============================= test session starts =============================
platform win32 -- Python 3.12.10, pytest-7.4.3, pluggy-1.6.0 -- C:\Users\Quencher\AppData\Local\Programs\Python\Python312\python.exe
cachedir: .pytest_cache
hypothesis profile 'default'
rootdir: C:\Users\Quencher\.gemini\antigravity\scratch\sovereign-repos\Project-AI
configfile: pyproject.toml
plugins: anyio-4.12.1, hypothesis-6.151.9, asyncio-0.23.3, cov-4.1.0
asyncio: mode=Mode.STRICT
collecting ... collected 38 items

tests/test_cli.py::TestCLIMain::test_cli_help PASSED                     [  2%]
tests/test_cli.py::TestCLIMain::test_cli_version PASSED                  [  5%]
tests/test_cli.py::TestCLIMain::test_cli_version_short PASSED            [  7%]
tests/test_cli.py::TestUserCommands::test_user_help PASSED               [ 10%]
tests/test_cli.py::TestUserCommands::test_user_example PASSED            [ 13%]
tests/test_cli.py::TestUserCommands::test_user_example_missing_arg FAILED [ 15%]
tests/test_cli.py::TestMemoryCommands::test_memory_help PASSED           [ 18%]
tests/test_cli.py::TestMemoryCommands::test_memory_example PASSED        [ 21%]
tests/test_cli.py::TestMemoryCommands::test_memory_example_missing_arg FAILED [ 23%]
tests/test_cli.py::TestLearningCommands::test_learning_help PASSED       [ 26%]
tests/test_cli.py::TestLearningCommands::test_learning_example PASSED    [ 28%]
tests/test_cli.py::TestLearningCommands::test_learning_example_missing_arg FAILED [ 31%]
tests/test_cli.py::TestPluginCommands::test_plugin_help PASSED           [ 34%]
tests/test_cli.py::TestPluginCommands::test_plugin_example PASSED        [ 36%]
tests/test_cli.py::TestPluginCommands::test_plugin_example_missing_arg FAILED [ 39%]
tests/test_cli.py::TestSystemCommands::test_system_help PASSED           [ 42%]
tests/test_cli.py::TestSystemCommands::test_system_example PASSED        [ 44%]
tests/test_cli.py::TestSystemCommands::test_system_example_missing_arg FAILED [ 47%]
tests/test_cli.py::TestAICommands::test_ai_help PASSED                   [ 50%]
tests/test_cli.py::TestAICommands::test_ai_example PASSED                [ 52%]
tests/test_cli.py::TestAICommands::test_ai_example_missing_arg FAILED    [ 55%]
tests/test_cli.py::TestCLIErrorHandling::test_invalid_command FAILED     [ 57%]
tests/test_cli.py::TestCLIErrorHandling::test_invalid_subcommand FAILED  [ 60%]
tests/test_api.py::test_health PASSED                                    [ 63%]
tests/test_api.py::test_tarl PASSED                                      [ 65%]
tests/test_api.py::test_root PASSED                                      [ 68%]
tests/test_api.py::test_intent_read_allow PASSED                         [ 71%]
tests/test_api.py::test_intent_write_deny_agent PASSED                   [ 73%]
tests/test_api.py::test_intent_execute_deny PASSED                       [ 76%]
tests/test_api.py::test_intent_mutate_deny PASSED                        [ 78%]
tests/test_api.py::test_governance_result_structure PASSED               [ 81%]
tests/test_api.py::test_pillar_votes PASSED                              [ 84%]
tests/test_api.py::test_audit_endpoint PASSED                            [ 86%]
tests/test_api.py::test_tarl_signature PASSED                            [ 89%]
tests/test_api.py::test_governed_execute_allow PASSED                    [ 92%]
tests/test_api.py::test_governed_execute_deny PASSED                     [ 94%]
tests/test_api.py::test_audit_persistence PASSED                         [ 97%]
tests/test_api.py::test_sandbox_executor PASSED                          [100%]

================================== FAILURES ===================================
_______________ TestUserCommands.test_user_example_missing_arg ________________

self = <tests.test_cli.TestUserCommands object at 0x000001DEC2B2D8E0>

    def test_user_example_missing_arg(self):
        """Test user example command with missing argument."""
        result = runner.invoke(app, ["user", "example"])
        assert result.exit_code != 0
>       assert "Missing argument" in result.stdout
E       AssertionError: assert 'Missing argument' in ''
E        +  where '' = <Result SystemExit(2)>.stdout

tests\test_cli.py:58: AssertionError
_____________ TestMemoryCommands.test_memory_example_missing_arg ______________

self = <tests.test_cli.TestMemoryCommands object at 0x000001DEC2B2DE20>

    def test_memory_example_missing_arg(self):
        """Test memory example command with missing argument."""
        result = runner.invoke(app, ["memory", "example"])
        assert result.exit_code != 0
>       assert "Missing argument" in result.stdout
E       AssertionError: assert 'Missing argument' in ''
E        +  where '' = <Result SystemExit(2)>.stdout

tests\test_cli.py:80: AssertionError
___________ TestLearningCommands.test_learning_example_missing_arg ____________

self = <tests.test_cli.TestLearningCommands object at 0x000001DEC2B2E360>

    def test_learning_example_missing_arg(self):
        """Test learning example command with missing argument."""
        result = runner.invoke(app, ["learning", "example"])
        assert result.exit_code != 0
>       assert "Missing argument" in result.stdout
E       AssertionError: assert 'Missing argument' in ''
E        +  where '' = <Result SystemExit(2)>.stdout

tests\test_cli.py:102: AssertionError
_____________ TestPluginCommands.test_plugin_example_missing_arg ______________

self = <tests.test_cli.TestPluginCommands object at 0x000001DEC2B2D730>

    def test_plugin_example_missing_arg(self):
        """Test plugin example command with missing argument."""
        result = runner.invoke(app, ["plugin", "example"])
        assert result.exit_code != 0
>       assert "Missing argument" in result.stdout
E       AssertionError: assert 'Missing argument' in ''
E        +  where '' = <Result SystemExit(2)>.stdout

tests\test_cli.py:124: AssertionError
_____________ TestSystemCommands.test_system_example_missing_arg ______________

self = <tests.test_cli.TestSystemCommands object at 0x000001DEC2B2E960>

    def test_system_example_missing_arg(self):
        """Test system example command with missing argument."""
        result = runner.invoke(app, ["system", "example"])
        assert result.exit_code != 0
>       assert "Missing argument" in result.stdout
E       AssertionError: assert 'Missing argument' in ''
E        +  where '' = <Result SystemExit(2)>.stdout

tests\test_cli.py:146: AssertionError
_________________ TestAICommands.test_ai_example_missing_arg __________________

self = <tests.test_cli.TestAICommands object at 0x000001DEC2B2EDE0>

    def test_ai_example_missing_arg(self):
        """Test ai example command with missing argument."""
        result = runner.invoke(app, ["ai", "example"])
        assert result.exit_code != 0
>       assert "Missing argument" in result.stdout
E       AssertionError: assert 'Missing argument' in ''
E        +  where '' = <Result SystemExit(2)>.stdout

tests\test_cli.py:168: AssertionError
__________________ TestCLIErrorHandling.test_invalid_command __________________

self = <tests.test_cli.TestCLIErrorHandling object at 0x000001DEC2B2F020>

    def test_invalid_command(self):
        """Test invalid command."""
        result = runner.invoke(app, ["invalid-command"])
        assert result.exit_code != 0
>       assert "No such command" in result.stdout
E       AssertionError: assert 'No such command' in ''
E        +  where '' = <Result SystemExit(2)>.stdout

tests\test_cli.py:178: AssertionError
________________ TestCLIErrorHandling.test_invalid_subcommand _________________

self = <tests.test_cli.TestCLIErrorHandling object at 0x000001DEC2B2F170>

    def test_invalid_subcommand(self):
        """Test invalid subcommand."""
        result = runner.invoke(app, ["user", "invalid-subcommand"])
        assert result.exit_code != 0
>       assert "No such command" in result.stdout
E       AssertionError: assert 'No such command' in ''
E        +  where '' = <Result SystemExit(2)>.stdout

tests\test_cli.py:184: AssertionError
============================== warnings summary ===============================
..\..\..\..\..\AppData\Local\Programs\Python\Python312\Lib\site-packages\fastapi\applications.py:18
  C:\Users\Quencher\AppData\Local\Programs\Python\Python312\Lib\site-packages\fastapi\applications.py:18: DeprecationWarning: 'HTTP_422_UNPROCESSABLE_ENTITY' is deprecated. Use 'HTTP_422_UNPROCESSABLE_CONTENT' instead.
    from fastapi.exception_handlers import (

..\..\..\..\..\AppData\Local\Programs\Python\Python312\Lib\site-packages\fastapi\applications.py:30
  C:\Users\Quencher\AppData\Local\Programs\Python\Python312\Lib\site-packages\fastapi\applications.py:30: DeprecationWarning: 'HTTP_422_UNPROCESSABLE_ENTITY' is deprecated. Use 'HTTP_422_UNPROCESSABLE_CONTENT' instead.
    from fastapi.openapi.utils import get_openapi

tests/test_api.py: 13 warnings
  C:\Users\Quencher\.gemini\antigravity\scratch\sovereign-repos\Project-AI\api\main.py:255: PydanticDeprecatedSince20: The `dict` method is deprecated; use `model_dump` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    payload = json.dumps(intent.dict(), sort_keys=True).encode()

tests/test_api.py: 26 warnings
  C:\Users\Quencher\.gemini\antigravity\scratch\sovereign-repos\Project-AI\api\main.py:464: PydanticDeprecatedSince20: The `dict` method is deprecated; use `model_dump` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    "votes": [v.dict() for v in record.votes],

tests/test_api.py::test_intent_read_allow
tests/test_api.py::test_governance_result_structure
tests/test_api.py::test_pillar_votes
tests/test_api.py::test_audit_endpoint
tests/test_api.py::test_audit_persistence
tests/test_api.py::test_audit_persistence
tests/test_api.py::test_audit_persistence
  C:\Users\Quencher\.gemini\antigravity\scratch\sovereign-repos\Project-AI\api\main.py:392: PydanticDeprecatedSince20: The `dict` method is deprecated; use `model_dump` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    return {"message": "Intent accepted under governance", "governance": result.dict()}

tests/test_api.py::test_intent_write_deny_agent
tests/test_api.py::test_intent_execute_deny
tests/test_api.py::test_intent_mutate_deny
  C:\Users\Quencher\.gemini\antigravity\scratch\sovereign-repos\Project-AI\api\main.py:388: PydanticDeprecatedSince20: The `dict` method is deprecated; use `model_dump` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    "governance": result.dict(),

tests/test_api.py::test_governed_execute_allow
tests/test_api.py::test_sandbox_executor
  C:\Users\Quencher\.gemini\antigravity\scratch\sovereign-repos\Project-AI\api\main.py:603: PydanticDeprecatedSince20: The `dict` method is deprecated; use `model_dump` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    "governance": result.dict(),

tests/test_api.py::test_governed_execute_deny
  C:\Users\Quencher\.gemini\antigravity\scratch\sovereign-repos\Project-AI\api\main.py:595: PydanticDeprecatedSince20: The `dict` method is deprecated; use `model_dump` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.12/migration/
    "governance": result.dict(),

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED tests/test_cli.py::TestUserCommands::test_user_example_missing_arg - A...
FAILED tests/test_cli.py::TestMemoryCommands::test_memory_example_missing_arg
FAILED tests/test_cli.py::TestLearningCommands::test_learning_example_missing_arg
FAILED tests/test_cli.py::TestPluginCommands::test_plugin_example_missing_arg
FAILED tests/test_cli.py::TestSystemCommands::test_system_example_missing_arg
FAILED tests/test_cli.py::TestAICommands::test_ai_example_missing_arg - Asser...
FAILED tests/test_cli.py::TestCLIErrorHandling::test_invalid_command - Assert...
FAILED tests/test_cli.py::TestCLIErrorHandling::test_invalid_subcommand - Ass...
================== 8 failed, 30 passed, 54 warnings in 2.49s ==================
