# Antigravity Security Configuration for Project-AI
# This file defines security policies and restrictions for AI agents

version: "1.0"

security:
  # Require human approval for sensitive operations
  require_approval:
    - file_deletion
    - config_changes
    - api_key_usage
    - database_operations
    - personhood_critical_changes
    - memory_modifications
    - ethical_framework_changes
  
  # Restricted paths - no modifications allowed
  restricted_paths:
    - path: "data/ai_persona/"
      reason: "Personhood-critical - AI identity and genesis records"
      read_only: true
    - path: ".env"
      reason: "Contains secrets and API keys"
      read_only: true
    - path: "data/command_override_config.json"
      reason: "Security configuration"
      read_only: true
    - path: "data/black_vault_secure/"
      reason: "Denied learning content"
      read_only: true
    - path: "data/memory/"
      reason: "AI memory and conversation history"
      modifications_require_approval: true
  
  # Sensitive file patterns
  sensitive_patterns:
    - "**/*password*"
    - "**/*secret*"
    - "**/*key*"
    - "**/*token*"
    - "**/*.pem"
    - "**/*.key"
    - "**/credentials*"
  
  # Allowed operations without approval
  auto_approve:
    - adding_tests
    - adding_documentation
    - adding_docstrings
    - adding_type_hints
    - fixing_typos
    - formatting_code
    - adding_comments
  
  # Security scanning
  auto_scan:
    enabled: true
    on_change: true
    tools:
      - name: bandit
        severity: medium
        exclude_paths:
          - "tests/"
          - "examples/"
      - name: pip-audit
        check_vulnerabilities: true
      - name: secret-scan
        patterns:
          - "sk-[a-zA-Z0-9]{32,}"  # OpenAI keys
          - "AIza[0-9A-Za-z_-]{35}"  # Google API keys
          - "gh[pousr]_[A-Za-z0-9]{36,}"  # GitHub tokens
    fail_on:
      - critical_vulnerability
      - exposed_secret
      - sql_injection
      - command_injection
  
  # Ethical review triggers
  ethical_review:
    auto_trigger_on:
      - ai_persona_changes
      - four_laws_modifications
      - memory_system_changes
      - learning_system_changes
      - user_data_access
      - encryption_changes
    require_triumvirate:
      - personhood_critical_changes
      - ethical_framework_changes
      - autonomous_decision_changes
  
  # Code execution restrictions
  execution:
    allowed_commands:
      - "pytest"
      - "python -m pytest"
      - "ruff"
      - "black"
      - "mypy"
      - "pip install"
      - "pip-audit"
      - "bandit"
    forbidden_commands:
      - "rm -rf /"
      - "sudo"
      - "chmod 777"
      - "eval"
      - "exec"
      - "curl | sh"
      - "wget | sh"
    sandbox:
      enabled: true
      network_access: limited
      filesystem_access: project_only
  
  # Data protection
  data_protection:
    encrypt_sensitive: true
    pii_detection: true
    anonymize_logs: true
    audit_trail: true
  
  # Compliance
  compliance:
    standards:
      - "OWASP Top 10"
      - "CWE Top 25"
      - "AGI Charter"
      - "Four Laws"
    audit_logging: true
    retention_days: 90
