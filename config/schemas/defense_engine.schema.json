{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Defense Engine Configuration Schema",
  "description": "Schema for Project-AI God Tier Zombie Apocalypse Defense Engine configuration",
  "type": "object",
  "required": ["version", "bootstrap", "subsystems"],
  "properties": {
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Configuration schema version"
    },
    "bootstrap": {
      "type": "object",
      "required": ["auto_discover", "failure_mode"],
      "properties": {
        "auto_discover": {
          "type": "boolean",
          "description": "Enable automatic subsystem discovery"
        },
        "discovery_paths": {
          "type": "array",
          "items": {"type": "string"},
          "description": "Paths to search for subsystems"
        },
        "failure_mode": {
          "type": "string",
          "enum": ["continue", "stop", "rollback"],
          "description": "Behavior on subsystem initialization failure"
        },
        "health_check_interval": {
          "type": "number",
          "minimum": 1,
          "maximum": 300,
          "description": "Health check interval in seconds"
        },
        "enable_hot_reload": {
          "type": "boolean",
          "description": "Enable runtime subsystem hot-reload"
        }
      }
    },
    "security": {
      "type": "object",
      "properties": {
        "encryption_enabled": {
          "type": "boolean",
          "description": "Enable state encryption"
        },
        "encryption_algorithm": {
          "type": "string",
          "enum": ["AES-256-GCM", "ChaCha20-Poly1305", "Fernet"],
          "default": "AES-256-GCM"
        },
        "key_rotation_days": {
          "type": "integer",
          "minimum": 1,
          "maximum": 365,
          "default": 90
        },
        "audit_log_retention_days": {
          "type": "integer",
          "minimum": 1,
          "default": 365
        }
      }
    },
    "operational_mode": {
      "type": "string",
      "enum": ["normal", "degraded", "air_gapped", "adversarial", "recovery", "maintenance", "emergency"],
      "default": "normal",
      "description": "System operational mode"
    },
    "subsystems": {
      "type": "object",
      "patternProperties": {
        "^[a-z_]+$": {
          "type": "object",
          "required": ["module_path", "class_name"],
          "properties": {
            "name": {
              "type": "string",
              "description": "Human-readable subsystem name"
            },
            "version": {
              "type": "string",
              "pattern": "^\\d+\\.\\d+\\.\\d+$"
            },
            "priority": {
              "type": "string",
              "enum": ["CRITICAL", "HIGH", "MEDIUM", "LOW", "BACKGROUND"]
            },
            "module_path": {
              "type": "string",
              "description": "Python module path"
            },
            "class_name": {
              "type": "string",
              "description": "Subsystem class name"
            },
            "dependencies": {
              "type": "array",
              "items": {"type": "string"},
              "description": "List of subsystem IDs this depends on"
            },
            "provides_capabilities": {
              "type": "array",
              "items": {"type": "string"},
              "description": "Capabilities this subsystem provides"
            },
            "enabled": {
              "type": "boolean",
              "default": true
            },
            "auto_init": {
              "type": "boolean",
              "default": true
            },
            "config": {
              "type": "object",
              "description": "Subsystem-specific configuration"
            }
          }
        }
      }
    },
    "data_persistence": {
      "type": "object",
      "properties": {
        "data_dir": {
          "type": "string",
          "default": "data"
        },
        "backup_enabled": {
          "type": "boolean",
          "default": true
        },
        "backup_interval_hours": {
          "type": "integer",
          "minimum": 1,
          "default": 24
        },
        "max_backups": {
          "type": "integer",
          "minimum": 1,
          "default": 7
        },
        "compression_enabled": {
          "type": "boolean",
          "default": true
        }
      }
    },
    "monitoring": {
      "type": "object",
      "properties": {
        "metrics_enabled": {
          "type": "boolean",
          "default": true
        },
        "metrics_export_interval": {
          "type": "integer",
          "minimum": 1,
          "default": 60
        },
        "alert_thresholds": {
          "type": "object",
          "properties": {
            "threat_level": {
              "type": "integer",
              "minimum": 0,
              "maximum": 10,
              "default": 6
            },
            "resource_critical_percent": {
              "type": "number",
              "minimum": 0,
              "maximum": 100,
              "default": 10
            },
            "subsystem_failure_count": {
              "type": "integer",
              "minimum": 1,
              "default": 3
            }
          }
        }
      }
    }
  }
}
